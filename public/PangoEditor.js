/*! For license information please see PangoEditor.js.LICENSE */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("html2canvas"),require("dompurify"),require("canvg"));else if("function"==typeof define&&define.amd)define(["html2canvas","dompurify","canvg"],t);else{var n="object"==typeof exports?t(require("html2canvas"),require("dompurify"),require("canvg")):t(e.html2canvas,e.dompurify,e.canvg);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(__WEBPACK_EXTERNAL_MODULE__1194__,__WEBPACK_EXTERNAL_MODULE__1195__,__WEBPACK_EXTERNAL_MODULE__1196__){return function(e){function t(t){for(var n,i,l=t[0],s=t[1],o=0,u=[];o<l.length;o++)i=l[o],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(a&&a(t);u.length;)u.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw e};var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var o=0;o<l.length;o++)t(l[o]);var a=s;return i(i.s=416)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XElementFactory=t.XDomUtil=t.XPageNumEle=t.XCommentEle=t.XButtonEle=t.XTextTableColumn=t.XParagraphFlag=t.XFractionEle=t.XCharacterEle=t.XTextTableView=t.XTextTableCellView=t.XTextTableRow=t.XTextTableCell=t.XTextTable=t.XTextDocumentsWrap=t.XStringEle=t.XPagePanelView=t.XDocPanelCmmt=t.XDocPanel=t.XPageView=t.XContainerColView=t.XContainerBaseView=t.XOutlineFoldIcon=t.XBaseMarkContainer=t.XInputEle=t.XPageBreakLabel=t.XLabelSerno=t.XInputBorderEle=t.XLabelEle=t.XEmptyLineSpaceEle=t.XSpliteLineEle=t.XShapeEle=t.XMedicalExpressionField=t.XImageEle=t.XCodeEle=t.XBaseResizableElement=t.XRadioBoxEle=t.XCheckBoxEle=t.XBaseChoiceEle=t.XBaseInputEle=t.XBaseContainer=t.XBaseElement=void 0;const r=n(150);Object.defineProperty(t,"XBaseElement",{enumerable:!0,get:function(){return r.XBaseElement}});const i=n(576);Object.defineProperty(t,"XBaseContainer",{enumerable:!0,get:function(){return i.XBaseContainer}});const l=n(306);Object.defineProperty(t,"XBaseInputEle",{enumerable:!0,get:function(){return l.XBaseInputEle}});const s=n(220);Object.defineProperty(t,"XBaseChoiceEle",{enumerable:!0,get:function(){return s.XBaseChoiceEle}});const o=n(591);Object.defineProperty(t,"XCheckBoxEle",{enumerable:!0,get:function(){return o.XCheckBoxEle}});const a=n(226);Object.defineProperty(t,"XRadioBoxEle",{enumerable:!0,get:function(){return a.XRadioBoxEle}});const u=n(666);Object.defineProperty(t,"XBaseResizableElement",{enumerable:!0,get:function(){return u.XBaseResizableElement}});const h=n(228);Object.defineProperty(t,"XCodeEle",{enumerable:!0,get:function(){return h.XCodeEle}});const d=n(75);Object.defineProperty(t,"XImageEle",{enumerable:!0,get:function(){return d.XImageEle}});const c=n(669);Object.defineProperty(t,"XMedicalExpressionField",{enumerable:!0,get:function(){return c.XMedicalExpressionField}});const p=n(230);Object.defineProperty(t,"XShapeEle",{enumerable:!0,get:function(){return p.XShapeEle}});const f=n(329);Object.defineProperty(t,"XSpliteLineEle",{enumerable:!0,get:function(){return f.XSpliteLineEle}});const g=n(675);Object.defineProperty(t,"XEmptyLineSpaceEle",{enumerable:!0,get:function(){return g.XEmptyLineSpaceEle}});const m=n(162);Object.defineProperty(t,"XLabelEle",{enumerable:!0,get:function(){return m.XLabelEle}});const E=n(330);Object.defineProperty(t,"XInputBorderEle",{enumerable:!0,get:function(){return E.XInputBorderEle}});const C=n(331);Object.defineProperty(t,"XLabelSerno",{enumerable:!0,get:function(){return C.XLabelSerno}});const A=n(676);Object.defineProperty(t,"XPageBreakLabel",{enumerable:!0,get:function(){return A.XPageBreakLabel}});const y=n(88);Object.defineProperty(t,"XInputEle",{enumerable:!0,get:function(){return y.XInputEle}});const I=n(677);Object.defineProperty(t,"XBaseMarkContainer",{enumerable:!0,get:function(){return I.XBaseMarkContainer}});const S=n(332);Object.defineProperty(t,"XOutlineFoldIcon",{enumerable:!0,get:function(){return S.XOutlineFoldIcon}});const _=n(334);Object.defineProperty(t,"XContainerBaseView",{enumerable:!0,get:function(){return _.XContainerBaseView}});const w=n(679);Object.defineProperty(t,"XContainerColView",{enumerable:!0,get:function(){return w.XContainerColView}});const b=n(680);Object.defineProperty(t,"XPageView",{enumerable:!0,get:function(){return b.XPageView}});const x=n(681);Object.defineProperty(t,"XDocPanel",{enumerable:!0,get:function(){return x.XDocPanel}});const P=n(682);Object.defineProperty(t,"XDocPanelCmmt",{enumerable:!0,get:function(){return P.XDocPanelCmmt}});const v=n(683);Object.defineProperty(t,"XPagePanelView",{enumerable:!0,get:function(){return v.XPagePanelView}});const T=n(79);Object.defineProperty(t,"XStringEle",{enumerable:!0,get:function(){return T.XStringEle}});const M=n(684);Object.defineProperty(t,"XTextDocumentsWrap",{enumerable:!0,get:function(){return M.XTextDocumentsWrap}});const L=n(45);Object.defineProperty(t,"XTextTable",{enumerable:!0,get:function(){return L.XTextTable}});const D=n(685);Object.defineProperty(t,"XTextTableCell",{enumerable:!0,get:function(){return D.XTextTableCell}});const R=n(336);Object.defineProperty(t,"XTextTableRow",{enumerable:!0,get:function(){return R.XTextTableRow}});const F=n(686);Object.defineProperty(t,"XTextTableCellView",{enumerable:!0,get:function(){return F.XTextTableCellView}});const N=n(687);Object.defineProperty(t,"XTextTableView",{enumerable:!0,get:function(){return N.XTextTableView}});const B=n(307);Object.defineProperty(t,"XCharacterEle",{enumerable:!0,get:function(){return B.XCharacterEle}});const k=n(688);Object.defineProperty(t,"XFractionEle",{enumerable:!0,get:function(){return k.XFractionEle}});const O=n(346);Object.defineProperty(t,"XParagraphFlag",{enumerable:!0,get:function(){return O.XParagraphFlag}});const G=n(712);Object.defineProperty(t,"XTextTableColumn",{enumerable:!0,get:function(){return G.XTextTableColumn}});const X=n(347);Object.defineProperty(t,"XButtonEle",{enumerable:!0,get:function(){return X.XButtonEle}});const V=n(348);Object.defineProperty(t,"XCommentEle",{enumerable:!0,get:function(){return V.XCommentEle}});const H=n(174);Object.defineProperty(t,"XPageNumEle",{enumerable:!0,get:function(){return H.XPageNumEle}});const U=n(16);Object.defineProperty(t,"XDomUtil",{enumerable:!0,get:function(){return U.XDomUtil}});const W=n(309);Object.defineProperty(t,"XElementFactory",{enumerable:!0,get:function(){return W.XElementFactory}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseAction=void 0;const r=n(2),i=n(62),l=n(0),s=n(16),o=n(29),a=n(351),u=n(111),h=n(234),d=n(352),c=n(92),p=n(32),f=n(14),g=n(6),m=n(3),E=n(7),C=n(26);t.XBaseAction=class{constructor(e){this.applyWkMode=d.ActionWorkMode.Default,this.resMsg=new u.ResMessage,this.tooltipUtil=null,this.edtCtrl=null,this.title=null,this.opType=r.ENumActOpType.Other,this.hotChKey=o.Keys.None,this.hotModKey=o.Keys.None,this.isRefresh=!0,this.SetEditCtrl(e)}static GetCurEle(){return this._curEle}static SetCurEle(e){this._curEle=e}SetEditCtrl(e){this.edtCtrl=e}SetElementList(e,t){this.settimeOutList=e,this.elementList=t}GetEdtCtrl(){return this.edtCtrl}GetVisiblePageViewPainter(){let e=[];return this.edtCtrl.MGetPageViewList().forEach(t=>{t.PageLocationUI.Y>this.edtCtrl.VisibleRect.Bottom||t.PageLocationUI.Y+t.PageRect.Height<this.edtCtrl.VisibleRect.Y||e.push(t)}),e}GetSelRangeOuterEles(e){let t,[n,r]=[null,null];return t=e.FromLineEleIx.LineIx!=e.ToLineEleIx.LineIx?e.FromLineEleIx.LineIx<e.ToLineEleIx.LineIx:e.FromLineEleIx.EleIx<=e.ToLineEleIx.EleIx,n=(t?e.FromLineEleIx:e.ToLineEleIx)._GetNextEle(!1,!1,!1),r=(t?e.ToLineEleIx:e.FromLineEleIx)._GetNextEle(!0,!1,!1),[n,r]}GetFocusedOuterEles(e){let[t,n]=[null,null];return t=e.LineEleIxFocused._GetNextEle(!1,!1,!1,!1),n=e.EleFocused,[t,n]}Execute(e){return this.resMsg.Clear(),this.resMsg}ActName(){return this.actName}get Title(){return this.title}set Title(e){this.title=e}get OpType(){return this.opType}set OpType(e){this.opType=e}set ApplyWorkMode(e){this.applyWkMode=e}IsChecked(){return!1}GetXDocFocused(){return null==this.edtCtrl?null:this.edtCtrl.M_DocumentFocused}GetEdtLoginUserInfo(){return null==this.edtCtrl?null:this.edtCtrl.M_EdtLoginUserInfo}SetHotKey(e,t){this.hotChKey=e,this.hotModKey=t}TestHotKey(e,t){return e!=o.Keys.None&&this.hotChKey==e&&this.hotModKey==t}IsEnable(e=!1){if(!this.IsEnableForCurWkMode(!1))return!1;let t=this.edtCtrl.M_EleEvtModel.EleClicked;if(s.XDomUtil.IsOwnXDocPanelEditable(t)||(this.OpType&r.ENumActOpType.AnyEdit)==r.ENumActOpType.Other)return!0;{let t="文档当前区域内元素不可编辑";return this.resMsg.MsgStr=t,this.MessageError(),e?a.CommDefinesExt.ShowWarnDlg(t,null):a.CommDefinesExt.ShowMsgSBar(t),!1}}IsEnableForCurWkMode(e=!0){const t=this.edtCtrl.M_EleEvtModel.WorkMode,n=this._TransToActWkMode(t),r=(n&this.applyWkMode)==n;if(!r){let n="当前 "+t+" 工作模式下，"+this.ActName()+" 不能编辑";e?a.CommDefinesExt.ShowWarnDlg(n,null):a.CommDefinesExt.ShowMsgSBar(n)}return r}resetRefreshDocList(e){null==this.RefreshDocList.find(t=>t.DocID==e.DocID)&&this.RefreshDocList.push(e)}MRefreshDocsView(){for(let e=0;e<this.RefreshDocList.length;e++){let t=this.RefreshDocList[e];this.edtCtrl.MRefreshDocView(t,!0)}}_RefreshPageAndMoveCaret(e=!0,t=!1,n){if(null!=this.edtCtrl&&this.isRefresh){const r=this.edtCtrl.MPagesCnt;t?this.edtCtrl.MRefreshDocView():this.edtCtrl.MRefreshDocsView(),this.edtCtrl.M_EleEvtModel.MoveCaretByCursorEle(e),null==this.tooltipUtil&&(this.tooltipUtil=new h.TooltipTestUtil(this.edtCtrl)),this.tooltipUtil.SetTooltipPos(0,!1),this.tooltipUtil.RefreshTooltip();const i=this.edtCtrl.MPagesCnt;(n||i!=r)&&this.edtCtrl.M_emrDocView.RefreshRuler()}}_RefreshPageAndMoveCaretBetweenEle(e,t,n=!0){if(null!=this.edtCtrl){const r=this.edtCtrl.MPagesCnt;this.edtCtrl.MRefreshDocViewBetweenEle(e,t),this.edtCtrl.M_EleEvtModel.MoveCaretByCursorEle(n),null==this.tooltipUtil&&(this.tooltipUtil=new h.TooltipTestUtil(this.edtCtrl)),this.tooltipUtil.SetTooltipPos(0,!1),this.tooltipUtil.RefreshTooltip();this.edtCtrl.MPagesCnt!=r&&this.edtCtrl.M_emrDocView.RefreshRuler()}}_RefreshPageAndMoveCaretWithLineRange(e,t,n=!0){if(null!=this.edtCtrl){const r=this.edtCtrl.MPagesCnt;if(e>-1)this.edtCtrl.MRefreshDocViewWithLineRange(e,t);else{let e=this.GetVisiblePageViewPainter(),t=-1,n=-1;(null!=e||e.length>0)&&(t=e[0].PageIx,n=e[e.length-1].PageIx);let r=this.edtCtrl.M_PageFocused;null!=r&&(r.PageIx>t&&(t=r.PageIx),t>n&&(n=t)),t>-1&&this.edtCtrl.MRefreshDocViewWithLineRange(this.edtCtrl.MGetPageView(t).FromLineIx,this.edtCtrl.MGetPageView(n).ToLineIx)}this.edtCtrl.M_EleEvtModel.MoveCaretByCursorEle(n),null==this.tooltipUtil&&(this.tooltipUtil=new h.TooltipTestUtil(this.edtCtrl)),this.tooltipUtil.SetTooltipPos(0,!1),this.tooltipUtil.RefreshTooltip();this.edtCtrl.MPagesCnt!=r&&this.edtCtrl.M_emrDocView.RefreshRuler()}}_UseCaretEleStyle(e){if(null!=e){if(null!=this.edtCtrl){let t=this.edtCtrl.M_CaretEleStyle;e.EleStyle.CopyFrom(t,!1)}const t=this.edtCtrl.M_EleEvtModel.WorkMode,n=this.edtCtrl.M_EdtCustomEvtGrp.getAppInsertForeColor();let i=t==r.ENumWorkMode.App;i=i&&null!=e.EleStyle,i=i&&null!=n&&!n.IsEmpty(),i&&(e.EleStyle.ForeColor=n)}}_AddUndoItem(e){if(null!=this.edtCtrl){let t=this.edtCtrl.M_EleEvtModel.EleClickedWrap,n=t.EleFocused;null==e.CursorUndoEle&&(e.CursorUndoEle=n),null==e.CursorRedoEle&&(e.CursorRedoEle=t.EleFocused),this.edtCtrl.M_UndoMgr.AddItem(e)}}_GetFirstEleFromRange(e){let t,n=null==e?0:e.length;if(n<=0)return null;let r=null;for(let t=0;t<n;t++)if(e[t]instanceof l.XCharacterEle){r=e[t];break}return t=null==r?e[0]:r,t}setInstance(e){}CheckAddRule(e,t){return this.Checkadd_WorkMode(e)&&this.Checkadd_PanelEdit(t)&&this.Checkadd_Input(e,t)}Checkadd_WorkMode(e){let t;return e==r.ENumWorkMode.PrintPreview||e==r.ENumWorkMode.Browse||e==r.ENumWorkMode.KeepTrace?(this.resMsg.MsgStr="病历，写入失败。浏览模式、打印预览和痕迹模式不能删除！",t=!1):t=!0,t}Checkadd_PanelEdit(e){let t;return s.XDomUtil.IsOwnXDocPanelEditable(e)?t=!0:(this.resMsg.MsgStr="病历，写入失败。当前面板不可编辑！",t=!1),t}Checkadd_Input(e,t){let n;if(e==r.ENumWorkMode.Design)n=!0;else{let i=s.XDomUtil.GetParentXInput(t,!0);if(null==i)n=e==r.ENumWorkMode.App;else if(i.UserEditable)n=!0;else{let e="病历，写入失败。当前元素只读！";this.resMsg.MsgStr=e,n=!1}}return n}_TransToActWkMode(e){let t=d.ActionWorkMode.Default;switch(e){case r.ENumWorkMode.Design:t=d.ActionWorkMode.Design;break;case r.ENumWorkMode.App:t=d.ActionWorkMode.Application;break;case r.ENumWorkMode.KeepTrace:case r.ENumWorkMode.PrintPreview:case r.ENumWorkMode.Browse:t=d.ActionWorkMode.Browse}return t}updateOwnerDocPanel(e,t){if(null!=e&&(e.OwnerDocPanel=t),e instanceof l.XBaseContainer)for(let n=0;n<e.ChildEleList.Count();n++){const r=e.ChildEleList.Get(n);this.updateOwnerDocPanel(r,t)}}resetDeleteFlag(e){if(null!=e&&(e instanceof p.XTextLabelElement?e.IsDeleteFlag=!0:e.Deletable=!0),e instanceof l.XBaseContainer)for(let t=0;t<e.ChildEleList.Count();t++){const n=e.ChildEleList.Get(t);this.resetDeleteFlag(n)}}xtextLabelElementToString(e){if(null!=e&&e instanceof p.XTextLabelElement){let t=new l.XStringEle;return t.Text=e.Text,t}if(e instanceof l.XBaseContainer)for(let t=0;t<e.ChildEleList.Count();t++){const n=e.ChildEleList.Get(t);let r=this.xtextLabelElementToString(n);null!=r&&e.ChildEleList.Set(t,r)}}getDocFromStroage(e){let t=f.XmlDomUtil.parseXMLFromString(e),n=new i.XTextDocument(!1);n.FromXML(t);let r=n.GetFirstBaseChild();const l=this.HasTypeParant(r,"XTextTableCell");null!=l&&(r=l);let s=n._GetLastBaseChild();return n.GetPagePanel(g.ENumPagePanelTp.Body).RefreshLines(!1),[r,s]}HasTypeParant(e,t){return null==e?null:e.EleTypeName==t?e:this.HasTypeParant(e.Parent,t)}ClearStyle(){let e=this.elementList.ToArray();for(let t=0;t<e.length;t++){let n=e[t];n instanceof l.XInputBorderEle||(n.EleStyle.BackgroundColor=n.OldForeColor,n.OldForeColor=null,this.elementList.Remove(n))}for(let e of this.settimeOutList)clearTimeout(e);this.elementList.Length>0&&this._RefreshPageAndMoveCaret(!0)}getXmlByCptIdInParent(e,t,n,r,s=!0,o=!0,a=!0,u=!1){let h,d=this.edtCtrl,c=new m.List;e.Document.storeChildrenList(c);new i.XTextDocument(!1);let g=t.ChildEleList,E=g.IndexOf(e),C=g.Length,A=new m.List;for(let t=E+1;t<C;t++){let n=g.Get(t);if(n instanceof l.XTextTable){if(u)break;if(!r){let t=new m.List;n.GetChildrenByType("XTextLabelElement",!0,t);let r=!1;for(let n=0;n<t.Length;n++){if(t.Get(n).TitleLevel<=e.TitleLevel){r=!0;break}}if(r)break}}if(n instanceof p.XTextLabelElement&&n.TitleLevel<=e.TitleLevel)break;A.Add(n)}if(0==A.Length)return{xml:null,paragraphtext:null};let y=new m.List;if(!o||!a){let e=!1;for(let[t,n]of A.ToArray().entries())0==t&&!o&&n instanceof l.XButtonEle||e&&!a&&n instanceof l.XParagraphFlag||(0==t&&!a&&n instanceof l.XParagraphFlag||1==t&&!a&&n instanceof l.XParagraphFlag&&A.Get(0)instanceof l.XButtonEle?e=!0:(e=n instanceof l.XParagraphFlag,y.Add(n)));A=y}e.Document.restoreChildrenList(A),e.Document.GetDocCtxt().EmrWorkMode=d.M_EleEvtModel.WorkMode,h=n?e.Document.GetInnerTextWithAll(s)||"":e.Document.GetInnerText(s)||"";let I=e.Document.ToXML(),S=f.XmlDomUtil.Xml2String(I);return e.Document.restoreChildrenList(c),d.Focus(),{xml:'<?xml version="1.0" encoding="utf-8"?>'+S,paragraphtext:h}}getXmlByCptIdInParent1(e,t,n,r=!0,s=!1,o=!0,a=!0){let u,h=this.edtCtrl,d=new m.List;new i.XTextDocument(!1);e.Document.storeChildrenList(d);let c=t.ChildEleList,g=c.IndexOf(e),E=c.Length,C=new m.List;for(let t=g+1;t<E;t++){let n=c.Get(t);if(n instanceof l.XTextTable){let t=new m.List;n.GetChildrenByType("XTextLabelElement",!0,t);let r=!1;for(let n=0;n<t.Length;n++){if(t.Get(n).TitleLevel<=e.TitleLevel){r=!0;break}}if(r)break}if(n instanceof p.XTextLabelElement&&n.TitleLevel<=e.TitleLevel)break;C.Add(n)}if(0==C.Length)return{xml:null,paragraphtext:null};let A=new m.List;if(!o||!a){let e=!1;for(let[t,n]of C.ToArray().entries())0==t&&!o&&n instanceof l.XButtonEle||e&&!a&&n instanceof l.XParagraphFlag||(0==t&&!a&&n instanceof l.XParagraphFlag||1==t&&!a&&n instanceof l.XParagraphFlag&&C.Get(0)instanceof l.XButtonEle?e=!0:(e=n instanceof l.XParagraphFlag,A.Add(n)));C=A}t instanceof l.XTextTableCell&&this.getNextTableCellEle(e,t,C),e.Document.restoreChildrenList(C),e.Document.GetDocCtxt().EmrWorkMode=h.M_EleEvtModel.WorkMode,u=n?e.Document.GetInnerTextWithAll(r,s)||"":e.Document.GetInnerText(r,s)||"";let y=e.Document.ToXML(),I=f.XmlDomUtil.Xml2String(y);return e.Document.restoreChildrenList(d),h.Focus(),{xml:'<?xml version="1.0" encoding="utf-8"?>'+I,paragraphtext:u}}getNextTableCellEle(e,t,n){let r=s.XDomUtil.GetXTableOfCell(t).GetNextCellWithNexRow(t);if(null==r)return;let i=r.ChildEleList,l=i.Length;for(let t=0;t<l;t++){let r=i.Get(t);if(r instanceof p.XTextLabelElement&&r.TitleLevel<=e.TitleLevel)return;n.Add(r)}this.getNextTableCellEle(e,r,n)}SetTimeChangeColor(e){if(C.TextDocInitInfo.GetInstance().DelayedChangeFlag){let t=this.GetBaseElement(e);for(let e=0;e<t.length;e++){let n=t[e];this.elementList.Add(n),n instanceof l.XInputBorderEle||(n.OldForeColor=n.EleStyle.BackgroundColor,n.EleStyle.BackgroundColor=new E.Color(C.TextDocInitInfo.GetInstance().DelayedChangeColor))}let n=setTimeout(()=>{for(let e=0;e<t.length;e++){let n=t[e];n instanceof l.XInputBorderEle||(this.elementList.Remove(n),n.EleStyle.BackgroundColor=n.OldForeColor,n.OldForeColor=null)}clearTimeout(n),this.settimeOutList.Remove(n),this._RefreshPageAndMoveCaret(!0)},C.TextDocInitInfo.GetInstance().DelayedChangeTime);this.settimeOutList.Add(n)}}GetBaseElement(e){let t,n=new m.List,r=new m.List;for(let t=0;t<e.length;t++){let i=e[t],s=i instanceof l.XBaseContainer?i:null;if(null==s)n.Add(i);else{r.Clear(),s.GetChildrenCanBeInline(r,!0,!0);let e=this._FiltUnselectableEles(r,!1,!0);n.AddRange(e)}}let i=n.ToArray();return n.Clear(),t=i,t}_FiltUnselectableEles(e,t=!0,n=!0){let r,i=e.ToArray();if(i.length<=0)r=i;else{e.Clear();let l=!1,o=!1,a=i;for(let r=0;r<a.length;r++){let i=a[r];null!=i&&(n&&i.EleStyle.DeleterIndex>=0?l=!0:t&&s.XDomUtil.IsBkgTextOfXInput(i)?o=!0:e.Add(i))}(l||o)&&(i=e.ToArray()),e.Clear(),r=i}return r}getEleByeleId(e,t){let n=new m.List;return e?(null==t||(-1!=e.indexOf("xid-")&&t.GetChildrenByXID(e,!0,n),n.Count()<1&&t.GetChildrenByCptId(e,!0,n)),n):n}MessageWarn(){this.resMsg.MsgStr&&!this.edtCtrl.HideMsgBox&&c.MessageBoxComp.Show({title:"提示",content:this.resMsg.MsgStr,type:"warning",dom:this.edtCtrl.ContainerDOM})}MessageError(){this.resMsg.MsgStr&&!this.edtCtrl.HideMsgBox&&c.MessageBoxComp.Show({title:"提示",content:this.resMsg.MsgStr,type:"error",dom:this.edtCtrl.ContainerDOM})}}},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ENumDefines=t.ENumPermLv=t.ENumXLabelType=t.ENumEleCursorSide=t.ENumCopyMode=t.ENumRefreshStatus=t.ENumEdtType=t.ENumActOpType=t.ContentViewEncryptType=t.ENumSecretType=t.ENumCanSecret=t.ENumBkgRectsType=t.ENumWarterMarkTp=t.ENumViewMode=t.ENumEvtSrc=t.ENumWorkMode=t.ENumXDocPath=t.XInputMarkType=void 0,function(e){e[e.SolidRect=0]="SolidRect",e[e.EmptyRect=1]="EmptyRect",e[e.SolidCircle=2]="SolidCircle",e[e.EmptyCircle=3]="EmptyCircle"}(t.XInputMarkType||(t.XInputMarkType={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.LocalFile=1]="LocalFile",e[e.RemoteFile=2]="RemoteFile"}(t.ENumXDocPath||(t.ENumXDocPath={})),function(e){e[e.Design=0]="Design",e[e.KeepTrace=1]="KeepTrace",e[e.App=2]="App",e[e.Form=3]="Form",e[e.Browse=6]="Browse",e[e.PrintPreview=7]="PrintPreview"}(t.ENumWorkMode||(t.ENumWorkMode={})),function(e){e[e.NOTHING=0]="NOTHING",e[e.MOUSE_DRAG=1]="MOUSE_DRAG",e[e.MOUSE_MOVE=2]="MOUSE_MOVE",e[e.MOUSE_LPRESS=4]="MOUSE_LPRESS",e[e.MOUSE_RPRESS=8]="MOUSE_RPRESS",e[e.MOUSE_DBLCLICK=16]="MOUSE_DBLCLICK",e[e.MOUSE_RELEAS=32]="MOUSE_RELEAS",e[e.KEY_PRESS=64]="KEY_PRESS",e[e.MOUSE_MOVELeave=128]="MOUSE_MOVELeave"}(t.ENumEvtSrc||(t.ENumEvtSrc={})),function(e){e[e.CleanView=1]="CleanView",e[e.WebView=2]="WebView",e[e.Init=-4]="Init"}(t.ENumViewMode||(t.ENumViewMode={})),function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Image=2]="Image"}(t.ENumWarterMarkTp||(t.ENumWarterMarkTp={})),function(e){e[e.None=0]="None",e[e.SelRects=1]="SelRects",e[e.FocusRects=2]="FocusRects",e[e.HoverRects=3]="HoverRects"}(t.ENumBkgRectsType||(t.ENumBkgRectsType={})),function(e){e[e.Inherit=0]="Inherit",e[e.Yes=1]="Yes",e[e.No=2]="No"}(t.ENumCanSecret||(t.ENumCanSecret={})),function(e){e[e.None=0]="None",e[e.All=1]="All",e[e.Partial=2]="Partial"}(r=t.ENumSecretType||(t.ENumSecretType={})),function(e){e[e.Both=0]="Both",e[e.Partial=1]="Partial",e[e.None=2]="None"}(i=t.ContentViewEncryptType||(t.ContentViewEncryptType={})),function(e){e[e.Other=0]="Other",e[e.CtntEdit=1]="CtntEdit",e[e.StyleEdit=2]="StyleEdit",e[e.AnyEdit=3]="AnyEdit",e[e.Save=4]="Save"}(t.ENumActOpType||(t.ENumActOpType={})),function(e){e[e.Other=0]="Other",e[e.Add=1]="Add",e[e.Delete=2]="Delete",e[e.Backspace=3]="Backspace",e[e.Replace=4]="Replace",e[e.ModStyle=5]="ModStyle"}(t.ENumEdtType||(t.ENumEdtType={})),function(e){e[e.None=0]="None",e[e.Descript=1]="Descript",e[e.Refresh=2]="Refresh",e[e.RegisterExp=3]="RegisterExp"}(t.ENumRefreshStatus||(t.ENumRefreshStatus={})),function(e){e[e.InWinSys=0]="InWinSys",e[e.InProgram=1]="InProgram",e[e.InDocByUser=2]="InDocByUser",e[e.InDoc=3]="InDoc"}(t.ENumCopyMode||(t.ENumCopyMode={})),function(e){e[e.Both=0]="Both",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.ForceLeft=3]="ForceLeft",e[e.ForceRight=4]="ForceRight"}(t.ENumEleCursorSide||(t.ENumEleCursorSide={})),function(e){e[e.Common=0]="Common",e[e.XOutlineSerno=1]="XOutlineSerno",e[e.XInputBorder=2]="XInputBorder",e[e.XInputLabel=3]="XInputLabel",e[e.XInputUnit=4]="XInputUnit",e[e.XInputSuffix=5]="XInputSuffix"}(t.ENumXLabelType||(t.ENumXLabelType={})),function(e){e[e.None=0]="None",e[e.Bed_Doctor=1]="Bed_Doctor",e[e.Charge_Physician=2]="Charge_Physician",e[e.Chief_Physician=3]="Chief_Physician"}(t.ENumPermLv||(t.ENumPermLv={}));t.ENumDefines=class{static SecretTypeFromAPI(e){let t=r.None;switch(e){case i.Both:t=r.All;break;case i.Partial:t=r.Partial;break;case i.None:t=r.None}return t}static SecretTypeToAPI(e){let t=i.None;switch(e){case r.None:t=i.None;break;case r.All:t=i.Both;break;case r.Partial:t=i.Partial}return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadOnlyList=t.ReadOnlyCollection=t.Dictionary=t.List=t.Enumerable=void 0;const r=n(31);Object.defineProperty(t,"Enumerable",{enumerable:!0,get:function(){return r.Enumerable}});const i=n(38);Object.defineProperty(t,"List",{enumerable:!0,get:function(){return i.List}});const l=n(193);Object.defineProperty(t,"Dictionary",{enumerable:!0,get:function(){return l.Dictionary}});const s=n(194);Object.defineProperty(t,"ReadOnlyCollection",{enumerable:!0,get:function(){return s.ReadOnlyCollection}});const o=n(483);Object.defineProperty(t,"ReadOnlyList",{enumerable:!0,get:function(){return o.ReadOnlyList}}),t.default=r.Enumerable,n(254)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(50),i=n(114),l=n(124);class s{static castAsNonUtf8Char(e,t=null){const n=t?t.getName():this.ISO88591;return l.default.decode(new Uint8Array([e]),n)}static guessEncoding(e,t){if(null!=t&&void 0!==t.get(r.default.CHARACTER_SET))return t.get(r.default.CHARACTER_SET).toString();const n=e.length;let i=!0,l=!0,o=!0,a=0,u=0,h=0,d=0,c=0,p=0,f=0,g=0,m=0,E=0,C=0;const A=e.length>3&&239===e[0]&&187===e[1]&&191===e[2];for(let t=0;t<n&&(i||l||o);t++){const n=255&e[t];o&&(a>0?0==(128&n)?o=!1:a--:0!=(128&n)&&(0==(64&n)?o=!1:(a++,0==(32&n)?u++:(a++,0==(16&n)?h++:(a++,0==(8&n)?d++:o=!1))))),i&&(n>127&&n<160?i=!1:n>159&&(n<192||215===n||247===n)&&C++),l&&(c>0?n<64||127===n||n>252?l=!1:c--:128===n||160===n||n>239?l=!1:n>160&&n<224?(p++,g=0,f++,f>m&&(m=f)):n>127?(c++,f=0,g++,g>E&&(E=g)):(f=0,g=0))}return o&&a>0&&(o=!1),l&&c>0&&(l=!1),o&&(A||u+h+d>0)?s.UTF8:l&&(s.ASSUME_SHIFT_JIS||m>=3||E>=3)?s.SHIFT_JIS:i&&l?2===m&&2===p||10*C>=n?s.SHIFT_JIS:s.ISO88591:i?s.ISO88591:l?s.SHIFT_JIS:o?s.UTF8:s.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let n=-1;return e.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,(function(e,r,i,l,s,o){if("%%"===e)return"%";if(void 0===t[++n])return;e=l?parseInt(l.substr(1)):void 0;let a,u=s?parseInt(s.substr(1)):void 0;switch(o){case"s":a=t[n];break;case"c":a=t[n][0];break;case"f":a=parseFloat(t[n]).toFixed(e);break;case"p":a=parseFloat(t[n]).toPrecision(e);break;case"e":a=parseFloat(t[n]).toExponential(e);break;case"x":a=parseInt(t[n]).toString(u||16);break;case"d":a=parseFloat(parseInt(t[n],u||10).toPrecision(e)).toFixed(0)}a="object"==typeof a?JSON.stringify(a):(+a).toString(u);let h=parseInt(i),d=i&&i[0]+""=="0"?"0":" ";for(;a.length<h;)a=void 0!==r?a+d:d+a;return a}))}static getBytes(e,t){return l.default.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}static Equals(e,t){return e===t}static GetHashCode(e){for(var t=0,n=0,r=e.length,i=0;i<r;i++)t=31*t+e.charCodeAt(n++);for(;t>2147483647;)t+=-4294967296;return t}static IsAsciiChar(e){let t=e.charCodeAt(0);return t>0&&t<127}static IsNullOrEmpty(e){return null==e||0==e.length}static Join(e,...t){try{let n=t[0];if(Array.isArray(n)||n instanceof Array){let t=s.Empty;for(let r=0;r<n.length;r++){let i=n[r];r<n.length-1?t+=i+e:t+=i}return t}if("object"==typeof n){let t=s.Empty,r=n;return Object.keys(n).forEach(n=>{t+=r[n]+e}),t=t.slice(0,t.length-e.length),t}let r=t;return s.join(e,...r)}catch(e){return s.Empty}}static Format(e,...t){try{return e.match(s.regexNumber)?s.format_inner(s.regexNumber,e,t):e.match(s.regexObject)?s.format_inner(s.regexObject,e,t,!0):e}catch(e){return s.Empty}}static format_inner(e,t,n,r=!1){return t.replace(e,(function(e,t){let i,l=e.split(":");return l.length>1&&(t=l[0].replace("{",""),e=l[1].replace("}","")),i=r?n[0][t]:n[t],null==i||null==i||e.match(/{\d+}/)?i:(i=s.parsePattern(e,i),void 0!==i&&null!=i?i:s.Empty)}))}static parsePattern(e,t){switch(e){case"L":return t&&(t=t.toLowerCase()),t;case"U":return t=t.toUpperCase();case"d":if("string"==typeof t)return s.getDisplayDateFromString(t);if(t instanceof Date)return s.Format("{0:00}.{1:00}.{2:0000}",t.getDate(),t.getMonth(),t.getFullYear());break;case"s":if("string"==typeof t)return s.getSortableDateFromString(t);if(t instanceof Date)return s.Format("{0:0000}-{1:00}-{2:00}",t.getFullYear(),t.getMonth(),t.getDate());break;case"n":{"string"!=typeof t&&(t=t.toString());let e=t.replace(/,/g,".");if(isNaN(parseFloat(e))||e.length<=3)break;let l=e.split(/[^0-9]+/g),o=l;l.length>1&&(o=[s.join("",...l.splice(0,l.length-1)),l[l.length-1]]);let a=o[0];var n=a.length%3,r=n>0?a.substring(0,n):s.Empty,i=a.substring(n).match(/.{3}/g);return t=(r=r+"."+s.Join(".",i))+(o.length>1?","+o[1]:"")}}return"number"!=typeof t&&isNaN(t)||isNaN(+e)||s.IsNullOrEmpty(t)?t:s.formatNumber(t,e)}static getDisplayDateFromString(e){let t;if(t=e.split("-"),t.length<=1)return e;let n=t[t.length-1],r=t[t.length-2],i=t[t.length-3];return n=n.split("T")[0],n=n.split(" ")[0],`${n}.${r}.${i}`}static getSortableDateFromString(e){let t=e.replace(",","").split(".");if(t.length<=1)return e;let n=t[t.length-1].split(" "),r=s.Empty;n.length>1&&(r=n[n.length-1]);let i=`${t[t.length-1].split(" ")[0]}-${t[t.length-2]}-${t[t.length-3]}`;return!s.IsNullOrEmpty(r)&&r.length>1?i+="T"+r:i+="T00:00:00",i}static formatNumber(e,t){let n=t.length,r=e.toString();if(n<=r.length)return r;let i=n-r.length;return i+=1,new Array(i).join("0")+r}static join(e,...t){let n=s.Empty;for(let r=0;r<t.length;r++){if("string"==typeof t[r]&&s.IsNullOrEmpty(t[r])||"number"!=typeof t[r]&&"string"!=typeof t[r])continue;n+=""+t[r];for(let i=r+1;i<t.length;i++)if(!s.IsNullOrEmpty(t[i])){n+=e,r=i-1;break}}return n}static Concat(e){let t="";return e instanceof Array&&e.forEach(e=>{"string"==typeof e&&(t+=e)}),t}}t.default=s,s.SHIFT_JIS=i.default.SJIS.getName(),s.GB2312="GB2312",s.ISO88591=i.default.ISO8859_1.getName(),s.UTF8=i.default.UTF8.getName(),s.PLATFORM_DEFAULT_ENCODING=s.UTF8,s.ASSUME_SHIFT_JIS=!1,s.regexNumber=/{(\d+(:\w*)?)}/g,s.regexObject=/{(\w+(:\w*)?)}/g,s.Empty=""},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WriterException=t.UnsupportedOperationException=t.ReedSolomonException=t.ReaderException=t.NotFoundException=t.IllegalStateException=t.IllegalArgumentException=t.FormatException=t.ChecksumException=t.ArithmeticException=t.ArrayIndexOutOfBoundsException=t.ArgumentOutOfRangeException=t.KeyNotFoundException=t.InvalidOperationException=t.ArgumentNullException=t.ArgumentException=t.Exception=void 0;var r=n(190);Object.defineProperty(t,"Exception",{enumerable:!0,get:function(){return r.Exception}});var i=n(422);Object.defineProperty(t,"ArgumentException",{enumerable:!0,get:function(){return i.ArgumentException}});var l=n(423);Object.defineProperty(t,"ArgumentNullException",{enumerable:!0,get:function(){return l.ArgumentNullException}});var s=n(424);Object.defineProperty(t,"InvalidOperationException",{enumerable:!0,get:function(){return s.InvalidOperationException}});var o=n(425);Object.defineProperty(t,"KeyNotFoundException",{enumerable:!0,get:function(){return o.KeyNotFoundException}});var a=n(426);Object.defineProperty(t,"ArgumentOutOfRangeException",{enumerable:!0,get:function(){return a.ArgumentOutOfRangeException}});var u=n(427);Object.defineProperty(t,"ArrayIndexOutOfBoundsException",{enumerable:!0,get:function(){return u.ArrayIndexOutOfBoundsException}});var h=n(428);Object.defineProperty(t,"ArithmeticException",{enumerable:!0,get:function(){return h.ArithmeticException}});var d=n(429);Object.defineProperty(t,"ChecksumException",{enumerable:!0,get:function(){return d.ChecksumException}});var c=n(430);Object.defineProperty(t,"FormatException",{enumerable:!0,get:function(){return c.FormatException}});var p=n(431);Object.defineProperty(t,"IllegalArgumentException",{enumerable:!0,get:function(){return p.IllegalArgumentException}});var f=n(432);Object.defineProperty(t,"IllegalStateException",{enumerable:!0,get:function(){return f.IllegalStateException}});var g=n(433);Object.defineProperty(t,"NotFoundException",{enumerable:!0,get:function(){return g.NotFoundException}});var m=n(434);Object.defineProperty(t,"ReaderException",{enumerable:!0,get:function(){return m.ReaderException}});var E=n(435);Object.defineProperty(t,"ReedSolomonException",{enumerable:!0,get:function(){return E.ReedSolomonException}});var C=n(436);Object.defineProperty(t,"UnsupportedOperationException",{enumerable:!0,get:function(){return C.UnsupportedOperationException}});var A=n(437);Object.defineProperty(t,"WriterException",{enumerable:!0,get:function(){return A.WriterException}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENumPagePanelTp=void 0,function(e){e[e.Header=0]="Header",e[e.Body=1]="Body",e[e.Footer=2]="Footer",e[e.CmmtBar=3]="CmmtBar"}(t.ENumPagePanelTp||(t.ENumPagePanelTp={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;const r=n(36);class i{constructor(e){this._value=null,this._value=i.buildStr(e)}static buildStr(e){if(null!=e){if(0===e.indexOf("rgba"))return e;if(0===e.indexOf("rgb")&&-1===e.indexOf("a")){let t=e.slice(0,e.lastIndexOf(")"))+", 1)";return t=t.replace("b","ba"),t}if(0===e.indexOf("#")&&9==e.length){const t=[];let n=parseInt("0x"+e.substr(1,2));return t.push(parseInt("0x"+e.substr(3,2))),t.push(parseInt("0x"+e.substr(5,2))),t.push(parseInt("0x"+e.substr(7,2))),n*=1/255,n=Math.ceil(100*n)/100,n=Math.min(n,1),t.push(n),"rgba(".concat(t.join(",")).concat(")")}if(0===e.indexOf("#")){const t=[];return t.push(parseInt("0x"+e.substr(1,2))),t.push(parseInt("0x"+e.substr(3,2))),t.push(parseInt("0x"+e.substr(5,2))),t.push(1),"rgba(".concat(t.join(",")).concat(")")}{let t=e[0].toUpperCase();e.substring(1)&&(t+=e.substring(1));const n=i[t];return n?n.ToRgbaString():i.Empty}}}ToRgbaString(){return this._value}static FromArgb(e,t,n){var r="#"+((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1);return new i(r)}toString(){if(r.StringUtils.IsNullOrEmpty(this._value))return null;{let e=this._value.split("(")[1].split(")")[0].split(","),t=Number(e[3]),n=parseInt(e[0]),r=parseInt(e[1]),i=parseInt(e[2]);t=Math.ceil(255*t),t=Math.min(t,255);let l=t.toString(16).toUpperCase();1==l.length&&(l="0"+l);let s=n.toString(16).toUpperCase();1==s.length&&(s="0"+s);let o=r.toString(16).toUpperCase();1==o.length&&(o="0"+o);let a=i.toString(16).toUpperCase();return 1==a.length&&(a="0"+a),"#"+l+s+o+a}}static RGBA2RGB(e){var t=e.split("(")[1].split(")")[0].split(","),n=t[3];return"rgb("+(1*(1-n)+t[0]*n)+","+(1*(1-n)+t[1]*n)+","+(1*(1-n)+t[2]*n)+")"}getOpacity(){if(r.StringUtils.IsNullOrEmpty(this._value))return null;{let e=this._value.split("(")[1].split(")")[0].split(",");return Number(e[3])}}setOpacity(e){this._value=this._value.replace("1)",e+")")}static get Empty(){return null}static get MediumPurple(){return new i("#FF9370DB")}static get MediumSeaGreen(){return new i("##FF3CB371")}static get MediumSlateBlue(){return new i("#FF7B68EE")}static get MediumSpringGreen(){return new i("#FF00FA9A")}static get MediumTurquoise(){return new i("#FF48D1CC")}static get MediumVioletRed(){return new i("#FFC71585")}static get MidnightBlue(){return new i("#FF191970")}static get MediumOrchid(){return new i("#FFBA55D3")}static get MintCream(){return new i("#FFF5FFFA")}static get Moccasin(){return new i("#FFFFE4B5")}static get NavajoWhite(){return new i("#FFFFDEAD")}static get Navy(){return new i("#FF000080")}static get OldLace(){return new i("#FFFDF5E6")}static get Olive(){return new i("#FF808000")}static get OliveDrab(){return new i("#FF6B8E23")}static get Orange(){return new i("#FFFFA500")}static get MistyRose(){return new i("#FFFFE4E1")}static get OrangeRed(){return new i("#FFFF4500")}static get MediumBlue(){return new i("#FF0000CD")}static get Maroon(){return new i("#FF800000")}static get LightBlue(){return new i("#FFADD8E6")}static get LightCoral(){return new i("#FFF08080")}static get LightGoldenrodYellow(){return new i("#FFFAFAD2")}static get LightGreen(){return new i("#FF90EE90")}static get LightGray(){return new i("#FFD3D3D3")}static get LightPink(){return new i("#FFFFB6C1")}static get LightSalmon(){return new i("#FFFFA07A")}static get MediumAquamarine(){return new i("#FF66CDAA")}static get LightSeaGreen(){return new i("#FF20B2AA")}static get LightSlateGray(){return new i("#FF778899")}static get LightSteelBlue(){return new i("#FFB0C4DE")}static get LightYellow(){return new i("#FFFFFFE0")}static get Lime(){return new i("#FF00FF00")}static get LimeGreen(){return new i("#FF32CD32")}static get Linen(){return new i("#FFFAF0E6")}static get Magenta(){return new i("#FFFF00FF")}static get LightSkyBlue(){return new i("#FF87CEFA")}static get LemonChiffon(){return new i("#FFFFFACD")}static get Orchid(){return new i("#FFDA70D6")}static get PaleGreen(){return new i("#FF98FB98")}static get SlateBlue(){return new i("#FF6A5ACD")}static get SlateGray(){return new i("#FF708090")}static get Snow(){return new i("#FFFFFAFA")}static get SpringGreen(){return new i("#FF00FF7F")}static get SteelBlue(){return new i("#FF4682B4")}static get Tan(){return new i("#FFD2B48C")}static get Teal(){return new i("#FF008080")}static get SkyBlue(){return new i("#FF87CEEB")}static get Thistle(){return new i("#FFD8BFD8")}static get Turquoise(){return new i("#FF40E0D0")}static get Violet(){return new i("#FFEE82EE")}static get Wheat(){return new i("#FFF5DEB3")}static get White(){return new i("#FFFFFFFF")}static get WhiteSmoke(){return new i("#FFF5F5F5")}static get Yellow(){return new i("#FFFFFF00")}static get YellowGreen(){return new i("#FF9ACD32")}static get Tomato(){return new i("#FFFF6347")}static get PaleGoldenrod(){return new i("#FFEEE8AA")}static get Silver(){return new i("#FFC0C0C0")}static get SeaShell(){return new i("#FFFFF5EE")}static get PaleTurquoise(){return new i("#FFAFEEEE")}static get PaleVioletRed(){return new i("#FFDB7093")}static get PapayaWhip(){return new i("#FFFFEFD5")}static get PeachPuff(){return new i("#FFFFDAB9")}static get Peru(){return new i("#FFCD853F")}static get Pink(){return new i("#FFFFC0CB")}static get Plum(){return new i("#FFDDA0DD")}static get Sienna(){return new i("#FFA0522D")}static get PowderBlue(){return new i("#FFB0E0E6")}static get Red(){return new i("#FFFF0000")}static get RosyBrown(){return new i("#FFBC8F8F")}static get RoyalBlue(){return new i("#FF4169E1")}static get SaddleBrown(){return new i("#FF8B4513")}static get Salmon(){return new i("#FFFA8072")}static get SandyBrown(){return new i("#FFF4A460")}static get SeaGreen(){return new i("#FF2E8B57")}static get Purple(){return new i("#FF800080")}static get LawnGreen(){return new i("#FF7CFC00")}static get LightCyan(){return new i("#FFE0FFFF")}static get Lavender(){return new i("#FFE6E6FA")}static get DarkKhaki(){return new i("#FFBDB76B")}static get DarkGreen(){return new i("#FF006400")}static get DarkGray(){return new i("#FFA9A9A9")}static get DarkGoldenrod(){return new i("#FFB8860B")}static get DarkCyan(){return new i("#FF008B8B")}static get DarkBlue(){return new i("#FF00008B")}static get Cyan(){return new i("#FF00FFFF")}static get Crimson(){return new i("#FFDC143C")}static get Cornsilk(){return new i("#FFFFF8DC")}static get LavenderBlush(){return new i("#FFFFF0F5")}static get Coral(){return new i("#FFFF7F50")}static Chocolate(){return new i("#FFD2691E")}static Chartreuse(){return new i("#FF7FFF00")}static get DarkMagenta(){return new i("#FF8B008B")}static get CadetBlue(){return new i("#FF5F9EA0")}static get Brown(){return new i("#FFA52A2A")}static get BlueViolet(){return new i("#FF8A2BE2")}static get Blue(){return new i("#FF0000FF")}static get BlanchedAlmond(){return new i("#FFFFEBCD")}static get Black(){return new i("#FF000000")}static get Bisque(){return new i("#FFFFE4C4")}static get Beige(){return new i("#FFF5F5DC")}static get Azure(){return new i("#FFF0FFFF")}static get Aquamarine(){return new i("#FF7FFFD4")}static get Aqua(){return new i("#FF00FFFF")}static get AntiqueWhite(){return new i("#FFFAEBD7")}static get AliceBlue(){return new i("#FFF0F8FF")}static get Transparent(){return new i("#00FFFFFF")}static get BurlyWood(){return new i("#FFDEB887")}static get DarkOliveGreen(){return new i("#FF556B2F")}static get CornflowerBlue(){return new i("#FF6495ED")}static DarkOrchid(){return new i("#FF9932CC")}static get Khaki(){return new i("#FFF0E68C")}static get Ivory(){return new i("#FFFFFFF0")}static get DarkOrange(){return new i("#FFFF8C00")}static get Indigo(){return new i("#FF4B0082")}static get IndianRed(){return new i("#FFCD5C5C")}static get HotPink(){return new i("#FFFF69B4")}static get Honeydew(){return new i("#FFF0FFF0")}static get GreenYellow(){return new i("#FFADFF2F")}static get Green(){return new i("#FF008000")}static get Gray(){return new i("#FF808080")}static get Goldenrod(){return new i("#FFDAA520")}static get GhostWhite(){return new i("#FFF8F8FF")}static get Gainsboro(){return new i("#FFDCDCDC")}static get Fuchsia(){return new i("#FFFF00FF")}static get Gold(){return new i("#FFFFD700")}static get FloralWhite(){return new i("#FFFFFAF0")}static get DarkRed(){return new i("#FF8B0000")}static get DarkSalmon(){return new i("#FFE9967A")}static get DarkSeaGreen(){return new i("#FF8FBC8F")}static get ForestGreen(){return new i("#FF228B22")}static get DarkSlateGray(){return new i("#FF2F4F4F")}static get DarkTurquoise(){return new i("#FF00CED1")}static get DarkSlateBlue(){return new i("#FF483D8B")}static get DeepPink(){return new i("#FFFF1493")}static get DeepSkyBlue(){return new i("#FF00BFFF")}static get DimGray(){return new i("#FF696969")}static get DodgerBlue(){return new i("#FF1E90FF")}static get Firebrick(){return new i("#FFB22222")}static get DarkViolet(){return new i("#FF9400D3")}static get ControlDark(){return new i("#FFA0A0A0")}static get ControlBlue(){return new i("#2d5afa")}IsEmpty(){return null==this._value}IsSystemColor(){return!1}static FromRgba(e,t,n,r){return null==r&&(r=255),new i("#"+i.transHex(r)+i.transHex(e)+i.transHex(t)+i.transHex(n))}static transHex(e){let t="";return null!=e&&(t=e.toString(16),1==t.length&&(t="0"+t)),t}IsEqual(e){return this._value==e._value}GetBrightness(){return 0}GetHue(){return 0}GetSaturation(){return 0}}t.Color=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CNumUtil=void 0;const r=n(4);t.CNumUtil=class{static TryParseBool(e,t){return r.default.IsNullOrEmpty(e)?t:"boolean"==typeof e?e:"number"==typeof e?!!e:"true"==e.toLowerCase()||"false"!=e.toLowerCase()&&void 0}static TryParseInt(e,t){if(r.default.IsNullOrEmpty(e))return t;let n=parseInt(e);return isNaN(n)?t:n}static TryParseLng(e,t){return r.default.IsNullOrEmpty(e)?t:parseFloat(e)}static TryParseFloat(e,t){if(r.default.IsNullOrEmpty(e))return t;let n=parseFloat(e);return isNaN(n)?t:n}static TryParsePct(e,t){let n;if(r.default.IsNullOrEmpty(e))return n=t,n;let i=e.indexOf("%");if(i<=0)n=t;else{let t=e.substring(0,i);n=parseFloat(t)/100}return n}static TryParseDouble(e,t){return r.default.IsNullOrEmpty(e)?t:parseFloat(e)}static ToStringForBool(e){return"boolean"==typeof e?e?"true":"false":r.default.IsNullOrEmpty(e)?e:void 0}static ToStringForNum(e){return e.toString()}static IsEqual(e,t,n){let r=e-t;return r>=-n&&r<=n}static Round(e,t=0,n=!0){t<0&&(t=0);let r=1;for(;t-- >0;)r*=10;return Math.floor(e*r+(n?.5:0))/r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleF=void 0;const r=n(17),i=n(25);class l{constructor(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i,this.location=new r.PointF(this.x,this.y)}get Location(){return this.location}set Location(e){this.location=e,this.x=e.X,this.y=e.Y}get X(){return this.x}set X(e){this.x=e,this.location.X=this.x}get Top(){return this.y}get Left(){return this.x}get Right(){return this.x+this.width}get Bottom(){return this.y+this.height}get Y(){return this.y}set Y(e){this.y=e,this.location.Y=this.y}get Width(){return this.width}set Width(e){this.width=e}get Height(){return this.height}set Height(e){this.height=e}Contains(e,t){if(e instanceof r.PointF){let n=e;e=n.X,t=n.Y}return e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height}static get Empty(){return new l(0,0,0,0)}union(e){const t=this.x<e.x?this.x:e.x,n=this.y<e.y?this.y:e.y,r=this.x+this.width<e.x+e.width?e.x+e.width:this.x+this.width,i=this.y+this.height<e.y+e.height?e.y+e.height:this.y+this.height;return new l(t,n,r-t,i-n)}toString(){return"("+this.x+","+this.y+")-("+this.width+","+this.height+")"}Inflate(e,t){}get Size(){return new i.SizeF(this.width,this.height)}set Size(e){this.width=e.Width,this.height=e.Height}Offset(e,t){this.x+=e,this.y+=t,this.location.X=this.x,this.location.Y=this.y}Clone(){return new l(this.x,this.y,this.width,this.height)}}t.RectangleF=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DPITransUtil=void 0;const r=n(82);t.DPITransUtil=class{static TransIntVal(e,t,n){var r;t<=0||n<=0||t==n?r=e:r=e*(n/t)+.5;return parseInt(r.toString())}static TransFloatVal(e,t,n){var r;t<=0||n<=0||t==n?r=e:r=e*(n/t);return parseFloat(r.toString())}static TransPointF(e,t,n,r){if(t<=0||r<=0||t==r)n.X=e.X,n.Y=e.Y;else{let i=r/t;n.X=e.X*i,n.Y=e.Y*i}return n}static TransRectF(e,t,n,r){if(t<=0||r<=0||t==r)n.X=e.X,n.Y=e.Y,n.Width=e.Width,n.Height=e.Height;else{let i=r/t;n.X=e.X*i,n.Y=e.Y*i,n.Width=e.Width*i,n.Height=e.Height*i}return n}static TransPadding(e,t,n){let i=r.Padding.Empty;if(t<=0||n<=0||t==n)i.Left=e.Left,i.Top=e.Top,i.Right=e.Right,i.Bottom=e.Bottom;else{let r=n/t;i.Left=parseInt(e.Left*r+.5+""),i.Top=parseInt(e.Top*r+.5+""),i.Right=parseInt(e.Right*r+.5+""),i.Bottom=parseInt(e.Bottom*r+.5+"")}return i}static TransRect(e,t,n,r){if(t<=0||r<=0||t==r)n.X=e.X,n.Y=e.Y,n.Width=e.Width,n.Height=e.Height;else{let i=r/t;n.X=e.X*i+.5,n.Y=e.Y*i+.5,n.Width=e.Width*i+.5,n.Height=e.Height*i+.5}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrawConstDef=t.BorderStyle=t.ENumVAlignStyle=t.ENumHAlignStyle=t.ENumDirection=t.ENumGutterSide=t.ENumOutTp=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.UI_Show=1]="UI_Show",e[e.UI_Print=2]="UI_Print",e[e.CsPrint=5]="CsPrint",e[e.ExpXML=6]="ExpXML",e[e.ExpPDF=7]="ExpPDF",e[e.ExpExcel=8]="ExpExcel",e[e.ExpWord=9]="ExpWord",e[e.ExpHtml=10]="ExpHtml"}(t.ENumOutTp||(t.ENumOutTp={})),function(e){e[e.LEFT=1]="LEFT",e[e.TOP=2]="TOP"}(t.ENumGutterSide||(t.ENumGutterSide={})),function(e){e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.TOP=4]="TOP",e[e.BOTTOM=8]="BOTTOM",e[e.ALL=15]="ALL"}(t.ENumDirection||(t.ENumDirection={})),function(e){e[e.NONE=1]="NONE",e[e.LEFT=2]="LEFT",e[e.CENTER=3]="CENTER",e[e.RIGHT=4]="RIGHT",e[e.BothEnds=5]="BothEnds",e[e.Scattered=6]="Scattered"}(t.ENumHAlignStyle||(t.ENumHAlignStyle={})),function(e){e[e.NONE=1]="NONE",e[e.TOP=2]="TOP",e[e.MIDDLE=3]="MIDDLE",e[e.BOTTOM=4]="BOTTOM"}(t.ENumVAlignStyle||(t.ENumVAlignStyle={})),function(e){e[e.None=0]="None",e[e.FixedSingle=1]="FixedSingle",e[e.Fixed3D=2]="Fixed3D"}(t.BorderStyle||(t.BorderStyle={}));t.DrawConstDef=class{static HasDirection(e,t){return t==(e&t)}}},function(e,t,n){"use strict";e.exports=n(631)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UndoGroup=void 0;const r=n(0),i=n(23),l=n(215),s=n(3);class o extends l.IXCursorEleUndo{constructor(){super(),this.cursorUndoEle=null,this.cursorRedoEle=null,this.isCaretVisible=!0,this.itemList=null,this.itemList=new s.List}get CursorUndoEle(){return this.cursorUndoEle}set CursorUndoEle(e){this.cursorUndoEle=r.XDomUtil.GetBaseElement(e)}get CursorRedoEle(){return this.cursorRedoEle}set CursorRedoEle(e){this.cursorRedoEle=r.XDomUtil.GetBaseElement(e)}get IsCaretVisible(){return this.isCaretVisible}AddItem(e){null!=e&&e.IsValid()&&this.itemList.Add(e)}IsValid(){return this.itemList.Count()>0}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){if(this.CanUndo()){this.isCaretVisible=!0;let e=this.itemList.ToArray();for(let t=e.length-1;t>=0;t--){const n=e[t];n.Undo();let r=n instanceof l.IXCursorEleUndo?n:null;if(null!=r){this.isCaretVisible=r.IsCaretVisible;let e=r.CursorUndoEle;null!=e&&(this.cursorUndoEle=e)}}}}Redo(){if(this.CanRedo()){this.isCaretVisible=!0;const e=this.itemList.GetEnumerator();for(;e.MoveNext();){const t=e.Current;t.Redo();let n=t instanceof l.IXCursorEleUndo?t:null;if(null!=n){this.isCaretVisible=n.IsCaretVisible;let e=n.CursorRedoEle;null!=e&&(this.cursorRedoEle=e)}}}}Clear(){if(this.cursorUndoEle=null,0!=this.itemList.Count()){for(let e of this.itemList)e.Clear();this.itemList.Clear()}}GetEnd(){let e,t=this.itemList.Count();if(t<=0)return e=null,e;let n=this.itemList.Get(t-1);if(n instanceof i.IXUndoable)e=n;else{let r=this.itemList.ToArray();for(let e=t-2;e>=0;e--)if(r[e]instanceof i.IXUndoable){n=r[e];break}e=n}return e}RemoveEnd(){const e=this.itemList.Count();if(0==e)return null;const t=this.itemList.Get(e-1);return this.itemList.RemoveAt(e-1),t}GetChildUodoList(){return this.itemList}}t.UndoGroup=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlDomUtil=void 0;const r=n(4);class i{static GetSingleNode(e,t){if(null==e)return null;let n;try{let r=e.childNodes;if(null==r||0==r.length)return null;let i=r.length;for(let e=0;e<i;e++)if(r[e].nodeName==t){n=r[e];break}}catch(e){}return n}static GetSingleAttribute(e,t){let n;if(null==e)return n=null,null;let r=e.attributes;if(null==r||0==r.length)return n=null,null;let i=null;try{i=r.getNamedItem(t)}catch(e){}return n=i,n}static GetSingleAttrValue(e,t){let n;if(null==e)return n=null,null;let r=e.attributes;if(null==r||0==r.length)return n=null,null;let i=null;try{i=r.getNamedItem(t)}catch(e){}return n=null==i?null:i.value,n}static CrtXmlAttr(e,t,n,l){let s;if(null==e)return s=null,null;if(r.default.IsNullOrEmpty(t))return s=null,null;let o,a=i._ParseXmlNameWithPrefix(t);return r.default.IsNullOrEmpty(a[1])?(s=null,null):(o=r.default.IsNullOrEmpty(a[0])||r.default.IsNullOrEmpty(l)?e.createAttribute(a[1]):e.createAttributeNS(l,t),o.value=n,s=o,s)}static CrtXmlEle(e,t,n){let l;if(null==e)return l=null,l;if(null==t)return l=null,l;let s,o=i._ParseXmlNameWithPrefix(t);return null==o[1]?(l=null,l):(s=r.default.IsNullOrEmpty(o[0])||r.default.IsNullOrEmpty(n)?e.createElement(o[1]):e.createElementNS(n,o[0],o[1]),l=s,l)}static _ParseXmlNameWithPrefix(e){let t,n,r=e.indexOf(":");return r<0&&(t=null,n=e),0==r&&(t=null,n=e.substring(1)),r>0&&(t=e.substring(0,r),n=e.substring(r+1)),[t,n]}static Xml2String(e){return(new XMLSerializer).serializeToString(e)}static setPrefix(e){for(var t=[],n=0;n<e;++n)t.push("    ");return t.join("")}static formateXml(e){let t=e;t="\n"+t.replace(/(<\w+)(\s.*?>)/g,(function(e,t,n){return t+" "+n.replace(/\s+(\w+=)/g," $1")})).replace(/>\s*?</g,">\n<"),t=t.replace(/\n/g,"\r").replace(/<!--(.+?)-->/g,(function(e,t){return"\x3c!--"+escape(t)+"--\x3e"})).replace(/\r/g,"\n");let n=[],r=t.replace(/\n(<(([^\?]).+?)(?:\s|\s*?>|\s*?(\/)>)(?:.*?(?:(?:(\/)>)|(?:<(\/)\2>)))?)/gm,(function(e,t,r,l,s,o,a,u){let h="/"==s||"/"==o||"/"==a||"/"==u,d="";return"!"==l?d=i.setPrefix(n.length):"/"!=l?(d=i.setPrefix(n.length),h||n.push(r)):(n.pop(),d=i.setPrefix(n.length)),"\n"+d+t})).substring(1);return r=r.replace(/\n/g,"\r").replace(/(\s*)<!--(.+?)-->/g,(function(e,t,n){return"\r"==t.charAt(0)&&(t=t.substring(1)),"\n"+t+"\x3c!--"+(n=unescape(n).replace(/\r/g,"\n")).replace(/^\s*/gm,t)+"--\x3e"})),r=r.replace(/\s+$/g,"").replace(/\r/g,"\r\n"),r}}t.XmlDomUtil=i,i.parseXMLFromString=function(e){var t;if(e=(e=e.replace(/\u0000/g,"")).replace(/\x00/g,""),(t=(new DOMParser).parseFromString(e,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors")>-1)throw new Error(t.firstChild.firstChild.textContent);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsNullOrUndefined=t.IsUndefined=t.IsNull=t.throws=void 0;const r=n(421);t.throws=r;var i=n(255);Object.defineProperty(t,"IsNull",{enumerable:!0,get:function(){return i.IsNull}});var l=n(256);Object.defineProperty(t,"IsUndefined",{enumerable:!0,get:function(){return l.IsUndefined}});var s=n(438);Object.defineProperty(t,"IsNullOrUndefined",{enumerable:!0,get:function(){return s.IsNullOrUndefined}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDomUtil=void 0;const r=n(2),i=n(59),l=n(3),s=n(25),o=n(106),a=n(305),u=n(65),h=n(83),d=n(585),c=n(0),p=n(4),f=n(7);class g{static ReCalcDrawSize(e,t,n){let r=g.GetParentHasRect(e,!1);if(null==r)return s.SizeF.Empty;let i,l=g.GetParentValidWidth(e,!1);i=g.CanContainerAutoHeight(r)?r.OwnerDocPanel.GetValidHeight(96):r.GetValidHeight(96);let o=h.XImageUtil.CalcImgZmRatio(t,n,l,i);return o<1&&(t*=o,n*=o),new s.SizeF(t,n)}static CanContainerAutoHeight(e){return null!=e&&e instanceof c.XTextTableCell}static GetFirstEleFromLine(e,t){if(null==e||e.ElementCnt<=0)return null;let n,r=null;for(let n of e.ChildEleList)if(n.EleTypeName==t){r=n;break}return n=r,n}static GetXTableOrViewOfCell(e){return g.GetCellLineContainer(e)}static IsTableLine(e){if(null==e||e.ElementCnt<=0)return!1;if(null!=e.Container){return"XTextTable"==e.Container.EleTypeName}return e.FirstElement instanceof c.XTextTableCell}static IsLineSameContainer(e,t){if(null==e||null==t)return!1;let n=e.OwnerLine,r=t.OwnerLine;return n.Container==r.Container}static GetEvtEleTpName(e){if(null==e)return null;let t=e.EleTypeName;if(e instanceof c.XCharacterEle){let n=e.Parent.Parent;if(n instanceof c.XBaseInputEle){if(e==n.GetFirstChildBaseEle(!0))return t}t=n.EleTypeName}else e instanceof c.XInputBorderEle?e.IsStartBorder||(t=e.Parent.EleTypeName):e instanceof c.XParagraphFlag&&(t=e.Parent.EleTypeName);return t}static IsEleRemoved(e,t){if(null==e||null==e.Parent)return!0;if(e instanceof c.XBaseInputEle&&(e=e.GetChildEle(0)),null==e)return!0;if(e.IsHidden(!t))return!1;let n=e instanceof c.XBaseContainer,r=e.IsRemoved;return!r&&t&&(r=g.HasDelTrace(e)),n?!!r||!g.HasValidChild(e):r}static IsOwnXDocPanelEditable(e){let t=null==e?null:e.OwnerDocPanel;return null!=t&&t.IsEditable}static AutoTransToReplaceMode(e){if(null==e)return!1;let t=e;if(null==t||" "!=t.ChVal)return!1;if(!t.EleStyle.XFontStyle.IsUnderline)return!1;let n=t.GetParentInputField();return null==n||n.MinSpaceNumber<=0}static GetXTableOfCell(e){return null==e||null==e.Parent?null:e.Parent.Parent}static IsEndCellOfXTable(e,t=!0,n=!0,r=!0){let i=g.GetXTableOfCell(e);if(null==i)return!1;let l,s=i.NumOfRows,o=i.NumOfColumns;l=r?e.RowIndex+(e.RowSpan<=1?0:e.RowSpan-1):e.RowIndex;let a=l+1>=s,u=e.ColIndex+(e.ColSpan<=1?0:e.ColSpan-1)+1>=o;return t&&n?a&&u:t?a:n&&u}static GetNextEle(e,t){let n=new i.ClickedElementWrapper(!1);return n.LineEleIxFocused.SetEle2(t),n.GetNextEle(e)}static GetBaseElement(e){if(null==e)return null;if(e instanceof c.XBaseContainer){return e.GetFirstChildBaseEle(!1)}return e}static HasDelTrace(e){if(null==e)return!1;let t=!1;for(;null!=e&&(t=g._ChkEleDelTrace(e),!t);)e=e.Parent;return t}static _ChkEleDelTrace(e){if(null==e)return!1;e instanceof c.XBaseInputEle&&(e=e.GetFirstChildBaseEle(!0));let t=null==e?null:e.EleStyle;return null!=t&&t.DeleterIndex>=0}static HasValidChild(e){if(null==e)return!1;return g.GetCtntChildCnt(e,!0)>=g.GetMinCntValidChild(e)}static GetMinCntValidChild(e){return null==e||e instanceof c.XStringEle?1:e instanceof c.XBaseInputEle?p.default.IsNullOrEmpty(e.BackgroundText)?2:3:1}static GetCtntChildCnt(e,t=!0){if(null==e)return 0;let n=e.ChildCount;if(n<=0)return 0;if(e instanceof c.XStringEle&&t)return n;n=0;for(let r of e.ChildEleList)g.IsEleRemoved(r,!t)||!t&&g.FullDelTrace(r)||n++;return n}static IsBkgTextOfXInput(e){if(null==e)return!1;let t,n;return e instanceof c.XCharacterEle?e.Parent instanceof c.XStringEle&&(t=e.Parent):e instanceof c.XStringEle&&(t=e),null!=t&&(t.Parent instanceof c.XBaseInputEle&&(n=t.Parent),null!=n&&t.IsXInputBkgText)}static IsInnerLabelOfXInput(e,t=!1){let n,r;if(e instanceof c.XLabelEle&&(n=e),null==n)return!1;if(t&&e instanceof c.XInputBorderEle)return!0;if(e.Parent instanceof c.XBaseInputEle&&(r=e.Parent),null==r)return!1;let i=r.LabelTextEle,l=r.UnitLabelTextEle,s=r.SuffixTextEle;return n==i||n==l||n==s}static IsInnerChildOfXInput(e){return null==e?null:g.IsInnerLabelOfXInput(e,!0)?e.Parent:g.IsBkgTextOfXInput(e)?e instanceof c.XCharacterEle?e.Parent.Parent:e.Parent:null}static FullDelTrace(e){if(null==e)return!1;if(!(e instanceof c.XBaseContainer)){return g._ChkEleDelTrace(e)}let t=!0,n=!1;for(let r of e.ChildEleList){if(null==g.IsInnerChildOfXInput(r)&&!g.IsEleRemoved(r,!1)&&(r instanceof c.XBaseInputEle&&(r=r.GetChildEle(0)),n=!0,t=t&&g.FullDelTrace(r),!t))break}return t&&!n&&(t=!1),t}static GetTopContainer(e){return null==e||null==e.Parent?null:e.Parent instanceof c.XBaseInputEle?g.GetTopContainer(e.Parent):e.Parent}static GetParentXInput(e,t=!1){if(null==e)return null;let n=null;if(e instanceof c.XBaseInputEle)n=e;else if(e instanceof c.XCharacterEle)n=e.GetParentInputField();else if(e instanceof c.XInputBorderEle){let r=e;n=t&&r.IsStartBorder?e.Parent.Parent instanceof c.XBaseInputEle?e.Parent.Parent:null:e.Parent instanceof c.XBaseInputEle?e.Parent:null}else if(e instanceof c.XTextTableCell){let t=g.GetCellLineContainer(e instanceof c.XTextTableCell?e:null);n=t.Parent instanceof c.XBaseInputEle?t.Parent:null}else n=e.Parent instanceof c.XBaseInputEle?e.Parent:null;if(null==n){let t=g.GetParentCell(e),r=g.GetCellLineContainer(t);null!=r&&(n=r.Parent instanceof c.XBaseInputEle?r.Parent:null)}return n}static GetCellLineContainer(e){return null==e||null==e.OwnerLine?null:e.OwnerLine.Container}static GetParentCell(e){if(null==e)return null;let t=null,n=e.Parent;for(;null!=n&&!(n instanceof c.XDocPanel);){if(n instanceof c.XTextTableCell){t=n;break}n=n.Parent}return t}static HasContent(e,t=!0){if(null==e)return!1;if(e.ChildCount<=0)return!1;let n=!1;for(let r of e.ChildEleList){if(g.IsEleRemoved(r,!t))continue;if(null==g.IsInnerChildOfXInput(r)){if(null!=(r instanceof c.XBaseContainer?r:null)){if(n=g.GetCtntChildCnt(r,t)>0,n)break}else if(t||!g.FullDelTrace(r)){n=!0;break}}}return n}static IsBdrOfXInput(e){return null!=e&&e instanceof c.XInputBorderEle}static GetTableRowOfLine(e){let t=null==e?null:e.FirstElement;if(null==t)return null;let n=t instanceof c.XTextTableCell?t:null;return null==n?null:n.Parent instanceof c.XTextTableRow?n.Parent:null}static TableAllRowsDelTrace(e){if(null==e)return!1;let t=!0;if(e instanceof c.XTextTableView){const n=e.LinesList;for(let e of n){let n=g.GetTableRowOfLine(e);if(null!=n){let e=g._ChkEleDelTrace(n);if(t=t&&e,!e)break}}}else if(e instanceof c.XTextTable)for(let n of e.Rows){let e=g._ChkEleDelTrace(n);if(t=t&&e,!e)break}return t}static CopyAllEles(e){let t=new l.List;t=g.GetAllBaseEles(e,t);return u.EmrClipboard.Copy_SelEles(t.ToArray(),!1,!0).ToArray()}static GetAllBaseEles(e,t){if(0!=e.length)for(let n=0;n<e.length;n++){let r=e[n];if(r instanceof c.XBaseContainer){let e=r.GetChildArr();t=g.GetAllBaseEles(e,t)}else t.Add(r)}return t}static GetParentHasRect(e,t=!1){let n;if(null==e||null==e.Parent)n=null;else{if(!t){let t=e.OwnerLine,r=null==t?null:t.Container;if(null!=r)return n=r,n}let r=e.Parent;for(t&&e instanceof c.XBaseContainer&&(r=e);null!=r&&!(r.CanBeInline(!1)||r instanceof c.XDocPanel);)r=r.Parent;n=r}return n}static IsFixWHRatioEle(e){return null!=e&&e instanceof c.XBaseResizableElement&&e.IsUniformScale}static GetRowFixHeight(e){if(null==e||e.LinesCnt<=0)return 0;let t=e.FixHeight;if(t<0){let n=e.EleStyle.ElePadd;t=e.LinesCnt>0?e.GetLinesHeight(!1,!1,300)/e.LinesCnt:50,t+=n.Top+n.Bottom}return t}static GetNextTableCell(e,t){let n=g.GetXTableOfCell(e);return t?n.GetNextCell(e,!0):n.GetPreCell(e,!0)}static GetParentValidWidth(e,t=!0){let n=g.GetParentHasRect(e,!1);if(null==n)return-1;if(null==e.OwnerLine)return-1;let r=0,i=e.OwnerLine.ColInx;if(i>=0){let e=n.GetColumnsParam();r=e.GetColWidth(i,96),r+=e.SumColsWidth(i,96)}r<=0&&(r=n.GetValidWidth(96));let l=0;null!=e.OwnerLine&&(l=e.OwnerLine.LineAssist.GetLineEditablePosX(96));if(r-=l+(i>0?i:0),t){r-=e.GetBoundsDPI(96).X}return r}static GetUserHistoryWrap(e){if(null==e||null==e.Document)return null;let t=e.EleStyle;if(null==t)return null;let n=new d.XUserHistoryWrap(e),r=e.Document.GetUserHistoryList(),i=t.CreatorIndex;return i>=0&&(n.AddHist=r.FindBySerno(i)),i=t.DeleterIndex,i>=0&&(n.DelHist=r.FindBySerno(i)),n}static GetToolTip(e){if(null==e)return null;let t=e.ToolTip;if(!p.default.IsNullOrEmpty(t))return t;let n=g.GetParentXInput(e,!1);return null!=n&&"FollowEleSetting"==n.TipShowRule&&(t=n.ToolTip),t}static GetElementFromLine(e,t){if(null==e)return null;let n=new l.List,r=e.GetElesIter();for(;r.MoveNext();)r.Current.EleTypeName==t&&n.Add(r.Current);return n}static GetLineContainer(e){return null==e||null==e.OwnerLine?null:e instanceof c.XBaseContainer&&e.CanBeInline(!1)?e:e.OwnerLine.Container}static PrepareParentXStr(e,t,n){const r=g.PrepareParentComm(e,t,!0),i=r[0];let l=i instanceof c.XStringEle?i:null;if(e[0]=r[1],null!=l&&l instanceof c.XStringEle)return[l,e[0]];l=new c.XStringEle,null!=t.Line.RelEleParagraphStyle&&l.EleStyle.XFontStyle.CopyFrom(t.Line.RelEleParagraphStyle.XFontStyle);let s=i.AddChildEle(e[0],l);if(null!=n){let e=new o.EleAddDelUndo(l,s,!0);n.AddItem(e)}return e[0]=0,[l,e[0]]}static PrepareParentComm(e,t,n=!1){const r=t.RefreshEleObj(!1),i=t._GetNextEle(!1,!0,!0),l=null==i?r:i,s=null==l?null:l.Parent instanceof c.XStringEle?l.Parent:null;if(g.IsBkgTextOfXInput(s))return e[0]=-1,[s,e[0]];if(null!=s)return null==i?e[0]=s.GetChildInx(r):(e[0]=1+s.GetChildInx(i),i==r&&e[0]--),[s,e[0]];e[0]=-1;return[g._FindParentToAddEle(e,r),e[0]]}static _FindParentToAddEle(e,t){let n,r,i=g.GetParentXInput(t,!1),l=t instanceof c.XInputBorderEle?t:null;return null!=i&&null!=l&&l.IsStartBorder?(n=i.Parent,r=n.GetChildInx(i)):(n=t.Parent,r=null==n?-1:n.GetChildInx(t)),e[0]=r,n}static TrySwitchXInputToNotEmpty(e,t,n,r,i){let l=null==t?null:t.Parent;if(null==l)return null;if(g.HasContent(l,!1))return null;if(null==n.EleStyle.EditForeColor||n.EleStyle.EditForeColor.IsEmpty()||(l.EleStyle.EditForeColor=n.EleStyle.EditForeColor),n instanceof c.XCharacterEle){n.EleStyle.CopyFrom(l.EleStyle,!1);let e=n.ChVal,t=new c.XStringEle;if(e.length>1)for(let r=0;r<e.length;r++){let i=new c.XCharacterEle(e[r]);i.EleStyle.CopyFrom(n.EleStyle,!1),t.AddChildEle(r,i)}else t.AddChildEle(0,n);n=t}let s=l.RemoveChild(t);if(l.AddChildEle(s,n),null!=i){let e=new a.EleReplaceUndo(t,n,s);i.AddItem(e)}if(null!=r){let t=g.GetNewCursorEle(l,s+1,e);r.ReplaceEle(t)}return n}static GetNewCursorEle(e,t,n){if(null==e)return null;let r=e.GetChildBaseEle(t,n),i=e.Parent;if(null==r&&null!=i){let t=i.GetChildInx(e);r=i.GetChildBaseEle(t+1,n)}return r}static TrySwitchXInputToEmpty(e,t,n,r,i){const l=g.IsEleRemoved(n,!1),s=g.HasContent(n,!t);if(null==n||l||s)return!1;let a=n.GetBackTextXStrEle();if(null==a)return!0;let u=g.GetXInputCtntChildIx(n);n.AddChildEle(u,a),n.EleStyle.isDefaultForeColor=!0,n.EleStyle.isDefaultBackgroundColor=!0;let h=new o.EleAddDelUndo(a,u,!0);if(i.AddItem(h),e>0&&null!=r){let i;i=127==e?g.GetNewCursorEle(n,u+1,t):a.GetChildEle(0),r.LineEleIxFocused.ReplaceEle(i)}return!0}static GetXInputCtntChildIx(e){if(null==e)return-1;let t=1,n=e.GetChildEle(1);return null!=n&&n instanceof c.XLabelEle&&n.LabelType==r.ENumXLabelType.XInputLabel&&t++,t}static UnderLineSettingIsValid(e){let t=g.GetParentXInput(e,!1),n=!1;if(null==t)n=!0;else if(t.MinSpaceNumber<=0)n=!0;else if(t.IsShowUnderLine_ShowSpace)if(null!=e&&e instanceof c.XCharacterEle){let t=e.GetInnerText(!1);n=null!=t&&!p.default.IsNullOrEmpty(t.replace(" ",""))}else n=!0;else n=!0;return n}static GetCellsInSameCol(e,t){return g.GetCellsByColInx(t,e.ColIndex)}static GetCellsByColInx(e,t){let n=new l.List;if(null==e)return n.ToArray();let r=e.Rows;if(null==r||0==r.Count())return n.ToArray();for(let e=0;e<r.Length;e++)for(let i=0;i<r.Get(e).Cells.Length;i++){let l=r.Get(e).Cells.Get(i);l.ColIndex==t&&n.Add(l)}return n.ToArray()}static GetCellsByRowInx(e,t){if(null==e)return null;let n=e.Rows;if(null==n||0==n.Count())return null;for(let e=0;e<n.Length;e++){let r=n.Get(e);if(r.Index==t)return r.Cells.ToArray()}return null}static IsHideByPatient(e,t,n,r){if(null!=e){let i=!1;e.Gender&&t&&(i=e.Gender!=t);let l=!1;return null!=e.Age&&(null!=n&&(l=Number(e.Age)>Number(n)),null!=r&&(l=l||Number(e.Age)<Number(r))),i||l}return!1}static setChildrenXBaseEleForeColorOpacity(e,t,n){if(t>=0&&t<=1)if(e instanceof c.XBaseContainer&&e.ChildCount>0){if(n||e.Attr_FgHide==n)for(let r=0;r<e.ChildEleList.Count();r++){const i=e.ChildEleList.Get(r);this.setChildrenXBaseEleForeColorOpacity(i,t,n)}}else{const n=e;let r=n.EleStyle.ForeColor.ToRgbaString();if(!p.default.IsNullOrEmpty(r)){const e=/(^\s+)|(\s+$)|\s+/g;r=r.replace(e,()=>""),r=r.replace(/[,][.0-9]+[/)]/,()=>","+t+")"),n.EleStyle.ForeColor=new f.Color(r)}}}static DyncHideParaFlg(e,t){if(null==("IScriptMsg"==t.GetType()?t:null))return!1;const n=t.Parent;let r,i=null,l=!1;const s=n.GetChildInx(t);let o=s+1;for(;o>=0;){let t=n.GetChildEle(o);if(o++,null==t)o=-1;else if(t instanceof c.XParagraphFlag&&!l)i=t.Attr_FgHide,t.Attr_FgHide=e,l=!0,r=t;else{const e=g.IsEleRemoved(t,!0),n=t.IsHidden(!1);e||n?l&&n&&(o=-1):o=-1}}if(e&&null!=r){let e=s-1;for(;e>=0;){let t=n.GetChildEle(e);if(e--,null==t)e=-1;else{const n=g.IsEleRemoved(t,!0),i=t.IsHidden(!1);t instanceof c.XParagraphFlag&&!n&&!i?e=-1:n||i||(r.Attr_FgHide=!1,e=-1)}}}null!=r&&r.Attr_FgHide!=i&&(r.IsLayoutValid=!1)}}t.XDomUtil=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PointF=void 0;class r{constructor(e,t){this.x=e,this.y=t}static get Empty(){return new r(0,0)}equals(e){return this.x===e.x&&this.y===e.y}get X(){return this.x}set X(e){this.x=e}get Y(){return this.y}set Y(e){this.y=e}Clone(){return new r(this.x,this.y)}}t.PointF=r},function(e,t,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},l=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function o(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function a(e,t){for(var n={},r=[],i=0;i<e.length;i++){var l=e[i],a=t.base?l[0]+t.base:l[0],u=n[a]||0,h="".concat(a," ").concat(u);n[a]=u+1;var d=o(h),c={css:l[1],media:l[2],sourceMap:l[3]};-1!==d?(s[d].references++,s[d].updater(c)):s.push({identifier:h,updater:m(c,t),references:1}),r.push(h)}return r}function u(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var s=l(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var h,d=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join("\n")});function c(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=d(t,i);else{var l=document.createTextNode(i),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(l,s[t]):e.appendChild(l)}}function p(e,t,n){var r=n.css,i=n.media,l=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),l&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var f=null,g=0;function m(e,t){var n,r,i;if(t.singleton){var l=g++;n=f||(f=u(t)),r=c.bind(null,n,l,!1),i=c.bind(null,n,l,!0)}else n=u(t),r=p.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=a(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=o(n[r]);s[i].references--}for(var l=a(e,t),u=0;u<n.length;u++){var h=o(n[u]);0===s[h].references&&(s[h].updater(),s.splice(h,1))}n=l}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(s=r,o=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(a," */")),l=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(l).concat([i]).join("\n")}var s,o,a;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(i[s]=!0)}for(var o=0;o<e.length;o++){var a=[].concat(e[o]);r&&i[a[0]]||(n&&(a[2]?a[2]="".concat(n," and ").concat(a[2]):a[2]=n),t.push(a))}},t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableUtil=void 0;const r=n(82),i=n(58),l=n(64),s=n(10),o=n(63),a=n(0),u=n(583),h=n(304),d=n(38),c=n(584);class p{static get StyleList(){return this._styleList}static set StyleList(e){this._styleList=e}static get DebugMode(){return this._debugMode}static GetCursorCell(e,t=!1){if(null==e)return null;if(e instanceof a.XTextTableCell)return e;const n=p.GetCursorCell(e.Parent);if(t&&null!=n){if(null!=a.XDomUtil.GetParentXInput(e,!0))return null;if(n.UserEditable)return null}return n}static GetCursorTextTable(e){if(null==e)return null;if(e instanceof a.XTextTable)return e;const t=p.GetCursorCell(e);let n;return n=null==t||null==t.Parent||null==t.Parent.Parent?null:t.Parent.Parent,n}static GetCellAlignEnum(e){let t,n;if(null==e)return t=l.XTextTableCellAlign.TOP,t;if(null!=e){if("MIDDLE"==e)return n=l.XTextTableCellAlign.MIDDLE,t=n,t;if("BOTTOM"==e)return n=l.XTextTableCellAlign.BOTTOM,t=n,t}return n=l.XTextTableCellAlign.TOP,t=n,t}static GetTextTableByCell(e){let t;return t=null==e||null==e.Parent||null==e.Parent.Parent?null:e.Parent.Parent,t}static GetTableMaxWidth(e,t){return e.GetValidWidthDPI(t)-s.DPITransUtil.TransIntVal(2,96,t)}static AllowDrawLine(e,t){let n,r=p.GetTextTableByCell(e);if(null==r)return n=!1,n;if(r.EleStyle.BorderHorizontalCenter)switch(t){case o.ORIENTATION.TOP:{let t=r.GetUpCell(e,!0);return null==t?(n=e.EleStyle.BorderTop,n):(n=e.EleStyle.BorderTop&&t.EleStyle.BorderBottom,n)}case o.ORIENTATION.BOTTOM:{let t=r.GetDownCell(e,!0);return null==t?(n=e.EleStyle.BorderBottom,n):(n=e.EleStyle.BorderBottom&&t.EleStyle.BorderTop,n)}case o.ORIENTATION.LEFT:{let t=r.GetPreCell(e,!0);return null==t?(n=e.EleStyle.BorderLeft,n):(n=e.EleStyle.BorderLeft&&t.EleStyle.BorderRight,n)}case o.ORIENTATION.RIGHT:{let t=r.GetNextCell(e,!0);return null==t?(n=e.EleStyle.BorderRight,n):(n=e.EleStyle.BorderRight&&t.EleStyle.BorderLeft,n)}}return n=!1,n}static TransformNumToAlpha(e){let t;if(e<26){let n=e%26+65;t=String.fromCodePoint(n)}else{let n=e/26,r=String.fromCodePoint(n+64),i=(e-26*n)%26+65,l=String.fromCodePoint(i);t=r.toString()+l.toString()}return t}static GetDefaultCellStyle(e){let t=new i.XBaseEleStyle(!1);t.BorderLeft=!0,t.BorderRight=!0,t.BorderTop=!0,t.BorderBottom=!0,t.SetDocument(e);const n=this.PaddingLR,l=this.PaddingTB;return t.ElePadd=new r.Padding(n,l,n,l),t}static GetCellAlignStr(e){let t;switch(e){case l.XTextTableCellAlign.MIDDLE:t="MIDDLE";break;case l.XTextTableCellAlign.BOTTOM:t="BOTTOM";break;default:t="TOP"}return t}static buildPropertiesInfo(e){if(e instanceof a.XTextTable){let t=new u.TablePropertiesInfo;return t.No=e.XID,t.IsDeleteRow=e.IsDeleteRow,t.IsDeleteTable=e.IsDeleteTable,t.IsInsertRow=e.IsInsertRow,t.IsSetColWidth=e.IsSetColWidth,t.IsSetRowHeight=e.IsSetRowHeight,t.Text_Expression=e.Text_Expression,t.Name=e.Name,t.IsPrint=e.IsPrint,t.THeadIx=e.THeadIx,t.UserEditable=e.UserEditable,t.FullPageByLastRow=e.FullPageByLastRow,t}if(e instanceof a.XTextTableCell){let t=new c.TableCellPropertiesInfo;return t.No=e.XID,t.UserEditable=e.UserEditable,t.DisSplit=e.DisSplit,t.Slashing=e.Slashing,t.ColSpan=e.ColSpan,t.RowSpan=e.RowSpan,t}}static buildBorderShadingInfo(e){let t=new h.BorderShadingInfo;return t.TopBorderLineColor=e.EleStyle.TopBorderLineColor,t.BottomBorderLineColor=e.EleStyle.BottomBorderLineColor,t.LeftBorderLineColor=e.EleStyle.LeftBorderLineColor,t.RightBorderLineColor=e.EleStyle.RightBorderLineColor,t.BorderLineWidth=e.EleStyle.EleBdrWidth,t.ShadingBackColor=e.EleStyle.BackgroundColor,t.ApplytoText=e.EleStyle.ApplytoText,t.DashStyle=e.EleStyle.DashStyle,t}static newRowIntoPreRow(e,t){if(null!=e&&e.ChildCount>0){const n=e.ChildEleList.ToArray(),r=t.ColIndex,i=t.Parent;for(let e=0;e<n.length;e++){const l=n[e];if(null!=l)if(l.ColIndex!=r){if(l.Visible){let t=i.ChildEleList.Get(e);t.Visible||(t=t.MainMergeCell),null==l.MainMergeCell&&(t.ColIndex==l.ColIndex?(t.RowSpan=t.RowSpan+1,t.RelatedMergeCell_Down.Add(l)):t.RelatedMergeCell_Right.Add(l),l.MainMergeCell=t),l.Visible=!1}}else{const e=t.Height,n=t.GetRealHeight(!1);let r=Math.round(e/2*100)/100;r<n&&(r=n),l.FixHeight=r,t.FixHeight=r,l.SetSizeDPI(-1,r,300),t.SetSizeDPI(-1,r,300)}}}}static newColIntoPreCol(e){if(null!=e){const t=e.Parent.Parent;if(null!=t&&t.ChildCount>0){const n=e.ColIndex,r=e.RowIndex,i=t.ChildEleList.ToArray();for(let e=0;e<i.length;e++){const t=i[e],l=t.Cells.Get(n+1);if(e!=r){if(l.Visible){let e=t.Cells.Get(n);e.Visible||(e=e.MainMergeCell),l.RowIndex==e.RowIndex&&(e.ColSpan=e.ColSpan+1,e.WidhtDisp+=l.Column.BoundsDISP.Width,e.SetSizeDPI(e.Bounds.Width+l.Column.Width,-1e3,300)),e.RelatedMergeCell_Right.Add(l),l.Visible=!1,l.MainMergeCell=e}}else l.Visible=!0}}}}static GetTextTableByCptID(e,t){let n,r=new d.List;if(null!=t){t.GetChildrenByCptId(e,!0,r),r.Length<=0&&t.GetChildrenByXID(e,!0,r);const i=r.ToArray();for(let e=0;e<i.length;e++){const t=i[e];if(t instanceof a.XTextTable){n=t;break}if(null==n&&null!=t){let e=t.Parent;for(;null!=e;)e instanceof a.XTextTable?(n=e,e=null):e=e.Parent}}}return n}static spanValidate(e){if(e.RowSpan>1)if(null!=e.RelatedMergeCell_Down&&e.RelatedMergeCell_Down.Length>0){let t=1;for(let n=0;n<e.RelatedMergeCell_Down.Count();n++){const r=e.RelatedMergeCell_Down.Get(n),i=r.MainMergeCell;null!=i&&i.XID==e.XID&&(r.ColIndex==e.ColIndex&&t++)}e.RowSpan=t}else e.RowSpan=1;if(e.ColSpan>1)if(null!=e.RelatedMergeCell_Right&&e.RelatedMergeCell_Right.Length>0){let t=1;for(let n=0;n<e.RelatedMergeCell_Right.Count();n++){const r=e.RelatedMergeCell_Right.Get(n),i=r.MainMergeCell;null!=i&&i.XID==e.XID&&(r.RowIndex==e.RowIndex&&t++)}e.ColSpan=t}else e.ColSpan=1}}t.XTextTableUtil=p,p._styleList=null,p._debugMode=null,p.PaddingLR=15,p.PaddingTB=10},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);t.default=class{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}Clear(){this.value=""}append(e){let t="";return t=e||0===e?"string"==typeof e?e.toString():this.encoding?r.default.castAsNonUtf8Char(e,this.encoding):String.fromCharCode(e):"",t+="",t?(t=t.replace(/\u0000/g,""),t&&(t=t.replace(/\x00/g,""))):t="",this.value+=t,this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=void 0;t.BaseComponent=class{constructor(e,t,n){this.o=t||{},this.dom=e,n||this.Render()}get React(){return this.react}set React(e){this.react=e}get Dom(){return this.dom}set Props(e){this.o=e}get Props(){return this.o}SetProp(e,t){this.o[e]=t}GetProp(e){return this.o[e]}SetState(e,t){let n={};n[e]=t,this.react.setState(n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IXUndoable=void 0;const r=n(215);class i extends r.IXCursorEleUndo{IsValid(){return!1}CanUndo(){return!1}CanRedo(){return!1}Undo(){}Redo(){}Clear(){}}t.IXUndoable=i},function(e,t,n){"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){}}}(),e.exports=n(634)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SizeF=void 0;class r{constructor(e,t){this.width=e,this.height=t}static get Empty(){return new r(0,0)}get Width(){return this.width}set Width(e){this.width=e}get Height(){return this.height}set Height(e){this.height=e}}t.SizeF=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocInitInfo=void 0;const r=n(3),i=n(11),l=n(29),s=n(7),o=n(2),a=n(37);class u{constructor(){this.MoreDocPrintSpace=14,this._viewBackColor=s.Color.FromRgba(139,139,139),this._InputBorderShowFlag=null,this._isSimulateUseWebService=!0,this._isShowParagraphFlag=!1,this._defaultCurrentTimeFlag=!0,this._DelayedChangeFlag=!1,this._DelayedChangeTime=5e3,this._JumpAll=!1,this._UseCalculatorNum=!1,this._ValidateOpenFile=!1}get ViewBackColor(){return this._viewBackColor}set ViewBackColor(e){this._viewBackColor=e}get CurrentPageBorderColor(){return this._currentPageBorderColor}set CurrentPageBorderColor(e){this._currentPageBorderColor=e}get PageBorderColor(){return this._pageBorderColor}set PageBorderColor(e){this._pageBorderColor=e}get TextSelectBgColor(){return this._textSelectBgColor}set TextSelectBgColor(e){this._textSelectBgColor=e}get InputFieldFocusColor(){return this._inputFieldFocusColor}set InputFieldFocusColor(e){this._inputFieldFocusColor=e}get InputFieldBackColor(){return this._inputFieldBackColor}set InputFieldBackColor(e){this._inputFieldBackColor=e}get InputFieldForeColor(){return this._inputFieldForeColor}set InputFieldForeColor(e){this._inputFieldForeColor=e}get BrowerForeColor(){return this._BrowerForeColor}set BrowerForeColor(e){this._BrowerForeColor=e}get InputFieldNoPassBackColor(){return this._inputFieldNoPassBackColor}set InputFieldNoPassBackColor(e){this._inputFieldNoPassBackColor=e}get InputFieldNoPassForeColor(){return this._inputFieldNoPassForeColor}set InputFieldNoPassForeColor(e){this._inputFieldNoPassForeColor=e}get InputFieldEditForeColor(){return this._inputFieldEditForeColor}set InputFieldEditForeColor(e){this._inputFieldEditForeColor=e}get TraceAddLineColor(){return this._traceAddLineColor}set TraceAddLineColor(e){this._traceAddLineColor=e}get TraceDeleteLineColor(){return this._traceDeleteLineColor}set TraceDeleteLineColor(e){this._traceDeleteLineColor=e}get InputFieldHoverColor(){return this._inputFieldHoverColor}set InputFieldHoverColor(e){this._inputFieldHoverColor=e}get InputFieldOnlyReadBorderColor(){return this._inputFieldOnlyReadBorderColor}set InputFieldOnlyReadBorderColor(e){this._inputFieldOnlyReadBorderColor=e}get InputFieldNotEnabledBorderColor(){return this._inputFieldNotEnabledBorderColor}set InputFieldNotEnabledBorderColor(e){this._inputFieldNotEnabledBorderColor=e}get InputFieldNormalBorderColor(){return this._inputFieldNormalBorderColor}set InputFieldNormalBorderColor(e){this._inputFieldNormalBorderColor=e}get InputBorderShowFlag(){return this._InputBorderShowFlag}set InputBorderShowFlag(e){this._InputBorderShowFlag=e}get InputFiledModifiedTagColor(){return this._inputFiledModifiedTagColor}set InputFiledModifiedTagColor(e){this._inputFiledModifiedTagColor=e}get InputFiledNormalTagColor(){return this._inputFiledNormalTagColor}set InputFiledNormalTagColor(e){this._inputFiledNormalTagColor=e}get InputFiledNoPassTagColor(){return this._inputFiledNoPassTagColor}set InputFiledNoPassTagColor(e){this._inputFiledNoPassTagColor=e}get PageBorderColorWithSkin(){return this._pageBorderColorWithSkin}set PageBorderColorWithSkin(e){this._pageBorderColorWithSkin=e}get IsShow_EleHideChk(){return this._isShow_EleHideChk}set IsShow_EleHideChk(e){this._isShow_EleHideChk=e}get NeedCheckChanged(){return this._needCheckChanged}set NeedCheckChanged(e){this._needCheckChanged=e}get IgnoreFieldBorderWhenPrint(){return this.ignoreFieldBorderWhenPrint}set IgnoreFieldBorderWhenPrint(e){this.ignoreFieldBorderWhenPrint=e}get IsSimulateUseWebService(){return this._isSimulateUseWebService}set IsSimulateUseWebService(e){this._isSimulateUseWebService=e}get IsShowRule(){return this._isShowRule}set IsShowRule(e){this._isShowRule=e}get BorderStyle(){return this._borderStyle}set BorderStyle(e){this._borderStyle=e}get IsShowParagraphFlag(){return this._isShowParagraphFlag}set IsShowParagraphFlag(e){this._isShowParagraphFlag=e}get CopyAcceptDataFormat(){return this._copyAcceptDataFormat}set CopyAcceptDataFormat(e){this._copyAcceptDataFormat=e}get AutoSave(){return this._autoSave}set AutoSave(e){this._autoSave=e}get AutoSaveSeconds(){return this._autoSaveSeconds}set AutoSaveSeconds(e){this._autoSaveSeconds=e}get RegisterCode(){return this._registerCode}set RegisterCode(e){this._registerCode=e}get IsStartAutoAssist(){return this._isStartAutoAssist}set IsStartAutoAssist(e){this._isStartAutoAssist=e}get InputFieldStartBorder(){return this._inputFieldStartBorder}set InputFieldStartBorder(e){this._inputFieldStartBorder=e}get ImageUrl(){return this._imageUrl?this._imageUrl:""}set ImageUrl(e){this._imageUrl=e}get DefaultCurrentTimeFlag(){return!1!==this._defaultCurrentTimeFlag}set DefaultCurrentTimeFlag(e){this._defaultCurrentTimeFlag=e}get DelayedChangeFlag(){return!0===this._DelayedChangeFlag}set DelayedChangeFlag(e){this._DelayedChangeFlag=e}get DelayedChangeTime(){return null==this._DelayedChangeTime?5e3:this._DelayedChangeTime}set DelayedChangeTime(e){this._DelayedChangeTime=e}get DelayedChangeColor(){return this._DelayedChangeColor?this._DelayedChangeColor:"#81D3f8"}set DelayedChangeColor(e){this._DelayedChangeColor=e}get PatientInfo(){return this._patientInfo}set PatientInfo(e){this._patientInfo=e}get JumpAll(){return this._JumpAll}set JumpAll(e){this._JumpAll=e}get UseCalculatorNum(){return this._UseCalculatorNum}set UseCalculatorNum(e){this._UseCalculatorNum=e}get ValidateOpenFile(){return this._ValidateOpenFile}set ValidateOpenFile(e){this._ValidateOpenFile=e}get InputFieldEndBorder(){return this._inputFieldEndBorder}set InputFieldEndBorder(e){this._inputFieldEndBorder=e}get InputFiled_IsShowTag(){return this._inputFiled_IsShowTag}set InputFiled_IsShowTag(e){this._inputFiled_IsShowTag=e}get InputFiled_IsDoctorEditorMode(){return this._inputFiled_IsDoctorEditorMode}set InputFiled_IsDoctorEditorMode(e){this._inputFiled_IsDoctorEditorMode=e}get HideMsgBox(){return this._HideMsgBox}set HideMsgBox(e){this._HideMsgBox=e}get InputMarkType(){return this._inputMarkType}set InputMarkType(e){this._inputMarkType=e}get BottomToolBar_ShowEleId(){return this._bottomToolBar_ShowEleId}set BottomToolBar_ShowEleId(e){this._bottomToolBar_ShowEleId=e}get ContinuePrintLineAutoAlign(){return this._continuePrintLineAutoAlign}set ContinuePrintLineAutoAlign(e){this._continuePrintLineAutoAlign=e}get IsHideTableCellBorder(){return this._isHideTableCellBorder}set IsHideTableCellBorder(e){this._isHideTableCellBorder=e}get IsFollowParargraphFlagInTable(){return this._isFollowParargraphFlagInTable}set IsFollowParargraphFlagInTable(e){this._isFollowParargraphFlagInTable=e}get UsingCellBorderSetting(){return this._usingCellBorderSetting}set UsingCellBorderSetting(e){this._usingCellBorderSetting=e}get IsSaveTrace(){return this._isSaveTrace}set IsSaveTrace(e){this._isSaveTrace=e}get SaveIsNeedEleValid(){return this._saveIsNeedEleValid}set SaveIsNeedEleValid(e){this._saveIsNeedEleValid=e}get AllKeyJump_ShortCutKey(){return this._allKeyJump_ShortCutKey}set AllKeyJump_ShortCutKey(e){this._allKeyJump_ShortCutKey=e}get InputFieldShowSerchBox_MaxCount(){return this._inputFieldShowSerchBox_MaxCount}set InputFieldShowSerchBox_MaxCount(e){this._inputFieldShowSerchBox_MaxCount=e}get InputFiledReadOnlyTagColor(){return this._inputFiledReadOnlyTagColor}set InputFiledReadOnlyTagColor(e){this._inputFiledReadOnlyTagColor=e}get CommentLineColor(){return this._commentLineColor}set CommentLineColor(e){this._commentLineColor=e}static GetInstance(){let e,t=null;try{u._settingDic.ContainsKey(u.EmrRunSetting)?(t=u._settingDic.Get(u.EmrRunSetting),e=t):(t=new u,u.DefaultInit(t),u._settingDic.Add(u.EmrRunSetting,t),e=t)}catch(n){e=t}return e}static DefaultInit(e){e.PageBorderColorWithSkin=!0,e.IsShow_EleHideChk=!0,e.PageBorderColor=s.Color.White,e.CommentLineColor=s.Color.Red,e.NeedCheckChanged=!0,e.ignoreFieldBorderWhenPrint=!1,e.IsShowRule=!1,e.BorderStyle=i.BorderStyle.Fixed3D,e.ViewBackColor=s.Color.FromRgba(230,230,230),e.CurrentPageBorderColor=s.Color.Red,e.IsShowParagraphFlag=!0,e.CopyAcceptDataFormat="0",e.AutoSave=!1,e.AutoSaveSeconds=10,e.RegisterCode="",e.IsStartAutoAssist=!1,e.IsStartUpAllKeyJump=!0,e.AllKeyJump_ShortCutKey=l.Keys.Return,e.InputFieldShowSerchBox_MaxCount=5,e.TextSelectBgColor=s.Color.FromRgba(0,153,229,60),e.InputFieldFocusColor=new s.Color("#30E2E2E2"),e.InputFieldHoverColor=new s.Color("#00E2E2E2"),e.InputFieldForeColor=s.Color.Black,e.InputFieldBackColor=s.Color.White,e.InputFieldNoPassForeColor=s.Color.Red,e.InputFieldNoPassBackColor=s.Color.Empty,e.InputFieldStartBorder="{",e.InputFieldEndBorder="}",e.JumpAll=!1,e.UseCalculatorNum=!1,e.InputFieldOnlyReadBorderColor=s.Color.FromRgba(140,140,140),e.InputFieldNotEnabledBorderColor=s.Color.FromRgba(140,140,140),e.InputFieldNormalBorderColor=s.Color.Black,e.InputFiledModifiedTagColor=s.Color.Blue,e.InputFiledNormalTagColor=s.Color.Transparent,e.InputFiledReadOnlyTagColor=s.Color.Gray,e.InputFiledNoPassTagColor=s.Color.Red,e.InputFiled_IsShowTag=!0,e.InputMarkType=o.XInputMarkType.SolidCircle,e.BottomToolBar_ShowEleId=!1,e.ContinuePrintLineAutoAlign=!0,e.IsHideTableCellBorder=!0,e.IsFollowParargraphFlagInTable=!1,e.UsingCellBorderSetting=!1,e.InputFiled_IsDoctorEditorMode=!1,e.InputFieldEditForeColor=e.InputFieldForeColor,e.BrowerForeColor=s.Color.Black,e.HideMsgBox=!1,e.ImageUrl="",e.DefaultCurrentTimeFlag=!0,e.DelayedChangeFlag=!1,e.DelayedChangeTime=5e3,e.DelayedChangeColor="#81D3f8",u._dateForamtDic.ContainsKey("0")||u._dateForamtDic.Add("0","yyyy-MM-dd"),u._dateForamtDic.ContainsKey("1")||u._dateForamtDic.Add("1","yyyy-MM-dd HH:mm"),u._dateForamtDic.ContainsKey("2")||u._dateForamtDic.Add("2","yyyy-MM-dd HH:mm:ss"),u._dateForamtDic.ContainsKey("3")||u._dateForamtDic.Add("3","yyyy.MM.dd HH:mm"),u._dateForamtDic.ContainsKey("4")||u._dateForamtDic.Add("4","yyyy/MM/dd HH:mm"),u._dateForamtDic.ContainsKey("5")||u._dateForamtDic.Add("5","yyyy/MM/dd HH:mm"),u._dateForamtDic.ContainsKey("6")||u._dateForamtDic.Add("6","yyyy年MM月dd日"),u._dateForamtDic.ContainsKey("7")||u._dateForamtDic.Add("7","yyyy年MM月dd日 HH时mm分"),u._dateForamtDic.ContainsKey("8")||u._dateForamtDic.Add("8","yyyy.MM.dd HH:mm"),u._dateForamtDic.ContainsKey("9")||u._dateForamtDic.Add("9","HH:mm:ss"),u._dateForamtDic.ContainsKey("10")||u._dateForamtDic.Add("10","HH:mm"),u._diagTypeDic.ContainsKey("4001")||u._diagTypeDic.Add("4001","入院诊断"),u._diagTypeDic.ContainsKey("4002")||u._diagTypeDic.Add("4002","初步诊断"),u._diagTypeDic.ContainsKey("4003")||u._diagTypeDic.Add("4003","补充诊断"),u._diagTypeDic.ContainsKey("4004")||u._diagTypeDic.Add("4004","确定诊断"),u._diagTypeDic.ContainsKey("4005")||u._diagTypeDic.Add("4005","最后诊断"),u._diagTypeDic.ContainsKey("4006")||u._diagTypeDic.Add("4006","出院诊断"),u._diagTypeDic.ContainsKey("4007")||u._diagTypeDic.Add("4007","门诊诊断"),u._diagTypeDic.ContainsKey("4008")||u._diagTypeDic.Add("4008","死亡诊断"),e.IsSaveTrace=!0,e.SaveIsNeedEleValid=!0}UpdatePatientInfo(e){this._patientInfo=e}UpdateXInputJumpType(e){this.JumpAll=!0===e}UpdateUseCalculatorNum(e){this.UseCalculatorNum=!0===e}UpdateValidateOpenFile(e){this.ValidateOpenFile=!0===e}UpdateCustom(e){if(null!=e){"middle"==e.BorderBrackets&&(this._inputFieldStartBorder="[",this._inputFieldEndBorder="]");const t=e.inputStartBorder;"string"==typeof t&&(this._inputFieldStartBorder=t);const n=e.inputEndBorder;"string"==typeof n&&(this._inputFieldEndBorder=n);const r=e.InputNormalBorderColor;null!=r&&(this._inputFieldNormalBorderColor=new s.Color(r));const i=e.InputBorderShowFlag;"boolean"==typeof i&&(this._InputBorderShowFlag=i);const l=e.FocusBgColor;null!=l&&(this._inputFieldFocusColor=new s.Color(l));const o=e.ForeColor;null!=o&&(this._inputFieldForeColor=new s.Color(o));const u=e.NoPassForeColor;null!=u&&(this._inputFieldNoPassForeColor=new s.Color(u));const h=e.BackColor;null!=h&&(this._inputFieldBackColor=new s.Color(h));const d=e.NoPassBackColor;null!=d&&(this._inputFieldNoPassBackColor=new s.Color(d));const c=e.HoverBgColor;null!=c&&(this._inputFieldHoverColor=new s.Color(c));const p=e.BgForeColor;null!=p&&(a.TextDocApiConst.InputFieldBackTextForeColor=new s.Color(p));const f=e.NoPassBgForeColor;null!=f&&(a.TextDocApiConst.InputFieldBackTextNoPassForeColor=new s.Color(f));const g=e.InputMoreSelectionEleSpliteStr;null!=g&&(a.TextDocApiConst.InputMoreSelectionEleSpliteStr=g);const m=e.HideCircle;this._inputFiled_IsShowTag=!m;const E=e.DoctorEditorMode;this._inputFiled_IsDoctorEditorMode=E;const C=e.EditForeColor;C&&(this._inputFieldEditForeColor=new s.Color(C));const A=e.traceAddLineColor;null!=A&&(this._traceAddLineColor=new s.Color(A));const y=e.traceDeleteLineColor;null!=y&&(this._traceDeleteLineColor=new s.Color(y));const I=e.HideMessageBoxComp;this._HideMsgBox=I}}UpdateImageUrl(e){this.ImageUrl=e}UpdateDefaultCurrentTimeFlag(e){this.DefaultCurrentTimeFlag=e}UpdateDelayedChangeInfo(e){if(e){let t=!0===e.DelayedChangeFlag,n=null==e.DelayedChangeColor?"#81D3f8":e.DelayedChangeColor,r=null==e.DelayedChangeTime?5e3:e.DelayedChangeTime;this.DelayedChangeFlag=t,this.DelayedChangeTime=r,this.DelayedChangeColor=n}}}t.TextDocInitInfo=u,u._dateForamtDic=new r.Dictionary,u._diagTypeDic=new r.Dictionary,u._settingDic=new r.Dictionary,u.EmrRunSetting="MedicalRecord",u.RunAsDemo=!1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseControl=void 0;const r=n(24);t.BaseControl=class{constructor(e,t){null!=e&&r.unmountComponentAtNode(e),t=t||{},this.initProps=Object.assign({},this.DefaultProps(),t)}set Component(e){this.component=e}get Component(){return this.component}get InitProps(){return this.initProps}}},function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Keys=void 0,function(e){e[e.Modifiers=-65536]="Modifiers",e[e.None=0]="None",e[e.LButton=1]="LButton",e[e.RButton=2]="RButton",e[e.Cancel=3]="Cancel",e[e.MButton=4]="MButton",e[e.XButton1=5]="XButton1",e[e.XButton2=6]="XButton2",e[e.LineFeed=10]="LineFeed",e[e.Clear=12]="Clear",e[e.Return=13]="Return",e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.ShiftKey=16]="ShiftKey",e[e.ControlKey=17]="ControlKey",e[e.Menu=18]="Menu",e[e.Pause=19]="Pause",e[e.Capital=20]="Capital",e[e.CapsLock=20]="CapsLock",e[e.KanaMode=21]="KanaMode",e[e.HanguelMode=21]="HanguelMode",e[e.HangulMode=21]="HangulMode",e[e.JunjaMode=23]="JunjaMode",e[e.FinalMode=24]="FinalMode",e[e.HanjaMode=25]="HanjaMode",e[e.KanjiMode=25]="KanjiMode",e[e.Escape=27]="Escape",e[e.IMEConvert=28]="IMEConvert",e[e.IMENonconvert=29]="IMENonconvert",e[e.IMEAccept=30]="IMEAccept",e[e.IMEAceept=30]="IMEAceept",e[e.IMEModeChange=31]="IMEModeChange",e[e.Space=32]="Space",e[e.Prior=33]="Prior",e[e.PageUp=33]="PageUp",e[e.Next=34]="Next",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.ArrowLeft=37]="ArrowLeft",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowDown=40]="ArrowDown",e[e.Select=41]="Select",e[e.Print=42]="Print",e[e.Execute=43]="Execute",e[e.Snapshot=44]="Snapshot",e[e.PrintScreen=44]="PrintScreen",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Help=47]="Help",e[e.D0=48]="D0",e[e.D1=49]="D1",e[e.D2=50]="D2",e[e.D3=51]="D3",e[e.D4=52]="D4",e[e.D5=53]="D5",e[e.D6=54]="D6",e[e.D7=55]="D7",e[e.D8=56]="D8",e[e.D9=57]="D9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.LWin=91]="LWin",e[e.RWin=92]="RWin",e[e.Apps=93]="Apps",e[e.Sleep=95]="Sleep",e[e.NumPad0=96]="NumPad0",e[e.NumPad1=97]="NumPad1",e[e.NumPad2=98]="NumPad2",e[e.NumPad3=99]="NumPad3",e[e.NumPad4=100]="NumPad4",e[e.NumPad5=101]="NumPad5",e[e.NumPad6=102]="NumPad6",e[e.NumPad7=103]="NumPad7",e[e.NumPad8=104]="NumPad8",e[e.NumPad9=105]="NumPad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Separator=108]="Separator",e[e.Subtract=109]="Subtract",e[e.Decimal=110]="Decimal",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.F13=124]="F13",e[e.F14=125]="F14",e[e.F15=126]="F15",e[e.F16=127]="F16",e[e.F17=128]="F17",e[e.F18=129]="F18",e[e.F19=130]="F19",e[e.F20=131]="F20",e[e.F21=132]="F21",e[e.F22=133]="F22",e[e.F23=134]="F23",e[e.F24=135]="F24",e[e.NumLock=144]="NumLock",e[e.Scroll=145]="Scroll",e[e.LShiftKey=160]="LShiftKey",e[e.RShiftKey=161]="RShiftKey",e[e.LControlKey=162]="LControlKey",e[e.RControlKey=163]="RControlKey",e[e.LMenu=164]="LMenu",e[e.RMenu=165]="RMenu",e[e.BrowserBack=166]="BrowserBack",e[e.BrowserForward=167]="BrowserForward",e[e.BrowserRefresh=168]="BrowserRefresh",e[e.BrowserStop=169]="BrowserStop",e[e.BrowserSearch=170]="BrowserSearch",e[e.BrowserFavorites=171]="BrowserFavorites",e[e.BrowserHome=172]="BrowserHome",e[e.VolumeMute=173]="VolumeMute",e[e.VolumeDown=174]="VolumeDown",e[e.VolumeUp=175]="VolumeUp",e[e.MediaNextTrack=176]="MediaNextTrack",e[e.MediaPreviousTrack=177]="MediaPreviousTrack",e[e.MediaStop=178]="MediaStop",e[e.MediaPlayPause=179]="MediaPlayPause",e[e.LaunchMail=180]="LaunchMail",e[e.SelectMedia=181]="SelectMedia",e[e.LaunchApplication1=182]="LaunchApplication1",e[e.LaunchApplication2=183]="LaunchApplication2",e[e.OemSemicolon=186]="OemSemicolon",e[e.Oem1=186]="Oem1",e[e.Oemplus=187]="Oemplus",e[e.Oemcomma=188]="Oemcomma",e[e.OemMinus=189]="OemMinus",e[e.OemPeriod=190]="OemPeriod",e[e.OemQuestion=191]="OemQuestion",e[e.Oem2=191]="Oem2",e[e.Oemtilde=192]="Oemtilde",e[e.Oem3=192]="Oem3",e[e.OemOpenBrackets=219]="OemOpenBrackets",e[e.Oem4=219]="Oem4",e[e.OemPipe=220]="OemPipe",e[e.Oem5=220]="Oem5",e[e.OemCloseBrackets=221]="OemCloseBrackets",e[e.Oem6=221]="Oem6",e[e.OemQuotes=222]="OemQuotes",e[e.Oem7=222]="Oem7",e[e.Oem8=223]="Oem8",e[e.OemBackslash=226]="OemBackslash",e[e.Oem102=226]="Oem102",e[e.ProcessKey=229]="ProcessKey",e[e.Packet=231]="Packet",e[e.Attn=246]="Attn",e[e.Crsel=247]="Crsel",e[e.Exsel=248]="Exsel",e[e.EraseEof=249]="EraseEof",e[e.Play=250]="Play",e[e.Zoom=251]="Zoom",e[e.NoName=252]="NoName",e[e.Pa1=253]="Pa1",e[e.OemClear=254]="OemClear",e[e.KeyCode=65535]="KeyCode",e[e.Shift=65536]="Shift",e[e.Control=131072]="Control",e[e.Alt=262144]="Alt"}(t.Keys||(t.Keys={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefineDPI=t.MergeCnt=t.PrintDelegates=t.ENumPrtColor=t.EnumPaperDir=t.ENumPaperSide=t.ENumPrtMode=t.ENumEndType=t.PrtConstDef=void 0;const r=n(11);t.PrtConstDef=class{constructor(){this.StripPpSzN="STRIP",this.CustmPpSzNO="CustomQI",this.CustmPpSzNO_CN="自定义"}},function(e){e[e.Error=0]="Error",e[e.ManualCancel=1]="ManualCancel",e[e.DoPrint=2]="DoPrint",e[e.DoExport=3]="DoExport"}(t.ENumEndType||(t.ENumEndType={})),function(e){e[e.None=0]="None",e[e.Normal=1]="Normal",e[e.Continue=2]="Continue",e[e.Patch=4]="Patch"}(t.ENumPrtMode||(t.ENumPrtMode={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.DoubleManul=2]="DoubleManul",e[e.DoubleAuto=3]="DoubleAuto"}(t.ENumPaperSide||(t.ENumPaperSide={})),function(e){e[e.None=0]="None",e[e.Vertical=1]="Vertical",e[e.Horizontal=2]="Horizontal"}(t.EnumPaperDir||(t.EnumPaperDir={})),function(e){e[e.None=0]="None",e[e.BW=1]="BW",e[e.Full=2]="Full"}(t.ENumPrtColor||(t.ENumPrtColor={}));t.PrintDelegates=class{};class i{}t.MergeCnt=i,i.Unknown_Cnt=254,i.Auto_Cnt=0;class l{constructor(){this.FontPt_DPI=72,this.CS_PrtDPI=100,this.CS_DocDPI=300}static GetOutDPI(e){let t;switch(e){case r.ENumOutTp.UI_Show:case r.ENumOutTp.UI_Print:return t=l.OS_PPI,t;case r.ENumOutTp.CsPrint:return t=96,t}return t=96,t}}t.DefineDPI=l,l.MM_DPI=25.4,l.Base_WinDPI=96,l.OS_PPI=96},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Enumerable=void 0,n(254);const r=n(419);class i{}t.Enumerable=i,i.AsEnumerable=r.asEnumerable,i.All=r.all,i.AllWithArray=r.allWithArray,i.Any=r.any,i.AnyWithArray=r.anyWithArray,i.Average=r.average,i.Concat=r.concat,i.Contains=r.contains,i.Count=r.count,i.DefaultIfEmpty=r.defaultIfEmpty,i.Distinct=r.distinct,i.ElementAt=r.elementAt,i.ElementAtOrDefault=r.elementAtOrDefault,i.Empty=r.empty,i.Except=r.except,i.First=r.first,i.FirstOrDefault=r.firstOrDefault,i.FirstOrDefaultWithArray=r.firstOrDefaultWithArray,i.GroupBy=r.groupBy,i.GroupJoin=r.groupJoin,i.Intersect=r.intersect,i.Join=r.join,i.Last=r.last,i.LastOrDefault=r.lastOrDefault,i.Max=r.max,i.Min=r.min,i.Reverse=r.reverse,i.Select=r.select,i.SelectMany=r.selectMany,i.SequenceEqual=r.sequenceEqual,i.Single=r.single,i.SingleOrDefault=r.singleOrDefault,i.Skip=r.skip,i.SkipWhile=r.skipWhile,i.Sum=r.sum,i.Take=r.take,i.TakeWhile=r.takeWhile,i.ToArray=r.toArray,i.ToDictionary=r.toDictionary,i.ToList=r.toList,i.Union=r.union,i.Where=r.where},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextLabelElement=void 0;const r=n(162),i=n(58),l=n(8),s=n(16),o=n(193),a=n(4),u=n(35),h=n(37),d=n(10);class c extends r.XLabelEle{constructor(){super(),super.formatBrushEnable=!0,this._rowDrawDic=new o.Dictionary}get EleTypeName(){return"XTextLabelElement"}CanBeInline(e=!1){if(!e)return!0;if(null!=this&&!1===this.IsPrintFlag)return!1;return!s.XDomUtil.IsBkgTextOfXInput(this)}GetInnerText(){let e=this.Text;return null==this.Text&&(e=""),e}get TitleLevel(){let e=this.propList.GetPropValue("TitleLevel");return e||(e=1),e}set TitleLevel(e){this.propList.ModifyProperty("TitleLevel",e,1)}get EleText(){let e=this.propList.GetPropValue("EleText");return null==e&&(e=1),e}get SetHideFlag(){let e=this.propList.GetPropValue("SetHideFlag");return l.CNumUtil.TryParseBool(e,!1)}set SetHideFlag(e){this.propList.ModifyProperty("SetHideFlag",e,!1)}get MaxLength(){let e=this.propList.GetPropValue("MaxLength");return l.CNumUtil.TryParseInt(e,null)}set MaxLength(e){this.propList.ModifyProperty("MaxLength",e,null)}get MinLength(){let e=this.propList.GetPropValue("MinLength");return l.CNumUtil.TryParseInt(e,null)}set MinLength(e){this.propList.ModifyProperty("MinLength",e,null)}set EleText(e){this.propList.ModifyProperty("EleText",e,"")}get Description(){let e=this.propList.GetPropValue("Description");return null==e&&(e=1),e}set Description(e){this.propList.ModifyProperty("Description",e,"")}get IsSaveFlag(){let e=this.propList.GetPropValue("IsSaveFlag");return l.CNumUtil.TryParseBool(e,!0)}set IsSaveFlag(e){this.propList.ModifyProperty("IsSaveFlag",l.CNumUtil.ToStringForBool(e),!0)}get FixPosition(){let e=this.propList.GetPropValue("FixPosition");return l.CNumUtil.TryParseBool(e,!1)}set FixPosition(e){this.propList.ModifyProperty("FixPosition",l.CNumUtil.ToStringForBool(e),!1)}get IsRequire(){let e=this.propList.GetPropValue("IsRequire");return l.CNumUtil.TryParseBool(e,!0)}set IsRequire(e){this.propList.ModifyProperty("IsRequire",l.CNumUtil.ToStringForBool(e),!0)}get IsPrintFlag(){let e=this.propList.GetPropValue("IsPrintFlag");return l.CNumUtil.TryParseBool(e,!0)}set IsPrintFlag(e){this.propList.ModifyProperty("IsPrintFlag",l.CNumUtil.ToStringForBool(e),!0)}get IsEditble(){let e=this.propList.GetPropValue("IsEditble");return l.CNumUtil.TryParseBool(e,!0)}set IsEditble(e){this.propList.ModifyProperty("IsEditble",l.CNumUtil.ToStringForBool(e),!0)}get IsDeleteFlag(){let e=this.propList.GetPropValue("IsDeleteFlag");return null==e&&(e=!1),l.CNumUtil.TryParseBool(e,!1)}set IsDeleteFlag(e){this.propList.ModifyProperty("IsDeleteFlag",l.CNumUtil.ToStringForBool(e),!1)}get TitleID(){return this.propList.GetPropValue("TitleID")}set TitleID(e){this.propList.ModifyProperty("TitleID",e,null)}get LevelTerm(){return this.propList.GetPropValue("LevelTerm")}set LevelTerm(e){this.propList.ModifyProperty("LevelTerm",e,null)}get Gender(){return this.propList.GetPropValue("Gender")}set Gender(e){this.propList.ModifyProperty("Gender",e,null)}get MaxAge(){return this.propList.GetPropValue("MaxAge")}set MaxAge(e){this.propList.ModifyProperty("MaxAge",e,null)}get MinAge(){return this.propList.GetPropValue("MinAge")}set MinAge(e){this.propList.ModifyProperty("MinAge",e,null)}initStyle(){this.EleStyle.XFontStyle.IsBold=!0,this.EleStyle.XFontStyle.DefaultStyle=new i.XBaseEleStyle(!0)}ToXML(e){if(this.IsSaveFlag){return super.ToXML(e)}}FromXML(e){super.FromXML(e)}NeedSerialized(){return!0}BulidRowDrawDic(){if(this._rowDrawDic.Clear(),!a.default.IsNullOrEmpty(this.Text)){let e=0,t="",n=1,r=super.GetBoundsDPI(96);for(let i=0;i<this.Text.length;i++){let l=this.Text[i],s=u.CommDefines.MeasureText(l.toString(),super.EleStyle.Font,96).Width;e+=s,Math.floor(e)>Math.floor(r.Width)?(this._rowDrawDic.Add(n,t),t=l.toString(),n++,e=s):t+=l}e>h.TextDocApiConst.FloatComparePrecision&&this._rowDrawDic.Add(n,t)}}GetRowDrawDic(){return this._rowDrawDic}ReCalcBaseSize(){var e;const t=null===(e=this.EleStyle)||void 0===e?void 0:e.Font;if(null==t)return;const n=this.GetEleValidWidth(!1),r=u.CommDefines.MeasureText1(this.Text,t,96).Width;if(this.preParentWidth!=n&&((r>n||r>this.preParentWidth)&&(this.IsLayoutValid=!1),this.preParentWidth=n),!this.IsLayoutValid){let e=Math.ceil(r/n);const i=d.DPITransUtil.TransFloatVal(t.SizeInPoints,72,96);if(e<=1)this.SetSizeDPI(r,i,96);else{let t=!1;const r=this.GetLineSpaceTimes(t),l=r[0];let s;if(t=r[1],t){s=e*(i+d.DPITransUtil.TransFloatVal(l,72,96))}else s=e*i*l;this.SetSizeDPI(n,s,96)}this.BulidRowDrawDic(),this.preParentWidth=this.Parent.Width,this.IsLayoutValid=!0}}GetEleValidWidth(e){let t;return t=null==this.OwnerLine?null!=this.Parent&&this.Parent.Width>0?this.Parent.GetValidWidth(96):-1:s.XDomUtil.GetParentValidWidth(this,e),t}GetLineSpaceTimes(e){if(null==this.OwnerLine||null==this.OwnerLine.RelEleParagraphStyle)return[1,e];const t=this.OwnerLine.RelEleParagraphStyle.LineSpacingStyle;return null==t||"SpaceSingle"==t?[1,e]:"Space1pt5"==t?[1.5,e]:"SpaceDouble"==t?[2,e]:"SpaceSpecify"==t?(e=!0,[this.OwnerLine.RelEleParagraphStyle.LineSpacing,!0]):"SpaceMultiple"==t?[this.OwnerLine.RelEleParagraphStyle.LineSpacing,e]:void 0}}t.XTextLabelElement=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrCalcEngine=void 0;const r=n(3),i=n(0),l=n(4),s=n(8),o=n(6),a=n(45),u=n(698),h=n(2),d=n(699),c=n(7),p=n(709),f=n(44),g=n(37),m=n(39);t.EmrCalcEngine=class{constructor(e){this.document=null,this.engine=null,this._undoMgr=null,this.document=e,this.InitEngine()}get M_UndoMgr(){return this._undoMgr}set M_UndoMgr(e){this._undoMgr=e}get DataContext(){return this.engine.DataContext}set DataContext(e){this.engine.DataContext=e}InitEngine(){null==this.engine&&(this.engine=new d.CalcEngine,this.engine.RegisterFunction("SetValue",1,2147483647,this.SetValue.bind(this)),this.engine.RegisterFunction("SetHide",1,2147483647,this.SetHide.bind(this)),this.engine.RegisterFunction("SetCanEmpty",1,2147483647,this.SetCanEmpty.bind(this)),this.engine.RegisterFunction("SetEleStyle",1,2147483647,this.SetEleStyle.bind(this)),this.engine.RegisterFunction("SetHideExt",1,2147483647,this.SetHideExt.bind(this)),this.engine.RegisterFunction("SetCheck",1,2147483647,this.SetCheck.bind(this)),this.engine.RegisterFunction("SetSize",1,2147483647,this.SetSize.bind(this)),this.engine.RegisterFunction("M_Or",1,2147483647,this.M_Or.bind(this)),this.engine.RegisterFunction("M_And",1,2147483647,this.M_And.bind(this)),this.engine.RegisterFunction("Join",1,2147483647,this.Join.bind(this)),this.engine.RegisterFunction("GetValue",1,2147483647,this.GetValue.bind(this)),this.engine.RegisterFunction("GetValueCode",1,2147483647,this.GetValueCode.bind(this)),this.engine.RegisterFunction("GetAttr",1,2147483647,this.GetAttr.bind(this)),this.engine.RegisterFunction("GetValueInt",1,2147483647,this.GetValueInt.bind(this)),this.engine.RegisterFunction("GetTime",1,2147483647,this.GetTime.bind(this)),this.engine.RegisterFunction("GetValueExt",1,2147483647,this.GetValueExt.bind(this)),this.engine.RegisterFunction("GetGrpValue",1,2147483647,this.GetGrpValue.bind(this)),this.engine.RegisterFunction("GetSumGrp",1,2147483647,this.GetSumGrp.bind(this)),this.engine.RegisterFunction("CalcTimes",1,2147483647,this.CalcTimes.bind(this)),this.engine.RegisterFunction("Compare",1,2147483647,this.Compare.bind(this)),this.engine.RegisterFunction("CompareAge",1,2147483647,this.CompareAge.bind(this)),this.engine.RegisterFunction("CompareExt",1,2147483647,this.CompareExt.bind(this)),this.engine.RegisterFunction("IsHide",1,2147483647,this.IsHide.bind(this)),this.engine.RegisterFunction("IsCheck",1,2147483647,this.IsCheck.bind(this)),this.engine.RegisterFunction("IsCheckGrp",1,2147483647,this.IsCheckGrp.bind(this)),this.engine.RegisterFunction("Reverse",1,2147483647,this.Reverse.bind(this)),this.engine.RegisterFunction("Follow",1,2147483647,this.Follow.bind(this)),this.engine.DataContext=null)}CalcExpress(e,t){if(l.default.IsNullOrEmpty(e))return null;this._undoGrp=t;let n=null;try{n=this.engine.Parse(e).Evaluate()}catch(e){n=null}return n}SetCheck(e){const t=e.Count()-1;let n=this.BulidRevEleList(e,t);const r=e.Get(t).Evaluate(),l=s.CNumUtil.TryParseBool(r,!1);return n.ToArray().forEach(e=>{let t=e instanceof i.XBaseChoiceEle?e:null;null!=t&&(t.Checked=l)}),{0:!0}}Reverse(e){let t;if(null==e.Get(0))t=!1;else{t=!s.CNumUtil.TryParseBool(e.Get(0).Evaluate(),!1)}return t}IsHide(e){let t;if(null==e.Get(0))t=!1;else{let n=e.Get(0).Evaluate().toString(),i=new r.List;this.GetEleByGrpId_Doc(n,!0,i),0==i.Count()&&this.GetEleByXID_Doc(n,i);let l=!1;i.Count()>0&&(l=i.Get(0).Attr_FgHide),t=l}return t}IsCheck(e){let t;if(null==e.Get(0))t=null;else{let n=e.Get(0).Evaluate().toString(),l=new r.List;this.GetEleByGrpId_Doc(n,!0,l),0==l.Count()&&this.GetEleByXID_Doc(n,l);let s=!1;if(l.Count()>0){let e=l.Get(0);null!=e&&e instanceof i.XBaseChoiceEle&&(s=e.Checked)}t=s?1:0}return t}IsCheckGrp(e){let t;if(null==e.Get(0))t=null;else{let n=e.Get(0).Evaluate().toString(),l=new r.List;if(this.GetEleByGrpId_Doc(n,!0,l),0==l.Count())t=!1;else{let e=!0,n=!1;l.ToArray().forEach(t=>{null!=t&&t instanceof i.XBaseChoiceEle&&(n=!0,t.Checked||(e=!1))}),t=n&&e?l.Count():0}}return t}SetValue(e){const t=e.Get(0).Evaluate().toString();let n,i=e.Get(1).Evaluate();if(null==i)n=!1;else{let e="";e=i instanceof Array?i[0].toString():i.toString();let l=new r.List;this.GetXDocBody().GetChildrenByGrpID(t,!0,l,!0),l.ToArray().forEach(t=>{"IScriptMsg"==t.GetType()&&t.UpdateInnerText(e,null)}),n=!0}return n}SetHide(e){let t;if(e.Count()<2)t=!0;else{const n=e.Count()-1,r=this.BulidRevEleList(e,n),i=e.Get(n).Evaluate(),l=s.CNumUtil.TryParseBool(i,!1);this.I_SetHide(r,l),t=!0}return t}SetCanEmpty(e){let t;if(e.Count()<2)t=!0;else{const n=e.Count()-1,r=this.BulidRevEleList(e,n),i=e.Get(n).Evaluate(),l=s.CNumUtil.TryParseBool(i,!1);this.I_SetAttr(r,l,"CanEmpty"),t=!0}return t}SetHideExt(e){let t;if(e.Count()<3)t=!0;else{const n=e.Count()-1,l=this.BulidRevEleList(e,n-1),o=e.Get(n).Evaluate(),a=s.CNumUtil.TryParseBool(o,!1);a&&this.I_SetHide(l,a);let u=this.DataContext;if(null!=u&&u instanceof i.XBaseElement){const i=e.Get(n-1).Evaluate(),l=s.CNumUtil.TryParseBool(i,!1);let o=new r.List;o.Add(u),this.I_SetHide(o,l),t=!0}else t=!0}return t}GetValue(e){if(null==e.Get(0))return null;let t=e.Get(0).Evaluate().toString(),n=new r.List;this.GetEleByGrpId_Doc(t,!0,n),0==n.Count()&&this.GetEleByXID_Doc(t,n);let i="";if(n.Count()>0){const e=n.Get(0);if(i=this.GetScriptInnerValue(e),null!=e&&i){const t="XInputField"==e.EleTypeName,n=e,r=null!=n.DataSrc&&1==n.DataSrc.MultiSelect&&n.DataSrc.DataCnt>0;if(t&&r){const e=g.TextDocApiConst.InputHaveNoEleSpliteStr,t=g.TextDocApiConst.InputMoreSelectionEleSpliteStr;let n=i.split(new RegExp("["+e+t+"]","g"));return[i,n]}}}return i}GetValueInt(e){let t=this.GetValue(e).toString();return s.CNumUtil.TryParseDouble(t,0)}GetTime(e){if(null==e.Get(0))return null;let t=e.Get(0).Evaluate().toString(),n=new r.List;this.GetEleByGrpId_Doc(t,!0,n),0==n.Count()&&this.GetEleByXID_Doc(t,n);let l="";if(n.Count()>0){const e=n.Get(0);if(null!=e&&e instanceof i.XInputEle&&(l=e.DateTimeValue,l))return this.CalcTimesFormat=e.DisplayFormat.Format,new Date(l).getTime()/1e3}return 0}GetValueCode(e){if(null==e.Get(0))return null;let t=e.Get(0).Evaluate().toString(),n=new r.List;this.GetEleByGrpId_Doc(t,!0,n),0==n.Count()&&this.GetEleByXID_Doc(t,n);let i="";if(n.Count()>0){const e=n.Get(0);if(null!=e&&"XInputField"==e.EleTypeName){const t=e.getDatasCode();null!=t&&(i=t)}}return i}GetAttr(e){if(null==e||e.Count()<2)return null;let t=e.Get(0).Evaluate().toString();if(!t)return null;let n=e.Get(1).Evaluate().toString();if(!n)return null;let i=new r.List;if(this.GetEleByXID_Doc(t,i),0==i.Count()&&this.GetEleByGrpId_Doc(t,!0,i),0==i.Count())return null;const l=i.Get(0);return null==l?null:l[n]}GetGrpValue(e){if(0==e.Count())return"";let t=e.Get(0).Evaluate().toString();if(l.default.IsNullOrEmpty(t))return"";let n=t.split(","),i="";for(let e=0;e<n.length;e++){let t=n[e],l=new r.List;this.GetEleByGrpIdOrXId_Doc(t,l),0!=l.Count()&&l.ToArray().forEach(e=>{let t=this.GetScriptInnerValue(e);i+=t})}return i}GetValueExt(e){let t;if(e.Count()<2)t="";else{t=s.CNumUtil.TryParseBool(e.Get(0).Evaluate(),!1)?e.Get(1).Evaluate().toString():e.Count()>2?e.Get(2).Evaluate().toString():""}return t}GetSumGrp(e){let t;if(0==e.Count())t="";else{let n=e.Get(0).Evaluate().toString();if(l.default.IsNullOrEmpty(n))t="";else{let e=n.split(","),i=0,l=e;for(let e=0;e<l.length;e++){let t=l[e],n=new r.List;this.GetEleByGrpIdOrXId_Doc(t,n),0!=n.Count()&&n.ToArray().forEach(e=>{let t=this.GetScriptInnerValue_Float(e);i+=t})}t=i}}return t}Compare(e){let t;if(null==e.Get(0)||null==e.Get(1))t=!1;else{let n,r=e.Get(0).Evaluate(),i=e.Get(1).Evaluate().toString();r instanceof Array?(n=r[1],r=r[0].toString()):r=r.toString(),t=r==i||null!=n&&-1!=n.indexOf(i)}return t}CompareAge(e){let t;if(null==e||e.Count()<3)t=!1;else if(null==e.Get(0)||null==e.Get(1))t=!1;else{let n=e.Get(0).Evaluate().toString(),r=e.Get(1).Evaluate().toString(),i=e.Get(2).Evaluate().toString();if(l.default.IsNullOrEmpty(i))t=!1;else{const e=/(^\s+)|(\s+$)|\s+/g;null!=i&&"string"==typeof i&&(i=i.replace(e,()=>""));let l=p.XapFunc.CompareAge(n,r);t=null==l?null:l>0?">"==i:l<0?"<"==i:"="==i}}return t}CompareExt(e){let t;if(null==e||e.Count()<3)t=null;else if(null==e.Get(0)||null==e.Get(1))t=null;else{const n=1*e.Get(0).Evaluate().toString();let r=e.Get(1).Evaluate().toString();const i=1*e.Get(2).Evaluate().toString();if(l.default.IsNullOrEmpty(r))t=null;else if(isNaN(n)||isNaN(i))t=null;else{const e=/(^\s+)|(\s+$)|\s+/g;null!=r&&"string"==typeof r&&(r=r.replace(e,()=>""));const l=n-i;t=l>0?">"==r:l<0?"<"==r:"="==r}}return t}SetSize(e){let t;if(null==e||e.Count()<2)t=!1;else{const n=e.Count()-1;let i=e.Get(n).Evaluate();if(i=i.toString(),l.default.IsNullOrEmpty(i))t=!1;else{let i=null,l=new r.List;const s=e.Get(n);l.Add(s);let o=this.BulidRevEleList(l,1);if(o.Count()>0&&(i=o.Get(0)),null==i)t=!1;else{let n=this.BulidRevEleList(e,e.Count()-1);"XTextTable"==i.EleTypeName&&this.SyncSize_TableEle(i,n),t=!0}}}return t}Follow(e){let t;return t=!(null==e||e.Count()<1)&&e.Get(0).Evaluate(),t}M_And(e){let t;if(null==e||e.Count()<1)t=!1;else{let n=0,r=!1;do{const t=e.Get(n).Evaluate();r=s.CNumUtil.TryParseBool(t,!1),n++}while(r&&n<e.Count());t=r}return t}M_Or(e){let t;if(null==e||e.Count()<1)t=!1;else{let n=0,r=!1;for(;!r&&n<e.Count();){const t=e.Get(n).Evaluate();r=s.CNumUtil.TryParseBool(t,!1),n++}t=r}return t}Join(e){let t;if(null==e)t="";else{let n="";e.ToArray().forEach(e=>{n+=e.Evaluate()}),t=n}return t}CalcTimes(e){if(null==e||e.Count()<2)return"";let t=e.Get(0).Evaluate();if(t=Number(t),isNaN(t))return"";let n=e.Get(1).Evaluate().toString();if(!n)return"";switch(n){case"day":t=t/3600/24,s.CNumUtil.Round(t,2,!0);break;case"hour":t/=3600,s.CNumUtil.Round(t,2,!0);break;case"minute":t/=60,s.CNumUtil.Round(t,2,!0);break;case"second":break;case"date":n=this.CalcTimesFormat;default:if(!m.DateTime.getReg(n)){t="";break}if(t<63072e4){const e=s.CNumUtil.Round(t/3600,0,!1),r=s.CNumUtil.Round(t%3600/60,0,!1),i=s.CNumUtil.Round(t%3600%60,0,!1);t="HH时mm分"==n?e+"时"+r+"分":"HH:mm"==n?e+":"+r:"HH:mm:ss"==n?e+":"+r+":"+i:s.CNumUtil.Round(t/3600,2,!0);break}let e=new m.DateTime;e.Value=new Date(1e3*t),t=e.ToString(n)}return t}SetEleStyle(e){if(e.Count()<4)return!1;let t=this.GetValidIdList(e,3);const n=e.Get(e.Count()-3).Evaluate();let i;if(s.CNumUtil.TryParseBool(n,!1)){const t=e.Get(e.Count()-2).Evaluate().toString();i=this.AnalyFontStyleStr(t)}else{const t=e.Get(e.Count()-1).Evaluate().toString();i=this.AnalyFontStyleStr(t)}let l=new r.List;for(let e=0;e<t.Count();e++){const n=t.Get(e);this.GetEleByGrpIdOrXId_Doc(n,l)}return this.SyscEleStyle(i,l.ToArray()),!0}AnalyFontStyleStr(e){let t=new r.Dictionary;const n=new RegExp("(\\[.*?\\])","g"),i=e.match(n);if(null!=i)for(let e=0;e<i.length;e++){let n=i[e];if(!l.default.IsNullOrEmpty(n)){n=n.replace("[",""),n=n.replace("]","");let e=n.split("_");2==e.length&&t.Add(e[0],e[1])}}return t}SyscEleStyle(e,t){if(null!=e&&0!=e.Count()&&null!=t&&0!=t.length){let n=new r.List;i.XDomUtil.GetAllBaseEles(t,n),n.ToArray().forEach(t=>{for(let n of e){const e=n.Key,r=n.Value;switch(e){case"FontName":t.EleStyle.XFontStyle.FontName=r,t.NotifyLayoutChanged(!0,!1);break;case"FontSize":t.EleStyle.XFontStyle.FontSize=s.CNumUtil.TryParseFloat(r,14),t.NotifyLayoutChanged(!0,!1);break;case"IsBold":t.EleStyle.XFontStyle.IsBold=s.CNumUtil.TryParseBool(r,!1),t.NotifyLayoutChanged(!0,!1);break;case"IsItalic":t.EleStyle.XFontStyle.IsItalic=s.CNumUtil.TryParseBool(r,!1),t.NotifyLayoutChanged(!0,!1);break;case"IsUnderLine":t.EleStyle.XFontStyle.IsUnderline=s.CNumUtil.TryParseBool(r,!1),t.NotifyLayoutChanged(!0,!1);break;case"IsDeleteLine":t.EleStyle.XFontStyle.IsStrikeout=s.CNumUtil.TryParseBool(r,!1),t.NotifyLayoutChanged(!0,!1);break;case"ForeColor":{const e=new c.Color(r);e.IsEmpty()||(t.EleStyle.ForeColor=e,t.NotifyLayoutChanged(!0,!1));break}case"BackColor":{const e=new c.Color(r);e.IsEmpty()||(t.EleStyle.BackgroundColor=e,t.NotifyLayoutChanged(!0,!1));break}case"IsSup":t.EleStyle.Superscript=s.CNumUtil.TryParseBool(r,!1),t.NotifyLayoutChanged(!0,!1);break;case"IsSub":t.EleStyle.Subscript=s.CNumUtil.TryParseBool(r,!1),t.NotifyLayoutChanged(!0,!1)}}})}}I_SetHide(e,t){e.ToArray().forEach(e=>{let n="IScriptMsg"==e.GetType()?e:null;if(null!=n&&n.Attr_FgHide!=t){this.I_AddEleAttrUnDoReDo(e,"hide",n.Attr_FgHide,t,!1),"function"==typeof n.UpdateEleAttrFgHide&&n.UpdateEleAttrFgHide(t,this._undoGrp),e.NotifyLayoutChanged(!0,!1),i.XDomUtil.DyncHideParaFlg(t,e);let r=1;this.document.GetDocCtxt().EmrWorkMode==h.ENumWorkMode.Design&&n.Attr_FgHide&&(r=.25),i.XDomUtil.setChildrenXBaseEleForeColorOpacity(n,r,t)}})}I_SetAttr(e,t,n){l.default.IsNullOrEmpty(n)||e.ToArray().forEach(e=>{let r="IScriptMsg"==e.GetType()?e:null;if(null!=r&&r[n]!=t){this.I_AddEleAttrUnDoReDo(e,n,r[n],t,!1),r[n]=t;const i=r;f.TextDocApiUtil.M_InnerEleExcScrExp(i,r.Document,this._undoGrp),e.NotifyLayoutChanged(!0,!1)}})}GetScriptInnerValue(e){let t;if(null==e)t="";else{let n=null;"IScriptMsg"==e.GetType()&&(n=e),t=null==n?"":n.ScriptInnerValue}return t}GetScriptInnerValue_Float(e){const t=this.GetScriptInnerValue(e);return s.CNumUtil.TryParseFloat(t,0)}BulidRevEleList(e,t){let n=new r.List;for(let i=0;i<t;i++){let t=new r.List;const l=e.Get(i).Evaluate().toString();this.GetEleByXID_Doc(l,t),0==t.Count()&&this.GetEleByGrpId_Doc(l,!0,t),n.AddRange(t)}return n}I_AddEleAttrUnDoReDo(e,t,n,r,i){if(null!=this._undoGrp){let l=new u.EleAttrUndo(e,t,n,r,i);this._undoGrp.AddItem(l)}}GetEleByGrpIdOrXId_Doc(e,t){this.GetEleByGrpId_Doc(e,!0,t),0==t.Count()&&this.GetEleByXID_Doc(e,t)}GetEleByXID_Doc(e,t){this.GetChildrenByXID(e,!0,t,this.GetXDocBody()),this.GetChildrenByXID(e,!0,t,this.GetXDocHeader()),this.GetChildrenByXID(e,!0,t,this.GetXDocFooter())}GetEleByGrpId_Doc(e,t,n){this.GetXDocHeader().GetChildrenByGrpID(e,t,n,!0),this.GetXDocBody().GetChildrenByGrpID(e,t,n,!0),this.GetXDocFooter().GetChildrenByGrpID(e,t,n,!0)}GetChildrenByXID(e,t,n,r){const s=r.GetChildIter();for(;s.MoveNext();){const r=s.Current,o=r instanceof i.XBaseContainer?r:null;(null==o||i.XDomUtil.HasValidChild(o))&&(l.default.Equals(e,r.XID)&&n.Add(r),t&&null!=o&&this.GetChildrenByXID(e,!0,n,o))}}GetValidIdList(e,t){let n,i=new r.List;if(e.Count()-t<0)n=i;else{for(let n=0;n<e.Count()-t;n++){let t=e.Get(n).Evaluate().toString();i.Add(t)}n=i}return n}GetXDocFooter(){return this.document.GetPagePanel(o.ENumPagePanelTp.Footer)}GetXDocHeader(){return this.document.GetPagePanel(o.ENumPagePanelTp.Header)}GetXDocBody(){return this.document.GetPagePanel(o.ENumPagePanelTp.Body)}SyncSize_TableEle(e,t){if(null!=t&&0!=t.Count()&&null!=e&&e instanceof a.XTextTable&&null!=e.Columns&&0!=e.Columns.Count()&&null!=e.Rows&&0!=e.Rows.Count())for(let n=0;n<t.Count();n++){const r=t.Get(n);if(null!=r&&r instanceof a.XTextTable&&null!=r.Columns&&0!=r.Columns.Count()&&null!=r.Rows&&0!=r.Rows.Count()&&r.Rows.Count()==e.Rows.Count()&&r.Columns.Count()==e.Columns.Count()){r.SetSizeDISP(e.BoundsDISP.Width,e.BoundsDISP.Height),r.SetSizeDPI(e.Bounds.Width,e.Bounds.Height,300);for(let t=0;t<r.Columns.Count();t++)r.Columns.Get(t).Width=e.Columns.Get(t).Width,r.Columns.Get(t).SetSizeDISP(e.Columns.Get(t).BoundsDISP.Width,e.Columns.Get(t).BoundsDISP.Height);for(let t=0;t<r.Rows.Count();t++)if(null!=r.Rows.Get(t)&&null!=r.Rows.Get(t).Cells&&0!=r.Rows.Get(t).Cells.Count())for(let n=0;n<r.Rows.Get(t).Cells.Count();n++)r.Rows.Get(t).Cells.Get(n).WidhtDisp=r.Rows.Get(t).Cells.Get(n).Column.WidthDisp,r.Rows.Get(t).Cells.Get(n).SetSizeDPI(e.Rows.Get(t).Cells.Get(n).Width,e.Rows.Get(t).Cells.Get(n).Height,300),r.Rows.Get(t).Cells.Get(n).SetPositionDISP(e.Rows.Get(t).Cells.Get(n).BoundsDISP.X,-1e3),r.Rows.Get(t).Cells.Get(n).PreFixHeight=e.Rows.Get(t).Cells.Get(n).PreFixHeight,r.Rows.Get(t).Cells.Get(n).PreFixHeight_Disp=e.Rows.Get(t).Cells.Get(n).PreFixHeight_Disp,r.Rows.Get(t).Cells.Get(n).FixHeight=e.Rows.Get(t).Cells.Get(n).FixHeight,r.Rows.Get(t).Cells.Get(n).FixHeight_Disp=e.Rows.Get(t).Cells.Get(n).FixHeight_Disp,r.Rows.Get(t).Cells.Get(n).NewFixHeight=e.Rows.Get(t).Cells.Get(n).NewFixHeight,r.Rows.Get(t).Cells.Get(n).NewFixHeight_Disp=e.Rows.Get(t).Cells.Get(n).NewFixHeight_Disp;r.NotifyLayoutChanged(!0,!0)}}}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Symbology=void 0,function(e){e[e.AZTEC=0]="AZTEC",e[e.CODABAR=1]="CODABAR",e[e.CODE_39=2]="CODE_39",e[e.CODE_93=3]="CODE_93",e[e.CODE_128=4]="CODE_128",e[e.DATA_MATRIX=5]="DATA_MATRIX",e[e.EAN_8=6]="EAN_8",e[e.EAN_13=7]="EAN_13",e[e.ITF=8]="ITF",e[e.MAXICODE=9]="MAXICODE",e[e.PDF_417=10]="PDF_417",e[e.QR_CODE=11]="QR_CODE",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"}(r||(r={})),t.default=r,function(e){e[e.Code39=0]="Code39",e[e.Code39Extd=1]="Code39Extd",e[e.Code93=2]="Code93",e[e.Code128Auto=3]="Code128Auto",e[e.Code128A=4]="Code128A",e[e.Code128B=5]="Code128B",e[e.Code128C=6]="Code128C",e[e.GS1128=7]="GS1128",e[e.HIBC128=8]="HIBC128",e[e.HIBC39=9]="HIBC39",e[e.Code2of5=10]="Code2of5",e[e.CodeI2of5=11]="CodeI2of5",e[e.ITF14=12]="ITF14",e[e.Codabar=13]="Codabar",e[e.MSI=14]="MSI",e[e.Code11=15]="Code11",e[e.ISBN=16]="ISBN",e[e.EAN13=17]="EAN13",e[e.EAN8=18]="EAN8",e[e.UPCA=19]="UPCA",e[e.UPCE=20]="UPCE"}(t.Symbology||(t.Symbology={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommDefines=t.CmmtLayout=void 0;const r=n(3),i=n(25),l=n(39),s=n(4),o=n(43);class a{}t.CmmtLayout=a,a.Cmmt_TitleHeight=50,a.RootCmmt_PaddLeft=20,a.SubCmmt_PaddLeft=50;class u{static IsNumBetween(e,t,n){let r,i=u.CmprNumVal(e,t,.001);return i<0?r=!1:(i=u.CmprNumVal(e,n,.001),r=i<=0),r}static CmprNumVal(e,t,n=.001){let r,i=e-t;return r=i<-n?-1:i>n?1:0,r}static GetFontFamilies(){let e;return null!=u._fontNameList?(e=u._fontNameList,e):(u._fontNameList=new r.List,e=u._fontNameList,e)}static CalcTabSpaceRealWidth(e){let t;if(e<0)t=0;else{let n=22*u.TabSpaceBitCnt,r=e/n+.99;0==e%n&&r++,t=r*n-e}return t}static GetEmrNextSer(){return this.emrser_int++}static Round(e,t=0,n=!0){t<0&&(t=0);let r=1;for(;t-- >0;)r*=10;return(e*r+(n?.5:0))/r}static TryParseInt(e,t){let n;if(null==e)n=t;else if(e instanceof Number)n=parseInt(e.toString());else if(e instanceof String){let r=e.toString();s.default.IsNullOrEmpty(r)&&(n=t)}else n=t;return n}static MeasureText(e,t,n=96){let r=o.GrapUtil.MeasureStrSize(null,t,0,e),l=i.SizeF.Empty;return u.TransSizeF(r,96,l,n),l}static MeasureText1(e,t,n=96){let r=0,l=0;if(null!=e){const n=e.split("");for(let e=0;e<n.length;e++){const i=o.GrapUtil.MeasureStrSize(null,t,0,n[e]);r+=i.Width,l+=i.Width}}let s=new i.SizeF(r,l),a=i.SizeF.Empty;return u.TransSizeF(s,96,a,n),a}static TransSizeF(e,t,n,r){if(t<=0||r<=0||t==r)n.Width=e.Width,n.Height=e.Height;else{let i=r/t;n.Width=e.Width*i,n.Height=e.Height*i}}static ConverCmToPx(e,t){return e/2.54*t}static GetLocaTime(){return l.DateTime.Now}static ReverseString(e){let t="";if(s.default.IsNullOrEmpty(e))t=e;else{t=e.split("").reverse().join("")}return t}}t.CommDefines=u,u._fontNameList=null,u.TabSpaceBitCnt=4,u.emrser_int=0},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.MultiformatReader=t.RSSExpandedReader=t.RSS14Reader=t.Code39Reader=t.ITFReader=t.Code128Reader=t.EAN13Reader=t.OneDReader=t.AztecCodeReader=t.QRCodeEncoderQRCode=t.QRCodeEncoder=t.QRCodeDecoderErrorCorrectionLevel=t.QRCodeWriter=t.QRCodeReader=t.DataMatrixReader=t.ReedSolomonEncoder=t.ReedSolomonDecoder=t.GenericGFPoly=t.GenericGF=t.WhiteRectangleDetector=t.MathUtils=t.StringUtils=t.PerspectiveTransform=t.HybridBinarizer=t.GridSamplerInstance=t.GridSampler=t.GlobalHistogramBinarizer=t.EncodeHintType=t.DetectorResult=t.DefaultGridSampler=t.DecoderResult=t.CharacterSetECI=t.BitSource=t.BitMatrix=t.BitArray=t.RGBLuminanceSource=t.ResultMetadataType=t.Result=t.PlanarYUVLuminanceSource=t.MultiFormatWriter=t.MultiFormatReader=t.LuminanceSource=t.InvertedLuminanceSource=t.DecodeHintType=t.BinaryBitmap=t.Binarizer=t.BarcodeFormat=void 0,i(n(493),t);var l=n(34);Object.defineProperty(t,"BarcodeFormat",{enumerable:!0,get:function(){return l.default}});var s=n(267);Object.defineProperty(t,"Binarizer",{enumerable:!0,get:function(){return s.default}});var o=n(264);Object.defineProperty(t,"BinaryBitmap",{enumerable:!0,get:function(){return o.default}});var a=n(50);Object.defineProperty(t,"DecodeHintType",{enumerable:!0,get:function(){return a.default}});var u=n(126);Object.defineProperty(t,"InvertedLuminanceSource",{enumerable:!0,get:function(){return u.default}});var h=n(127);Object.defineProperty(t,"LuminanceSource",{enumerable:!0,get:function(){return h.default}});var d=n(283);Object.defineProperty(t,"MultiFormatReader",{enumerable:!0,get:function(){return d.default}});var c=n(551);Object.defineProperty(t,"MultiFormatWriter",{enumerable:!0,get:function(){return c.default}});var p=n(552);Object.defineProperty(t,"PlanarYUVLuminanceSource",{enumerable:!0,get:function(){return p.default}});var f=n(57);Object.defineProperty(t,"Result",{enumerable:!0,get:function(){return f.default}});var g=n(85);Object.defineProperty(t,"ResultMetadataType",{enumerable:!0,get:function(){return g.default}});var m=n(553);Object.defineProperty(t,"RGBLuminanceSource",{enumerable:!0,get:function(){return m.default}});var E=n(99);Object.defineProperty(t,"BitArray",{enumerable:!0,get:function(){return E.default}});var C=n(78);Object.defineProperty(t,"BitMatrix",{enumerable:!0,get:function(){return C.default}});var A=n(203);Object.defineProperty(t,"BitSource",{enumerable:!0,get:function(){return A.default}});var y=n(114);Object.defineProperty(t,"CharacterSetECI",{enumerable:!0,get:function(){return y.default}});var I=n(128);Object.defineProperty(t,"DecoderResult",{enumerable:!0,get:function(){return I.default}});var S=n(272);Object.defineProperty(t,"DefaultGridSampler",{enumerable:!0,get:function(){return S.default}});var _=n(154);Object.defineProperty(t,"DetectorResult",{enumerable:!0,get:function(){return _.default}});var w=n(158);Object.defineProperty(t,"EncodeHintType",{enumerable:!0,get:function(){return w.default}});var b=n(266);Object.defineProperty(t,"GlobalHistogramBinarizer",{enumerable:!0,get:function(){return b.default}});var x=n(273);Object.defineProperty(t,"GridSampler",{enumerable:!0,get:function(){return x.default}});var P=n(155);Object.defineProperty(t,"GridSamplerInstance",{enumerable:!0,get:function(){return P.default}});var v=n(265);Object.defineProperty(t,"HybridBinarizer",{enumerable:!0,get:function(){return v.default}});var T=n(199);Object.defineProperty(t,"PerspectiveTransform",{enumerable:!0,get:function(){return T.default}});var M=n(4);Object.defineProperty(t,"StringUtils",{enumerable:!0,get:function(){return M.default}});var L=n(72);Object.defineProperty(t,"MathUtils",{enumerable:!0,get:function(){return L.default}});var D=n(198);Object.defineProperty(t,"WhiteRectangleDetector",{enumerable:!0,get:function(){return D.default}});var R=n(101);Object.defineProperty(t,"GenericGF",{enumerable:!0,get:function(){return R.default}});var F=n(153);Object.defineProperty(t,"GenericGFPoly",{enumerable:!0,get:function(){return F.default}});var N=n(129);Object.defineProperty(t,"ReedSolomonDecoder",{enumerable:!0,get:function(){return N.default}});var B=n(293);Object.defineProperty(t,"ReedSolomonEncoder",{enumerable:!0,get:function(){return B.default}});var k=n(202);Object.defineProperty(t,"DataMatrixReader",{enumerable:!0,get:function(){return k.default}});var O=n(204);Object.defineProperty(t,"QRCodeReader",{enumerable:!0,get:function(){return O.default}});var G=n(295);Object.defineProperty(t,"QRCodeWriter",{enumerable:!0,get:function(){return G.default}});var X=n(157);Object.defineProperty(t,"QRCodeDecoderErrorCorrectionLevel",{enumerable:!0,get:function(){return X.default}});var V=n(207);Object.defineProperty(t,"QRCodeEncoder",{enumerable:!0,get:function(){return V.default}});var H=n(208);Object.defineProperty(t,"QRCodeEncoderQRCode",{enumerable:!0,get:function(){return H.default}});var U=n(197);Object.defineProperty(t,"AztecCodeReader",{enumerable:!0,get:function(){return U.default}});var W=n(86);Object.defineProperty(t,"OneDReader",{enumerable:!0,get:function(){return W.default}});var j=n(281);Object.defineProperty(t,"EAN13Reader",{enumerable:!0,get:function(){return j.default}});var z=n(275);Object.defineProperty(t,"Code128Reader",{enumerable:!0,get:function(){return z.default}});var Y=n(280);Object.defineProperty(t,"ITFReader",{enumerable:!0,get:function(){return Y.default}});var Q=n(274);Object.defineProperty(t,"Code39Reader",{enumerable:!0,get:function(){return Q.default}});var K=n(276);Object.defineProperty(t,"RSS14Reader",{enumerable:!0,get:function(){return K.default}});var q=n(554);Object.defineProperty(t,"RSSExpandedReader",{enumerable:!0,get:function(){return q.default}});var J=n(200);Object.defineProperty(t,"MultiformatReader",{enumerable:!0,get:function(){return J.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocApiConst=void 0;const r=n(7),i=n(300);class l{static get InputFieldBackTextForeColor(){return this._InputFieldBackTextForeColor}static set InputFieldBackTextForeColor(e){null!=e&&e instanceof r.Color&&(this._InputFieldBackTextForeColor=e)}static get InputFieldBackTextNoPassForeColor(){return this._InputFieldBackTextNoPassForeColor}static set InputFieldBackTextNoPassForeColor(e){null!=e&&e instanceof r.Color&&(this._InputFieldBackTextNoPassForeColor=e)}}t.TextDocApiConst=l,l.ExpIdSpliteChar="&",l.DesktopPath="",l.MachineName="",l.UserName="",l.IsCleanLoad=!1,l.ZoomStep=.1,l.MinZoomRatio=.4,l.MaxZoomRatio=3,l.FractionEleEmptyHeight=6,l.FractionLeftRightEmptyWidth=4,l.FloatComparePrecision=1e-6,l.FractionHert_LineWidth=10,l.DefaultBackTextForeColor=r.Color.FromRgba(155,155,155),l._InputFieldBackTextForeColor=r.Color.FromRgba(155,155,155),l._InputFieldBackTextNoPassForeColor=r.Color.FromRgba(155,155,155),l.MarkPointWidth=8,l.MarkPointHeight=8,l.InputFormActMode="MouseClick,Enter,MouseDblClick",l.InputFormEventActMode="Enter,MouseDblClick",l.InputHaveNoEleSpliteStr=",",l.InputMoreSelectionEleSpliteStr="、",l.InputSelectIndexSpliteChar=",",l.IsShow_DataEleTbx=!0,l.PrintSetting_EnabledValid_App=!0,l.ReadOnlyChk_EnabledValid_App=!0,l.CanDeleteChk_EnabledValid_App=!0,l.ImageSelectedMaskColor=r.Color.FromRgba(0,0,0,80),l.ImageMarkPointFillColor=r.Color.FromRgba(100,100,100),l.ImageMarkPointForbidFillColor=r.Color.FromRgba(150,150,150),l.ImageMarkPointBorderColor=r.Color.FromRgba(255,255,255),l.DiaonosisAutoGraphFormat="医生签名：[姓名]\r\n[日期]",l.FormatCursor=i.Cursors.Default,l.IsWriteLog=!1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0;const r=n(31),i=n(5),l=n(194),s=n(15),o=n(258);class a{constructor(e){this.items=[],e&&(e instanceof Array?this.items=e.map(e=>e):this.AddRange(e))}GetItems(){return this.items}GetEnumerator(){return new o.IEnumerator(this)}InsertRange(e,t){for(let n=0;n<t.length;n++)this.items.splice(e+n,0,t[n])}RemoveRange(e,t){this.items.splice(e,t)}get Length(){return this.items.length}get IsReadOnly(){return!1}Set(e,t){if(e<0||e>=this.Length)throw new i.ArgumentOutOfRangeException("index",e);this.items[e]=t}Get(e){if(e<0||e>=this.Length)throw new i.ArgumentOutOfRangeException("index",e);return this.items[e]}Add(e){this.items.push(e)}AddRange(e){if(e)for(let t of e)this.Add(t)}AsReadOnly(){return new l.ReadOnlyCollection(this)}Clear(){this.items=[]}CopyTo(e,t){let n=0;for(let r of this)e[n+++t]=r}Exists(e){return s.throws.ThrowIfNull("match",e),this.Any(e)}Find(e){return s.throws.ThrowIfNull("match",e),this.FirstOrDefault(null,e)}FindAll(e){return s.throws.ThrowIfNull("match",e),this.Where(e).ToList()}FindIndex(e,t,n){if(e<0||e>=this.Length)throw new i.ArgumentOutOfRangeException("startIndex",e);if(t<0||t>this.Length)throw new i.ArgumentOutOfRangeException("count",t);if(e+t>this.Length)throw new i.ArgumentException("startIndex + count");s.throws.ThrowIfNull("match",n);let r=this.items.length,l=0;for(let i=e;i<r&&!(++l>t);i++)if(n(this.items[i]))return i;return-1}FindLast(e){return s.throws.ThrowIfNull("match",e),this.LastOrDefault(null,e)}FindLastIndex(e,t,n){if(e<0||e>=this.Length)throw new i.ArgumentOutOfRangeException("startIndex",e);if(t<0||t>this.Length)throw new i.ArgumentOutOfRangeException("count",t);if(e+t>this.Length)throw new i.ArgumentException("startIndex + count");s.throws.ThrowIfNull("match",n);let r=0;for(let i=e;i>=0&&!(++r>t);i--)if(n(this.items[i]))return i;return-1}GetRange(e,t){if(e<0||e>=this.Length)throw new i.ArgumentOutOfRangeException("index",e);if(t<0||t>this.Length)throw new i.ArgumentOutOfRangeException("count",t);if(e+t>this.Length)throw new i.ArgumentException("index + count");return new a(function*(e,t,n){let r=e.length,i=0;for(let l=t;l<r&&!(++i>n);l++)yield e[l]}(this.items,e,t))}IndexOf(e){return this.items.findIndex(t=>t===e)}Insert(e,t){if(e<0||e>this.Length)throw new i.ArgumentOutOfRangeException("index",e);this.items.splice(e,0,t)}Remove(e){let t=this.IndexOf(e);return t>=0&&(this.RemoveAt(t),!0)}RemoveAt(e){if(e<0||e>=this.Length)throw new i.ArgumentOutOfRangeException("index",e);this.items.splice(e,1)}TrueForAll(e){return s.throws.ThrowIfNull("match",e),this.All(e)}*[Symbol.iterator](){for(let e of this.items)yield e}All(e){return r.Enumerable.AllWithArray(this.items,e)}Any(e){return r.Enumerable.AnyWithArray(this.items,e)}AsEnumerable(){return r.Enumerable.AsEnumerable(this)}Average(e){return r.Enumerable.Average(this,e)}Concat(e){return r.Enumerable.Concat(this,e)}Contains(e,t){return r.Enumerable.Contains(this,e,t)}Count(){return this.items.length}DefaultIfEmpty(e){return r.Enumerable.DefaultIfEmpty(this,e)}Distinct(e){return r.Enumerable.Distinct(this,e)}ElementAt(e){return r.Enumerable.ElementAt(this,e)}ElementAtOrDefault(e,t){return r.Enumerable.ElementAtOrDefault(this,e,t)}Except(e,t){return r.Enumerable.Except(this,e,t)}First(e){return r.Enumerable.First(this,e)}FirstOrDefault(e,t){return r.Enumerable.FirstOrDefaultWithArray(this.items,e,t)}GroupBy(e,t,n){return r.Enumerable.GroupBy(this,e,t,n)}GroupJoin(e,t,n,i,l){return r.Enumerable.GroupJoin(this,e,t,n,i,l)}Intersect(e,t){return r.Enumerable.Intersect(this,e,t)}Join(e,t,n,i,l){return r.Enumerable.Join(this,e,t,n,i,l)}Last(e){return r.Enumerable.Last(this,e)}LastOrDefault(e,t){return r.Enumerable.LastOrDefault(this,e,t)}Max(e){return r.Enumerable.Max(this,e)}Min(e){return r.Enumerable.Min(this,e)}Reverse(){return r.Enumerable.Reverse(this)}Select(e){return r.Enumerable.Select(this,e)}SelectMany(e,t){return r.Enumerable.SelectMany(this,e,t)}SequenceEqual(e,t){return r.Enumerable.SequenceEqual(this,e,t)}Single(e){return r.Enumerable.Single(this,e)}SingleOrDefault(e,t){return r.Enumerable.SingleOrDefault(this,e,t)}Skip(e){return r.Enumerable.Skip(this,e)}SkipWhile(e){return r.Enumerable.SkipWhile(this,e)}Sum(e){return r.Enumerable.Sum(this,e)}Take(e){return r.Enumerable.Take(this,e)}TakeWhile(e){return r.Enumerable.TakeWhile(this,e)}ToArray(){return r.Enumerable.ToArray(this)}ToDictionary(e,t,n){return r.Enumerable.ToDictionary(this,e,t,n)}ToList(){return r.Enumerable.ToList(this)}Union(e,t){return r.Enumerable.Union(this,e,t)}Where(e){return r.Enumerable.Where(this,e)}}t.List=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateTime=void 0;class r{constructor(){this.value=new Date}get Value(){return this.value}set Value(e){this.value=e}static resetValue(e,t,n){let r,i,l,s,o,a,u=new Date;"yyyy年"==t?r=+e.match(/\d+/g)[0]:"yyyy年MM月"==t?(r=+e.match(/\d+/g)[0],i=+e.match(/\d+/g)[1]):"yyyy年MM月dd日"==t||"yyyy-MM-dd"==t?(r=+e.match(/\d+/g)[0],i=+e.match(/\d+/g)[1],l=+e.match(/\d+/g)[2]):"yyyy年MM月dd日HH时"==t?(r=+e.match(/\d+/g)[0],i=+e.match(/\d+/g)[1],l=+e.match(/\d+/g)[2],s=+e.match(/\d+/g)[3]):"yyyy年MM月dd日HH时mm分"==t||"yyyy-MM-dd HH:mm"==t||"yyyy年MM月dd日HH:mm"==t?(r=+e.match(/\d+/g)[0],i=+e.match(/\d+/g)[1],l=+e.match(/\d+/g)[2],s=+e.match(/\d+/g)[3],o=+e.match(/\d+/g)[4]):"yyyy年MM月dd日HH时mm分ss秒"==t||"yyyy-MM-dd HH:mm:ss"==t?(r=+e.match(/\d+/g)[0],i=+e.match(/\d+/g)[1],l=+e.match(/\d+/g)[2],s=+e.match(/\d+/g)[3],o=+e.match(/\d+/g)[4],a=+e.match(/\d+/g)[5]):"HH时mm分"==t||"HH:mm"==t?(s=+e.match(/\d+/g)[0],o=+e.match(/\d+/g)[1]):"HH:mm:ss"==t&&(s=+e.match(/\d+/g)[0],o=+e.match(/\d+/g)[1],a=+e.match(/\d+/g)[2]),r&&u.setFullYear(r),i&&u.setMonth(i-1,1),l&&u.setDate(l),null!=s&&u.setHours(s),null!=o&&u.setMinutes(o),null!=a&&u.setSeconds(a),n.Value=u}static getReg(e){let t;return"yyyy年"==e?t=/^\d{4}年$/:"yyyy年MM月"==e?t=/^\d{4}年\d{2}月$/:"yyyy年MM月dd日"==e?t=/^\d{4}年\d{2}月\d{2}日$/:"yyyy-MM-dd"==e?t=/^\d{4}-\d{2}-\d{2}$/:"yyyy年MM月dd日HH时"==e?t=/^\d{4}年\d{2}月\d{2}日\d{2}时$/:"yyyy年MM月dd日HH时mm分"==e?t=/^\d{4}年\d{2}月\d{2}日\d{2}时\d{2}分$/:"yyyy-MM-dd HH:mm"==e?t=/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/:"yyyy年MM月dd日HH:mm"==e?t=/^\d{4}年\d{2}月\d{2}日\d{2}:\d{2}$/:"yyyy年MM月dd日HH时mm分ss秒"==e?t=/^\d{4}年\d{2}月\d{2}日\d{2}时\d{2}分\d{2}秒$/:"yyyy-MM-dd HH:mm:ss"==e?t=/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/:"HH时mm分"==e?t=/^\d{2}时\d{2}分$/:"HH:mm"==e?t=/^\d{2}:\d{2}$/:"HH:mm:ss"==e&&(t=/^\d{2}:\d{2}:\d{2}$/),t}static TryParse(e,t,n){let i=r.getReg(t);return!!new RegExp(i).test(e)&&(r.resetValue(e,t,n),!0)}static get Now(){return new r}ToString(e){var t={"M+":this.Value.getMonth()+1,"d+":this.Value.getDate(),"h+":this.Value.getHours()%12==0?12:this.Value.getHours()%12,"H+":this.Value.getHours(),"m+":this.Value.getMinutes(),"s+":this.Value.getSeconds(),"q+":Math.floor((this.Value.getMonth()+3)/3),S:this.Value.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.Value.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+{0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"}[this.Value.getDay()+""])),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e}Ticks(){return r.Now.Value.getTime()}static Today(){return null}static get CurentTimeString(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),l=e.getMinutes(),s=e.getSeconds(),o=(e.getMilliseconds(),t+"-");return n<10&&(o+="0"),o+=n+"-",r<10&&(o+="0"),o+=r+" ",i<10&&(o+="0"),o+=i+":",l<10&&(o+="0"),o+=l+":",s<10&&(o+="0"),o+=s}static getCurrentDateToFormat(){let e="";const t=new Date,n=t.getFullYear(),r=t.getMonth(),i=t.getDate(),l=t.getHours(),s=t.getMinutes();t.getSeconds();return e=n+"/"+(r>=10?r:"0"+r)+"/"+(i>=10?i:"0"+i)+" "+(l>=10?l:"0"+l)+":"+(s>=10?s:"0"+s),e}static TimeString(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),l=e.getMinutes(),s=e.getSeconds(),o=(e.getMilliseconds(),t+"-");return n<10&&(o+="0"),o+=n+"-",r<10&&(o+="0"),o+=r+" ",i<10&&(o+="0"),o+=i+":",l<10&&(o+="0"),o+=l+":",s<10&&(o+="0"),o+=s}}t.DateTime=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleTypeEnum=void 0,function(e){e[e.NormalEle=0]="NormalEle",e[e.SingleChoiceDropEle=1]="SingleChoiceDropEle",e[e.MoreChoiceDropEle=2]="MoreChoiceDropEle",e[e.HaveNoEle=3]="HaveNoEle",e[e.NumEle=4]="NumEle",e[e.DateEle=5]="DateEle",e[e.TextEle=6]="TextEle",e[e.SingleChoiceGroupEle=7]="SingleChoiceGroupEle",e[e.MoreChoiceGroupEle=8]="MoreChoiceGroupEle",e[e.SingleChoiceBtn=9]="SingleChoiceBtn",e[e.MoreChoiceBtn=10]="MoreChoiceBtn",e[e.SignEle=11]="SignEle",e[e.DiagnosisEle=12]="DiagnosisEle",e[e.PhaseEle=13]="PhaseEle",e[e.PrescriptionEle=14]="PrescriptionEle",e[e.SqlEle=15]="SqlEle",e[e.MacroEle=16]="MacroEle",e[e.BusinessStructEle=17]="BusinessStructEle",e[e.RefEle=18]="RefEle",e[e.QrCodeEle=19]="QrCodeEle",e[e.None=20]="None",e[e.GroupEle=21]="GroupEle"}(t.EleTypeEnum||(t.EleTypeEnum={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(72),i=n(271);class l{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof l){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*i.default.floatToIntBits(this.x)+i.default.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),r=this.distance(e[0],e[2]);let i,l,s;if(n>=t&&n>=r?(l=e[0],i=e[1],s=e[2]):r>=n&&r>=t?(l=e[1],i=e[0],s=e[2]):(l=e[2],i=e[0],s=e[1]),this.crossProductZ(i,l,s)<0){const e=i;i=s,s=e}e[0]=i,e[1]=l,e[2]=s}static distance(e,t){return r.default.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,n){const r=t.x,i=t.y;return(n.x-r)*(e.y-i)-(n.y-i)*(e.x-r)}}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XInputFactory=void 0;const r=n(44),i=n(2),l=n(0),s=n(46),o=n(221),a=n(218),u=n(217),h=n(88),d=n(80),c=n(219),p=n(4),f=n(641),g=n(650),m=n(653),E=n(37),C=n(38),A=n(664);class y{constructor(){}static GetInstance(){return null==y._instance&&(y._instance=new y),y._instance}GetSelect(e,t=null){if((t=this.InitInputFiled(e,t)).DataSrc=new u.XDataSource,t.DataSrc.EditStyle="DropdownList","7001"==e.Code_mrdetp||"7003"==e.Code_mrdetp?t.DataSrc.MultiSelect=!0:t.DataSrc.MultiSelect=!1,"7001"==e.Code_mrdetp&&(t.DataSrc.ListValueFormatString="有无列表",t.DataSrc.ListValueSeparatorChar="、",t.SetAttribute("SurePrefix",e.Su_des),t.SetAttribute("NegativePrefix",e.Ne_des)),"7003"==e.Code_mrdetp&&t.DataSrc.ListValueSeparatorChar,"7004"==e.Code_mrdetp)t.DataSrc.DynamicListItems=!0;else if(t.DataSrc.Clear(),null!=e.Valuelist&&e.Valuelist.Count()>0&&null!=e.Valuelist)for(let n=0;n<e.Valuelist.Length;n++)t.DataSrc.AddData1(e.Valuelist.Get(n));return t.SelModel=e.SelModel,t.HasSearch=e.HasSearch,t.ReBulidInputField(e.DefaultValue,null,e.DefalutValueIsChanged),t}InitInputFiled(e,t){return null==t&&(t=new h.XInputEle),t.SetAttribute("type",e.Code_mrdetp),t.SetAttribute("decode",e.Code_de),t.SetAttribute("decodeName",e.Name_de),t.SetAttribute("deValueCode",e.ValueCode_de),null!=e.Fg_hide&&t.SetAttribute("hide",e.Fg_hide.toString()),null!=e.Fg_quote&&t.SetAttribute("fgquote",e.Fg_quote.toString()),null!=e.Fg_qs&&t.SetAttribute("fgqs",e.Fg_qs.toString()),t.GrpID=e.Id_mr_de,t.InputEventName=e.InputEventName,t.CptID=e.conceptDomainCode,t.LackEllipsisvalue=e.LackEllipsisvalue,t.DynamicData=e.DynamicData,t.Attr_TypeCode=e.Code_mrdetp,t.Name=e.Name,t.IsPrint=e.IsPrint,t.IsDisSkip=e.IsDisSkip,t.QuoteSource=e.QuoteSource,t.QuoteTarget=e.QuoteTarget,t.EnableValueValidate=!0,t.Visible_Expression=e.Text_Expression,t.LabelText=e.Text_label,t.SuffixText=e.Suffix_label,t.EleToolTip=e.Text_tip,t.BackgroundText=e.Text_background,t.IsRefreshSysTime=e.IsRefreshSysTime,t.ExtendAttr1=e.ExtendAttr1,t.CustomAttribute=e.CustomAttribute,t.DefaultCurrentTimeFlag=e.DefaultCurrentTimeFlag,t.PrintCurrentTimeFlag=e.PrintCurrentTimeFlag,e.Fg_encrypt?t.SetCanSecret(i.ENumCanSecret.Yes):t.SetCanSecret(i.ENumCanSecret.Inherit),e.Fg_border?t.BorderVisible="AlwaysVisible":t.BorderVisible="Hidden",t.Deletable=e.Fg_delete,t.UserEditable=e.Fg_edit,t.CanEmpty=e.CanEmpty,t.ValueBinding=new a.XDataBinding,t.ValueBinding.DataSource=e.Name_source,t.ValueBinding.BindingPath=e.Name_property,t.ValueBinding.Readonly=!1,t.EditorActiveMode=e.Activation_Mode_Key,t.EditorEventActiveMode=e.EditorEventActiveMode,t.SetAttribute("macroEleOutStyle",e.Out_style),t.SetAttribute("macroEleOutFormat",e.Out_format),t.DefalultValue=e.DefaultValue,t.StartBorderPritnInLine=e.CanBeInLine_StartBorder,t.EndBorderPritnInLine=e.CanBeInLine_EndBorder,t.IsSensitiveInfo=e.IsSensitiveInfo,t.MinSpaceNumber=e.Occupying_Num,t.IsShowUnderLine_ShowSpace=e.IsStartUp_UnderLine,t.IsAppendWrite=e.IsAddCallBack,t.IsAllowKeyInput=e.IsAllowKeyInput,t.Gender=e.Gender,t.MaxAge=e.MaxAge,t.MinAge=e.MinAge,t}GetText(e,t=null){if((t=this.InitInputFiled(e,t)).NumExpression=e.Value_expression,t.ValidateStyle.Required=!0,t.ValidateStyle.CheckMaxValue=e.CheckMaxValue,t.ValidateStyle.CheckMinValue=e.CheckMinValue,t.ValidateStyle.MaxLength=e.Lg_max,t.ValidateStyle.MinLength=e.Lg_min,""!=e.Out_format&&""!=e.Out_style){switch(t.DisplayFormat=new c.XValueFormater,e.Out_style){case"None":t.DisplayFormat.Style=s.XValueFormatStyle.None;break;case"Numeric":t.DisplayFormat.Style=s.XValueFormatStyle.Numeric;break;case"Currency":t.DisplayFormat.Style=s.XValueFormatStyle.Currency;break;case"DateTime":t.DisplayFormat.Style=s.XValueFormatStyle.DateTime;break;case"String":t.DisplayFormat.Style=s.XValueFormatStyle.String;break;case"SpecifyLength":t.DisplayFormat.Style=s.XValueFormatStyle.SpecifyLength;break;case"Boolean":t.DisplayFormat.Style=s.XValueFormatStyle.Boolean;break;case"Percent":t.DisplayFormat.Style=s.XValueFormatStyle.Percent}t.DisplayFormat.Format=e.Out_format}return t.ReBulidInputField(e.DefaultValue,null,e.DefalutValueIsChanged),t}GetNumber(e,t=null){if((t=this.InitInputFiled(e,t)).UnitText=e.Text_unit,t.ShowDialog=e.ShowDialog,t.EditorMode=e.EditorMode,t.ValidateStyle.CheckMaxValue=e.CheckMaxValue,t.ValidateStyle.CheckMinValue=e.CheckMinValue,t.ValidateStyle.MaxValue=e.Nu_max,t.ValidateStyle.MinValue=e.Nu_min,t.ValidateStyle.MaxDecimalDigits=e.Nu_digit,t.DataSrc=new u.XDataSource,t.DataSrc.Clear(),null!=e.Text_unitList&&e.Text_unitList.Count()>0&&null!=e.Text_unitList)for(let n=0;n<e.Text_unitList.Length;n++)t.DataSrc.AddData1(e.Text_unitList.Get(n));return t.DataSrc.EditStyle="Numeric",t.ReBulidInputField(e.DefaultValue,null,e.DefalutValueIsChanged),t}GetDatetime(e,t=null){return null==(t=this.InitInputFiled(e,t)).DisplayFormat&&(t.DisplayFormat=new c.XValueFormater),t.DisplayFormat.Style=s.XValueFormatStyle.DateTime,t.DisplayFormat.Format=e.Dt_format,t.DataSrc=new u.XDataSource,t.DataSrc.EditStyle="DateTime",t.ReBulidInputField(e.DefaultValue,null,e.DefalutValueIsChanged),t}GetRadio(e,t=null){return this.GetBaseChoiceGrp(e,!1,t)}GetBaseChoiceGrp(e,t,n=null){let r;if(null==n?n=new o.XChoiceGroupEle:n.Clear(),null==e)r=n;else if(null==e.Valuelist)r=n;else if(0==e.Valuelist.Count())r=n;else{n.ElementInfo=e;for(let r=0;r<e.Valuelist.Length;r++){let i,s=e.Valuelist.Get(r);i=t?new l.XCheckBoxEle:new l.XRadioBoxEle,p.default.IsNullOrEmpty(s.GrpId)||(i.GrpID=s.GrpId),p.default.IsNullOrEmpty(s.XId)||i.SetProp("XID",s.XId),i.SetAttribute("type",e.Code_mrdetp),i.SetAttribute("decode",e.Code_de),i.SetAttribute("DecodeName",e.Name_de),i.SetAttribute("DeValueCode",e.ValueCode_de),i.GrpID=e.Id_mr_de,i.CptID=e.conceptDomainCode,i.LackEllipsisvalue=e.LackEllipsisvalue,i.DynamicData=e.DynamicData,i.Name=e.Name,i.IsPrint=e.IsPrint,i.EleToolTip=e.Text_tip,i.SourceName=e.Name_source,i.PropertyName=e.Name_property,i.Deletable=e.Fg_delete,i.CheckedValue=s.Key,i.Caption=s.Value,i.Attr_FgHide=e.Fg_hide,i.IsShowRightText=e.IsShowRightText,i.TextShowRight=e.IsTextRightShow,i.BaseChoiceShowStyle=e.BaseChoiceShowStyle,i.OnlyPrintCheckedItem=e.OnlyPrintCheckedItem,i.IsMustCheck=e.IsMustChoose,i.QuoteSource=e.QuoteSource,i.QuoteTarget=e.QuoteTarget,i.VAlign_Mark=e.VAlign,i.IsPrint=e.IsPrint,i.BaseChoiceShowStyle=e.BaseChoiceShowStyle,i.IsShowRightText=e.IsShowRightText,i.IsTextRightShow=e.IsTextRightShow,i.Grp_StrongShow=e.IsStrongShow,i.Valuelist=e.Valuelist,i.Text_Expression=e.Text_Expression,i.ExtendAttr1=e.ExtendAttr1,i.Gender=e.Gender,i.MaxAge=e.MaxAge,i.MinAge=e.MinAge,null!=e.Name_source&&null!=e.Name_property&&(i.ValueBinding=new a.XDataBinding,i.ValueBinding.DataSource=e.Name_source,i.ValueBinding.BindingPath=e.Name_property,i.ValueBinding.Readonly=!1),n.Add(i)}r=n}return r}GetCheck(e,t=null){return this.GetBaseChoiceGrp(e,!0,t)}GetCommonEle(e,t=null){let n;if(null==e)n=t;else{let r=this.InitInputFiled(e,t);"DateTime"==e.Out_style&&(r.DisplayFormat.Format=e.Out_format),r.ReBulidInputField(e.DefaultValue,null,e.DefalutValueIsChanged),n=r}return n}GetMacroInputEle(e,t=null){let n;if(p.default.IsNullOrEmpty(e.Out_style))n=this.GetCommonEle(e,t);else{let r=e.Out_style;if(null!=r){if("DateTime"==r&&(t=this.GetDatetime(e,t),!p.default.IsNullOrEmpty(e.Out_format))){let n=e.Out_format.split("|");n.length>=1&&(t.DisplayFormat.Format=n[0])}"Numberic"==r&&(t=this.GetNumber(e,t))}n=t=this.GetCommonEle(e,t)}return n}GetSqlInputEle(e,t=null){t=this.InitInputFiled(e,t);let n=e.SqlText;return p.default.IsNullOrEmpty(n)?t.SqlText="":(n=n.replace("\r\n",""),n.endsWith(";")||n.endsWith("；"),t.SqlText=n),t.Sql_WriteBack_PropName=e.Sql_WriteBack_PropName,t.ReBulidInputField(e.DefaultValue,null,e.DefalutValueIsChanged),t}GetRefEle(e,t=null){return(t=this.InitInputFiled(e,t)).RefCode=e.RefCode,t.RefName=e.RefName,t.RefActiveStyle=e.ActiveStyle,t.Attr_TypeCode="9003",t.RefIsMulSel=e.RefIsMulSel,t.RefResultFormatStr=e.RefResultFormatStr,t.RefResultIsVertLayout=e.RefResultIsVertLayout,t.LastSpliteCharShowRule=e.LastSpliteCharShowRule,t.ReBulidInputField(e.DefaultValue,null,e.DefalutValueIsChanged),t}GetBarCodeEle(e,t=null){return(t=this.InitInputFiled(e,t)).Attr_TypeCode="1003",t.IsQrCode=e.IsQrCode,t.CodeRule=e.CodeRule,t.SqlText=e.SqlText,t.BulidCodeRightNow=e.BulidCodeRightNow,t.QrCode_IsShowLabelText=e.QrCode_IsShowLabelText,t.QrCode_LabelText=e.QrCode_LabelText,t.QrCode_LabelTextPosition=e.QrCode_LabelTextPosition,t.QrCode_IsAllowDrag=e.QrCode_IsAllowDrag,t.ReBulidInputField(e.DefaultValue,null,e.DefalutValueIsChanged),t}UpdateChoiceEle(e,t){let n=!1;if(void 0!==e.GrpID&&(n=!0,t.GrpID=e.GrpID),void 0!==e.CanDel&&(n=!0,t.Deletable=e.CanDel),void 0!==e.TipText&&(n=!0,t.EleToolTip=e.TipText),void 0!==e.SourceName&&(n=!0,t.SourceName=e.SourceName),void 0!==e.PropName&&(n=!0,t.PropertyName=e.PropName),void 0!==e.EleValue&&(n=!0,t.CheckedValue=e.EleValue),void 0!==e.EleShowText&&(n=!0,t.Caption=e.EleShowText),void 0!==e.IsShowText&&(n=!0,t.IsShowRightText=e.IsShowText),void 0!==e.OnlyPrintCheckedItem&&(n=!0,t.OnlyPrintCheckedItem=e.OnlyPrintCheckedItem),void 0!==e.IsTextRightShow&&(n=!0,t.TextShowRight=e.IsTextRightShow),void 0!==e.IsHide&&(n=!0,t.Attr_FgHide=e.IsHide),void 0!==e.BaseChoiceShowStyle&&(n=!0,t.BaseChoiceShowStyle=e.BaseChoiceShowStyle),void 0!==e.Text_Expression&&(n=!0,t.Text_Expression=e.Text_Expression),void 0!==e.VAlign&&(n=!0,t.VAlign_Mark=e.VAlign),void 0!==e.IsPrint&&(n=!0,t.IsPrint=e.IsPrint),void 0!==e.conceptDomainCode&&(n=!0,t.CptID=e.conceptDomainCode),void 0!==e.Name_de&&(n=!0,t.SetAttribute("DecodeName",e.Name_de)),void 0!==e.ValueCode_de&&(n=!0,t.SetAttribute("DeValueCode",e.ValueCode_de)),void 0!==e.Grp_IsStrongShow){n=!0,t.Grp_StrongShow=e.Grp_IsStrongShow;let i=r.TextDocApiUtil.GetGrpEles(t.Document,t);for(let e=0;e<i.Length;e++){let n=i.Get(e);n.Equals(t)||(n.Grp_StrongShow=t.Grp_StrongShow)}}if(void 0!==e.Name||void 0!==e.IsMustChoose||void 0!==e.OnlyPrintCheckedItem){n=!0,t.Name=e.Name,t.IsMustCheck=e.IsMustChoose;let i=r.TextDocApiUtil.GetElesByEleGrpId(t.Document,t.GrpID,["XTextRadioBox","XTextCheckBox"]);for(let n=0;n<i.Length;n++){let r=i.Get(n);if(!t.Equals(r)){let t=r instanceof l.XBaseChoiceEle?r:null;null!=t&&(t.Name=e.Name,t.IsMustCheck=e.IsMustChoose,t.OnlyPrintCheckedItem=e.OnlyPrintCheckedItem,t.NotifyLayoutChanged(!0,!1))}}}1==n&&t.NotifyLayoutChanged(!0,!1)}GetDiagnosisEle(e,t=null){null==t&&(t=new h.XInputEle);let n={};return null!=e&&(n.type=e.Code_mrdetp,n.name=e.DiagnoseType,n.BorderVisible=e.Fg_border,n.Deletable=e.Fg_delete,n.CanEmpty=e.CanEmpty,t.CptID=e.CptID,t.MinSpaceNumber=e.Occupying_Num,t.IsShowUnderLine_ShowSpace=e.IsStartUp_UnderLine,t.IsPrint=e.IsPrint,t.DefalultValue=e.DefaultValue,t.SetAttribute("decode",e.Code_de),t.SetAttribute("decodeName",e.Name_de),t.SetAttribute("deValueCode",e.ValueCode_de),t.UserEditable=!1,t.IsDisSkip=e.IsDisSkip,t.DiagnoseType=e.DiagnoseType,t.Arrangement=e.Arrangement,t.SplitChar=e.SplitChar,t.InTable=e.InTable,t.InTableColIx=e.InTableColIx,t.CustomAttribute=e.CustomAttribute,t.InputEventName=e.InputEventName,t.EditorEventActiveMode=e.EditorEventActiveMode),t.SetAttribute("type",n.type||"4001"),t.GrpID=d.XInputUtil.GetInstance().GetUniqueCode(),t.Name=n.name||"初步诊断",t.ToolTip=n.name||"初步诊断",t.BackgroundText=n.name||"初步诊断",t.BorderVisible=n.BorderVisible?"AlwaysVisible":"false",t.CptID=e.conceptDomainCode,t.Deletable=n.Deletable||!1,t.IsAllowKeyInput=null,t.CanEmpty=n.CanEmpty||!0,t.ReBulidInputField("",null,!1),t}BulidCalendarDateControl(e){return new f.Calendar(e)}BulidCalculatorControl(e){return"Unit"==e.type?new g.Calculator(e):"Calculator"==e.type?new A.Calculator1(e):void 0}BulidDropDownMenuControl(e,t,n){const r=n.DataSrc,i=n.InnerValue;let l=new m.EmrDropDowmControl;l.IsHaveNoEle=t,l.IsMulity=e,l.inputEleXID=n.XID,l.disFreeInput=n.IsAllowKeyInput,l.HasSearch=n.HasSearch,l.AddItems(r.DataList);let s=new C.List;if(!p.default.IsNullOrEmpty(i)){const e=E.TextDocApiConst.InputMoreSelectionEleSpliteStr;let r=[];if(t){const t=E.TextDocApiConst.InputHaveNoEleSpliteStr,l=i.split(t);let s="";l.forEach(e=>{e[0]==(n.SurePrefix||"有")&&(s=e.slice(1))}),r=s.split(e)}else r=i.split(e);const o=l.DataSource.GetEnumerator();for(;o.MoveNext();){const e=o.Current;if(!(r.length>0))break;const t=r.indexOf(e.Value);-1!=t&&(r.splice(t,1),s.Add(e.Index.toString()))}}return l.SelectIndexList=s,!(s.Count()>0)&&null!=r&&null!=r.DataList&&r.DataList.Count()>0&&(l.searchText=i),l}}t.XInputFactory=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GrapUtil=void 0;const r=n(151),i=n(492),l=n(25),s=n(56),o=n(195),a=n(262),u=n(4);class h{static MeasureCharWidth(e,t,n,r){return~~(h.MeasureCharWidthF(e,t,n,r)+.999)}static MeasureStrSize(e,t,n,r){let i=h.MeasureStrSizeF(e,t,n,r);return new l.SizeF(i.Width,i.Height)}static MeasureStrSizeF(e,t,n,r){let i;if(u.default.IsNullOrEmpty(r))return i=l.SizeF.Empty,i;r=u.default.Format(".{0}.",r);let s=l.SizeF.Empty,o=l.SizeF.Empty,a=h.GetDefaultStrFormat();return null==e?(s=(e=h.GetTmpGrap()).MeasureString(r,t,n,a),o=e.MeasureString("..",t,n,a)):(s=e.MeasureString(r,t,n,a),o=e.MeasureString("..",t,n,a)),s.Width-=o.Width,i=s,i}static GetDefaultStrFormat(){let e;return null!=h.default_strfmt?(e=h.default_strfmt,e):(null==h.default_strfmt&&(h.default_strfmt=new s.StringFormat(s.StringFormat.GenericTypographic),h.default_strfmt.FormatFlags&=~o.StringFormatFlags.LineLimit,h.default_strfmt.Trimming=a.StringTrimming.EllipsisCharacter),e=h.default_strfmt,e)}static GetTmpGrap(){let e;if(null!=h.tmpGrap)e=h.tmpGrap;else{let t=i.Bitmap.FromHeightAndWidth(10,10);t.SetResolution(96,96),h.tmpGrap=r.Graphics.FromImage(t),e=h.tmpGrap}return e}static MeasureCharWidthF(e,t,n,r){" "==r?r=".":"　"==r&&(r="．");let i=l.SizeF.Empty;return i=null==e?(e=h.GetTmpGrap()).MeasureString(r,t,n,s.StringFormat.GenericTypographic):e.MeasureString(r,t,n,s.StringFormat.GenericTypographic),i.Width}static RoateGraphics(e,t,n,r){t>0&&(r?(e.RotateTransform(-t),e.TransformOrigin([0,0])):(e.RotateTransform(t),e.TransformOrigin([n.X+n.Width/2,n.Y+n.Height/2])))}}t.GrapUtil=h,h.tmpGrap=r.Graphics.Empty,h.default_strfmt=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocApiUtil=void 0;const r=n(3),i=n(0),l=n(6),s=n(2),o=n(21),a=n(4),u=n(586),h=n(65);class d{static GetInnerValue(e,t,n){let r,l=new o.default;if(!(e instanceof i.XBaseContainer))return r=e.GetInnerText(t),r;const s=e.GetChildArr();for(let e=0;e<s.length;e++){let r=s[e];if(null!=r)if(r instanceof i.XBaseContainer){let e=d.GetInnerValue(r,t,n);l.append(e)}else{let e=i.XDomUtil.GetParentXInput(r,!1);const s=e.IsInnerInputEle(r);null!=e&&s||!n&&r.IsHidden(!0)||(t||r.EleStyle.DeleterIndex<0)&&l.append(r.GetInnerText(t))}}let a=l.toString();return l.setLengthToZero(),r=a,r}static GeElementPathMapping(e){let t;return t=d.customElementMapping.ContainsKey(e)?d.customElementMapping.Get(e):"",t}static GetElesByEleGrpId(e,t,n){let i;if(a.default.IsNullOrEmpty(t))return i=null,i;null!=n&&0!=n.length||(n=["XInputField","XTextRadioBox","XTextCheckBox","XMedicalExpressionField"]);let l=d.GetElesByEleType(e,n),s=new r.List;for(let e of l)t==e.GrpID&&s.Add(e);return i=s,i}static GetElesByEleType(e,t){let n=new r.List;try{e.GetPagePanel(l.ENumPagePanelTp.Header).GetChildrenByTypes(t,!0,n),e.GetPagePanel(l.ENumPagePanelTp.Body).GetChildrenByTypes(t,!0,n),e.GetPagePanel(l.ENumPagePanelTp.Footer).GetChildrenByTypes(t,!0,n)}catch(e){}return n}static M_SetPartEleLayoutValid(e,t){let n;if(null==e)n=!1;else{try{let r=d.GetElesByEleType(e,t);if((null==r?0:r.Count())<=0)return n=!1,n;r.ToArray().forEach(e=>{e.NotifyLayoutChanged(!0,!1)})}catch(e){}n=!0}return n}static ChkInputEleCanOperator(e,t){let n,r=null;try{if(e!=s.ENumWorkMode.Design)return n=null,n;if(null==t)return n=null,n;let l=i.XDomUtil.GetParentXInput(t,!1);if(null==l)return n=null,n;if(!l.AllowOperate)return n=new Boolean(!1),n;let o=l.Parent;for(;null!=o&&!(o instanceof i.XDocPanel);){if(o instanceof i.XBaseInputEle){if(!o.AllowOperate){r=new Boolean(!1);break}}o=o.Parent}}catch(e){}return n=r,n}static GetChildrenByClassType(e,t,n,r){try{let l=r.GetChildIter();for(;l.MoveNext();){let r=l.Current,s=null;if(r instanceof i.XBaseContainer&&(s=r),null!=s&&!i.XDomUtil.HasValidChild(s))continue;e.IsAssignableFrom(r.GetType())&&n.Add(r),t&&null!=s&&d.GetChildrenByClassType(e,!0,n,s)}}catch(e){}}static GetElesByGrpIdOrXId(e,t,n){let i;if(a.default.IsNullOrEmpty(t))i=null;else{null!=n&&0!=n.length||(n=["XInputField","XTextRadioBox","XTextCheckBox","XMedicalExpressionField"].ToArray());let l=d.GetElesByEleType(e,n),s=new r.List;for(let e=0;e<l.Length;e++){let n=l[e];t!=n.GrpID&&t!=n.XID||s.Add(n)}i=s}return i}static SetPainterMapping(e,t){d.CustomPainterMapping.ContainsKey(e)||d.CustomPainterMapping.Add(e,t)}static GetGrpEles(e,t){let n,s=new r.List;try{e.GetPagePanel(l.ENumPagePanelTp.Header).GetChildrenByGrpID(t.GrpID,!0,s),e.GetPagePanel(l.ENumPagePanelTp.Body).GetChildrenByGrpID(t.GrpID,!0,s),e.GetPagePanel(l.ENumPagePanelTp.Footer).GetChildrenByGrpID(t.GrpID,!0,s),n=new r.List;for(let e=0;e<s.Length;e++)s[e]instanceof i.XBaseChoiceEle&&n.Add(s[e])}catch(e){n=null}return n}static GetPainterMapping(e){return d.CustomPainterMapping.ContainsKey(e)?d.CustomPainterMapping[e]:null}static M_InnerEleExcScrExp(e,t,n){if(null!=t){let i=new r.List;i.Add(e),null!=e.RelScriptMsgs&&e.RelScriptMsgs.length>0&&i.AddRange(e.RelScriptMsgs);for(let e=0;e<i.Count();e++){let r=i.Get(e);if(null!=r.ExpTypeArray&&0!=r.ExpTypeArray.length){const e=r.ExpTypeArray;let i=0;for(;i<e.length;){const l=e[i];let s="IL_105";s="IL_D5","IL_D5"==s&&(d.SendMessage(l,r.Id,t,n),r.IsUseXId&&d.SendMessage(l,r.XID,t,n),s="IL_105"),"IL_105"!=s||i++}}}}}static SendMessage(e,t,n,r){try{if(null!=n){let i=new u.MsgResult;n.AssistFunc.MsgBus.SendMessage(n.AssistFunc.CalcEngine,t,e,i,r)}}catch(e){}}static getXLabelParagraphText(e,t,n=!1,s=!1){if(null==e||null==t)return null;let o=new r.List;e.Document.GetChildrenListByCptId(e.CptID,o);let a=new r.List;for(let e of o)e instanceof i.XBaseContainer?e.GetAllBaseChildren(a):a.Add(e);let u=new r.List;for(let e=0;e<a.Count();e++){const t=a.Get(e);i.XDomUtil.HasDelTrace(t)||u.Add(t)}if(a=u,n&&a.Count()>0&&("XParagraphFlag"==a.Get(0).EleTypeName&&a.RemoveAt(0),"XParagraphFlag"==a.Last().EleTypeName&&a.RemoveAt(a.Count()-1)),a.Count()<1)return t.Clear(),"";let d,c=h.EmrClipboard.Copy_SelEles(a.ToArray(),!0,!0);for(let e=0;e<c.Count();e++){const n=c.Get(e);this.updateOwnerDocPanel(n,t.GetPagePanel(l.ENumPagePanelTp.Body))}return t.restoreChildrenList(c),d=s?t.GetInnerTextWithAll()||"":t.GetInnerText()||"",d}static updateOwnerDocPanel(e,t){if(null!=e&&(e.OwnerDocPanel=t),e instanceof i.XBaseContainer)for(let n=0;n<e.ChildEleList.Count();n++){const r=e.ChildEleList.Get(n);this.updateOwnerDocPanel(r,t)}}}t.TextDocApiUtil=d,d.customElementMapping=new r.Dictionary,d.CustomPainterMapping=new r.Dictionary},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTable=void 0;const r=n(9),i=n(3),l=n(10),s=n(16),o=n(20),a=n(26),u=n(8),h=n(63),d=n(14),c=n(115),p=n(0),f=n(35),g=n(21),m=n(310),E=n(163),C=n(44);class A extends p.XBaseContainer{constructor(){super(),this.boundsDisp=r.RectangleF.Empty,this._Rows=null,this._isFollowParagraphFlag=!1,this._IsShowBorderHideLine=!1,this._IsShowCellCode=!1,this._UsingCellBorderSetting=!1,this.cellHasHideBorder=!1,this._FullPageByLastRow=null,this.Rows=new i.List,this.Columns=new i.List,this.IsShowBorderHideLine=a.TextDocInitInfo.GetInstance().IsHideTableCellBorder,this.IsFollowParagraphFlag=a.TextDocInitInfo.GetInstance().IsShowParagraphFlag}get EleTypeName(){return"XTextTable"}get BoundsDISP(){return this.boundsDisp}set BoundsDISP(e){this.boundsDisp=e}get Name(){return this.propList.GetPropValue("Name")}set Name(e){this.propList.ModifyProperty("Name",e,null)}get Text_Expression(){return this.attrList.GetPropValue("DefaultEventExpression")}set Text_Expression(e){this.attrList.ModifyProperty("DefaultEventExpression",e,null)}get Rows(){return this._Rows}set Rows(e){this._Rows=e}get IsFollowParagraphFlag(){return this._isFollowParagraphFlag}set IsFollowParagraphFlag(e){this._isFollowParagraphFlag=e}get ExpessionArray(){return[this.Text_Expression]}set ExpessionArray(e){null!=e&&null!=e[0]&&(this.Text_Expression=e[0])}get Id(){return super.GrpID}set Id(e){super.GrpID=e}get CanReflect(){return!0}get IsGroupEle(){return!0}get ShowName(){return this.Name}get ScriptInnerValue(){return this.GetInnerText(!1)}GetInnerText(e){let t;if(0==this.ChildEleList.Count())return t="",t;let n=new g.default;for(let t of this.ChildEleList)null!=t&&(e||t.EleStyle.DeleterIndex<0)&&n.append(t.GetInnerText(e));let r=n.toString();return n.setLengthToZero(),t=r,t}get ExpTypeArray(){return["SetVisible","SetSize"]}GetType(){return"IScriptMsg"}get IsUseXId(){return!0}get IsShowBorderHideLine(){return this._IsShowBorderHideLine}set IsShowBorderHideLine(e){this._IsShowBorderHideLine=e}get IsDeleteRow(){let e=this.propList.GetPropValue("IsDeleteRow");return u.CNumUtil.TryParseBool(e,!0)}set IsDeleteRow(e){this.propList.ModifyProperty("IsDeleteRow",e,!0)}get IsDeleteTable(){const e=this.propList.GetPropValue("IsDeleteTable");return u.CNumUtil.TryParseBool(e,!0)}set IsDeleteTable(e){this.propList.ModifyProperty("IsDeleteTable",e,!0)}get IsInsertRow(){let e=this.propList.GetPropValue("IsInsertRow");return u.CNumUtil.TryParseBool(e,!0)}set IsInsertRow(e){this.propList.ModifyProperty("IsInsertRow",e,!0)}get IsSetColWidth(){let e=this.propList.GetPropValue("IsSetColWidth");return u.CNumUtil.TryParseBool(e,!0)}set IsSetColWidth(e){this.propList.ModifyProperty("IsSetColWidth",e,!0)}get IsSetRowHeight(){let e=this.propList.GetPropValue("IsSetRowHeight");return u.CNumUtil.TryParseBool(e,!0)}set IsSetRowHeight(e){this.propList.ModifyProperty("IsSetRowHeight",e,!0)}get IsShowCellCode(){return this._IsShowCellCode}set IsShowCellCode(e){this._IsShowCellCode=e}get NumOfRows(){let e;return e=null!=this.Rows?this.Rows.Count():0,e}get NumOfColumns(){let e;return e=null!=this.Columns?this.Columns.Count():0,e}get FromRowIx(){return 0}get UsingCellBorderSetting(){return this._UsingCellBorderSetting}set UsingCellBorderSetting(e){this._UsingCellBorderSetting=e}get IsPrint(){let e=this.propList.GetPropValue("IsPrint");return u.CNumUtil.TryParseBool(e,!0)}set IsPrint(e){this.propList.ModifyProperty("IsPrint",e,!0)}CanBeInline(e=!1){return!(!this.IsPrint&&e)&&super.CanBeInline(e)}get THeadIx(){let e=this.propList.GetPropValue("THeadIx");return u.CNumUtil.TryParseInt(e,-1)}set THeadIx(e){this.propList.ModifyProperty("THeadIx",e,-1)}IsWholeLineEle(){return!0}CombineCells(){this.ComBineCells_New(null)}ComBineCells_New(e){let t=new i.Dictionary,n=new i.List;for(let e of this.Rows)for(let r of e.Cells)if(r.Visible){if(r.ColSpan>1)for(let n=1;n<r.ColSpan;n++){1==n&&(r.WidhtDisp=r.Column.BoundsDISP.Width,r.SetSizeDPI(r.Column.Width,-1e3,300));const l=e.Cells.Get(r.ColIndex+n);if(e.Cells.Count()>r.ColIndex+n)if(r.WidhtDisp+=l.Column.BoundsDISP.Width,r.SetSizeDPI(r.Bounds.Width+l.Column.Width,-1e3,300),r.NotifyLayoutChanged(!0,!1),l.Visible=!1,r.RelatedMergeCell_Right.Contains(l)||r.RelatedMergeCell_Right.Add(l),l.MainMergeCell=r,t.ContainsKey(l.ColIndex))t.Get(l.ColIndex).Contains(l)||t.Get(l.ColIndex).Add(l);else{let e=new i.List;e.Add(l),t.Add(l.ColIndex,e)}}if(r.RowSpan>1){r.SetSizeDPI(-1e3,r.RowBaseHeight,300);for(let e=1;e<r.RowSpan&&!(r.RowIndex+e>=this.Rows.Count());e++){const n=this.Rows.Get(r.RowIndex+e).Cells,l=n.Get(r.ColIndex);r.SetSizeDPI(-1e3,r.Bounds.Height+l.RowBaseHeight,300),r.NotifyLayoutChanged(!0,!1),l.Visible=!1,r.RelatedMergeCell_Down.Contains(l)||r.RelatedMergeCell_Down.Add(l),l.MainMergeCell=r;for(let e=1;e<r.ColSpan;e++){const l=n.Get(r.ColIndex+e);if(l.Visible=!1,r.RelatedMergeCell_Right.Contains(l)||r.RelatedMergeCell_Right.Add(l),l.MainMergeCell=r,t.ContainsKey(l.ColIndex))t.Get(l.ColIndex).Contains(l)||t.Get(l.ColIndex).Add(l);else{let e=new i.List;e.Add(l),t.Add(l.ColIndex,e)}}}n.Contains(r)||n.Add(r)}const l=r.EleStyle;this.cellHasHideBorder||null==l||l.BorderTop||l.BorderBottom||l.BorderLeft||l.BorderRight||(this.cellHasHideBorder=!0),o.XTextTableUtil.spanValidate(r)}for(let n=this.Columns.Count()-1;n>=0;n--)if(t.ContainsKey(n)&&t.Get(n).Count()==this.Rows.Count()&&t.Get(n).Count()>0){let r=new m.TextTableDeleteColumnUndoRedo(this,t.Get(n).Get(0).ColIndex);this.Action_DeleteColumn(t.Get(n).Get(0)),null!=e&&e.AddItem(r)}for(let t=0;t<n.Count();t++){const r=n.Get(t);if(0==r.ColIndex&&r.ColSpan==this.Columns.Count()&&r.RowSpan>1){for(let t=r.RelatedMergeCell_Down.Count()-1;t>=0;t--){const i=r.RelatedMergeCell_Down.Get(t);n.Remove(i);let l=new E.TextTableDeleteRowRedoUndo(this,i.Parent);this.Action_DeleteRow(i),null!=e&&e.AddItem(l),r.RowSpan--}const i=r.Height;if(null!=r.OwnerLine)for(let e of r.OwnerLine.ChildEleList){let t=e instanceof p.XTextTableCell?e:null;null!=t&&t.SetSizeDPI(-1e3,i,300)}let l=n.Get(t).Parent instanceof p.XTextTableRow?n.Get(t).Parent:null;null!=l&&l.SetSizeDPI(-1e3,i,300)}}}CreatColumn(e){let t=d.XmlDomUtil.GetSingleNode(e,"Columns").children;this.Columns=new i.List;let n=0,r=0,s=0;for(let e=0;e<t.length;e++){let i=d.XmlDomUtil.GetSingleNode(t[e],"Width");if(null==i)continue;let o=new p.XTextTableColumn(this);o.OwnerDocPanel=this.OwnerDocPanel;let a=u.CNumUtil.TryParseFloat(i.textContent,0);a=Math.floor(a),o.Width=a,o.Index=s++,this.AddColumn(o),n+=o.Width;const h=l.DPITransUtil.TransIntVal(o.Width,300,96);o.SetSizeDISP(h,-1e3),r+=h}this.SetSizeDPI(n,-1e3,300),this.SetSizeDISP(r,-1e3)}AddColumn(e){this.Columns.Add(e),e.Index=this.Columns.Count()-1}_Before_BuildLines_(){const e=s.XDomUtil.GetParentHasRect(this,!1);if(null==e)return;const t=e.GetColumnsParam(),n=null!=t&&t.ColsCnt>1;let r=e.GetValidWidth(300),i=r-l.DPITransUtil.TransFloatVal(2,100,300);r=Math.floor(1e3*r)/1e3,n&&(i=t.GetColWidth(0,300));const o=this.GetValidWidth(300),a=this.Columns.Length;0!=f.CommDefines.CmprNumVal(o,i,a)&&this.ReBuildTableLayout(o,i)}_After_BuildLines_(){this.CombineCells();let e=super.GetLinesIter();for(;e.MoveNext();){let t=e.Current;t.ReCalcLineSize();for(let e of t.ChildEleList)e.SetPositionDPI(e.X,e.Y,300)}}RefreshInnerLines(){if(null==super.OwnerLine)return;let e=super.OwnerLine.RealTop,t=super.OwnerLine.RealLeft,n=this.lineList;for(let r=0;r<n.Count();r++){n.Get(r).RealLeft=super.OwnerLine.RealLeft,n.Get(r).RealTop=e;for(let e of n.Get(r).ChildEleList){let n=e instanceof p.XTextTableCell?e:null;null!=n&&(n.RefreshInnerLines(super.OwnerLine.RealLeft+n.Bounds.X,super.OwnerLine.RealTop+n.OwnerLine.Bounds.Y),t+=n.Column.Width)}e+=n.Get(r).Bounds.Height}}ReCalcLinesInnerElementSize(e){if(null!=e)for(let t of e.ChildEleList){let n=t;null!=n&&n.RowBaseHeight<e.Height&&n.SetSizeDPI(-1e3,e.Height,300)}}AddChildEle(e,t){return t.LineCntChanged=this.Cell_LineCntChanged,super.AddChildEle(e,t)}GetEleAtPos(e,t,n,r,i){super.GetEleAtPos(e,t,n,r,i)}UpdateEleAttrFgHide(e,t){super.Attr_FgHide!=e&&(super.Attr_FgHide=e,C.TextDocApiUtil.M_InnerEleExcScrExp(this,this.Document,t))}Undo_InsertColumn(e,t,n){if(null==e)return;let r=e.Index;this.Columns.Remove(e);let i=0;for(let e of this.Columns)e.Index=i++;for(let e of this.Columns)e.SetSizeDPI(t.Get(e.Index).Width,t.Get(e.Index).Height,300),e.SetPositionDPI(t.Get(e.Index).X,t.Get(e.Index).Y,300),e.SetSizeDISP(n.Get(e.Index).Width,n.Get(e.Index).Height),e.SetPositionDISP(n.Get(e.Index).X,n.Get(e.Index).Y);for(let e of this.Rows){let t=e.Cells.Get(r);this.ReleaseCellMerge(t),e.RemoveChildWithEle(t),e.Cells.Remove(t);for(let t=0;t<e.Cells.Count();t++)e.Cells.Get(t).SetSizeDPI(this.Columns.Get(t).Bounds.Width,-1e3,300),e.Cells.Get(t).WidhtDisp=this.Columns.Get(t).BoundsDISP.Width}this.CombineCells()}formatDecimal(e,t){let n=(e=e.toString()).indexOf(".");return e=-1!==n?e.substring(0,t+n+1):e.substring(0),parseFloat(e).toFixed(t)}Action_CreateTextTable_New(e,t){if(this.Columns=new i.List,null==this.OwnerDocPanel)return;let n=this.Document.GetPageFmt(),r=o.XTextTableUtil.GetTableMaxWidth(n,300);this.SetSizeDPI(r,-1e3,300);let s=l.DPITransUtil.TransIntVal(r,300,96);this.SetSizeDISP(s,-1e3);let a=parseFloat(this.formatDecimal(this.BoundsDISP.Width/t,2)),u=this.BoundsDISP.Width%t,h=parseFloat(this.formatDecimal(this.Bounds.Width/t,2)),d=this.Bounds.Width%t;for(let e=0;e<t;e++){let n=new p.XTextTableColumn(this);n.OwnerDocPanel=this.OwnerDocPanel,e==t-1&&(a+=u,h+=d),n.Width=h,n.SetSizeDISP(a,-1e3),this.AddColumn(n)}this.ClearChildren(!0),this.Rows.Clear();for(let t=0;t<e;t++){let e=this.CreateRow();this.AddChildEle(2147483647,e),this.boundsDisp.Width<e.WidthDisp&&this.SetSizeDISP(e.WidthDisp,-1e3),this.Rows.Add(e)}}Action_InsertRow(e,t,n=!1){let r=o.XTextTableUtil.GetCursorCell(e);if(null==r)return null;let i=super.GetChildInx(r.Parent),l=this.CreateRow(n,r.Parent);switch(t){case h.ORIENTATION.TOP:i=i;break;case h.ORIENTATION.BOTTOM:let e=i;const t=r.RelatedMergeCell_Down;for(let n=0;n<t.Count();n++){const r=t.Get(n).Parent;e=Math.max(e,r.Index)}const n=r.RelatedMergeCell_Right;for(let t=0;t<n.Count();t++){const r=n.Get(t).Parent;e=Math.max(e,r.Index)}i=Math.max(e,i),i++}return i<0&&(i=0),this.AddChildEle(i,l),this.Rows.Insert(i,l),this.ResetMergeOnRowChanged(i,l,!0),l}CreateRow(e=!1,t){let n=new p.XTextTableRow;return n.Parent=this,n.OwnerDocPanel=this.OwnerDocPanel,n.LineCntChanged=this.Cell_LineCntChanged,n.CreateCells(e,t),n}ResetMergeOnRowChanged(e,t,n){if(n&&e>=0&&e<this.Rows.Count()-1)for(let n of this.Rows.Get(e+1).Cells)(null==n.RelatedMergeCell_Down||n.RowSpan<=1||n.RelatedMergeCell_Down.Count()<=0)&&null!=n.MainMergeCell&&n.MainMergeCell.RowSpan>1&&(n.MainMergeCell.RelatedMergeCell_Down.Contains(t.Cells.Get(n.ColIndex))||(n.MainMergeCell.RelatedMergeCell_Down.Add(t.Cells.Get(n.ColIndex)),n.MainMergeCell.ColIndex==n.ColIndex&&n.MainMergeCell.RowSpan++,t.Cells.Get(n.ColIndex).MainMergeCell=n.MainMergeCell));if(!n&&e>=0&&e<=this.Rows.Count()-1)for(let e of t.Cells){if(e.RowSpan>1&&e.RelatedMergeCell_Down.Count()>0){for(let t of e.RelatedMergeCell_Down)t.Visible=!0,t.MainMergeCell=null;e.RelatedMergeCell_Down.Clear()}if(e.ColSpan>1&&e.RelatedMergeCell_Right.Count()>0){for(let t of e.RelatedMergeCell_Right)t.Visible=!0,t.MainMergeCell=null;e.RelatedMergeCell_Right.Clear()}null!=e.MainMergeCell&&e.MainMergeCell.RowSpan>1&&e.MainMergeCell.RelatedMergeCell_Down.Count()>0&&(e.Visible=!0,e.MainMergeCell.RelatedMergeCell_Down.Remove(e),e.MainMergeCell.RelatedMergeCell_Right.Remove(e),e.ColIndex==e.MainMergeCell.ColIndex&&e.MainMergeCell.RowSpan--)}}Cell_LineCntChanged(e,t){let n=e instanceof p.XTextTableCell?e:null,r=n.Height,i=n.Parent.ChildEleList.GetEnumerator();for(;i.MoveNext();){let e=i.Current instanceof p.XTextTableCell?i.Current:null;null!=e&&e.RowSpan<=1&&e.GetRealHeight(!0)>r&&(r=e.GetRealHeight(!0))}if(null!=n.Parent)for(n.Parent.Height=r,i=n.Parent.ChildEleList.GetEnumerator();i.MoveNext();){let e=i.Current instanceof p.XTextTableCell?i.Current:null;null!=e&&e.SetSizeDPI(-1e3,r,300)}}Redo_InsertRow(e,t){let n;return null==e?(n=null,n):(this.AddChildEle(t,e),this.Rows.Insert(t,e),this.ResetMergeOnRowChanged(t,e,!0),n=e,n)}Undo_InsertRow(e){null!=e&&(this.ResetMergeOnRowChanged(e.Index,e,!1),super.RemoveChildWithEle(e),this.lineList.Remove(e.OwnerLine),this.Rows.Remove(e))}Action_DeleteRow(e){let t=e instanceof p.XTextTableCell?e:null;null!=t&&(this.ResetMergeOnRowChanged(t.RowIndex,t.Parent,!1),super.RemoveChildWithEle(t.Parent),this.lineList.Remove(t.OwnerLine),this.Rows.Remove(t.Parent instanceof p.XTextTableRow?t.Parent:null))}Action_InsertColumn_New(e,t,n=!0){if(e<0)return null;let r=t;if(null==t&&(r=new p.XTextTableColumn(this)),r.OwnerDocPanel=this.OwnerDocPanel,!n){let t=!0;if(e-1>=0){const n=this.Columns.Get(e-1);if(null!=n){const e=n.Width,i=Math.ceil(e/2*100)/100;if(e>0&&i>0){r.Width=e-i,n.Width=i;const s=l.DPITransUtil.TransIntVal(i,300,96);n.SetSizeDISP(s,-1e3),t=!1}}}n=t}if(n){let e=0;for(let t=0;t<this.Columns.Count();t++){let n=this.Columns.Get(t).Width/(this.NumOfColumns+1),r=this.Columns.Get(t).Width-n;this.Columns.Get(t).Width=u.CNumUtil.TryParseFloat(r.toString(),0);let i=l.DPITransUtil.TransIntVal(this.Columns.Get(t).Width,300,96);this.Columns.Get(t).SetSizeDISP(i,-1e3),e+=this.Columns.Get(t).Width}r.Width=this.Bounds.Width-e}let i=l.DPITransUtil.TransIntVal(r.Width,300,96);r.SetSizeDISP(i,-1e3),this.Columns.Insert(e,r);let s=0;for(let e of this.Columns)e.Index=s++;for(let t of this.Rows)e<0&&(e=0),t.InsertCell(e);return this.CombineCells(),r}RedoUndo_InsertColumn(e,t){e>=0&&this.Columns.Insert(e,t)}Action_DeleteColumn_1(e){let t=o.XTextTableUtil.GetCursorCell(e);null!=t&&this.Action_DeleteColumn_2(t.ColIndex)}Action_DeleteColumn_2(e){let t=0;for(;t<this.Columns.Count();){if(t==e){if(1==this.Columns.Count())break;0==t?(this.Columns.Get(t+1).Width+=this.Columns.Get(t).Width,this.Columns.Get(t+1).SetSizeDISP(this.Columns.Get(t+1).BoundsDISP.Width+this.Columns.Get(t).BoundsDISP.Width,-1e3)):(this.Columns.Get(t-1).Width+=this.Columns.Get(t).Width,this.Columns.Get(t-1).SetSizeDISP(this.Columns.Get(t-1).BoundsDISP.Width+this.Columns.Get(t).BoundsDISP.Width,-1e3));break}t++}this.Columns.Get(e);this.Columns.RemoveAt(e);let n=0;for(let e of this.Columns)e.Index=n++;for(let t of this.Rows)this.DeleteCell(t.Cells.Get(e))}DeleteCell(e){let t=e.Parent;if(null==t.Parent)return!1;this.ReleaseCellMerge(e),t.RemoveChildWithEle(e),t.Cells.Remove(e);for(let e=0;e<this.Columns.Count();e++)t.Cells.Get(e).Column=this.Columns.Get(e),t.Cells.Get(e).WidhtDisp=this.Columns.Get(e).BoundsDISP.Width,t.Cells.Get(e).SetSizeDPI(t.Cells.Get(e).Column.Width,-1e3,300);return!0}Redo_DeleteColumn(e){if(e>=0&&this.Columns.Count()>e){for(let t=0;t<this.Columns.Count();t++)if(t==e){this.Columns.Count(),0==t?(this.Columns.Get(t+1).Width+=this.Columns.Get(t).Width,this.Columns.Get(t+1).SetSizeDISP(this.Columns.Get(t+1).BoundsDISP.Width+this.Columns.Get(t).BoundsDISP.Width,-1e3)):(this.Columns.Get(t-1).Width+=this.Columns.Get(t).Width,this.Columns.Get(t-1).SetSizeDISP(this.Columns.Get(t-1).BoundsDISP.Width+this.Columns.Get(t).BoundsDISP.Width,-1e3));break}this.Columns.Get(e);this.Columns.RemoveAt(e)}}Action_Undo_InsertColumn(e){if(null!=e){let t=this.Columns.IndexOf(e);this.Columns.RemoveAt(t);for(let e of this.Rows)this.DeleteCell(e.Cells.Get(t))}}Copy(e,t){if(null!=e){this.OwnerDocPanel=e.OwnerDocPanel,super.Parent=e.Parent;let t=0;for(let n of e.Rows){let r=new p.XTextTableRow;if(r.LineCntChanged=this.Cell_LineCntChanged,r.CopyFrom(n,!1,!1,!0),r.Cells.Count()>0&&(this.AddChildEle(2147483647,r),this.Rows.Add(r),0==this.Columns.Count()))for(let n of r.Cells){let r=new p.XTextTableColumn(this);r.CopyFrom(e.Columns.Get(n.ColIndex),!1,!1,!0),t+=r.BoundsDISP.Width,this.AddColumn(r)}}if(0!=this.NumOfRows&&0!=this.NumOfColumns)if(this.NumOfColumns!=e.NumOfColumns){let e=300,n=0;if(null!=this.OwnerDocPanel){let r=this.Document.GetPageFmt().GetValidWidthDPI(300);this.SetSizeDPI(r,-1e3,300);let i=l.DPITransUtil.TransIntVal(r,300,96);this.SetSizeDISP(i,-1e3),t=i-t>0?i-t:t,e=t/this.NumOfColumns,n=t%this.NumOfColumns}for(let t=0;t<this.NumOfColumns;t++){let r=this.Columns.Get(t).BoundsDISP.Width+e;t==this.NumOfColumns-1&&(r+=n),this.Columns.Get(t).SetSizeDISP(r,-1e3),this.Columns.Get(t).Width=l.DPITransUtil.TransFloatVal(r,96,300)}for(let e of this.Rows)for(let t=0;t<e.Cells.Count();t++)e.Cells.Get(t).Column=this.Columns.Get(t)}else this.SetSizeDPI(e.Width,e.Height,300),this.SetSizeDISP(e.BoundsDISP.Width,e.BoundsDISP.Height)}}ReleaseCellMerge(e){if(null!=e){if(e.RowSpan>1&&e.RelatedMergeCell_Down.Count()>0){for(let t of e.RelatedMergeCell_Down)t.Visible=!0,t.MainMergeCell=null,t.NotifyLayoutChanged(!0,!1);e.RelatedMergeCell_Down.Clear()}if(e.ColSpan>1&&e.RelatedMergeCell_Right.Count()>0){for(let t of e.RelatedMergeCell_Right)t.Visible=!0,t.MainMergeCell=null,t.NotifyLayoutChanged(!0,!1);e.RelatedMergeCell_Right.Clear()}null!=e.MainMergeCell&&(e.MainMergeCell.RelatedMergeCell_Down.Contains(e)?(e.MainMergeCell.RowSpan--,e.MainMergeCell.RelatedMergeCell_Down.Remove(e),e.MainMergeCell.NotifyLayoutChanged(!0,!1)):e.MainMergeCell.RelatedMergeCell_Right.Contains(e)&&(e.RowIndex==e.MainMergeCell.RowIndex&&e.MainMergeCell.ColSpan--,e.MainMergeCell.RelatedMergeCell_Right.Remove(e),e.MainMergeCell.NotifyLayoutChanged(!0,!1)),e.MainMergeCell=null)}}CopyFromSelRange(e,t,n,i,s){let o,a=r.RectangleF.Empty,u=this._FiltTableCellsSameTable(a,e,t),h=u[0],d=u[1];if((null==h?0:h.length)<=0)return o=0,o;const c=h[0].Parent.Parent;null!=c&&super.CopyFrom(c,null,n,i);let f=0,g=0;for(let e=0;e<d.Width;e++){let t=new p.XTextTableColumn(this);t.Index=e,t.CopyFrom(h[e].Column,!1,!1,!0),this.AddColumn(t),f+=t.Width,g+=l.DPITransUtil.TransIntVal(t.Width,300,96)}this.SetSizeDPI(f,-1e3,300),this.SetSizeDISP(g,-1e3);let m=0,E=0,C=0,A=new p.XTextTableRow;for(let e=0;e<h.length;e++){0==A.Cells.Count()&&(A.Index=E++,this.AddChildEle(2147483647,A),this.Rows.Add(A));let t=new p.XTextTableCell;null!=h[e]&&t.CopyFrom(h[e],!0,n,i),t.Column=this.Columns.Get(C),A.InsertCell_Withindex(t,2147483647),C++,m++,A.Cells.Count()==this.Columns.Count()&&(A=new p.XTextTableRow,C=0)}return o=m,o}SetSelectRangle(e,t){let n=e,r=t;if(null!=n&&null!=r){let e=n.RowIndex,t=r.RowIndex;e>r.RowIndex&&(e=r.RowIndex,t=n.RowIndex);let i=n.ColIndex,l=r.ColIndex;i>l&&(e=r.ColIndex,t=n.ColIndex);for(let n of this.Rows)for(let r of n.Cells)r.RowIndex>=e&&r.RowIndex<=t&&r.ColIndex>=i&&r.ColIndex<=l?r.Select=!0:r.Select=!1}}SelectAll(e,t){for(let n of this.Rows)for(let r of n.Cells)r.Select=e,e?t.Add(r):t.Remove(r)}CopySelectText(){let e=new g.default;for(let t of this.Rows){let n=!1;for(let r of t.Cells)r.Select&&(e.append(r.GetInnerText(!1).trim()),n=!0,e.append("\t"));n&&e.append("\r\n")}return e.toString()}_FiltTableCellsSameTable(e,t,n){e=r.RectangleF.Empty;let l=null==t?0:t.length;if(l<=0||n>=l)return null;let s=t[n],a=o.XTextTableUtil.GetCursorTextTable(s);if(null==a)return null;e.X=s.ColIndex,e.Y=s.RowIndex;let u=new i.List;for(let r=n;r<l;r++){let n=t[r],i=o.XTextTableUtil.GetCursorTextTable(n);if(null==i||i!=a)break;u.Add(n),n.RowIndex==s.RowIndex&&e.Width++,n.ColIndex==s.ColIndex&&e.Height++}let h=u.ToArray();return u.Clear(),[h,e]}static CanContainerAutoHeight(e){return null!=e&&e instanceof p.XTextTableCell}GetUpCell(e,t=!0){if(null==e)return null;let n=null;return e.RowIndex-1>=0&&(n=this.Rows.Get(e.RowIndex-1).Cells.Get(e.ColIndex)),null!=n&&!n.Visible&&t&&(n=this.GetUpCell(n,!0)),n}GetDownCell(e,t=!0){if(null==e)return null;let n=null;return e.RowIndex+1<this.Rows.Count()&&(n=this.Rows.Get(e.RowIndex+1).Cells.Get(e.ColIndex)),null!=n&&!n.Visible&&t&&(n=this.GetDownCell(n,!0)),n}GetLeftCell(e,t=!0){if(null==e)return null;let n=null;return e.ColIndex-1>=0&&(n=this.Rows.Get(e.RowIndex).Cells.Get(e.ColIndex-1)),null!=n&&!n.Visible&&t&&(n=this.GetLeftCell(n,!0)),n}GetFirstCell(){let e=this.Rows.Get(0).Cells.Get(0);return e.Visible||(e=this.GetNextCell(e,!0)),e}GetNextCell(e,t=!0){if(null==e)return null;let n=null;return e.ColIndex+1<this.Columns.Count()&&(n=this.Rows.Get(e.RowIndex).Cells.Get(e.ColIndex+1)),null!=n&&!n.Visible&&t&&(n=this.GetNextCell(n,!0)),n}GetNextCellWithNexRow(e,t=!0){if(null==e)return null;let n=null;return e.ColIndex+1<this.Columns.Count()&&(n=this.Rows.Get(e.RowIndex).Cells.Get(e.ColIndex+1)),e.ColIndex+1==this.Columns.Count()&&(n=e.RowIndex+1==this.Rows.Count()?null:this.Rows.Get(e.RowIndex+1).Cells.Get(0)),null!=n&&!n.Visible&&t&&(n=this.GetNextCellWithNexRow(n,!0)),n}GetPreCell(e,t=!0){if(null==e)return null;let n=null;return e.ColIndex-1>=0?n=this.Rows.Get(e.RowIndex).Cells.Get(e.ColIndex-1):e.RowIndex-1>=0&&(n=this.Rows.Get(e.RowIndex-1).Cells.Get(e.Parent.ChildCount-1)),null!=n&&!n.Visible&&t&&(n=this.GetPreCell(n,!0)),n}static GetBaseElement(e){if(null==e)return null;let t=e instanceof p.XBaseContainer?e:null;return null!=t&&(e=t.GetFirstChildBaseEle(!1)),e}static GetCellsByRowInx(e,t){if(null==e)return null;let n=e.Rows;if(null==n||0==n.Count())return null;for(let e of n)if(e.Index==t){return e.Cells.ToArray()}return null}GetCellsByColInx(e){let t=this.Rows;if(null==t||0==t.Count())return null;if(!(e>=0&&e<this.NumOfColumns))return null;let n=[];for(let r of t)if(null!=r.Cells){const t=r.Cells.Get(e);null!=t&&n.push(t)}return n.length<1&&(n=null),n}GetLastCell(){let e=this.Rows.Get(this.Rows.Count()-1),t=e.Cells.Get(e.Cells.Count()-1);return t.Visible||(t=this.GetPreCell(t,!0)),t}GetValidWidth(e){let t=super.EleStyle.ElePadd,n=this.Width-t.Left-t.Right;return l.DPITransUtil.TransFloatVal(n,300,e)}ReBuildTableLayout(e,t){this.SetSizeDPI(t,-1e3,300);let n=l.DPITransUtil.TransIntVal(t,300,96);this.SetSizeDISP(n,-1e3);let r=t/e,i=t;for(let e=0;e<this.Columns.Count();e++){let t;t=e==this.Columns.Count()-1?i:this.Columns.Get(e).Width*r,this.Columns.Get(e).Width=t;let n=l.DPITransUtil.TransIntVal(this.Columns.Get(e).Width,300,96);this.Columns.Get(e).SetSizeDISP(n,-1e3),i-=this.Columns.Get(e).Width}for(let e of this.Rows)for(let t of e.Cells){if(t.WidhtDisp=t.Column.BoundsDISP.Width,0==t.RelatedMergeCell_Right.Count())t.SetSizeDPI(t.Column.Width,-1e3,300);else{let e=0;for(let n=t.ColIndex;n<t.ColIndex+t.ColSpan;n++)e+=this.Columns.Get(n).Width;t.SetSizeDPI(e,-1e3,300)}t.NotifyLayoutChanged(!0,!1)}}SetSizeDISP(e,t){-1e3!=e&&(this.boundsDisp.Width=e),-1e3!=t&&(this.boundsDisp.Height=t)}TransFormToPaint(){this.SetPositionDISP(this.Bounds.X,this.Bounds.Y)}SetPositionDISP(e,t){-1e3!=e&&(this.boundsDisp.X=l.DPITransUtil.TransIntVal(e,300,96)),-1e3!=t&&(this.boundsDisp.Y=l.DPITransUtil.TransIntVal(t,300,96));let n=this.boundsDisp.X,r=this.boundsDisp.Y;for(let e of this.Columns)e.SetPositionDISP(n,r),n+=e.BoundsDISP.Width;for(let e of this.Rows){n=this.boundsDisp.X;let t=0;for(let i of e.Cells)i.SetPositionDISP(n,r),n+=i.Column.BoundsDISP.Width,i.RowSpan<=1&&(t=t>i.HeightDisp?t:i.HeightDisp);r+=t}}ToXML(e){this.DeleteAllCombinedRow();let t=super.ToXML(e);if(null==t)return null;let n=d.XmlDomUtil.CrtXmlAttr(e,"xsi:type",this.EleTypeName,c.XmlNsTags.GetURI("xsi"));t.setAttributeNode(n),t.setAttribute("NumOfRows",this.NumOfRows.toString()),t.setAttribute("NumOfColumns",this.NumOfColumns.toString());let r=e.createElement("Columns");t.appendChild(r);for(let t of this.Columns){let n=t.ToXML(e);r.appendChild(n)}return t}FromXML(e){super.BaseFromXML(e),o.XTextTableUtil.StyleList=this.Document.GetCommStyleList();let t=u.CNumUtil.TryParseInt(d.XmlDomUtil.GetSingleAttrValue(e,"StyleIndex"),-1);o.XTextTableUtil.StyleList.CopyEleStyle(t,super.EleStyle),this.CreatColumn(e),this.ClearChildren(!0),this.Rows.Clear();let n=d.XmlDomUtil.GetSingleNode(e,"XElements");if(null==n)return;let r=n.children;if(null!=r&&0!=r.length){for(let e=0;e<r.length;e++){let t=r[e],n=d.XmlDomUtil.GetSingleAttrValue(t,"xsi:type"),i=p.XElementFactory.CreatXElement(n,null);if(null==i)return;i.Parent=this,i.OwnerDocPanel=this.OwnerDocPanel,i.FromXML(t),this.AddChildEle(2147483647,i);let l=i;null!=l&&l instanceof p.XTextTableRow&&(l.Index=e,this.Rows.Add(l))}this.CombineCells(),this.DeleteAllCombinedRow(),this.cellHasHideBorder&&-1==t&&null!=super.EleStyle&&(super.EleStyle.BorderTop=!1,super.EleStyle.BorderBottom=!1,super.EleStyle.BorderLeft=!1,super.EleStyle.BorderRight=!1)}}DeleteAllCombinedRow(){if(null!=this.Rows)for(let e=0;e<this.Rows.Count();e++){const t=this.Rows.Get(e);if(null==t.Cells)continue;let n,r=!0;for(let e=0;e<t.Cells.Count();e++){const i=t.Cells.Get(e);if(i.Visible){r=!1;break}n=i}r&&this.Action_DeleteRow(n)}}Action_DeleteColumn(e){if(e instanceof p.XBaseElement){let t=o.XTextTableUtil.GetCursorCell(e);null!=t&&this.Action_DeleteColumn(t.ColIndex)}else{const t=e;let n=0;for(;n<this.Columns.Count();){if(n==t){if(1==this.Columns.Count())break;0==n?(this.Columns.Get(n+1).Width+=this.Columns.Get(n).Width,this.Columns.Get(n+1).SetSizeDISP(this.Columns.Get(n+1).BoundsDISP.Width+this.Columns.Get(n).BoundsDISP.Width,-1e3)):(this.Columns.Get(n-1).Width+=this.Columns.Get(n).Width,this.Columns.Get(n-1).SetSizeDISP(this.Columns.Get(n-1).BoundsDISP.Width+this.Columns.Get(n).BoundsDISP.Width,-1e3));break}n++}this.Columns.Get(t);this.Columns.RemoveAt(t);let r=0;for(let e=0;e<this.Columns.Length;e++)this.Columns.Get(e).Index=r++;for(let e=0;e<this.Rows.Length;e++)this.DeleteCell(this.Rows.Get(e).Cells.Get(t))}}Action_CombineCell_New2(e,t,n){let r=null;for(let t=0;t<this.Rows.Count();t++){let i=this.Rows.Get(t);for(let t=0;t<i.Cells.Count();t++){let l=i.Cells.Get(t);if(l.Visible)if(e.Contains(l))null==r?(null!=n&&(n.MainCell=l,n.BeforeColSpan=l.ColSpan,n.BeforeRowSpan=l.RowSpan,n.Width=l.Width,n.Height=l.Height,n.WidthDisp=l.WidhtDisp,n.HeightDisp=l.HeightDisp),r=l,r.RowSpan=0==r.RowSpan?1:r.RowSpan,r.ColSpan=0==r.ColSpan?1:r.ColSpan,r.NotifyLayoutChanged(!0,!1)):l.ColSpan<=1?r.ColSpan++:r.ColSpan+=l.ColSpan;else if(null!=r)break}if(null!=r){for(;++t<this.Rows.Count();){i=this.Rows.Get(t);const n=i.Cells.Get(r.ColIndex);if(!e.Contains(n))break;n.Visible&&(n.RowSpan<=1?r.RowSpan++:r.RowSpan+=n.RowSpan)}break}}return null!=r&&null!=n&&(n.MainCell=r,n.AfterColSpan=r.ColSpan,n.AfterRowSpan=r.RowSpan),this.ComBineCells_New(t),n}XTextTableCellLinesCalc(){for(let e of this.lineList){let t=e.GetElesIter();for(;t.MoveNext();){let e=t.Current instanceof p.XTextTableCell?t.Current:null;null!=e&&e.CalcSizeByLines()}}}CalcSizeByLines(){if(this.CanBeInline(!1)&&!this.IsLayoutValid){this.XTextTableCellLinesCalc();let e=0,t=0;for(let n of this.Rows)n.IsHidden(!0)||(e+=n.Height,n.Index=t++);let n=0;for(let e of this.Columns)n+=e.Width;this.SetSizeDPI(n,e,300);let r=l.DPITransUtil.TransIntVal(e,300,96),i=l.DPITransUtil.TransIntVal(n,300,96);this.SetSizeDISP(i,r),this.IsLayoutValid=!0}}SetPositionDPI(e,t,n){super.SetPositionDPI(e,t,n);let r=this.Bounds.X,i=this.Bounds.Y,s=0;for(let e of this.Columns)e.Index=s++,e.SetPositionDPI(r,i,n),r+=e.Bounds.Width;this.RebuildTableLine();let o=0,a=0;for(let e of this.Rows)e.IsHidden(!0)||(o+=e.Height,e.Index=a++);this.SetSizeDPI(-1e3,o,300);let u=l.DPITransUtil.TransIntVal(o,300,96);this.SetSizeDISP(-1e3,u),this.TransFormToPaint()}RebuildTableLine(){let e=this.Bounds.X,t=this.Bounds.Y,n=0,r=super.GetLinesIter();for(;r.MoveNext();){e=this.Bounds.X;let i=r.Current;i.IndexInView=n++,i.SetPositionDPI(this.Bounds.X,t,300);i.GetElesIter();t+=i.LineAssist.GetLineFullHeight(300,!0)}}SetSizeDPI(e,t,n){if(n>0&&300!=n){let r=300/n;e>=0&&(e*=r),t>=0&&(t*=r)}e>=0&&(this.Bounds.Width=e),t>=0&&(this.Bounds.Height=t)}get FullPageByLastRow(){if(null==this._FullPageByLastRow){const e=this.attrList.GetPropValue("FullPageByLastRow");this._FullPageByLastRow=u.CNumUtil.TryParseBool(e,!1)}return this._FullPageByLastRow}set FullPageByLastRow(e){this._FullPageByLastRow=!!e;const t=u.CNumUtil.ToStringForBool(this._FullPageByLastRow);this.attrList.ModifyProperty("FullPageByLastRow",t,"false")}}t.XTextTable=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClickRemoveModel=t.XValueTypeStyle=t.XValueFormatStyle=t.CheckErrorType=t.PositionEnum=void 0,function(e){e[e.LeftBottom=0]="LeftBottom",e[e.LeftTop=1]="LeftTop",e[e.RightTop=2]="RightTop",e[e.RightBottom=3]="RightBottom"}(t.PositionEnum||(t.PositionEnum={})),function(e){e[e.None=0]="None",e[e.TextLength_Under=1]="TextLength_Under",e[e.TextLength_Over=2]="TextLength_Over",e[e.Number_Under=3]="Number_Under",e[e.Number_Over=4]="Number_Over",e[e.Number_Digits_Over=5]="Number_Digits_Over",e[e.Number_TextType_ILegal=6]="Number_TextType_ILegal",e[e.NotEmpty=7]="NotEmpty",e[e.MustChoose=8]="MustChoose",e[e.MustNumber=9]="MustNumber",e[e.DateFormat=10]="DateFormat"}(t.CheckErrorType||(t.CheckErrorType={})),function(e){e[e.None=0]="None",e[e.Numeric=1]="Numeric",e[e.Currency=2]="Currency",e[e.DateTime=3]="DateTime",e[e.String=4]="String",e[e.SpecifyLength=5]="SpecifyLength",e[e.Boolean=6]="Boolean",e[e.Percent=7]="Percent"}(t.XValueFormatStyle||(t.XValueFormatStyle={})),function(e){e[e.Text=0]="Text",e[e.Integer=1]="Integer",e[e.Numeric=2]="Numeric",e[e.Date=3]="Date",e[e.Time=4]="Time",e[e.DateTime=5]="DateTime",e[e.RegExpress=6]="RegExpress"}(t.XValueTypeStyle||(t.XValueTypeStyle={})),function(e){e[e.ForceRemove=0]="ForceRemove",e[e.TraceRemove=1]="TraceRemove"}(t.ClickRemoveModel||(t.ClickRemoveModel={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBasePainter=void 0;const r=n(7),i=n(110),l=n(9),s=n(10),o=n(697),a=n(2);t.XBasePainter=class{constructor(){}Paint(e,t,n,r,i){if(null!=e){let l=n.Color,s=r.Color,o=r.Width;try{this.PaintElement(e,t,n,r,i),this.PaintChildLines(e,t,n,r,i),this.PaintBorder(e,t,r,i),this.PaintMaskLayer(e,t,n,i)}catch(e){}n.Color=l,r.Color=s,r.Width=o}}PaintChildLines(e,t,n,r,i){}PaintBorder(e,t,n,r){}PaintMaskLayer(e,t,n,r){}_PaintBkgColor_(e,t,n,s,o){if(null!=n){let a=n.EleStyle.BackgroundColor;const u=n.Document;null!=u&&u.GetDocCtxt().EmrWorkMode;if(a!=r.Color.Empty){t.Color=a;let r=l.RectangleF.Empty;i.RectFUtil.ToRect2(s,r);let u=n.OwnerLine;u.GetRealParaghSpacingBefore(o),u.LineAssist.GetLineFullHeight(o,!1);e.FillRectangle(t,s)}}}_PaintUnderline_(e,t,n,r,i){if(null!=n){let l=n.EleStyle;if(!this._PaintTraceFlag_(n,e,t,r)){let o=0,a=n.OwnerLine.LineAssist.GetMaxEleForUnderlinePosY(n,o);if(null!=a){let n=a.Y+a.Height;n=s.DPITransUtil.TransFloatVal(n,300,i),t.Width=0,t.Color=l.ForeColor,e.DrawLine(t,r.Left,n,r.Right,n)}}}}_PaintStrikeout_(e,t,n,r,i){if(null!=n){let l=n.EleStyle;if(!this._PaintTraceFlag_(n,e,t,r)){let o=0,a=n.OwnerLine.LineAssist.GetMaxEleForStrikeoutPosY(n,o);if(null!=a){let n=a.Y+a.Height/2;n=s.DPITransUtil.TransFloatVal(n,300,i),t.Width=0,t.Color=l.ForeColor,e.DrawLine(t,r.Left,n,r.Right,n)}}}}_PaintTraceFlag_(e,t,n,r){if(null==e)return!1;if(e.Document.GetDocCtxt().ViewMode.IsCleanViewMode)return!1;const i=e.Document,l=null!=i?i.GetDocCtxt().EmrWorkMode:null;if(null!=l&&l!=a.ENumWorkMode.KeepTrace)return!1;let s=!1,u=e.EleStyle;switch(o.TraceFlagPainter.Chk_TraceTp(u)){case a.ENumEdtType.Add:"XParagraphFlag"==e.EleTypeName||"XTextLabelElement"==e.EleTypeName||(s=!0,o.TraceFlagPainter.Paint_AddTraceFlag(e,t,n,r));break;case a.ENumEdtType.Delete:case a.ENumEdtType.Backspace:s=!0,o.TraceFlagPainter.Paint_DelTraceFlag(e,t,n,r)}return s}_GetPageView(e){let t;if(null==e)return null;let n=e.OwnPageView;if(null==n){n=e.Document.GetDocCtxt().PgvPaiting}return t=n,t}_GetPagePaintArgs(e){let t=this._GetPageView(e);return null==t?null:t.PageDrawArgs}_GetEmrWorkMode(e){return e.Document.GetDocCtxt().EmrWorkMode}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertElement=void 0;const r=n(2),i=n(13),l=n(1),s=n(55),o=n(89),a=n(3),u=n(0),h=n(37);class d extends l.XBaseAction{constructor(){super(),this.edt_elerange=null,this.newEle=null,super.OpType=r.ENumActOpType.CtntEdit,this.edt_elerange=new s.EmrEditEleRange}Execute(e){this.newEle=null,this.resMsg.Clear();let t,n=super.GetEdtCtrl(),r=n.M_EleEvtModel,l=r.EleClickedWrap;if(null!=l&&l.IsValid()){let l=e.length,s=l<1?null:e[0];this.newEle=null==s?null:s;let d=l<2||null==e[1]?null:e[1],c=l<3||null==e[2]?-1:Number(e[2]),p=l<4||null==e[3]||!(e[3]instanceof u.XBaseContainer)?null:e[3];if(c>=0||(c=-1),null==this.newEle){let e=!1;if(this.newEle=this.CrtNewEle(s,e),null==this.newEle)return e||(this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName+" 待插入元素为空",this.MessageError()),t=this.resMsg,t}let f=d;null==f&&(f=new i.UndoGroup),this.edt_elerange.SetEleEvtObjs(r,n.M_EleEvtHandler),this.edt_elerange.DelSelRange(127,f,this.resMsg);let g=new a.List;if(this.newEle instanceof u.XInputEle&&(this.newEle.EleStyle.CopyFrom(n.M_CaretEleStyle,!1),this.newEle.GetAllBaseChildren(g,!1)),g.Length>0)for(let e of g)super._UseCaretEleStyle(e),this.newEle instanceof u.XInputEle&&this.newEle.IsShowUnderLine_ShowSpace&&e instanceof u.XCharacterEle&&(e.EleStyle.XFontStyle.IsUnderline=!0),e.Parent instanceof u.XStringEle&&e.Parent.IsXInputBkgText&&(e.EleStyle.ForeColor=h.TextDocApiConst.InputFieldBackTextForeColor);this.edt_elerange.InsertNewEle(this.newEle,p,c,!0,f,this.resMsg)<0||(null==d&&super._AddUndoItem(f),null!=this.newEle&&"IScriptMsg"==this.newEle.GetType()&&o.MsgRegisterHandler.RegisterExpressionToMsgBus(n.M_DocumentFocused),super._RefreshPageAndMoveCaret(!0,!0)),t=this.resMsg}else this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName+" 请确定插入光标位置",this.MessageError(),t=this.resMsg;return t}CrtNewEle(e,t){return!1,null}}t.A_InsertElement=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{static arraycopy(e,t,n,r,i){for(;i--;)n[r++]=e[t++]}static currentTimeMillis(){return Date.now()}static TryParse(e,t,n){return t}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.OTHER=0]="OTHER",e[e.PURE_BARCODE=1]="PURE_BARCODE",e[e.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",e[e.TRY_HARDER=3]="TRY_HARDER",e[e.CHARACTER_SET=4]="CHARACTER_SET",e[e.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",e[e.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",e[e.ASSUME_GS1=7]="ASSUME_GS1",e[e.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",e[e.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",e[e.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"}(r||(r={})),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Font=void 0;const r=n(3),i=n(21),l=n(301),s=n(103);var o=new r.Dictionary;o.Add("宋体",new l.FontFamily("SimSun","宋体")),o.Add("黑体",new l.FontFamily("SimHei","黑体")),o.Add("微软雅黑",new l.FontFamily("Microsoft Yahei","微软雅黑")),o.Add("微软正黑体",new l.FontFamily("Microsoft JhengHe","微软正黑体")),o.Add("楷体",new l.FontFamily("KaiTi","楷体")),o.Add("新宋体",new l.FontFamily("NSimSun","新宋体")),o.Add("仿宋",new l.FontFamily("FangSong","仿宋"));var a=new r.Dictionary;a.Add("苹方",new l.FontFamily("PingFang SC","苹方")),a.Add("华文黑体",new l.FontFamily("STHeiti","华文黑体")),a.Add("华文楷体",new l.FontFamily("STKaiti","华文楷体")),a.Add("华文宋体",new l.FontFamily("STSong","华文宋体")),a.Add("华文仿宋",new l.FontFamily("STFangsong","华文仿宋")),a.Add("华文中宋",new l.FontFamily("STZhongsong","华文中宋")),a.Add("华文琥珀",new l.FontFamily("STHupo","华文琥珀"));var u=new r.Dictionary;u.Add("幼圆",new l.FontFamily("YouYuan","幼圆")),u.Add("隶书",new l.FontFamily("LiSu","隶书")),u.Add("华文细黑",new l.FontFamily("STXihei","华文细黑")),u.Add("华文彩云",new l.FontFamily("STCaiyun","华文彩云")),u.Add("楷体",new l.FontFamily("FZShuTi","楷体")),u.Add("方正舒体",new l.FontFamily("NSimSun","方正舒体")),u.Add("方正姚体",new l.FontFamily("FZYaoti","方正姚体"));t.Font=class{constructor(e,t,n){this._name=null,this._size=0,this._fontStyle=null,this._name=e,this._size=t,this._fontStyle=n}get Name(){return this._name}get Size(){return this._size}set Size(e){e>0&&(this._size=e)}get SizeInPoints(){return this._size}get Height(){return 0}get FontWidth(){return null}get Bold(){return(this._fontStyle&s.FontStyle.Bold)==s.FontStyle.Bold}get Underline(){return(this._fontStyle&s.FontStyle.Underline)==s.FontStyle.Underline}get Italic(){return(this._fontStyle&s.FontStyle.Italic)==s.FontStyle.Italic}get Strikeout(){return(this._fontStyle&s.FontStyle.Strikeout)==s.FontStyle.Strikeout}get FontFamily(){let[e,t]=o.TryGetValue(this.Name);return e||([e,t]=a.TryGetValue(this.Name)),e||([e,t]=u.TryGetValue(this.Name)),e||(t=o.Get("宋体")),t}get Style(){return this._fontStyle}SystemFontName(){return"SimSun"}IsSystemFont(){return this.SystemFontName()==this.Name}toString(){let e=new i.default;return this.Italic?e.append("italic"):e.append("normal"),this.Bold?e.append(" bold"):e.append(" normal"),e.append(" "+this.Size+"pt"),e.append(" "+this.Name),e.toString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dialog=void 0;const r=n(12),i=n(139),l=n(24);n(774);class s extends r.Component{constructor(e){super(e),this.onMouseDown=e=>{let t=e.clientX,n=e.clientY;const{styleLeft:r,styleTop:i}=this.state;document.body.onmousemove=e=>{let l=e.clientX-t+r,s=e.clientY-n+i;this.InWindow(e.clientX,e.clientY,t,n)?this.setState({styleLeft:l,styleTop:s}):(document.body.onmousemove=null,document.body.onmouseup=null),e.preventDefault(),e.stopPropagation()},document.body.onmouseup=function(e){document.body.onmousemove=null,document.body.onmouseup=null,e.preventDefault(),e.stopPropagation()},e.preventDefault(),e.stopPropagation()},this.InWindow=(e,t,n,r)=>{let i=document.body.clientHeight,l=document.body.clientWidth;return!(e<20&&n>e||e>l-20&&n<e||t<20&&r>t||t>i-20&&r<t)},this.okHandler=()=>{this.props.onOk(),this.setVisible(!1)},this.closeHandler=()=>{this.props.onCancel(),this.setVisible(!1)},this.state={styleTop:0,styleLeft:0,styleHeight:e.height,styleWidth:e.width,visible:!1,fadeInOut:!0,isRender:!0,isDrag:e.isDrag}}componentDidMount(){this.setVisible(this.props.visible),document.body.onkeyup=e=>{"Escape"===e.code&&(this.props.onCancel(),this.setVisible(!1))}}componentDidUpdate(e,t,n){e.visible!=this.props.visible&&this.setVisible(this.props.visible)}renderFooter(){return this.props.showFooter?r.createElement("div",{className:"pango-editor-dialog-footer"},r.createElement(i.Button,{text:"取消",type:"default",width:60,height:32,onClick:this.closeHandler}),r.createElement(i.Button,{text:"确定",type:"primary",width:60,height:32,onClick:this.okHandler})):null}setVisible(e){e?(this.setState({visible:!0}),setTimeout(()=>{this.setState({fadeInOut:!1})})):(this.setState({fadeInOut:!0}),setTimeout(()=>{this.setState({visible:!1}),this.setState({fadeInOut:!1})},300),this.props.isDestroy&&setTimeout(()=>{this.setState({isRender:!1})}))}render(){let{style:e,title:t,zIndex:n,width:i,height:s,className:o}=this.props,{visible:a,fadeInOut:u,isRender:h,isDrag:d,styleTop:c,styleLeft:p}=this.state,f=i+"px",g=s+"px",m=Object.assign({width:f,height:g,top:c+"px",left:p+"px"},e),E=d?" isDrag":"";return h?l.createPortal(r.createElement("div",{className:"pango-editor-mask"+(u?" fadeInOut":"")+(o?" "+o:""),style:{zIndex:n,display:a?"flex":"none"}},r.createElement("div",{className:"pango-editor-dialog"+E,style:m},r.createElement("div",{className:"pango-editor-dialog-header",onMouseDown:d?this.onMouseDown.bind(this):()=>{}},r.createElement("span",{className:"pango-editor-dialog-title"},t),r.createElement("span",{className:"pango-editor-dialog-closeBtn",onClick:this.closeHandler},"×")),r.createElement("div",{className:"pango-editor-dialog-content"},this.props.children),this.renderFooter())),document.getElementsByTagName("body").item(0)):null}}t.Dialog=s,s.defaultProps={className:"",title:"",showFooter:!0,visible:!1,isDestroy:!1,isDrag:!0,style:{},width:500,zIndex:1e3,onOk:()=>{},onCancel:()=>{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SolidBrush=void 0;const r=n(491);class i extends r.Brush{constructor(e){super(),this._value=e}get Color(){return this._value}set Color(e){this._value=e}Dispose(){}}t.SolidBrush=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ElementInfo=void 0;const r=n(37);t.ElementInfo=class{constructor(){this._Activation_Mode_Key=null,this._Text_Expression=null,this._Fg_edit=null,this._Fg_encrypt=null,this._ShowDialog=null,this._Fg_delete=null,this._Fg_border=null,this._Fg_hide=null,this._Id_mraet=null,this._Name_mraet=null,this._Id_mratermgrp=null,this._CanEmpty=null,this._IsSensitiveInfo=null,this._DefaultValue=null,this._DiagnoseType=null,this._Arrangement=null,this._SplitChar=null,this._ShowWay=null,this._InTable=null,this._InTableColIx=0,this._DefalutValueIsChanged=null,this._CheckMaxValue=null,this._CheckMinValue=null,this._IsRefreshSysTime=null,this._HasSearch=!0,this._QuoteSource=!1,this._QuoteTarget=!1,this.CanEmpty=!0,this.Activation_Mode_Key=r.TextDocApiConst.InputFormActMode,this.IsAllowKeyInput=!0}get conceptDomainCode(){return this._conceptDomainCode}set conceptDomainCode(e){this._conceptDomainCode=e}get Id_mr_de(){return this.id_mr_de}set Id_mr_de(e){this.id_mr_de=e}get Name(){return this.name}set Name(e){this.name=e}get CptID(){return this._cptid}set CptID(e){this._cptid=e}get LackEllipsisvalue(){return this._lackEllipsisvalue}set LackEllipsisvalue(e){this._lackEllipsisvalue=e}get DynamicData(){return this._dynamicData}set DynamicData(e){this._dynamicData=e}get InputEventName(){return this._inputEventName}set InputEventName(e){this._inputEventName=e}get Code_de(){return this.code_de}set Code_de(e){this.code_de=e}get Name_de(){return this.name_de}set Name_de(e){this.name_de=e}get ValueCode_de(){return this.valuecode_de}set ValueCode_de(e){this.valuecode_de=e}get Code_mrdetp(){return this.code_mrdetp}set Code_mrdetp(e){this.code_mrdetp=e}get Text_label(){return this.text_label}set Text_label(e){this.text_label=e}get Suffix_label(){return this._suffix_label}set Suffix_label(e){this._suffix_label=e}get Text_background(){return this.text_background}set Text_background(e){this.text_background=e}get Text_tip(){return this.text_tip}set Text_tip(e){this.text_tip=e}get Activation_Mode_Key(){return this._Activation_Mode_Key}set Activation_Mode_Key(e){this._Activation_Mode_Key=e}get Text_Expression(){return this._Text_Expression}set Text_Expression(e){this._Text_Expression=e}get Fg_edit(){return this._Fg_edit}set Fg_edit(e){this._Fg_edit=e}get Fg_encrypt(){return this._Fg_encrypt}set Fg_encrypt(e){this._Fg_encrypt=e}get ShowDialog(){return this._ShowDialog}set ShowDialog(e){this._ShowDialog=e}get Fg_delete(){return this._Fg_delete}set Fg_delete(e){this._Fg_delete=e}get Fg_border(){return this._Fg_border}set Fg_border(e){this._Fg_border=e}get Fg_hide(){return this._Fg_hide}set Fg_hide(e){this._Fg_hide=e}get Id_mraet(){return this._Id_mraet}set Id_mraet(e){this._Id_mraet=e}get Name_mraet(){return this._Name_mraet}set Name_mraet(e){this._Name_mraet=e}get Id_mratermgrp(){return this._Id_mratermgrp}set Id_mratermgrp(e){this._Id_mratermgrp=e}get Name_mratermgrp(){return this.name_mratermgrp}set Name_mratermgrp(e){this.name_mratermgrp=e}get CanEmpty(){return this._CanEmpty}set CanEmpty(e){this._CanEmpty=e}get IsSensitiveInfo(){return this._IsSensitiveInfo}set IsSensitiveInfo(e){this._IsSensitiveInfo=e}get DefaultValue(){return this._DefaultValue}set DefaultValue(e){this._DefaultValue=e}get DiagnoseType(){return this._DiagnoseType}set DiagnoseType(e){this._DiagnoseType=e}get Arrangement(){return this._Arrangement}set Arrangement(e){this._Arrangement=e}get SplitChar(){return this._SplitChar}set SplitChar(e){this._SplitChar=e}get ShowWay(){return this._ShowWay}set ShowWay(e){this._ShowWay=e}get InTable(){return this._InTable}set InTable(e){this._InTable=e}get InTableColIx(){return this._InTableColIx}set InTableColIx(e){this._InTableColIx=e}get DefalutValueIsChanged(){return this._DefalutValueIsChanged}set DefalutValueIsChanged(e){this._DefalutValueIsChanged=e}get CheckMaxValue(){return this._CheckMaxValue}set CheckMaxValue(e){this._CheckMaxValue=e}get CheckMinValue(){return this._CheckMinValue}set CheckMinValue(e){this._CheckMinValue=e}get Lg_max(){return this.lg_max}set Lg_max(e){this.lg_max=e}get Lg_min(){return this.lg_min}set Lg_min(e){this.lg_min=e}get Value_expression(){return this.value_expression}set Value_expression(e){this.value_expression=e}get Text_unit(){return this.text_unit}set Text_unit(e){this.text_unit=e}get Nu_digit(){return this.nu_digit}set Nu_digit(e){this.nu_digit=e}get Nu_max(){return this.nu_max}set Nu_max(e){this.nu_max=e}get Nu_min(){return this.nu_min}set Nu_min(e){this.nu_min=e}get Valuelist(){return this.valuelist}set Valuelist(e){this.valuelist=e}get Text_unitList(){return this.text_unitList}set Text_unitList(e){this.text_unitList=e}get Su_des(){return this.su_des}set Su_des(e){this.su_des=e}get Ne_des(){return this.ne_des}set Ne_des(e){this.ne_des=e}get SelModel(){return this._SelModel}set SelModel(e){this._SelModel=e}get Dt_format(){return this.dt_format}set Dt_format(e){this.dt_format=e}get IsRefreshSysTime(){return this._IsRefreshSysTime}set IsRefreshSysTime(e){this._IsRefreshSysTime=e}get Out_style(){return this.out_style}set Out_style(e){this.out_style=e}get Out_format(){return this.out_format}set Out_format(e){this.out_format=e}get Fg_qs(){return this.fg_qs}set Fg_qs(e){this.fg_qs=e}get Fg_quote(){return this.fg_quote}set Fg_quote(e){this.fg_quote=e}get RefCode(){return this._RefCode}set RefCode(e){this._RefCode=e}get RefName(){return this._RefName}set RefName(e){this._RefName=e}get ActiveStyle(){return this._ActiveStyle}set ActiveStyle(e){this._ActiveStyle=e}get RefIsMulSel(){return this._RefIsMulSel}set RefIsMulSel(e){this._RefIsMulSel=e}get RefResultIsVertLayout(){return this._RefResultIsVertLayout}set RefResultIsVertLayout(e){this._RefResultIsVertLayout=e}get RefResultSpliteStr(){return this._RefResultSpliteStr}set RefResultSpliteStr(e){this._RefResultSpliteStr=e}get RefResultFormatStr(){return this._RefResultFormatStr}set RefResultFormatStr(e){this._RefResultFormatStr=e}get LastSpliteCharShowRule(){return this._LastSpliteCharShowRule}set LastSpliteCharShowRule(e){this._LastSpliteCharShowRule=e}get IsQrCode(){return this._IsQrCode}set IsQrCode(e){this._IsQrCode=e}get CodeRule(){return this._CodeRule}set CodeRule(e){this._CodeRule=e}get BulidCodeRightNow(){return this._BulidCodeRightNow}set BulidCodeRightNow(e){this._BulidCodeRightNow=e}get QrCode_IsShowLabelText(){return this._QrCode_IsShowLabelText}set QrCode_IsShowLabelText(e){this._QrCode_IsShowLabelText=e}get QrCode_LabelText(){return this._QrCode_LabelText}set QrCode_LabelText(e){this._QrCode_LabelText=e}get QrCode_LabelTextPosition(){return this._QrCode_LabelTextPosition}set QrCode_LabelTextPosition(e){this._QrCode_LabelTextPosition=e}get QrCode_IsAllowDrag(){return this._QrCode_IsAllowDrag}set QrCode_IsAllowDrag(e){this._QrCode_IsAllowDrag=e}get IsShowRightText(){return this._IsShowRightText}set IsShowRightText(e){this._IsShowRightText=e}get OnlyPrintCheckedItem(){return this._OnlyPrintCheckedItem}set OnlyPrintCheckedItem(e){this._OnlyPrintCheckedItem=e}get IsTextRightShow(){return this._IsTextRightShow}set IsTextRightShow(e){this._IsTextRightShow=e}get IsStrongShow(){return this._IsStrongShow}set IsStrongShow(e){this._IsStrongShow=e}get BaseChoiceShowStyle(){return this._BaseChoiceShowStyle}set BaseChoiceShowStyle(e){this._BaseChoiceShowStyle=e}get IsMustChoose(){return this._IsMustChoose}set IsMustChoose(e){this._IsMustChoose=e}get VAlign(){return this._VAlign}set VAlign(e){this._VAlign=e}get Name_source(){return this._Name_source}set Name_source(e){this._Name_source=e}get ExtendAttr1(){return this._ExtendAttr1}set ExtendAttr1(e){this._ExtendAttr1=e}get Name_property(){return this.name_property}set Name_property(e){this.name_property=e}get SelectRowXId(){return this._SelectRowXId}set SelectRowXId(e){this._SelectRowXId=e}get SqlText(){return this._SqlText}set SqlText(e){this._SqlText=e}get CustomAttribute(){return this._CustomAttribute}set CustomAttribute(e){this._CustomAttribute=e}get Sql_WriteBack_PropName(){return this._Sql_WriteBack_PropName}set Sql_WriteBack_PropName(e){this._Sql_WriteBack_PropName=e}get IsAddCallBack(){return this._IsAddCallBack}set IsAddCallBack(e){this._IsAddCallBack=e}get IsAllowKeyInput(){return this._IsAllowKeyInput}set IsAllowKeyInput(e){this._IsAllowKeyInput=e}get CanBeInLine_StartBorder(){return this._CanBeInLine_StartBorder}set CanBeInLine_StartBorder(e){this._CanBeInLine_StartBorder=e}get CanBeInLine_EndBorder(){return this._CanBeInLine_EndBorder}set CanBeInLine_EndBorder(e){this._CanBeInLine_EndBorder=e}get IsDisSkip(){return this._IsDisSkip}set IsDisSkip(e){this._IsDisSkip=e}get IsPrint(){return this._isPrint}set IsPrint(e){this._isPrint=e}get Occupying_Num(){return this._Occupying_Num}set Occupying_Num(e){this._Occupying_Num=e}get IsStartUp_UnderLine(){return this._IsStartUp_UnderLine}set IsStartUp_UnderLine(e){this._IsStartUp_UnderLine=e}get DefaultCurrentTimeFlag(){return this._defaultCurrentTimeFlag}set DefaultCurrentTimeFlag(e){this._defaultCurrentTimeFlag=e}get PrintCurrentTimeFlag(){return this._PrintCurrentTimeFlag}set PrintCurrentTimeFlag(e){this._PrintCurrentTimeFlag=e}get EditorEventActiveMode(){return this._editorEventActiveMode}set EditorEventActiveMode(e){this._editorEventActiveMode=e}get HasSearch(){return this._HasSearch}set HasSearch(e){this._HasSearch=e}get QuoteSource(){return this._QuoteSource}set QuoteSource(e){this._QuoteSource=e}get QuoteTarget(){return this._QuoteTarget}set QuoteTarget(e){this._QuoteTarget=e}get Gender(){return this._gender}set Gender(e){this._gender=e}get MaxAge(){return this._maxAge}set MaxAge(e){this._maxAge=e}get MinAge(){return this._minAge}set MinAge(e){this._minAge=e}get EditorMode(){return this._editorMode}set EditorMode(e){this._editorMode=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrEditEleRange=void 0;const r=n(2),i=n(0),l=n(16),s=n(79),o=n(94),a=n(143),u=n(4),h=n(106),d=n(138),c=n(13),p=n(95),f=n(108),g=n(240);class m extends f.EditEleRange{constructor(){super(),this.eleEvtModel=null,this.eleEvtHandler=null,this.rangeEdtAssist=null,this.rangeEdtAssist=new g.EditEleRangeAssist}SetEleEvtObjs(e,t){this.eleEvtModel=e,this.eleEvtHandler=t,super.ClickedEleWrap=null==e?null:e.EleClickedWrap,this.rangeEdtAssist.SetEleEvtModel(e)}IsSelRangeValid(){let e;if(null==this.eleEvtModel)e=!1;else{let t=this.eleEvtModel.SelRange;e=null!=t&&t.IsValid()}return e}DelSelRange(e,t,n,r=!0){if(null!=this.eleEvtModel){let e=this.eleEvtModel.SelRange;this.DelLineSelRange(e,t,n,r)}}DelLineSelRange(e,t,n,s=!0){if(null!=e&&e.IsValid()&&this.eleEvtModel.WorkMode!=r.ENumWorkMode.Browse&&this.eleEvtModel.WorkMode!=r.ENumWorkMode.KeepTrace){let n=e.InfoUtil.GetLineElesInRange(!0,!0,!0),o=null==n?0:n.length;if(o>0){let u=super.ClickedEleWrap.EleFocused,h=this.rangeEdtAssist.FindEleIxCannotDel(n),d=null==h?0:h.length;if(d-1>=o)e.Clear();else{let c=new a.XPageLineSelRange,p=-1,f=-1,g=0,m=[];for(let e=0;e<d;e++){let l=h[e];if(l<o&&n[l]instanceof i.XBaseContainer&&this._ClearSelNodelContainer(n[l],t,c),l<=g)g=l+1;else{p<0&&(p=g),f=l-1;let e=this.rangeEdtAssist.SplitSubRangeByTraceUser(n,g,l);for(let i=0;i<e.length;i++){let l=e[i];const o=this.eleEvtModel.WorkMode==r.ENumWorkMode.App||this.eleEvtModel.WorkMode==r.ENumWorkMode.Form,a=this.eleEvtModel.M_xdocEditor.M_EdtCustomEvtGrp.AppKeepTrace;o&&a&&s?this.rangeEdtAssist.RemoveSubRangeAsTrace(n,l,t):this.rangeEdtAssist.RemoveSubRange(n,l,t)}g=l+1,m.push([p,f])}}for(let e=0;e<m.length;e++){let r=m[e][0],i=m[e][1],s=!0,o=r<0?null:l.XDomUtil.GetParentXInput(n[r],!0),a=i<0?null:l.XDomUtil.GetParentXInput(n[i],!0);a==o&&(a=null),l.XDomUtil.TrySwitchXInputToEmpty(-1,s,o,null,t),l.XDomUtil.TrySwitchXInputToEmpty(-1,s,a,null,t)}let E=null==h?-1:h[0],C=E<0||E>=o?null:n[E],A=this.rangeEdtAssist.After_DelElesRange_EleCursor(C,e);t.CursorUndoEle=u,t.CursorRedoEle=A,e.Clear();let y=this.rangeEdtAssist.FindXStrFromSelRange(n);null!=y&&this.eleEvtHandler.OnTextChanged(y);let I=this.rangeEdtAssist.FindXInputStartBdrsInRange(null,n);this.rangeEdtAssist.UpdateXDocXinputCache(I)}}}}HaveCanNotDelELe(){let e=this.eleEvtModel.SelRange;if(null!=e&&e.IsValid()&&this.eleEvtModel.WorkMode!=r.ENumWorkMode.Browse&&this.eleEvtModel.WorkMode!=r.ENumWorkMode.KeepTrace){let t=e.InfoUtil.GetLineElesInRange(!0,!0,!0),n=null==t?0:t.length;if(n>0){super.ClickedEleWrap.EleFocused;if(this.rangeEdtAssist.FindEleIxCannotDel(t).length>=2)return!0;for(let e=0;e<n;e++){if(t[e]instanceof i.XTextTableCell)return!0}}}return!1}_ClearSelNodelContainer(e,t,n){if(null!=e&&e instanceof i.XTextTableCell){let r=e,i=new c.UndoGroup;n.SetFromIx(r.GetFirstChildBaseEle(!0)),n.SetToIx(r.GetLastChildEle(),!0),this.DelLineSelRange(n,i,null),t.AddItem(i)}}InsertNewEle(e,t,n,a,d,c,f=!0,g=!1){let m;if(null==this.eleEvtModel||null==this.eleEvtHandler)m=-1;else if(null==e)m=-1;else{let E=super.ClickedEleWrap.LineEleIxFocused,C=E.RefreshEleObj(!1);const A=this.eleEvtModel.WorkMode;if(o.EditorWorkModeUtil.ChkAddRuleForWorkMode(C,A,g)){let o,u=[-1];if(e instanceof i.XCharacterEle){const e=l.XDomUtil.PrepareParentXStr(u,E,d);o=e[0],u[0]=e[1]}else if(null!=t)o=t;else{const e=l.XDomUtil.PrepareParentComm(u,E,!1);o=e[0],u[0]=e[1]}if(null==o)m=-1;else{let c=n>=0&&(o==C.Parent||null!=t),g=c?n:u[0],A=this.eleEvtModel.ViewMode.IsCleanViewMode,y=-1,I=null;if(o instanceof s.XStringEle){let t=o;if(l.XDomUtil.HasContent(t.Parent,!1))y=t.SplitSelf(g,e,d);else{let n=l.XDomUtil.TrySwitchXInputToNotEmpty(!0,t,e,null,d);null!=n&&(e=n,y=t.Parent.GetChildInx(n),t=n)}a&&null!=t&&this.eleEvtHandler.OnTextChanged(t);let n=o.Parent,r=n.GetChildInx(e);r>=0&&(I=l.XDomUtil.GetNewCursorEle(n,r+1,!0))}else{if(!this.rangeEdtAssist.IsAddableByEleTp(o,e))return m=-1,m;I=c?e:o.GetChildBaseEle(g,A),y=o.AddChildEle(g,e),a&&y>=0&&this.eleEvtHandler.OnTextChanged(o);let t=new h.EleAddDelUndo(e,y,!0);d.AddItem(t)}let S=this.eleEvtModel.AddEdtHistAct;const _=this.eleEvtModel.M_xdocEditor.M_EdtCustomEvtGrp.AppKeepTrace;if(null!=S&&_&&f){"XParagraphFlag"==e.EleTypeName||"XTextLabelElement"==e.EleTypeName||S.Execute3(r.ENumEdtType.Add,d,[e])}y<0?m=-1:(E.ReplaceEle(I),d.CursorUndoEle=C,d.CursorRedoEle=I,p.EmrInnerUtil.UpdateXDocXinputCache(e instanceof i.XBaseInputEle?e:null),m=y)}this.eleEvtModel.M_xdocEditor.M_EleEvtHandler.OnTextChanged(o)}else{let e=C.GetInnerText(!this.eleEvtModel.ViewMode.IsCleanViewMode);u.default.IsNullOrEmpty(e)&&(e=C.GrpID),c.MsgLevel=5,c.MsgStr="当前工作模式下, 不能在元素 "+e+" 处编辑插入",m=-1}}return m}InsertNewEles(e,t,n,i,l,s=!0,o=!1){let a;if(null==t)a=!1;else if(null==this.eleEvtModel||null==this.eleEvtHandler)a=!1;else{let u=super.ClickedEleWrap.EleFocused,h=this.InsertNewEle(t,null,e,!1,i,l,s,o);if(h<0)a=!1;else{let e=t.Parent;if(n=this.rangeEdtAssist.RemoveEleCannotAdd(e,n),h=e.AddChildrenEle(h+1,n),h>=0){this.eleEvtHandler.OnTextChanged(e);let t=this.eleEvtModel.AddEdtHistAct;const l=this.eleEvtModel.M_xdocEditor.M_EdtCustomEvtGrp.AppKeepTrace;if(null!=t&&l&&s){let e;for(let t=0;t<n.length;t++){const r=n[t];"XParagraphFlag"==r.EleTypeName||"XTextLabelElement"==r.EleTypeName||(null==e&&(e=[]),e.push(r))}t.Execute3(r.ENumEdtType.Add,i,e)}let o=new d.EleRangeAddDelUndo(n,h,!0);i.AddItem(o)}i.CursorUndoEle=u,i.CursorRedoEle=super.ClickedEleWrap.EleFocused;let l=this.rangeEdtAssist.FindXInputStartBdrsInRange(t,n);this.rangeEdtAssist.UpdateXDocXinputCache(l),a=!0}}return a}static BuildElesFromStr(e,t,n,r){let o;if(n.Clear(),null==n||null==r)o=null;else{let e;if(null==e||e.length<=0)o=null;else{if(null==t){let e=r.LineEleIxFocused._GetNextEle(!1,!0,!0);t=null==e?null:e.EleStyle,l.XDomUtil.IsBkgTextOfXInput(e)&&(t=e.GetParentInputField().EleStyle)}let a=r.LineEleIxFocused.Line,u=null==a?null:a.RelEleParagraphStyle,h=e.length,d=new s.XStringEle;d.EleStyle.CopyFrom(t,!1),d.Text=e[0];for(let r=1;r<h;r++){let l=new i.XParagraphFlag;l.EleStyle.CopyFrom(u,!1),n.Add(l);let o=new s.XStringEle;o.EleStyle.CopyFrom(t,!1),o.Text=e[r],n.Add(o)}o=d}}return o}}t.EmrEditEleRange=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringFormat=void 0;const r=n(195),i=n(90),l=n(490),s=n(262);class o{constructor(e){this.alignment=null,this.formatFlags=null,this.lineAlignment=null,this.hotkeyPrefix=null,this.trimming=null,this.digitSubstitutionLanguage=0,null!=e&&(this.trimming=e.trimming,this.hotkeyPrefix=e.hotkeyPrefix,this.lineAlignment=e.lineAlignment,this.alignment=e.alignment,this.formatFlags=e.formatFlags)}static get GenericDefault(){let e=new o(null);return e.Alignment=i.StringAlignment.Near,e.DigitSubstitutionLanguage=0,e.FormatFlags=0,e.HotkeyPrefix=l.HotkeyPrefix.None,e.LineAlignment=i.StringAlignment.Near,e.Trimming=s.StringTrimming.Character,e}static get GenericTypographic(){let e=new o(null);return e.Alignment=i.StringAlignment.Near,e.DigitSubstitutionLanguage=0,e.FormatFlags=r.StringFormatFlags.FitBlackBox|r.StringFormatFlags.NoClip,e.HotkeyPrefix=l.HotkeyPrefix.None,e.LineAlignment=i.StringAlignment.Near,e.Trimming=s.StringTrimming.EllipsisCharacter,e}get FormatFlags(){return this.formatFlags}set FormatFlags(e){this.formatFlags=e}get Alignment(){return this.alignment}set Alignment(e){this.alignment=e}get LineAlignment(){return this.lineAlignment}set LineAlignment(e){this.lineAlignment=e}get HotkeyPrefix(){return this.hotkeyPrefix}set HotkeyPrefix(e){this.hotkeyPrefix=e}get Trimming(){return this.trimming}set Trimming(e){this.trimming=e}get DigitSubstitutionLanguage(){return this.digitSubstitutionLanguage}set DigitSubstitutionLanguage(e){this.digitSubstitutionLanguage=e}}t.StringFormat=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(49);t.default=class{constructor(e,t,n=(null==t?0:8*t.length),i,l,s=r.default.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=i,this.format=l,this.timestamp=s,this.text=e,this.rawBytes=t,this.numBits=null==n?null==t?0:8*t.length:n,this.resultPoints=i,this.format=l,this.resultMetadata=null,this.timestamp=null==s?r.default.currentTimeMillis():s}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){null!==e&&(null===this.resultMetadata?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(null===t)this.resultPoints=e;else if(null!==e&&e.length>0){const n=new Array(t.length+e.length);r.default.arraycopy(t,0,n,0,t.length),r.default.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}}getTimestamp(){return this.timestamp}toString(){return this.text}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseEleStyle=void 0;const r=n(210),i=n(82),l=n(8),s=n(10),o=n(115),a=n(104),u=n(7),h=n(14),d=n(130),c=n(4),p=n(26);class f extends d.XBasePropList{constructor(e){super(),this.isDefault=!1,this.dpiElePadd=i.Padding.Empty,this.index=-1,this.fontStyle=null,this._mutualExclusionColor=null,this.elePadd=i.Padding.Empty,this.isDefault=e;let t=this.isDefault?"Default":"Style";this.XmlEleName=t,this.isDefaultForeColor=!0,this.isDefaultBackgroundColor=!0,this.fontStyle=new r.XFontStyle(null),this.fontStyle.Default=this.isDefault,this.fontStyle.SetPropList(this.propList)}get Index(){return this.index}set Index(e){this.index=e}get VAlign(){let e=this.propList.GetPropValue("VAlign");return c.default.IsNullOrEmpty(e)?null:e}set VAlign(e){this.propList.ModifyProperty("VAlign",e,null)}get VAlign_ENumVal(){let e=this.VAlign;return a.StyleVAlignVals.GetEnumVAlign(e)}set VAlign_ENumVal(e){let t=a.StyleVAlignVals.GetVAlignStrVal(e);this.VAlign=t}get XFontStyle(){return this.fontStyle}get Font(){return this.fontStyle.BuildFont()}get isDefaultForeColor(){let e=this.propList.GetPropValue("isDefaultForeColor");if(null==e){let t=this.propList.GetColorValue("Color",null);e=!(t&&(!t||t.toString()!=u.Color.Black.toString())),this.propList.ModifyProperty("isDefaultForeColor",e,!0)}return l.CNumUtil.TryParseBool(e,!0)}set isDefaultForeColor(e){this.propList.ModifyProperty("isDefaultForeColor",e,!0)}get ForeColor(){let e=this._ForeColor||this.propList.GetColorValue("Color",u.Color.Black);if(null!=e){const t=e.ToRgbaString().split(",");let n=t[3];if(n=n.replace(")",""),Number(n)<.01){let n="";for(let e=0;e<t.length;e++)e!=t.length-1?n+=t[e]+",":n+="1)";e=new u.Color(n)}}return e}set ForeColor(e){this._ForeColor=e,this.isDefaultForeColor&&this.propList.SetColorValue("Color",u.Color.Black,u.Color.Black),this.propList.SetColorValue("Color",e,u.Color.Black)}get HistColor(){return this._HistColor}set HistColor(e){this._HistColor=e}set MutualExclusionColor(e){this._mutualExclusionColor=e}get MutualExclusionColor(){return this._mutualExclusionColor}get EditForeColor(){return this.propList.GetColorValue("EditColor",u.Color.Empty)}set EditForeColor(e){const t=p.TextDocInitInfo.GetInstance().InputFiled_IsDoctorEditorMode,n=p.TextDocInitInfo.GetInstance().InputFieldEditForeColor;t&&null!=n&&!n.IsEmpty()&&this.propList.SetColorValue("EditColor",e,u.Color.Empty)}get isDefaultBackgroundColor(){let e=this.propList.GetPropValue("isDefaultBackgroundColor");if(null==e){let t=this.propList.GetColorValue("Color",null);e=!(t&&(!t||t.toString()!=new u.Color("#FFFFFF").toString()&&t.toString()!=new u.Color("#332d5afa").toString())),this.propList.ModifyProperty("isDefaultBackgroundColor",e,e)}return l.CNumUtil.TryParseBool(e,!0)}set isDefaultBackgroundColor(e){this.propList.ModifyProperty("isDefaultBackgroundColor",e,e)}get BackgroundColor(){let e=this._BackgroundColor||this.propList.GetColorValue("BackgroundColor",null);if(null!=e){const t=e.ToRgbaString().split(",");if("1)"==t[3]){const n=p.TextDocInitInfo.GetInstance().InputFieldBackColor,r=n.ToRgbaString().split(",");r[0]==t[0]&&r[1]==t[1]&&r[2]==t[2]&&(e=n)}}return e}set BackgroundColor(e){this._BackgroundColor=e,this.propList.SetColorValue("BackgroundColor",e,null)}get TopBorderLineColor(){return this.propList.GetColorValue("TopBorderLineColor",null)}set TopBorderLineColor(e){this.propList.SetColorValue("TopBorderLineColor",e,null)}get BottomBorderLineColor(){return this.propList.GetColorValue("BottomBorderLineColor",null)}set BottomBorderLineColor(e){this.propList.SetColorValue("BottomBorderLineColor",e,null)}get LeftBorderLineColor(){return this.propList.GetColorValue("LeftBorderLineColor",null)}set LeftBorderLineColor(e){this.propList.SetColorValue("LeftBorderLineColor",e,null)}get RightBorderLineColor(){return this.propList.GetColorValue("RightBorderLineColor",null)}set RightBorderLineColor(e){this.propList.SetColorValue("RightBorderLineColor",e,null)}get Superscript(){let e=this.propList.GetPropValue("Superscript");return l.CNumUtil.TryParseBool(e,!1)}set Superscript(e){this.propList.ModifyProperty("Superscript",e,"false"),e&&this.propList.ModifyProperty("Subscript","false","false")}get Subscript(){let e=this.propList.GetPropValue("Subscript");return l.CNumUtil.TryParseBool(e,!1)}set Subscript(e){this.propList.ModifyProperty("Subscript",e,"false"),e&&this.propList.ModifyProperty("Superscript","false","false")}get EleBdrWidth(){let e=this.propList.GetPropValue("BorderWidth");return l.CNumUtil.TryParseInt(e,0)}set EleBdrWidth(e){this.EleRightBdrWidth=e,this.EleTopBdrWidth=e,this.propList.ModifyProperty("BorderWidth",l.CNumUtil.ToStringForNum(e),"0")}get EleRightBdrWidth(){let e=this.propList.GetPropValue("RightBdrWidth");return l.CNumUtil.TryParseInt(e,0)}set EleRightBdrWidth(e){this.propList.ModifyProperty("RightBdrWidth",l.CNumUtil.ToStringForNum(e),"0")}get EleTopBdrWidth(){let e=this.propList.GetPropValue("TopBdrWidth");return l.CNumUtil.TryParseInt(e,0)}set EleTopBdrWidth(e){this.propList.ModifyProperty("TopBdrWidth",l.CNumUtil.ToStringForNum(e),"0")}get ApplytoText(){let e=this.propList.GetPropValue("ApplytoText");return c.default.IsNullOrEmpty(e)?null:e}set ApplytoText(e){this.RightApplytoText=e,this.TopApplytoText=e,this.propList.ModifyProperty("ApplytoText",e,"表格")}get RightApplytoText(){let e=this.propList.GetPropValue("RightApplytoText");return c.default.IsNullOrEmpty(e)?null:e}set RightApplytoText(e){this.propList.ModifyProperty("RightApplytoText",e,"表格")}get TopApplytoText(){let e=this.propList.GetPropValue("TopApplytoText");return c.default.IsNullOrEmpty(e)?null:e}set TopApplytoText(e){this.propList.ModifyProperty("TopApplytoText",e,"表格")}get BorderLeft(){let e=this.propList.GetPropValue("BorderLeft");const t=this.defaultBorderFalseWithBdWidth(e);return l.CNumUtil.TryParseBool(e,t)}set BorderLeft(e){this.propList.ModifyProperty("BorderLeft",l.CNumUtil.ToStringForBool(e),"true")}get BorderRight(){let e=this.propList.GetPropValue("BorderRight");const t=this.defaultBorderFalseWithBdWidth(e);return l.CNumUtil.TryParseBool(e,t)}set BorderRight(e){this.propList.ModifyProperty("BorderRight",l.CNumUtil.ToStringForBool(e),"true")}get BorderTop(){let e=this.propList.GetPropValue("BorderTop");const t=this.defaultBorderFalseWithBdWidth(e);return l.CNumUtil.TryParseBool(e,t)}set BorderTop(e){this.propList.ModifyProperty("BorderTop",l.CNumUtil.ToStringForBool(e),"true")}get BorderBottom(){let e=this.propList.GetPropValue("BorderBottom");const t=this.defaultBorderFalseWithBdWidth(e);return l.CNumUtil.TryParseBool(e,t)}set BorderBottom(e){this.propList.ModifyProperty("BorderBottom",l.CNumUtil.ToStringForBool(e),"true")}defaultBorderFalseWithBdWidth(e){if(null==e&&!this.ApplytoText){if(null!=this.propList.GetPropValue("BorderWidth"))return!1}return!0}get BorderVerticalCenter(){let e=this.propList.GetPropValue("BorderVerticalCenter");return l.CNumUtil.TryParseBool(e,!0)}set BorderVerticalCenter(e){this.propList.ModifyProperty("BorderVerticalCenter",l.CNumUtil.ToStringForBool(e),"true")}get BorderHorizontalCenter(){let e=this.propList.GetPropValue("BorderHorizontalCenter");return l.CNumUtil.TryParseBool(e,!0)}set BorderHorizontalCenter(e){this.propList.ModifyProperty("BorderHorizontalCenter",l.CNumUtil.ToStringForBool(e),"true")}get DashStyle(){let e,t=this.propList.GetPropValue("DashStyle");return e=null==t?0:l.CNumUtil.TryParseInt(t,0),e}set DashStyle(e){this.RightDashStyle=e,this.TopDashStyle=e,this.propList.ModifyProperty("DashStyle",l.CNumUtil.ToStringForNum(e),"0")}get RightDashStyle(){let e,t=this.propList.GetPropValue("RightDashStyle");return e=null==t?0:l.CNumUtil.TryParseInt(t,0),e}set RightDashStyle(e){this.propList.ModifyProperty("RightDashStyle",l.CNumUtil.ToStringForNum(e),"0")}get TopDashStyle(){let e,t=this.propList.GetPropValue("TopDashStyle");return e=null==t?0:l.CNumUtil.TryParseInt(t,0),e}set TopDashStyle(e){this.propList.ModifyProperty("TopDashStyle",l.CNumUtil.ToStringForNum(e),"0")}get ElePadd(){return this.elePadd}set ElePadd(e){e!=this.elePadd&&(this.elePadd=e,this.propList.ModifyProperty("PaddingLeft",e.Left,0),this.propList.ModifyProperty("PaddingTop",e.Top,0),this.propList.ModifyProperty("PaddingRight",e.Right,0),this.propList.ModifyProperty("PaddingBottom",e.Bottom,0))}set ElePaddLeft(e){e!=this.elePadd.Left&&(this.elePadd.Left=e,this.propList.ModifyProperty("PaddingLeft",e,0))}set ElePaddRight(e){e!=this.elePadd.Right&&(this.elePadd.Right=e,this.propList.ModifyProperty("PaddingRight",e,0))}get CreatorIndex(){let e=this.propList.GetPropValue("CreatorIndex");return l.CNumUtil.TryParseInt(e,-1)}set CreatorIndex(e){this.propList.ModifyProperty("CreatorIndex",l.CNumUtil.ToStringForNum(e),"-1")}get DeleterIndex(){let e=this.propList.GetPropValue("DeleterIndex");return l.CNumUtil.TryParseInt(e,-1)}set DeleterIndex(e){this.propList.ModifyProperty("DeleterIndex",l.CNumUtil.ToStringForNum(e),"-1")}Clear(){this.isDefault||super.Clear(),this.index=-1}IsEmpty(){return this.propList.Count()<=0}SetDocument(e){null!=e&&(this.XFontStyle.DefaultStyle=e.GetDefaultStyle())}GetEleBdrWidthDPI(e){return s.DPITransUtil.TransIntVal(this.EleBdrWidth,300,e)}GetElePaddDPI(e){return this.dpiElePadd=s.DPITransUtil.TransPadding(this.elePadd,300,e),this.dpiElePadd}HasProp(e){return this.propList.HasProp(e)}RemoveProp(e){this.propList.RemoveProperties([e])}CopyFrom(e,t=!1){if(null==e)return;let n=this.CreatorIndex,r=this.DeleterIndex;this.index=e.index,this.propList.CopyFrom(e.propList),e.DeleterIndex>-1&&e.HistColor&&(this.ForeColor=e.HistColor),t||(this.CreatorIndex=n,this.DeleterIndex=r),this._After_AttrListFilled()}CopyPartialFrom(e,t){if(null!=e&&null!=t&&0!=t.length)for(let n=0;n<t.length;n++){let r=t[n],i=e.propList.GetPropValue(r);this.propList.ModifyProperty(r,i,null)}}BuildCommStyle(e){this.Clear();let t=null==e?0:e.length;if(t>0)for(let n=0;n<t;n++){let t=e[n].EleStyle;this.propList.KeepCommProps(t.propList)}}IsEqual(e){let t=null!=e,n=null!=this.propList,r=this.propList.IsEqual(e.propList);return t&&n&&r}ToXML(e){let t=super.ToXML(e);if(null==t)return null;if(this.index>=0)return t.setAttribute("Index",l.CNumUtil.ToStringForNum(this.index)),t;{let n=o.XmlNsTags.GetURI("xsi"),r=e.createAttributeNS(n,"xsi:type");r.value="DocumentContentStyle",t.setAttributeNode(r)}return t}FromXML(e){if(null==e)return;super.FromXML(e);let t=h.XmlDomUtil.GetSingleAttrValue(e,"Index");this.index=l.CNumUtil.TryParseInt(t,-1),this._After_AttrListFilled()}_After_AttrListFilled(){this._FromXML_Padd()}_FromXML_Padd(){let e=this.propList.GetPropValue("PaddingLeft");this.elePadd.Left=l.CNumUtil.TryParseInt(e,0),e=this.propList.GetPropValue("PaddingTop"),this.elePadd.Top=l.CNumUtil.TryParseInt(e,0),e=this.propList.GetPropValue("PaddingRight"),this.elePadd.Right=l.CNumUtil.TryParseInt(e,0),e=this.propList.GetPropValue("PaddingBottom"),this.elePadd.Bottom=l.CNumUtil.TryParseInt(e,0)}}t.XBaseEleStyle=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClickedElementWrapper=void 0;const r=n(17),i=n(0),l=n(9),s=n(6),o=n(132),a=n(2),u=n(20);class h{constructor(e){this.origElePosInLine=r.PointF.Empty,this.pageFocused=null,this.lastPageFocused=null,this.lineEleIx=null,this.backup=null,this.clickPosInCtrl=r.PointF.Empty,this.cursorPosInDom=r.PointF.Empty,this.clickPosYDiff=0,this.lineEleIx=new o.XLineEleIx,e&&(this.backup=new h(!1))}get ClickPosInCtrl(){return this.clickPosInCtrl}set ClickPosInCtrl(e){this.clickPosInCtrl=e}get CursorPosInDom(){return this.cursorPosInDom}set CursorPosInDom(e){this.cursorPosInDom=e}get ClickPosYDiff(){return this.clickPosYDiff}set ClickPosYDiff(e){this.clickPosYDiff=e}get PageFocused(){let e,t=this.EleFocused;return e=this.eleIseInTHead(t)||null==t?null:t.OwnPageView,null==e&&(e=this.pageFocused),e}set PageFocused(e){this.lastPageFocused=this.pageFocused,this.pageFocused=e}get LineEleIxFocused(){return this.lineEleIx}get EleFocused(){return null==this.lineEleIx?null:this.lineEleIx.RefreshEleObj(!1)}GetNextEle(e){return this.lineEleIx._GetNextEle(e,!1,!1)}IsValid(){return null!=this.lineEleIx&&this.lineEleIx.IsValid()}IsValidBaseEle(){let e;if(null!=this.lineEleIx&&this.lineEleIx.IsValid()){let t=this.lineEleIx.RefreshEleObj(!1);e=null!=t&&!(t instanceof i.XBaseContainer)}else e=!1;return e}CopyFrom(e){null!=e&&(this.CopyClickPosition(e),this.pageFocused=e.pageFocused,this.lastPageFocused=null,this.lineEleIx.CopyFrom(e.lineEleIx))}CopyClickPosition(e){null!=e&&(this.clickPosInCtrl=e.clickPosInCtrl,this.origElePosInLine=e.origElePosInLine,this.clickPosYDiff=e.clickPosYDiff)}MovetoLineEnd(e){let t,n=this.lineEleIx.Line.ElementCnt,r=this.lineEleIx.EleIx,i=e?n-r-1:-r;if(0==i)t=!0;else{t=this._SkipEles_SameLine(i)}return t}_SkipEles_SameLine(e){if(0==e)return!1;let t=e>0;t||(e=-e);let n=!1;for(let r=0;r<e&&(n=this.lineEleIx._MovetoNextEle(t),n);r++);return n&&this.SkipElesForbidCursor(t),n}MovetoNextEle(e,t=!1){let n=this.lineEleIx._MovetoNextEle(e);return n&&this.SkipElesForbidCursor(e,t),n}SkipElesForbidCursor(e,t=!1){do{let e=this.EleFocused,n=this.LineEleIxFocused._GetNextEle(!1,!0,!1);if(null==e||null==n)break;if((t||e.EleCursorAllowSide!=a.ENumEleCursorSide.ForceRight)&&(t||n.EleCursorAllowSide!=a.ENumEleCursorSide.ForceLeft))break}while(this.LineEleIxFocused._MovetoNextEle(e))}MovetoNextLine(e){return this.lineEleIx._MovetoNextLine(e,this.origElePosInLine)}Clear(e=!0){this.pageFocused=null,this.lastPageFocused=null,this.lineEleIx.Clear(),this.clickPosYDiff=0,this.clickPosInCtrl=r.PointF.Empty,this.origElePosInLine=r.PointF.Empty,e&&this.ClearBackup()}ClearBackup(){null!=this.backup&&this.backup.Clear(!0)}static GetElePosInCtrl(e,t,n){let i=r.PointF.Empty;if(null==e)return r.PointF.Empty;null==t&&(t=e.OwnPageView);let s;i.X=.32*e.RealLeft,i.Y=.32*e.RealTop;for(let t=e.OwnerLine;null!=t;t=null==s?null:s.OwnerLine)i.X+=t.GetAlignLeft(96),s=t.Container;i.X+=1,i.Y+=1;let o=l.RectangleF.Empty;return null!=t&&(o=t.GetPageRectUI(96)),i.X+=o.X,i.Y+=o.Y,i.X*=n,i.Y*=n,i}static GetEleRectInCtrl(e,t,n){if(null==e)return l.RectangleF.Empty;if(!e.CanBeInline(!1)&&e instanceof i.XBaseContainer){e=e.GetFirstChildBaseEle(!0)}if(null==e)return l.RectangleF.Empty;let r=e.GetBoundsDPI(96);r.Width*=n,r.Height*=n;let s=h.GetElePosInCtrl(e,t,n);return r.X=s.X,r.Y=s.Y,r}get MarkEleClicked(){return null==this.lineEleIx?null:this.lineEleIx.MarkEle}get EleFocusedPgPanelTp(){let e=this.EleFocused;return null==(null==e?null:e.OwnerDocPanel)?s.ENumPagePanelTp.Body:e.OwnerDocPanel.PagePanelTp}UpdateOrigElePosInLine(){this.IsValid()?(this.origElePosInLine.X=this.EleFocused.Bounds.X,this.origElePosInLine.Y=5):this.origElePosInLine=r.PointF.Empty}get LastPageFocused(){return this.lastPageFocused}Backup(){null!=this.backup&&this.backup.CopyFrom(this)}Restore(){null!=this.backup&&this.backup.IsValid()&&(this.CopyFrom(this.backup),this.ClearBackup())}GetNextRealEle(e,t){for(;null!=e&&"XLableInputBorder"==e.EleTypeName&&!e.Parent.IsBorderVisible&&(e.Parent.InnerValue||!t&&e.IsStartBorder||t&&!e.IsStartBorder);){if(!this.LineEleIxFocused._MovetoNextEle(t))break;e=this.GetNextEle(t)}return e}eleIseInTHead(e){if(null==e)return!1;const t=u.XTextTableUtil.GetCursorCell(e);if(null==t)return!1;const n=t.Parent.Parent;if(null==n)return!1;const r=n.THeadIx;if(!(r>=0))return!1;return r>=t.RowIndex}}t.ClickedElementWrapper=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrApiUtil=void 0;const r=n(337),i=n(44),l=n(6),s=n(172),o=n(3),a=n(696),u=n(341),h=n(344),d=n(345),c=n(2);class p{static LoadXDocBrowse(e,t){let n=p._Load_XDocBrowse(e,t);return null==n?null:n.XDocument}static _Load_XDocBrowse(e,t){let n;if(null!=t&&t.IsValid()){t.LineToPrint=null;let r=new d.XDocIOInfo;r.LoadXDoc(e,t);let i=r.XDocument;if(null==i)n=null;else{i.GetDocCtxt().EmrWorkMode=c.ENumWorkMode.Browse;let e=i.GetDocCtxt().ViewMode;e.IsCleanViewMode=!0,e.IsWebViewMode=!1,n=r}}else n=null;return n}static ConvertStrToFractionType(e){let t;if(null!=e){if("1"==e)return t=s.FractionType.Vert,t;if("2"==e)return t=s.FractionType.Oblique,t;if("3"==e)return t=s.FractionType.Hert,t}return t=s.FractionType.Vert,t}static ConvertFractionType(e){let t;if(null!=e){if("1"==e)return t=s.FractionType.Vert,t;if("2"==e)return t=s.FractionType.Oblique,t;if("3"==e)return t=s.FractionType.Hert,t}return t=s.FractionType.Vert,t}static ConvertFractionTypeToStr(e){return e.toString()}static GetEmrEditWrapperCtrl(e){const t=e.M_emrDocView;return t instanceof r.EmrDocView?t:null}static RegisterEle_PainterAndAchieve(){let e=new u.XCodePainter;i.TextDocApiUtil.SetPainterMapping("XBarcodeField",e);let t=new h.XInputBorderPainter;i.TextDocApiUtil.SetPainterMapping("XLableInputBorder",t)}static HasSelection(e){let t=e.M_EleEvtModel.SelRange;return null!=t&&t.IsValid()}static GetScriptEleList(e,t){let n=new a.Type("IScriptMsg"),r=p.GetElesByObjType(n,e,t),i=new o.List;for(let e=0;e<r.Count();e++){const t=r.Get(e);if("IScriptMsg"==t.GetType()){t.CanReflect&&i.Add(t)}}return i}static GetElesByObjType(e,t,n){let r=new o.List;return i.TextDocApiUtil.GetChildrenByClassType(e,t,r,n.GetPagePanel(l.ENumPagePanelTp.Header)),i.TextDocApiUtil.GetChildrenByClassType(e,t,r,n.GetPagePanel(l.ENumPagePanelTp.Body)),i.TextDocApiUtil.GetChildrenByClassType(e,t,r,n.GetPagePanel(l.ENumPagePanelTp.Footer)),r}}t.EmrApiUtil=p},function(e,t,n){"use strict";var r=n(390),i=Object.prototype.toString;function l(e){return"[object Array]"===i.call(e)}function s(e){return void 0===e}function o(e){return null!==e&&"object"==typeof e}function a(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===i.call(e)}function h(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),l(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:l,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:o,isPlainObject:a,isUndefined:s,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:u,isStream:function(e){return o(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:h,merge:function e(){var t={};function n(n,r){a(t[r])&&a(n)?t[r]=e(t[r],n):a(n)?t[r]=e({},n):l(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)h(arguments[r],n);return t},extend:function(e,t,n){return h(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextDocument=void 0;const r=n(418),i=n(260),l=n(487),s=n(3),o=n(488),a=n(715),u=n(716),h=n(0),d=n(6),c=n(39),p=n(717),f=n(718),g=n(721),m=n(726),E=n(728),C=n(14),A=n(115),y=n(4),I=n(161),S=n(32);t.XTextDocument=class{constructor(e=!1){this._isDocFmtChanged=!1,this.docCtxt=null,this.cmmtBar=null,this.header=null,this.body=null,this.footer=null,this.isCleanLoad=!1,this.pageCols=null,this.pageFmt=null,this.commStyleList=null,this.outlineList=null,this.assist=null,this.docParams=null,this.waterMark=null,this.debugOptions=null,this.docSignatures=null,this.docUserHistories=null,this._readonly=!1,this._unEditableColor=null,this._topMarginFlag=!1,this._topMargin=80,this._newPage=!1,this._SaveWithTrace=!0,this._docStatusImage="",this._showDoc=!0,this.hasExpessionToRefreshDocView=!1,this.isCleanLoad=e,this.header=new h.XDocPanel(d.ENumPagePanelTp.Header),this.header.EleStyle=I.XEleStyleFactory.CreatXEleStyle(this.header.EleTypeName),this.footer=new h.XDocPanel(d.ENumPagePanelTp.Footer),this.footer.EleStyle=I.XEleStyleFactory.CreatXEleStyle(this.footer.EleTypeName),this.body=new h.XDocPanel(d.ENumPagePanelTp.Body),this.body.EleStyle=I.XEleStyleFactory.CreatXEleStyle(this.body.EleTypeName),this.cmmtBar=new h.XDocPanelCmmt,this.docParams=new a.XTextDocParams,this.pageFmt=new i.XPageFmtParams,this.pageCols=new l.XColumnsParams(this.body),this.waterMark=new u.XDocWaterMark(this),this.debugOptions=new g.XDebugOptions,this.docSignatures=new m.XSignatureList,this.docUserHistories=new E.XUserHistoryList,this.commStyleList=new p.XEleCommStyleList,this.outlineList=new f.XOutlineList,this.docCtxt=new r.XDocContext,this.assist=new o.XTextDocumentAssist(this),this.header.Document=this,this.body.Document=this,this.footer.Document=this,this.cmmtBar.Document=this,this.DocID=String((new Date).valueOf())}get IsDocFmtChanged(){return this._isDocFmtChanged}set IsDocFmtChanged(e){this._isDocFmtChanged=e}GetDocCtxt(){return this.docCtxt}get IsCleanLoad(){return this.isCleanLoad}GetPagePanel(e){let t=null;switch(e){case d.ENumPagePanelTp.Header:t=this.header;break;case d.ENumPagePanelTp.Body:t=this.body;break;case d.ENumPagePanelTp.Footer:t=this.footer;break;case d.ENumPagePanelTp.CmmtBar:t=this.cmmtBar}return t}GetBodyChildren(){return null!=this.body?this.body.ChildEleList:null}GetPageCols(){return this.pageCols}GetPageFmt(){return this.pageFmt}get CommStyleList(){return this.commStyleList}GetCommStyleList(){return this.commStyleList}GetDefaultStyle(){return this.commStyleList.GetDefaultStyle()}GetOutlineList(){return this.outlineList}GetInnerText(e=!0,t=!1){return this.body.GetInnerText(!1,e,t)}GetInnerTextWithAll(e=!0,t=!1){return this.body.GetInnerTextWithAll(!1,e,t)}get IsEditable(){return this.header.IsEditable||this.body.IsEditable||this.footer.IsEditable}set IsEditable(e){e!=this.IsEditable&&(this.header.IsEditable=this.footer.IsEditable=!1,this.body.IsEditable=e)}get Readonly(){return this._readonly}set Readonly(e){this._readonly=e}get UnEditableColor(){return this._unEditableColor}set UnEditableColor(e){this._unEditableColor=e}get TopMarginFlag(){return this._topMarginFlag}set TopMarginFlag(e){this._topMarginFlag=e}get TopMargin(){return this._topMargin}set TopMargin(e){this._topMargin=e}get NewPage(){return this._newPage}set NewPage(e){this._newPage=e}get SaveWithTrace(){return this._SaveWithTrace}set SaveWithTrace(e){this._SaveWithTrace=e}get DocStatusImage(){return this._docStatusImage}set DocStatusImage(e){this._docStatusImage=e}get ShowDoc(){return this._showDoc}set ShowDoc(e){this._showDoc=e}GetFirstBaseChild(e=!0){return null==this.body?null:this.body.GetFirstChildBaseEle(e)}_GetLastBaseChild(e=!0,t=!0){return null==this.body?null:this.body._GetLastBaseEle(e,t)}GetChildrenByType(e,t,n=!1){let r=new s.List;return this.body.GetChildrenByType(e,t,r,!1,n),r}ReverseEditableXDocPanel(){let e=this.body.IsEditable;this.body.IsEditable=!e,this.header.IsEditable=this.footer.IsEditable=e}GetHeaderLastChild(){return this.header.ChildEleList.Get(this.header.ChildCount-1)}GetBodyLastChild(){return this.body.ChildEleList.Get(this.body.ChildCount-1)}GetBodyFirstChild(){return this.body.LinesList.Get(0).ChildEleList.Get(0)}GetFooterLastChild(){return this.footer.ChildEleList.Get(this.footer.ChildCount-1)}get IsChanged(){return this.IsDocFmtChanged||this.header.IsChanged||this.body.IsChanged||this.footer.IsChanged||this.cmmtBar.IsChanged}ResetChangedFlag(){this.IsDocFmtChanged=!1,this.header.IsChanged=!1,this.body.IsChanged=!1,this.footer.IsChanged=!1,this.cmmtBar.IsChanged=!1}InvalidLayout(){let e=this.IsChanged;this.header.NotifyLayoutChanged(!1,!0),this.body.NotifyLayoutChanged(!1,!0),this.footer.NotifyLayoutChanged(!1,!0),this.cmmtBar.NotifyLayoutChanged(!1,!0),e||this.ResetChangedFlag()}get AssistFunc(){return this.assist}GetDocParams(){return this.docParams}GetWaterMark(){return this.waterMark}GetDebugOpts(){return this.debugOptions}GetSecurityOpts(){return this.debugOptions.GetDocOpts().GetSecurityOpt()}GetDocSignatures(){return this.docSignatures}GetUserHistoryList(){return this.docUserHistories}ToXML(){let e=C.XmlDomUtil.parseXMLFromString("<XTextDocument></XTextDocument>"),t=C.XmlDomUtil.GetSingleNode(e,"XTextDocument"),n=C.XmlDomUtil.CrtXmlAttr(e,y.default.Format("{0}:{1}","xmlns","xsi"),A.XmlNsTags.GetURI("xsi"),A.XmlNsTags.GetURI("xmlns"));t.setAttributeNode(n);let r=C.XmlDomUtil.CrtXmlAttr(e,"EditorVersion","V1.0-20210908",A.XmlNsTags.GetURI("xmlns"));t.setAttributeNode(r),this.commStyleList.Clear(!1,!1);let i=e.createElement("XElements");t.appendChild(i);let l=this.header.ToXML(e);i.appendChild(l);let s=this.body.ToXML(e);i.appendChild(s);let o=this.footer.ToXML(e);i.appendChild(o);let a=this.cmmtBar.ToXML(e);i.appendChild(a);let u=this.pageFmt.ToXML(e);t.appendChild(u);let h=this.pageCols.ToXML(e);t.appendChild(h);let d=this.waterMark.ToXML(e);null!=d&&t.appendChild(d),this.debugOptions.GetDocOpts().GetSecurityOpt().HasUserHistory=this.docUserHistories.Count>0;let c=this.debugOptions.ToXML(e);t.appendChild(c);let p=this.docParams.ToXML(e);t.appendChild(p);let f=this.docSignatures.ToXML(e);if(t.appendChild(f),this.SaveWithTrace){let n=this.docUserHistories.ToXML(e);t.appendChild(n)}let g=this.commStyleList.ToXML(e);t.appendChild(g);let m=e.createElement("BodyText");m.textContent=this.GetInnerText(),t.appendChild(m);let E=e.createElement("HeadText");return E.textContent=this.header.GetInnerText(!1),t.appendChild(E),e}resetChildrenList(e,t){let n=this.body.ChildEleList,r=new s.List;for(let t=e-1;t>0&&!(n.Get(t)instanceof h.XParagraphFlag);t--)r.Add(n.Get(t));r.Add(n.Get(e));for(let t=e+1;t<n.Length;t++){if(n.Get(t)instanceof h.XParagraphFlag){r.Add(n.Get(t));break}r.Add(n.Get(t))}for(let e of r)t.Add(e)}resetChildrenListById(e,t,n,r){let i,l=this.body.ChildEleList,o=new s.List,a=!1,u=!1;for(let t=0;t<l.Length;t++){let n=l.Get(t);if(n instanceof S.XTextLabelElement&&a&&i==n.TitleLevel)break;u&&o.Add(l.Get(t)),n instanceof S.XTextLabelElement&&n.CptID==e&&(u=!0,a=!0,i=n.TitleLevel)}let d=!1;for(let[e,i]of o.ToArray().entries())0==e&&!t&&i instanceof h.XButtonEle||d&&!n&&i instanceof h.XParagraphFlag||(0==e&&!n&&i instanceof h.XParagraphFlag||1==e&&!n&&i instanceof h.XParagraphFlag&&o.Get(0)instanceof h.XButtonEle?d=!0:(d=i instanceof h.XParagraphFlag,r.Add(i)))}GetChildrenListByCptId(e,t,n=!1){let r,i=this.body.ChildEleList,l=new s.List,o=!1,a=!1,u=null;for(let t=0;t<i.Length;t++){let s=i.Get(t);if(s instanceof S.XTextLabelElement&&o&&r>=s.TitleLevel){u=s;break}a&&(n?s instanceof h.XInputEle&&l.Add(i.Get(t)):l.Add(i.Get(t))),s instanceof S.XTextLabelElement&&s.CptID==e&&(a=!0,o=!0,r=s.TitleLevel)}for(let[e,n]of l.ToArray().entries()){if(n instanceof h.XTextTable){let e=new s.List;if(n.GetChildrenByType("XTextLabelElement",!0,e),e.Length>0)continue}t.Add(n)}return u}restoreChildrenList(e){this.body.ChildEleList.Clear();for(let t of e)this.body.ChildEleList.Add(t)}storeChildrenList(e){let t=this.body.ChildEleList;for(let n of t)e.Add(n)}get DocName(){return this.docParams.DocName}set DocName(e){null!=this.docParams&&(this.docParams.DocName=e)}get DocID(){return this.docParams.DocID}set DocID(e){null!=this.docParams&&(this.docParams.DocID=e)}get FirstDocStartPageNum(){return this.docParams.FirstDocStartPageNum}set FirstDocStartPageNum(e){null!=this.docParams&&(this.docParams.FirstDocStartPageNum=e)}get IsAssociatPageIndex(){return this.docParams.IsAssociatPageIndex}set IsAssociatPageIndex(e){null!=this.docParams&&(this.docParams.IsAssociatPageIndex=e)}FromXML(e){if(null==e)return;c.DateTime.Now.Ticks();let t=e.firstChild instanceof Element?e.firstChild:null;if(null==t)return;let n=C.XmlDomUtil.GetSingleNode(t,"PageSettings");this.pageFmt.FromXML(n);let r=C.XmlDomUtil.GetSingleNode(t,"PageCols");this.pageCols.FromXML(r);let i=C.XmlDomUtil.GetSingleNode(t,"WaterMark");this.waterMark.FromXML(i),this.waterMark.AutoFntSz();let l=C.XmlDomUtil.GetSingleNode(t,"ControlOptionsFor");this.debugOptions.FromXML(l);let s=C.XmlDomUtil.GetSingleNode(t,"Parameters");this.docParams.FromXML(s);let o=C.XmlDomUtil.GetSingleNode(t,"Signatures");if(this.docSignatures.FromXML(o),!this.isCleanLoad){let e=C.XmlDomUtil.GetSingleNode(t,"UserHistories");this.docUserHistories.FromXML(e)}let a=C.XmlDomUtil.GetSingleNode(t,"ContentStyles");this.commStyleList.FromXML(a);let u=C.XmlDomUtil.GetSingleNode(t,"XElements");if(null!=u){let e=u.children;for(let t=0;t<e.length;t++){let n=e[t];this._FromXML_PagePanel(n)}}this.outlineList.RefreshAllParent();c.DateTime.Now.Ticks()}_FromXML_PagePanel(e){let t=C.XmlDomUtil.GetSingleAttrValue(e,"xsi:type");y.default.IsNullOrEmpty(t)||("XTextHeader"==t&&(this.header.Document=this,this.header.FromXML(e),this.header.validateAddLastXPaFlag()),"XTextBody"==t&&(this.body.Document=this,this.body.FromXML(e),this.body.validateAddLastXPaFlag()),"XTextFooter"==t&&(this.footer.Document=this,this.footer.FromXML(e),this.footer.validateAddLastXPaFlag()),"XDocComment"==t&&(this.cmmtBar.Document=this,this.cmmtBar.FromXML(e)))}RefreshLines(e){this.header.ReCalcBaseSize(),this.header.RefreshLines(e),this.footer.ReCalcBaseSize(),this.footer.RefreshLines(e),this.body.ReCalcBaseSize(),this.body.RefreshLines(e),this.ReCalcPagePanelPos(),this.ReCalcHeadFootMax()}RefreshLinesWithBodyLineRange(e,t,n){this.header.ReCalcBaseSize(),this.header.RefreshLines(n),this.footer.ReCalcBaseSize(),this.footer.RefreshLines(n),this.body.ReCalcBaseSize(),this.body.RefreshLinesWithLineRange(e,t,n),this.ReCalcPagePanelPos(),this.ReCalcHeadFootMax()}RefreshLinesBetweenEle(e,t,n){this.header.ReCalcBaseSize(),this.header.RefreshLines(n),this.footer.ReCalcBaseSize(),this.footer.RefreshLines(n),this.body.ReCalcBaseSize(),this.body.RefreshLinesBetweenEle(e,t,n),this.ReCalcPagePanelPos(),this.ReCalcHeadFootMax()}ReCalcPagePanelPos(){this.header.SetPositionDPI(0,0,0),this.footer.SetPositionDPI(0,0,0),this.body.SetPositionDPI(0,0,0),this.cmmtBar.SetPositionDPI(0,0,0)}ReCalcHeadFootMax(e=300){let t=50,n=this.header.GetLinesHeight(!0,!0,e);n>0||(n=0);let r=this.footer.GetLinesHeight(!0,!0,e);r>0||(n=0);let i=this.body.getMaxLineHeight(e);i<50&&(i=50);let l=this.GetPageFmt().GetValidHeightDPI2(e);if(l>i)if(l-=i,l<n+r){const e=l-r,i=l-n;t=e>r?e:i>n?i:l/2}else t=l;n>t&&(this.RemovedisVaildLine(this.header,t),this.header.IsLayoutValid=!1,this.header.CalcSizeByLines()),r>t&&(this.RemovedisVaildLine(this.footer,t),this.footer.IsLayoutValid=!1,this.footer.CalcSizeByLines())}RemovedisVaildLine(e,t){let n=t;const r=e.LinesList;if(null!=r&&n>0){if("XTextTableCell"==e.EleTypeName){n-=e.EleStyle.ElePadd.Top+e.EleStyle.ElePadd.Bottom}const t=r.Count();for(let i=0;i<t;i++){const l=r.Get(i);if(null==l)continue;const s=l.LineAssist.GetLineFullHeight(300,!0);if(n>=s){n-=s;continue}let o=h.XDomUtil.GetElementFromLine(l,"XTextTable");const a=h.XDomUtil.GetElementFromLine(l,"XTextTableCell");if(o.AddRange(a),null!=o&&o.Count()>0){let t=n;for(let e=0;e<o.Count();e++){const r=o.Get(e),i=this.RemovedisVaildLine(r,n);i<t&&(t=i)}if(t>-1){n=t,l.ReCalcLineSize(),e.IsLayoutValid=!1,e.CalcSizeByLines();continue}}if(0==i){r.Clear(),e.Height=0,n=-1;break}r.Get(i-1).NextLine=null,r.RemoveRange(i,t-i),e.CalcSizeByLines();break}}return n}Clear(){this.body.Clear(),this.header.Clear(),this.footer.Clear(),this.cmmtBar.Clear(),this.docParams.Clear(),this.pageFmt.Clear(),this.pageCols.Clear(),this.waterMark.Clear(),this.debugOptions.Clear(),this.docSignatures.Clear(),this.docUserHistories.Clear(),this.commStyleList.Clear(!0,!0),this.outlineList.Clear(),this.docCtxt.Clear(),this.assist.Clear(),this._InitEmptyPageCtnt()}_InitEmptyPageCtnt(){let e=new Array;e.push(this.header),e.push(this.body),e.push(this.footer);let t=e;for(let e=0;e<t.length;e++){let n=t[e],r=h.XElementFactory.CreatXElement("XParagraphFlag",null);r.OwnerDocPanel=n,n.AddChildEle(0,r)}}getBodyEleWidthCptId(e=!0,t=!0,n=!1){let r=[];return r=this.body.getAllEleWidthCptId(e,t,n),r}GetFirstChildByIds(e){let t=new s.List;return this.body.GetChildrenByXID(e,!0,t),t.Count()<1&&this.body.GetChildrenByCptId(e,!0,t),t.Count()<1&&this.header.GetChildrenByXID(e,!0,t),t.Count()<1&&this.footer.GetChildrenByXID(e,!0,t),t.Count()<1&&this.header.GetChildrenByCptId(e,!0,t),t.Count()<1&&this.footer.GetChildrenByCptId(e,!0,t),t.Count()<1?null:t.Get(0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ORIENTATION=void 0,function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e[e.NONE=4]="NONE"}(t.ORIENTATION||(t.ORIENTATION={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableCellAlign=void 0,function(e){e[e.TOP=0]="TOP",e[e.MIDDLE=1]="MIDDLE",e[e.BOTTOM=2]="BOTTOM"}(t.XTextTableCellAlign||(t.XTextTableCellAlign={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrClipboard=void 0;const r=n(2),i=n(0),l=n(16),s=n(3),o=n(116),a=n(4);class u{constructor(){this.isCut=!1,this.hasPasted=!1,this.lineEleRange=new o.XLineEleRange,this.arrEleRange=null}static GetInstance(){return u._instance}CopyToClipboard(e,t,n,r="",i=!1,l=!1){if(this.isCut=n,this.hasPasted=!1,null==e||null==t)return!1;const s=this.setLineEleRange(e,t,!0,l);if(null==s)return!1;let o;return i&&null!=this.arrEleRange?(this.arrEleRange=[...this.arrEleRange,...s],o=!0):(this.arrEleRange=s,o=!l),r||(r=this.lineEleRange.BuildEleRangeAsText(this.arrEleRange)),o||this.lineEleRange.Clear(),u.SetOsClipboardCtnt(r),o}getEmrWorkMode(e){if(null==e)return null;const t=e.Document;if(null==t)return null;return t.GetDocCtxt().EmrWorkMode}GetHiddenLineElesInRange(e,t){if(null==e||e.length<2)return e;let n=0;const i=e[n];if(null==i)return e;const l=i.OwnerDocPanel;if(null==l)return e;const o=i.Document;if(null==o)return e;if(null==t&&(t=o.GetDocCtxt().EmrWorkMode),t==r.ENumWorkMode.Design)return e;const u=o.AssistFunc.MsgBus;if(null==u||null==u.M_msgBus)return e;let h=[];for(let t=0;t<e.length;t++){const n=e[t];null!=n.XID&&h.push(n.XID),null!=n.GrpID&&h.push(n.GrpID);let r=n.Parent;for(;null!=r&&null!=r.Parent;)-1==h.indexOf(r.XID)&&h.push(r.XID),-1==h.indexOf(r.GrpID)&&h.push(r.GrpID),r=r.Parent}let d=new s.List;l.GetAllBaseChildren(d);let c,p,f=[],g=0;for(;n<e.length&&g<d.Count();){const t=d.Get(g);if(e[n].XID==t.XID||e[n].GrpID==t.GrpID)f.push(e[n]),n++,g++,c=null,p=null;else{let e=t.Parent;if(null!=e){for(;null!=e.Parent&&null!=e.Parent.Parent;)e=e.Parent;if(null!=e.Parent){const n=e.XID||e.GrpID;if(null==c||c!=n){p=!1,c=n;if("IScriptMsg"==e.GetType()){const t=e.ExpessionArray;if(null!=t&&t.length>0)for(let e=0;e<t.length;e++){const n=t[e];if(!p&&!a.default.IsNullOrEmpty(n)){let e=0;for(;!p&&e<h.length;){const t=h[e];-1!=n.indexOf(t)&&(p=!0),e++}}}}}p&&f.push(t)}}g++}}return f}setLineEleRange(e,t,n,l=!1){this.lineEleRange.Clear(),this.lineEleRange.SetFromIx(e),this.lineEleRange.SetToIx(t,!0),this.lineEleRange.SortFromToIx();let o=this.lineEleRange.InfoUtil.GetLineElesInRange(!0,!0);const a=this.getEmrWorkMode(e);let u=!0;l&&a!=r.ENumWorkMode.Design&&(u=!1),u&&(o=this.GetHiddenLineElesInRange(o,a));const h=null==o?0:o.length;if(h<=0)o=null;else if(l){let e,t=["XCharacter","XLable","XTextLabelElement","XTextCheckBox","XTextRadioBox","XInputField"],n=new s.List,r=new s.List;const l=o[0].OwnerDocPanel;for(let s=0;s<h;s++){let a=o[s];if(null!=a)if(a instanceof i.XCharacterEle)n.Add(a),"XString"==a.Parent.EleTypeName&&(e=a.Parent);else if(-1!=t.indexOf(a.EleTypeName)){const t=a.GetInnerText(!1);if(t){t.split("").forEach(t=>{const s=new i.XCharacterEle(t);s.OwnerDocPanel=l,s.Parent=e,n.Add(s),null==e&&r.Add(s)})}}}for(let t=0;t<r.Count();t++){const n=r.Get(t);null==n.Parent&&(n.Parent=null!=e?e:l)}o=n.ToArray()}else if(n)for(let e=0;e<h;e++){let t=o[e]instanceof i.XBaseContainer?o[e]:null;if(null!=t){let n=i.XElementFactory.CreatXElement(t.EleTypeName,null);n.CopyFrom(t,!0,!0,!0),n.Parent=t.Parent,o[e]=n}}return o}static SetOsClipboardCtnt(e){a.default.IsNullOrEmpty(e)&&(e=""),u.OsClipboardEmrCtnt=e,localStorage.setItem(u.emrCopyToXMLInner,e),u.DomExecCommand(e)}static DomExecCommand(e){const t=document.createElement("input");t.value=e,""==t.value&&(t.value=" "),t.setAttribute("id","execCommand_copy_input"),document.body.append(t),t.select(),document.execCommand("copy"),document.getElementById("execCommand_copy_input").remove()}IsEmpty(){let e=null==this.arrEleRange||0==this.arrEleRange.length;if(!e){const t=this.arrEleRange[0].OwnerDocPanel;(null==t||t.ChildCount<=0)&&(this.arrEleRange=null,e=!0)}return e}static GetOsClipboardCtnt(){let e;return e=u.PasteFromCaret||"",e}CopyFromClipboard(e,t){t=null;let n=u.Copy_SelEles(this.arrEleRange,!1,e);this.hasPasted=!0;let r,i=null==n?0:n.Count();if(i<=0)r=null;else{t=n.Get(0),n.RemoveAt(0);let e=i<=1?null:n.ToArray();n.Clear(),r=e}return[r,t]}static Copy_SelEles(e,t=!1,n=!0){if(!Array.isArray(e))return null;if(e.length<1)return null;const r=e.length;let l=new s.List,o=!1,h=0;for(;h<r;){const r=e[h];let s,d=r.Parent;if(null==d){h++;continue}let c=u._Get_SpecialPaEle_TpName(r);a.default.IsNullOrEmpty(c)&&(c=r.EleTypeName),s=i.XElementFactory.CreatXElement(c,null);let p=s.CopyFromSelRange(e,h,t,n,!1);if(p<=0)break;o&&u._HandleSuffixContainer(s instanceof i.XBaseContainer?s:null,l),o=!1,s.OwnerDocPanel=d.OwnerDocPanel,l.Add(s),h+=p}return l}static _HandleSuffixContainer(e,t){if(null!=e&&null!=t&&t.Count()>0){let n=0;if(e instanceof i.XBaseInputEle){n=l.XDomUtil.GetXInputCtntChildIx(e);let t=e.GetChildEle(n);null!=t&&t.IsXInputBkgText&&e.RemoveChild(n)}for(let r=0;r<t.Length;r++)e.AddChildEle(n++,t[r]);t.Clear()}}static _Get_SpecialPaEle_TpName(e){let t=null;if(e instanceof i.XCharacterEle)t="XString";else if(e instanceof i.XInputBorderEle){let n=e.Parent;t=null==n?"XInputField":n.EleTypeName}else e instanceof i.XTextTableCell&&(t="XTextTable");return t}static IsOsClipboardEmrCtntChanged(e=null){let t;const n=/(^\s+)|(\s+$)|\s+/g;let r=e||u.OsClipboardEmrCtnt;null!=r&&(r=r.replace(n,()=>""));let i=u.GetOsClipboardCtnt();return null!=i&&(i=i.replace(n,()=>"")),t=r!=i,t}get M_ArrEleRange(){return this.arrEleRange}ClearRange(){this.arrEleRange=null}}t.EmrClipboard=u,u._instance=new u,u.OsClipboardEmrCtnt=null,u.PasteFromCaret=null,u.emrCopyToXMLKey="emrCopyToXML",u.emrCopyToXMLInner="emrCopyToXMLInner",u.emrCopyToXMLUser="emrCopyToXMLUser",u.emrCopyToXMLPatient="emrCopyToXMLPatient"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.text=n.text||t,this.options=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pen=void 0;t.Pen=class{constructor(e,t){this._dashStyle=null,this._dashPattern=null,this.color=e,this.width=t}get Color(){return this.color}set Color(e){this.color=e}get Width(){return this.width}set Width(e){this.width=e}get DashStyle(){return this._dashStyle}set DashStyle(e){this._dashStyle=e}get DashPattern(){return this._dashPattern}set DashPattern(e){this._dashPattern=e}Dispose(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_BaseInsertInput=void 0;const r=n(40),i=n(0),l=n(16),s=n(60),o=n(48);class a extends o.A_InsertElement{Execute(e){let t;if(null==e||0==e.length)t=this.resMsg;else{let n=s.EmrApiUtil.GetEmrEditWrapperCtrl(super.GetEdtCtrl());if(null==n)t=this.resMsg;else{let s;s=super.GetEdtCtrl().M_EdtCustomEvtGrp.xDiagTableInfo.updateDiagTable(),null==s&&(s=super.GetEdtCtrl().M_EleEvtModel.EleClicked);let o=!!(s instanceof i.XInputBorderEle&&s.IsStartBorder),a=l.XDomUtil.GetParentXInput(s,o),u=!0;if(null!=a){switch(a.TipShowRule=n.EleTipShowRule,a.InputType){case r.EleTypeEnum.SingleChoiceDropEle:case r.EleTypeEnum.MoreChoiceDropEle:case r.EleTypeEnum.HaveNoEle:case r.EleTypeEnum.NumEle:case r.EleTypeEnum.DateEle:case r.EleTypeEnum.SqlEle:u=!1}}u?this.resMsg=super.Execute(e):(this.resMsg.MsgStr="当前元素不支持嵌套！",this.MessageError()),t=this.resMsg}}return t}}t.A_BaseInsertInput=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractHandlerLayer=void 0;const r=n(59),i=n(110);t.AbstractHandlerLayer=class{constructor(e){this.msCursor=null,this.xdocEditor=null,this.eleEvtModel=null,this.isWaken=!1,this.xdocEditor=e,this.eleEvtModel=null==e?null:e.M_EleEvtModel}get MsCursor(){return this.msCursor}set MsCursor(e){this.msCursor=e,this.xdocEditor.ContainerDOM.style.cursor=this.msCursor}get IsWaken(){return this.isWaken}CanWakeBySrc(e,t){return!0}TryWake(e,t){let n;return this.isWaken?n=!0:(this.isWaken=!1,n=!1),n}Handle(e,t,n){}OnDone(){this.isWaken&&(this.isWaken=!1)}CanWakeNextLayer(){return!1}AddUndoItem(e){if(null!=this.xdocEditor){if(null==e)return;let t=this.xdocEditor.M_EleEvtModel.EleClickedWrap,n=t.EleFocused;null==e.CursorUndoEle&&(e.CursorUndoEle=n),null==e.CursorRedoEle&&(e.CursorRedoEle=t.EleFocused),this.xdocEditor.M_UndoMgr.AddItem(e)}}GetActivePgview(e){return(e?this.eleEvtModel.EleClickedWrap:this.eleEvtModel.EleMOverWrap).PageFocused}CalcPosInEle(e,t,n){if(null==e)n.X=n.Y=0;else{let i=this.GetActivePgview(t),l=r.ClickedElementWrapper.GetElePosInCtrl(e,i,1);n.X-=l.X,n.Y-=l.Y}}CalcRectInCtrl(e,t,n){let l=this.GetActivePgview(t),s=r.ClickedElementWrapper.GetEleRectInCtrl(e,l,1);i.RectFUtil.CopyRectF(s,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocLoadParam=void 0;const r=n(2),i=n(188),l=n(417),s=n(4);class o extends i.DocInfoArgs{constructor(e,t){super(i.ENumDocTp.EmrDoc),this.lineToPrt=!1,this.mergeIntoPrevDocPage=null,this.nextDocToNewPage=null,this.srcStr=null,this.srcType=r.ENumXDocPath.UnKnown,this.workMode=r.ENumWorkMode.Design,this.srcStr=e,this.srcType=t}get SrcStr(){return this.srcStr}set SrcStr(e){this.srcStr=e}get SrcType(){return this.srcType}set SrcType(e){this.srcType=e}get LineToPrint(){return this.lineToPrt}set LineToPrint(e){this.lineToPrt=e}get IsMergeIntoPrevDocPage(){return this.mergeIntoPrevDocPage}get IsNextDocToNewPage(){return this.mergeIntoPrevDocPage}get PatientInfo(){return this._patientInfo}set PatientInfo(e){this._patientInfo=e}get ShowIcon(){return this._showIcon}set ShowIcon(e){this._showIcon=e}get WorkMode(){return this.workMode}set WorkMode(e){this.workMode=e}Clear(){super.Clear(),this.srcStr=null,this.srcType=r.ENumXDocPath.UnKnown,this.lineToPrt=null,this.mergeIntoPrevDocPage=!1,this.nextDocToNewPage=!0,this._patientInfo=null}IsValid(){return r.ENumXDocPath.UnKnown!=this.srcType&&!s.default.IsNullOrEmpty(this.srcStr)}CopyFrom(e){if(null==e)return;super.CopyFrom(e);let t=e;null!=t&&(this.srcStr=t.srcStr,this.srcType=t.srcType,this.lineToPrt=t.lineToPrt,this.mergeIntoPrevDocPage=t.mergeIntoPrevDocPage,this.nextDocToNewPage=t.nextDocToNewPage,this._patientInfo=t._patientInfo,this._showIcon=t._showIcon,this.workMode=t.workMode)}SetSerialDocPagesPolicy(e,t){this.mergeIntoPrevDocPage=e,this.nextDocToNewPage=t}IsCurrDocToNewPage(e){let t=null==e?null:e.IsNextDocToNewPage;return null!=!this.mergeIntoPrevDocPage&&null!=!t||null!=this.mergeIntoPrevDocPage&&!this.mergeIntoPrevDocPage||null!=t&&t}Build_DocKey(){let e=this.SrcStr;return this.SrcType==r.ENumXDocPath.RemoteFile&&(e=(new l.MD5).str_md5(e)),e}}t.XDocLoadParam=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EqualityComparer=void 0;const r=Symbol("HASH_CODE");class i{GetHashCode(e){let t=0;if(e){if("number"==typeof e)return e;if("string"==typeof e)return s(e);if(t=e[r],void 0!==t)return t;t=function(){let e=(new Date).valueOf();return s(function(e,t){let n="",r=e;t&&t>e&&(r=Math.round(Math.random()*(t-e))+e);for(let e=0;e<r;e++){let e=Math.round(Math.random()*(h.length-1));n+=h[e]}return n}(6,32)+e.toString())}(),e[r]=t}return t}static Default(){return new l}}t.EqualityComparer=i;class l extends i{Equals(e,t){return e===t}}function s(e){let t=0;if(e)for(let n=0;n<e.length;n++)t=31*t+e.charCodeAt(n),t=o(t);return t}function o(e){return e>a||e<u?4294967295&e:e}const a=2147483647,u=-2147483648,h=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{MathUtils(){}static round(e){return NaN===e?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,n,r){const i=e-n,l=t-r;return Math.sqrt(i*i+l*l)}static sum(e){let t=0;for(let n=0,r=e.length;n!==r;n++){t+=e[n]}return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeAnchorUtil=void 0;const r=n(37),i=n(35),l=n(91),s=n(63),o=n(7),a=n(9);class u{constructor(){this.AnchorCnt=8,this.AnchorIx_TopCenter=6,this.AnchorIx_BtmCenter=7}static PaintEleAnchors(e,t,n,i,l){if(null!=e&&e.IsFocused){let s=e.GetBoundsDPI(l),h=u._BuildAllAnchorRects(e,s),d=r.TextDocApiConst.ImageMarkPointFillColor,c=r.TextDocApiConst.ImageMarkPointBorderColor,p=n.Color,f=i.Color;n.Color=d,i.Color=c;let g=a.RectangleF.Empty;for(let e=0;e<8;e++)g=h[e],g.Width>0&&g.Height>0&&(t.FillRectangle(n,g),t.DrawRectangle(i,g.X,g.Y,g.Width,g.Height));i.Color=o.Color.Gray,t.DrawRectangle(i,s.X,s.Y,s.Width,s.Height),n.Color=p,i.Color=f}}static _BuildAllAnchorRects(e,t){let n=[];for(let r=0;r<8;r++){u.IsAnchorForbidden(e,u.Arr_AnchorTP[r])?n.push(a.RectangleF.Empty):n.push(u._CalcAnchorRect(u.Arr_AnchorTP[r],t))}return n}static IsAnchorForbidden(e,t){let n;if(null!=e&&e.IsFocused)if(t==l.MarkPoint.None)n=!1;else{let r=!1,i=e.GetForbidAnchors(),l=null==i?0:i.length;if(l<=0)n=!1;else{for(let e=0;e<l;e++)if(i[e]==t){r=!0;break}n=r}}else n=!0;return n}static _CalcAnchorRect(e,t){let n=a.RectangleF.Empty;switch(n.Width=r.TextDocApiConst.MarkPointWidth,n.Height=r.TextDocApiConst.MarkPointHeight,e){case l.MarkPoint.LeftTop:n.X=t.X,n.Y=t.Y;break;case l.MarkPoint.LeftCenter:n.X=t.X,n.Y=t.Y+t.Height/2,n.Y-=n.Height/2;break;case l.MarkPoint.LeftBottom:n.X=t.X,n.Y=t.Bottom,n.Y-=n.Height;break;case l.MarkPoint.TopCenter:n.X=t.X+t.Width/2,n.Y=t.Y,n.X-=n.Width/2;break;case l.MarkPoint.BottomCenter:n.X=t.X+t.Width/2,n.Y=t.Bottom,n.X-=n.Width/2,n.Y-=n.Height;break;case l.MarkPoint.RightTop:n.X=t.Right,n.Y=t.Y,n.X-=n.Width;break;case l.MarkPoint.RightCenter:n.X=t.Right,n.Y=t.Y+t.Height/2,n.X-=n.Width,n.Y-=n.Height/2;break;case l.MarkPoint.RightBottom:n.X=t.Right,n.Y=t.Bottom,n.X-=n.Width,n.Y-=n.Height}return n}static Hit_Hot(e,t,n){let i;if(null==e)i=l.MarkPoint.None;else{let s=1;n>0&&300!=n&&(s=300/n);let o=s*t.X,a=s*t.Y,u=s*r.TextDocApiConst.MarkPointWidth,h=0,d=e.Width,c=0,p=e.Height,f=(h+d)/2,g=(c+p)/2;if(o>=h&&o<h+u){if(a>=g-u&&a<=g+u)return i=l.MarkPoint.LeftCenter,i;if(a>=c&&a<=c+u)return i=l.MarkPoint.LeftTop,i;if(a>=p-u&&a<=p)return i=l.MarkPoint.LeftBottom,i}else if(o>=f-u/2&&o<=f+u/2){if(a>=c&&a<=c+u)return i=l.MarkPoint.TopCenter,i;if(a>=p-u&&a<=p)return i=l.MarkPoint.BottomCenter,i}else if(o>=d-u&&o<=d){if(a>=g-u/2&&a<=g+u/2)return i=l.MarkPoint.RightCenter,i;if(a>=c&&a<=c+u)return i=l.MarkPoint.RightTop,i;if(a>=p-u&&a<=p)return i=l.MarkPoint.RightBottom,i}i=l.MarkPoint.None}return i}static Hit_CellSide(e,t,n){if(null==e)return s.ORIENTATION.NONE;const r=e.Parent.Parent;let l=1;n>0&&300!=n&&(l=300/n);const o=l*t.X,a=l*t.Y,u=6*l,h=6*l,d=e.Bounds.Clone();let c=r.OwnerLine.RelEleParagraphStyle.SpacingBefore,p=d.Top+c,f=d.Bottom+c;d.X=d.Y=0;const g=e.RowSpan<=1?1:e.RowSpan,m=e.ColSpan<=1?1:e.ColSpan;let E=i.CommDefines.CmprNumVal(o,d.Left,h);if(0==E){return 0==e.ColIndex?s.ORIENTATION.NONE:s.ORIENTATION.LEFT}if(E=i.CommDefines.CmprNumVal(o,d.Right,h),0==E){return e.ColIndex+m>r.NumOfColumns?s.ORIENTATION.NONE:s.ORIENTATION.RIGHT}if(E=i.CommDefines.CmprNumVal(a,p,u),0==E){return 0==e.RowIndex?s.ORIENTATION.NONE:s.ORIENTATION.TOP}if(E=i.CommDefines.CmprNumVal(a,f,u),0==E){return e.RowIndex+g>r.NumOfRows?s.ORIENTATION.NONE:s.ORIENTATION.BOTTOM}return s.ORIENTATION.NONE}static Hit_Cell(e,t,n){if(null==e)return s.ORIENTATION.NONE;const r=e.Parent.Parent;let l=1;n>0&&300!=n&&(l=300/n);const o=l*t.X,a=l*t.Y,u=e.Bounds.Clone();u.X=u.Y=0;const h=e.RowSpan<=1?1:e.RowSpan,d=e.ColSpan<=1?1:e.ColSpan,c=i.CommDefines.CmprNumVal(o,u.Left),p=i.CommDefines.CmprNumVal(o,u.Right),f=i.CommDefines.CmprNumVal(a,u.Top),g=i.CommDefines.CmprNumVal(a,u.Bottom);if(1==c&&-1==p&&1==f&&-1==g)return s.ORIENTATION.NONE;if(0==c){return 0==e.ColIndex?s.ORIENTATION.NONE:s.ORIENTATION.LEFT}if(0==p){return e.ColIndex+d>r.NumOfColumns?s.ORIENTATION.NONE:s.ORIENTATION.RIGHT}if(0==f){return 0==e.RowIndex?s.ORIENTATION.NONE:s.ORIENTATION.TOP}if(0==g){return e.RowIndex+h>r.NumOfRows?s.ORIENTATION.NONE:s.ORIENTATION.BOTTOM}return s.ORIENTATION.NONE}}t.ResizeAnchorUtil=u,u.Arr_AnchorTP=[l.MarkPoint.LeftTop,l.MarkPoint.LeftCenter,l.MarkPoint.LeftBottom,l.MarkPoint.RightTop,l.MarkPoint.RightCenter,l.MarkPoint.RightBottom,l.MarkPoint.TopCenter,l.MarkPoint.BottomCenter]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12);n(644);const i=n(24),l=n(9),s=n(17),o=n(139),a={top:7,isTopFromProp:!1,left:7,isShow:!1,isRender:!0,disabled:!1,target:l.RectangleF.Empty,onOk:()=>{},onCancel:()=>{},onClose:()=>{},className:"",showOkBtn:!1,cancelText:"取消",showCancelBtn:!1};class u extends r.Component{constructor(e){super(e),this.domBody=document.getElementsByTagName("body").item(0),this.onMouseDown=e=>{e.preventDefault();let t=e.clientX,n=e.clientY;const{left:r,top:i}=this.state;document.body.onmousemove=e=>{let l=e.clientX-t+r,s=e.clientY-n+i;this.InWindow(e.clientX,e.clientY,t,n)?this.setState({left:l,top:s}):(document.body.onmousemove=null,document.body.onmouseup=null)},document.body.onmouseup=function(){document.body.onmousemove=null,document.body.onmouseup=null}},this.InWindow=(e,t,n,r)=>{let i=document.body.clientHeight,l=document.body.clientWidth;return!(e<20&&n>e||e>l-20&&n<e||t<20&&r>t||t>i-20&&r<t)},this.handleClickOutside=e=>{if(!(this&&this.toggleContainer&&this.toggleContainer.current))return;const t=this.state.isShow,n=this.props.alwayShow,r=this.toggleContainer.current.contains(e.target),i=this.props.target.Contains(new s.PointF(e.pageX,e.pageY));!t||n||r||i||this.state.isShow&&(this.setState({isShow:!1}),this.props.onClose(!0)),"function"==typeof this.props.onHandleClickOutside&&this.props.onHandleClickOutside()},this.okHandler=e=>{this.props.onOk(),this.setState({isShow:!1}),this.props.onClose()},this.cancelHandler=e=>{this.props.onCancel(),this.setState({isShow:!1}),this.props.onClose()},this.onkeyup=e=>{"Escape"===e.code&&this.props.onClose(!0)},this.onkeyup=this.onkeyup.bind(this),this.state={isShow:e.isShow,top:e.top,left:e.left},this.toggleContainer=r.createRef()}componentDidMount(){setTimeout(()=>{document.addEventListener("mousedown",this.handleClickOutside,!0)});const e=document.documentElement.clientHeight,t=document.documentElement.clientWidth;let n=this.toggleContainer.current;const r=n.offsetLeft+n.offsetWidth;if(r>t){const e=Math.abs(r-t),i=n.offsetLeft-e;this.setState({left:i})}if(n.offsetTop+n.offsetHeight>e){const e=n.offsetTop-n.offsetHeight-15;this.setState({top:e})}}componentDidUpdate(e,t){this.props.isShow!=e.isShow&&this.setState((e,t)=>({isShow:t.isShow,top:t.top,left:t.left}))}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}renderButtonArea(){if(this.props.showOkBtn||this.props.showCancelBtn){const{cancelText:e,okBtnId:t,canceBtnId:n,btnAllowEnter:i,btnKeyUp:l}=this.props;return r.createElement("div",{className:"popover-buttonArea"},this.props.showCancelBtn?r.createElement(o.Button,{height:28,width:68,onClick:this.cancelHandler,id:n,allowEnter:i,onKeyUp:l,type:"default",text:e}):null,this.props.showOkBtn?r.createElement(o.Button,{height:28,width:68,onClick:this.okHandler,id:t,allowEnter:i,onKeyUp:l,type:"primary",text:"确定"}):null)}return null}render(){const{isShow:e,top:t,left:n}=this.state,{className:l,isTopFromProp:s,isRender:o}=this.props;let a=t,u=n;return s&&this.props.top&&(a=this.props.top,u=this.props.left),a<0&&(a=0),o?i.createPortal(r.createElement("div",{className:"pango-editor-popover "+l,ref:this.toggleContainer,onKeyUp:this.onkeyup,style:{display:e?"block":"none",top:a+"px",left:u+"px"}},this.props.children,this.renderButtonArea()),this.domBody):null}}u.defaultProps=a,t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XImageEle=t.ImageType=void 0;const r=n(668),i=n(8),l=n(104),s=n(91),o=n(3),a=n(16),u=n(0),h=n(14),d=n(83),c=n(4);var p;!function(e){e[e.NormalImage=0]="NormalImage",e[e.BarCode=1]="BarCode",e[e.QrCode=2]="QrCode",e[e.TeechBitmap=3]="TeechBitmap",e[e.SyncImage=4]="SyncImage"}(p=t.ImageType||(t.ImageType={}));class f extends u.XBaseResizableElement{constructor(){super(),this.imgInfo=null,this.imgObj=null,this.imgInfo=new r.XImageInfo,this.ZOrderStyle="Normal"}get Bounds(){let e=super.Bounds;return 0==e.Width&&0==e.Height&&(e.Width=this.ImgObj.Width,e.Height=this.ImgObj.Height),e}get EleTypeName(){return"XImage"}get ImgInfo(){return this.imgInfo}get ImageType(){let e,t=this.propList.GetPropValue("ImageType");if(null==t)e=p.NormalImage;else{let n;p[t]||(n=p.NormalImage),e=p[t]}return e}set ImageType(e){this.propList.ModifyProperty("ImageType",e,p.NormalImage)}get DataString(){return this.propList.GetPropValue("DataString")}set DataString(e){this.propList.ModifyProperty("DataString",e,p.NormalImage)}get Deletable(){let e=this.propList.GetPropValue("Deleteable");return this.ImageType==p.SyncImage?i.CNumUtil.TryParseBool(e,!1):i.CNumUtil.TryParseBool(e,!0)}set Deletable(e){this.ImageType==p.SyncImage?this.propList.ModifyProperty("Deleteable",e,!1):this.propList.ModifyProperty("Deleteable",e,!0)}get ContentReadOnly(){let e,t=this.propList.GetPropValue("ContentReadonly");return e=null==t||""==t.toString()?null:i.CNumUtil.TryParseBool(t,!1),e}set ContentReadOnly(e){this.propList.ModifyProperty("ContentReadonly",e,null),null!=e&&(super.UserEditable=!e)}get VAlign(){return l.StyleVAlignVals.GetVAlignStrVal(super.EleStyle.VAlign_ENumVal)}get Title(){return this.propList.GetPropValue("Title")}set Title(e){this.propList.ModifyProperty("Title",e,null),super.ToolTip=e}get AltText(){return this.propList.GetPropValue("Alt")}set AltText(e){this.propList.ModifyProperty("Alt",e,null)}get KeepWidthHeightRate(){let e=this.propList.GetPropValue("KeepWidthHeightRate");return i.CNumUtil.TryParseBool(e,!1)}set KeepWidthHeightRate(e){this.propList.ModifyProperty("Alt",e,null)}get IsPrint(){let e=this.propList.GetPropValue("IsPrint");return i.CNumUtil.TryParseBool(e,!0)}set IsPrint(e){this.propList.ModifyProperty("IsPrint",e,!0)}get ZOrderStyle(){let e=this.propList.GetPropValue("ZOrderStyle");return c.default.IsNullOrEmpty(e)&&(e="Normal"),e}set ZOrderStyle(e){this.propList.ModifyProperty("ZOrderStyle",e,"Normal")}get OffsetX(){let e=this.propList.GetPropValue("OffsetX");return i.CNumUtil.TryParseFloat(e,0)}set OffsetX(e){this.propList.ModifyProperty("OffsetX",e,0)}get OffsetY(){let e=this.propList.GetPropValue("OffsetY");return i.CNumUtil.TryParseFloat(e,0)}set OffsetY(e){this.propList.ModifyProperty("OffsetY",e,0)}get ImgObj(){return this.imgObj}set ImgObj(e){this.imgObj=e,null!=this.imgObj&&(this.InitSizeByImgObj(null),this.IsLayoutValid=!1)}setImgObj(e,t=!0){this.imgObj=d.XImageUtil.Base64ToImage(e,t)}get Source(){return this.propList.GetPropValue("Source")}set Source(e){this.propList.ModifyProperty("Source",e,null)}GetInnerText(e){return e?"[图片]":this.IsRemoved?"":"[图片]"}get Gender(){return this.propList.GetPropValue("Gender")}get HaveValue(){let e=this.propList.GetPropValue("HaveValue");return i.CNumUtil.TryParseBool(e,!1)}set HaveValue(e){this.propList.ModifyProperty("HaveValue",e,!1)}get UseEditorTeeth(){let e=this.propList.GetPropValue("UseEditorTeeth");return i.CNumUtil.TryParseBool(e,!1)}set UseEditorTeeth(e){this.propList.ModifyProperty("UseEditorTeeth",e,!1)}get SetHideFlag(){let e=this.propList.GetPropValue("SetHideFlag");return i.CNumUtil.TryParseBool(e,!1)}set SetHideFlag(e){this.propList.ModifyProperty("SetHideFlag",e,!1)}set Gender(e){this.propList.ModifyProperty("Gender",e,null)}get MaxAge(){return this.propList.GetPropValue("MaxAge")}set MaxAge(e){this.propList.ModifyProperty("MaxAge",e,null)}get MinAge(){return this.propList.GetPropValue("MinAge")}set MinAge(e){this.propList.ModifyProperty("MinAge",e,null)}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r);let i=e;null!=i&&(this.imgObj=i.imgObj,this.imgInfo.IsImgBase64=e.ImgInfo.IsImgBase64,this.InitImgInfoByImgObj(e.ImgInfo.IsImgBase64))}GetForbidAnchors(){let e=new o.List;return super.UserEditable?this.KeepWidthHeightRate&&(e.Add(s.MarkPoint.LeftCenter),e.Add(s.MarkPoint.TopCenter),e.Add(s.MarkPoint.BottomCenter),e.Add(s.MarkPoint.RightCenter)):(e.Add(s.MarkPoint.LeftTop),e.Add(s.MarkPoint.LeftCenter),e.Add(s.MarkPoint.LeftBottom),e.Add(s.MarkPoint.TopCenter),e.Add(s.MarkPoint.BottomCenter),e.Add(s.MarkPoint.RightTop),e.Add(s.MarkPoint.RightCenter),e.Add(s.MarkPoint.RightBottom)),e.ToArray()}CanBeInline(e=!1){return!(e&&!this.IsPrint)&&super.CanBeInline(e)}InitImageEle(e){this.Title=e.Title,this.AltText=e.Alt,this.ContentReadOnly=e.ContentReadOnly,this.KeepWidthHeightRate=e.KeepWidthHeightRate,this.ImgObj=e.DrawImage,this.KeepWidthHeightRate=e.KeepWidthHeightRate,this.OffsetX=e.OffsetX,this.OffsetY=e.OffsetY,this.ZOrderStyle=e.ZOrderStyle,super.EleStyle.VAlign_ENumVal=l.StyleVAlignVals.GetEnumVAlign(e.VAlign)}InitSizeByImgObj(e){this.InitImgInfoByImgObj(this.ImgInfo.IsImgBase64);let t=this.imgObj.Width,n=this.imgObj.Height;this.imgInfo.HorizontalResolution>0&&(t*=96/this.imgInfo.HorizontalResolution),this.imgInfo.VerticalResolution>0&&(n*=96/this.imgInfo.VerticalResolution),null==e&&(e=this);let r=a.XDomUtil.ReCalcDrawSize(e,t,n);(r.Width<=0||r.Height<=0)&&(r.Width=1,r.Height=1),this.SetSizeDPI(r.Width,r.Height,96)}InitImgInfoByImgObj(e){null!=this.imgObj&&(this.imgInfo.HorizontalResolution=this.imgObj.HorizontalResolution,this.imgInfo.VerticalResolution=this.imgObj.VerticalResolution,e&&(this.imgInfo.ImgBase64=this.imgObj.ImageEle.src))}FromXML(e){super.FromXML(e);let t=h.XmlDomUtil.GetSingleNode(e,"Image");this.imgInfo.FromXML(t),this.imgObj=d.XImageUtil.Base64ToImage(this.imgInfo.ImgBase64,this.ImgInfo.IsImgBase64),super.ToolTip=this.Title}ToXML(e){let t,n=super.ToXML(e);if(null==n)t=null;else{this.InitImgInfoByImgObj(this.ImgInfo.IsImgBase64);let r=this.imgInfo.ToXML(e);null!=r&&n.appendChild(r),t=n}return t}GetImageEleInfo(){return this.BulidImageEleInfo()}BulidImageEleInfo(){let e=new r.XImageInfo;return e.No=this.CptID,e.Name_de=this.GetAttribute("decodeName"),e.Title=this.Title,e.Gender=this.Gender,e.MaxAge=this.MaxAge,e.MinAge=this.MinAge,e.Width=this.imgObj.Width,e.Height=this.imgObj.Height,e.Attr_FgHide=this.Attr_FgHide,e.Deletable=this.Deletable,e}}t.XImageEle=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Input=void 0;const r=n(12);n(326);const i=n(170),l=n(225);class s extends r.Component{constructor(e,t){super(e,t),this.inputRef=r.createRef(),this.onChange=(e,t)=>{this.setState({value:e.target.value}),this.props.onChange&&this.props.onChange(e.target.value,t)},this.onValid=e=>{this.props.onValid&&this.props.onValid(e)},this.state={value:e.value}}componentDidUpdate(e,t,n){e.value!=this.props.value&&this.setState({value:this.props.value})}renderPrefixIcon(){const{prefixIcon:e,height:t}=this.props;let n=parseInt(t)+"px";return e&&r.createElement("span",{className:"pango-input-prefix-wrap"},r.createElement("i",{className:"pango-input-icon emr-icon-"+e,style:{lineHeight:n}}))}renderSuffixIcon(){const{suffixIcon:e,height:t}=this.props;let n=parseInt(t)+"px";return e&&r.createElement("span",{className:"pango-input-suffix-wrap"},r.createElement("i",{className:"pango-input-icon emr-icon-"+e,style:{lineHeight:n}}))}render(){const{prefixIcon:e,suffixIcon:t,inputClass:n}=this.props,{value:s}=this.state,o=l.default("",{"pango-input-prefix":e,"pango-input-suffix":t,[""+n]:n});return r.createElement(i.default,Object.assign({},this.props,{inputClass:o,ref:this.inputRef,value:s,onChange:this.onChange,onValid:this.onValid}),this.renderPrefixIcon(),this.renderSuffixIcon())}}t.Input=s,s.defaultProps={height:32,value:"",visible:!0}},function(e,t,n){"use strict";function r(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}Object.defineProperty(t,"__esModule",{value:!0}),t.typeChecking=t.computed=t.removeClass=t.addClass=t.hasClass=t.domType=t.remove=t.css=void 0,t.css=function(e,t){for(let n in t)e.style[n]=t[n]},t.remove=function(e){e instanceof HTMLElement?e.parentNode.removeChild(e):e instanceof HTMLCollection&&Array.prototype.forEach.call(e,(function(e){e.parentNode.removeChild(e)}))},t.domType=function(e){return Object.prototype.toString.call(e)},t.hasClass=r,t.addClass=function(e,t){r(e,t)||(e.className+=" "+t)},t.removeClass=function(e,t){if(r(e,t)){let n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}},t.computed=function(e,t,n,r){Object.defineProperty(e,t,{set:function(t){n.forEach((i,l)=>{r[l](e,t,n[l])})}})},t.typeChecking=function(e){return Object.prototype.toString.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(99),i=n(49),l=n(100),s=n(21),o=n(5);class a{constructor(e,t,n,r){if(this.width=e,this.height=t,this.rowSize=n,this.bits=r,null==t&&(t=e),this.height=t,e<1||t<1)throw new o.IllegalArgumentException("Both dimensions must be greater than 0");null==n&&(n=Math.floor((e+31)/32)),this.rowSize=n,null==r&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,n=e[0].length,r=new a(n,t);for(let i=0;i<t;i++){const t=e[i];for(let e=0;e<n;e++)t[e]&&r.set(e,i)}return r}static parseFromString(e,t,n){if(null===e)throw new o.IllegalArgumentException("stringRepresentation cannot be null");const r=new Array(e.length);let i=0,l=0,s=-1,u=0,h=0;for(;h<e.length;)if("\n"===e.charAt(h)||"\r"===e.charAt(h)){if(i>l){if(-1===s)s=i-l;else if(i-l!==s)throw new o.IllegalArgumentException("row lengths do not match");l=i,u++}h++}else if(e.substring(h,h+t.length)===t)h+=t.length,r[i]=!0,i++;else{if(e.substring(h,h+n.length)!==n)throw new o.IllegalArgumentException("illegal character encountered: "+e.substring(h));h+=n.length,r[i]=!1,i++}if(i>l){if(-1===s)s=i-l;else if(i-l!==s)throw new o.IllegalArgumentException("row lengths do not match");u++}const d=new a(s,u);for(let e=0;e<i;e++)r[e]&&d.set(Math.floor(e%s),Math.floor(e/s));return d}get(e,t){const n=t*this.rowSize+Math.floor(e/32);return 0!=(this.bits[n]>>>(31&e)&1)}set(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(31&e)&4294967295}unset(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(31&e)&4294967295)}flip(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(31&e)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new o.IllegalArgumentException("input matrix dimensions do not match");const t=new r.default(Math.floor(this.width/32)+1),n=this.rowSize,i=this.bits;for(let r=0,l=this.height;r<l;r++){const l=r*n,s=e.getRow(r,t).getBitArray();for(let e=0;e<n;e++)i[l+e]^=s[e]}}clear(){const e=this.bits,t=e.length;for(let n=0;n<t;n++)e[n]=0}setRegion(e,t,n,r){if(t<0||e<0)throw new o.IllegalArgumentException("Left and top must be nonnegative");if(r<1||n<1)throw new o.IllegalArgumentException("Height and width must be at least 1");const i=e+n,l=t+r;if(l>this.height||i>this.width)throw new o.IllegalArgumentException("The region must fit inside the matrix");const s=this.rowSize,a=this.bits;for(let n=t;n<l;n++){const t=n*s;for(let n=e;n<i;n++)a[t+Math.floor(n/32)]|=1<<(31&n)&4294967295}}getRow(e,t){null==t||t.getSize()<this.width?t=new r.default(this.width):t.clear();const n=this.rowSize,i=this.bits,l=e*n;for(let e=0;e<n;e++)t.setBulk(32*e,i[l+e]);return t}setRow(e,t){i.default.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let n=new r.default(e),i=new r.default(e);for(let e=0,r=Math.floor((t+1)/2);e<r;e++)n=this.getRow(e,n),i=this.getRow(t-1-e,i),n.reverse(),i.reverse(),this.setRow(e,i),this.setRow(t-1-e,n)}getEnclosingRectangle(){const e=this.width,t=this.height,n=this.rowSize,r=this.bits;let i=e,l=t,s=-1,o=-1;for(let e=0;e<t;e++)for(let t=0;t<n;t++){const a=r[e*n+t];if(0!==a){if(e<l&&(l=e),e>o&&(o=e),32*t<i){let e=0;for(;0==(a<<31-e&4294967295);)e++;32*t+e<i&&(i=32*t+e)}if(32*t+31>s){let e=31;for(;a>>>e==0;)e--;32*t+e>s&&(s=32*t+e)}}}return s<i||o<l?null:Int32Array.from([i,l,s-i+1,o-l+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let n=0;for(;n<t.length&&0===t[n];)n++;if(n===t.length)return null;const r=n/e;let i=n%e*32;const l=t[n];let s=0;for(;0==(l<<31-s&4294967295);)s++;return i+=s,Int32Array.from([i,r])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let n=t.length-1;for(;n>=0&&0===t[n];)n--;if(n<0)return null;const r=Math.floor(n/e);let i=32*Math.floor(n%e);const l=t[n];let s=31;for(;l>>>s==0;)s--;return i+=s,Int32Array.from([i,r])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof a))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&l.default.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+l.default.hashCode(this.bits),e}toString(e="X ",t="  ",n="\n"){return this.buildToString(e,t,n)}buildToString(e,t,n){let r=new s.default;for(let i=0,l=this.height;i<l;i++){for(let n=0,l=this.width;n<l;n++)r.append(this.get(n,i)?e:t);r.append(n)}return r.toString()}clone(){return new a(this.width,this.height,this.rowSize,this.bits.slice())}}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XStringEle=void 0;const r=n(3),i=n(0),l=n(106),s=n(590),o=n(2),a=n(21),u=n(4);class h extends i.XBaseContainer{constructor(){super(...arguments),this.isXInputBkgText=!1,this.secret_firstch_ix=0,this.secret_pa_allch_cnt=0}get EleTypeName(){return"XString"}get IsXInputBkgText(){return this.isXInputBkgText}set IsXInputBkgText(e){this.isXInputBkgText=e}IsDelete(){for(let e of this.ChildEleList)if(-1==e.EleStyle.DeleterIndex)return!1;return!0}get Text(){return this.propList.GetPropValue("Text")}set Text(e){this.UpdateText(e)&&(this._RefreshChildCharEles(),this.ReCalcBaseSize())}set Secret_FirstCh_Ix(e){this.secret_firstch_ix=e}set Secret_PaAllCh_Cnt(e){this.secret_pa_allch_cnt=e}Clear(){super.Clear(),this.UpdateText(null),this.secret_firstch_ix=0,this.secret_pa_allch_cnt=0}CanBeInline(e=!1){return!1}AddChildEle(e,t){let n,r;if(t instanceof i.XCharacterEle&&(n=t),null==n)return r=-1,r;e=super.AddChildEle(e,n);let l=this.Text;return null==l&&(l=""),e<=0?l=n.ChVal+l:e>=l.length?l+=n.ChVal:l=l.slice(0,e)+n.ChVal+l.slice(e),this.UpdateText(l),r=e,r}RemoveChild(e){let t,n=super.RemoveChild(e);if(null==n)t=null;else{let e=this.Text;this.UpdateText(e),t=n}return this.ChildCount<1&&(this.IsRemoved=!0),t}AddChildrenEle(e,t){let n;if(null==t||0==t.length)return n=-1,n;let l=new a.default,s=new r.List,o=t;for(let e=0;e<o.length;e++){let t,n=o[e];n instanceof i.XCharacterEle&&(t=n),null!=t&&(s.Add(t),l.append(t.ChVal))}let h=l.toString(),d=s.ToArray();if(t=null,s.Clear(),(e=super.AddChildrenEle(e,d))<0)return n=-1,n;l.setLengthToZero();let c=this.Text;return u.default.IsNullOrEmpty(c)?l.append(h):(l.append(c.substring(0,e)),l.append(h),l.append(c.substring(e))),c=l.toString(),this.UpdateText(c),l.setLengthToZero(),n=e,n}RemoveChildren(e,t){let n,r=super.RemoveChildrenWithRange(e,t);if(null==r||r.length<=0)n=r;else{let e=this.Text;this.UpdateText(e),n=r}return n}MergeChildrenFrom(e,t){if(!super.MergeChildrenFrom(e,t))return!1;let n=e;if(null==n)return!1;let r=this.Text;null==r&&(r=""),r+=n.Text,this.UpdateText(r);let i=n.UndoRelateId;return null!=n.Attr_FgHide&&(this.Attr_FgHide=n.Attr_FgHide),null!=n.SelfHide&&(this.SelfHide=n.SelfHide),this.UpdateUndoRelateId(i),!1}SplitSelf(e,t,n){if(null==t)return-1;if(t instanceof i.XCharacterEle){let r=this.AddChildEle(e,t);if(r>=0&&null!=n){let e=new l.EleAddDelUndo(t,r,!0);n.AddItem(e)}return r}let r=super.ChildCount;if(r<=0)return-1;e<0?e=0:e>r&&(e=r);let o=super.Parent,a=o.GetChildInx(this),u=-1;if(e<=0||e>=r){if(u=e<=0?a:a+1,u=o.AddChildEle(u,t),u>=0&&null!=n){let e=new l.EleAddDelUndo(t,u,!0);n.AddItem(e)}}else{let i=new s.XStrSplitUndo(this,a,e),l=this.RemoveChildren(e,r-e),d=new h;o.AddChildEle(a+1,d),d.AddChildrenEle(0,l),u=o.AddChildEle(a+1,t),null!=n&&(i.SetEndXtr(d,t),n.AddItem(i))}return u}GetRealAddPos_SplitRes(e){let t;return t=null==e||e.length<2?-1:e[1]>=0?e[1]:e[0],t}_RefreshChildCharEles(){this.ClearChildren(!0);let e=this.Text;if(null==e)return;let t=[],n=e.indexOf("𬌗");for(let r=0;r<e.length;r++){let i=e[r];n!=r?t.push(i):(t.push("𬌗"),r++)}if(null!=t&&0!=t.length)for(let e=0;e<t.length;e++){let n=t[e],r=new i.XCharacterEle(n);super.AddChildEle(2147483647,r),r.EleStyle.CopyFrom(super.EleStyle,!0)}}UpdateUndoRelateId(e){return null!=e&&(this.propList.ModifyProperty("UndoRelateId",e,null),this.IsLayoutValid=!1,!0)}UpdateText(e){return this.Text!=e&&(this.propList.ModifyProperty("Text",e,null),this.IsLayoutValid=!1,!0)}ChangeSecretType(e){if(this.secret_pa_allch_cnt>0){switch(e){case o.ENumSecretType.None:case o.ENumSecretType.All:this._SwitchSecretTp_Fully_(e);break;case o.ENumSecretType.Partial:this._SwitchSecretTp_Partial_(this.secret_firstch_ix,this.secret_pa_allch_cnt)}this.ReCalcBaseSize()}}_SwitchSecretTp_Fully_(e){let t=super.GetChildIter();for(;t.MoveNext();){let n=t.Current;null!=n&&n.ChangeSecretType(e)}}_SwitchSecretTp_Partial_(e,t){let n=super.ChildCount,r=e+n,i=!1,l=!1;if(e<=0&&(i=!0),r>=t&&(l=!0),i||l){let e=super.GetChildArr();if(1==t)e[0].ChangeSecretType(o.ENumSecretType.All);else if(2==t)i?(e[0].ChangeSecretType(o.ENumSecretType.None),r>=t&&e[1].ChangeSecretType(o.ENumSecretType.All)):e[0].ChangeSecretType(o.ENumSecretType.All);else{i?(e[0].ChangeSecretType(o.ENumSecretType.None),e[n-1].ChangeSecretType(r>=t?o.ENumSecretType.None:o.ENumSecretType.All)):l&&(e[0].ChangeSecretType(o.ENumSecretType.All),e[n-1].ChangeSecretType(o.ENumSecretType.None));for(let t=1;t<n-1;t++)e[t].ChangeSecretType(o.ENumSecretType.All)}}else this._SwitchSecretTp_Fully_(o.ENumSecretType.All)}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r),t||(this.Text=null);let i=e;null!=i&&(this.isXInputBkgText=i.isXInputBkgText,this.secret_firstch_ix=i.secret_firstch_ix,this.secret_pa_allch_cnt=i.secret_pa_allch_cnt)}ReCalcBaseSize(){for(let e of this.ChildEleList)e.ReCalcBaseSize()}NeedSerialized_New(){return super.NeedSerialized()}NeedSerialized(){return super.NeedSerialized()&&super.ChildCount>0}ToXMLs(e){let t=[];if(!this.NeedSerialized())return null;let n=this._BeforeToXML_SplitByEleStyle(),r=null==n?0:n.length;for(let i=0;i<r;i++)if(n[i].NeedSerialized_New()){let r=n[i].BaseToXML(e);t[i]=r}return t}ToXML(e){return null}_BeforeToXML_SplitByEleStyle(){let e;if(super.ChildCount<=0)return e=[this],e;let t=new a.default,n=null,l=new r.List,s=new r.List,o=super.GetChildIter();for(;o.MoveNext();){let e=o.Current;if(null!=e&&e instanceof i.XCharacterEle){if(null==n||n.IsEqual(e.EleStyle))l.Add(e);else{let r=this._CrtNewXStr_ToXML(l,n,t);s.Add(r),l.Clear(),l.Add(e)}n=e.EleStyle}}if(l.Count()>0){let e=this._CrtNewXStr_ToXML(l,n,t);s.Add(e),null!=this.UndoRelateId&&(s.Get(0).UndoRelateId=this.UndoRelateId),null!=this.Attr_FgHide&&(s.Get(0).Attr_FgHide=this.Attr_FgHide),null!=this.SelfHide&&(s.Get(0).SelfHide=this.SelfHide)}return s.ToArray()}_CrtNewXStr_ToXML(e,t,n){if(null==e||e.Count()<=0)return null;let r=new h,i=r.XID;r.OwnerDocPanel=this.OwnerDocPanel;let l=0;n.setLengthToZero();for(let t of e)t.SetXmlEleIx(i,l),n.append(t.ChVal),l++;return r.UpdateText(n.toString()),r.EleStyle.CopyFrom(t,!0),r}FromXML(e){super.BaseFromXML(e),this._RefreshChildCharEles(),this.ReCalcBaseSize(),this._AfterFromXML_FillUserHistEle()}_AfterFromXML_FillUserHistEle(){let e=this.Document;if(null==e)return;let t=e.GetUserHistoryList();if(0==t.Count)return;let n=super.GetChildIter();for(;n.MoveNext();){let e=n.Current,r=e.EleStyle,i=r.DeleterIndex;if(i<0&&(i=r.CreatorIndex),i>=0){let n=t.FindBySerno(i);null!=n&&n.AddRelEle(2147483647,e)}}}}t.XStringEle=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XInputUtil=void 0;const r=n(54),i=n(312),l=n(3),s=n(46),o=n(115),a=n(39),u=n(0),h=n(42),d=n(4);class c{static GetInstance(){return null==c._inputUtil&&(c._inputUtil=new c),c._inputUtil}static MacroEle_IsDateOut(e){return"DateTime"==c.MarcroWithOutFormat(e)}static MacroEle_IsDateOutWithElementInfo(e){return"DateTime"==e.Out_style}static MacroEle_IsNumOut(e){return"Numberic"==c.MarcroWithOutFormat(e)}static MacroEle_IsNumOutWithElementInfo(e){return"Numberic"==e.Out_style}static MarcroWithOutFormat(e){let t;if(null==e)t="";else if("1001"!=e.Attr_TypeCode)t="";else{let n=e.GetAttribute("macroEleOutStyle");t=d.default.IsNullOrEmpty(n)?"":n}return t}static SepicalDealMacroEle(e,t){if("1001"==t.Code_mrdetp)if(t.Out_style=e.GetAttribute("macroEleOutStyle"),t.Out_format=e.GetAttribute("macroEleOutFormat"),c.MacroEle_IsDateOutWithElementInfo(t)&&!d.default.IsNullOrEmpty(t.Out_format)){let e=t.Out_format.split("|");e.length>=1&&(t.Dt_format=e[0],t.Out_format=e[0])}else c.MacroEle_IsNumOutWithElementInfo(t)}SetElesStyle(e,t){if(null!=e&&0!=e.length)for(let n=0;n<e.length;n++){let r=e[n];r instanceof u.XBaseContainer?this.SetElesStyle(r.GetChildArr(),t):this.SetCurEleStyle(r,t)}}SetCurEleStyle(e,t){e.EleStyle.CopyFrom(t,!1)}static IsExistWildChar(e){if(d.default.IsNullOrEmpty(e))return!1;let t=!1,n=i.InputWildCastsConst.GetInstance().InputWildKeys;for(let r=0;r<n.length;r++){let i=n[r].split("_");if(2==i.length){let n=i[0],r=i[1];if(e.indexOf(n)>-1&&e.indexOf(r)>-1){t=!0;break}}}return t}RemoveChilds(e,t){if(null!=e&&null!=t)for(let n of t)e.RemoveChildWithEle(n)}BulidEleInfo_InputField(e){let t;if(null==e)t=null;else{let n=new r.ElementInfo;if(n.Code_mrdetp=e.Attr_TypeCode,n.Code_de=e.InputDecode,n.EditorMode=e.EditorMode,n.Name_de=e.InputDecodeName,n.ValueCode_de=e.InputDeValueCode,n.conceptDomainCode=e.CptID,n.EditorEventActiveMode=e.EditorEventActiveMode,n.IsPrint=e.IsPrint,n.IsDisSkip=e.IsDisSkip,n.Fg_hide=e.Attr_FgHide,n.InputEventName=e.InputEventName,n.Fg_quote=e.Input_FgQuote,n.Fg_qs=e.Input_FgQs,n.Id_mr_de=e.GrpID,n.Name=e.Name,n.CptID=e.CptID,n.ExtendAttr1=e.ExtendAttr1,n.LackEllipsisvalue=e.LackEllipsisvalue,n.DynamicData=e.DynamicData,n.CustomAttribute=e.CustomAttribute,null!=e.Visible_Expression&&null!=e.Visible_Expression&&(n.Text_Expression=encodeURIComponent(e.Visible_Expression)),n.Text_label=e.LabelText,n.Text_tip=e.EleToolTip,n.Suffix_label=e.SuffixText,n.Text_background=e.BackgroundText,n.Gender=e.Gender,n.DefaultCurrentTimeFlag=e.DefaultCurrentTimeFlag,n.PrintCurrentTimeFlag=e.PrintCurrentTimeFlag,n.MaxAge=e.MaxAge,n.MinAge=e.MinAge,n.Fg_encrypt=e.CanSecretReal(),n.Fg_border="AlwaysVisible"==e.BorderVisible,n.Fg_delete=e.Deletable,n.Fg_edit=e.UserEditable,n.IsPrint=e.IsPrint,n.IsDisSkip=e.IsDisSkip,n.IsRefreshSysTime=e.IsRefreshSysTime,n.Activation_Mode_Key=e.EditorActiveMode,n.CanBeInLine_StartBorder=e.StartBorderPritnInLine,n.CanBeInLine_EndBorder=e.EndBorderPritnInLine,n.QuoteSource=e.QuoteSource,n.QuoteTarget=e.QuoteTarget,n.DiagnoseType=e.DiagnoseType,n.Arrangement=e.Arrangement,n.SplitChar=e.SplitChar,n.ShowWay=e.ShowWay,n.InTable=e.InTable,n.InTableColIx=e.InTableColIx,null!=e.DataSrc){n.Su_des=e.SurePrefix,n.Ne_des=e.NegativePrefix,n.Valuelist=new l.List;for(let t=0;t<e.DataSrc.DataList.Length;t++)n.Valuelist.Add(e.DataSrc.DataList.Get(t))}null!=e.ValueBinding&&(n.Name_source=e.ValueBinding.DataSource,n.Name_property=e.ValueBinding.BindingPath),null!=e.ValidateStyle&&(n.CheckMaxValue=e.ValidateStyle.CheckMaxValue,n.CheckMinValue=e.ValidateStyle.CheckMinValue,n.Lg_max=e.ValidateStyle.MaxLength,n.Lg_min=e.ValidateStyle.MinLength,n.Nu_digit=e.ValidateStyle.MaxDecimalDigits,n.Nu_max=e.ValidateStyle.MaxValue,n.Nu_min=e.ValidateStyle.MinValue),null!=e.DisplayFormat&&(n.Dt_format=e.DisplayFormat.Format),n.Value_expression=e.NumExpression,n.Text_unit=e.UnitText,n.ShowDialog=e.ShowDialog,n.CanEmpty=e.CanEmpty,n.DefaultValue=e.DefalultValue,n.SelModel=e.SelModel,n.IsSensitiveInfo=e.IsSensitiveInfo,n.Occupying_Num=e.MinSpaceNumber,n.IsStartUp_UnderLine=e.IsShowUnderLine_ShowSpace,c.SepicalDealMacroEle(e,n),n.SqlText=e.SqlText,n.IsAddCallBack=e.IsAppendWrite,n.Sql_WriteBack_PropName=e.Sql_WriteBack_PropName,n.RefCode=e.RefCode,n.RefName=e.RefName,n.ActiveStyle=e.RefActiveStyle,n.RefIsMulSel=e.RefIsMulSel,n.RefResultFormatStr=e.RefResultFormatStr,n.RefResultIsVertLayout=e.RefResultIsVertLayout,n.LastSpliteCharShowRule=e.LastSpliteCharShowRule,n.IsAddCallBack=e.IsAppendWrite,n.IsAllowKeyInput=e.IsAllowKeyInput,n.IsQrCode=e.IsQrCode,n.CodeRule=e.CodeRule,n.BulidCodeRightNow=e.BulidCodeRightNow,n.QrCode_IsShowLabelText=e.QrCode_IsShowLabelText,n.QrCode_LabelText=e.QrCode_LabelText,n.QrCode_LabelTextPosition=e.QrCode_LabelTextPosition,n.QrCode_IsAllowDrag=e.QrCode_IsAllowDrag,n.HasSearch=e.HasSearch,t=n}return t}BulidEleInfo_InputGroup(e){let t;if(null==e)return t=null,t;let n=new r.ElementInfo;return n.Code_mrdetp=e.Attr_TypeCode,n.Code_de=e.Decode,n.Name_de=e.DecodeName,n.ValueCode_de=e.DeValueCode,n.Fg_hide=e.Attr_FgHide,n.Id_mr_de=e.GrpID,n.Name=e.Name,n.Text_tip=e.EleToolTip,n.Fg_delete=e.Deletable,n.IsMustChoose=e.IsMustCheck,null!=e.ValueBinding&&null!=e.ValueBinding&&(null!=e.ValueBinding.DataSource&&null!=e.ValueBinding.DataSource&&(n.Name_source=e.ValueBinding.DataSource),null!=e.ValueBinding.BindingPath&&null!=e.ValueBinding.BindingPath&&(n.Name_property=e.ValueBinding.BindingPath)),n.BaseChoiceShowStyle=e.BaseChoiceShowStyle,n.VAlign=e.VAlign_Mark,n.IsShowRightText=e.IsShowRightText,n.IsTextRightShow=e.TextShowRight,n.IsStrongShow=e.Grp_StrongShow,t=n,t}GetCheckErrorStr(e){let t="";switch(e.CheckError_Type){case s.CheckErrorType.TextLength_Under:t="文字长度必须大于或等于"+e.ValidateStyle.MinLength+"个字符！";break;case s.CheckErrorType.TextLength_Over:t="文字长度必须小于或等于"+e.ValidateStyle.MaxLength+"个字符！";break;case s.CheckErrorType.Number_Under:t="录入值必须大于或等于"+e.ValidateStyle.MinValue+"！";break;case s.CheckErrorType.Number_Over:t="录入值必须小于或等于"+e.ValidateStyle.MaxValue+"！";break;case s.CheckErrorType.Number_Digits_Over:t="小数位数必须小于或等于"+e.ValidateStyle.MaxDecimalDigits+"位！";break;case s.CheckErrorType.Number_TextType_ILegal:t="输入内容不可存在中文或其他特殊字符！";break;case s.CheckErrorType.NotEmpty:t="输入内容不可为空！";break;case s.CheckErrorType.MustChoose:t="当前组至少选择一个！";break;case s.CheckErrorType.MustNumber:t="录入值必须是数值！";break;case s.CheckErrorType.DateFormat:t="日期格式不对"}return t}GetGrandPaXInputList(e){let t,n=new l.List;if(null==e||null==e.Parent||e.Parent instanceof u.XDocPanel)return t=n,t;for(e=e.Parent;null!=e;e=e.Parent)n.Add(e);return t=n,t}GetUniqueCode(){return d.default.Format("{0}{1}{2}",o.EleIDPrefix.GId_Prev,a.DateTime.Now.ToString("yyyyMMddHHmmss"),this.GenerateCheckCodeNum(6))}GenerateCheckCodeNum(e){let t=d.default.Empty;a.DateTime.Now.Ticks;for(let n=0;n<e;++n){t+=(48+Math.random()%10).toString()}return t}AlertDiagnosisEleForm(e,t,n,r){null==e&&(e=h.XInputFactory.GetInstance().GetDiagnosisEle())}}t.XInputUtil=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetTableAlign=void 0;const r=n(0),i=n(64),l=n(20),s=n(11),o=n(3),a=n(145),u=n(120);class h extends u.A_SetHAlignBase{constructor(){super(...arguments),this.rowIx=-1,this.colIx=-1}ActName(){return"SetTableAlign"}Execute(e){this.resMsg.Clear(),this.resMsg.ReturnParams=null,this.resMsg.IsReturnMsg=!0;let t=[];this.resMsg.MsgStr="";const n=super.GetEdtCtrl().All_Document;for(let i=0;i<e.length;i++){const s=e[i];this.formatParamVals(s);let a=!1,u=!1,h=!1,d=!1;for(var r=0;r<n.length;r++){const e=n[r],i=e.DocID;if(-1==t.indexOf(i)&&t.push(i),this.docId&&i!=this.docId)continue;if(a=!0,!this.eleId)continue;const s=e.GetPagePanel(1);if(null==s)continue;const c=this.getEleByeleId(this.eleId,s);if(c.Count()>0){u=!0;const e=c.ToArray();for(let t=0;t<e.length;t++){const n=e[t],r=l.XTextTableUtil.GetCursorTextTable(n);if(null==r)continue;const i=r.Rows;if(null==i)continue;h=!0;const s=i.ToArray();let a=new o.List;for(let e=0;e<s.length;e++){const t=s[e];if(this.rowIx>=0&&e!=this.rowIx)continue;const n=t.Cells;if(null==n)continue;const r=n.ToArray();for(let e=0;e<r.length;e++){const t=r[e];this.colIx>=0&&e!=this.colIx||a.Add(t)}}a.Count()>0&&(d=!0,this.M_SetTableCellsAlign(this.hAlign,this.vAlign,a))}}}a||(this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+i+"]中的docId="+this.docId+" 不存在病历文档Id["+t.join(",")+"]中。<br />"),u||(this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+i+"]中的innerEleID="+this.eleId+" 不存在。<br />"),h||(this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+i+"]中的innerEleID="+this.eleId+" 不在表格里。<br />"),d||(this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+i+"]中的行索引="+this.rowIx+" 列索引="+this.colIx+" 找不到对应的单元格。<br />")}return this.resMsg}formatParamVals(e){e[0];let t=e.docId;a.LangUtils.IsString(t)||(t=null),this.docId=t;let n=e.innerEleID;a.LangUtils.IsString(n)||(n=null),this.eleId=n;let r=e.hAlign;r="CENTER"==r?s.ENumHAlignStyle.CENTER:"RIGHT"==r?s.ENumHAlignStyle.RIGHT:s.ENumHAlignStyle.LEFT,this.hAlign=r;let l=e.vAlign;l="MIDDLE"==l?i.XTextTableCellAlign.MIDDLE:"BOTTOM"==l?i.XTextTableCellAlign.BOTTOM:i.XTextTableCellAlign.TOP,this.vAlign=l;let o=Number(e.rowIx);o>=0||(o=-1),this.rowIx=o;let u=Number(e.colIx);u>=0||(u=-1),this.colIx=u}M_SetTableCellsAlign(e,t,n){let r,i=!1,l=super.GetEdtCtrl().M_EleEvtModel.EleClicked;if(r=null!=n?n:this.GetTableAlignCells(l),null!=r&&0!=r.Count()){for(let n=0;n<r.Count();n++){let l=r.Get(n);super.Execute([e,l]),super.IsHAlignChanged&&(i||(i=!0)),l.CellAlign!=t&&(l.CellAlign=t,l.NotifyLayoutChanged(!0,!1),i||(i=!0))}i&&super._RefreshPageAndMoveCaret(!0,!0)}}GetTableAlignCells(e){let t=super.GetEdtCtrl().M_EleEvtModel.SelRange.InfoUtil.GetLineElesInRange(!0,!0),n=new o.List;if(null!=t&&t.length>0){let e=t;for(let t=0;t<e.length;t++){let i=e[t],l=i instanceof r.XTextTableCell?i:null;null!=l&&n.Add(l)}}else{let t=l.XTextTableUtil.GetCursorCell(e);null!=t&&n.Add(t)}return n}}t.A_SetTableAlign=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Padding=void 0;class r{constructor(e,t,n,r){this.Left=0,this.initLeft=0,this.Right=0,this.initRight=0,this.Top=0,this.initTop=0,this.Bottom=0,this.initBottom=0,this.Left=e,this.Right=n,this.Top=t,this.Bottom=r}static get Empty(){return new r(0,0,0,0)}Clone(){return new r(this.Left,this.Top,this.Right,this.Bottom)}}t.Padding=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XImageUtil=void 0;const r=n(196),i=n(4),l=n(26);t.XImageUtil=class{static Base64ToImage(e,t=!0){let n;if(i.default.IsNullOrEmpty(e))n=null;else{let i=new r.XImage;const s=new Image;if(t){let t=e.split(","),n="";n=1==t.length?"data:image/gif;base64,"+t[0]:e,s.src=n}else s.src=l.TextDocInitInfo.GetInstance().ImageUrl+e;i.ImageEle=s,n=i}return n}static ImageToBase64(e){if(null==e)return null;var t=document.createElement("canvas");t.width=e.Width,t.height=e.Height,t.getContext("2d").drawImage(e.ImageEle,0,0,e.Width,e.Height);let n="image/png";const r=e.ImageEle.src.split(",");r.length>1&&"data:image/jpeg;base64"==r[0]&&(n="image/jpeg");return t.toDataURL(n,1)}static CalcImgZmRatio(e,t,n,r){let i;return i=e/t>=n/r?n/e:r/t,i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{static numberOfTrailingZeros(e){let t;if(0===e)return 32;let n=31;return t=e<<16,0!==t&&(n-=16,e=t),t=e<<8,0!==t&&(n-=8,e=t),t=e<<4,0!==t&&(n-=4,e=t),t=e<<2,0!==t&&(n-=2,e=t),n-(e<<1>>>31)}static numberOfLeadingZeros(e){if(0===e)return 32;let t=1;return e>>>16==0&&(t+=16,e<<=16),e>>>24==0&&(t+=8,e<<=8),e>>>28==0&&(t+=4,e<<=4),e>>>30==0&&(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135,e+=e>>>8,63&(e+=e>>>16)}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t){return parseInt(e,t)}}t.default=r,r.MIN_VALUE_32_BITS=-2147483648,r.MAX_VALUE=Number.MAX_SAFE_INTEGER},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.OTHER=0]="OTHER",e[e.ORIENTATION=1]="ORIENTATION",e[e.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",e[e.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",e[e.ISSUE_NUMBER=4]="ISSUE_NUMBER",e[e.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",e[e.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",e[e.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",e[e.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",e[e.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",e[e.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"}(r||(r={})),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(99),i=n(50),l=n(85),s=n(41),o=n(5);class a{decode(e,t){try{return this.doDecode(e,t)}catch(n){if(t&&!0===t.get(i.default.TRY_HARDER)&&e.isRotateSupported()){const n=e.rotateCounterClockwise(),r=this.doDecode(n,t),i=r.getResultMetadata();let o=270;null!==i&&!0===i.get(l.default.ORIENTATION)&&(o+=i.get(l.default.ORIENTATION)%360),r.putMetadata(l.default.ORIENTATION,o);const a=r.getResultPoints();if(null!==a){const e=n.getHeight();for(let t=0;t<a.length;t++)a[t]=new s.default(e-a[t].getY()-1,a[t].getX())}return r}throw new o.NotFoundException}}reset(){}doDecode(e,t){const n=e.getWidth(),a=e.getHeight();let u=new r.default(n);const h=t&&!0===t.get(i.default.TRY_HARDER),d=Math.max(1,a>>(h?8:5));let c;c=h?a:15;const p=Math.trunc(a/2);for(let r=0;r<c;r++){const o=Math.trunc((r+1)/2),h=p+d*(0==(1&r)?o:-o);if(h<0||h>=a)break;try{u=e.getBlackRow(h,u)}catch(e){continue}for(let e=0;e<2;e++){if(1===e&&(u.reverse(),t&&!0===t.get(i.default.NEED_RESULT_POINT_CALLBACK))){const e=new Map;t.forEach((t,n)=>e.set(n,t)),e.delete(i.default.NEED_RESULT_POINT_CALLBACK),t=e}try{const r=this.decodeRow(h,u,t);if(1===e){r.putMetadata(l.default.ORIENTATION,180);const e=r.getResultPoints();null!==e&&(e[0]=new s.default(n-e[0].getX()-1,e[0].getY()),e[1]=new s.default(n-e[1].getX()-1,e[1].getY()))}return r}catch(e){}}}throw new o.NotFoundException}static recordPattern(e,t,n){const r=n.length;for(let e=0;e<r;e++)n[e]=0;const i=e.getSize();if(t>=i)throw new o.NotFoundException;let l=!e.get(t),s=0,a=t;for(;a<i;){if(e.get(a)!==l)n[s]++;else{if(++s===r)break;n[s]=1,l=!l}a++}if(s!==r&&(s!==r-1||a!==i))throw new o.NotFoundException}static recordPatternInReverse(e,t,n){let r=n.length,i=e.get(t);for(;t>0&&r>=0;)e.get(--t)!==i&&(r--,i=!i);if(r>=0)throw new o.NotFoundException;a.recordPattern(e,t+1,n)}static patternMatchVariance(e,t,n){const r=e.length;let i=0,l=0;for(let n=0;n<r;n++)i+=e[n],l+=t[n];if(i<l)return Number.POSITIVE_INFINITY;const s=i/l;n*=s;let o=0;for(let i=0;i<r;i++){const r=e[i],l=t[i]*s,a=r>l?r-l:l-r;if(a>n)return Number.POSITIVE_INFINITY;o+=a}return o/i}}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelEleItemInfo=void 0;const r=n(3);t.SelEleItemInfo=class{constructor(){this._index=0,this._key=null,this._value=null,this._level=-1,this._groupNum=null,this._xid=null,this._grpId=null,this.ChildEleItems=new r.List}get Index(){return this._index}set Index(e){this._index=e}get Key(){return this._key}set Key(e){this._key=e}get Value(){return this._value}set Value(e){this._value=e}get Level(){return this._level}set Level(e){this._level=e}get ChildEleItems(){return this._childEleItems}set ChildEleItems(e){this._childEleItems=e}get GroupNum(){return this._groupNum}set GroupNum(e){this._groupNum=e}get XId(){return this._xid}set XID(e){this._xid=e}get GrpId(){return this._grpId}set GrpId(e){this._grpId=e}get EleToolTip(){return this._eleToolTip}set EleToolTip(e){this._eleToolTip=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XInputEle=void 0;const r=n(58),i=n(46),l=n(80),s=n(592),o=n(16),a=n(217),u=n(218),h=n(311),d=n(219),c=n(0),p=n(133),f=n(167),g=n(40),m=n(8),E=n(138),C=n(3),A=n(39),y=n(321),I=n(7),S=n(13),_=n(14),w=n(36),b=n(322),x=n(42),P=n(37),v=n(26),T=n(44),M=n(59),L=n(108),D=n(323),R=n(92),F=n(639),N=n(640),B=n(17),k=n(2);class O extends c.XBaseInputEle{constructor(){super(...arguments),this._docEditor=null,this.isHaveTraceDeleteSerno=-1,this._DiagnoseValueArr=[]}get CheckError_Type(){return super.CheckError_Type}set CheckError_Type(e){super.CheckError_Type=e,this.CheckError_Type==i.CheckErrorType.None?this.ToolTip=this.EleToolTip:this.ToolTip=l.XInputUtil.GetInstance().GetCheckErrorStr(this)}get RelEleIds(){return this.propList.GetPropValue("RelEleIds")}set RelEleIds(e){this.propList.ModifyProperty("RelEleIds",e,"")}get ChkFailTipArray(){}get Data_PropName(){return super.ValueBinding.BindingPath}get Data_PropValue(){return super.InnerValue}get SourceName(){return super.ValueBinding.DataSource}get IsLinkEle(){return this.InputType==g.EleTypeEnum.SqlEle||this.InputType==g.EleTypeEnum.RefEle}get IsAllowKeyInput(){let e=this.propList.GetPropValue("IsAllowKeyInput");return this.InputType!=g.EleTypeEnum.TextEle&&this.InputType!=g.EleTypeEnum.NumEle&&this.InputType!=g.EleTypeEnum.SignEle&&this.InputType!=g.EleTypeEnum.NormalEle&&this.InputType!=g.EleTypeEnum.PhaseEle||(e=!0),m.CNumUtil.TryParseBool(e,!0)}set IsAllowKeyInput(e){this.propList.ModifyProperty("IsAllowKeyInput",e,!0)}get Data_PropDetailValue(){let e;return e=this.InputType==g.EleTypeEnum.SqlEle?super.SqlTextDetail:"",e}get IsQrCode(){let e=this.propList.GetPropValue("IsQrCode");return m.CNumUtil.TryParseBool(e,!0)}set IsQrCode(e){this.propList.ModifyProperty("IsQrCode",e,!0)}get CodeRule(){return this.propList.GetPropValue("CodeRule")}set CodeRule(e){this.propList.ModifyProperty("CodeRule",e,null)}get InputEventName(){return this.propList.GetPropValue("InputEventName")}set InputEventName(e){this.propList.ModifyProperty("InputEventName",e,null)}get DateTimeValue(){if(this.InputType==g.EleTypeEnum.DateEle){let e=this.InnerValue,t=super.DisplayFormat.Format,n=new A.DateTime;return A.DateTime.TryParse(e,t,n)?n.ToString("yyyy-MM-dd HH:mm:ss"):""}return null}get BulidCodeRightNow(){let e=this.propList.GetPropValue("BulidCodeRightNow");return m.CNumUtil.TryParseBool(e,!1)}set BulidCodeRightNow(e){this.propList.ModifyProperty("BulidCodeRightNow",e,!1)}get QrCode_IsShowLabelText(){let e=this.propList.GetPropValue("QrCode_IsShowLabelText");return m.CNumUtil.TryParseBool(e,!1)}set QrCode_IsShowLabelText(e){this.propList.ModifyProperty("QrCode_IsShowLabelText",e,!1)}get QrCode_LabelText(){return this.propList.GetPropValue("QrCode_LabelText")}set QrCode_LabelText(e){this.propList.ModifyProperty("QrCode_LabelText",e,"")}get CustomAttribute(){return this.propList.GetPropValue("CustomAttribute")}set CustomAttribute(e){this.propList.ModifyProperty("CustomAttribute",e,"")}get InputExtendAttr(){return this.propList.GetPropValue("InputExtendAttr")}set InputExtendAttr(e){this.propList.ModifyProperty("InputExtendAttr",e,"")}get InputStorageData(){return this.propList.GetPropValue("InputStorageData")}set InputStorageData(e){this.propList.ModifyProperty("InputStorageData",e,"")}get QrCode_LabelTextPosition(){let e=this.propList.GetPropValue("QrCode_LabelTextPosition");return w.StringUtils.IsNullOrEmpty(e)&&(e="Bottom"),e}set QrCode_LabelTextPosition(e){this.propList.ModifyProperty("QrCode_LabelTextPosition",e,"Bottom")}get QrCode_IsAllowDrag(){let e=this.propList.GetPropValue("QrCode_IsAllowDrag");return m.CNumUtil.TryParseBool(e,!0)}set QrCode_IsAllowDrag(e){this.propList.ModifyProperty("QrCode_IsAllowDrag",e,!0)}set PreSetvalueText(e){this.propList.ModifyProperty("PreSetvalueText",e,"")}get PreSetvalueText(){return this.propList.GetPropValue("PreSetvalueText")}get Sql_WriteBack_PropName(){return this.propList.GetPropValue("Sql_WriteBack_PropName")}set Sql_WriteBack_PropName(e){this.propList.ModifyProperty("Sql_WriteBack_PropName",e,null)}get RefIsMulSel(){let e=this.propList.GetPropValue("RefIsMulSel");return m.CNumUtil.TryParseBool(e,!1)}set RefIsMulSel(e){this.propList.ModifyProperty("RefIsMulSel",e,!1)}get IsUseXId(){return!0}AddChildEle(e,t){let n=super.AddChildEle(e,t);return super.M_SetBorderEleEmptyIsShow(),n}AddChildrenEle(e,t){let n=super.AddChildrenEle(e,t);return super.M_SetBorderEleEmptyIsShow(),n}RemoveChild(e){let t=super.RemoveChild(e);return super.M_SetBorderEleEmptyIsShow(),t}RemoveChildren(e,t){let n=super.RemoveChildrenWithRange(e,t);return super.M_SetBorderEleEmptyIsShow(),n}CopyFromSelRange(e,t,n,r,i){let l=super.CopyFromSelRange(e,t,n,!0,i);if(l<=0)return 0;let s=e[t],o=s.Parent instanceof O?s.Parent:null;if(null==o)return 0;super.CopyFrom(o,null,n,!0),o=this;let a=this.M_TryGetXBorder(!0,o.StartEle),u=this.M_TryGetXBorder(!1,o.EndEle);super.InsertBorderEle(a,u),super.InsertLabelText(),o.MinSpaceNumber>0?(this.MinSpaceNumber=o.MinSpaceNumber,this.Init_AddEmptySpaceEle()):super.DynamicShowHideBackEle(),super.InsertUnitLabelText(),super.InsertSuffixText();let h=this.GetBackEle();return null!=h&&(this._backTextEle=h),o.InputType==g.EleTypeEnum.PhaseEle&&this.Copy_CorrectPhaseEleType(),l}M_TryGetXBorder(e,t){let n,r=new C.List;super.GetChildrenByType("XLableInputBorder",!1,r);for(let t of r){let r=t instanceof c.XInputBorderEle?t:null;if(null!=r&&r.IsStartBorder==e)return n=r,n}if(null!=t){let r=new c.XInputBorderEle;r.CopyFrom(t,!1,!1,!0),e?this.AddChildEle(0,r):this.AddChildEle(super.ChildCount,r),n=r}else n=null;return n}Copy_CorrectPhaseEleType(){super.Attr_TypeCode="5002",this.InputType=g.EleTypeEnum.TextEle}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r);let i=e instanceof O?e:null;null!=i&&(this.InputType=i.InputType)}GetBackEle(e=!1){let t=super.GetChildArr();if(null==t||0==t.length)return null;let n=null,r=-1,i=t;for(let e=0;e<i.length;e++){let t=i[e],l=t instanceof c.XStringEle?t:null;if(null!=l&&l.IsXInputBkgText){n=l,r=e;break}}return e?[n,r]:n}BindDocEditor(e){this._docEditor=e}UpdateInnerText(e,t=null,n){this.UpdateXInputValue(e,t,!1,n),this.Document.hasExpessionToRefreshDocView=!0}UpdateInput_InnerValue(e,t,n,r=null){null==this._undoGroup&&(this._undoGroup=new S.UndoGroup);let i=w.StringUtils.IsNullOrEmpty(t);i||this._inputAssist.RemoveBackEle();let l=r;null==l&&(l=this.UpdateText_BulidNewStyle2()),this.UpdateText_RemoveEle(e,n);let s=this.UpdateText_BulidNewEles(t,l);this.UpdateText_InsertEles(s,e),i&&super.DynamicShowHideBackEle(),this.IsLayoutValid=!1}TextChanged(){if(null!=this.Document){let e=this.Document.GetDocCtxt().ViewMode.IsCleanViewMode;if(!o.XDomUtil.IsEleRemoved(this,e)){l.XInputUtil.MacroEle_IsDateOut(this)||this.StartValueValidate(!0,null),T.TextDocApiUtil.M_InnerEleExcScrExp(this,this.Document,this._undoGroup);let e=l.XInputUtil.GetInstance().GetGrandPaXInputList(this);for(let t of e)T.TextDocApiUtil.M_InnerEleExcScrExp(t,this.Document,this._undoGroup);super.DirectXStrEleTextModified(!0),this.Pop_TextChangedMsg()}}}RemoveChildAll(e,t=!1,n=null,r=!0){let i=this.BulidRemoveEleList(e,n,t,r),o=i[0];if(n=i[1],null==o||0==o.Count())return null;let a=new s.XRemoveWrapper;if(a.FromPos=super.GetChildInx(o.Get(0)),a.RemoveEles=o.ToArray(),null!=this._undoGroup){let e=new E.EleRangeAddDelUndo(o.ToArray(),n.GetChildInx(o.Get(0)),!1);this._undoGroup.AddItem(e)}return l.XInputUtil.GetInstance().RemoveChilds(n,o),a}GetElementsByType(e,t){let n=new C.List;return super.GetChildrenByType(e,t,n),n}GetChildInputEleList(e){let t;if(e){t=this.GetElementsByType("XInputField",!0)}else t=new C.List;return t}UpdateChildElement1(e,t){if(t||this.RemoveChildAll(!0,!1,null,!1),null==e||0==e.Count())return;let n=this.UpdateText_BulidNewStyle2();l.XInputUtil.GetInstance().SetElesStyle(e.ToArray(),n);let r=new C.List;for(let t of e)if("XLableInputBorder"!=t.EleTypeName){if(t instanceof c.XStringEle){if(t.IsXInputBkgText)continue}r.Add(t)}this.AddChildrenEle(super.ChildCount-1,r.ToArray()),super.DynamicShowHideBackEle(),this.NotifyLayoutChanged(!0,!0),super.DynamicShowHideBackEle()}UpdateChildElement2(e,t,n){let r=new S.UndoGroup;if(!n){let e=this.RemoveChildAll(!0,!1,null,!0);if(null!=e){let t=new E.EleRangeAddDelUndo(e.RemoveEles,e.FromPos,!1);r.AddItem(t)}}let i,l=e.GetPagePanel(t).GetChildArr();if(0==l.length)return i=null,i;let s=l.ToList();s.RemoveAt(s.Count()-1),l=s.ToArray(),this.AddChildrenEle(super.ChildCount-1,l),super.DynamicShowHideBackEle(),this.NotifyLayoutChanged(!0,!0);let o=new E.EleRangeAddDelUndo(l.ToArray(),super.GetChildInx(l[0]),!0);return r.AddItem(o),i=r,i}SenderLoadDataEvent(){null!=O.DynamicLoadData&&O.DynamicLoadData(this)}get GetShowText(){return super.GetXInputText(!1,!1,!1,!1,!1,!1,!0)}GetInnerChildren(e){let t=this.ChildEleList;for(let n of t)if(!(n instanceof c.XInputBorderEle)){if(n instanceof c.XStringEle&&n.IsXInputBkgText)return e;e.Add(n)}}UpdateText_BulidNewStyle2(e=!1){let t,n=super.GetChildList(!1,this,!0)[0];if(null==n||0==n.Count())null!=super.GetBackTextXStrEle()&&(super.EleStyle.XFontStyle.FontName=this._backTextEle.EleStyle.XFontStyle.FontName,super.EleStyle.XFontStyle.FontSize=this._backTextEle.EleStyle.XFontStyle.FontSize),t=super.EleStyle;else{let r=null;if(n.Get(0)instanceof c.XBaseContainer){let e=n.Get(0);e.ChildCount>0&&(r=e.GetFirstChildBaseEle(!0).EleStyle)}else r=this.NeedSerialized()?e?super.EleStyle:n.Get(0).EleStyle:super.EleStyle;t=r}return t}StartValueValidate(e,t=null,n=!1){let r;if(!e)return r=!0,r;let s=!0;if(super.CanEmpty)this.CheckError_Type=i.CheckErrorType.None;else{if(w.StringUtils.IsNullOrEmpty(super.InnerValue))return this.CheckError_Type=i.CheckErrorType.NotEmpty,r=!1,this.backTextEleValidate(),r;this.CheckError_Type=i.CheckErrorType.None}let o=super.InnerValue;null!=o&&(o=o.trim());let a=!1,u=this.InputType,h=!1;switch(u){case g.EleTypeEnum.NumEle:s=this.NumEleValidate(o),r=this.IL_119(s,!0),h=!0;break;case g.EleTypeEnum.DateEle:s=this.DateEleValidate(t,o),r=this.IL_119(s,!0),h=!0;break;case g.EleTypeEnum.TextEle:break;default:if(u!=g.EleTypeEnum.PhaseEle){if(u!=g.EleTypeEnum.MacroEle){r=this.IL_119(s,!0),h=!0;break}l.XInputUtil.MacroEle_IsNumOut(this)?(s=this.NumEleValidate(o),a=!0):l.XInputUtil.MacroEle_IsDateOut(this)&&(s=this.DateEleValidate(t,o)),r=this.IL_119(s,a),h=!0}}return h||(s=this.TextEleValidate(o),r=this.IL_119(s,!0)),this.backTextEleValidate(),r}backTextEleValidate(){if(null!=this._backTextEle&&this.CheckError_Type!=i.CheckErrorType.None){const e=P.TextDocApiConst.InputFieldBackTextNoPassForeColor;if(this._backTextEle.EleStyle.ForeColor=e,this._backTextEle.ChildCount>0){const t=this._backTextEle.ChildEleList.ToArray();for(let n=0;n<t.length;n++){t[n].EleStyle.ForeColor=e}}}}IL_119(e,t,n=!0){if(null!=e&&t){let t=v.TextDocInitInfo.GetInstance().InputFieldBackColor,r=v.TextDocInitInfo.GetInstance().InputFieldForeColor;e?e&&(this.CheckError_Type=i.CheckErrorType.None,this._isError=!1):(t=v.TextDocInitInfo.GetInstance().InputFieldNoPassBackColor,r=v.TextDocInitInfo.GetInstance().InputFieldNoPassForeColor,this._isError=!0);let l=super.GetChildIter();this.UpdateEleFailColor_Recursion(l,t,r,this,n)}return!(null!=e)||e}NumEleValidate(e){let t;if(null==super.ValidateStyle)return!0;if((null==e||0==e.length)&&super.CanEmpty)return null;let n=Number(e);if(isNaN(n))return this.CheckError_Type=i.CheckErrorType.Number_TextType_ILegal,!1;if(n!=n)return this.CheckError_Type=i.CheckErrorType.MustNumber,t=!1,t;if(super.ValidateStyle.MaxDecimalDigits>=0){let n,r=e.split(".");if(n=r.length<2?0:r[1].length,n>super.ValidateStyle.MaxDecimalDigits)return this.CheckError_Type=i.CheckErrorType.Number_Digits_Over,t=!1,t}if(super.ValidateStyle.CheckMaxValue){let e=super.ValidateStyle.MaxValue;if(null!=e&&n>e)return this.CheckError_Type=i.CheckErrorType.Number_Over,t=!1,t}if(super.ValidateStyle.CheckMinValue){let e=super.ValidateStyle.MinValue;if(null!=e&&n<e)return this.CheckError_Type=i.CheckErrorType.Number_Under,t=!1,t}return t=!0,t}TextEleValidate(e){let t;if(null==super.ValidateStyle)t=null;else if(super.ValidateStyle.Required){let n=null==e?0:e.length;if(0==n&&super.CanEmpty)t=null;else{if(null!=super.ValidateStyle.MaxLength&&0!=super.ValidateStyle.MaxLength){if(n>super.ValidateStyle.MaxLength)return this.CheckError_Type=i.CheckErrorType.TextLength_Over,t=!1,this._isError=!0,t;this._isError=!1}if(null!=super.ValidateStyle.MinLength){if(n<super.ValidateStyle.MinLength)return this.CheckError_Type=i.CheckErrorType.TextLength_Under,t=!1,this._isError=!0,t;this._isError=!1}this._isError?t=null:(this.CheckError_Type=i.CheckErrorType.None,t=!0)}}else t=null;return t}DateEleValidate(e,t){let n;null==e&&(e=new r.XBaseEleStyle(!1)).CopyFrom(super.EleStyle,!1);let l=new A.DateTime;if(w.StringUtils.IsNullOrEmpty(t)&&super.CanEmpty)return n=!0,n;if(!A.DateTime.TryParse(t,super.DisplayFormat.Format,l))return this.CheckError_Type=i.CheckErrorType.DateFormat,n=!1,n;let s=y.TextDocInnerUtil.FormatDateTimeToString(t,super.DisplayFormat.Format);return this.UpdateInnerText(s,null),n=!0,n}UpdateEleFailColor_Recursion(e,t,n,r,i=!0){for(;e.MoveNext();){let l=e.Current;if(null==r||!r.IsSpecialEle(l,!1,!1,!1,!1)){let e=l;if(null!=e&&e instanceof c.XBaseContainer){let r=e.GetChildIter();e=e instanceof c.XBaseInputEle?e:null,this.UpdateEleFailColor_Recursion(r,t,n,e,i)}null!=t&&(this._isError||l.EleStyle.isDefaultBackgroundColor)&&(l.EleStyle.BackgroundColor=t,l.EleStyle.isDefaultBackgroundColor=!0),null!=n&&(this._isError||l.EleStyle.isDefaultForeColor)&&(l.EleStyle.ForeColor=n,l.EleStyle.isDefaultForeColor=i);const r=v.TextDocInitInfo.GetInstance().InputFiled_IsDoctorEditorMode;if(!this._isError&&r){const e=l.EleStyle.EditForeColor;null==e||e.IsEmpty()||(l.EleStyle.ForeColor=l.EleStyle.EditForeColor)}}}}UpdateXInputValue(e,t=null,n=!1,r){if(null!=e){if(!n&&e==super.InnerValue)return;l.XInputUtil.MacroEle_IsDateOut(this)&&(e=y.TextDocInnerUtil.FormatDateTimeToString(e,super.DisplayFormat.Format));let i=!1;if(null!=this._docEditor){const e=this._docEditor.M_EleEvtModel.WorkMode,t=e==k.ENumWorkMode.App||e==k.ENumWorkMode.Form,n=this._docEditor.M_EdtCustomEvtGrp.AppKeepTrace;t&&n&&(i=!0)}null==r||r||(i=!1),this.UpdateInput_InnerValue(i,e,!i,t),this.TextChanged()}}UpdateText_InsertEles(e,t){if(null!=e&&0!=e.Count()){this.AddChildrenEle(super.GetInsertIdx(),e.ToArray());let n=new E.EleRangeAddDelUndo(e.ToArray(),super.GetChildInx(e.Get(0)),!0);if(null!=this._undoGroup&&this._undoGroup.AddItem(n),null!=this._docEditor){const n=this._docEditor.M_EleEvtModel,r=n.WorkMode,i=n.AddEdtHistAct,l=t&&(r==k.ENumWorkMode.App||r==k.ENumWorkMode.Form),s=this._docEditor.M_EdtCustomEvtGrp.AppKeepTrace;l&&s&&i.Execute3(k.ENumEdtType.Add,this._undoGroup,e.ToArray())}}}UpdateText_RemoveEle(e,t){let n=this.I_RemoveChildAll(null,!0,t,!1);if(e){let e=new C.List;for(let t of n)t instanceof c.XBaseContainer?e.AddRange(t.GetChildArr()):e.Add(t);if(null!=this._docEditor){const e=this._docEditor.M_EleEvtModel.AddEdtHistAct.Execute3(k.ENumEdtType.Delete,this._undoGroup,n.ToArray());t&&e.ReturnParams>-1?this.isHaveTraceDeleteSerno=e.ReturnParams:this.isHaveTraceDeleteSerno=-1}}}I_RemoveChildAll(e,t,n,r){let i,s=this.BulidRemoveEleList(t,e,r,!0),o=s[0];if(e=s[1],0!=o.Count()&&n){let t=new E.EleRangeAddDelUndo(o.ToArray(),e.GetChildInx(o.Get(0)),!1);this._undoGroup.AddItem(t),l.XInputUtil.GetInstance().RemoveChilds(e,o)}return i=o,i}BulidRemoveEleList(e,t,n=!1,r=!0){let i=super.GetChildList(e,t,r),l=i[0];t=i[1];let s=new C.List;for(let e of l){this.RemoveValidate(e,n)&&s.Add(e)}return[s,t]}RemoveValidate(e,t){let n;if(t)return n=!0,n;let r=!0;if(e instanceof c.XBaseContainer){let t=e.GetChildArr();for(let e=0;e<t.length;e++){let n=t[e];n instanceof c.XBaseContainer?r=this.RemoveValidate(n,!0):n.EleStyle.DeleterIndex>=0&&this.RemoveEle_NoWithTrace(n.Parent)}}return n=r,n}RemoveEle_NoWithTrace(e){let t=e.GetChildArr(),n=new C.List,r=t;for(let e=0;e<r.length;e++){let t=r[e];t.EleStyle.DeleterIndex<0&&t.EleStyle.CreatorIndex<0&&n.Add(t)}if(n.Count()>0){e.NotifyLayoutChanged(!0,!1);for(let t of n)e.RemoveChildWithEle(t)}}GetInputTypeName(){let e;switch(super.Attr_TypeCode){case"5002":e="text";break;case"7002":e="sigleSelect";break;case"7003":e="moreSelect";break;case"6002":e="date";break;case"6001":e="number";break;case"7001":e="havNo";break;case"3001":e="sign";break;case"4001":case"4002":case"4003":case"4004":case"4005":case"4006":case"4007":case"4008":e="diagnosis"}return e}GetInputTypeNum(){let e;switch(super.Attr_TypeCode){case"5002":return e=1,e;case"7002":return e=2,e;case"7003":return e=3,e;case"6002":return e=4,e;case"6001":return e=5,e;case"4008":return e=8,e;case"7001":return e=10,e}return e=g.EleTypeEnum.NormalEle,e}GetEleType(){let e;switch(super.Attr_TypeCode){case"7002":return super.DataSrc.EditStyle="DropdownList",e=g.EleTypeEnum.SingleChoiceDropEle,e;case"7003":return super.DataSrc.EditStyle="DropdownList",e=g.EleTypeEnum.MoreChoiceDropEle,e;case"7001":return super.DataSrc.EditStyle="DropdownList",e=g.EleTypeEnum.HaveNoEle,e;case"5002":return super.DataSrc.EditStyle="Text",e=g.EleTypeEnum.TextEle,e;case"6001":return super.DataSrc.EditStyle="Numeric",e=g.EleTypeEnum.NumEle,e;case"6002":return super.DataSrc.EditStyle="DateTime",e=g.EleTypeEnum.DateEle,e;case"8001":return e=g.EleTypeEnum.SingleChoiceGroupEle,e;case"8002":return e=g.EleTypeEnum.MoreChoiceGroupEle,e;case"3001":return e=g.EleTypeEnum.SignEle,e;case"7004":return e=g.EleTypeEnum.SqlEle,e;case"4001":case"4002":case"4003":case"4004":case"4005":case"4006":case"4007":case"4008":return e=g.EleTypeEnum.DiagnosisEle,e;case"1101":return e=g.EleTypeEnum.PhaseEle,e;case"1001":return e=g.EleTypeEnum.MacroEle,e;case"1002":return e=g.EleTypeEnum.PrescriptionEle,e;case"9001":return e=g.EleTypeEnum.GroupEle,e;case"9002":return e=g.EleTypeEnum.BusinessStructEle,e;case"9003":return e=g.EleTypeEnum.RefEle,e;case"1003":return e=g.EleTypeEnum.QrCodeEle,e}return e=g.EleTypeEnum.NormalEle,e}FromXML(e){super.FromXML(e),this.InputType=this.GetEleType(),this.InputType==g.EleTypeEnum.NumEle?super.ValidateStyle.ValueType=i.XValueTypeStyle.Numeric:this.InputType==g.EleTypeEnum.DiagnosisEle&&(this.UserEditable=!1,this.IsAllowKeyInput=null);let t=_.XmlDomUtil.GetSingleNode(e,"FieldSettings");if(null!=t&&(null==this._dataSrc&&(this._dataSrc=new a.XDataSource),this._dataSrc.FromXML(t),w.StringUtils.IsNullOrEmpty(this._dataSrc.ListValueSeparatorChar)&&(this._dataSrc.ListValueSeparatorChar="、")),t=_.XmlDomUtil.GetSingleNode(e,"ValueBinding"),null!=t&&(null==super.ValueBinding&&(super.ValueBinding=new u.XDataBinding),super.ValueBinding.FromXML(t)),t=_.XmlDomUtil.GetSingleNode(e,"ValidateStyle"),null!=t&&(null==super.ValidateStyle&&(super.ValidateStyle=new h.XValueValidateStyle),super.ValidateStyle.FromXML(t)),t=_.XmlDomUtil.GetSingleNode(e,"DisplayFormat"),null!=t&&(null==super.DisplayFormat&&(super.DisplayFormat=new d.XValueFormater),super.DisplayFormat.FromXML(t)),this.InputType==g.EleTypeEnum.DateEle&&this.Document.GetDocCtxt().EmrWorkMode!=k.ENumWorkMode.Design&&v.TextDocInitInfo.GetInstance().DefaultCurrentTimeFlag&&this.DefaultCurrentTimeFlag&&!this.InnerValue){let e,t=A.DateTime.CurentTimeString,n=t.split(" ")[0],r=t.split(" ")[1],i=n.split("-")[0],l=n.split("-")[1],s=n.split("-")[2],o=r.split(":")[0],a=r.split(":")[1],u=r.split(":")[2],h=this.DisplayFormat.Format;"yyyy年"==h?e=i+"年":"yyyy年MM月"==h?e=`${i}年${l}月`:"yyyy年MM月dd日"==h?e=`${i}年${l}月${s}日`:"yyyy-MM-dd"==h?e=`${i}-${l}-${s}`:"yyyy年MM月dd日HH时"==h?e=`${i}年${l}月${s}日${o}时`:"yyyy年MM月dd日HH时mm分"==h?e=`${i}年${l}月${s}日${o}时${a}分`:"yyyy-MM-dd HH:mm"==h?e=`${i}-${l}-${s} ${o}:${a}`:"yyyy年MM月dd日HH:mm"==h?e=`${i}年${l}月${s}日${o}:${a}`:"yyyy年MM月dd日HH时mm分ss秒"==h?e=`${i}年${l}月${s}日${o}时${a}分${u}秒`:"yyyy-MM-dd HH:mm:ss"==h?e=`${i}-${l}-${s} ${o}:${a}:${u}`:"HH时mm分"==h?e=`${o}时${a}分`:"HH:mm"==h?e=`${o}:${a}`:"HH:mm:ss"==h&&(e=`${o}:${a}:${u}`),this.UpdateInnerText(e,null)}super.InsertLabelText(),this.InputType==g.EleTypeEnum.NumEle?(super.InsertSuffixText(),super.InsertUnitLabelText()):super.ToggleUnitToLabel(),this._initValue=super.GetXInputText(!1,!1,!0,!1,!1,!1,!1),this._initValue||(this.EleStyle.isDefaultForeColor=!0,this.EleStyle.isDefaultBackgroundColor=!0),this._initModfied=super.IsModified,w.StringUtils.IsNullOrEmpty(super.EditorActiveMode)?super.EditorActiveMode=P.TextDocApiConst.InputFormActMode:super.EditorActiveMode=super.EditorActiveMode.replace(" ",",");let n=this.Document;if(null!=n){n.AssistFunc.XDocXInputCache.TryCacheXInput(this)}let r=e instanceof Element?e:null;if(null!=r){let e=r.getElementsByTagName("LabelText");e.length>0&&super.Add_DocEleStyle(e[0]instanceof Element?e[0]:null,this._labelTextEle),e=r.getElementsByTagName("UnitText"),e.length>0&&super.Add_DocEleStyle(e[0]instanceof Element?e[0]:null,this._unitTextEle),e=r.getElementsByTagName("SuffixText"),e.length>0&&super.Add_DocEleStyle(e[0]instanceof Element?e[0]:null,this._suffixTextEle),e=r.getElementsByTagName("StartBorderText"),e.length>0&&super.Add_DocEleStyle(e[0]instanceof Element?e[0]:null,super.StartEle),e=r.getElementsByTagName("EndBorderText"),e.length>0&&super.Add_DocEleStyle(e[0]instanceof Element?e[0]:null,super.EndEle),super.M_SetBorderPrintInLine()}if(this.MinSpaceNumber>0){let e=0,t=this._initValue;for(let n=0;n<t.length;n++){let r=t[n];this.IsChineseChar(r)?e+=2:e++}if(e<this.MinSpaceNumber){let t=new C.List,n=new c.XStringEle,r=super.EleStyle;for(let n=0;n<this.MinSpaceNumber-e;n++){let e=c.XElementFactory.CreatXElement("XCharacter",null);null!=e&&(e.ChVal=" ",e.EleStyle.CopyFrom(r,!1),t.Add(e))}n.AddChildrenEle(0,t.ToArray());let i=this.GetChildInx(this.GetBorderEle(!1));this.ExistSuffixText()&&i--,this.ExistUnitLabelEle()&&this.InputType==g.EleTypeEnum.NumEle&&i--,this.AddChildEle(i,n)}}super.DynamicShowHideBackEle(),v.TextDocInitInfo.GetInstance().ValidateOpenFile&&this.StartValueValidate(!0,super.EleStyle),super.CorrectChildStyle()}IsChineseChar(e){return!!/[\u4e00-\u9fa5]/.test(e)}ToXML(e){return this.InputType==g.EleTypeEnum.DiagnosisEle&&(this.UserEditable=!1,this.IsAllowKeyInput=null),super.ToXML(e)}Pop_TextChangedMsg(){if(null!=this._docEditor){const e=this._docEditor;setTimeout(()=>{let t=e.GetAlertFormStartRect(i.PositionEnum.LeftBottom,0,0,"focused").Location,n=e.M_EleEvtModel.EleClickedWrap,r=new F.CallBackEvent,l=e.MGetZoomRatio();const s=M.ClickedElementWrapper.GetEleRectInCtrl(n.EleFocused,e.M_PageFocused,l);let o=new B.PointF(s.Left,s.Bottom);r.bodyLocation=t,r.editorLocation=o,r.EleId=this.XID,r.CptID=this.CptID,r.DocId=this.Document.DocID,r.EventName=N.EventUtils.TextChange,r.Value=this.InnerValue,r.DateTimeValue=this.DateTimeValue,r.InnerText=this.PreSetvalueText,e.M_EdtCustomEvtGrp.InputChange&&e.M_EdtCustomEvtGrp.InputChange(r)})}this._docEditor&&this._docEditor.ValidateDialog&&this._docEditor.M_ActionHandler.L_ExecuteCommand("ValidateDoc",[])}BulidQrCode(e,t,n){let r;if("1003"!=super.Attr_TypeCode)r=null;else if(n){let e=super.SqlText;null!=t&&t.size>0&&t.forEach((t,n)=>{e=e.replace(n,t)}),this.RemoveChildAll(!0,!1,null,!0);let n="";if(w.StringUtils.IsNullOrEmpty(n))r=null;else{let e=new f.BarcodeInfo;if(e.Content=n,e.CodeStyleStr=this.CodeRule,e.CodeChoiceStyle=this.IsQrCode?f.CodeType.QRcode:f.CodeType.Barcode,e.IsShowLabelText=this.QrCode_IsShowLabelText,e.LabelText=this.QrCode_LabelText,e.LabelShowPosition=this.QrCode_LabelTextPosition,e.IsAllowDrag=this.QrCode_IsAllowDrag,this.IsQrCode)e.GetEditBarcodeImage=p.XCodeUtil.GetInstance().BuildQRcode(n);else{let t=w.StringUtils.IsNullOrEmpty(this.CodeRule)?b.TextDocInitInfoExt.GetInstance().DftBarCodeRule:this.CodeRule,r=p.XCodeUtil.GetInstance().GetBarCodeTypeByStr(t),i=p.XCodeUtil.GetInstance().BuildBarcode(r,n,7,74,I.Color.Black,I.Color.Black);if(i.IsException)return this._docEditor.HideMsgBox||R.MessageBoxComp.Show({title:"提示",content:"条码数据格式有误！",type:"warning",dom:this._docEditor.ContainerDOM}),null;e.GetEditBarcodeImage=i.Image}let t=new c.XCodeEle;t.InitCodeEle(e),this.AddChildEle(super.GetInsertIdx(),t),super.DynamicShowHideBackEle(),r=t}}else r=null;return r}get SelModel(){return this._SelModel}set SelModel(e){this._SelModel=e}ReBulidInputField(e="",t=null,n=!0){super.InsertBorderEle(null,null),super.M_SetBorderPrintInLine(),super.InsertLabelText();let r=!1;this._spaceCountChanged&&(r=this.Init_AddEmptySpaceEle(),this._spaceCountChanged=!1),r||super.InnerValue!=e&&n&&this.InputType!=g.EleTypeEnum.PrescriptionEle&&this.InputType!=g.EleTypeEnum.MacroEle&&this.InputType!=g.EleTypeEnum.SignEle&&this.InputType!=g.EleTypeEnum.DiagnosisEle&&this.InputType!=g.EleTypeEnum.PhaseEle&&this.UpdateInnerText(e,t),super.DynamicShowHideBackEle(),super.InsertSuffixText(),super.InsertUnitLabelText(),this.InputType=this.GetEleType(),super.M_SetBorderEleEmptyIsShow()}Init_AddEmptySpaceEle(){let e=!1;if(super.MinSpaceNumber>0){this.RemoveChildAll(!0,!1,null,!0);let t=new r.XBaseEleStyle(!1),n=super.CreateSpaceEles(super.MinSpaceNumber,super.EleStyle,t);if(null!=n&&n.length>0){e=!0;let t=super.GetInsertIdx(),r=c.XElementFactory.CreatXElement("XString",null);null!=r&&r.AddChildrenEle(0,n),this.AddChildEle(t,r)}}return e}UpdateEleInfo(e){let t=this;switch(t.EleToolTip=e.Text_tip,t.InputType){case g.EleTypeEnum.NormalEle:case g.EleTypeEnum.SignEle:case g.EleTypeEnum.PrescriptionEle:x.XInputFactory.GetInstance().GetCommonEle(e,t);break;case g.EleTypeEnum.SingleChoiceDropEle:case g.EleTypeEnum.MoreChoiceDropEle:case g.EleTypeEnum.HaveNoEle:x.XInputFactory.GetInstance().GetSelect(e,t);break;case g.EleTypeEnum.NumEle:x.XInputFactory.GetInstance().GetNumber(e,t);break;case g.EleTypeEnum.DateEle:x.XInputFactory.GetInstance().GetDatetime(e,t);break;case g.EleTypeEnum.TextEle:x.XInputFactory.GetInstance().GetText(e,t);break;case g.EleTypeEnum.SqlEle:x.XInputFactory.GetInstance().GetSqlInputEle(e,t);break;case g.EleTypeEnum.MacroEle:x.XInputFactory.GetInstance().GetMacroInputEle(e,t);break;case g.EleTypeEnum.BusinessStructEle:x.XInputFactory.GetInstance().GetCommonEle(e,t);break;case g.EleTypeEnum.RefEle:x.XInputFactory.GetInstance().GetRefEle(e,t);break;case g.EleTypeEnum.QrCodeEle:x.XInputFactory.GetInstance().GetBarCodeEle(e,t);break;case g.EleTypeEnum.DiagnosisEle:x.XInputFactory.GetInstance().GetDiagnosisEle(e,t)}t.StartValueValidate(!0,t.EleStyle)}UpdateText_BulidNewEles(e,t){let n;if(null==e)n=null;else{const r=v.TextDocInitInfo.GetInstance();r.InputFiled_IsDoctorEditorMode&&(t.EditForeColor=r.InputFieldEditForeColor);let i=new M.ClickedElementWrapper(!1);i.LineEleIxFocused.SetEle(super.EndEle);let s=new C.List,o=!1;if(this.InputType==g.EleTypeEnum.DiagnosisEle&&e&&(o=this.diagEleBuildElesFromStr(t,s,i)),this.InputType==g.EleTypeEnum.SignEle&&e instanceof c.XImageEle&&(o=!0,s.Add(e)),!o){let n=new C.List,r=L.EditEleRange.BuildElesFromStr(e,t,n,i);l.XInputUtil.IsExistWildChar(e)?s.AddRange(D.XInputEleHelper.AnalysisWildStr(e,t,super.StartEle)):(null!=r&&s.Add(r),s.AddRange(n))}n=s}return n}diagEleBuildElesFromStr(e,t,n){const i=this._DiagnoseValueArr;if(!(i instanceof Array&&i.length>0))return null;let s=new r.XBaseEleStyle(!1);s.CopyFrom(e,!1),s.XFontStyle.IsBold=!0;let o=!1;for(let r=0;r<i.length;r++){const a=i[r];let u=a.title;const h=a.content;let d=new C.List;if(u){t.Count()>0&&(u="\n"+u);const e=L.EditEleRange.BuildElesFromStr(u+"\n",s,d,n);t.Add(e),t.AddRange(d),o=!0}let c=new C.List,p="";const f=this.Arrangement||a.arrangement;if(h instanceof Array&&h.length>0){const e=this.SplitChar||"";let t="";"vertical"==f&&(t="\n"),p=h.join(e+t),p+=e}else h&&(p=h);"horizontal"==f&&(p=p.replace(/\r?\n|\r/g,""));const g=L.EditEleRange.BuildElesFromStr(p,e,c,n);l.XInputUtil.IsExistWildChar(p)?(t.AddRange(D.XInputEleHelper.AnalysisWildStr(p,e,super.StartEle)),o=!0):(null!=g&&t.Add(g),t.AddRange(c),o=!0)}return o}set DiagnoseValueArr(e){this._DiagnoseValueArr=e}getDatasCode(){let e=null;if(null!=this.DataSrc&&null!=this.DataSrc.DataList&&this.SelectIndex){const t=this.SelectIndex.split(",");for(let n=0;n<t.length;n++){let r=Number(t[n]);if(r>0){r-=1;const t=this.DataSrc.DataList.Get(r),i=this.InnerValue&&-1!=this.InnerValue.indexOf(t.Value);(t.Value==this.InnerValue||i)&&(n>0?e+=",":e="",e+=t.Key)}}}return e}}t.XInputEle=O},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgRegisterHandler=void 0;const r=n(2),i=n(44),l=n(0),s=n(711),o=n(3),a=n(4),u=n(60);class h{static ReMatch_SetSizeExpression(e,t){let n;if(a.default.IsNullOrEmpty(e))n=null;else{let t="Follow\\(([\"|']"+h.regId+"+[\"|'])\\)";n=h.RgBulidIdList(e,t,!1,"")}return n}static ReMatch_SetEleStyleExpression(e,t){let n;if(a.default.IsNullOrEmpty(e))n=null;else{let r=["Compare\\(GetValue\\(([\"|']"+h.regId+"+[\"|'])\\),([\"|']"+h.regId+"*[\"|'])\\)","IsCheck\\(([\"|']"+h.regId+"+[\"|'])\\)"],i=new o.List;for(let n=0;n<r.length;n++){let l=r[n];i.AddRange(h.RgBulidIdList(e,l,!0,t))}n=i}return n}static ReMatch_CheckExpression(e,t){let n;if(a.default.IsNullOrEmpty(e))n=null;else{let t="IsCheck\\(([\"|']"+h.regId+"+[\"|'])\\)";n=h.RgBulidIdList(e,t,!1,"")}return n}static ReMatch_VisibleExpression(e,t){if(a.default.IsNullOrEmpty(e))return null;let n=["Compare\\(GetValue\\(([\"|']"+h.regId+"+[\"|'])\\),([\"|']"+h.regId+"*[\"|'])\\)","Compare\\(GetValueCode\\(([\"|']"+h.regId+"+[\"|'])\\),([\"|']"+h.regId+"*[\"|'])\\)","CompareAge\\(GetValue\\(([\"|']"+h.regId+"+[\"|'])\\),([\"|']"+h.regId+"+[\"|']),([\"|']"+h.regId+"+[\"|'])\\)","CompareAge\\(GetValueCode\\(([\"|']"+h.regId+"+[\"|'])\\),([\"|']"+h.regId+"+[\"|']),([\"|']"+h.regId+"+[\"|'])\\)","IsHide\\(([\"|']"+h.regId+"+[\"|'])\\)","IsCheck\\(([\"|']"+h.regId+"+[\"|'])\\)","CompareExt\\(GetValue\\((.*?)\\),.*\\)","GetTime\\(([\"|']"+h.regId+"+[\"|'])\\)","CompareExt\\(GetAttr\\(([\"|']"+h.regId+"+[\"|']),([\"|']"+h.regId+"+[\"|'])\\),([\"|']"+h.regId+"+[\"|']),([\"|']"+h.regId+"+[\"|'])\\)"],r=new o.List;for(let i=0;i<n.length;i++){let l=n[i];r.AddRange(h.RgBulidIdList(e,l,!0,t))}return r}static ReMatchIds_SetValueExp(e,t){let n=["GetValueInt\\(([\"|']"+h.regId+"+[\"|'])\\)","GetTime\\(([\"|']"+h.regId+"+[\"|'])\\)","GetValue\\(([\"|']"+h.regId+"+[\"|'])\\)","GetValueCode\\(([\"|']"+h.regId+"+[\"|'])\\)","IsCheck\\(([\"|']"+h.regId+"+[\"|'])\\)","IsCheckGrp\\(([\"|']"+h.regId+"+[\"|'])\\)","GetSumGrp\\((.*?)\\)","GetGrpValue\\((.*?)\\)","GetValueExt\\((.*?),.*\\)"],r=new o.List;for(let i=0;i<n.length;i++){let l=n[i],s=h.RgBulidIdList(e,l,!0,t);r.AddRange(s)}return r}static ReMatch_ReceiveIdList(e,t){const n=["SetHide\\((.*?),.*\\)","SetCanEmpty\\((.*?),.*\\)","SetHideExt\\((.*?),.*\\)","SetValue\\((.*?),.*\\)","SetCheck\\((.*?),.*\\)","SetSize\\((.*?),.*\\)","SetEleStyle\\((.*?),.*\\)"];let r=null;for(let i=0;i<n.length;i++){const l=n[i];if(r=h.RgBulidIdList(e,l,!0,t),null!=r&&r.Count()>0)break}return r}static RegisterExpressionToMsgBus(e,t=!1){const n=e.GetDocCtxt().EmrWorkMode==r.ENumWorkMode.Browse||e.GetDocCtxt().EmrWorkMode==r.ENumWorkMode.KeepTrace;if(!t&&n)return null;e.AssistFunc.MsgBus.Clear(),h._scriptEle=u.EmrApiUtil.GetScriptEleList(!0,e);const i=new o.List;for(let t=0;t<h._scriptEle.Count();t++){const n=h._scriptEle.Get(t);if(null!=n.ExpessionArray&&0!=n.ExpessionArray.length){const t=n.ExpessionArray;for(let r=0;r<t.length;r++){const i=t[r];if(!a.default.IsNullOrEmpty(i)){const t=i.split(";");if(0!=t.length){const r=t;for(let t=0;t<r.length;t++){const i=r[t];if(!a.default.IsNullOrEmpty(i)){const t=h.GetScriptExpType(i);h.RegiestExpToMsgBus(t,i,n,e)}}}}}}}return i}static CheckExpValid(e){let t=u.EmrApiUtil.GetScriptEleList(!0,e),n=new o.List;for(let r=0;r<t.Length;r++){let l=t[r],o=l.ExpessionArray;if(null!=o&&0!=o.length){let t=o;for(let r=0;r<t.length;r++){let o=t[r];if(!a.default.IsNullOrEmpty(o)){let t=null,r=h.GetScriptExpType(o);if(null!=r&&("SETVALUE"!=r?"SETHIDE"!=r&&"SETHIDEEXT"!=r&&"SETCANEMPTY"!=r?"SETCHECK"!=r?"SETSIZE"!=r?"SETELESTYLE"==r&&(t=h.ReMatch_SetEleStyleExpression(o,l.Id)):t=h.ReMatch_SetSizeExpression(o,l.Id):t=h.ReMatch_CheckExpression(o,l.Id):t=h.ReMatch_VisibleExpression(o,l.Id):t=h.ReMatchIds_SetValueExp(o,l.Id)),null==t||0==t.Count()){if(!a.default.IsNullOrEmpty(o)){let e="元素 ["+l.ShowName+"] 配置公式无效！",t=new s.EleExpCheckResultInfo("",l.Id,l,e,!1);n.Add(t)}}else{t=h.FormatSenderId(t);for(let r=0;r<t.Length;r++){let o=t[r],a=i.TextDocApiUtil.GetElesByGrpIdOrXId(e,o,null);if(null==a||0==a.Count()){let e,t=new s.EleExpCheckResultInfo(o,l.Id,l,e,!1);n.Add(t)}}}}}}}return n}static RegiestExpToMsgBus(e,t,n,i){let s,o,a=n.Id;const u=n instanceof l.XBaseElement?n:null;if("SETCHECK"==e)a=n.XID,s=h.ReMatch_CheckExpression(t,a),o="SetCheck";else if("SETHIDE"==e||"SETHIDEEXT"==e){s=h.ReMatch_VisibleExpression(t,a),o="SetVisible";let e=1;i.GetDocCtxt().EmrWorkMode==r.ENumWorkMode.Design&&u.Attr_FgHide&&(e=.25),l.XDomUtil.setChildrenXBaseEleForeColorOpacity(u,e,u.Attr_FgHide),l.XDomUtil.DyncHideParaFlg(u.Attr_FgHide,u)}else"SETCANEMPTY"==e?(s=h.ReMatch_VisibleExpression(t,a),o="SetVisible"):"SETVALUE"==e?(s=h.ReMatchIds_SetValueExp(t,a),s=h.FormatSenderId(s),o="SetValue"):"SETSIZE"==e?(s=h.ReMatch_SetSizeExpression(t,a),o="SetSize"):"SETELESTYLE"==e&&(s=h.ReMatch_SetEleStyleExpression(t,a),o="SetEleStyle");if(null!=e&&null!=s&&s.Count()>0){const e=h.ReMatch_ReceiveIdList(t,a);h.AddExpToMsgBus(s,u,i,t,o,e)}}static AddExpToMsgBus(e,t,n,r,i,l){const s=n.AssistFunc.MsgBus;for(let n=0;n<e.Count();n++){const o=e.Get(n);for(let e=0;e<l.Count();e++){const n=l.Get(e);s.AddMsgItem(o,i,r,n,h.GetScriptEleById(n),t)}}}static GetScriptEleById(e){let t;return null==h._scriptEle?t=null:(t=h._scriptEle.Find(t=>t.Id==e),t=t instanceof l.XBaseElement?t:null),t}static GetScriptExpType(e){let t;if(a.default.IsNullOrEmpty(e))t="";else if(e=e.replace("\r\n",""),a.default.IsNullOrEmpty(e))t="";else{let n=e.indexOf("(");if(-1==n)t="";else{let r=e.substring(0,n);a.default.IsNullOrEmpty(r)?t="":(r=r.toUpperCase(),t=r)}}return t}static FormatSenderId(e){let t=new o.List;for(let n=0;n<e.Count();n++){let r=e.Get(n).split(",");t.AddRange(r)}return t}static RgBulidIdList(e,t,n=!1,r=""){let i=e.replace(/(^\s+)|(\s+$)|\s+/g,()=>""),l=new o.List;const s=new RegExp(t,"g"),u=i.match(s);if(null==u)return l;for(let e=0;e<u.length;e++){const t=u[e];if(null!=t){let e=t;if(!a.default.IsNullOrEmpty(e)){let t=e.search(/[/"|/']/);if(-1!=t)e=e.substring(t+1),t=e.search(/[/"|/']/),e=e.substring(0,t);else{const n=e.split(",");e=n[0],t=e.search(/[/(]/),-1!=t&&(e=e.substring(t+1))}"Id"!=e&&"XId"!=e||!n?l.Add(e):l.Add(r)}}}return l}static updateAllExpressStr(e,t,n){if(null!=n&&null!=e&&e instanceof Array&&e.length>0&&null!=t&&t instanceof Array&&t.length>0)for(let r=0;r<n.Count();r++){let i=n.Get(r);if("IScriptMsg"==i.GetType()){const n=i.ExpessionArray;if(null!=n&&n instanceof Array&&n.length>0){let r=[],l=!1;for(let i=0;i<n.length;i++){let s=n[i];if(null!=s){let n=s;for(let r=0;r<e.length;r++){const i=e[r];if(!a.default.IsNullOrEmpty(i)&&-1!=n.indexOf(i)){const e=new RegExp(i,"g");n=n.replace(e,()=>t[r])}}r[i]=n,l=!0}}l&&(i.ExpessionArray=r)}}if(i.ChildCount&&i.ChildCount>0){const n=i.ChildEleList;this.updateAllExpressStr(e,t,n)}}}static changeAllChildrenNewIdAndXId(e,t=!1){let n=[],r=[];if(null!=e)for(let i=0;i<e.Count();i++){const l=e.Get(i);let s=l.GrpID,o=l.XID;const u=l.XIDFromCopy,h=null!=u?u.split(","):null;let d=null!=h?h[1]:"",c=null!=h?h[0]:"";const p=d==s,f=c==o;if(t||a.default.IsNullOrEmpty(d)){const e=l._BuildGrpID(null);d=s,s=e}if(t||a.default.IsNullOrEmpty(c)){const e=l._BuildNewXID();c=o,o=e}const g=n.indexOf(d);-1!=g&&r[g]?s=r[g]:(d==s&&(s=l._BuildGrpID(null)),n.push(d),r.push(s));const m=n.indexOf(c);if(-1!=m&&r[m]?o=r[m]:(c==o&&(o=l._BuildNewXID()),n.push(c),r.push(o)),t?(l.GrpID=s,l.XID=o):(p&&(l.GrpID=s),f&&(l.XID=o)),l.XIDFromCopy=null,l.ChildCount&&l.ChildCount>0){const e=l.ChildEleList,i=this.changeAllChildrenNewIdAndXId(e,t);n=[...n,...i[0]],r=[...r,...i[1]]}}return[n,r]}}t.MsgRegisterHandler=h,h.regId="[^,\"']",h._scriptEle=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringAlignment=void 0,function(e){e[e.Near=0]="Near",e[e.Center=1]="Center",e[e.Far=2]="Far"}(t.StringAlignment||(t.StringAlignment={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkPoint=void 0,function(e){e[e.LeftTop=0]="LeftTop",e[e.LeftCenter=1]="LeftCenter",e[e.LeftBottom=2]="LeftBottom",e[e.TopCenter=3]="TopCenter",e[e.BottomCenter=4]="BottomCenter",e[e.RightTop=5]="RightTop",e[e.RightCenter=6]="RightCenter",e[e.RightBottom=7]="RightBottom",e[e.None=8]="None"}(t.MarkPoint||(t.MarkPoint={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageBoxComp=t.MessageBox=void 0;const r=n(12),i=n(139),l=n(24);n(637);const s={type:"warning",title:"标题",content:"内容",showFooter:!0,showOk:!0,showCancel:!1,okText:"确定",cancelText:"取消",visible:!0,style:{},width:420,height:192,zIndex:1e4,level:1,onOk:()=>{}};class o extends r.Component{constructor(e){super(e),this.okHandler=()=>{this.props.onOk(),this.setVisible(!1)},this.cancelHandler=()=>{this.setVisible(!1)},this.state={visible:!1,fadeInOut:!0,isRender:!0}}componentDidMount(){this.setVisible(this.props.visible),1==this.props.level&&setTimeout(()=>{this.setVisible(!1)},2e3)}componentDidUpdate(e,t,n){e.visible!=this.props.visible&&this.setVisible(this.props.visible)}renderFooter(){return this.props.showFooter?r.createElement("div",{className:"pango-editor-dialog-footer"},this.props.showCancel?r.createElement(i.Button,{text:this.props.cancelText,type:"default",width:88,height:32,onClick:this.cancelHandler}):null,this.props.showOk?r.createElement(i.Button,{text:this.props.okText,type:"primary",width:88,height:32,onClick:this.okHandler}):null):null}setVisible(e){e?(this.setState({visible:!0}),setTimeout(()=>{this.setState({fadeInOut:!1})})):(this.setState({fadeInOut:!0}),setTimeout(()=>{this.setState({visible:!1,fadeInOut:!1,isRender:!1})},300))}renderLevel0(){let{type:e,style:t,width:n,height:i,title:s,content:o,zIndex:a}=this.props,{visible:u,fadeInOut:h,isRender:d}=this.state,c=n+"px",p=i+"px",f=Object.assign({width:c,height:p},t);return d?l.createPortal(r.createElement("div",{className:"pango-editor-msg-dialog-mask"+(h?" msg-dialog_fadeInOut":""),style:{zIndex:a,display:u?"flex":"none"}},r.createElement("div",{className:"pango-editor-msg-dialog-wrap pango-editor-msg-dialog-"+e,style:f},r.createElement("div",{className:"pango-editor-msg-dialog_info"},r.createElement("i",{className:"pango-editor-icon emr-icon-"+e}),r.createElement("div",{className:"info"},r.createElement("span",{className:"pango-editor-msg-dialog-title"},s),r.createElement("p",{className:"pango-editor-msg-dialog-text"},o))),this.renderFooter())),document.getElementsByTagName("body").item(0)):null}renderLevel1(){let{type:e,style:t,content:n,zIndex:i,dom:s}=this.props,o=s||document.getElementsByTagName("body").item(0),{visible:a,fadeInOut:u,isRender:h}=this.state,d=Object.assign({width:"640px",height:"40px",zIndex:i,display:a?"block":"none"},t);return h?l.createPortal(r.createElement("div",{className:"pango-editor-msg-dialog-wrap level1 pango-editor-msg-dialog-"+e,style:d},r.createElement("div",{className:"pango-editor-msg-dialog_info"},r.createElement("i",{className:"pango-editor-icon emr-icon-"+e}),r.createElement("div",{className:"info"},r.createElement("p",{className:"pango-editor-msg-dialog-text"},n)))),o):null}destory(){this.setState({visible:!1,fadeInOut:!1,isRender:!1})}render(){return 0==this.props.level?this.renderLevel0():this.renderLevel1()}}t.MessageBox=o,o.defaultProps=s;t.MessageBoxComp=class{static Show(e){let t=Object.assign(Object.assign({},s),Object.assign({},e));this.instance&&this.instance.destory(),this.instance=l.render(r.createElement(o,Object.assign({},t)),document.createDocumentFragment())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Expression=void 0;const r=n(4),i=n(119),l=n(39);t.Expression=class{constructor(e){null!=e&&e instanceof i.Token?this._token=e:this._token=new i.Token(null,i.TKID.ATOM,i.TKTYPE.IDENTIFIER)}Evaluate(){if(this._token.Type!=i.TKTYPE.LITERAL)throw new Error("无效的表达式！");return this._token.Value}Optimize(){return this}static string(e){const t=e.Evaluate();return null==t?r.default.Empty:t.toString()}static double(e){const t=e.Evaluate();if(null==t)return 0;if(t instanceof Number){return t}if(t instanceof Boolean)return t?1:0;if(t instanceof l.DateTime){return t.Ticks()}}static bool(e){const t=e.Evaluate();if(t instanceof Boolean){return t}if(t instanceof String){const e=t;return"Y"==e||"y"==e||"true"==t}return null!=t&&(t instanceof Number?0!=t:0!=Number(e))}static DateTime(e){const t=e.Evaluate();return t instanceof l.DateTime?t:t instanceof Number?l.DateTime.Now:void 0}CompareTo(e){return 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditorWorkModeUtil=void 0;const r=n(239),i=n(44),l=n(2),s=n(0),o=n(4),a=n(32),u=n(20);class h{static CanSwitch(e,t,n){let r;if(e==t)r=!1;else{if(t==l.ENumWorkMode.KeepTrace&&(null==n||!n.IsValid()))return alert('"当前登陆用户信息无效，无法切换到修订模式"'),r=!1,r;r=!0}return r}static ChkAddRuleForWorkMode(e,t,n=!1){let r;if(t==l.ENumWorkMode.Browse)r=!1;else if(t==l.ENumWorkMode.KeepTrace)r=!1;else if(s.XDomUtil.IsOwnXDocPanelEditable(e)){let o=i.TextDocApiUtil.ChkInputEleCanOperator(t,e);if(null==o||o)if(t==l.ENumWorkMode.Design)r=!0;else{if(e instanceof a.XTextLabelElement&&e.FixPosition)return!1;{let i=s.XDomUtil.GetParentXInput(e,!0);if(null==i)r=t==l.ENumWorkMode.App,r&&(r=this.checkEditableInTable(e));else{const e=t==l.ENumWorkMode.App||t==l.ENumWorkMode.Form,s=i.UserEditable&&(n||i.IsAllowKeyInput);r=e&&s}}}else r=!1}else r=!1;return r}static ChkDelRuleForWorkMode(e,t,n){let r;if(t==l.ENumWorkMode.Browse)return!1;if(!s.XDomUtil.IsOwnXDocPanelEditable(e))return!1;let o=i.TextDocApiUtil.ChkInputEleCanOperator(t,e);if(null!=o&&!o)return!1;if(t==l.ENumWorkMode.Design)return!0;if(t==l.ENumWorkMode.App&&null!=e&&e instanceof s.XTextTableCell){r=!0;let t=e.Parent;for(;null!=t&&r;)t instanceof s.XTextTable&&!t.IsDeleteTable?r=!1:t=t.Parent;if(!r)return!1}return r=h._ChkDelRule_OneEle_AppMode(e,t,!0,n),r}static ChkDelRuleForWorkMode2(e,t,n){let r,i=null==e?0:e.length;if(i<=0)r="待删除元素列表为空";else if(t==l.ENumWorkMode.Browse||t==l.ENumWorkMode.KeepTrace)r="浏览模式与痕迹模式，不能删除任何内容";else if(s.XDomUtil.IsOwnXDocPanelEditable(e[0]))if(t==l.ENumWorkMode.Design)r=null;else{let l=null;for(let r=0;r<i;r++)if(!h._ChkDelRule_OneEle_AppMode(e[r],t,!1,n)){let n=e[r].GetInnerText(!0);o.default.IsNullOrEmpty(n)&&(n=e[r].GrpID),l="当前工作模式["+t+"]下, 不能删除元素 "+n;break}r=l}else r="待删除元素所在文档区域不可编辑";return r}static _ChkDelRule_OneEle_AppMode(e,t,n,i){let o=t==l.ENumWorkMode.KeepTrace;if(e instanceof a.XTextLabelElement&&!e.IsDeleteFlag||e instanceof s.XBaseChoiceEle&&!e.Deletable)return!1;let u=s.XDomUtil.GetNextEle(!0,e);if(e instanceof s.XParagraphFlag&&u instanceof a.XTextLabelElement&&u.FixPosition)return!1;if((e instanceof s.XImageEle||e instanceof s.XButtonEle)&&!e.Deletable)return!1;let h,d=s.XDomUtil.GetParentXInput(e,!1);if(null==d)h=t==l.ENumWorkMode.App,h&&(h=this.checkEditableInTable(e));else{if(o){if(n){let t=null,n=s.XDomUtil.GetUserHistoryWrap(e);if(null!=n&&(t=null==n.AddHist?null:n.AddHist.UserInfo,n.Clear()),!r.A_AddEdtHistory.CanDelWithHist(i))return h=!1,h}if(s.XDomUtil.FullDelTrace(e))return h=!1,h}if(null!=(e instanceof s.XInputBorderEle?e:null)){h=null!=s.XDomUtil.GetParentXInput(d,!1)&&d.Deletable}else h=d.UserEditable}return h}static checkEditableInTable(e){if("XTextTableCell"==e.EleTypeName)return!0;if("XTextTable"==e.EleTypeName)return!0;const t=u.XTextTableUtil.GetCursorTextTable(e);if(null!=t)return!!t.UserEditable;const n=u.XTextTableUtil.GetCursorCell(e);return null==n||!!n.UserEditable}}t.EditorWorkModeUtil=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrInnerUtil=void 0;const r=n(352),i=n(26),l=n(232),s=n(339),o=n(6),a=n(172),u=n(16),h=n(767),d=n(10),c=n(3),p=n(39),f=n(4);class g{static get RenderHeight(){let e;return e=l.RelativeUIParam.ScreenSize==s.ScreenSize.Large?g.LargeScreenRenderHeight:g.SmallScreenRenderHeight,e}static get DrawFont(){let e;return e=l.RelativeUIParam.ScreenSize==s.ScreenSize.Large?g.LargeScreenFontFont:g.SmallScreenFont,e}static GetWorkMode(e){let t;if(f.default.IsNullOrEmpty(e))t=r.ActionWorkMode.None;else{let n=e.split("|");if(0==n.length)t=r.ActionWorkMode.None;else{let e=r.ActionWorkMode.None,i=n;for(let t=0;t<i.length;t++){let n,r;i[t];r&&(e|=n)}t=e}}return t}static ZoomImage(e,t,n){let r;try{let r,i,l=e.Width,s=e.Height;s>t||l>n?l*t>s*n?(r=n,i=n*s/l):(i=t,r=l*t/s):(r=l,i=s)}catch(t){r=e}return r}static OpenSelectFileDialog(e){let t;if(f.default.IsNullOrEmpty(e)){f.default.IsNullOrEmpty(e)}else t="";return t}static GetDirectAllFileNames(e,t){}static GetDirectFileNames(e,t){}static ReadFile(e){return null}static WriteFile(e,t){}static WriteFile2(e,t,n){}static CombineTxtFile(e,t,n){}static UpdateXDocXinputCache(e){if(null!=e){let t=e.Document;if(null!=t){let n=t.AssistFunc.XDocXInputCache;u.XDomUtil.IsEleRemoved(e,!1)?n.RemoveItem(e.Attr_TypeCode,e.XID):n.TryCacheXInput(e),g.ResetBodyXInputCache(t)}}}static ResetBodyXInputCache(e,t){let n=e.AssistFunc.XDocXInputCache.BodyXInputCache,r=e.AssistFunc.XDocXInputCache.BodyAllXInputCache,l=e.AssistFunc.XDocXInputCache.BodyParTakeQuoteXInputCache,s=new c.List;e.GetPagePanel(o.ENumPagePanelTp.Body).GetChildrenByType("XInputField",!0,s,!0),n.Clear(),l.Clear(),r.Clear(),s.ToArray().forEach(e=>{let s=e;i.TextDocInitInfo.GetInstance().IsStartUpAllKeyJump&&(null==s||s.IsDisSkip||(s.BindDocEditor(t),n.Add(s))),!s.QuoteTarget||f.default.IsNullOrEmpty(s.LackEllipsisvalue)||f.default.IsNullOrEmpty(s.CptID)||l.Add(s),r.Add(s)});let a=e.AssistFunc.XDocXInputCache.BodyXChoiceCache,u=e.AssistFunc.XDocXInputCache.BodyParTakeQuoteXChoiceCache,h=new c.List;e.GetPagePanel(o.ENumPagePanelTp.Body).GetChildrenByTypes(["XTextRadioBox","XTextCheckBox"],!0,h,!0),a.Clear(),u.Clear(),h.ToArray().forEach(e=>{let t=e;a.Add(t),!t.QuoteTarget||f.default.IsNullOrEmpty(t.LackEllipsisvalue)||f.default.IsNullOrEmpty(t.CptID)||u.Add(t)})}static GetBodyCacheInputs(e){return e.AssistFunc.XDocXInputCache.BodyXInputCache.ToArray()}static GetBodyAllCacheXInputs(e){return e.AssistFunc.XDocXInputCache.BodyAllXInputCache.ToArray()}static GetNextInputEle_Body(e,t,n){let r,i;if(r=n?g.GetBodyAllCacheXInputs(e):g.GetBodyCacheInputs(e),null==r||0==r.length)i=null;else{let e=new c.List;e.AddRange(r);let n=e.IndexOf(t);if(-1==n)i=null;else{let r=g.GetNextValidJumpInputEle(t,n+1,e.Count(),e);i=r}}return i}static GetServTime(){let e;return i.TextDocInitInfo.RunAsDemo,e=p.DateTime.Now,e}static BulidImageRightInfo(e){let t;if(null==e)t=null;else{let n=new h.ImageRightPropertyInfo;n.Id=e.GrpID,n.Title=e.Title,n.Alt=e.AltText,n.Source=e.Source,n.ContentReadOnly=e.ContentReadOnly,n.DrawImage=e.ImgObj,n.KeepWidthHeightRate=e.KeepWidthHeightRate,n.OffsetX=e.OffsetX,n.OffsetY=e.OffsetY,n.VAlign=e.VAlign,n.ZOrderStyle=e.ZOrderStyle,t=n}return t}static Base64ToImage(e){let t;return f.default.IsNullOrEmpty(e)&&(t=null),t}static ImageToBase64(e){let t;return null==e&&(t=null),t}static ConvertStrToFractionEleType(e){let t;if(null!=e){if("1"==e)return t=a.FractionType.Vert,t;if("2"==e)return t=a.FractionType.Oblique,t;if("3"==e)return t=a.FractionType.Hert,t}return t=a.FractionType.Vert,t}static ConvertFractionEleTypeToStr(e){return e+""}static ConvertFloatToCm(e,t,n){const r=2.54*d.DPITransUtil.TransFloatVal(e,t,96)/96;let i;if(n>0){const e=10*n;i=Math.round(r*e)/e}else i=Math.round(r);return i}static GetNextValidJumpInputEle(e,t,n,r){let i=null;for(let e=t;e<n;e++){let t=r.Get(e);if(!t.IsHidden(!0)&&t.UserEditable&&!t.IsComplexInputEle()){i=t;break}}return i}}t.EmrInnerUtil=g,g.SmallScreenRenderHeight=24,g.LargeScreenRenderHeight=28},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.activeSetWidthItem=t.activeColorItem=void 0;const r=n(77);t.default=function(e){let t=document.getElementsByClassName("kssToolbarItemBT");document.getElementById("kssToolbarMiddleArea").style.display="inline-block",Array.prototype.forEach.call(t,e=>{r.removeClass(e,"kssToolbarActiveItemBT")}),e?(r.addClass(e,"kssToolbarActiveItemBT"),document.getElementById("kssRectangleCanvas").style.cursor="crosshair"):document.getElementById("kssRectangleCanvas").style.cursor="move"},t.activeColorItem=function(e){let t=document.getElementsByClassName("kssColorItem");Array.prototype.forEach.call(t,e=>{r.removeClass(e,"active")}),e&&r.addClass(e,"active")},t.activeSetWidthItem=function(e){let t=document.getElementsByClassName("kssLineWidthItem");Array.prototype.forEach.call(t,e=>{r.removeClass(e,"active")}),e&&r.addClass(e,"active")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.intersect=t.group=t.except=t.distinct=t.contains=t.concat=void 0;var r=n(443);Object.defineProperty(t,"concat",{enumerable:!0,get:function(){return r.concat}});var i=n(192);Object.defineProperty(t,"contains",{enumerable:!0,get:function(){return i.contains}});var l=n(444);Object.defineProperty(t,"distinct",{enumerable:!0,get:function(){return l.distinct}});var s=n(445);Object.defineProperty(t,"except",{enumerable:!0,get:function(){return s.except}});var o=n(446);Object.defineProperty(t,"group",{enumerable:!0,get:function(){return o.group}});var a=n(447);Object.defineProperty(t,"intersect",{enumerable:!0,get:function(){return a.intersect}})},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,l){function s(e){try{a(r.next(e))}catch(e){l(e)}}function o(e){try{a(r.throw(e))}catch(e){l(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}a((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserCodeReader=void 0;const i=n(264),l=n(265),s=n(268),o=n(269),a=n(5);t.BrowserCodeReader=class{constructor(e,t=500,n){this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return"undefined"!=typeof navigator}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return r(this,void 0,void 0,(function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const n of e){const e="video"===n.kind?"videoinput":n.kind;if("videoinput"!==e)continue;const r={deviceId:n.deviceId||n.id,label:n.label||"Video device "+(t.length+1),kind:e,groupId:n.groupId};t.push(r)}return t}))}getVideoInputDevices(){return r(this,void 0,void 0,(function*(){return(yield this.listVideoInputDevices()).map(e=>new o.VideoInputDevice(e.deviceId,e.label))}))}findDeviceById(e){return r(this,void 0,void 0,(function*(){const t=yield this.listVideoInputDevices();return t?t.find(t=>t.deviceId===e):null}))}decodeFromInputVideoDevice(e,t){return r(this,void 0,void 0,(function*(){return yield this.decodeOnceFromVideoDevice(e,t)}))}decodeOnceFromVideoDevice(e,t){return r(this,void 0,void 0,(function*(){let n;this.reset(),n=e?{deviceId:{exact:e}}:{facingMode:"environment"};const r={video:n};return yield this.decodeOnceFromConstraints(r,t)}))}decodeOnceFromConstraints(e,t){return r(this,void 0,void 0,(function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(n,t)}))}decodeOnceFromStream(e,t){return r(this,void 0,void 0,(function*(){this.reset();const n=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(n)}))}decodeFromInputVideoDeviceContinuously(e,t,n){return r(this,void 0,void 0,(function*(){return yield this.decodeFromVideoDevice(e,t,n)}))}decodeFromVideoDevice(e,t,n){return r(this,void 0,void 0,(function*(){let r;r=e?{deviceId:{exact:e}}:{facingMode:"environment"};const i={video:r};return yield this.decodeFromConstraints(i,t,n)}))}decodeFromConstraints(e,t,n){return r(this,void 0,void 0,(function*(){const r=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(r,t,n)}))}decodeFromStream(e,t,n){return r(this,void 0,void 0,(function*(){this.reset();const r=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(r,n)}))}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return r(this,void 0,void 0,(function*(){const n=this.prepareVideoElement(t);return this.addVideoSource(n,e),this.videoElement=n,this.stream=e,yield this.playVideoOnLoadAsync(n),n}))}playVideoOnLoadAsync(e){return new Promise((t,n)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return r(this,void 0,void 0,(function*(){if(!this.isVideoPlaying(e))try{yield e.play()}catch(e){}}))}getMediaElement(e,t){const n=document.getElementById(e);if(!n)throw new a.ArgumentException(`element with id '${e}' not found`);if((n.nodeName?n.nodeName.toLowerCase():null)!==(t?t.toLowerCase():null))throw new a.ArgumentException(`element with id '${e}' must be an ${t} element`);return n}decodeFromImage(e,t){if(!e&&!t)throw new a.ArgumentException("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new a.ArgumentException("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,n){if(void 0===e&&void 0===t)throw new a.ArgumentException("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)}decodeFromImageElement(e){if(!e)throw new a.ArgumentException("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);let n;return this.imageElement=t,n=this.isImageLoaded(t)?this.decodeOnce(t,!1,!0):this._decodeOnLoadImage(t),n}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)}_decodeFromVideoElementSetup(e){if(!e)throw new a.ArgumentException("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new a.ArgumentException("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const n=this._decodeOnLoadImage(t);return t.src=e,n}decodeFromVideoUrl(e){if(!e)throw new a.ArgumentException("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n}decodeFromVideoUrlContinuously(e,t){if(!e)throw new a.ArgumentException("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),r=this.decodeFromVideoElementContinuously(n,t);return n.src=e,r}_decodeOnLoadImage(e){return new Promise((t,n)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,n),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return r(this,void 0,void 0,(function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)}))}_decodeOnLoadVideoContinuously(e,t){return r(this,void 0,void 0,(function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)}))}isImageLoaded(e){return!!e.complete&&0!==e.naturalWidth}prepareImageElement(e){let t;return void 0===e&&(t=document.createElement("img"),t.width=200,t.height=200),"string"==typeof e&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return e||"undefined"==typeof document||(t=document.createElement("video"),t.width=200,t.height=200),"string"==typeof e&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,n=!0){this._stopAsyncDecode=!1;const r=(i,l)=>{if(this._stopAsyncDecode)return l(new a.NotFoundException("Video stream has ended before any code could be detected.")),void(this._stopAsyncDecode=void 0);try{i(this.decode(e))}catch(e){const s=t&&e instanceof a.NotFoundException,o=(e instanceof a.ChecksumException||e instanceof a.FormatException)&&n;if(s||o)return setTimeout(r,this._timeBetweenDecodingAttempts,i,l);l(e)}};return new Promise((e,t)=>r(e,t))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const n=()=>{if(this._stopContinuousDecode)this._stopContinuousDecode=void 0;else try{const r=this.decode(e);t(r,null),setTimeout(n,this.timeBetweenScansMillis)}catch(e){t(null,e);const r=e instanceof a.ChecksumException||e instanceof a.FormatException,i=e instanceof a.NotFoundException;(r||i)&&setTimeout(n,this._timeBetweenDecodingAttempts)}};n()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}createBinaryBitmap(e){const t=this.getCaptureCanvasContext(e);this.drawImageOnCanvas(t,e);const n=this.getCaptureCanvas(e),r=new s.HTMLCanvasElementLuminanceSource(n),o=new l.default(r);return new i.default(o)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const t=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=t}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}drawImageOnCanvas(e,t){e.drawImage(t,0,0)}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if("undefined"==typeof document)return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let n,r;return void 0!==e&&(e instanceof HTMLVideoElement?(n=e.videoWidth,r=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,r=e.naturalHeight||e.height)),t.style.width=n+"px",t.style.height=r+"px",t.width=n,t.height=r,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),!1===this._stopAsyncDecode&&this.stopAsyncDecode(),!1===this._stopContinuousDecode&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(void 0!==this.videoEndedListener&&this.videoElement.removeEventListener("ended",this.videoEndedListener),void 0!==this.videoPlayingEventListener&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),void 0!==this.videoCanPlayListener&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(void 0!==this.imageLoadedListener&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch(n){e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch(t){e.src=""}this.videoElement.removeAttribute("src")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(49),i=n(84),l=n(100),s=n(5);class o{constructor(e,t){void 0===e?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,this.bits=null==t?o.makeArray(e):t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>32*this.bits.length){const t=o.makeArray(e);r.default.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return 0!=(this.bits[Math.floor(e/32)]&1<<(31&e))}set(e){this.bits[Math.floor(e/32)]|=1<<(31&e)}flip(e){this.bits[Math.floor(e/32)]^=1<<(31&e)}getNextSet(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),l=n[r];l&=~((1<<(31&e))-1);const s=n.length;for(;0===l;){if(++r===s)return t;l=n[r]}const o=32*r+i.default.numberOfTrailingZeros(l);return o>t?t:o}getNextUnset(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),l=~n[r];l&=~((1<<(31&e))-1);const s=n.length;for(;0===l;){if(++r===s)return t;l=~n[r]}const o=32*r+i.default.numberOfTrailingZeros(l);return o>t?t:o}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new s.IllegalArgumentException;if(t===e)return;t--;const n=Math.floor(e/32),r=Math.floor(t/32),i=this.bits;for(let l=n;l<=r;l++){const s=(2<<(l<r?31:31&t))-(1<<(l>n?0:31&e));i[l]|=s}}clear(){const e=this.bits.length,t=this.bits;for(let n=0;n<e;n++)t[n]=0}isRange(e,t,n){if(t<e||e<0||t>this.size)throw new s.IllegalArgumentException;if(t===e)return!0;t--;const r=Math.floor(e/32),i=Math.floor(t/32),l=this.bits;for(let s=r;s<=i;s++){const o=(2<<(s<i?31:31&t))-(1<<(s>r?0:31&e))&4294967295;if((l[s]&o)!==(n?o:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++}appendBits(e,t){if(t<0||t>32)throw new s.IllegalArgumentException("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);this.appendBit;for(let n=t;n>0;n--)this.appendBit(1==(e>>n-1&1))}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);this.appendBit;for(let n=0;n<t;n++)this.appendBit(e.get(n))}xor(e){if(this.size!==e.size)throw new s.IllegalArgumentException("Sizes don't match");const t=this.bits;for(let n=0,r=t.length;n<r;n++)t[n]^=e.bits[n]}toBytes(e,t,n,r){for(let i=0;i<r;i++){let r=0;for(let t=0;t<8;t++)this.get(e)&&(r|=1<<7-t),e++;t[n+i]=r}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,r=this.bits;for(let i=0;i<n;i++){let n=r[i];n=n>>1&1431655765|(1431655765&n)<<1,n=n>>2&858993459|(858993459&n)<<2,n=n>>4&252645135|(252645135&n)<<4,n=n>>8&16711935|(16711935&n)<<8,n=n>>16&65535|(65535&n)<<16,e[t-i]=n}if(this.size!==32*n){const t=32*n-this.size;let r=e[0]>>>t;for(let i=1;i<n;i++){const n=e[i];r|=n<<32-t,e[i-1]=r,r=n>>>t}e[n-1]=r}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof o))return!1;const t=e;return this.size===t.size&&l.default.equals(this.bits,t.bits)}hashCode(){return 31*this.size+l.default.hashCode(this.bits)}toString(){let e="";for(let t=0,n=this.size;t<n;t++)0==(7&t)&&(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new o(this.size,this.bits.slice())}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(49),i=n(5);class l{static fill(e,t){for(let n=0,r=e.length;n<r;n++)e[n]=t}static fillWithin(e,t,n,r){l.rangeCheck(e.length,t,n);for(let i=t;i<n;i++)e[i]=r}static rangeCheck(e,t,n){if(t>n)throw new i.IllegalArgumentException("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new i.ArrayIndexOutOfBoundsException(t);if(n>e)throw new i.ArrayIndexOutOfBoundsException(n)}static asList(...e){return e}static create(e,t,n){return Array.from({length:e}).map(e=>Array.from({length:t}).fill(n))}static createInt32Array(e,t,n){return Array.from({length:e}).map(e=>Int32Array.from({length:t}).fill(n))}static equals(e,t){if(!e)return!1;if(!t)return!1;if(!e.length)return!1;if(!t.length)return!1;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}static hashCode(e){if(null===e)return 0;let t=1;for(const n of e)t=31*t+n;return t}static fillUint8Array(e,t){for(let n=0;n!==e.length;n++)e[n]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)}static copyOfRange(e,t,n){const i=n-t,l=new Int32Array(i);return r.default.arraycopy(e,t,l,0,i),l}static binarySearch(e,t,n){void 0===n&&(n=l.numberComparator);let r=0,i=e.length-1;for(;r<=i;){const l=i+r>>1,s=n(t,e[l]);if(s>0)r=l+1;else{if(!(s<0))return l;i=l-1}}return-r-1}static numberComparator(e,t){return e-t}}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(153),i=n(270),l=n(84),s=n(5);class o extends i.default{constructor(e,t,n){super(),this.primitive=e,this.size=t,this.generatorBase=n;const i=new Int32Array(t);let l=1;for(let n=0;n<t;n++)i[n]=l,l*=2,l>=t&&(l^=e,l&=t-1);this.expTable=i;const s=new Int32Array(t);for(let e=0;e<t-1;e++)s[i[e]]=e;this.logTable=s,this.zero=new r.default(this,Int32Array.from([0])),this.one=new r.default(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new s.IllegalArgumentException;if(0===t)return this.zero;const n=new Int32Array(e+1);return n[0]=t,new r.default(this,n)}inverse(e){if(0===e)throw new s.ArithmeticException;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+l.default.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}t.default=o,o.AZTEC_DATA_12=new o(4201,4096,1),o.AZTEC_DATA_10=new o(1033,1024,1),o.AZTEC_DATA_6=new o(67,64,1),o.AZTEC_PARAM=new o(19,16,1),o.QR_CODE_FIELD_256=new o(285,256,0),o.DATA_MATRIX_FIELD_256=new o(301,256,1),o.AZTEC_DATA_8=o.DATA_MATRIX_FIELD_256,o.MAXICODE_FIELD_64=o.AZTEC_DATA_6},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(100),i=n(72);class l{PDF417Common(){}static getBitCountSum(e){return i.default.sum(e)}static toIntArray(e){if(null==e||!e.length)return l.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let n=0;for(const r of e)t[n++]=r;return t}static getCodeword(e){const t=r.default.binarySearch(l.SYMBOL_TABLE,262143&e);return t<0?-1:(l.CODEWORD_TABLE[t]-1)%l.NUMBER_OF_CODEWORDS}}t.default=l,l.NUMBER_OF_CODEWORDS=929,l.MAX_CODEWORDS_IN_BARCODE=l.NUMBER_OF_CODEWORDS-1,l.MIN_ROWS_IN_BARCODE=3,l.MAX_ROWS_IN_BARCODE=90,l.MODULES_IN_CODEWORD=17,l.MODULES_IN_STOP_PATTERN=18,l.BARS_IN_MODULE=8,l.EMPTY_INT_ARRAY=new Int32Array([]),l.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),l.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontStyle=void 0,function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Italic=2]="Italic",e[e.Underline=4]="Underline",e[e.Strikeout=8]="Strikeout"}(t.FontStyle||(t.FontStyle={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleVAlignVals=void 0;const r=n(11);class i{static GetVAlignStrVal(e){let t=null;switch(e){case r.ENumVAlignStyle.TOP:t="Top";break;case r.ENumVAlignStyle.MIDDLE:t="Center";break;case r.ENumVAlignStyle.BOTTOM:t="Bottom"}return t}static GetEnumVAlign(e){let t;if(null==e)t=r.ENumVAlignStyle.NONE;else{let n=r.ENumVAlignStyle.NONE;null!=e&&("Top"!=e?"Center"!=e?"Bottom"==e&&(n=r.ENumVAlignStyle.BOTTOM):n=r.ENumVAlignStyle.MIDDLE:n=r.ENumVAlignStyle.TOP),t=n}return t}}t.StyleVAlignVals=i,i.None="",i.Top="Top",i.Center="Center",i.Bottom="Bottom"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XParagraphFlagStyle=void 0;const r=n(211),i=n(8),l=n(10);class s extends r.XVirtualManualCRStyle{constructor(){super(),this.isFolded=!1,this._bottomMargin=0,this.lineSpacingStyleArr=["Space1pt5","SpaceDouble","SpaceSpecify","SpaceMultiple","SpaceExactly"]}get IsFolded(){return this.isFolded}set IsFolded(e){this.isFolded=e}get ParagraphOutlineLevel(){return null}set ParagraphOutlineLevel(e){}get ParagraphMultiLevel(){return null}set ParagraphMultiLevel(e){}get ParagraphListStyle(){return null}set ParagraphListStyle(e){}get LeftIndent(){const e=this.propList.GetPropValue("LeftIndent"),t=i.CNumUtil.TryParseFloat(e,0);return isNaN(Number(e))&&this.propList.ModifyProperty("LeftIndent",t,"0"),t}set LeftIndent(e){let t=i.CNumUtil.ToStringForNum(e)||0;this.propList.ModifyProperty("LeftIndent",t,"0")}get BottomMargin(){return this._bottomMargin}set BottomMargin(e){this._bottomMargin=e}get FirstLineIndent(){let e=this.propList.GetPropValue("FirstLineIndent");const t=i.CNumUtil.TryParseFloat(e,0);return isNaN(Number(e))&&this.propList.ModifyProperty("FirstLineIndent",t,"0"),t}set FirstLineIndent(e){let t=i.CNumUtil.ToStringForNum(e);this.propList.ModifyProperty("FirstLineIndent",t,"0")}get SpacingBefore(){let e=this.propList.GetPropValue("SpacingBeforeParagraph");return i.CNumUtil.TryParseFloat(e,0)}set SpacingBefore(e){let t=i.CNumUtil.ToStringForNum(e);this.propList.ModifyProperty("SpacingBeforeParagraph",t,"0")}get SpacingAfter(){let e=this.propList.GetPropValue("SpacingAfterParagraph");return i.CNumUtil.TryParseFloat(e,0)}set SpacingAfter(e){let t=i.CNumUtil.ToStringForNum(e);this.propList.ModifyProperty("SpacingAfterParagraph",t,"0")}get LineSpacingStyle(){let e=this.propList.GetPropValue("LineSpacingStyle");return-1==this.lineSpacingStyleArr.indexOf(e)&&(e=null),null==e?"SpaceSingle":e}set LineSpacingStyle(e){-1==this.lineSpacingStyleArr.indexOf(e)&&(e="SpaceSingle"),this.propList.ModifyProperty("LineSpacingStyle",e,"SpaceSingle")}get LineSpacing(){let e=this.propList.GetPropValue("LineSpacing");return i.CNumUtil.TryParseFloat(e,1)}set LineSpacing(e){let t=i.CNumUtil.ToStringForNum(e);this.propList.ModifyProperty("LineSpacing",t,"1")}GetLineIndentDPI(e,t){let n=this.LeftIndent,r=this.FirstLineIndent;return 0!=r&&e&&(n+=r),l.DPITransUtil.TransFloatVal(n,300,t)}GetSpacingBeforeDPI(e){let t,n=this.SpacingBefore;return n<=0?t=0:(n=l.DPITransUtil.TransFloatVal(n,300,e),t=n),t}GetSpacingAfterDPI(e){let t,n=this.SpacingAfter;return n<=0?t=0:(n=l.DPITransUtil.TransFloatVal(n,300,e),t=n),t}GetLineSpacingDPI(e){let t,n=0,r=super.Font;if(null==r)t=n;else{let i=r.SizeInPoints,s=1.3*i;s=l.DPITransUtil.TransFloatVal(s,72,300);let o=this.LineSpacing,a=this.LineSpacingStyle;null!=a&&("SpaceSingle"!=a?"Space1pt5"!=a?"SpaceDouble"!=a?"SpaceExactly"!=a?"SpaceSpecify"!=a?"SpaceMultiple"==a&&(o<1&&(o=1),n=o*s):(o<i&&(o=i),n=l.DPITransUtil.TransFloatVal(o,72,300)):n=l.DPITransUtil.TransFloatVal(i,72,300):n=2*s:n=1.5*s:n=s),n=l.DPITransUtil.TransFloatVal(n,300,e),t=n}return t}GetLineCntOfSpacing(e){let t,n=this.GetLineSpacingDPI(300);if(n<=0)t=0;else{t=(e?this.SpacingBefore:this.SpacingAfter)/n}return t}SetSpacingByLineCnt(e,t){let n=t*this.GetLineSpacingDPI(300);e?this.SpacingBefore=n:this.SpacingAfter=n}CopyOnlyParaStyleFrom(e){if(null!=e){let t=["LeftIndent","FirstLineIndent","SpacingBeforeParagraph","SpacingAfterParagraph","LineSpacingStyle","LineSpacing"];super.CopyPartialFrom(e,t)}}ToXML(e){return this.propList.RemoveProperties(["ParagraphOutlineLevel","ParagraphMultiLevel","ParagraphListStyle"]),super.ToXML(e)}BuildXParagraphStyle(e){let t=e.LeftShrink;null!=t&&(this.LeftIndent=l.DPITransUtil.TransFloatVal(10*Number(t),25.4,300)||0),t=e.FirstRowShrink,null!=t&&(this.FirstLineIndent=l.DPITransUtil.TransFloatVal(10*Number(t),25.4,300)||0),t=e.ParagraphBeforeShrink,null!=t&&this.SetSpacingByLineCnt(!0,Number(t)),t=e.ParagraphAfterShrink,null!=t&&this.SetSpacingByLineCnt(!1,Number(t));let n=e.RowSpaceValueText;n&&(this.LineSpacingStyle=n+"",this.LineSpacing=e.RowSpace)}}t.XParagraphFlagStyle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleAddDelUndo=void 0;const r=n(0),i=n(23);class l extends i.IXUndoable{constructor(e,t,n){super(),this.paEle=null,this.childEle=null,this.childPos=-1,this.cursorUndoEle=null,this.cursorRedoEle=null,this.isAdd=!0,this.paEle=null==e?null:e.Parent,this.childEle=e,this.childPos=t,this.isAdd=n}get IsCaretVisible(){return!0}get CursorUndoEle(){return this.cursorUndoEle}set CursorUndoEle(e){this.cursorUndoEle=r.XDomUtil.GetBaseElement(e)}get CursorRedoEle(){return this.cursorRedoEle}set CursorRedoEle(e){this.cursorRedoEle=e}get RelativeEle(){return this.childEle}IsValid(){return null!=this.paEle&&null!=this.childEle&&this.childPos>=0}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){if(this.CanUndo())if(this.isAdd){let e=this.childPos;if(this.childPos>=0&&this.childPos<this.paEle.ChildCount&&null!=this.childEle){let t=this.paEle.ChildEleList.Get(this.childPos);if(!t||t.XID!=this.childEle.XID){const t=this.paEle.GetChildInx(this.childEle);t>=0&&(e=t)}}this.paEle.RemoveChild(e)}else this.paEle.AddChildEle(this.childPos,this.childEle)}Redo(){this.CanRedo()&&(this.isAdd?this.paEle.AddChildEle(this.childPos,this.childEle):this.paEle.RemoveChild(this.childPos))}Clear(){this.paEle=null,this.childEle=null,this.childPos=-1}}t.EleAddDelUndo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InsertElementBack=void 0;const r=n(167),i=n(34),l=n(36),s=n(320),o=n(7),a=n(168),u=n(222),h=n(223),d=n(169),c=n(39),p=n(2);t.InsertElementBack=class{static getTableInfo(e,t){let n=t,r=p.ENumRefreshStatus.None;const i={No:"tableCode",Name:"tableName",IsSetRowHeight:"rowHeightFlag",IsSetColWidth:"columnWidthFlag",IsInsertRow:"addRowFlag",IsDeleteRow:"deleteRowFlag",IsDeleteTable:"deleteTableFlag",IsPrint:"isPrint",THeadIx:"tHeadIx",Text_Expression:"expressionInput",UserEditable:"readFlag",FullPageByLastRow:"fullPageByLastRow"};for(const t in i){const l=i[t];if(Object.prototype.hasOwnProperty.call(e,l)){let i=e[l];"readFlag"==l&&(i=!i),"Text_Expression"==t&&i?(i=decodeURIComponent(i),n[t]!=i&&(r=p.ENumRefreshStatus.RegisterExp),n[t]=i):n[t]!=i&&(n[t]=i,"THeadIx"==t?r=p.ENumRefreshStatus.Refresh:r<p.ENumRefreshStatus.Descript&&(r=p.ENumRefreshStatus.Descript))}}return e.refreshStatus=r,i}static getTableCellInfo(e,t){let n=t,r=p.ENumRefreshStatus.None;const i={UserEditable:"readFlag",DisSplit:"DisSplit",Slashing:"Slashing",ColSpan:"colSpan",RowSpan:"rowSpan"};for(const t in i){const l=i[t];if(Object.prototype.hasOwnProperty.call(e,l)){let i=e[l];"readFlag"==l&&(i=!i),n[t]!=i&&(n[t]=i,"readFlag"!=t&&(r=p.ENumRefreshStatus.Refresh),r<p.ENumRefreshStatus.Descript&&(r=p.ENumRefreshStatus.Descript))}}return e.refreshStatus=r,i}static getBarCodeInfo(e,t){let n=null!=t?t:new r.BarcodeInfo;return void 0!==e.insertType&&(n.Type=e.insertType),void 0!==e.elementCode&&(e.refreshStatus=1,n.No=e.elementCode),void 0!==e.elementName&&(e.refreshStatus=1,n.Name=e.elementName),void 0!==e.dataEmementName&&(e.refreshStatus=1,n.DataEleName=e.dataEmementName),void 0!==e.dataEmementCode&&(e.refreshStatus=1,n.DateEleCode=e.dataEmementCode),void 0!==e.sourceName&&(e.refreshStatus=1,n.SourceName=e.sourceName),void 0!==e.attributeName&&(e.refreshStatus=1,n.PropName=e.attributeName),void 0!==e.codeRule&&(e.refreshStatus=2,n.CodeStyleStr=e.codeRule),void 0!==e.stripWidth&&(e.refreshStatus=2,n.BarcodeLineWidth=e.stripWidth),void 0!==e.stripHeight&&(e.refreshStatus=2,n.BarcodeLineHeight=e.stripHeight),void 0!==e.textContent&&(e.refreshStatus=2,n.Content=e.textContent),void 0!==e.textContentFlag&&(e.refreshStatus=2,n.IsShowText=e.textContentFlag),void 0!==e.textAlignment&&(e.refreshStatus=2,n.TextAlignStyleStr=e.textAlignment),void 0!==e.labelText&&(e.refreshStatus=2,n.LabelText=e.labelText),void 0!==e.labelTextFlag&&(e.refreshStatus=2,n.IsShowLabelText=e.labelTextFlag),void 0!==e.labelTextPosition&&(e.refreshStatus=2,n.LabelShowPosition=e.labelTextPosition),n.CodeChoiceStyle=r.CodeType.Barcode,void 0!==e.conceptDomainCode&&(e.refreshStatus=1,n.CptID=e.conceptDomainCode),void 0!==e.extendAttr1&&(e.refreshStatus=1,n.ExtendAttr1=e.extendAttr1),void 0!==e.dragFlag&&(e.refreshStatus=1,n.IsAllowDrag=e.dragFlag),void 0!==e.hideFlag&&(e.refreshStatus=2,n.Attr_FgHide=e.hideFlag),n}static getQRCodeInfo(e,t){let n=null!=t?t:new r.BarcodeInfo;return void 0!==e.insertType&&(n.Type=e.insertType),void 0!==e.elementCode&&(e.refreshStatus=1,n.No=e.elementCode),void 0!==e.elementName&&(e.refreshStatus=1,n.Name=e.elementName),void 0!==e.dataEmementName&&(e.refreshStatus=1,n.DataEleName=e.dataEmementName),void 0!==e.dataEmementCode&&(e.refreshStatus=1,n.DateEleCode=e.dataEmementCode),void 0!==e.sourceName&&(e.refreshStatus=1,n.SourceName=e.sourceName),void 0!==e.attributeName&&(e.refreshStatus=1,n.PropName=e.attributeName),void 0!==e.codeRule&&(e.refreshStatus=2,n.CodeStyleStr=e.codeRule),void 0!==e.textContent&&(e.refreshStatus=2,n.Content=e.textContent),void 0!==e.labelText&&(e.refreshStatus=2,n.LabelText=e.labelText),void 0!==e.labelTextFlag&&(e.refreshStatus=2,n.IsShowLabelText=e.labelTextFlag),void 0!==e.labelTextPosition&&(e.refreshStatus=2,n.LabelShowPosition=e.labelTextPosition),n.CodeChoiceStyle=r.CodeType.QRcode,void 0!==e.conceptDomainCode&&(e.refreshStatus=1,n.CptID=e.conceptDomainCode),void 0!==e.extendAttr1&&(e.refreshStatus=1,n.ExtendAttr1=e.extendAttr1),void 0!==e.dragFlag&&(e.refreshStatus=1,n.IsAllowDrag=e.dragFlag),void 0!==e.hideFlag&&(e.refreshStatus=2,n.Attr_FgHide=e.hideFlag),n}static getSpliteLineInfo(e){let t=new s.HorizontalLinePropertiesInfo;return t.Type=e.insertType,t.No=e.attributeCode,t.HorLineColor=new o.Color(e.lineColor?e.lineColor:"#000000"),t.LineWidth=e.lineWidth,t.LineLength=e.lineLength,t.SpliteLineEleHeight=e.elementHeight,t.IsAutoWidth=e.adaptionWidthFlag,t.ShowLineStyle=e.displayWay,t.DottedLineWidth=e.dottedLineWidth,t.DottedLinePadding=e.dottedLineInterval,t}static getBtnInfo(e){let t=new u.InsertBtnInfo;return t.GrpId=e.attributeCode,t.Text=e.displayText,t.Deletable=null==e.deleteFlag||e.deleteFlag,t.BorderStyle=e.borderStyle,t.BorderColor=new o.Color(e.borderColor),t.BackColor=new o.Color(e.backgroundColor),null!=e.buttonIcon&&null!=e.buttonIcon&&(t.Icon=e.buttonIcon,t.IconWidth=e.iconWidth,t.IconHeight=e.iconHeight),t}static getMedExpressionInfo(e){let t=this.BulidInsertMedicalInfo(e.formulaType);return t.No=e.attributeCode,t.Name=e.displayText,t.VAlign=e.alignWay,t.Type=e.insertType,t.Gender=e.sexJudge,t.MaxAge=e.maxAge,t.MinAge=e.minAge,t.conceptDomainCode=e.conceptDomainCode,t.ValueCode_de=e.dataEmementCode,t.Name_de=e.dataEmementName,t}static getShapeInfo(e){let t=new a.ShapeInfo;return t.Type=e.insertType,t.No=e.attributeCode,t.Name=e.attributeName,t.ShapeKey=e.shapeType,t.ShapeText=e.displayText,t.AlignKey=e.alignWay,"CirCle"==e.shapeType&&(t.RoundAngle=e.roundRadian),"CirRect"==e.shapeType&&(t.RoundAngle=e.roundRadian),"Ellipse"==e.shapeType&&(t.HorEllipseNum=e.levelThan,t.RoundAngle=e.roundRadian,t.VerEllipseNum=e.verticalThan),t}static getBarCodeType(e){let t=i.Symbology.Code39;return"Code39"==e?t=i.Symbology.Code39:"Code39Extd"==e?t=i.Symbology.Code39Extd:"Code128Auto"==e?t=i.Symbology.Code128Auto:"Code2of5"==e?t=i.Symbology.Code2of5:"Codel2of5"==e?t=i.Symbology.CodeI2of5:"Codabar"==e?t=i.Symbology.Codabar:"MSI"==e?t=i.Symbology.MSI:"Code11"==e&&(t=i.Symbology.Code11),t}static getQRCodeType(e){let t=l.BarcodeFormat.QR_CODE;return"QR_CODE"==e?t=l.BarcodeFormat.QR_CODE:"PDF_417"==e?t=l.BarcodeFormat.PDF_417:"DATA_MATRIX"==e&&(t=l.BarcodeFormat.DATA_MATRIX),t}static BulidInsertMedicalInfo(e){let t,n=null;switch(e){case"FourValues":n=new d.MedExpressionItemInfo,n.IconName="FourValues-1",n.Text="月经公式1",n.Type="FourValues",n.DefaultValue=c.DateTime.Now.ToString("yyyy-MM-dd")+",3,30,"+c.DateTime.Now.ToString("yyyy-MM-dd")+",true,true";break;case"FourValues1":n=new d.MedExpressionItemInfo,n.IconName="FourValues1-1",n.Text="月经公式2",n.Type="FourValues1",n.DefaultValue="Value1,Value2,Value3,Value4";break;case"FourValues2":n=new d.MedExpressionItemInfo,n.IconName="FourValues2-1",n.Text="月经公式3",n.Type="FourValues2",n.DefaultValue="Value1,Value2,Value3,Value4";break;case"ThreeValues":n=new d.MedExpressionItemInfo,n.IconName="ThreeValues-1",n.Text="月经公式4",n.Type="ThreeValues",n.DefaultValue="Value1,Value2,Value3";break;case"Pupil":n=new d.MedExpressionItemInfo,n.IconName="Pupil-1",n.Text="瞳孔图",n.Type="Pupil",n.DefaultValue="Value1,Value2,Value3,Value4,Value5,Value6,Value7";break;case"LightPositioning":n=new d.MedExpressionItemInfo,n.IconName="LightPositioning-1",n.Text="光定位图",n.Type="LightPositioning",n.DefaultValue="Value1,Value2,Value3,Value4,Value5,Value6,Value7,Value8,Value9";break;case"FetalHeart":n=new d.MedExpressionItemInfo,n.IconName="FetalHeart-1",n.Text="胎心图",n.Type="FetalHeart",n.DefaultValue="Value1,Value2,Value3,Value4,Value5,Value6";break;case"PainIndex":n=new d.MedExpressionItemInfo,n.IconName="ruler",n.Text="标尺图",n.Type="PainIndex"}return null!=n?(t=new h.InsertMedExpressionItemInfo,t.ItemInfo=n,t.Name=n.Name,t.VAlign="Center"):t=null,t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditEleRange=void 0;const r=n(0),i=n(16),l=n(79),s=n(58);t.EditEleRange=class{get EleEvtHandler(){return this._eleEvtHandler}set EleEvtHandler(e){this._eleEvtHandler=e}get ClickedEleWrap(){return this.elickedEleWrap}set ClickedEleWrap(e){this.elickedEleWrap=e}static BuildElesFromStr(e,t,n,o){if(n.Clear(),!e)return null;if(null==n)return null;let a,u,h=e.split(/\r?\n|\r/g);if(null==h||h.length<=0)return null;if(null!=o){const e=o.LineEleIxFocused.Line;if(null!=e&&(a=e.RelEleParagraphStyle),null==t){let e=o.LineEleIxFocused._GetNextEle(!1,!0,!0);null!=e&&null!=e.EleStyle?t=i.XDomUtil.IsBkgTextOfXInput(e)?e.GetParentInputField().EleStyle:e.EleStyle:null!=o.EleFocused&&null!=o.EleFocused.EleStyle&&(t=new s.XBaseEleStyle(!1)).CopyFrom(o.EleFocused.EleStyle,!1)}}null==t&&(t=new s.XBaseEleStyle(!1));let d=h.length;for(let e=0;e<d;e++){if(0!=e){let e=new r.XParagraphFlag;null!=a&&e.EleStyle.CopyFrom(a,!1),null==u?u=e:n.Add(e)}if(h[e]){let r=new l.XStringEle;r.EleStyle.CopyFrom(t,!1),r.Text=h[e],0==e?u=r:n.Add(r)}}return u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DomUtils=void 0;class r{static GetOffset(e){let t=null,n=null,r=e.offsetParent;for(t+=e.offsetLeft,n+=e.offsetTop;r;)t+=r.offsetLeft,n+=r.offsetTop,r=r.offsetParent;return{left:t,top:n}}static GetScrollPosition(e){let t=null,n=null,r=e.offsetParent;for(t+=e.scrollLeft,n+=e.scrollTop;r;)t+=r.scrollLeft,n+=r.scrollTop,r=r.parentElement;return{left:t,top:n}}static GetZIndex(){return++this.currentZIndex}static textWidth(e,t){let n=t||"font-size-14",r=document.createElement("div");r.innerHTML=e,r.className="pango-textWidth-div "+n,r.style.fontFamily="Arial,Helvetica Neue,SourceHanSansCN,Microsoft YaHei,PingFang SC,sans-serif",document.body.appendChild(r);let i=Math.ceil(r.offsetWidth+1);return r.remove(),i}static convertSize(e){if(null!=e)return(e=String(e)).indexOf("%")>=0?e:parseInt(e)+"px"}static throttle(e,t,n){clearTimeout(e.tid),e.tid=setTimeout((function(){e.call(t)}),n)}static debounce(e,t,n){return function(){clearTimeout(e.tid),e.id=setTimeout(()=>{e.call(t)},n)}}static convertCssStyle(e){let t={};if(e){let n=e.split(";");for(let e of n){let n=e.split(":");t[n[0]]=n[1]}}return t}}t.DomUtils=r,r.currentZIndex=100},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectFUtil=void 0;const r=n(9),i=n(17),l=n(25),s=n(11),o=n(82);class a{static CopyRectF(e,t){t.X=e.X,t.Y=e.Y,t.Width=e.Width,t.Height=e.Height}static ToPoint(e){let t=i.PointF.Empty;return t.X=e.X+.5,t.Y=e.Y+.5,t}static ToSize(e){let t=l.SizeF.Empty;return t.Width=e.Width+.5,t.Height=e.Height+.5,t}static ToRect(e){let t=r.RectangleF.Empty;return t.X=e.X+.5,t.Y=e.Y+.5,t.Width=e.Width+.5,t.Height=e.Height+.5,t}static ToRect2(e,t){t.X=e.X+.5,t.Y=e.Y+.5,t.Width=e.Width+.5,t.Height=e.Height+.5}static ZoomRectF(e,t,n,r){n<=0&&(n=1),t.X=r?e.X*n:e.X,t.Y=r?e.Y*n:e.Y;let i=t.Size;a.ZoomSizeF(e.Size,i,n),t.Size=i}static ZoomPointF(e,t,n){n<=0&&(n=1),1==n?(t.X=e.X,t.Y=e.Y):(t.X=e.X*n,t.Y=e.Y*n)}static ZoomSizeF(e,t,n){n<=0&&(n=1),1==n?(t.Width=e.Width,t.Height=e.Height):(t.Width=e.Width*n,t.Height=e.Height*n)}static AlignRectF(e,t,n,r,i){let l=[],a=o.Padding.Empty,u=e.Width,h=e.Height,d=-1e3==n.Left?a.Left:n.Left,c=-1e3==n.Top?a.Top:n.Top;switch(r){case s.ENumHAlignStyle.LEFT:l[0]=d;break;case s.ENumHAlignStyle.CENTER:u-=d,u-=-1e3==n.Right?a.Right:n.Right,l[0]=d+(u-t.Width)/2;break;case s.ENumHAlignStyle.RIGHT:l[0]=e.Width-t.Width,l[0]-=-1e3==n.Right?a.Right:n.Right}switch(i){case s.ENumVAlignStyle.TOP:l[1]=c;break;case s.ENumVAlignStyle.MIDDLE:h-=c,h-=-1e3==n.Bottom?a.Bottom:n.Bottom,l[1]=c+(h-t.Height)/2;break;case s.ENumVAlignStyle.BOTTOM:l[1]=e.Height-t.Height,l[1]-=-1e3==n.Bottom?a.Bottom:n.Bottom}return t.X+=l[0],t.Y+=l[1],l}static LimitRectF(e,t,n){let r=0,i=0;t.X<e.X&&(r=e.X-t.X,t.X=e.X),t.Y<e.Y&&(i=e.Y-t.Y,t.Y=e.Y),t.Width-=r,t.X+t.Width>e.X+e.Width&&(t.Width=e.X+e.Width-t.X),t.Height-=i,!n&&t.Y+t.Height>e.Y+e.Height&&(t.Height=e.Y+e.Height-t.Y)}}t.RectFUtil=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResMessage=void 0;const r=n(710);t.ResMessage=class{constructor(e,t,n,r){this.msgLevel=7,this.codeStr=null,this.msgStr=null,this.ex=null,this.isReturnMsg=!1,this.msgLevel=e,this.codeStr=n,this.msgStr=t,null!=r&&(this.msgLevel=1,this.codeStr=null,this.msgStr=r.Message,this.ex=r)}get MsgLevel(){return this.msgLevel}set MsgLevel(e){this.msgLevel=e}get CodeStr(){return this.codeStr}set CodeStr(e){this.codeStr=e}get MsgStr(){return this.msgStr}set MsgStr(e){this.msgStr=e}get Ex(){return this.ex}set Ex(e){this.MsgLevel=1,this.ex=e,this.msgStr=null==e?null:e.Message}Clear(){this.msgLevel=7,this.codeStr=null,this.msgStr=null,this.ex=null,this.ReturnParams="",this.isReturnMsg=!1}CopyFrom(e){null!=e&&(this.msgLevel=e.msgLevel,this.codeStr=e.codeStr,null==e.Ex?(this.ex=null,this.msgStr=e.msgStr):this.Ex=e.Ex)}IsDebugMsg(){return this.msgLevel>=7}IsInfoMsg(){return 5==this.msgLevel}IsWarnMsg(){return this.msgLevel<=2}IsErrorMsg(){return this.msgLevel<=1}ToString(){return r.LogItem.getLogLevelInfo(this.msgLevel)+"："+this.codeStr+","+this.msgStr}get ReturnParams(){return this._returnParams}set ReturnParams(e){this._returnParams=e}get IsReturnMsg(){return this.isReturnMsg}set IsReturnMsg(e){this.isReturnMsg=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseA_SetFontDetail=void 0;const r=n(2),i=n(0),l=n(16),s=n(834),o=n(835),a=n(13),u=n(1);class h extends u.XBaseAction{constructor(){super(null),super.OpType=r.ENumActOpType.StyleEdit}ChkActParamsCnt(e){let t;return null==e||e.length<1?(this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName+" 调用参数有误",t=!1):t=!0,t}Execute(e){if(!this.IsEnable(!1))return;this.resMsg.Clear();let t,n=null==e?0:e.length,r=e[0],i=n>=2?e[1]:null,l=super.GetEdtCtrl(),s=l.M_EleEvtModel.SelRange;if(null!=s&&s.IsValid()){let e=s.InfoUtil.GetLineBaseElesInRange(!1,!1);if(this._ChangeSelElesFont(r,i,e)){super._RefreshPageAndMoveCaret(!0,!0);let t=super._GetFirstEleFromRange(e);l.M_EleEvtHandler.OnEleStyleChanged(this.ActName(),t.EleStyle)}t=this.resMsg}else{let e=l.M_CaretEleStyle;this._ChangeOneFont(e.XFontStyle,r,i),t=this.resMsg}return t}_ChangeSelElesFont(e,t,n){let r,s=null==n?0:n.length;if(s<=0)r=!1;else{let u=new a.UndoGroup,h=null,d=!1;for(let r=0;r<s;r++){let s=n[r];if(null!=s){if("SetTextUnderline"==this.ActName()&&!l.XDomUtil.UnderLineSettingIsValid(s))continue;let n=e;this.FormartFontName(s,n);let r=l.XDomUtil.IsInnerChildOfXInput(s);if(null!=r){if(r==h)continue;s=r,h=r}let a=new o.EleFontUndo(s),c=s.EleStyle.XFontStyle,p=this._ChangeOneFont(c,n,t);if(d=d||p,p){a.ReadNewFontStyle(),u.AddItem(a);let e=s instanceof i.XBaseInputEle?s:null;null==e?s.NotifyLayoutChanged(!0,!1):e.ResetInnerChildrenStyles(!0)}else a.Clear()}}d&&(super._AddUndoItem(u),n[0].OwnerDocPanel.IsChanged=!0),r=d}return r}FormartFontName(e,t){"SetFontName"==this.ActName()&&this.ReSetFontName(e,t)}ReSetFontName(e,t){let n=e.GetInnerText(!0);t.toString(),s.EmrToolBarCommon.GetSuitFontName(t.toString(),n)}_ChangeOneFont(e,t,n){let r=!1;switch(this.ActName()){case"SetFont":case"SetDefaultFont":r=!1;break;case"SetFontName":r=e.FontName!=t.toString(),r&&(e.FontName=t.toString());break;case"SetFontSize":const i=Number(t);e.FontSize=i,e.FontSizeName=n.toString(),r=!0;break;case"SetFontBold":r=e.IsBold!=t,r&&(e.IsBold=!!t);break;case"SetFontItalic":r=e.IsItalic!=t,r&&(e.IsItalic=!!t);break;case"SetFontStrikeout":r=e.IsStrikeout!=t,r&&(e.IsStrikeout=!!t);break;case"SetTextUnderline":r=e.IsUnderline!=t,r&&(e.IsUnderline=!!t)}return r}}t.BaseA_SetFontDetail=h},function(e,t,n){var r=n(18),i=n(1136);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterSetValueIdentifiers=void 0,function(e){e[e.Cp437=0]="Cp437",e[e.ISO8859_1=1]="ISO8859_1",e[e.ISO8859_2=2]="ISO8859_2",e[e.ISO8859_3=3]="ISO8859_3",e[e.ISO8859_4=4]="ISO8859_4",e[e.ISO8859_5=5]="ISO8859_5",e[e.ISO8859_6=6]="ISO8859_6",e[e.ISO8859_7=7]="ISO8859_7",e[e.ISO8859_8=8]="ISO8859_8",e[e.ISO8859_9=9]="ISO8859_9",e[e.ISO8859_10=10]="ISO8859_10",e[e.ISO8859_11=11]="ISO8859_11",e[e.ISO8859_13=12]="ISO8859_13",e[e.ISO8859_14=13]="ISO8859_14",e[e.ISO8859_15=14]="ISO8859_15",e[e.ISO8859_16=15]="ISO8859_16",e[e.SJIS=16]="SJIS",e[e.Cp1250=17]="Cp1250",e[e.Cp1251=18]="Cp1251",e[e.Cp1252=19]="Cp1252",e[e.Cp1256=20]="Cp1256",e[e.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",e[e.UTF8=22]="UTF8",e[e.ASCII=23]="ASCII",e[e.Big5=24]="Big5",e[e.GB18030=25]="GB18030",e[e.EUC_KR=26]="EUC_KR"}(r=t.CharacterSetValueIdentifiers||(t.CharacterSetValueIdentifiers={}));class i{constructor(e,t,n,...r){this.valueIdentifier=e,this.name=n,this.values="number"==typeof t?Int32Array.from([t]):t,this.otherEncodingNames=r,i.VALUE_IDENTIFIER_TO_ECI.set(e,this),i.NAME_TO_ECI.set(n,this);const l=this.values;for(let e=0,t=l.length;e!==t;e++){const t=l[e];i.VALUES_TO_ECI.set(t,this)}for(const e of r)i.NAME_TO_ECI.set(e,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new Error("incorect value");const t=i.VALUES_TO_ECI.get(e);if(void 0===t)throw new Error("incorect value");return t}static getCharacterSetECIByName(e){const t=i.NAME_TO_ECI.get(e);if(void 0===t)throw new Error("incorect value");return t}equals(e){if(!(e instanceof i))return!1;const t=e;return this.getName()===t.getName()}}t.default=i,i.VALUE_IDENTIFIER_TO_ECI=new Map,i.VALUES_TO_ECI=new Map,i.NAME_TO_ECI=new Map,i.Cp437=new i(r.Cp437,Int32Array.from([0,2]),"Cp437"),i.ISO8859_1=new i(r.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),i.ISO8859_2=new i(r.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),i.ISO8859_3=new i(r.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),i.ISO8859_4=new i(r.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),i.ISO8859_5=new i(r.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),i.ISO8859_6=new i(r.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),i.ISO8859_7=new i(r.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),i.ISO8859_8=new i(r.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),i.ISO8859_9=new i(r.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),i.ISO8859_10=new i(r.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),i.ISO8859_11=new i(r.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),i.ISO8859_13=new i(r.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),i.ISO8859_14=new i(r.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),i.ISO8859_15=new i(r.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),i.ISO8859_16=new i(r.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),i.SJIS=new i(r.SJIS,20,"SJIS","Shift_JIS"),i.Cp1250=new i(r.Cp1250,21,"Cp1250","windows-1250"),i.Cp1251=new i(r.Cp1251,22,"Cp1251","windows-1251"),i.Cp1252=new i(r.Cp1252,23,"Cp1252","windows-1252"),i.Cp1256=new i(r.Cp1256,24,"Cp1256","windows-1256"),i.UnicodeBigUnmarked=new i(r.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),i.UTF8=new i(r.UTF8,26,"UTF8","UTF-8"),i.ASCII=new i(r.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),i.Big5=new i(r.Big5,28,"Big5"),i.GB18030=new i(r.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),i.EUC_KR=new i(r.EUC_KR,30,"EUC_KR","EUC-KR")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleIDPrefix=t.EleXsiTypeVals=t.EleTypeCodes=t.EleToolTipShowRuleDefine=t.RulwShowStyle=t.GutterSideVals=t.EleTags=t.XmlNsTags=void 0;const r=n(11);class i{static GetURI(e){let t=null;return null!=e&&("xmlns"!=e?"xsi"==e&&(t="http://www.w3.org/2001/XMLSchema-instance"):t="http://www.w3.org/2000/xmlns/"),t}}t.XmlNsTags=i,i.xmlns="xmlns",i.xsi="xsi";class l{}t.EleTags=l,l.XTextDocument="XTextDocument",l.XElements="XElements",l.Element="Element",l.Attr_EditorVersion="EditorVersion";t.GutterSideVals=class{constructor(){this.Left="Left",this.Top="Top"}static ToENumVal(e){let t,n=r.ENumGutterSide.LEFT;return null==e?(t=n,t):(null!=e&&"Top"==e&&(n=r.ENumGutterSide.TOP,t=n),n=r.ENumGutterSide.LEFT,t=n,t)}};class s{}t.RulwShowStyle=s,s.Default="Default",s.Rectangle="Rectangle";class o{}t.EleToolTipShowRuleDefine=o,o.FollowEleSetting="FollowEleSetting",o.AlwaysHide="AlwaysHide";class a{}t.EleTypeCodes=a,a.InMacroEle="1001",a.InPrescription="1002",a.InPhase="1101",a.InQuoteSource="2001",a.InQuoteTarget="2002",a.InDataBinding="2003",a.InSignature="3001",a.InAdmissionDiagnosis="4001",a.InPreliminaryDiagnosis="4002",a.InSupplementDiagnosis="4003",a.InCorrectionDiagnosis="4004",a.InFinallyDiagnosis="4005",a.InLeaveDiagnosis="4006",a.InClinicDiagnosis="4007",a.InDeathDiagnosis="4008",a.InLabel="5001",a.InText="5002",a.InEmbed="5003",a.InNumber="6001",a.InDate="6002",a.InDropYesNo="7001",a.InDropRadio="7002",a.InDropChkbox="7003",a.InElementData="7004",a.InFlatRadio="8001",a.InFlatChkbox="8002",a.InGroup="9001",a.InBusinessStruct="9002",a.InRef="9003",a.InCommon="9004";class u{}t.EleXsiTypeVals=u,u.XDocHeader="XTextHeader",u.XDocBody="XTextBody",u.XDocFooter="XTextFooter",u.XDocComment="XDocComment",u.XCharacter="XCharacter",u.XString="XString",u.XParagraphFlag="XParagraphFlag",u.XPageBreakLabel="XPageBreakLabel",u.XLable="XLable",u.XLableInputBorder="XLableInputBorder",u.XPageNumInfo="XPageInfo",u.XImage="XImage",u.XInputField="XInputField",u.XTextRadioBox="XTextRadioBox",u.XTextCheckBox="XTextCheckBox",u.XMedicalExpressionField="XMedicalExpressionField",u.XBarcodeField="XBarcodeField",u.XEmptyLineSpace="XEmptyLineSpace",u.XTextTable="XTextTable",u.XTextTableRow="XTextTableRow",u.XTextTableCell="XTextTableCell",u.XTableColumns="Columns",u.XTextTableColumn="XTextTableColumn",u.XComment="XComment",u.XLabelSerno="XLabelSerno",u.XOutlineFoldIcon="XOutlineFoldIcon",u.XSpliteLine="HorizontalLine",u.XFraction="Fraction",u.XShape="Shape",u.DocumentContentStyle="DocumentContentStyle";class h{}t.EleIDPrefix=h,h.XId_Prev="xid-",h.GId_Prev=""},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XLineEleRange=void 0;const r=n(0),i=n(132),l=n(302),s=n(21);class o{constructor(){this.fromLineEle=null,this.toLineEle=null,this.initSelEle=null,this.tmpLineEle=null,this.infoUtil=null,this.fromLineEle=new i.XLineEleIx,this.toLineEle=new i.XLineEleIx,this.initSelEle=new i.XLineEleIx,this.tmpLineEle=new i.XLineEleIx,this.infoUtil=new l.XLineEleRangeUtil(this)}get FromLineEleIx(){return this.fromLineEle}get FromLineEle(){return this.fromLineEle.RefreshEleObj(!1)}get ToLineEleIx(){return this.toLineEle}get ToLineEle(){return this.toLineEle.RefreshEleObj(!1)}get InfoUtil(){return this.infoUtil}get InitSelEleIx(){return this.initSelEle}get InitSelEle(){return this.initSelEle.RefreshEleObj(!1)}Clear(){this.fromLineEle.Clear(),this.toLineEle.Clear(),this.initSelEle.Clear(),this.infoUtil.ClearLastSelRects()}SetFromIx(e){null!=e&&e!=this.FromLineEle&&(this.fromLineEle.SetEle2(e),this.initSelEle.CopyFrom(this.fromLineEle))}SetToIx(e,t=!0){null!=e&&e!=this.ToLineEle&&this.fromLineEle.IsValid()&&this.toLineEle.SetEle2(e)}IsForward(){let e;if(this.IsValid()){e=(null==this.fromLineEle?-1:this.fromLineEle.CompareTo(this.toLineEle))<=0}else e=!0;return e}IsValid(){return null!=this.fromLineEle&&null!=this.toLineEle&&this.fromLineEle.IsValid()&&this.toLineEle.IsValid()}SortFromToIx(){let e=o.SortFromToLineEleIx(this.fromLineEle,this.toLineEle);this.fromLineEle=e[0],this.toLineEle=e[1]}IsEleInRange(e){let t;if(null!=e&&this.IsValid())if(this.tmpLineEle.SetEle2(e),this.tmpLineEle.IsValid()){let e=this.tmpLineEle.CompareTo(this.fromLineEle),n=this.tmpLineEle.CompareTo(this.toLineEle),r=e>=0&&n<=0;r||(r=r||e<=0&&n>=0),t=r}else t=!1;else t=!1;return t}static SortFromToLineEleIx(e,t){let n,r=[e,t];if(null==e&&null==t)n=r;else{if((null==e?-1:e.CompareTo(t))<=0)n=r;else{let e=r[0];r[0]=r[1],r[1]=e,n=r}}return n}BuildEleRangeAsText(e){let t;if(t=null!=e&&e.length>0?e:this.InfoUtil.GetLineElesInRange(!0,!0),null==t||t.length<1)return null;let n=new s.default;for(let e=0;e<t.length;e++){let r=t[e];r.EleStyle.DeleterIndex<0&&n.append(r.GetInnerText(!1))}return n.toString()}BuildEleRangeAsTextWithNotBorder(e){let t;if(t=null!=e&&e.length>0?e:this.InfoUtil.GetLineElesInRange(!0,!0),null==t||t.length<1)return null;let n=new s.default;for(let e=0;e<t.length;e++){let i=t[e];i instanceof r.XInputBorderEle||i.EleStyle.DeleterIndex<0&&n.append(i.GetInnerText(!1))}return n.toString()}}t.XLineEleRange=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParagraphListStyleVals=void 0;const r=n(3),i=n(36);class l{static IsNoneListStyle(e){return i.StringUtils.IsNullOrEmpty(e)||i.StringUtils.Equals(e,"None")}static GetShowListStyleVals(){let e=new r.Dictionary,t=["None","ListNumberStyle","ListNumberStyleArabic1","ListNumberStyleArabic2","ListNumberStyleNumberInCircle","ListNumberStyleLowercaseLetter","ListNumberStyleLowercaseRoman","ListNumberStyleSimpChinNum1","ListNumberStyleSimpChinNum2","ListNumberStyleTradChinNum1","ListNumberStyleTradChinNum2","ListNumberStyleZodiac1","ListNumberStyleZodiac2"];for(let n=0;n<t.length;n++){let r=t[n];e.Add(r,l.GetShowVal(r))}return e}static GetListStyleSpliteChars(){}static GetShowVal(e){let t=null;switch(e){case"None":t="无";break;case"ListNumberStyle":t="1. 2. 3. ";break;case"ListNumberStyleArabic1":t="1, 2, 3, ";break;case"ListNumberStyleArabic2":t="1) 2) 3) ";break;case"ListNumberStyleNumberInCircle":t="① ② ③ ";break;case"ListNumberStyleLowercaseLetter":t="a) b) c) ";break;case"ListNumberStyleLowercaseRoman":t="i) ii) iii) ";break;case"ListNumberStyleSimpChinNum1":t="一、 二、 三、一、 二、 三、";break;case"ListNumberStyleSimpChinNum2":t="一） 二） 三） ";break;case"ListNumberStyleTradChinNum1":t="壹、 贰、 叁、 ";break;case"ListNumberStyleTradChinNum2":t="壹） 贰） 叁） ";break;case"ListNumberStyleZodiac1":t="甲， 乙， 丙， ";break;case"ListNumberStyleZodiac2":t="子， 丑， 寅， ";break;case"BulletedList":t="● BulletedList";break;case"BulletedListBlock":t="■ BulletedListBlock";break;case"BulletedListDiamond":t="◆ BulletedListDiamond";break;case"BulletedListCheck":t="✔ BulletedListCheck";break;case"BulletedListRightArrow":t=" BulletedListRightArrow";break;case"BulletedListHollowStar":t="✧ BulletedListHollowStar"}return t}}t.ParagraphListStyleVals=l,l.None="None",l.ListNumberStyle="ListNumberStyle",l.ListNumberStyleArabic1="ListNumberStyleArabic1",l.ListNumberStyleArabic2="ListNumberStyleArabic2",l.ListNumberStyleNumberInCircle="ListNumberStyleNumberInCircle",l.ListNumberStyleLowercaseLetter="ListNumberStyleLowercaseLetter",l.ListNumberStyleLowercaseRoman="ListNumberStyleLowercaseRoman",l.ListNumberStyleSimpChinNum1="ListNumberStyleSimpChinNum1",l.ListNumberStyleSimpChinNum2="ListNumberStyleSimpChinNum2",l.ListNumberStyleTradChinNum1="ListNumberStyleTradChinNum1",l.ListNumberStyleTradChinNum2="ListNumberStyleTradChinNum2",l.ListNumberStyleZodiac1="ListNumberStyleZodiac1",l.ListNumberStyleZodiac2="ListNumberStyleZodiac2",l.BulletedList="BulletedList",l.BulletedListBlock="BulletedListBlock",l.BulletedListDiamond="BulletedListDiamond",l.BulletedListCheck="BulletedListCheck",l.BulletedListRightArrow="BulletedListRightArrow",l.BulletedListHollowStar="BulletedListHollowStar"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SmoothingMode=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Default=0]="Default",e[e.HighSpeed=1]="HighSpeed",e[e.HighQuality=2]="HighQuality",e[e.None=3]="None",e[e.AntiAlias=4]="AntiAlias"}(t.SmoothingMode||(t.SmoothingMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TKID=t.TKTYPE=t.Token=void 0;t.Token=class{constructor(e,t,n){this.Value=e,this.ID=t,this.Type=n}},function(e){e[e.COMPARE=0]="COMPARE",e[e.ADDSUB=1]="ADDSUB",e[e.MULDIV=2]="MULDIV",e[e.POWER=3]="POWER",e[e.GROUP=4]="GROUP",e[e.LITERAL=5]="LITERAL",e[e.IDENTIFIER=6]="IDENTIFIER",e[e.ASSIGN=7]="ASSIGN",e[e.SEMI=8]="SEMI"}(t.TKTYPE||(t.TKTYPE={})),function(e){e[e.GT=0]="GT",e[e.LT=1]="LT",e[e.GE=2]="GE",e[e.LE=3]="LE",e[e.EQ=4]="EQ",e[e.NE=5]="NE",e[e.ADD=6]="ADD",e[e.SUB=7]="SUB",e[e.MUL=8]="MUL",e[e.DIV=9]="DIV",e[e.DIVINT=10]="DIVINT",e[e.MOD=11]="MOD",e[e.POWER=12]="POWER",e[e.OPEN=13]="OPEN",e[e.CLOSE=14]="CLOSE",e[e.END=15]="END",e[e.COMMA=16]="COMMA",e[e.PERIOD=17]="PERIOD",e[e.ATOM=18]="ATOM",e[e.ASSIGN=19]="ASSIGN",e[e.VAR=20]="VAR",e[e.SEMI=21]="SEMI"}(t.TKID||(t.TKID={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetHAlignBase=void 0;const r=n(2),i=n(0),l=n(131),s=n(3),o=n(825),a=n(13),u=n(1);class h extends u.XBaseAction{constructor(){super(),this.isHAlignChanged=!1,super.OpType=r.ENumActOpType.StyleEdit}get IsHAlignChanged(){return this.isHAlignChanged}Execute(e){this.resMsg.Clear();let t,n,r=null,i=null==e?0:e.length,l=e[0];if(i>=2&&(r=e[1]),t=null==r?this._GetArrParaghOfSelLines():this._GetArrParaghOfContainer(r),null==t||0==t.length)this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName+" 命令没有定位有效的段落。",n=this.resMsg;else{let e=new a.UndoGroup;this.isHAlignChanged=!1;let r=t;for(let t=0;t<r.length;t++){let n=r[t];const i=this._ChangeOneParaghHAlign(n,l,e);this.isHAlignChanged=this.isHAlignChanged||i}this.isHAlignChanged&&(super._AddUndoItem(e),super._RefreshPageAndMoveCaret(!0,!0)),n=this.resMsg}return n}_GetArrParaghOfSelLines(){let e=super.GetEdtCtrl(),t=e.M_EleEvtModel,n=new s.List,r=e.M_EleEvtModel.SelRange;if(null!=r&&r.IsValid()){let e=r.InfoUtil.GetLineParaghFlagsInRange();n.AddRange(e)}else{let e=t.EleClickedWrap.LineEleIxFocused.Line;n.Add(e.RelEleParagraph)}let i=n.ToArray();return n.Clear(),i}_GetArrParaghOfContainer(e){let t;if(null==e)t=null;else{let n=new s.List,r=e.GetChildIter();for(;r.MoveNext();){let e=r.Current instanceof i.XParagraphFlag?r.Current:null;null!=e&&n.Add(e)}let l=n.ToArray();n.Clear(),t=l}return t}_ChangeOneParaghHAlign(e,t,n){let r,i=e.ParaghStyle,s=i.HAlign_ENumVal;if(t==s)r=!1;else{i.HAlign_ENumVal=t,(l.StyleHAlignVals.IsUnusualHAlign(s)||l.StyleHAlignVals.IsUnusualHAlign(t))&&e.NotifyLayoutChanged(!0,!1);let a=new o.HAlignUndo(i,s);n.AddItem(a),r=!0}return r}}t.A_SetHAlignBase=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontInfo=void 0;const r=n(4);t.FontInfo=class{get FontName(){return this.fontName}set FontName(e){this.fontName=e}get FontSize(){return this.fontSize}set FontSize(e){this.fontSize=e}get FontSizeName(){return this.fontSizeName}set FontSizeName(e){this.fontSizeName=e}get IsDrawDeleteLine(){return this.isDrawDeleteLine}set IsDrawDeleteLine(e){this.isDrawDeleteLine=e}get IsDrawUnderLine(){return this.isDrawUnderLine}set IsDrawUnderLine(e){this.isDrawUnderLine=e}get IsBold(){return this.isBold}set IsBold(e){this.isBold=e}get IsItatlic(){return this.isItatlic}set IsItatlic(e){this.isItatlic=e}InitFontInfo(){this.FontName="",this.FontSize=0,this.IsDrawDeleteLine=!1,this.IsDrawUnderLine=!1,this.IsBold=!1,this.IsItatlic=!1}Equals(e){let t=e;return null!=t&&t.FontName==this.FontName&&t.FontSize==this.FontSize&&t.IsBold==this.IsBold&&t.IsItatlic==this.IsItatlic&&t.IsDrawDeleteLine==this.IsDrawDeleteLine&&t.IsDrawUnderLine==this.IsDrawUnderLine}GetHashCode(){return r.default.GetHashCode(this.FontName)+r.default.GetHashCode(this.IsDrawDeleteLine.toString())+r.default.GetHashCode(this.IsBold.toString())+r.default.GetHashCode(this.IsDrawUnderLine.toString())+r.default.GetHashCode(this.IsItatlic.toString())}Intersect(e){this.IsBold=this.IsBold==e.IsBold&&this.IsBold,this.IsItatlic=this.IsItatlic==e.IsItatlic&&this.IsItatlic,this.IsDrawDeleteLine=this.IsDrawDeleteLine==e.IsDrawDeleteLine&&this.IsDrawDeleteLine,this.IsDrawUnderLine=this.IsDrawUnderLine==e.IsDrawUnderLine&&this.IsDrawUnderLine,this.FontSize=this.FontSize==e.FontSize?this.FontSize:0,this.FontName=this.FontName==e.FontName?this.FontName:""}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBuilderFactory=t.XPagePanelViewBuilder=t.TableCellViewBuilder=t.XPageViewBuilder=t.TableViewBuilder=t.XBaseViewBuilder=void 0;var r=n(929);Object.defineProperty(t,"XBaseViewBuilder",{enumerable:!0,get:function(){return r.XBaseViewBuilder}});var i=n(381);Object.defineProperty(t,"TableViewBuilder",{enumerable:!0,get:function(){return i.TableViewBuilder}});var l=n(246);Object.defineProperty(t,"XPageViewBuilder",{enumerable:!0,get:function(){return l.XPageViewBuilder}});var s=n(933);Object.defineProperty(t,"TableCellViewBuilder",{enumerable:!0,get:function(){return s.TableCellViewBuilder}});var o=n(382);Object.defineProperty(t,"XPagePanelViewBuilder",{enumerable:!0,get:function(){return o.XPagePanelViewBuilder}});var a=n(934);Object.defineProperty(t,"XBuilderFactory",{enumerable:!0,get:function(){return a.XBuilderFactory}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77);t.default=function(e,t){"textLayer"===t?(r.css(e.kssTextLayer,{zIndex:99}),r.css(e.rectangleCanvas,{zIndex:98})):"canvasLayer"===t&&(r.css(e.rectangleCanvas,{zIndex:99}),r.css(e.kssTextLayer,{zIndex:98}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(114);class i{static decode(e,t){const n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):"undefined"==typeof TextDecoder||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)}static shouldDecodeOnFallback(e){return!i.isBrowser()&&"ISO-8859-1"===e}static encode(e,t){const n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):"undefined"==typeof TextEncoder?this.encodeFallback(e):(new TextEncoder).encode(e)}static isBrowser(){return"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)}static encodingName(e){return"string"==typeof e?e:e.getName()}static encodingCharacterSet(e){return e instanceof r.default?e:r.default.getCharacterSetECIByName(e)}static decodeFallback(e,t){const n=this.encodingCharacterSet(t);if(i.isDecodeFallbackSupported(n)){let t="";for(let n=0,r=e.length;n<r;n++){let r=e[n].toString(16);r.length<2&&(r="0"+r),t+="%"+r}return decodeURIComponent(t)}if(n.equals(r.default.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new Error(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(r.default.UTF8)||e.equals(r.default.ISO8859_1)||e.equals(r.default.ASCII)}static encodeFallback(e){const t=btoa(unescape(encodeURIComponent(e))).split(""),n=[];for(let e=0;e<t.length;e++)n.push(t[e].charCodeAt(0));return new Uint8Array(n)}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DashStyle=void 0,function(e){e[e.Solid=0]="Solid",e[e.Dash=1]="Dash",e[e.Dot=2]="Dot",e[e.DashDot=3]="DashDot",e[e.DashDotDot=4]="DashDotDot",e[e.Custom=5]="Custom"}(t.DashStyle||(t.DashStyle={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(127);class i extends r.default{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const n=this.delegate.getRow(e,t),r=this.getWidth();for(let e=0;e<r;e++)n[e]=255-(255&n[e]);return n}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(t);for(let r=0;r<t;r++)n[r]=255-(255&e[r]);return n}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,n,r){return new i(this.delegate.crop(e,t,n,r))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new i(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new i(this.delegate.rotateCounterClockwise45())}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(21);t.default=class{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,n,i){throw new r.UnsupportedOperationException("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new r.UnsupportedOperationException("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new r.UnsupportedOperationException("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new i.default;for(let n=0;n<this.height;n++){const r=this.getRow(n,e);for(let e=0;e<this.width;e++){const n=255&r[e];let i;i=n<64?"#":n<128?"+":n<192?".":" ",t.append(i)}t.append("\n")}return t.toString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,r,i=-1,l=-1){this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=r,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=l,this.numBits=null==e?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(101),l=n(153);t.default=class{constructor(e){this.field=e}decode(e,t){const n=this.field,s=new l.default(n,e),o=new Int32Array(t);let a=!0;for(let e=0;e<t;e++){const t=s.evaluateAt(n.exp(e+n.getGeneratorBase()));o[o.length-1-e]=t,0!==t&&(a=!1)}if(a)return;const u=new l.default(n,o),h=this.runEuclideanAlgorithm(n.buildMonomial(t,1),u,t),d=h[0],c=h[1],p=this.findErrorLocations(d),f=this.findErrorMagnitudes(c,p);for(let t=0;t<p.length;t++){const l=e.length-1-n.log(p[t]);if(l<0)throw new r.ReedSolomonException("Bad error location");e[l]=i.default.addOrSubtract(e[l],f[t])}}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){const n=e;e=t,t=n}const i=this.field;let l=e,s=t,o=i.getZero(),a=i.getOne();for(;s.getDegree()>=(n/2|0);){let e=l,t=o;if(l=s,o=a,l.isZero())throw new r.ReedSolomonException("r_{i-1} was zero");s=e;let n=i.getZero();const u=l.getCoefficient(l.getDegree()),h=i.inverse(u);for(;s.getDegree()>=l.getDegree()&&!s.isZero();){const e=s.getDegree()-l.getDegree(),t=i.multiply(s.getCoefficient(s.getDegree()),h);n=n.addOrSubtract(i.buildMonomial(e,t)),s=s.addOrSubtract(l.multiplyByMonomial(e,t))}if(a=n.multiply(o).addOrSubtract(t),s.getDegree()>=l.getDegree())throw new r.IllegalStateException("Division algorithm failed to reduce polynomial?")}const u=a.getCoefficient(0);if(0===u)throw new r.ReedSolomonException("sigmaTilde(0) was zero");const h=i.inverse(u);return[a.multiplyScalar(h),s.multiplyScalar(h)]}findErrorLocations(e){const t=e.getDegree();if(1===t)return Int32Array.from([e.getCoefficient(1)]);const n=new Int32Array(t);let i=0;const l=this.field;for(let r=1;r<l.getSize()&&i<t;r++)0===e.evaluateAt(r)&&(n[i]=l.inverse(r),i++);if(i!==t)throw new r.ReedSolomonException("Error locator degree does not match number of roots");return n}findErrorMagnitudes(e,t){const n=t.length,r=new Int32Array(n),i=this.field;for(let l=0;l<n;l++){const s=i.inverse(t[l]);let o=1;for(let e=0;e<n;e++)if(l!==e){const n=i.multiply(t[e],s),r=0==(1&n)?1|n:-2&n;o=i.multiply(o,r)}r[l]=i.multiply(e.evaluateAt(s),i.inverse(o)),0!==i.getGeneratorBase()&&(r[l]=i.multiply(r[l],s))}return r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBasePropList=void 0;const r=n(160);t.XBasePropList=class{constructor(){this.propList=null,this.propList=new r.XPropertyCollection}get XmlEleName(){return this.propList.XmlEleName}set XmlEleName(e){this.propList.XmlEleName=e}Clear(){this.propList.Clear()}ToXML(e){if(null==this.propList||this.propList.IsEmpty())return null;return this.propList.ToXML(e)}FromXML(e){null==e?this.propList.Clear():this.propList.FromXML(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleHAlignVals=void 0;const r=n(11);class i{static IsUnusualHAlign(e){return e==r.ENumHAlignStyle.BothEnds||e==r.ENumHAlignStyle.Scattered}static GetHAlignStrVal(e){let t=null;switch(e){case r.ENumHAlignStyle.LEFT:t="Left";break;case r.ENumHAlignStyle.CENTER:t="Center";break;case r.ENumHAlignStyle.RIGHT:t="Right";break;case r.ENumHAlignStyle.BothEnds:t="BothEnds";break;case r.ENumHAlignStyle.Scattered:t="Scattered"}return t}static GetEnumHAlign(e){let t;if(null==e)return t=r.ENumHAlignStyle.BothEnds,t;let n=r.ENumHAlignStyle.NONE;return null!=e&&("Left"!=e?"Center"!=e?"Right"!=e?"BothEnds"!=e?"Scattered"==e&&(n=r.ENumHAlignStyle.Scattered):n=r.ENumHAlignStyle.BothEnds:n=r.ENumHAlignStyle.RIGHT:n=r.ENumHAlignStyle.CENTER:n=r.ENumHAlignStyle.LEFT),t=n,t}}t.StyleHAlignVals=i,i.None="",i.Left="Left",i.Center="Center",i.Right="Right",i.BothEnds="BothEnds",i.Scattered="Scattered"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XLineEleIx=void 0;const r=n(0),i=n(302),l=n(17),s=n(59);t.XLineEleIx=class{constructor(e){this.eleObj=null,this.line=null,this.eleIx=-1,this.atRightHalf=!1,this.markEle=null,this.CopyFrom(e)}get Line(){return this.RefreshLineEle(),this.line}get LineContainer(){let e=this.Line;return null==e?null:e.Container}get LineIx(){let e=this.Line;return null==e?-1:e.Index}get EleIx(){return this.RefreshLineEle(),this.eleIx}get AtRightHalf(){return this.atRightHalf}set AtRightHalf(e){this.atRightHalf=e}get MarkEle(){return this.markEle}set MarkEle(e){this.markEle=e}Clear(){this.line=null,this.eleIx=-1,this.eleObj=null,this.atRightHalf=!1}RefreshLineEle(){(null==this.line||this.line.ElementCnt<=0)&&this.SetEle2(this.eleObj)}IsValid(){return this.RefreshLineEle(),null!=this.line&&this.line.ElementCnt>0&&this.eleIx>=0}RefreshEleObj(e){return null==this.line||!e&&null!=this.eleObj||(this.eleObj=this.line.GetEleByInx(this.eleIx)),this.eleObj}SetEle1(e,t){this.line=e,this.eleIx=t,this.eleObj=null,this.atRightHalf=!1}SetEle2(e){null==e?this.Clear():(this.line=e.OwnerLine,this.eleIx=null==this.line?-1:this.line.IndexOfElement(e),this.eleObj=e,this.atRightHalf=!1)}ReplaceEle(e){null!=e&&(this.line=null,this.eleIx=-1,this.eleObj=e,this.atRightHalf=!1)}_GetNextEle(e,t,n,i=!0){let l;if(null==this.line)l=null;else{let s,o;if(e)if(this.eleIx<this.line.ElementCnt-1)s=this.line,o=this.eleIx+1;else{let i=this._TryGet_NextEle_AfterTable(this.eleObj instanceof r.XTextTableCell?this.eleObj:null);if(null!=i){if(n){i=null==(i.Parent instanceof r.XStringEle?i.Parent:null)?null:i instanceof r.XCharacterEle?i:null}return l=i,l}s=t?this.line:this._GetNextLine(e),o=t?2147483647:0}else if(this.eleIx>=1)s=this.line,o=this.eleIx-1;else{s=t?this.line:this._GetNextLine(e),o=t||null==s?0:s.ElementCnt-1;let a=null==s?null:s.GetEleByInx(o);if(a=this._TryGet_NextEle_AfterTable(a instanceof r.XTextTableCell?a:null,i),null!=a){if(n){a=null==(a.Parent instanceof r.XStringEle?a.Parent:null)?null:a instanceof r.XCharacterEle?a:null}return l=a,l}}let a=null,u=null==s?0:s.ElementCnt;if(u>0&&(o<0?o=0:o>=u&&(o=u-1),a=s.GetEleByInx(o),null!=a&&a.IsRemoved&&(a=null),n&&null!=a)){a=null==(a.Parent instanceof r.XStringEle?a.Parent:null)?null:a instanceof r.XCharacterEle?a:null}l=a}return l}_TryGet_NextEle_AfterTable(e,t=!0){let n;if(null==e)n=null;else if(r.XDomUtil.IsEndCellOfXTable(e,!0,!0,t)){let t=r.XDomUtil.GetXTableOfCell(e),i=t.OwnerLine;if(t==i.LastElement)n=null;else{n=i.GetNextEle(t)}}else n=null;return n}_GetNextLine(e){let t;if(null==this.line)t=null;else{t=i.XLineEleRangeUtil.GetNextLine2(this.line,e)}return t}_MovetoNextEle(e){let t;if(null==this.line)t=!1;else{let n=!0;if(e)if(this.eleIx<this.line.ElementCnt-1)this.eleIx++;else{let e=this._TryGet_NextEle_AfterTable(this.eleObj instanceof r.XTextTableCell?this.eleObj:null);if(null!=e)this.SetEle2(e),n=!0;else if(n=this._MovetoNextLine(!0,l.PointF.Empty),n){e=this.RefreshEleObj(!1);let t=e instanceof r.XTextTableCell?e:null;null!=t&&(this.line=t.GetFirstLine(),this.eleIx=0)}}else if(this.eleIx>=1)this.eleIx--;else{n=this._MovetoNextLine(!1,l.PointF.Empty);let e=this.RefreshEleObj(!1);e=this._TryGet_NextEle_AfterTable(e instanceof r.XTextTableCell?e:null),null!=e&&(this.SetEle2(e),n=!0)}n&&(this.eleObj=null,this.atRightHalf=!1,this.RefreshEleObj(!0)),t=n}return t}_MovetoNextLine(e,t){let n;if(null==this.line)n=!1;else{if(null==this.LineContainer)n=!1;else{let r=this._GetNextLine(e);if(null==r)n=!1;else{if(this.line=r,l.PointF.Empty.equals(t))this.eleIx=e?0:r.ElementCnt-1,this.eleObj=null;else{let e=new s.ClickedElementWrapper(!1);const n=r.X+t.X,i=r.Y+t.Y;r.LineAssist.GetEleAtPos(n,i,300,e,!0),null!=e.EleFocused&&this.SetEle2(e.EleFocused)}this.atRightHalf=!1,n=!0}}}return n}CopyFrom(e){null!=e&&e.IsValid()&&(this.SetEle1(e.line,e.eleIx),this.eleObj=e.RefreshEleObj(!1),this.atRightHalf=!1)}CompareTo(e){let t;if(null==this.line)t=-1;else if(null==e||null==e.line)t=1;else{let n=this.line.CmprByLineInx(e.line);0!=n?t=n:(n=this.eleIx-e.eleIx,t=0!=n?n:0)}return t}SetEle(e){null==e?this.Clear():(this.line=e.OwnerLine,this.eleIx=null==this.line?-1:this.line.IndexOfElement(e),this.eleObj=e,this.atRightHalf=!1)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCodeUtil=void 0;const r=n(34),i=n(25),l=n(593),s=n(629),o=n(4),a=n(292),u=n(51),h=n(83),d=n(107);class c{constructor(){this.InitCodeUtil()}static GetInstance(){return null==c._instance&&(c._instance=new c),c._instance}get QRcodeStyleList(){return this._qRcodeStyleList}get BarcodeStyleList(){return this._barcodeStyleList}get BarcodeErrorInfo(){return this._barcodeErrorInfo}set BarcodeErrorInfo(e){this._barcodeErrorInfo=e}get QRcodeErrorInfo(){return this._qrcodeErrorInfo}GetBarCodeDefaultShowSize(e,t){let n=t>0?t:74;return n=Math.min(n,740),new i.SizeF(24*e,n)}GetQrCodeSizeF(e,t){return new i.SizeF(84,84)}InitCodeUtil(){this._barcode=new l.BarCodes1D,this._barcode.TextVisible=!0,this._barcode.Multiplier=7,this._barcode.AutoSize=!0,this._barcode.TextAlignment="center",this._barcode.Font=new u.Font("微软雅黑",16)}GetBarCodeTypeByStr(e){o.default.IsNullOrEmpty(e)&&(e="Code128B");return d.InsertElementBack.getBarCodeType(e)}GetQrCodeTypeByStr(e){o.default.IsNullOrEmpty(e)&&(e="QR_CODE");return d.InsertElementBack.getQRCodeType(e)}SetBarCodeTextVisible(e){this._barcode.TextVisible=e}BuildQRcode(e){let t;if(o.default.IsNullOrEmpty(e))return t=null,t;e=e.replace("</Br>","\r\n");let n=this.GetQrCodeSizeF();const r=new a.BrowserQRCodeSvgWriter;r.setMargin=0;const i=r.write(e,n.Width,n.Height);let l=(new XMLSerializer).serializeToString(i);return l=window.btoa(l),t=h.XImageUtil.Base64ToImage("data:image/svg+xml;base64,"+l),t}BuildQRcodeBase64(){return"data:image/svg+xml;base64"}SetBarCodeAlgliment(e){o.default.IsNullOrEmpty(e)&&(e="Center")}GetSuitMultipler(e){let t=1;for(let n=1;n<=15;n++){if(this._barcode.Multiplier=n,this._barcode.Size.Width>=e.Width){t=n;break}15==n&&(t=15)}return t}BuildBarcode(e,t,n,i,l,a,u=!0){let h;if(o.default.IsNullOrEmpty(t))h=null;else{let o=new s.BulidCodeResultInfo;if(this._barcode.BackColor=a,this._barcode.ForeColor=l,this._barcode.UseTestData=!1,this._barcode.Symbology=e,this._barcode.BarcodeData=t,this._barcode.TextVisible=u,this._barcode.IsValidBarcode()){let e,t=this.GetBarCodeDefaultShowSize(n,i),r=this.GetSuitMultipler(t);this._barcode.Multiplier=r,i>0&&(this._barcode.Size.Height=i);try{e=this._barcode.SaveToBitmap()}catch(t){e=null,this.BarcodeErrorInfo=t}o.Image=e,h=o}else this._barcodeErrorInfo=r.Symbology[e].toString(),o.IsException=!0,h=o}return h}}t.XCodeUtil=c},function(e,t,n){"use strict";var r;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var l=t.SET_A=0,s=t.SET_B=1,o=t.SET_C=2,a=(t.SHIFT=98,t.START_A=103),u=t.START_B=104,h=t.START_C=105;t.MODULO=103,t.STOP=106,t.FNC1=207,t.SET_BY_CODE=(i(r={},a,l),i(r,u,s),i(r,h,o),r),t.SWAP={101:l,100:s,99:o},t.A_START_CHAR=String.fromCharCode(208),t.B_START_CHAR=String.fromCharCode(209),t.C_START_CHAR=String.fromCharCode(210),t.A_CHARS="[\0-_È-Ï]",t.B_CHARS="[ -È-Ï]",t.C_CHARS="(Ï*[0-9]{2}Ï*)",t.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SIDE_BIN="101",t.MIDDLE_BIN="01010",t.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},t.EAN2_STRUCTURE=["LL","LG","GL","GG"],t.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],t.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(135);t.default=function(e,t,n){var i=e.split("").map((function(e,n){return r.BINARIES[t[n]]})).map((function(t,n){return t?t[e[n]]:""}));if(n){var l=e.length-1;i=i.map((function(e,t){return t<l?e+n:e}))}return i.join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(66);var s=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"encode",value:function(){for(var e="110",t=0;t<this.data.length;t++){var n=parseInt(this.data[t]).toString(2);n=o(n,4-n.length);for(var r=0;r<n.length;r++)e+="0"==n[r]?"100":"110"}return{data:e+="1001",text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]+$/)}}]),t}(((r=l)&&r.__esModule?r:{default:r}).default);function o(e,t){for(var n=0;n<t;n++)e="0"+e;return e}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleRangeAddDelUndo=void 0;const r=n(0),i=n(23);class l extends i.IXUndoable{constructor(e,t,n){super(),this.paEle=null,this.fromPos=-1,this.arrChildEles=null,this.isCaretVisible=!0,this.cursorUndoEle=null,this.cursorRedoEle=null,this.isAdd=!0,this.paEle=null==e||0==e.length?null:e[0].Parent,this.arrChildEles=e,this.fromPos=t,this.isAdd=n}get IsCaretVisible(){return this.isCaretVisible}get CursorUndoEle(){return this.cursorUndoEle}set CursorUndoEle(e){this.cursorUndoEle=r.XDomUtil.GetBaseElement(e)}get CursorRedoEle(){return this.cursorRedoEle}set CursorRedoEle(e){this.cursorRedoEle=e}IsValid(){return null!=this.paEle&&this.fromPos>=0}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){this.CanUndo()&&(this.isAdd?(this.isCaretVisible=!0,this.paEle.RemoveChildrenWithRange(this.fromPos,this.arrChildEles.length)):(this.isCaretVisible=!1,this.paEle.AddChildrenEle(this.fromPos,this.arrChildEles)))}Redo(){this.CanRedo()&&(this.isCaretVisible=!0,this.isAdd?this.paEle.AddChildrenEle(this.fromPos,this.arrChildEles):this.paEle.RemoveChildrenWithRange(this.fromPos,this.arrChildEles.length))}Clear(){this.paEle=null,this.arrChildEles=null,this.fromPos=-1}}t.EleRangeAddDelUndo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;const r=n(12);n(632);class i extends r.PureComponent{constructor(e){super(e),this.buttonRef=r.createRef(),this.handleKeyDown=e=>{const{onKeyDown:t}=this.props;t&&t(e),13==e.which&&this.handleClick(e)}}handleClick(e){const{onClick:t}=this.props;t&&t(e)}handleKeyUp(e){const{onKeyUp:t}=this.props;"function"==typeof t&&t(e),13==e.which&&this.handleClick(e)}render(){const{text:e,type:t,id:n,style:i,width:l,height:s,onKeyUp:o}=this.props;let a=l+"px",u=s+"px",h=Object.assign({width:a,height:u},i);return r.createElement("button",{id:n,ref:this.buttonRef,className:"pango-editor-text-button button-"+t,style:h,onClick:e=>this.handleClick(e),onKeyUp:e=>this.handleKeyUp(e),onKeyDown:this.handleKeyDown},e,this.props.suffixIcon?r.createElement("i",{className:"suffixIcon "+this.props.suffixIcon}):"")}}t.Button=i,i.defaultProps={onClick:()=>{},text:"确定",type:"primary",style:{},id:"",width:60,height:32,suffixIcon:"",allowEnter:!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageFormat=void 0;const r=n(82),i=n(10);class l{constructor(e){this.PunchPaper_RowHeightMM=12.7,this.CmmtAreaWidth=192,this.isStrip=!1,this.isPunchPaper=!1,this.isBigPage=!1,this.ppSzNo=null,this.landscape=!1,this.paperFeedHoriz=null,this.useVisionVal=!1,this.width=500,this.height=800,this.showCmmtArea=!1,this.useVisionVal=e,this.landscape=!1,this.paperFeedHoriz=null,this.padding=new r.Padding(20,20,20,20)}get IsStrip(){return this.isStrip}set IsStrip(e){this.isStrip=e}get IsPunchPaper(){return this.isPunchPaper}set IsPunchPaper(e){this.isPunchPaper=e}get IsStripOrPunchPaper(){return this.isStrip||this.isPunchPaper}get IsBigPage(){return this.isBigPage}set IsBigPage(e){this.isBigPage=e}get PpSzNo(){return this.ppSzNo}set PpSzNo(e){"Custom"==e&&(e="CustomQI"),this.ppSzNo=e}get Landscape(){return this.landscape}set Landscape(e){this.landscape=e}get PaperFeedHoriz(){return this.paperFeedHoriz}set PaperFeedHoriz(e){this.paperFeedHoriz=e}get UseVisionVal(){return this.useVisionVal}get Width(){return this.width}set Width(e){this.width=e}get Height(){return this.height}set Height(e){this.height=e}get ShowCmmtArea(){return this.showCmmtArea}set ShowCmmtArea(e){this.showCmmtArea=e}newPageFormat1(e){let t=new l;return t.useVisionVal=e,t.landscape=!1,t.paperFeedHoriz=null,t.padding=new r.Padding(20,20,20,20),t}newPageFormat2(e,t,n){let r=new l;return r.useVisionVal=e,r.landscape=!1,r.paperFeedHoriz=null,r.padding=i.DPITransUtil.TransPadding(t,n,96),r}newPageFormat3(e,t){}SetSize(e,t,n){n<=0||96==n?(this.width=parseInt(e+.5+""),this.height=parseInt(t+.5+"")):(this.width=parseInt(96*e/n+.5+""),this.height=parseInt(96*t/n+.5+""))}static GetCmmtAreaWidth(e){let t=192;return e>0&&96!=e&&(t=parseInt(t*e/96+"")),t}GetPadding(){return this.padding}SetPadding(e,t){t<=0||96==t?this.padding=e:(this.padding.Left=parseInt(96*e.Left/t+.5+""),this.padding.Top=parseInt(96*e.Top/t+.5+""),this.padding.Right=parseInt(96*e.Right/t+.5+""),this.padding.Bottom=parseInt(96*e.Bottom/t+.5+""))}}t.PageFormat=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XUserInfo=void 0;const r=n(4);t.XUserInfo=class{constructor(){this.usrId=null,this.usrName=null,this.permLv=0}get UsrId(){return this.usrId}set UsrId(e){this.usrId=e}get UsrName(){return this.usrName}set UsrName(e){this.usrName=e}get PermissionLv(){return this.permLv}set PermissionLv(e){this.permLv=e}Clear(){this.usrId=null,this.usrName=null,this.permLv=0}IsValid(){return!r.default.IsNullOrEmpty(this.usrName)&&this.permLv>0}CopyFrom(e){null!=e&&(this.usrId=e.usrId,this.usrName=e.usrName,this.permLv=e.permLv)}static Equals(e,t){return e==t||null!=e&&null!=t&&e==t}Equals(e){let t;if(this==e)t=!0;else{let n=e;t=null!=n&&this.usrId==n.usrId&&this.usrName==n.usrName&&this.permLv==n.permLv}return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetWorkModeBase=void 0;const r=n(2),i=n(1),l=n(2),s=n(6),o=n(0),a=n(7);class u extends i.XBaseAction{A_SetWorkModeBase(){super.OpType=r.ENumActOpType.Other}Execute(e){let t;if(this.resMsg.Clear(),null==e||e.length<1)this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName+" 调用参数有误",t=this.resMsg;else{let n=l.ENumWorkMode[e[0]];const r=super.GetEdtCtrl();r.MShowAsPrint=!1,r.IsPrintview=!1,r.unfocus=!0;const i=r.M_EleEvtModel.WorkMode;r.M_EleEvtModel.WorkMode=l.ENumWorkMode[n];const o=r.All_Document;if(null!=o&&(i==l.ENumWorkMode.KeepTrace||l.ENumWorkMode[n]==l.ENumWorkMode.KeepTrace))for(let e=0;e<o.length;e++){const t=o[e].GetPagePanel(s.ENumPagePanelTp.Body);l.ENumWorkMode[n]==l.ENumWorkMode.KeepTrace?this.setChildrensFgHide(!1,t):this.setChildrensFgHide(!0,t)}let a=r.M_XDocsUtil;i==l.ENumWorkMode.Browse&&l.ENumWorkMode[n]==l.ENumWorkMode.App||i==l.ENumWorkMode.App&&l.ENumWorkMode[n]==l.ENumWorkMode.Browse||i!=l.ENumWorkMode[n]&&(a.InvalidXDocsLayout(),super._RefreshPageAndMoveCaret(!0)),r.M_EdtCustomEvtGrp.AfterSetWorkMode&&r.M_EleEvtModel.WorkMode!=l.ENumWorkMode.Browse&&r.M_EdtCustomEvtGrp.AfterSetWorkMode(r.M_EleEvtModel.WorkMode),t=this.resMsg}return t}setChildrensFgHide(e=!1,t){if(null!=t){const n=t.ChildEleList;if(n.Count()>0){const t=n.ToArray();for(let n=0;n<t.length;n++){const r=t[n];if(null!=r){const t=r.EleStyle;null!=t&&t.DeleterIndex>-1&&(r.Attr_FgHide=e),r instanceof o.XBaseContainer&&this.setChildrensFgHide(e,r),e||null==t||t.DeleterIndex>-1&&(r.EleStyle.ForeColor=a.Color.Blue,t.CreatorIndex>-1&&(r.EleStyle.ForeColor=a.Color.Blue))}}}}}}t.A_SetWorkModeBase=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPageLineSelRange=void 0;const r=n(116),i=n(0),l=n(59);class s extends r.XLineEleRange{constructor(){super(),this.tmpLineEleWrap=null,this.tmpLineEleWrap=new l.ClickedElementWrapper(!1)}SetToIx(e,t=!0){super.SetToIx(e,t),this._CorrectSelectFromToIx(t)}IsValid(){return null!=this.fromLineEle&&null!=this.toLineEle&&this.fromLineEle.IsValid()&&this.toLineEle.IsValid()}_CorrectSelectFromToIx(e){if(super.IsValid()&&(super.FromLineEleIx.CopyFrom(super.InitSelEleIx),e)){let e=super.FromLineEleIx.CompareTo(super.ToLineEleIx);if(0!=e)if(e<0)super.ToLineEle instanceof i.XBaseContainer||(this.tmpLineEleWrap.LineEleIxFocused.SetEle2(super.ToLineEle),this.tmpLineEleWrap.MovetoNextEle(!1,!0),super.ToLineEleIx.SetEle2(this.tmpLineEleWrap.EleFocused));else{let e=!(super.FromLineEle instanceof i.XBaseContainer);if(super.FromLineEle instanceof i.XParagraphFlag){let t=super.FromLineEle;if(t!=t.Parent.GetLastChildEle()){let n=t.OwnerLine.LineAssist.GetFirstLineEleOfParagraph(!0);super.IsEleInRange(n)&&(e=!1)}}e&&(this.tmpLineEleWrap.LineEleIxFocused.SetEle2(super.FromLineEle),this.tmpLineEleWrap.MovetoNextEle(!1),super.FromLineEleIx.SetEle2(this.tmpLineEleWrap.EleFocused))}}}SelectNearXStringEle(e){if(null!=e){let t,n,r=e.Parent,l=null,s=r.GetChildInx(e),o=s;for(;;){let e=r.GetChildEle(o);if(null==e)break;e.ChildCount>0&&(l=e.GetChildEle(0)),o--}for(o=s;t=r.GetChildEle(o),t instanceof i.XStringEle;)o++;n=t instanceof i.XBaseContainer?t.GetFirstChildBaseEle(!0):t,this.SetFromIx(l),this.SetToIx(n,!0)}}SelectContainerLines(e){if(null!=e){if(e.LinesCnt>0){let t=e.GetFirstLine();if(null!=t){let n=e.GetEndLine();if(null!=n){let e=t.FirstElement;null!=e&&e instanceof i.XTextTable&&(e=e.GetFirstCell());let r=n.LastElement;null!=r&&r instanceof i.XTextTable&&(r=r.GetLastCell()),this.SetFromIx(e),this.SetToIx(r,!0)}}}}}}t.XPageLineSelRange=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BtnClickEvents=void 0,function(e){e[e.AddUsingBtn=0]="AddUsingBtn",e[e.CompliteBtn=1]="CompliteBtn",e[e.OkBtnClickEvent=2]="OkBtnClickEvent",e[e.CancelClickBtnEvent=3]="CancelClickBtnEvent",e[e.FindNextClickBtnEvent=4]="FindNextClickBtnEvent",e[e.ReplaceBtnClickEvent=5]="ReplaceBtnClickEvent",e[e.ReplaceAllBtnClickEvent=6]="ReplaceAllBtnClickEvent",e[e.ApplicationClickBtnEvent=7]="ApplicationClickBtnEvent",e[e.PictureChoiceClickBtnEvent=8]="PictureChoiceClickBtnEvent",e[e.SaveXmlSourceCodeClickBtnEvent=9]="SaveXmlSourceCodeClickBtnEvent",e[e.FindXmlCodeClickBtnEvent=10]="FindXmlCodeClickBtnEvent",e[e.DefaultValueClickBtnEvent=11]="DefaultValueClickBtnEvent"}(t.BtnClickEvents||(t.BtnClickEvents={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LangUtils=void 0;class r{static IsString(e){return"[object String]"==Object.prototype.toString.apply(e)}static IsFunction(e){return"[object Function]"==Object.prototype.toString.apply(e)}static IsArray(e){return"[object Array]"==Object.prototype.toString.apply(e)}static IsNumber(e){return"[object Number]"==Object.prototype.toString.apply(e)}static IsRegExp(e){return"[object RegExp]"==Object.prototype.toString.apply(e)}IsObject(e){return"[object Object]"==Object.prototype.toString.apply(e)}IsDate(e){return"[object Date]"==Object.prototype.toString.apply(e)}static listToMap(e){if(!e)return{};e=r.IsArray(e)?e:e.split(",");for(var t,n=0,i={};t=e[n++];)i[t.toUpperCase()]=i[t]=1;return i}static removeItem(e,t){for(var n=0,r=e.length;n<r;n++)e[n]===t&&(e.splice(n,1),n--)}static trim(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")}static bind(e,t){return function(){return e.apply(t,arguments)}}}t.LangUtils=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingComp=t.Loading=void 0;const r=n(12),i=n(109);n(946);const l=n(24),s=n(22);class o extends r.Component{constructor(e){super(e),this.state={isRender:!0}}componentDidMount(){this.props.parent.React=this}show(){this.setState({isRender:!0})}hide(){setTimeout(()=>{this.setState({isRender:!1})})}render(){return this.state.isRender?l.createPortal(r.createElement("div",{className:"loading-mask",style:{zIndex:i.DomUtils.GetZIndex()}},r.createElement("i",{className:"loading-icon"})),document.getElementsByTagName("body").item(0)):null}}t.Loading=o;class a extends s.BaseComponent{constructor(){super(document.createDocumentFragment(),{})}static GetIns(){return null==this.instance&&(this.instance=new a),this.instance}static show(){this.GetIns().React.show()}static hide(){this.GetIns().React.hide()}Render(){l.render(r.createElement(o,{parent:this}),this.Dom)}}t.LoadingComp=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.rectangleCanvas.getContext("2d").drawImage(e.rectangleCanvas,0,0,e.width*e.scale,e.height*e.scale,0,0,e.width*e.scale,e.height*e.scale);let t=e.rectangleCanvas.toDataURL("image/jpg");e.snapshootList.push(t),e.currentImgDom.src=t}},function(e,t,n){"use strict";n.d(t,"b",(function(){return Q})),n.d(t,"a",(function(){return K}));var r=Uint8Array,i=Uint16Array,l=Uint32Array,s=new r([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o=new r([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new r([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u=function(e,t){for(var n=new i(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var s=new l(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)s[o]=o-n[r]<<5|r;return[n,s]},h=u(s,2),d=h[0],c=h[1];d[28]=258,c[258]=28;for(var p=u(o,0),f=p[0],g=p[1],m=new i(32768),E=0;E<32768;++E){var C=(43690&E)>>>1|(21845&E)<<1;C=(61680&(C=(52428&C)>>>2|(13107&C)<<2))>>>4|(3855&C)<<4,m[E]=((65280&C)>>>8|(255&C)<<8)>>>1}var A=function(e,t,n){for(var r=e.length,l=0,s=new i(t);l<r;++l)++s[e[l]-1];var o,a=new i(t);for(l=0;l<t;++l)a[l]=a[l-1]+s[l-1]<<1;if(n){o=new i(1<<t);var u=15-t;for(l=0;l<r;++l)if(e[l])for(var h=l<<4|e[l],d=t-e[l],c=a[e[l]-1]++<<d,p=c|(1<<d)-1;c<=p;++c)o[m[c]>>>u]=h}else for(o=new i(r),l=0;l<r;++l)o[l]=m[a[e[l]-1]++]>>>15-e[l];return o},y=new r(288);for(E=0;E<144;++E)y[E]=8;for(E=144;E<256;++E)y[E]=9;for(E=256;E<280;++E)y[E]=7;for(E=280;E<288;++E)y[E]=8;var I=new r(32);for(E=0;E<32;++E)I[E]=5;var S=A(y,9,0),_=A(y,9,1),w=A(I,5,0),b=A(I,5,1),x=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},P=function(e,t,n){var r=t/8>>0;return(e[r]|e[r+1]<<8)>>>(7&t)&n},v=function(e,t){var n=t/8>>0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>>(7&t)},T=function(e){return(e/8>>0)+(7&e&&1)},M=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var s=new(e instanceof i?i:e instanceof l?l:r)(n-t);return s.set(e.subarray(t,n)),s},L=function(e,t,n){var i=e.length,l=!t||n,u=!n||n.i;n||(n={}),t||(t=new r(3*i));var h=function(e){var n=t.length;if(e>n){var i=new r(Math.max(2*n,e));i.set(t),t=i}},c=n.f||0,p=n.p||0,g=n.b||0,m=n.l,E=n.d,C=n.m,y=n.n,I=8*i;do{if(!m){n.f=c=P(e,p,1);var S=P(e,p+1,3);if(p+=3,!S){var w=e[(V=T(p)+4)-4]|e[V-3]<<8,L=V+w;if(L>i){if(u)throw"unexpected EOF";break}l&&h(g+w),t.set(e.subarray(V,L),g),n.b=g+=w,n.p=p=8*L;continue}if(1==S)m=_,E=b,C=9,y=5;else{if(2!=S)throw"invalid block type";var D=P(e,p,31)+257,R=P(e,p+10,15)+4,F=D+P(e,p+5,31)+1;p+=14;for(var N=new r(F),B=new r(19),k=0;k<R;++k)B[a[k]]=P(e,p+3*k,7);p+=3*R;var O=x(B),G=(1<<O)-1;if(!u&&p+F*(O+7)>I)break;var X=A(B,O,1);for(k=0;k<F;){var V,H=X[P(e,p,G)];if(p+=15&H,(V=H>>>4)<16)N[k++]=V;else{var U=0,W=0;for(16==V?(W=3+P(e,p,3),p+=2,U=N[k-1]):17==V?(W=3+P(e,p,7),p+=3):18==V&&(W=11+P(e,p,127),p+=7);W--;)N[k++]=U}}var j=N.subarray(0,D),z=N.subarray(D);C=x(j),y=x(z),m=A(j,C,1),E=A(z,y,1)}if(p>I)throw"unexpected EOF"}l&&h(g+131072);for(var Y=(1<<C)-1,Q=(1<<y)-1,K=C+y+18;u||p+K<I;){var q=(U=m[v(e,p)&Y])>>>4;if((p+=15&U)>I)throw"unexpected EOF";if(!U)throw"invalid length/literal";if(q<256)t[g++]=q;else{if(256==q){m=null;break}var J=q-254;if(q>264){var Z=s[k=q-257];J=P(e,p,(1<<Z)-1)+d[k],p+=Z}var $=E[v(e,p)&Q],ee=$>>>4;if(!$)throw"invalid distance";p+=15&$;z=f[ee];if(ee>3){Z=o[ee];z+=v(e,p)&(1<<Z)-1,p+=Z}if(p>I)throw"unexpected EOF";l&&h(g+131072);for(var te=g+J;g<te;g+=4)t[g]=t[g-z],t[g+1]=t[g+1-z],t[g+2]=t[g+2-z],t[g+3]=t[g+3-z];g=te}}n.l=m,n.p=p,n.b=g,m&&(c=1,n.m=C,n.d=E,n.n=y)}while(!c);return g==t.length?t:M(t,0,g)},D=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8},R=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},F=function(e,t){for(var n=[],l=0;l<e.length;++l)e[l]&&n.push({s:l,f:e[l]});var s=n.length,o=n.slice();if(!s)return[new r(0),0];if(1==s){var a=new r(n[0].s+1);return a[n[0].s]=1,[a,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var u=n[0],h=n[1],d=0,c=1,p=2;for(n[0]={s:-1,f:u.f+h.f,l:u,r:h};c!=s-1;)u=n[n[d].f<n[p].f?d++:p++],h=n[d!=c&&n[d].f<n[p].f?d++:p++],n[c++]={s:-1,f:u.f+h.f,l:u,r:h};var f=o[0].s;for(l=1;l<s;++l)o[l].s>f&&(f=o[l].s);var g=new i(f+1),m=N(n[c-1],g,0);if(m>t){l=0;var E=0,C=m-t,A=1<<C;for(o.sort((function(e,t){return g[t.s]-g[e.s]||e.f-t.f}));l<s;++l){var y=o[l].s;if(!(g[y]>t))break;E+=A-(1<<m-g[y]),g[y]=t}for(E>>>=C;E>0;){var I=o[l].s;g[I]<t?E-=1<<t-g[I]++-1:++l}for(;l>=0&&E;--l){var S=o[l].s;g[S]==t&&(--g[S],++E)}m=t}return[new r(g),m]},N=function(e,t,n){return-1==e.s?Math.max(N(e.l,t,n+1),N(e.r,t,n+1)):t[e.s]=n},B=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new i(++t),r=0,l=e[0],s=1,o=function(e){n[r++]=e},a=1;a<=t;++a)if(e[a]==l&&a!=t)++s;else{if(!l&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(l),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(l);s=1,l=e[a]}return[n.subarray(0,r),t]},k=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},O=function(e,t,n){var r=n.length,i=T(t+2);e[i]=255&r,e[i+1]=r>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var l=0;l<r;++l)e[i+l+4]=n[l];return 8*(i+4+r)},G=function(e,t,n,r,l,u,h,d,c,p,f){D(t,f++,n),++l[256];for(var g=F(l,15),m=g[0],E=g[1],C=F(u,15),_=C[0],b=C[1],x=B(m),P=x[0],v=x[1],T=B(_),M=T[0],L=T[1],N=new i(19),G=0;G<P.length;++G)N[31&P[G]]++;for(G=0;G<M.length;++G)N[31&M[G]]++;for(var X=F(N,7),V=X[0],H=X[1],U=19;U>4&&!V[a[U-1]];--U);var W,j,z,Y,Q=p+5<<3,K=k(l,y)+k(u,I)+h,q=k(l,m)+k(u,_)+h+14+3*U+k(N,V)+(2*N[16]+3*N[17]+7*N[18]);if(Q<=K&&Q<=q)return O(t,f,e.subarray(c,c+p));if(D(t,f,1+(q<K)),f+=2,q<K){W=A(m,E,0),j=m,z=A(_,b,0),Y=_;var J=A(V,H,0);D(t,f,v-257),D(t,f+5,L-1),D(t,f+10,U-4),f+=14;for(G=0;G<U;++G)D(t,f+3*G,V[a[G]]);f+=3*U;for(var Z=[P,M],$=0;$<2;++$){var ee=Z[$];for(G=0;G<ee.length;++G){var te=31&ee[G];D(t,f,J[te]),f+=V[te],te>15&&(D(t,f,ee[G]>>>5&127),f+=ee[G]>>>12)}}}else W=S,j=y,z=w,Y=I;for(G=0;G<d;++G)if(r[G]>255){te=r[G]>>>18&31;R(t,f,W[te+257]),f+=j[te+257],te>7&&(D(t,f,r[G]>>>23&31),f+=s[te]);var ne=31&r[G];R(t,f,z[ne]),f+=Y[ne],ne>3&&(R(t,f,r[G]>>>5&8191),f+=o[ne])}else R(t,f,W[r[G]]),f+=j[r[G]];return R(t,f,W[256]),f+j[256]},X=new l([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),V=new r(0),H=function(e,t,n,a,u,h){var d=e.length,p=new r(a+d+5*(1+Math.floor(d/7e3))+u),f=p.subarray(a,p.length-u),m=0;if(!t||d<8)for(var E=0;E<=d;E+=65535){var C=E+65535;C<d?m=O(f,m,e.subarray(E,C)):(f[E]=h,m=O(f,m,e.subarray(E,d)))}else{for(var A=X[t-1],y=A>>>13,I=8191&A,S=(1<<n)-1,_=new i(32768),w=new i(S+1),b=Math.ceil(n/3),x=2*b,P=function(t){return(e[t]^e[t+1]<<b^e[t+2]<<x)&S},v=new l(25e3),L=new i(288),D=new i(32),R=0,F=0,N=(E=0,0),B=0,k=0;E<d;++E){var H=P(E),U=32767&E,W=w[H];if(_[U]=W,w[H]=U,B<=E){var j=d-E;if((R>7e3||N>24576)&&j>423){m=G(e,f,0,v,L,D,F,N,k,E-k,m),N=R=F=0,k=E;for(var z=0;z<286;++z)L[z]=0;for(z=0;z<30;++z)D[z]=0}var Y=2,Q=0,K=I,q=U-W&32767;if(j>2&&H==P(E-q))for(var J=Math.min(y,j)-1,Z=Math.min(32767,E),$=Math.min(258,j);q<=Z&&--K&&U!=W;){if(e[E+Y]==e[E+Y-q]){for(var ee=0;ee<$&&e[E+ee]==e[E+ee-q];++ee);if(ee>Y){if(Y=ee,Q=q,ee>J)break;var te=Math.min(q,ee-2),ne=0;for(z=0;z<te;++z){var re=E-q+z+32768&32767,ie=re-_[re]+32768&32767;ie>ne&&(ne=ie,W=re)}}}q+=(U=W)-(W=_[U])+32768&32767}if(Q){v[N++]=268435456|c[Y]<<18|g[Q];var le=31&c[Y],se=31&g[Q];F+=s[le]+o[se],++L[257+le],++D[se],B=E+Y,++R}else v[N++]=e[E],++L[e[E]]}}m=G(e,f,h,v,L,D,F,N,k,E-k,m),h||(m=O(f,m,V))}return M(p,0,a+T(m)+u)},U=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,l=n.length,s=0;s!=l;){for(var o=Math.min(s+5552,l);s<o;++s)i+=r+=n[s];r%=65521,i%=65521}e=r,t=i},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+2*((255&e)<<23)}}},W=function(e,t,n,r,i){return H(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,r,!i)},j=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},z=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;e[0]=120,e[1]=r<<6|(r?32-2*r:1)},Y=function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function Q(e,t){void 0===t&&(t={});var n=U();n.p(e);var r=W(e,t,2,4);return z(r,t),j(r,r.length-4,n.d()),r}function K(e,t){return L((Y(e),e.subarray(2,-4)),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MeasureConverter=void 0;t.MeasureConverter=class{ConvPxDPI(e,t,n){return e*(n/t)}ConvPxToMm(e,t){let n;if(t<=0)n=0;else{n=25.4*e/t}return n}ConvMmToPx(e,t){let n;if(t<=0)n=0;else{n=t*e/25.4}return n}CalcRealDPI(e,t){let n;if(0==t)n=0;else{let r=t/25.4;r=e/r,n=r}return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseElement=void 0;const r=n(35),i=n(571),l=n(160),s=n(39),o=n(0),a=n(115),u=n(8),h=n(2),d=n(26),c=n(9),p=n(161),f=n(14),g=n(10),m=n(6),E=n(575),C=n(4);class A{constructor(){this.attrList=null,this.propList=null,this.eleXID=null,this.eleStyle=null,this.isLayoutValid=!1,this.isRemoved=!1,this.parent=null,this.ownerDocPanel=null,this.formatBrushEnable=!1,this.ownerLine=null,this.bounds=c.RectangleF.Empty,this.attrList=new i.XAttributeCollection,this.propList=new l.XPropertyCollection,this.propList.XmlEleName="VirtualPropList",this.eleStyle=p.XEleStyleFactory.CreatXEleStyle(this.EleTypeName)}get OwnPageView(){return null==this.ownerLine?null:this.ownerLine.PageView}get EleTypeName(){return null}get Document(){const e=this.OwnerDocPanel;return null==e?null:e.Document}set Document(e){null!=this.OwnerDocPanel&&(this.OwnerDocPanel.Document=e)}get XID(){if(null!=this.eleXID)return this.eleXID;let e=this.propList.GetPropValue("XID");return null==e&&(e=this._BuildNewXID(),this.propList.ModifyProperty("XID",e,null)),this.eleXID=e,e}set XID(e){this.eleXID=e,this.propList.ModifyProperty("XID",e,null)}_BuildNewXID(){let e=r.CommDefines.GetEmrNextSer();return"xid-"+s.DateTime.Now.Ticks()+"-"+e}get GrpID(){let e=this.propList.GetPropValue("ID"),t=this._BuildGrpID(e);return e!=t&&this.propList.ModifyProperty("ID",t,null),t}set GrpID(e){this.propList.ModifyProperty("ID",e,null)}get CptID(){return this.propList.GetPropValue("CptID")}set CptID(e){this.propList.ModifyProperty("CptID",e,null)}get bussId(){return this.propList.GetPropValue("bussId")}set bussId(e){this.propList.ModifyProperty("bussId",e,null)}get EmployeeId(){return this.propList.GetPropValue("EmployeeId")}set EmployeeId(e){this.propList.ModifyProperty("EmployeeId",e,null)}get SignEleHaveValue(){let e=this.propList.GetPropValue("SignEleHaveValue");return u.CNumUtil.TryParseBool(e,!1)}set SignEleHaveValue(e){this.propList.ModifyProperty("SignEleHaveValue",e,!1)}get UndoRelateId(){return this.propList.GetPropValue("UndoRelateId")}set UndoRelateId(e){this.propList.ModifyProperty("UndoRelateId",e,null)}get ExtendAttr1(){return this.propList.GetPropValue("ExtendAttr1")}set ExtendAttr1(e){this.propList.ModifyProperty("ExtendAttr1",e,null)}get LackEllipsisvalue(){return this.propList.GetPropValue("LackEllipsisvalue")}set LackEllipsisvalue(e){this.propList.ModifyProperty("LackEllipsisvalue",e,null)}get DynamicData(){let e=this.propList.GetPropValue("DynamicData");return""==e&&(e=null),e}set DynamicData(e){this.propList.ModifyProperty("DynamicData",e,null)}get DynamicDataValue(){return this.propList.GetPropValue("DynamicDataValue")}set DynamicDataValue(e){this.propList.ModifyProperty("DynamicDataValue",e,null)}get OldForeColor(){return this._oldForeColor}set OldForeColor(e){this._oldForeColor=e}_BuildGrpID(e){let t;if(null==e){let e=r.CommDefines.GetEmrNextSer(),n=s.DateTime.Now.ToString("yyyyMMddHHmmss");t=C.default.Format("{0}{1}{2:000000}",a.EleIDPrefix.GId_Prev,n,e)}else e.startsWith(a.EleIDPrefix.GId_Prev)||(t=C.default.Format("{0}{1}",a.EleIDPrefix.GId_Prev,e)),t=e;return t}get EleStyle(){return this.eleStyle}set EleStyle(e){this.eleStyle=e}get IsLayoutValid(){return this.isLayoutValid}set IsLayoutValid(e){this.isLayoutValid=e,e||null!=this.parent&&(this.parent.IsLayoutValid=!1)}get IsRemoved(){if(this.isRemoved)return!0;for(let e=this.parent;null!=e;e=e.parent)if(e.isRemoved)return!0;return!1}set IsRemoved(e){this.isRemoved=e}get Parent(){return this.parent}set Parent(e){this.parent=e,null!=e&&(this.isRemoved=!1)}get Granpa(){return null==this.parent?null:this.Parent.Parent}get OwnerDocPanel(){return this.ownerDocPanel}set OwnerDocPanel(e){if(this.ownerDocPanel=e,null!=e){let t=e.Document;this.eleStyle.SetDocument(t)}}set FormatBrushEnable(e){this.formatBrushEnable=e}get FormatBrushEnable(){return this.formatBrushEnable}get Attr_TypeCode(){return this.attrList.GetPropValue("type")}set Attr_TypeCode(e){this.attrList.ModifyProperty("type",e,null)}get Attr_FgHide(){let e=this.attrList.GetPropValue("hide");return u.CNumUtil.TryParseBool(e,!1)}set Attr_FgHide(e){const t=u.CNumUtil.ToStringForBool(e);this.attrList.ModifyProperty("hide",t,"false"),this.IsLayoutValid=!1}get SelfHide(){let e=this.attrList.GetPropValue("selfhide");return u.CNumUtil.TryParseBool(e,null)}set SelfHide(e){const t=u.CNumUtil.ToStringForBool(e);this.attrList.ModifyProperty("selfhide",t,null),this.IsLayoutValid=!1}get UserEditable(){let e=this.propList.GetPropValue("UserEditable");return u.CNumUtil.TryParseBool(e,!0)}set UserEditable(e){this.propList.ModifyProperty("UserEditable",e,!0)}get Deletable(){let e=this.propList.GetPropValue("Deleteable");return u.CNumUtil.TryParseBool(e,!0)}set Deletable(e){this.propList.ModifyProperty("Deleteable",e,!0)}get ToolTip(){return this.propList.GetPropValue("ToolTip")}set ToolTip(e){this.propList.ModifyProperty("ToolTip",e,null)}get SourceName(){return this.propList.GetPropValue("SourceName")}set SourceName(e){this.propList.ModifyProperty("SourceName",e,null)}get PropertyName(){return this.propList.GetPropValue("PropertyName")}set PropertyName(e){this.propList.ModifyProperty("PropertyName",e,null)}get OwnerLine(){return this.ownerLine}set OwnerLine(e){this.ownerLine=e}get OwnerLineInx(){return null==this.ownerLine?-1:this.ownerLine.Index}get OwnerPanelLindeIndex(){let e=-1,t=this.Document.GetPagePanel(m.ENumPagePanelTp.Body).LinesList,n=this.OwnerLine;for(let r=0;r<t.Length;r++)if(t.Get(r)==n){e=r;break}return e}SetCanSecret(e){switch(e){case h.ENumCanSecret.Inherit:this.Attr_CanSecret=null;break;case h.ENumCanSecret.Yes:this.Attr_CanSecret=!0;break;case h.ENumCanSecret.No:this.Attr_CanSecret=!1}}CanSecretReal(){let e=this;for(;null!=e&&null==e.Attr_CanSecret;)e=e.Parent;return null!=e&&null!=e.Attr_CanSecret&&e.Attr_CanSecret}get Attr_CanSecret(){let e=this.attrList.GetPropValue("boolencrypt");return null==e?null:u.CNumUtil.TryParseBool(e,!1)}set Attr_CanSecret(e){this.attrList.ModifyProperty("boolencrypt",u.CNumUtil.ToStringForBool(e),null)}IsHidden(e=!0){let t=this.Document;if(null==t)return!1;let n=null==this.ownerLine?null:this.ownerLine.RelEleParagraphStyle;if(null!=n&&n.IsFolded)return!0;if(e){if(t.GetDocCtxt().ViewMode.IsCleanViewMode){if(o.XDomUtil.HasDelTrace(this))return!0;if(this instanceof o.XTextTable){return o.XDomUtil.TableAllRowsDelTrace(this)}}}if(t.GetDocCtxt().EmrWorkMode==h.ENumWorkMode.Design)return!1;let r=this,i=!1;for(;null!=r&&(i=r.Attr_FgHide,!i);)r=r.Parent;return i}NeedSerialized(){if(!d.TextDocInitInfo.GetInstance().IsSaveTrace){if(o.XDomUtil.HasDelTrace(this))return!1;this.eleStyle.CreatorIndex>-1&&(this.eleStyle.CreatorIndex=-1)}return!0}get EleCursorAllowSide(){return h.ENumEleCursorSide.Both}set EleCursorAllowSide(e){}Equals(e){if(this===e)return!0;let t;return e instanceof A&&(t=e),null!=t&&this.XID==t.XID}M_SetAttribute(e,t,n){this.attrList.ModifyProperty(e,t,n)}SetAttribute(e,t){this.M_SetAttribute(e,t,null)}GetAttribute(e){let t=this.attrList.GetPropValue(e);return null==t?null:t}CopyFrom(e,t=!1,n=!1,r=!0){let i=this.XID,l=this.GrpID;r&&this.eleStyle.CopyFrom(e.eleStyle,!1),this.attrList.CopyFrom(e.attrList),this.propList.CopyFrom(e.propList),n?(this.XID=e.XID,this.GrpID=e.GrpID,this.XIDFromCopy=""):(this.XID=i==e.XID?null:i,this.GrpID=l==e.GrpID?null:l,this.XIDFromCopy=e.XID+","+e.GrpID)}get X(){return this.bounds.X}get Y(){return this.bounds.Y}get Width(){return this.bounds.Width}get Height(){return this.bounds.Height}set Height(e){}GetRealLeft(){let e=this.X;return null!=this.ownerLine?e+=this.ownerLine.RealLeft:null!=this.Parent&&(e+=this.Parent.GetRealLeft()),e}GetRealTop(){let e=this.Y;return null!=this.ownerLine?e+=this.ownerLine.RealTop:null!=this.Parent&&(e+=this.Parent.GetRealTop()),e}NotifyLayoutChanged(e=!0,t=!1){e?this.IsLayoutValid=!1:this.isLayoutValid=!1}GetInnerText(e){return""}ChangeSecretType(e){}ReCalcBaseSize(){}CanBeInline(e=!1){return!0}IsWholeLineEle(){return!1}Clear(){null!=this.eleStyle&&this.eleStyle.Clear(),this.isLayoutValid=!1,this.attrList.Clear(),this.propList.Clear(),this.bounds=c.RectangleF.Empty,this.parent=null,this.ownerLine=null}FromXML(e){this.BaseFromXML(e)}BaseFromXML(e){this._FromXML_EleStyle(e),this.attrList.FromXML(e),this.propList.FromXML(e),this._AfterFromXML_()}_FromXML_EleStyle(e){if(null!=this.Document){let t=this.Document.CommStyleList,n=f.XmlDomUtil.GetSingleAttrValue(e,"StyleIndex"),r=u.CNumUtil.TryParseInt(n,-1),i=-1;r>=0&&t.CopyEleStyle(r,this.eleStyle,i)}}_AfterFromXML_(){}ToXMLs(e){return null}ToXML(e){var t;return!((null===(t=this.EleStyle)||void 0===t?void 0:t.DeleterIndex)>-1&&!this.Document.SaveWithTrace)&&this.NeedSerialized()?this.BaseToXML(e):null}BaseToXML(e){var t;if((null===(t=this.EleStyle)||void 0===t?void 0:t.DeleterIndex)>-1&&!this.Document.SaveWithTrace)return null;let n=this.Document.CommStyleList,r=e.createElement("Element");this._BeforeToXML_();let i=f.XmlDomUtil.CrtXmlAttr(e,"xsi:type",this.EleTypeName,a.XmlNsTags.GetURI("xsi"));r.setAttributeNode(i);let l=n.TryAddEleStyle(this.eleStyle);if(l>=0&&r.setAttribute("StyleIndex",l.toString()),null!=this.attrList&&!this.attrList.IsEmpty()){let t=this.attrList.ToXML(e);r.appendChild(t)}if(null!=this.propList&&!this.propList.IsEmpty()){let t=this.propList.ToXML(e),n=t.children;if(null!=n&&t.hasChildNodes){let e=n.length;for(let t=0;t<e;t++){let e=n[0];e.nodeType==E.XmlNodeType.Element&&r.appendChild(e)}}}return r}_BeforeToXML_(){let e=this.XID;this.propList.ModifyProperty("XID",e,null),e=this.GrpID,this.propList.ModifyProperty("ID",e,null)}get Bounds(){return this.bounds}GetBoundsDPI(e){let t=this.Bounds.Clone();return t=g.DPITransUtil.TransRectF(t,300,t,e),t}SetPositionDPI(e,t,n){if(n>0&&300!=n){let r=300/n;-1e3!=e&&(e*=r),-1e3!=t&&(e=r*t)}-1e3!=e&&(this.bounds.X=Math.round(100*e)/100),-1e3!=t&&(this.bounds.Y=Math.round(100*t)/100)}SetSizeDPI(e,t,n){if(n>0&&300!=n){let r=300/n;e>=0&&(e*=r),t>=0&&(t*=r)}e>=0&&(this.bounds.Width=Math.round(100*e)/100),t>=0&&(this.bounds.Height=Math.round(100*t)/100)}CopyFromSelRange(e,t,n,r,i){let l,s=null==e?0:e.length;if(s<=0||t>=s)l=0;else{let i=e[t];this.CopyFrom(i,!1,n,r),l=1}return l}get RealLeft(){let e=this.X;return null!=this.ownerLine?e+=this.ownerLine.RealLeft:null!=this.Parent&&(e+=this.Parent.RealLeft),e}get RealTop(){let e=this.Bounds.Y;return null!=this.ownerLine?e+=this.ownerLine.RealTop:null!=this.Parent&&(e+=this.Parent.RealTop),e}GetEleAtPos(e,t,n,i,l,s){let a=this.Bounds;if(a.Width>0&&a.Height>0){if(n>0&&300!=n){let r=300/n;e*=r,t*=r}let u;if(null!=this.ownerLine){let t=this.ownerLine.GetWordSpacing(n),i=a.Right+t;if(s){let e=a.Right,t=this;for(;e<=a.Right;){const n=t.parent.bounds.Right;n>e&&(e=n),t=t.parent}e>i&&(i=e)}u=r.CommDefines.IsNumBetween(e,a.Left,i)}else u=a.Contains(e,t);if(u){const n=!s&&r.CommDefines.CmprNumVal(e-a.X,a.Width/2,.001)>0;if(i.ClickPosYDiff=t-a.Y,i.LineEleIxFocused.SetEle2(this),this instanceof o.XLabelEle&&this.LabelType==h.ENumXLabelType.XInputUnit){let e=o.XDomUtil.GetNextEle(!1,this);e instanceof o.XLabelEle&&e.LabelType==h.ENumXLabelType.XInputSuffix&&i.MovetoNextEle(!1)}if(!l)return;switch(this.EleCursorAllowSide){case h.ENumEleCursorSide.Both:n?i.MovetoNextEle(!0):i.SkipElesForbidCursor(!1);break;case h.ENumEleCursorSide.Left:case h.ENumEleCursorSide.ForceLeft:i.LineEleIxFocused.AtRightHalf=n;break;case h.ENumEleCursorSide.Right:case h.ENumEleCursorSide.ForceRight:i.MovetoNextEle(!0)}}}}get XID_Test(){return this.eleXID}set XID_Test(e){this.eleXID=e}CopyBoundsFrom(e){null!=e&&(this.bounds.X=e.bounds.X,this.bounds.Y=e.bounds.Y,this.bounds.Width=e.bounds.Width,this.bounds.Height=e.bounds.Height)}get IsInHeadFooterPanel(){let e,t=this.OwnerDocPanel;if(null==t)e=!1;else{let n=t.PagePanelTp;e=n==m.ENumPagePanelTp.Header||n==m.ENumPagePanelTp.Footer}return e}GetType(){return"XBaseElement"}UpdateInnerText(e,t,n){}}t.XBaseElement=A,A.InvalidXY=-1e3},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Graphics=void 0;const r=n(25),i=n(9),l=n(56),s=n(17),o=n(195),a=n(263),u=n(53),h=n(125),d=n(90),c=n(152);class p{constructor(e){this._context=null,this.originX=0,this.originY=0,this.rotation=0,this.origin=[0,0],this.clip=null,this.intersectClip=null,this._smoothingMode=null,this.isTranslateFirst=null,this._showXParagraphFlag=!0,this._ShowStatusImg=!0,this._ShowWaterMark=!0,e instanceof HTMLCanvasElement?this._context=e.getContext("2d"):this._context=e}get OriginX(){return this.originX}static get Empty(){let e=document.createElement("canvas").getContext("2d");return new p(e)}refresh(){}set ShowXParagraphFlag(e){this._showXParagraphFlag=null==e||e}get ShowXParagraphFlag(){return this._showXParagraphFlag}get ShowStatusImg(){return this._ShowStatusImg}set ShowStatusImg(e){this._ShowStatusImg=e}get ShowWaterMark(){return this._ShowWaterMark}set ShowWaterMark(e){this._ShowWaterMark=e}set EditableCanvas(e){this._editableCanvas=e}get EditableCanvas(){return this._editableCanvas}get Clip(){return this.clip}set Clip(e){this.clip=e}ResetClip(){this.clip=null}IntersectClip(e){this.intersectClip=e}DrawString(e,t,n,r,o,a){let h;n instanceof u.SolidBrush&&(h=n);let c=0,p=0,f=0,g=0,m="left",E="top";if(r instanceof i.RectangleF)c=r.X,p=r.Y,f=r.Width,g=r.Height;else if(r instanceof s.PointF){let e=r;c=e.X,p=e.Y}else"number"==typeof r&&(c=r);let C=null;"number"==typeof o?p=o:o instanceof l.StringFormat&&(C=o),null!=a&&a instanceof l.StringFormat&&(C=a),C&&(C.Alignment==d.StringAlignment.Near?m="left":C.Alignment==d.StringAlignment.Center?(c+=f/2,m="center"):C.Alignment==d.StringAlignment.Far&&(c+=f,m="right"),C.LineAlignment==d.StringAlignment.Near?E="top":C.LineAlignment==d.StringAlignment.Center?(p+=g/2,E="middle"):C.LineAlignment==d.StringAlignment.Far&&(p+=g,E="bottom")),this._context.save(),this.transform();let A=t.Italic?"italic":"normal",y=t.Bold?"bold":"normal";this._context.font=`${A} ${y} ${t.Size}pt ${t.FontFamily.GetName()}`,this._context.fillStyle=h.Color.ToRgbaString(),this._context.textAlign=m,this._context.textBaseline=E,this._context.fillText(e,c,p),this._context.restore()}MeasureString(e,t,n,i,l,s){this._context.font=t.toString(),this._context.direction="inherit",this._context.textAlign="center",this._context.textBaseline="alphabetic",this.ConfigContextWithStringFormat(this._context,i);let o=this._context.measureText(e),a=o.width,u=o.actualBoundingBoxAscent,h=o.actualBoundingBoxDescent,d=t.Size/3+h+u;return new r.SizeF(a,d)}ConfigContextWithStringFormat(e,t){(t.FormatFlags&o.StringFormatFlags.DirectionRightToLeft)==o.StringFormatFlags.DirectionRightToLeft?e.direction="rtl":e.direction="inherit",t.FormatFlags,o.StringFormatFlags.NoClip,o.StringFormatFlags.NoClip,t.FormatFlags,o.StringFormatFlags.FitBlackBox,o.StringFormatFlags.FitBlackBox,t.FormatFlags,o.StringFormatFlags.DirectionVertical,o.StringFormatFlags.DirectionVertical,t.FormatFlags,o.StringFormatFlags.DisplayFormatControl,o.StringFormatFlags.DisplayFormatControl,t.FormatFlags,o.StringFormatFlags.LineLimit,o.StringFormatFlags.LineLimit,t.FormatFlags,o.StringFormatFlags.MeasureTrailingSpaces,o.StringFormatFlags.MeasureTrailingSpaces,t.FormatFlags,o.StringFormatFlags.NoFontFallback,o.StringFormatFlags.NoFontFallback,t.FormatFlags,o.StringFormatFlags.NoWrap,o.StringFormatFlags.NoWrap}FillRectangle(e,t,n,r,l){if(t instanceof i.RectangleF){let e=t;t=e.X,n=e.Y,r=e.Width,l=e.Height}let s;e instanceof u.SolidBrush&&(s=e),this._context.save(),this.transform(),this._context.fillStyle=s.Color.ToRgbaString(),this._context.fillRect(t,n,r,l),this._context.restore()}FillRectangles(e,t){for(let n of t)this.FillRectangle(e,n)}DrawRectangle(e,t,n,r,l){if(null==e.DashStyle||e.DashStyle==h.DashStyle.Solid){if(t instanceof i.RectangleF){let e=t;t=e.X,n=e.Y,r=e.Width,l=e.Height}this._context.save(),this.transform(),this._context.strokeStyle=e.Color.ToRgbaString(),this._context.strokeRect(t,n,r,l),this._context.restore()}else{if(t instanceof i.RectangleF){let e=t;t=e.X,n=e.Y,r=e.Width,l=e.Height}this.DrawLine(e,t,n,t+r,n),this.DrawLine(e,t+r,n,t+r,n+l),this.DrawLine(e,t+r,n+l,t,n+l),this.DrawLine(e,t,n+l,t,n)}}DrawRectangles(e,t){for(let n of t)this.DrawRectangle(e,n)}DrawLine(e,t,n,r,i,l){let o=0,a=0,u=0,d=0;if(t instanceof s.PointF&&n instanceof s.PointF){let e=t,r=n;o=e.X,a=e.Y,u=r.X,d=r.Y}else o=t,a=n,u=r,d=i;if(this._context.save(),this._context.strokeStyle=e.Color.ToRgbaString(),this._context.lineWidth=e.Width?e.Width:1,this._context.beginPath(),null!=e.DashStyle)switch(e.DashStyle){case h.DashStyle.Dash:this._context.setLineDash([10,10]);break;case h.DashStyle.DashDot:this._context.setLineDash([6,3,1,3]);break;case h.DashStyle.DashDotDot:this._context.setLineDash([6,3,1,3,1,3]);break;case h.DashStyle.Dot:this._context.setLineDash([2]);break;case h.DashStyle.Custom:this._context.setLineDash(e.DashPattern)}this.transform(),this._context.moveTo(o,a),this._context.lineTo(u,d),this._context.stroke(),this._context.restore()}DrawLines(e,t){for(let n=0;n<t.length;n++)n!=t.length-1&&this.DrawLine(e,t[n],t[n+1])}DrawCircle(e,t,n){}DrawEllipse(e,t,n,r,l){if(t instanceof i.RectangleF){let e=t;t=e.X,n=e.Y,r=e.Width,l=e.Height}this._context.save(),this.transform(),this._context.beginPath(),this._context.ellipse(t+r/2,n+l/2,r/2,l/2,0,0,2*Math.PI),this._context.strokeStyle=e.Color.ToRgbaString(),this._context.stroke(),this._context.restore()}FillEllipse(e,t,n,r,l){if(t instanceof i.RectangleF){let e=t;t=e.X,n=e.Y,r=e.Width,l=e.Height}let s;e instanceof u.SolidBrush&&(s=e),this._context.save(),this.transform(),this._context.beginPath(),this._context.ellipse(t+r/2,n+l/2,r/2,l/2,0,0,2*Math.PI),this._context.fillStyle=s.Color.ToRgbaString(),this._context.fill(),this._context.restore()}DrawArcRect(e,t,n){let r=t.X,i=t.Y,l=t.Width,s=t.Height,o=n;this._context.save(),this.transform(),this._context.beginPath(),this._context.moveTo(r+o,i),this._context.strokeStyle=e.Color.ToRgbaString(),this._context.lineTo(r+l-o,i),this._context.arc(r+l-o,i+o,o,1.5*Math.PI,2*Math.PI),this._context.lineTo(r+l,i+s-o),this._context.arc(r+l-o,i+s-o,o,0,.5*Math.PI),this._context.lineTo(r+o,i+s),this._context.arc(r+o,i+s-o,o,.5*Math.PI,Math.PI),this._context.lineTo(r,i+o),this._context.arc(r+o,i+o,o,Math.PI,1.5*Math.PI),this._context.stroke(),this._context.restore()}FillArcRect(e,t,n){let r;e instanceof u.SolidBrush&&(r=e);let i=t.X,l=t.Y,s=t.Width,o=t.Height,a=n;this._context.save(),this.transform(),this._context.beginPath(),this._context.moveTo(i+a,l),this._context.fillStyle=r.Color.ToRgbaString(),this._context.lineTo(i+s-a,l),this._context.arc(i+s-a,l+a,a,1.5*Math.PI,2*Math.PI),this._context.lineTo(i+s,l+o-a),this._context.arc(i+s-a,l+o-a,a,0,.5*Math.PI),this._context.lineTo(i+a,l+o),this._context.arc(i+a,l+o-a,a,.5*Math.PI,Math.PI),this._context.lineTo(i,l+a),this._context.arc(i+a,l+a,a,Math.PI,1.5*Math.PI),this._context.fill(),this._context.restore()}set SmoothingMode(e){this._smoothingMode=e}DrawImage(e,t,n){let r=t,i=this.originX,l=this.originY,s=null;null!=this.intersectClip&&(s=this.intersectClip.Clone());let o=e.ImageEle,a=o.src,u=c.ImageCache.Get(a);if(null==u){u=o;let e=new Image;e.src=a,e.crossOrigin="Anonymous";let t=this;e.onload=function(n){t.DrawImageToCanvas(e,r,i,l,s),c.ImageCache.Put(a,e),t.EditableCanvas.M_EdtCustomEvtGrp.ImgLoadFinish&&t.ImageIsLoad()},e.onerror=t=>{this.ResetImageList(a),e.src=c.ImageCache.DefaultImgBase64,this.DrawImageToCanvas(e,r,i,l,s,n),this.EditableCanvas.M_EdtCustomEvtGrp.ImageLoadError&&this.EditableCanvas.M_EdtCustomEvtGrp.ImageLoadError({cptId:n.CptID,xId:n.XID,url:n.ImgInfo.ImgBase64})}}else u.crossOrigin="Anonymous",this.DrawImageToCanvas(u,r,i,l,s,n),this.EditableCanvas.M_EdtCustomEvtGrp.ImgLoadFinish&&this.ImageIsLoad()}ImageIsLoad(){let e=c.ImageCache.GetImagList();if(e&&e.Length>0){let t=!0;for(let n of e)if(t=null!=c.ImageCache.Get(n),!t)break;t&&this.EditableCanvas.M_EdtCustomEvtGrp.ImgLoadFinish&&!this.EditableCanvas.ImageLoadFinish&&this.EditableCanvas.M_EdtCustomEvtGrp.ImgLoadFinish()}}ResetImageList(e){let t=c.ImageCache.GetImagList();t&&t.Length>0&&(t.Remove(e),this.ImageIsLoad())}DrawImageToCanvas(e,t,n,r,i,l){this._context.save(),this.transform(n,r),i&&this.runClip(i);try{e.setAttribute("onerror","this.src="+c.ImageCache.DefaultImgBase64+";"),this._context.drawImage(e,t.X,t.Y,t.Width,t.Height)}catch(n){this.ResetImageList(e.src),e.src=c.ImageCache.DefaultImgBase64,this._context.drawImage(e,t.X,t.Y,t.Width,t.Height),this.EditableCanvas.M_EdtCustomEvtGrp.ImageLoadError&&this.EditableCanvas.M_EdtCustomEvtGrp.ImageLoadError({cptId:l.CptID,xId:l.XID,url:l.ImgInfo.ImgBase64})}this._context.restore()}DrawCurve(e,t,n){this._context.save(),this.transform(),this._context.strokeStyle=e.Color.ToRgbaString(),this._context.beginPath(),this._context.moveTo(n[0][0],n[0][1]);for(let e=1;e<n.length;e++)n.length-1!=e&&this._context.quadraticCurveTo(n[e][0],n[e][1],n[e+1][0],n[e+1][1]);this._context.stroke(),this._context.restore()}DrawPolygon(e,t,n){this._context.save(),this.transform(),this._context.beginPath(),e.forEach((e,t)=>{0==t?this._context.moveTo(e.x,e.y):this._context.lineTo(e.x,e.y)}),this._context.closePath(),this._context.fillStyle=t.Color.ToRgbaString(),this._context.fill(),this._context.strokeStyle=n.Color.ToRgbaString(),this._context.stroke(),this._context.restore()}FillPolygon(e,t){}ScaleTransform(e,t){}runClip(e){let t=this.intersectClip;e&&(t=e),null!=t&&(this._context.rect(0,0,t.Width,t.Height),this._context.clip())}transform(e,t){let n=this.originX,r=this.originY;e&&t&&(n=e,r=t);let i=window.devicePixelRatio,l=window.devicePixelRatio;i*=this.scaleX||1,l*=this.scaleY||1,this.isTranslateFirst?(this._context.translate(n,r),this._context.scale(i,l)):(this._context.scale(i,l),this._context.translate(n,r));let s=0;this.rotation>0&&(s=this.rotation*Math.PI/180,this._context.translate(this.origin[0],this.origin[1]),this._context.rotate(s),this._context.translate(-this.origin[0],-this.origin[1]))}TranslateTransform(e,t,n){this.originX=parseFloat(new a.Big(this.originX).add(e).toFixed(2)),this.originY=parseFloat(new a.Big(this.originY).add(t).toFixed(2))}RotateTransform(e){this.rotation+=e}TransformOrigin(e){this.origin=e}scale(e,t,n){this.isTranslateFirst=!!n,this.scaleX=e,this.scaleY=t}Save(){return null}Restore(e){}Resize(e,t){this.TransDpr(e)==this._context.canvas.width&&this.TransDpr(t)==this._context.canvas.height||(this._context.canvas.setAttribute("width",this.TransDpr(e)+""),this._context.canvas.setAttribute("height",this.TransDpr(t)+""),this._context.canvas.style.width=e+"px",this._context.canvas.style.height=t+"px")}TransDpr(e){return parseInt(e*window.devicePixelRatio+"")}SetMarginH(e){this._context.canvas.style.marginRight=e+"px"}SetMarginV(e){this._context.canvas.style.marginBottom=e+"px"}static FromImage(e){return null}Flush(){this._context.clearRect(0,0,this._context.canvas.width,this._context.canvas.height)}}t.Graphics=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageCache=void 0;const r=n(3);class i{static Put(e,t){this.cache.ContainsKey(e)||this.cache.Add(e,t)}static Get(e){return this.cache.ContainsKey(e)?this.cache.Get(e):null}static Clear(){this.cache.Clear()}static PutImage(e){this.imgList.Contains(e)||this.imgList.Add(e)}static ClearImgList(){this.imgList.Clear()}static GetImagList(){return this.imgList}}t.ImageCache=i,i.cache=new r.Dictionary,i.imgList=new r.List,i.DefaultImgBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAeNQTFRFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARmqk6wAAAKB0Uk5TAKhmbh0zQ0Q3JwUBO4TF9PrVllIIDXbc75UhBHPu+5sULdHsV2D2l3f+u3y+B6Us9Wr3JXK4Qr2Bhcr8EPM9HGQ1QYmOOYAmbUeYPinb+egi6QbnE+tK2J4M0wq3teUfnwvjKh5vWP0jtvi82mMx8SQPPHuIihXGQFCqAubCyas4DsvXLjpJr2lIXb+drodTRfLi8KkXzFvBsBbdYXC6zWh4IAsAAAABYktHRACIBR1IAAAACXBIWXMAAABIAAAASABGyWs+AAAHJklEQVR42u3d/V9URRQG8DEFkyVFERGQVQxE1ETMrNhSgyKsANEsDCupvKJiWSGFQu9lZe8v2nvzp7YrrsvenTNzzszAPbfPPD/fvXu/DLvP7N4ZEPJ/EpH0BQRIgDBPgHBLgHBLgHBLgHBLgHBLgHBLgHBLgHCLGrLiHsZZQYCsFIyzMkCYJUC4JUC4JUC4JUC4JUC4xStkVVX16nvX1KQakqm9b+26hcPq1m+o35hSSMOmxvJDNzc1pxDSsqW18uDs1m1pg7RtVx4t729PF6Rjh4TSuYyve2fIzi4JZ1dDaiC7pTZ7HkgJpEM3HoXsTQeke580pScNkJbt0pj9D6YAcsDskPIh/pCGVonJQfaQTSiHfJg7JNMocVnDHFKLdMhHmEMexUJ6mUPWYiG5x1hDMo9jIfIQa8hhtEMeYQ15Ag/ZzRrSh4f0s4asxkOeZA15Cg8ZYA15Gg8ZZA2pqUNDjrKGiPVoyCrekE6so3EZHC6QeizkGeaQjZuRkGddL7L+uSWFiCacYyjj6KgeHjFLXCDHsijIEUdHW37kR7uXEiK2ogbkuJvj2InCWYxj4gR5/iQC8oKbY9uLC6cxjYnbF3TtZseYm+NUb/FEhjFx/MrU2CUvjTs5ak6XTqWXOEJqXtY7XnnVyZE5s/hk2t8u12/jJ3bpHK+97uQQ/eWn042J8/2R43s1v1dvuDnOxk+okXi49dazH3CMub0+RHSu4pSwxMfN0MnzqqMbHd93Rd8FxVnB14mf29N9F+PHTl1y7EHx5lvKi4DGxNeCgcsDvbnSYHQecp1fieYTwC8sIPG4hOPtdy69O31lYPDoYVdEPjNTUpIkTBfVjL8n4ShfJzwhNeelLioJS0hmTOqjkLCE9EtTKiUcIT1Gh0LCENJ+TiISl/CDvH9BohKTsIO0Yb+biUm4QcBCN0mYQYqf0OkSXhBtoeslrCCGQtdKOEGMha6TcIJMQ1dbp5EU58KMIGCh52Z3mseEDwQu9EEhzBI2ELjQb9/cNkq4QOBCv3pNYCRMIM1z0EXOF/cLGCQ8IHChD83cPUgvYQGZ+AC6wJHFmx4GNJIR9dfp1pDoQ4udI3Ch7/io7EDdmKhjC4mycs/HVAdc6LnZ2KFkiSUkKtxU/GTGdFgsYKErln5QJXaQaOHm6Ke07+DhT+iq1VFEiRUkKt7knfuM4IAL/U6BOElsIFHpZnXr52gHXOjzwNsGSWIBiRbfdF/3BdIBF/oQ+FKjSOiQqHzxwHCEcsCFfvIy/CiChAyJ4osgug4gHHChxwrEWkKFRIrFHNNGxzi4BLqiQGwlREikXJSy4Zr+ajSf0I1rB7ESGiQCFtdc105XNJ/QEctrkRISJAIXCWmnK3ChXzUMJUFCgUSaxU6a6cqX4IPmcfNOlIQAibSLtsDpClzoQ9i5GkaCh0SGxWdzbcqLgAtdVyB0CRpicgDTFbjQ9QVClmAhZkd+uvJVxcPgQjcVCFWChGAciumK5it36uJzkwQHwTkqpitwoVvszzBIUBCsQ5ZPVzSFjioQkgQD+TqnOGTkhvqETXcvsXxRXFmQBRKL7rsVDEQ5HqPdLd+oz/ht8SK/A58UXSCEMTFDAEf+Jw78hO5MV+BCJxQIXmKEgI58zqpL+/Z0ZTYngZAKBC0xQXQOIb5X13Z+ugIXOrFAsBIDRP06L60o/eFH5eN/av8Z/NE5/iEC6BWvh+jHo5CqEUmL8wY/YEy0ENN4FDKJ3SK+kF8sCiQW+pfY5vEo5NebBIddgZSHfFsB5xBi4rTExrZAnCBYh36JdlnsC8QBgnfkqxH+VL44LgViDaE4BFiNZXErEEsI0SHErWEjxNf2VwrkN8T7bixANZZyxZODBFHFtPXJUI02n0CWBGLeVtc8pXm4jwLxAjE7tNXopUB8QDAOTTX6KRAPEP3rvBSoGr3+4QEHCG48CgGqsWsLCwjeIcBqNN8MWnoIyQFW45mWpCFEhxAH1Vumfvf1BmwJITvAarxBXrviE2LhAKvx5h/JQawcYDX+OZkUxNIBViNp7YpHiLUDrMbW2iQgDg6wGvdh1654hDg5BFSN2b+WG+LqgKrRebpChLg7wGp0nK7QID4cYDW6TVdIED8OsBqvu0xXKBBfDrAa6Utt7SB/+3II0fCP8hnIS23tID6XlAPV2Gg9XUlsbTxQjdbTlQQX+aur0Xa6kuRuBXU1Wk5XEt12oa7GbEfqIKJqVPU8VtOVhDfCANVoMV1JekcPUI306UrSEHFK/amRPF1JHAJVI3W6kjwEqkbidIUBBKpG2s4gFhBxq071fKTpCg+IqFZWI2FnEBcIUI3onUF8IEA1IncGcYIA1YjaGcQLAlUjcrrCCAJVo2lnED+IyKj/HhVqukKBLMM/0f5X+cQXPf8T7RQmQLglQLglQLglQLglQLglQLglQLglQLglQLglQLjlP4KT3g4G6dzuAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIyLTAzLTI4VDE1OjQ0OjMzKzA4OjAwZXSSXwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMi0wMy0yOFQxNTo0NDozMyswODowMBQpKuMAAABMdEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL2hvbWUvYWRtaW4vaWNvbi1mb250L3RtcC9pY29uX25jaDBsc3U4c3o3L2luc2VydHBpYy5zdmcjZ0w4AAAAAElFTkSuQmCC"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(270),i=n(49),l=n(5);class s{constructor(e,t){if(0===t.length)throw new l.IllegalArgumentException;this.field=e;const n=t.length;if(n>1&&0===t[0]){let e=1;for(;e<n&&0===t[e];)e++;e===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-e),i.default.arraycopy(t,e,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(0===e)return this.getCoefficient(0);const t=this.coefficients;let n;if(1===e){n=0;for(let e=0,i=t.length;e!==i;e++){const i=t[e];n=r.default.addOrSubtract(n,i)}return n}n=t[0];const i=t.length,l=this.field;for(let s=1;s<i;s++)n=r.default.addOrSubtract(l.multiply(e,n),t[s]);return n}addOrSubtract(e){if(!this.field.equals(e.field))throw new l.IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){const e=t;t=n,n=e}let o=new Int32Array(n.length);const a=n.length-t.length;i.default.arraycopy(n,0,o,0,a);for(let e=a;e<n.length;e++)o[e]=r.default.addOrSubtract(t[e-a],n[e]);return new s(this.field,o)}multiply(e){if(!this.field.equals(e.field))throw new l.IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,n=t.length,i=e.coefficients,o=i.length,a=new Int32Array(n+o-1),u=this.field;for(let e=0;e<n;e++){const n=t[e];for(let t=0;t<o;t++)a[e+t]=r.default.addOrSubtract(a[e+t],u.multiply(n,i[t]))}return new s(u,a)}multiplyScalar(e){if(0===e)return this.field.getZero();if(1===e)return this;const t=this.coefficients.length,n=this.field,r=new Int32Array(t),i=this.coefficients;for(let l=0;l<t;l++)r[l]=n.multiply(i[l],e);return new s(n,r)}multiplyByMonomial(e,t){if(e<0)throw new l.IllegalArgumentException;if(0===t)return this.field.getZero();const n=this.coefficients,r=n.length,i=new Int32Array(r+e),o=this.field;for(let e=0;e<r;e++)i[e]=o.multiply(n[e],t);return new s(o,i)}divide(e){if(!this.field.equals(e.field))throw new l.IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new l.IllegalArgumentException("Divide by 0");const t=this.field;let n=t.getZero(),r=this;const i=e.getCoefficient(e.getDegree()),s=t.inverse(i);for(;r.getDegree()>=e.getDegree()&&!r.isZero();){const i=r.getDegree()-e.getDegree(),l=t.multiply(r.getCoefficient(r.getDegree()),s),o=e.multiplyByMonomial(i,l),a=t.buildMonomial(i,l);n=n.addOrSubtract(a),r=r.addOrSubtract(o)}return[n,r]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);if(0!==n){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),0===t||1!==n){const t=this.field.log(n);0===t?e+="1":1===t?e+="a":(e+="a^",e+=t)}0!==t&&(1===t?e+="x":(e+="x^",e+=t))}}return e}}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(272);class i{static setGridSampler(e){i.gridSampler=e}static getInstance(){return i.gridSampler}}t.default=i,i.gridSampler=new r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(86),i=n(5);class l extends r.default{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t=!1,n=null,r=0,i=[0,0,0];for(;!t;){i=[0,0,0],n=l.findGuardPattern(e,r,!1,this.START_END_PATTERN,i);let s=n[0];r=n[1];let o=s-(r-s);o>=0&&(t=e.isRange(o,s,!1))}return n}static checkChecksum(e){return l.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(0===t)return!1;let n=parseInt(e.charAt(t-1),10);return l.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let t=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new i.FormatException;n+=t}n*=3;for(let r=t-2;r>=0;r-=2){let t=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new i.FormatException;n+=t}return(1e3-n)%10}static decodeEnd(e,t){return l.findGuardPattern(e,t,!1,l.START_END_PATTERN,new Array(l.START_END_PATTERN.length).fill(0))}static findGuardPattern(e,t,n,s,o){let a=e.getSize(),u=0,h=t=n?e.getNextUnset(t):e.getNextSet(t),d=s.length,c=n;for(let n=t;n<a;n++)if(e.get(n)!==c)o[u]++;else{if(u===d-1){if(r.default.patternMatchVariance(o,s,l.MAX_INDIVIDUAL_VARIANCE)<l.MAX_AVG_VARIANCE)return[h,n];h+=o[0]+o[1];let e=o.slice(2,o.length);for(let t=0;t<u-1;t++)o[t]=e[t];o[u-1]=0,o[u]=0,u--}else u++;o[u]=1,c=!c}throw new i.NotFoundException}static decodeDigit(e,t,n,s){this.recordPattern(e,n,t);let o=this.MAX_AVG_VARIANCE,a=-1,u=s.length;for(let e=0;e<u;e++){let n=s[e],i=r.default.patternMatchVariance(t,n,l.MAX_INDIVIDUAL_VARIANCE);i<o&&(o=i,a=e)}if(a>=0)return a;throw new i.NotFoundException}}t.default=l,l.MAX_AVG_VARIANCE=.48,l.MAX_INDIVIDUAL_VARIANCE=.7,l.START_END_PATTERN=[1,1,1],l.MIDDLE_PATTERN=[1,1,1,1,1],l.END_PATTERN=[1,1,1,1,1,1],l.L_PATTERNS=[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2]]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCorrectionLevelValues=void 0;const r=n(5);var i;!function(e){e[e.L=0]="L",e[e.M=1]="M",e[e.Q=2]="Q",e[e.H=3]="H"}(i=t.ErrorCorrectionLevelValues||(t.ErrorCorrectionLevelValues={}));class l{constructor(e,t,n){this.value=e,this.stringValue=t,this.bits=n,l.FOR_BITS.set(n,this),l.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return l.L;case"M":return l.M;case"Q":return l.Q;case"H":return l.H;default:throw new r.ArgumentException(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof l))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=l.FOR_BITS.size)throw new r.IllegalArgumentException;return l.FOR_BITS.get(e)}}t.default=l,l.FOR_BITS=new Map,l.FOR_VALUE=new Map,l.L=new l(i.L,"L",1),l.M=new l(i.M,"M",0),l.Q=new l(i.Q,"Q",3),l.H=new l(i.H,"H",2)},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ERROR_CORRECTION=0]="ERROR_CORRECTION",e[e.CHARACTER_SET=1]="CHARACTER_SET",e[e.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",e[e.MIN_SIZE=3]="MIN_SIZE",e[e.MAX_SIZE=4]="MAX_SIZE",e[e.MARGIN=5]="MARGIN",e[e.PDF417_COMPACT=6]="PDF417_COMPACT",e[e.PDF417_COMPACTION=7]="PDF417_COMPACTION",e[e.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",e[e.AZTEC_LAYERS=9]="AZTEC_LAYERS",e[e.QR_VERSION=10]="QR_VERSION"}(r||(r={})),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(297);class i extends r.default{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let n=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,n)}encodeCompressedGtinWithoutAI(e,t,n){for(let n=0;n<4;++n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*n,10);r/100==0&&e.append("0"),r/10==0&&e.append("0"),e.append(r)}i.appendCheckDigit(e,n)}static appendCheckDigit(e,t){let n=0;for(let r=0;r<13;r++){let i=e.charAt(r+t).charCodeAt(0)-"0".charCodeAt(0);n+=0==(1&r)?3*i:i}n=10-n%10,10==n&&(n=0),e.append(n)}}t.default=i,i.GTIN_SIZE=40},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPropertyCollection=void 0;const r=n(572),i=n(7),l=n(4);t.XPropertyCollection=class{constructor(){this.isModified=!1,this.xmlEleName=null,this.ArrExcludeProps_FromXML=["Attributes","XElements","FieldSettings","ValueBinding","ValidateStyle","DisplayFormat","Image","RulerSetting","Columns"],this.propMap=new Map}get Modified(){return this.isModified}get XmlEleName(){return this.xmlEleName}set XmlEleName(e){this.xmlEleName=e}IsEmpty(){return 0==this.propMap.size}HasProp(e){return this.propMap.has(e)}GetPropValue(e){return this.propMap.get(e)}UpdateProperty(e,t){null!=e&&null!=t&&this.HasProp(e)&&this.propMap.set(e,t)}KeepCommProps(e){if(null!=e)if(this.Count()<=0){let t=e.propMap.keys();for(let n of t)this.propMap.set(n,e.propMap.get(n))}else;}ReplacePropKey(e,t){e!=t&&this.HasProp(e)&&(this.propMap.set(t,this.propMap.get(e)),this.propMap.delete(e))}RemoveProperties(e){if(null!=e&&0!=e.length&&!this.IsEmpty())for(let t=0;t<e.length;t++)this.propMap.delete(e[t])}ToXML(e){let t=this.xmlEleName;null==t&&(t="[NoGrpProps]");let n=e.createElement(t);for(let t of this.propMap.keys()){const r=this.propMap.get(t);if(null!=r){let i=e.createElement(t);i.textContent=""+r,n.appendChild(i)}}return n}FromXML(e){if(this.propMap.clear(),null!=e&&e.hasChildNodes){let t=e.children;for(let e=0;e<t.length;e++){let n=t[e];if(1==n.nodeType){let e=n.nodeName;if(!l.default.IsNullOrEmpty(e)&&!this.ArrExcludeProps_FromXML.Contains(e)){let t=n.textContent;l.default.IsNullOrEmpty(t)||(e=e.trim(),this.ModifyProperty(e,t,null))}}}}}ModifyProperty(e,t,n){l.default.IsNullOrEmpty(e)||(null==t&&(t=n),"BackgroundColor"==e&&null==t?this.propMap.delete(e):this.propMap.set(e,t))}GetColorValue(e,t){let n=this.GetPropValue(e);return null==n?t:("string"==typeof n&&(n=new i.Color(n),this.SetColorValue(e,n,t)),n)}SetColorValue(e,t,n){this.ModifyProperty(e,t,n)}CopyFrom(e){if(this.propMap.clear(),null!=e&&0!=e.Count()){this.XmlEleName=e.XmlEleName;for(let t of e.propMap.keys())this.propMap.set(t,e.propMap.get(t))}}IsEqual(e){if(null==e)return!1;if(this.Count()!=e.Count())return!1;if(0==this.Count())return!0;let t=this.propMap.keys();for(let n of t){let t=new r.KeyValuePair(n,this.propMap.get(n)),i=new r.KeyValuePair(n,e.propMap.get(n));if(!t.IsEqual(i))return!1}return!0}Count(){return this.propMap.size}ToArray(){let e=[];for(let t of this.propMap.entries())e.push(new r.KeyValuePair(t[0],t[1]));return e}Clear(){this.propMap.clear()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XEleStyleFactory=void 0;const r=n(4),i=n(58),l=n(105),s=n(573),o=n(574);t.XEleStyleFactory=class{static CreatXEleStyle(e){if(r.default.IsNullOrEmpty(e))return null;let t=null;return t="XParagraphFlag"==e?new l.XParagraphFlagStyle:"XTextTableCell"==e?new s.XTextTableCellStyle:"XTextLabelElement"==e?new o.XTextLabelElementStyle:new i.XBaseEleStyle(!1),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XLabelEle=void 0;const r=n(43),i=n(10),l=n(0),s=n(2),o=n(4);class a extends l.XBaseElement{constructor(){super(),this.cursorType=s.ENumEleCursorSide.Both,this.labelType=s.ENumXLabelType.Common,this.selFrom=-1,this.selCount=0,super.formatBrushEnable=!0}get EleTypeName(){return"XLable"}get Text(){return this.propList.GetPropValue("Text")}set Text(e){this.propList.ModifyProperty("Text",e,null),this.IsLayoutValid=!1}get EleCursorAllowSide(){return this.cursorType}set EleCursorAllowSide(e){this.cursorType=e}get LabelType(){return this.labelType}set LabelType(e){this.labelType=e}get SelFrom(){return this.selFrom}set SelFrom(e){this.selFrom=e}get SelCount(){return this.selCount}set SelCount(e){this.selCount=e}CanBeInline(e=!1){if(!e)return!0;let t=l.XDomUtil.GetParentXInput(this);if(null!=t&&!1===t.IsPrint)return!1;let n=!1;return null==t||l.XDomUtil.HasContent(t,!1)||(n=!0),!n}ReCalcBaseSize(){if(!this.IsLayoutValid){let e=this.Text;if(o.default.IsNullOrEmpty(e))return this.SetSizeDPI(0,0,-1),void(this.IsLayoutValid=!0);let t=super.EleStyle;if(null!=t){let e=t.Font;if(null!=e){let t=r.GrapUtil.MeasureStrSize(null,e,1e3,this.Text);t.Height=i.DPITransUtil.TransFloatVal(e.SizeInPoints,72,96),this.SetSizeDPI(t.Width,t.Height,96),this.IsLayoutValid=!0}}}}GetInnerText(e){if(e)return this.Text;let t=super.EleStyle.DeleterIndex>=0?"":this.Text;return this.selFrom>=0&&this.selCount>0&&(t=t.substring(this.selFrom,this.selCount)),t}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r);let i=e instanceof a?e:null;null!=i&&(this.EleCursorAllowSide=i.EleCursorAllowSide,this.LabelType=i.LabelType,this.SelFrom=i.SelFrom,this.SelCount=i.SelCount)}ClearSelRange(){this.selFrom=-1,this.selCount=0}NeedSerialized(){return!1}}t.XLabelEle=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTableDeleteRowRedoUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t){super(),this.baseTable=e,this.deleteRow=t,null!=t&&(this.deleteIndex=t.Index)}IsValid(){return!0}CanUndo(){return!0}CanRedo(){return!0}Undo(){this.baseTable.Redo_InsertRow(this.deleteRow,this.deleteIndex)}Redo(){this.baseTable.Undo_InsertRow(this.deleteRow)}Clear(){}}t.TextTableDeleteRowRedoUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(66),s=(r=l)&&r.__esModule?r:{default:r},o=n(134);var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.substring(1),n));return r.bytes=e.split("").map((function(e){return e.charCodeAt(0)})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var e=this.bytes,n=e.shift()-105,r=o.SET_BY_CODE[n];if(void 0===r)throw new RangeError("The encoding does not start with a start character.");!0===this.shouldEncodeAsEan128()&&e.unshift(o.FNC1);var i=t.next(e,1,r);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:t.getBar(n)+i.result+t.getBar((i.checksum+n)%o.MODULO)+t.getBar(o.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var e=this.options.ean128||!1;return"string"==typeof e&&(e="true"===e.toLowerCase()),e}}],[{key:"getBar",value:function(e){return o.BARS[e]?o.BARS[e].toString():""}},{key:"correctIndex",value:function(e,t){if(t===o.SET_A){var n=e.shift();return n<32?n+64:n-32}return t===o.SET_B?e.shift()-32:10*(e.shift()-48)+e.shift()-48}},{key:"next",value:function(e,n,r){if(!e.length)return{result:"",checksum:0};var i=void 0,l=void 0;if(e[0]>=200){l=e.shift()-105;var s=o.SWAP[l];void 0!==s?i=t.next(e,n+1,s):(r!==o.SET_A&&r!==o.SET_B||l!==o.SHIFT||(e[0]=r===o.SET_A?e[0]>95?e[0]-96:e[0]:e[0]<32?e[0]+96:e[0]),i=t.next(e,n+1,r))}else l=t.correctIndex(e,r),i=t.next(e,n+1,r);var a=l*n;return{result:t.getBar(l)+i.result,checksum:a+i.checksum}}}]),t}(s.default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mod10=function(e){for(var t=0,n=0;n<e.length;n++){var r=parseInt(e[n]);(n+e.length)%2==0?t+=r:t+=2*r%10+Math.floor(2*r/10)}return(10-t%10)%10},t.mod11=function(e){for(var t=0,n=[2,3,4,5,6,7],r=0;r<e.length;r++){var i=parseInt(e[e.length-1-r]);t+=n[r%n.length]*i}return(11-t%11)%11}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e,t){return r({},e,t)}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.BarcodeInfo=t.CodeType=void 0,function(e){e[e.Barcode=0]="Barcode",e[e.QRcode=1]="QRcode"}(r=t.CodeType||(t.CodeType={}));const i=n(80);class l{constructor(){this._No=null,this._Type=null,this._ExtendAttr1=null,this._Name=null,this._conceptDomainCode=null,this._Content=null,this._CodeStyleStr=null,this._TextAlignStyleStr=null,this._IsShowText=null,this._attr_FgHide=!1,this._BarcodeLineWidth=null,this._BarcodeLineHeight=74,this._CodeChoiceStyle=null,this._GetEditBarcodeImage=null,this._DataEleName=null,this._DateEleCode=null,this._SourceName=null,this._PropName=null,this._Expression=null,this._IsShowLabelText=null,this._LabelText=null,this._LabelShowPosition=null,this._IsAllowDrag=null}get No(){return this._No}set No(e){this._No=e}get Type(){return this._Type}set Type(e){this._Type=e}get ExtendAttr1(){return this._ExtendAttr1}set ExtendAttr1(e){this._ExtendAttr1=e}get Name(){return this._Name}set Name(e){this._Name=e}get CptID(){return this._conceptDomainCode}set CptID(e){this._conceptDomainCode=e}get Content(){return this._Content}set Content(e){this._Content=e}get CodeStyleStr(){return this._CodeStyleStr}set CodeStyleStr(e){this._CodeStyleStr=e}get TextAlignStyleStr(){return this._TextAlignStyleStr}set TextAlignStyleStr(e){this._TextAlignStyleStr=e}get IsShowText(){return this._IsShowText}set IsShowText(e){this._IsShowText=e}get Attr_FgHide(){return this._attr_FgHide}set Attr_FgHide(e){this._attr_FgHide=e}get BarcodeLineWidth(){return this._BarcodeLineWidth}set BarcodeLineWidth(e){this._BarcodeLineWidth=e}get BarcodeLineHeight(){return this._BarcodeLineHeight}set BarcodeLineHeight(e){this._BarcodeLineHeight=e}get CodeChoiceStyle(){return this._CodeChoiceStyle}set CodeChoiceStyle(e){this._CodeChoiceStyle=e}get GetEditBarcodeImage(){return this._GetEditBarcodeImage}set GetEditBarcodeImage(e){this._GetEditBarcodeImage=e}get DataEleName(){return this._DataEleName}set DataEleName(e){this._DataEleName=e}get DateEleCode(){return this._DateEleCode}set DateEleCode(e){this._DateEleCode=e}get SourceName(){return this._SourceName}set SourceName(e){this._SourceName=e}get PropName(){return this._PropName}set PropName(e){this._PropName=e}get Expression(){return this._Expression}set Expression(e){this._Expression=e}get IsShowLabelText(){return this._IsShowLabelText}set IsShowLabelText(e){this._IsShowLabelText=e}get LabelText(){return this._LabelText}set LabelText(e){this._LabelText=e}get LabelShowPosition(){return this._LabelShowPosition}set LabelShowPosition(e){this._LabelShowPosition=e}get IsAllowDrag(){return this._IsAllowDrag}set IsAllowDrag(e){this._IsAllowDrag=e}get GetTextInfo(){return new l}GetDefaltBarcodeInfo1(e){let t=this.GetTextInfo;return t.BarcodeLineWidth=7,t.No=i.XInputUtil.GetInstance().GetUniqueCode(),t.IsShowText=!1,t.CodeChoiceStyle=e?r.QRcode:r.Barcode,t}}t.BarcodeInfo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeInfo=void 0;t.ShapeInfo=class{get No(){return this._No}set No(e){this._No=e}get Type(){return this._Type}set Type(e){this._Type=e}get Name(){return this._Name}set Name(e){this._Name=e}get ShapeKey(){return this._ShapeKey}set ShapeKey(e){this._ShapeKey=e}get ShapeText(){return this._ShapeText}set ShapeText(e){this._ShapeText=e}get RoundAngle(){return this._RoundAngle}set RoundAngle(e){this._RoundAngle=e}get HorEllipseNum(){return this._HorEllipseNum}set HorEllipseNum(e){this._HorEllipseNum=e}get VerEllipseNum(){return this._VerEllipseNum}set VerEllipseNum(e){this._VerEllipseNum=e}get AlignKey(){return this._AlignKey}set AlignKey(e){this._AlignKey=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MedExpressionItemInfo=void 0;t.MedExpressionItemInfo=class{get Type(){return this._Type}set Type(e){this._Type=e}get Text(){return this._Text}set Text(e){this._Text=e}get IconName(){return this._IconName}set IconName(e){this._IconName=e}get Name(){return this._Name}set Name(e){this._Name=e}get DefaultValue(){return this._DefaultValue}set DefaultValue(e){this._DefaultValue=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12);n(326);const i=n(12),l=n(109),s=n(225);t.default=function(){class e extends i.Component{constructor(e,t){super(e,t),this.isInputIME=!1,this.labelRef=r.createRef(),this._onCompositionStart=e=>{this.props.disabled||(this.isInputIME=!0)},this._onCompositionEnd=e=>{this.props.disabled||(this.isInputIME=!1,this.props.onChange&&this.props.onChange(e,Object.assign({},this.props)))},this._handleChange=e=>{this.isInputIME||this.props.onChange&&this.props.onChange(e,Object.assign({},this.props))},this._onKeypress=e=>{this.props.disabled||(this.props.onKeypress&&this.props.onKeypress(e,Object.assign({},this.props)),13==e.which&&this._onEnter(e))},this._onEnter=e=>{this.props.disabled||(this._valueChanged(),this.props.onEnter&&this.props.onEnter(e,Object.assign({},this.props)))},this._onBlur=e=>{this.props.disabled||(this._valueChanged(),this._validate(),this.props.onBlur&&this.props.onBlur(e,Object.assign({},this.props)))},this._clearButtonClick=e=>{this.props.disabled||(this.inputRef.current.value="",this.props.onClear&&this.props.onClear(Object.assign({},this.props)),this._valueChanged())},this.value=e.value||"",this.state={isRenderTip:!1,isValid:!0},this.inputRef=e.inputRef}componentDidMount(){this.inputRef.current.value=this.props.value,this._isRenderTip()}componentDidUpdate(e,t,n){e.value!=this.props.value&&(this.props.triggerValueChange&&this.props.onValueChanged&&this.props.onValueChanged(this.props.value,this.value,Object.assign({},this.props)),this.value=this.props.value),this.inputRef.current.value=this.props.value,!this.props.isVerify||e.value==this.props.value&&e.isVerify==this.props.isVerify||this.props.onValid&&this.props.onValid(this._validate())}_getLabelWidthInfo(){let{labelText:e,labelWidth:t}=this.props,n=e,r=parseInt(t),i=l.DomUtils.textWidth(n,"font-size-16");return n&&("auto"===t||0==r||isNaN(r))&&(r=i),{labelWidth:r,textWidth:i}}_isRenderTip(){const e=this._getLabelWidthInfo();let t=e.labelWidth<e.textWidth;t&&this.setState({isRenderTip:t})}renderLabel(){let{labelAlign:e,labelText:t,labelWidth:n,height:i}=this.props,l=e||"left";const o=s.default("pango-input-label",{["label-align-"+l]:l});let a=t,u=parseInt(i)+"px";return a&&r.createElement("label",{ref:this.labelRef,className:o,style:{width:this._getLabelWidthInfo().labelWidth,lineHeight:u}},a)}_valueChanged(){let e=this.inputRef.current.value;e!=this.value&&(this.props.triggerValueChange&&this.props.onValueChanged&&this.props.onValueChanged(e,this.value,Object.assign({},this.props)),this.value=e)}_validate(){if(this.props.disabled)return!0;const{required:e,regex:t,minLength:n,errorMessage:r,labelText:i}=this.props,l=this.inputRef.current.value;let s;return e&&!l?(this._errorMsg=r||(i?"请输入"+i:"请输入必填项"),this.setState({isValid:!1}),s=!1):n&&(null==l?void 0:l.length)<n?(this._errorMsg="输入长度不能小于"+n,this.setState({isValid:!1}),s=!1):t&&!new RegExp(t,"g").test(l)?(this._errorMsg=r||"输入格式错误",this.setState({isValid:!1}),s=!1):(this._errorMsg="",this.setState({isValid:!0}),s=!0),s}render(){const{id:e,required:t,clearable:n,disabled:i,height:o,width:a,top:u,left:h,position:d,visible:c,placeholder:p,maxLength:f,inputClass:g,type:m,readonly:E,onKeyup:C,onKeydown:A,onClick:y,onFocus:I,onMouseover:S,onMouseout:_,onMouseDown:w,childRender:b}=this.props,{isValid:x}=this.state,P=s.default("pango-input--wrap",{"is-required":t,"is-input-error":!x}),v=s.default("pango-input",{"is-disabled":i,"pango-input-clearable":n});let T=u+"px",M=h+"px";const L=l.DomUtils.convertSize(o),D=l.DomUtils.convertSize(a);let R={top:T,left:M,display:c?"inline-block":"none"},F={};(L.indexOf("%")>=0||D.indexOf("%")>=0)&&(F={width:D,height:L},R=Object.assign(Object.assign({},R),F));const N={position:d};return Object.assign(R,N),r.createElement("div",{className:P,style:R},this.renderLabel(),r.createElement("div",{className:v+" "+g,style:F},r.createElement("input",{key:e,ref:this.inputRef,type:m,className:"pango-input-inner",style:{height:L,lineHeight:L,width:D},placeholder:p,readOnly:i||E,maxLength:f,autoComplete:"off",spellCheck:"false",onChange:this._handleChange,onKeyUp:e=>{C&&C(e,Object.assign({},this.props))},onKeyDown:e=>{A&&A(e,Object.assign({},this.props))},onKeyPress:this._onKeypress,onClick:e=>{!i&&y&&y(e,Object.assign({},this.props))},onFocus:e=>{I&&I(e,Object.assign({},this.props))},onBlur:this._onBlur,onMouseOver:e=>{S&&S(e,Object.assign({},this.props))},onMouseOut:e=>{_&&_(e,Object.assign({},this.props))},onMouseDown:e=>{w&&w(e,Object.assign({},this.props))},onCompositionStart:this._onCompositionStart,onCompositionEnd:this._onCompositionEnd}),b&&b,n&&r.createElement("span",{className:"pango-input-clearable-wrap",onClick:this._clearButtonClick},r.createElement("i",{className:"pango-input-icon pango-icon-clear2",style:{lineHeight:L}})),this.props.children,!x&&r.createElement("div",{className:"pango-input-error-message"},this._errorMsg)))}}return e.defaultProps={height:32,width:200,visible:!0,triggerValueChange:!0,errorMessage:""},r.forwardRef((t,n)=>r.createElement(e,Object.assign({},t,{inputRef:n})))}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RulerInfo=void 0;const r=n(8),i=n(14);t.RulerInfo=class{constructor(e="Default"){"Rectangle"==e?this.DefaultInit_Rect():this.DefaultInit()}get Name(){return this._Name}set Name(e){this._Name=e}get ShowStyle(){return this._ShowStyle}set ShowStyle(e){this._ShowStyle=e}get MinScale(){return this._MinScale}set MinScale(e){this._MinScale=e}get MaxScale(){return this._MaxScale}set MaxScale(e){this._MaxScale=e}get ScaleDigit(){return this._ScaleDigit}set ScaleDigit(e){this._ScaleDigit=e}get ScaleSpace(){return this._ScaleSpace}set ScaleSpace(e){this._ScaleSpace=e}get ScaleShowSpace(){return this._ScaleShowSpace}set ScaleShowSpace(e){this._ScaleShowSpace=e}get ScaleUnit(){return this._ScaleUnit}set ScaleUnit(e){this._ScaleUnit=e}get MaxScalePreText(){return this._MaxScalePreText}set MaxScalePreText(e){this._MaxScalePreText=e}get ExprssionText(){return this._ExprssionText}set ExprssionText(e){this._ExprssionText=e}get IsShowFirstRowUnit(){return this._IsShowFirstRowUnit}set IsShowFirstRowUnit(e){this._IsShowFirstRowUnit=e}get RulerNum(){return this._RulerNum}set RulerNum(e){this._RulerNum=e}get HAlignStr(){return this._HAlignStr}set HAlignStr(e){this._HAlignStr=e}get VAlignStr(){return this._VAlignStr}set VAlignStr(e){this._VAlignStr=e}DefaultInit(){this.Name="刻度尺",this.ShowStyle="Default",this.MinScale=0,this.MaxScale=10,this.ScaleSpace=1,this.ScaleShowSpace=1,this.MaxScalePreText="",this.IsShowFirstRowUnit=!1,this.ScaleUnit="",this.ScaleDigit=0,this.HAlignStr="Center",this.VAlignStr="Center"}DefaultInit_Rect(){this.Name="矩形标尺",this.ShowStyle="Rectangle",this.MinScale=0,this.MaxScale=2.5,this.ScaleSpace=.25,this.ScaleShowSpace=2,this.MaxScalePreText=">",this.IsShowFirstRowUnit=!1,this.ScaleUnit="h",this.ScaleDigit=1,this.HAlignStr="Center",this.VAlignStr="Center"}ToXML(e){let t=e.createElement("RulerSetting"),n=e.createElement("Name");return n.textContent=this.Name,t.appendChild(n),n=e.createElement("ShowStyle"),n.textContent=this.ShowStyle,t.appendChild(n),n=e.createElement("MinScale"),n.textContent=this.MinScale.toString(),t.appendChild(n),n=e.createElement("MaxScale"),n.textContent=this.MaxScale.toString(),t.appendChild(n),n=e.createElement("ScaleDigit"),n.textContent=this.ScaleDigit.toString(),t.appendChild(n),n=e.createElement("ScaleSpace"),n.textContent=this.ScaleSpace.toString(),t.appendChild(n),n=e.createElement("ScaleShowSpace"),n.textContent=this.ScaleShowSpace.toString(),t.appendChild(n),n=e.createElement("ScaleUnit"),n.textContent=this.ScaleUnit,t.appendChild(n),n=e.createElement("MaxScalePreText"),n.textContent=this.MaxScalePreText,t.appendChild(n),n=e.createElement("IsShowFirstRowUnit"),n.textContent=this.IsShowFirstRowUnit.toString(),t.appendChild(n),n=e.createElement("ExprssionText"),n.textContent=this.ExprssionText,t.appendChild(n),t}FromXML(e){let t=i.XmlDomUtil.GetSingleNode(e,"RulerSetting");if(null!=t){let e=i.XmlDomUtil.GetSingleNode(t,"Name");null!=e&&(this.Name=e.textContent),e=i.XmlDomUtil.GetSingleNode(t,"ShowStyle"),null!=e&&(this.ShowStyle=e.textContent),e=i.XmlDomUtil.GetSingleNode(t,"MinScale"),null!=e&&(this.MinScale=r.CNumUtil.TryParseFloat(e.textContent,this.MinScale)),e=i.XmlDomUtil.GetSingleNode(t,"MaxScale"),null!=e&&(this.MaxScale=r.CNumUtil.TryParseFloat(e.textContent,this.MaxScale)),e=i.XmlDomUtil.GetSingleNode(t,"ScaleDigit"),null!=e&&(this.ScaleDigit=r.CNumUtil.TryParseInt(e.textContent,this.ScaleDigit)),e=i.XmlDomUtil.GetSingleNode(t,"ScaleSpace"),null!=e&&(this.ScaleSpace=r.CNumUtil.TryParseFloat(e.textContent,this.ScaleSpace)),e=i.XmlDomUtil.GetSingleNode(t,"ScaleShowSpace"),null!=e&&(this.ScaleShowSpace=r.CNumUtil.TryParseInt(e.textContent,this.ScaleDigit)),e=i.XmlDomUtil.GetSingleNode(t,"ScaleUnit"),null!=e&&(this.ScaleUnit=e.textContent),e=i.XmlDomUtil.GetSingleNode(t,"MaxScalePreText"),null!=e&&(this.MaxScalePreText=e.textContent),e=i.XmlDomUtil.GetSingleNode(t,"IsShowFirstRowUnit"),null!=e&&(this.IsShowFirstRowUnit=r.CNumUtil.TryParseBool(e.textContent,this.IsShowFirstRowUnit)),e=i.XmlDomUtil.GetSingleNode(t,"ExprssionText"),null!=e&&(this.ExprssionText=e.textContent)}}ToString(){return this.RulerNum.ToString("0.00")}GetScaleFormatStr(){let e="";this.ScaleDigit>0&&(e="0.");for(let t=0;t<this.ScaleDigit;t++)e+="#";return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FractionType=void 0,function(e){e[e.Vert=1]="Vert",e[e.Oblique=2]="Oblique",e[e.Hert=3]="Hert"}(t.FractionType||(t.FractionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XLabelPainter=void 0;const r=n(0),i=n(32),l=n(11),s=n(43),o=n(30),a=n(47);class u extends a.XBasePainter{PaintElement(e,t,n,a,u){let h=r.XDomUtil.GetParentXInput(e);if((null==h||u!=l.ENumOutTp.CsPrint||!1!==h.IsPrint)&&this.NeedDrawText(e,u)){let l=e.EleStyle,h=o.DefineDPI.GetOutDPI(u),d=e.GetInnerText(!0)||"",c=e.GetBoundsDPI(h);super._PaintBkgColor_(t,n,e,c,h);let p=l.Font;if(null!=p){r.XCharacterEle.Fnt_Mtc.SetFont(p);this.CalcXOffsetAlign(t,p,d,c.Width);n.Color=l.ForeColor;const o=s.GrapUtil.GetDefaultStrFormat();if(e instanceof i.XTextLabelElement&&e.GetRowDrawDic().Count()>1){let r=e.GetRowDrawDic(),i=c.Height/r.Count();i<0&&(i=0);let l=0;for(let e of r)t.DrawString(e.Value,p,n,c.X,c.Y+l*i,o),l++}else{if(null==d)return;if(e instanceof r.XPageNumEle){let e=s.GrapUtil.MeasureCharWidth(null,p,500,d);t.DrawString(d,p,n,c.X+(c.Width-e)/2,c.Y,o)}else t.DrawString(d,p,n,c.X,c.Y,o)}this._PaintUnderline_(t,a,e,c,h)}}}CalcXOffsetAlign(e,t,n,r){return 0}NeedDrawText(e,t){let n;return t!=l.ENumOutTp.UI_Show&&e instanceof r.XPageBreakLabel?(n=!1,n):(n=!0,n)}}t.XLabelPainter=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPageNumEle=void 0;const r=n(10),i=n(0),l=n(43);class s extends i.XBaseResizableElement{get EleTypeName(){return"XPageInfo"}constructor(){super(),this.Width=400,this.PageNumStyle="Arabic",super.IsAutoHeight=!0}get PageNumStyle(){return this.propList.GetPropValue("ListSernoStyle")}set PageNumStyle(e){this.propList.ModifyProperty("ListSernoStyle",e,null)}get FormatString(){return this.propList.GetPropValue("FormatString")}set FormatString(e){this.propList.ModifyProperty("FormatString",e,null)}ReCalcBaseSize(){let e=this.GetInnerText(!1);if(!this.IsLayoutValid){let t=super.EleStyle;if(null!=t){let n=t.Font;if(null!=n){let t=e.replace("[%PageIndex%]","999").replace("[%NumOfPages%]","999").replace("[%LocalPageIndex%]","999").replace("[%LocalNumOfPages%]","999").replace("[%AssociatPageIndex%]","999"),i=l.GrapUtil.MeasureCharWidth(null,n,500,t),s=r.DPITransUtil.TransFloatVal(n.SizeInPoints,72,96);this.SetSizeDPI(i,s,96),this.IsLayoutValid=!0}}}}GetInnerText(e){return this.getValueByFormat(this.FormatString,this.PageNumStyle)}_AfterFromXML_(){super.IsAutoHeight=!0,super._AfterFromXML_()}}t.XPageNumEle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XHistoryUtil=void 0;const r=n(2),i=n(350),l=n(0);class s{static MergeOpType(e){return e==r.ENumEdtType.Backspace&&(e=r.ENumEdtType.Delete),e}static GetPNEles_OnEleRange(e,t){let n=[],r=s._GetPrevEle_SameLv(e),i=s._GetNextEle_SameLv(t);return n=[r,i],n}static RemoveHistory_OnEles(e,t){let n=null==e?0:e.length;if(n>0)for(let r=0;r<n;r++)s.RemoveHistory_OnEle(e[r],t)}static RemoveHistory_OnEle(e,t){let n=l.XDomUtil.GetUserHistoryWrap(e),r=null==n?null:n.AddHist;if(null!=r&&r.GetRelEleCnt()>0){let n=r.RemoveRelEle(e);if(null!=t){let l=new i.HistoryRelEleUndo(r,e,n,!1);t.AddItem(l)}}}static _GetPrevEle_SameLv(e){let t=null==e?null:e.Parent;if(null==t)return null;if(e!=t.GetChildEle(0)){let n=t.GetChildInx(e);return t.GetChildEle(n-1)}let n=t.Parent,r=null==n?-1:n.GetChildInx(t);if(r<=0)return null;let i=n.GetChildEle(r-1);return i instanceof l.XBaseContainer?i.GetLastChildEle():null}static _GetNextEle_SameLv(e){let t=null==e?null:e.Parent;if(null==t)return null;if(e!=t.GetLastChildEle()){let n=t.GetChildInx(e);return t.GetChildEle(n+1)}let n=t.Parent,r=null==n?-1:n.GetChildInx(t);if(r<=0)return null;let i=n.GetChildEle(r+1);return i instanceof l.XBaseContainer?i.GetChildEle(0):null}}t.XHistoryUtil=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrTooltipManager=void 0;const r=n(338),i=n(4),l=n(731);class s{constructor(){this._tipRender=null,this._tipInfo=null,this._tipRender=new r.XToolTipRender,this._tipInfo=new l.EmrTooltipInfo}static get Instance(){return s._instance}get TipInfo(){return this._tipInfo}RefreshTooltip(){i.default.IsNullOrEmpty(this._tipInfo.TipMsg)?this._tipRender.Hide():!this._tipInfo.IsTipMsgChanged&&this._tipRender.IsShowing||(this._tipRender.IsShowing&&this._tipRender.Hide(),this._tipInfo.IsTipSizeValid()?this._tipRender.Show2(this._tipInfo.TipMsg,this._tipInfo.TipRect,r.Position.TopLeft,r.Position.BottomLeft):this._tipRender.Show(this._tipInfo.TipMsg,this._tipInfo.TipPos))}HideTooltip(){this._tipInfo.Clear(),this._tipRender.Hide()}}t.EmrTooltipManager=s,s._instance=new s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetViewModeBase=void 0;const r=n(26),i=n(2),l=n(16),s=n(7),o=n(4),a=n(1);class u extends a.XBaseAction{constructor(){super(),super.OpType=i.ENumActOpType.StyleEdit}IsEnable(e=!1){return super.IsEnableForCurWkMode(!1)}Execute(e){let t;if(this.resMsg.Clear(),null==e||e.length<1)this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName+" 调用参数有误",this.MessageError(),t=this.resMsg;else{let n=e[0],i=super.GetEdtCtrl(),l=i.M_EleEvtModel,o=this._UpdateViewMode(l,n);if(o[0]||o[1]){let e=i.M_XDocsUtil.MGet_Documents();for(let t=0;t<e.length;t++){let n=e[t];if(o[0]){let e=l.ViewMode.IsCleanViewMode;this._TrySwitchXInputBkgText(e,n),this._Reset_EleFocused(l)}else if(o[1]){i.BackColor=i.M_IsWebView?s.Color.White:r.TextDocInitInfo.GetInstance().ViewBackColor;let e=i.MGetPageFmt(0);n.GetPageFmt().TranstoQiPageFmt(e,i.M_IsWebView)}n.InvalidLayout()}super._RefreshPageAndMoveCaret(!0),t=this.resMsg}else t=this.resMsg}return t}_UpdateViewMode(e,t){let n=this.ActName(),r=e.ViewMode,i=new Array(2);return null!=n&&("A_SetViewMode_Complex"!=n&&"A_SetViewMode_Clean"!=n?"A_SetViewMode_Page"!=n&&"A_SetViewMode_Web"!=n||(i[1]=r.IsWebViewMode!=t,r.IsWebViewMode=t):(i[0]=r.IsCleanViewMode!=t,r.IsCleanViewMode=!0)),e.SyncViewModelToXDoc(),i}_TrySwitchXInputBkgText(e,t){let n=t.AssistFunc.XDocXInputCache.GetAllItems(),r=null==n?0:n.length;if(r>0){let t=0;for(;t<r;){let r=n[t],i=r.BackgroundText;if(!o.default.IsNullOrEmpty(i)){l.XDomUtil.FullDelTrace(r.GetFirstChildBaseEle(!0))||l.XDomUtil.FullDelTrace(r)&&(e?r.DynamicShowHideBackEle():r.RemoveChild(r.GetBackTextXStrEle()))}t++}}}_Reset_EleFocused(e){let t=e.EleClickedWrap.LineEleIxFocused,n=t.RefreshEleObj(!1);if(l.XDomUtil.FullDelTrace(n)){let r=l.XDomUtil.GetParentXInput(n,!1);if(null!=r){let n;if(l.XDomUtil.FullDelTrace(r.GetFirstChildBaseEle(!0))){let t=r.Parent,i=t.GetChildInx(r),l=e.ViewMode.IsCleanViewMode;n=t.GetChildBaseEle(i+1,l)}else n=r.GetLastChildEle();t.ReplaceEle(n)}}}}t.A_SetViewModeBase=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputFieldUtil=void 0;const r=n(221),i=n(88);class l{static InsertValiuate(e,t,n,r){let i;return 0==r.length||null==r[0]?(t.MsgLevel=7,t.MsgStr=e+" 外部传入的数据为null,开始弹窗....",i=null):r.length<1?(t.MsgLevel=2,t.MsgStr=e+" 调用参数有误",i=null):i=r[0],i}static GetInputFildType(){null==l._tempInputEle&&(l._tempInputEle=new i.XInputEle)}static GetChoiceGroupType(){null==l._tempChoiceGroupEle&&(l._tempChoiceGroupEle=new r.XChoiceGroupEle)}static OutInputFieldDetailMsg(e){}}t.InputFieldUtil=l,l._tempInputEle=null,l._tempChoiceGroupEle=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageNumFormWrap=void 0;const r=n(2),i=n(793),l=n(364),s=n(4);t.PageNumFormWrap=class{ShowPageNumForm(e,t,n=r.ENumWorkMode.Design,i){let l;if(null==e)l=!1;else{e.FormatString=i[1].replace("AssociatPageIndex","PageIndex"),e.PageNumStyle=i[0];let t=this._BuildPageNumInfo(e);l=!0,null==t?l=!1:(this._BuildPageNumInfo(e),this._BuildXPageNumEle(t,e),l=!0)}return l}_BuildPageNumInfo(e){let t=new l.InsertPageNumbersInfo;return t.NumberDisplayStyle=e.PageNumStyle,t.PageChkResult=this._ChkPageNumTypes(e.FormatString),t.FormatStr=e.FormatString,t}_BuildXPageNumEle(e,t){t.PageNumStyle=e.NumberDisplayStyle,t.FormatString=e.FormatStr}_ChkPageNumTypes(e){let t,n=i.EmrCheckBoxType.Default;return s.default.IsNullOrEmpty(e)||(e.indexOf("[%PageIndex%]")>=0&&(n|=i.EmrCheckBoxType.PageIndex),e.indexOf("[%NumOfPages%]")>=0&&(n|=i.EmrCheckBoxType.TotalPageCnt),e.indexOf("[%LocalPageIndex%]")>=0&&(n|=i.EmrCheckBoxType.LoacalPageIndex),e.indexOf("[%LocalNumOfPages%]")>=0&&(n|=i.EmrCheckBoxType.LoacalTotalPageCnt)),t=n,t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){}static get TeechImg(){return this._teechImg}static set TeechImg(e){this._teechImg=e}static get Adaptive(){return this._adaptive}static set Adaptive(e){this._adaptive=e}static get ShowRule(){return this._showRule}static set ShowRule(e){this._showRule=e}}r._teechImg=0,r._showRule=!0,t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleStyleUndo=t.ENumSubset=void 0;const r=n(0),i=n(58),l=n(23);var s;!function(e){e[e.All=0]="All",e[e.Paragraph=1]="Paragraph"}(s=t.ENumSubset||(t.ENumSubset={}));class o extends l.IXUndoable{constructor(e,t){super(),this.styleSubset=s.All,this.relEle=null,this.oldStyle=null,this.newStyle=null,this.relEle=e,this.styleSubset=t,null!=e&&(this.oldStyle=new i.XBaseEleStyle(!1),this.oldStyle.CopyFrom(e.EleStyle,!0))}ReadNewStyle(){if(null!=this.newStyle&&this.newStyle.Clear(),null!=this.relEle){let e=this.relEle.EleStyle;this.newStyle=new i.XBaseEleStyle(!1),this.newStyle.CopyFrom(e,!0)}}IsValid(){return null!=this.relEle&&null!=this.oldStyle&&null!=this.newStyle}CanUndo(){return null!=this.relEle&&null!=this.oldStyle}CanRedo(){return null!=this.relEle&&null!=this.newStyle}Undo(){if(this.CanUndo()){let e=this.relEle.EleStyle;switch(this.styleSubset){case s.All:e.CopyFrom(this.oldStyle,!0);break;case s.Paragraph:e.CopyOnlyParaStyleFrom(this.oldStyle)}let t=this.relEle instanceof r.XBaseInputEle?this.relEle:null;null==t?this.relEle.NotifyLayoutChanged(!0,!1):t.ResetInnerChildrenStyles(!0)}}Redo(){if(this.CanRedo()){let e=this.relEle.EleStyle;switch(this.styleSubset){case s.All:e.CopyFrom(this.newStyle,!0);break;case s.Paragraph:e.CopyOnlyParaStyleFrom(this.newStyle)}let t=this.relEle instanceof r.XBaseInputEle?this.relEle:null;null==t?this.relEle.NotifyLayoutChanged(!0,!1):t.ResetInnerChildrenStyles(!0)}}Clear(){this.relEle=null,null!=this.oldStyle&&this.oldStyle.Clear(),null!=this.newStyle&&this.newStyle.Clear()}}t.EleStyleUndo=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetParaSerno=void 0;const r=n(6),i=n(233),l=n(117),s=n(3),o=n(4),a=n(13),u=n(8),h=n(1),d=n(240);class c extends h.XBaseAction{Execute(e){let t=e[0],n=u.CNumUtil.TryParseBool(e[1],!1),r=u.CNumUtil.TryParseInt(e[2],-1),i=super.GetEdtCtrl(),l=new a.UndoGroup,s=!1;this._SetLabelSernoBefore(null,r,i);let o=this.ActName();return null!=o&&("SetParaSingleSerno"!=o&&"SetParaMuliSerno"!=o?"ReStartSerno"!=o?"ContineSerno"==o&&(s=this.ContineSerno(i,s)):s=this.SetParaghLabelSerno(null,r,s):s=this.SetParaghLabelSerno2(null,t,n,l,s,r)),s&&(super._AddUndoItem(l),super._RefreshPageAndMoveCaret(!0,!0)),super.Execute(e)}_SetLabelSernoBefore(e,t,n){let r=this.ActName();null!=r&&("SetParaSingleSerno"!=r&&"SetParaMuliSerno"!=r?"ReStartSerno"==r&&this._BulidReStartSernoParaghs(n):this._GetArrParaghOfSelLines(n))}IsEmptyLine(e){let t=e.OwnerLine;return null==t||t.ElementCnt<2}GetLabelSernoByParagh(e){let t=0,n=e.Parent,r=e.FindPrevParagh(null);return null!=r&&(t=1+n.GetChildInx(r)),n.GetChildEle(t)}GetCurrentPargFlag(e){let t=null,n=e.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.Line;return null!=n&&(t=n.RelEleParagraph),t}GetAllParaghFlags(e,t=!1){let n=new s.List;e.M_DocumentFocused.GetPagePanel(r.ENumPagePanelTp.Body).GetChildrenByType("XParagraphFlag",!0,n);let i=new s.List;for(let e=0;e<n.Length;e++){let r=n[e];if(null!=r){if(!t&&this.IsEmptyLine(r))continue;i.Add(r)}}return i}GetParaghInx(e,t){let n;if(null==e||0==e.Count())n=-1;else if(null==t)n=-1;else{let r=-1;for(let n=0;n<e.Count();n++)if(e[n].Equals(t)){r=n;break}n=r}return n}_BulidReStartSernoParaghs(e){let t,n=this.GetAllParaghFlags(e,!1),r=this.GetCurrentPargFlag(e);if(null==r)t=null;else{let e=r.ParaghStyle.ParagraphListStyle,i=new s.List,l=!1;for(let t=0;t<n.Length;t++){let s=n[t];if(r.Equals(s))l=!0,i.Add(r);else if(l){if(!e==s.ParaghStyle.ParagraphListStyle)break;let t=this.GetLabelSernoByParagh(s);if(null!=t&&1==t.Index)break;i.Add(s)}}t=i.ToArray()}return t}SetParaghLabelSerno(e,t,n){if(null==e||0==e.length)n=!1;else{let r=t;for(let t=0;t<e.length;t++){let n=e[t];this.IsEmptyLine(n)||(this.SetParaghLabelSernoText(n,r),r++)}n=!0}return n}ContineSerno(e,t){let n=this.GetAllParaghFlags(e,!1),r=this.GetCurrentPargFlag(e);if(null!=r){let e=this.GetParaghInx(n,r);if(-1!=e){let s=this.GetLabelSernoByParagh(r);if(null!=s&&1==s.Index){let s=r.ParaghStyle.ParagraphListStyle,o=-1;for(let t=e-1;t>=0;t--){if(n[t].ParaghStyle.ParagraphListStyle.Equals(s)){let e=this.GetLabelSernoByParagh(n[t]);if(null!=e){o=e.Index;break}}}if(-1!=o){for(let t=e;t<n.Count();t++){if(!n[t].ParaghStyle.ParagraphListStyle.Equals(s))break;let r=this.GetLabelSernoByParagh(n[t]);if(null!=r){if(t!=e&&1==r.Index)break;let s=n[t].ParaghStyle.ParagraphListStyle,a=l.ParagraphListStyleVals.GetShowVal(s),u=a.length<=1?".":a[1];o=r.Index=o+1,r.Text=i.SernoPath.GetSerCode(s,o,"无")+u+" "}}t=!0}}}}return t}_GetArrParaghOfSelLines(e){let t=e.M_EleEvtModel,n=null,r=e.M_EleEvtModel.SelRange;if(null!=r&&r.IsValid())n=r.InfoUtil.GetLineParaghFlagsInRange();else{let e=t.EleClickedWrap.LineEleIxFocused.Line;null!=e&&(n=[e.RelEleParagraph])}return n}SetParaghLabelSerno2(e,t,n,r,i,l){let s=1;-1!=l&&(s=l);for(let l=0;l<e.length;l++){let o=e[l];if(!this.IsEmptyLine(o)){if(t!=o.ParaghStyle.ParagraphListStyle){let e=o.ParaghStyle.ParagraphListStyle;o.ParaghStyle.ParagraphMultiLevel=n,o.ParaghStyle.ParagraphListStyle=t,d.EditEleRangeAssist.ChangeOneParaghOutline(o,!1,-1,!0,e,r),o.NotifyLayoutChanged(!0,!1),this.SetParaghLabelSernoText(o,s),i=!0}s++}}return i}SetParaghLabelSernoText(e,t){let n=e.ParaghStyle.ParagraphListStyle;if(!e.ParaghStyle.ParagraphMultiLevel&&!o.default.IsNullOrEmpty(n)){let r=l.ParagraphListStyleVals.GetShowVal(n),s=r.length<=1?".":r[1],o=this.GetLabelSernoByParagh(e);null!=o&&(o.Text=i.SernoPath.GetSerCode(n,t,"无")+s+" ",o.Index=t)}}}t.A_SetParaSerno=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrFmtBrush=void 0;const r=n(0),i=n(181);class l{constructor(){this.longMode=!1,this.srcEle=null,this.srcCvsID=null}get IsLongMode(){return this.longMode}set IsLongMode(e){this.longMode=e}static GetInstance(){return l._instance}Clear(e=null){null!=e&&null!=this.srcCvsID&&e!=this.srcCvsID||(this.longMode=!1,this.srcEle=null)}IsEmpty(){return null==this.srcEle}SetSrcEleStyle(e,t){this.srcEle=e,this.srcCvsID=t}UseFmtBrush(e,t){let n=null==e?0:e.length;if(n>0&&!this.IsEmpty()){let l=null;for(let s=0;s<n;s++){let n=e[s];if(null!=n&&n!=this.srcEle&&this._CanUseStyle(n)){let e=r.XDomUtil.IsInnerChildOfXInput(n);null!=e&&(n=e,l=e);let s=new i.EleStyleUndo(n,i.ENumSubset.All);this._BrushOneEleStyle(n),s.ReadNewStyle(),t.AddItem(s)}}this.IsLongMode||this.Clear(null)}}_CanUseStyle(e){let t;return t=this.srcEle.FormatBrushEnable?e.FormatBrushEnable:this.srcEle.EleTypeName==e.EleTypeName,t}_BrushOneEleStyle(e){let t=e.EleStyle,n=t.ForeColor;if(t.CopyFrom(this.srcEle.EleStyle,!1),null!=e.OwnerLine){e.OwnerLine.RelEleParagraph.EleStyle.CopyFrom(this.srcEle.OwnerLine.RelEleParagraph.EleStyle,!1)}r.XDomUtil.IsBdrOfXInput(e)&&(t.Superscript=!1,t.Subscript=!1,t.ForeColor=n);let i=e instanceof r.XBaseInputEle?e:null;null==i?e.NotifyLayoutChanged(!0,!1):i.ResetInnerChildrenStyles(!0)}}t.EmrFmtBrush=l,l._instance=new l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTableInsertRowRedoUndo=void 0;const r=n(23),i=n(20);class l extends r.IXUndoable{constructor(e,t,n){super(),this.baseTable=e,this.insertRow=t,this.insertIndex=t.Index,this.splitCell=n}IsValid(){return!0}CanUndo(){return!0}CanRedo(){return!0}Undo(){this.baseTable.Undo_InsertRow(this.insertRow)}Redo(){this.baseTable.Redo_InsertRow(this.insertRow,this.insertIndex),null!=this.splitCell&&i.XTextTableUtil.newRowIntoPreRow(this.insertRow,this.splitCell)}Clear(){}}t.TextTableInsertRowRedoUndo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PainterFactory=void 0;const r=n(173),i=n(36),l=n(908),s=n(909),o=n(910),a=n(912),u=n(913),h=n(914),d=n(915),c=n(916),p=n(917),f=n(378),g=n(918),m=n(919),E=n(920),C=n(921),A=n(344),y=n(341),I=n(923),S=n(924);t.PainterFactory=class{static CrtPainter(e,t=null){let n,_;if(i.StringUtils.IsNullOrEmpty(e))return n=null,null;switch(e){case"XCharacter":_=new l.XCharacterPainter;break;case"XTextLabelElement":_=new S.XTextLabelPainter;break;case"XLable":case"XLabelSerno":case"XPageBreakLabel":_=new r.XLabelPainter;break;case"XPageInfo":_=new s.XPageNumPainter;break;case"XParagraphFlag":_=new o.XParagraphPainter;break;case"XOutlineFoldIcon":_=new a.XOutlineFoldPainter;break;case"HorizontalLine":_=new c.XSpliteLinePainter;break;case"Shape":_=new p.XShapePainter;break;case"XTextTable":_=new u.XTextTablePainter;break;case"XTextTableRow":_=new h.XTextTableRowPainter;break;case"XTextTableCell":_=new d.XTextTableCellPainter;break;case"XMedicalExpressionField":_=new I.XMedicalExpressionPainter;break;case"XBarcodeField":_=new y.XCodePainter;break;case"XLableInputBorder":_=new A.XInputBorderPainter;break;case"XTextRadioBox":_=new f.XRadioBoxPainter;break;case"XTextCheckBox":_=new g.XCheckBoxPainter;break;case"Fraction":_=new m.XFractionPainter;break;case"XImage":_=new E.XImagePainter;break;case"XButtonEle":_=new C.XButtonPainter}return n=_,n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputAlertFormEvtHandler=void 0;const r=n(26),i=n(29),l=n(0),s=n(60),o=n(2),a=n(36),u=n(95),h=n(40),d=n(80),c=n(46),p=n(42),f=n(17),g=n(9),m=n(13),E=n(323),C=n(38),A=n(37),y=n(92),I=n(306);class S{constructor(e){this.isUpdateMoveCaret=!0,this._xdocEditor=e}get InputPopControl(){return this._tempEmrPopControl}OnMouseDoubleClick(e){clearTimeout(S.OnMouse_Down_Timout);let t=!1;if(null!=e.EditorActiveMode&&-1!=e.EditorActiveMode.indexOf("MouseDblClick")&&(t=!0),null!=e.EditorEventActiveMode&&-1!=e.EditorEventActiveMode.indexOf("MouseDblClick")){let t={type:e.InputEventName,cptId:e.CptID,value:e.InnerValue,DateTimeValue:e.DateTimeValue,InputExtendAttr:e.InputExtendAttr,InputStorageData:e.InputStorageData,bodylocation:this._xdocEditor.GetAlertFormStartRect(c.PositionEnum.LeftBottom,0,0).Location};this._xdocEditor.M_EdtCustomEvtGrp.InputActiveHandler&&this._xdocEditor.M_EdtCustomEvtGrp.InputActiveHandler(t)}if(this._xdocEditor.M_EdtCustomEvtGrp.InputDoubleClick){const t=e.DataSrc.DataList;let n="textinput",r={};if(t.Length>0){n="select";let i=new C.List;for(let n of t){let t=n.Key,r=n.Value,l={};l.value=t,l.name=r,l.XID=e.XID,i.Add(l)}r.itemListEle=i}let i=Object.assign({elementId:e.XID,cptId:e.CptID,elementName:e.Name,value:e.GetInnerText(!1),backText:e.BackgroundText,tipText:e.ToolTip,inputType:n},r);this._xdocEditor.M_EdtCustomEvtGrp.InputDoubleClick(i)}return t&&this.InputFiledPop(e,"MouseDblClick")}OnMouseClick(e){return clearTimeout(S.OnMouse_Down_Timout),new Promise(t=>{S.OnMouse_Down_Timout=setTimeout(()=>{let n=!1;if(null!=e.EditorActiveMode&&-1!=e.EditorActiveMode.indexOf("MouseClick")&&(n=!0),null!=e.EditorEventActiveMode&&-1!=e.EditorEventActiveMode.indexOf("MouseClick")){let t={type:e.InputEventName,value:e.InnerValue,cptId:e.CptID,DateTimeValue:e.DateTimeValue,InputExtendAttr:e.InputExtendAttr,InputStorageData:e.InputStorageData,bodylocation:this._xdocEditor.GetAlertFormStartRect(c.PositionEnum.LeftBottom,0,0).Location};this._xdocEditor.M_EdtCustomEvtGrp.InputActiveHandler&&this._xdocEditor.M_EdtCustomEvtGrp.InputActiveHandler(t)}if(this._xdocEditor.M_EdtCustomEvtGrp.InputMouseClick){const t=e.DataSrc.DataList;let n={};if(t.Length>0){let r=new C.List;for(let n of t){let t=n.Key,i=n.Value,l={};l.value=t,l.name=i,l.XID=e.XID,r.Add(l)}n.itemListEle=r}let r=Object.assign({cptId:e.CptID,elementId:e.XID,elementName:e.Name,docId:e.Document.DocID,customAttribute:e.CustomAttribute,LackEllipsisvalue:e.LackEllipsisvalue,inputType:e.GetInputTypeName(),value:e.GetInnerText(!1),backText:e.BackgroundText,tipText:e.ToolTip,DateTimeValue:e.DateTimeValue,DynamicData:e.DynamicData?JSON.parse(decodeURIComponent(e.DynamicData)):null},n);this._xdocEditor.M_EdtCustomEvtGrp.InputMouseClick(r)}return t(),n&&this.InputFiledPop(e,"MouseClick")},300)})}OnEnterDown(e,t=!1){let n=!1;clearTimeout(S.OnMouse_Down_Timout);const l=r.TextDocInitInfo.GetInstance().IsStartUpAllKeyJump,o=r.TextDocInitInfo.GetInstance().AllKeyJump_ShortCutKey;if(null!=e.EditorEventActiveMode&&-1!=e.EditorEventActiveMode.indexOf("Enter")){let t={type:e.InputEventName,value:e.InnerValue,cptId:e.CptID,InputExtendAttr:e.InputExtendAttr,InputStorageData:e.InputStorageData,bodylocation:this._xdocEditor.GetAlertFormStartRect(c.PositionEnum.LeftBottom,0,0).Location};this._xdocEditor.M_EdtCustomEvtGrp.InputActiveHandler&&this._xdocEditor.M_EdtCustomEvtGrp.InputActiveHandler(t)}if(!l||o!=i.Keys.Return||!t){if(null!=e.EditorEventActiveMode&&-1!=e.EditorEventActiveMode.indexOf("Enter")){let t={type:e.InputEventName,value:e.InnerValue,cptId:e.CptID,DateTimeValue:e.DateTimeValue,InputExtendAttr:e.InputExtendAttr,InputStorageData:e.InputStorageData};this._xdocEditor.M_EdtCustomEvtGrp.InputActiveHandler&&this._xdocEditor.M_EdtCustomEvtGrp.InputActiveHandler(t)}let t=!1;null!=e.EditorActiveMode&&-1!=e.EditorActiveMode.indexOf("Enter")&&(t=!0);let n=this.InputFiledPop(e,"Enter"),r=t&&n;return r||(r=this.ExecAllKeyJump(e,n)),r}return s.EmrApiUtil.HasSelection(this._xdocEditor)||this.ExecAllKeyJump(e),n=!0,n}OnTabDown(e){if(!r.TextDocInitInfo.GetInstance().IsStartUpAllKeyJump)return!1;return s.EmrApiUtil.HasSelection(this._xdocEditor)||this.ExecAllInputJump(e),!0}ExecAllInputJump(e){u.EmrInnerUtil.ResetBodyXInputCache(e.Document,this._xdocEditor);let t=u.EmrInnerUtil.GetNextInputEle_Body(e.Document,e,!0);if(null==t)return this.UpdateMoveCaretEle(!0),!1;let n=this.getChildFirst(t);if(this._xdocEditor.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(n),this._xdocEditor.MRefreshDocView(),!t.Equals(this._inputEle)){const n=e.GetLastChildEle(),r=t.GetLastChildEle();this._xdocEditor.M_EleEvtHandler.OnCursorChange(n,r)}s.EmrApiUtil.GetEmrEditWrapperCtrl(this._xdocEditor);this._inputEle=t instanceof l.XInputEle?t:null;let r=this._inputEle.GetFirstChildBaseEle(),i=g.RectangleF.Empty;this._xdocEditor.MSetScrollToEleRect(r,i),this._xdocEditor.M_EleEvtModel.MoveCaretByCursorEle(!0)}ExecAllKeyJump(e,t=!0){let n=r.TextDocInitInfo.GetInstance().JumpAll;if(n&&e.IsDisSkip)return this.isUpdateMoveCaret=!0,this.popControlCloseHandler(),!1;u.EmrInnerUtil.ResetBodyXInputCache(e.Document,this._xdocEditor);let i=u.EmrInnerUtil.GetNextInputEle_Body(e.Document,e,n);if(null==i)return t&&this.UpdateMoveCaretEle(!0),this.isUpdateMoveCaret=!0,this.popControlCloseHandler(),!1;let o=this.getChildFirst(i);if(this._xdocEditor.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(o),this._xdocEditor.MRefreshDocView(),!i.Equals(this._inputEle)){const t=e.GetLastChildEle(),n=i.GetLastChildEle();this._xdocEditor.M_EleEvtHandler.OnCursorChange(t,n)}s.EmrApiUtil.GetEmrEditWrapperCtrl(this._xdocEditor);this._inputEle=i instanceof l.XInputEle?i:null;let a=this._inputEle.GetFirstChildBaseEle(),h=g.RectangleF.Empty;this._xdocEditor.MSetScrollToEleRect(a,h);return this.InputFiledPop(this._inputEle,"Enter",n)||(this.isUpdateMoveCaret=!0,this.popControlCloseHandler()),!0}getChildFirst(e){if(null==e)return null;if(e.ChildEleList.Count()>0){const t=e.ChildEleList.Count();let n;for(let r=0;r<t;r++){const i=e.ChildEleList.Get(r);if(i instanceof l.XBaseContainer){if(n=i.GetFirstChildBaseEle(),null!=n)break}else{if("XLableInputBorder"!=i.EleTypeName&&i instanceof l.XLabelEle&&i.LabelType!=o.ENumXLabelType.XInputLabel){n=i;break}if(r>=t-1){n=i;break}}}return n}return null}Init(e){this._inputEle=e}AlertFormValidBefore(e){let t,n=l.XDomUtil.GetXTableOfCell(l.XDomUtil.GetParentCell(this._inputEle)),r=!1;if(n instanceof l.XTextTable&&n.XID==this._xdocEditor.M_EdtCustomEvtGrp.EditablaDiagTableXID&&(r=!0),null==this._inputEle)return!1;if(!this._inputEle.UserEditable)return!1;if(null==this._inputEle.DataSrc)return!1;if(this._inputEle.EnterInputField_DownKey==i.Keys.Control)return!1;if(this._inputEle.Document.GetDocCtxt().EmrWorkMode==o.ENumWorkMode.Browse&&!r)return!1;if(this._inputEle.Document.GetDocCtxt().EmrWorkMode==o.ENumWorkMode.KeepTrace)return!1;if(null==this._xdocEditor)return!1;if("Enter"==e)return!0;const s=this._xdocEditor.M_EleEvtModel.EleClickedWrap,a=s.ClickPosYDiff;return t=a>0&&a<s.EleFocused.Bounds.Height,t}InputFiledPop(e,t,n=!1){let i=t&&-1!=e.EditorActiveMode.indexOf(t),l=r.TextDocInitInfo.GetInstance().JumpAll;this.Init(e);let o=this._xdocEditor.M_EleEvtModel.EleClickedWrap.ClickPosInCtrl,a=this._xdocEditor.GetAlertFormStartRect(c.PositionEnum.LeftBottom,0,0).Location,u={cptId:e.CptID,bodyLocation:a,editorLocation:o,customAttribute:e.CustomAttribute,LackEllipsisvalue:e.LackEllipsisvalue,inputType:e.GetInputTypeName(),value:e.GetInnerText(!1),docId:e.Document.DocID,DateTimeValue:e.DateTimeValue,innerText:e.PreSetvalueText,DynamicData:e.DynamicData?JSON.parse(decodeURIComponent(e.DynamicData)):null,DynamicDataValue:(e.InputType==h.EleTypeEnum.SingleChoiceDropEle||e.InputType==h.EleTypeEnum.MoreChoiceDropEle)&&e.DynamicData&&e.DynamicDataValue?JSON.parse(e.DynamicDataValue):null};if(i&&!this._inputEle.UserEditable&&this._xdocEditor.M_EdtCustomEvtGrp.ReadOnlyInputActiveWithCptId&&this._xdocEditor.M_EdtCustomEvtGrp.ReadOnlyInputActiveWithCptId(u),!this.AlertFormValidBefore(t))return!1;i&&this._xdocEditor.M_EdtCustomEvtGrp.InputActiveWithCptId&&this._xdocEditor.M_EdtCustomEvtGrp.InputActiveWithCptId(u),this._inputEle.DataSrc.DynamicListItems&&this._inputEle.SenderLoadDataEvent();let p=!1;switch(this._inputEle.InputType){case h.EleTypeEnum.SingleChoiceDropEle:case h.EleTypeEnum.MoreChoiceDropEle:case h.EleTypeEnum.HaveNoEle:p=this.DropDownEleClick();break;case h.EleTypeEnum.NumEle:p=this._inputEle.ShowDialog&&this.NumericEleClick(t);break;case h.EleTypeEnum.DateEle:p=this.DateTimeClick();break;case h.EleTypeEnum.SqlEle:break;case h.EleTypeEnum.MacroEle:d.XInputUtil.MacroEle_IsDateOut(this._inputEle)?p=this.DateTimeClick():d.XInputUtil.MacroEle_IsNumOut(this._inputEle);break;case h.EleTypeEnum.RefEle:break;default:!n||!l&&this._inputEle.IsDisSkip||s.EmrApiUtil.HasSelection(this._xdocEditor)||this.ExecAllKeyJump(this._inputEle)}return null!=this._xdocEditor.M_EleEvtModel.PopCtrl&&(this._hasPopover=p),this._xdocEditor.M_EleEvtModel.PopCtrl=!0,p}DropDownEleClick(){return 0!=this._inputEle.DataSrc.DataList.Count()&&(this._inputEle.DataSrc.MultiSelect?a.StringUtils.IsNullOrEmpty(this._inputEle.DataSrc.ListValueFormatString)||"有无列表"!=this._inputEle.DataSrc.ListValueFormatString?this.ShowDropDownForm(this._inputEle.DataSrc.MultiSelect,!1):this.ShowDropDownForm(this._inputEle.DataSrc.MultiSelect,!0):this.ShowDropDownForm(this._inputEle.DataSrc.MultiSelect,!1),!0)}ShowDropDownForm(e,t){const n=this._xdocEditor.GetAlertFormStartRect(c.PositionEnum.LeftBottom,0,0).Location;let r=p.XInputFactory.GetInstance().BulidDropDownMenuControl(e,t,this._inputEle);r.Layout(n),this._tempEmrPopControl=r,r.SelectedOkEvent=this.emrContextMenuForm_SelectedOkEvent.bind(this),r.CloseEvent=this.popControlCloseHandler.bind(this)}ShowUnitDropDownForm(e,t){const n=this._xdocEditor.GetAlertFormStartRect(c.PositionEnum.LeftBottom,0,0).Location;let r=p.XInputFactory.GetInstance().BulidDropDownMenuControl(e,t,this._inputEle);r.Layout(n),this._tempEmrPopControl=r,r.SelectedOkEvent=this.Unit_SelectedOkEvent.bind(this),r.CloseEvent=this.popControlCloseHandler.bind(this)}Unit_SelectedOkEvent(e,t,n,r){const i=this.BulidInsertStringByList(e,!0);this._inputEle.UnitText=i,this._inputEle.UnitLabelTextEle.Text=i,this._xdocEditor.MRefreshDocView(),this.UpdateMoveCaretEle()}emrContextMenuForm_SelectedOkEvent(e,t,n,r,i=!1){if(null!=e&&0!=e.Count()||a.StringUtils.IsNullOrEmpty(r))if(n){const n=this.BulidInsertStringByList(e,!0),r=this.BulidInsertStringByList(t,!1);let i="";a.StringUtils.IsNullOrEmpty(n)||(i=i+(this._inputEle.SurePrefix||"有")+n),a.StringUtils.IsNullOrEmpty(n)||a.StringUtils.IsNullOrEmpty(r)||(i+=A.TextDocApiConst.InputHaveNoEleSpliteStr),a.StringUtils.IsNullOrEmpty(r)||(i=i+(this._inputEle.NegativePrefix||"无")+r),this.InsertString(i)}else{const t=this.BulidInsertStringByList(e,!0);this.InsertString(t,i)}else this._inputEle.IsAllowKeyInput&&this.InsertString(r)}BulidInsertStringByList(e,t=!0){let n="",r="",i=[],l=[];if(null!=e){const t=e.GetEnumerator();for(;t.MoveNext();){const e=t.Current;i.push(e.Value),l.push(e.Index.toString())}}return n=i.join(A.TextDocApiConst.InputMoreSelectionEleSpliteStr),r=l.join(A.TextDocApiConst.InputSelectIndexSpliteChar),null!=this._inputEle&&t&&(this._inputEle.SelectIndex=r),n}NumericEleClick(e){this.LostFocus();let t=this._xdocEditor.GetAlertFormStartRect(c.PositionEnum.LeftBottom,0,0).Location,n=!1;if(t.equals(f.PointF.Empty))n=!1;else if(this._inputEle.EditorMode==I.NumInputEditorMode.NoneDialog)n=!1;else if(this._inputEle.EditorMode==I.NumInputEditorMode.CalculatorDiolog){let e=p.XInputFactory.GetInstance().BulidCalculatorControl({type:"Calculator",value:this._inputEle.InnerValue,top:t.Y,left:t.X,onOk:this.calculatorForm_SelectedOkEvent.bind(this),onClose:this.popControlCloseHandler.bind(this)});this._tempEmrPopControl=e,n=!0}else if(this._inputEle.EditorMode==I.NumInputEditorMode.UnitListDiolog){if(this._inputEle.DataSrc.DataList.Length<=0)return!1;{let e=[],r=this._inputEle.UnitText;for(let t of this._inputEle.DataSrc.DataList)e.push({checked:t.Value==r,Value:t.Value,key:t.Key});let i=p.XInputFactory.GetInstance().BulidCalculatorControl({type:"Unit",value:this._inputEle.InnerValue,top:t.Y,left:t.X,dataList:e,unit:this._inputEle.UnitText,onOk:this.calculatorForm_SelectedOkEvent.bind(this),onClose:this.popControlCloseHandler.bind(this)});i.inputEleXID=this._inputEle.XID,this._tempEmrPopControl=i,n=!0}}return n}calculatorForm_SelectedOkEvent(e,t){let n=r.TextDocInitInfo.GetInstance().UseCalculatorNum,i=1/0,l=-1/0;this._inputEle.ValidateStyle&&this._inputEle.ValidateStyle.MaxValue&&(i=this._inputEle.ValidateStyle.MaxValue),this._inputEle.ValidateStyle&&this._inputEle.ValidateStyle.MinValue&&(l=this._inputEle.ValidateStyle.MinValue);let s,o=parseFloat(e),a=Number(o);n||(a<l?(a=l,this._xdocEditor.HideMsgBox||y.MessageBoxComp.Show({title:"提示",content:"输入的值小于最小值，取最小值",type:"warning",dom:this._xdocEditor.ContainerDOM})):a>=l&&a<=i?a=a:a>i&&(a=i,this._xdocEditor.HideMsgBox||y.MessageBoxComp.Show({title:"提示",content:"输入的值超过了最大值，取最大值",type:"warning",dom:this._xdocEditor.ContainerDOM}))),s=""===e?"":String(a),this._inputEle.EditorMode==I.NumInputEditorMode.UnitListDiolog&&(this._inputEle.UnitText=t,this._inputEle.UnitLabelTextEle.Text=t),this._xdocEditor.MRefreshDocView(),this.InsertString(s)}DateTimeClick(){this.LostFocus();let e,t=this._xdocEditor.GetAlertFormStartRect(c.PositionEnum.LeftBottom,0,0).Location;if(t==f.PointF.Empty)e=!1;else{let n="yyyy-MM-dd";null!=this._inputEle.DisplayFormat&&this._inputEle.DisplayFormat.Style==c.XValueFormatStyle.DateTime&&(n=this._inputEle.DisplayFormat.Format);let r=p.XInputFactory.GetInstance().BulidCalendarDateControl({dateFormat:n,value:this._inputEle.InnerValue,position:t,onOk:this.calendarDateForm_SelectedOkEvent.bind(this),onClose:this.popControlCloseHandler.bind(this)});r.inputEleXID=this._inputEle.XID,this._tempEmrPopControl=r,e=!0}return e}calendarDateForm_SelectedOkEvent(e){this.InsertString(e)}ClickUpdateInputText(e,t=!1){let n=this._xdocEditor.M_EleEvtModel,r=n.AddEdtHistAct;this._inputEle.IsAppendWrite&&(e=this._inputEle.InnerValue+e),this._inputEle.BindDocEditor(this._xdocEditor);const i=this._xdocEditor.M_EdtCustomEvtGrp.AppKeepTrace,l=n.WorkMode==o.ENumWorkMode.Design||!i;this._inputEle.InputType==h.EleTypeEnum.SingleChoiceDropEle?(e||t)&&E.XInputEleHelper.UpdateInnerTextByClick(this._inputEle,e,r,l,this._xdocEditor):E.XInputEleHelper.UpdateInnerTextByClick(this._inputEle,e,r,l,this._xdocEditor),this._xdocEditor.M_EleEvtHandler.OnTextChanged(this._inputEle.ChildEleList.Get(1)),this._xdocEditor.MRefreshDocView(),this.UpdateMoveCaretEle()}InsertString(e,t=!1){if(null!=this._inputEle&&null!=this._xdocEditor){let n=new m.UndoGroup;this._inputEle.SetUnDoGroup(n),this._inputEle.MinSpaceNumber>0&&""==e&&(e=" "),this.ClickUpdateInputText(e,t);let r=this._xdocEditor.M_EleEvtModel.EleClickedWrap,i=r.EleFocused;null==n.CursorUndoEle&&(n.CursorUndoEle=i),null==n.CursorRedoEle&&(n.CursorRedoEle=r.EleFocused),this._xdocEditor.M_UndoMgr.AddItem(n),n=null,this._inputEle.SetUnDoGroup(n)}}popControlCloseHandler(e=!1){!this._hasPopover||e?this._xdocEditor.M_EleEvtModel.PopCtrl=null:this._xdocEditor.M_EleEvtModel.PopCtrl=this._tempEmrPopControl,this._hasPopover=!1,!e&&this.isUpdateMoveCaret?this._xdocEditor.M_EleEvtModel.MoveCaretByCursorEle(!1):this.isUpdateMoveCaret=!0}UpdateMoveCaretEle(e=!1){if(null!=this._inputEle)if(this.isUpdateMoveCaret=!1,this._inputEle.IsDisSkip||e){let e;e=this._inputEle.LabelTextEle?this._inputEle.LabelTextEle:this._inputEle.StartEle;let t=l.XDomUtil.GetNextEle(!0,e);this._xdocEditor.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(t),this._xdocEditor.M_EleEvtHandler.OnCursorChange(e,t),this._xdocEditor.M_EleEvtModel.MoveCaretByCursorEle(!0)}else this.OnEnterDown(this._inputEle,!0)}LostFocus(){null!=this._xdocEditor.FocusManager&&null!=this._xdocEditor.FocusManager.ActiveFocus&&(this._xdocEditor.FocusManager.ActiveFocus.IsFocus=!1,this._xdocEditor.FocusManager.ActiveFocus=null)}}t.InputAlertFormEvtHandler=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=e.rectangleCanvas.getContext("2d");t.clearRect(0,0,e.width,e.height),t.drawImage(e.currentImgDom,0,0,e.width*e.scale,e.height*e.scale,0,0,e.width*e.scale,e.height*e.scale)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocInfoArgs=t.ENumDocTp=void 0;const r=n(189),i=n(4);var l;!function(e){e[e.UnKnown=0]="UnKnown",e[e.Report=1]="Report",e[e.EmrDoc=2]="EmrDoc"}(l=t.ENumDocTp||(t.ENumDocTp={}));class s{constructor(e){this.NoDataMsg="无数据",this.docType=l.UnKnown,this.docIx=-1,this.docLocalIx=-1,this.docName=null,this.docPath=null,this.tipBeforePrt=null,this.paperName=null,this.pageSizePortrait=new r.CSize,this.fromPageIx=-1,this.pagesCnt=0,this.loadErrMsg=null,this.docType=e}get DocType(){return this.docType}set DocType(e){this.docType=e}get DocIx(){return this.docIx}set DocIx(e){this.docIx=e}get DocLocalIx(){return this.docLocalIx}set DocLocalIx(e){this.docLocalIx=e}get DocName(){return this.docName}set DocName(e){this.docName=e}get DocPath(){return this.docPath}set DocPath(e){this.docPath=e}get PaperName(){return this.paperName}set PaperName(e){this.paperName=e}get PageSizePortrait(){return this.pageSizePortrait}get FromPageIx(){return this.fromPageIx}set FromPageIx(e){this.fromPageIx=e}get PagesCnt(){return this.pagesCnt}set PagesCnt(e){this.pagesCnt=e}get TipBeforePrt(){return this.tipBeforePrt}set TipBeforePrt(e){this.tipBeforePrt=e}get LoadErrMsg(){return this.loadErrMsg}set LoadErrMsg(e){this.loadErrMsg=e}get IsLoadSuccess(){let e=i.default.IsNullOrEmpty(this.LoadErrMsg);return e||(e=i.default.Equals("无数据",this.LoadErrMsg)),e}Clear(){this.docType=l.UnKnown,this.docIx=-1,this.docLocalIx=-1,this.docName=null,this.docPath=null,this.paperName=null,this.pageSizePortrait.setSizeAsMM(0,0),this.fromPageIx=-1,this.pagesCnt=0,this.tipBeforePrt=null,this.loadErrMsg=null}CopyFrom(e){null!=e&&(this.docType=e.docType,this.docIx=e.docIx,this.docLocalIx=e.docLocalIx,this.docName=e.docName,this.docPath=e.docPath,this.paperName=e.paperName,this.pageSizePortrait.copyFrom(e.pageSizePortrait),this.fromPageIx=e.fromPageIx,this.pagesCnt=e.pagesCnt,this.tipBeforePrt=e.tipBeforePrt,this.loadErrMsg=e.loadErrMsg)}BuildStrPageSizeMM(){return this.pageSizePortrait.getWidthAsMM()+"x"+this.pageSizePortrait.getHeightAsMM()+"mm"}static IsSameDoc(e,t){return e==t||null!=e&&null!=t&&e.docType==t.docType&&e.docIx==t.docIx}static IsSamePage(e,t){return e==t||null!=e&&null!=t&&s.IsSameDoc(e.DocArgs,t.DocArgs)&&e.PageIx==t.PageIx}static ComparePage(e,t){let n;if(e==t)n=0;else if(null==e)n=-1;else if(null==t)n=1;else{let r=e.DocArgs.docIx-t.DocArgs.docIx;if(0!=r)n=r>0?1:-1;else{let r=e.PageIx-t.PageIx;n=0!=r?r>0?1:-1:0}}return n}}t.DocInfoArgs=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CSize=void 0;const r=n(149);t.CSize=class{constructor(){this.width_mm=0,this.height_mm=0,this.conv=null,this.conv=new r.MeasureConverter}isValid(){return this.width_mm>0&&this.height_mm>0}copyFrom(e){null!=e&&(this.width_mm=e.width_mm,this.height_mm=e.height_mm)}limitFrom(e,t){t?(this.width_mm<e.width_mm&&(this.width_mm=e.width_mm),this.height_mm<e.height_mm&&(this.height_mm=e.height_mm)):(this.width_mm>e.width_mm&&(this.width_mm=e.width_mm),this.height_mm>e.height_mm&&(this.height_mm=e.height_mm))}zoomMdSize(e){this.width_mm*=e,this.height_mm*=e}getWidthAsMM(){return this.width_mm}getHeightAsMM(){return this.height_mm}setWidthAsMM(e){this.width_mm=e}setHeightAsMM(e){this.height_mm=e}setSizeAsMM(e,t){this.width_mm=e,this.height_mm=t}addSizeAsMM(e,t){this.width_mm+=e,this.height_mm+=t}getWidthAsPX(e){return this.conv.ConvMmToPx(this.width_mm,e)}getHeightAsPX(e){return this.conv.ConvMmToPx(this.height_mm,e)}setWidthAsPX(e,t){this.width_mm=this.conv.ConvPxToMm(e,t)}setHeightAsPX(e,t){this.height_mm=this.conv.ConvPxToMm(e,t)}setSizeAsPX(e,t,n){this.width_mm=this.conv.ConvPxToMm(e,n),this.height_mm=this.conv.ConvPxToMm(t,n)}addSizeAsPX(e,t,n){e=this.conv.ConvPxToMm(e,n),t=this.conv.ConvPxToMm(t,n),this.width_mm+=e,this.height_mm+=t}zoomSize(e){e>0&&1!=e&&(this.width_mm*=e,this.height_mm*=e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Exception=void 0;t.Exception=class{constructor(e){this.message=e||"程序出现异常"}get Message(){return this.message}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndexOutOfBoundsException=void 0;const r=n(5);class i extends r.Exception{}t.IndexOutOfBoundsException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contains=void 0,t.contains=function(e,t,n){if(e){n=n||((e,t)=>e===t);for(let r of e)if(n(r,t))return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dictionary=void 0;const r=n(31),i=n(71),l=n(5),s=n(479),o=n(15),a=n(258);class u{constructor(e,t){if(this.freeList=-1,this.freeCount=0,this.version=0,this.count=0,this.comparer=t||i.EqualityComparer.Default(),e)if("number"==typeof e){let t=e;if(t<0)throw new l.ArgumentOutOfRangeException("capacity",t,"capacity 小于 0");this.Initialize(t)}else for(let t of e)t instanceof s.KeyValuePair?this.Set(t.Key,t.Value):this.Set(t[0],t[1])}GetEnumerator(){return new a.IEnumerator(this.ToList())}get Keys(){return null}Initialize(e){let t=c.GetPrime(e),n=new Array(t),r=new Array(t);for(let e=0;e<t;e++)n[e]=-1,r[e]=new h;return this.buckets=n,this.entries=r,this.freeList=-1,t}Add(e,t){this.TryInsert(e,t,d.ThrowOnExisting)}Set(e,t){this.TryInsert(e,t,d.OverwriteExisting)}Get(e){let t=this.FindEntry(e);if(t>=0){return this.entries[t].value}throw new l.KeyNotFoundException}ContainsKey(e){return this.FindEntry(e)>=0}Clear(){if(this.count>0){let e=this.buckets,t=this.entries;for(let t=0;t<e.length;t++)e[t]=-1;for(let e=0;e<t.length;e++)t[e]=new h;this.freeList=-1,this.count=0,this.freeCount=0,this.version++}}Remove(e){o.throws.ThrowIfNull("key",e);let t=this.buckets,n=this.entries,r=this.comparer;if(t){let i=2147483647&r.GetHashCode(e),l=i%t.length,s=-1;for(let o=t[l];o>=0;s=o,o=n[o].next)if(n[o].hashCode===i&&r.Equals(n[o].key,e))return s<0?t[l]=n[o].next:n[s].next=n[o].next,n[o].hashCode=-1,n[o].next=this.freeList,n[o].key=void 0,n[o].value=void 0,this.freeList=o,this.freeCount++,this.version++,!0}return!1}TryGetValue(e){let t=this.FindEntry(e);if(t>=0){return[!0,this.entries[t].value]}return[!1,void 0]}FindEntry(e){o.throws.ThrowIfNull("key",e);let t=this.buckets,n=this.entries,r=this.comparer;if(t){let i=2147483647&r.GetHashCode(e);for(let l=t[i%t.length];l>=0;l=n[l].next)if(n[l].hashCode===i&&r.Equals(n[l].key,e))return l}return-1}TryInsert(e,t,n){o.throws.ThrowIfNull("key",e),this.buckets||this.Initialize(0);let r=this.buckets,i=this.entries,s=this.comparer,a=2147483647&s.GetHashCode(e),u=a%this.buckets.length;for(let o=r[u];o>=0;o=i[o].next)if(i[o].hashCode===a&&s.Equals(i[o].key,e)){if(n===d.ThrowOnExisting)throw new l.ArgumentException("key","已经存在相同的Key");return i[o].value=t,this.version++,!0}let h=0;this.freeCount>0?(h=this.freeList,this.freeList=i[h].next,this.freeCount--):(this.count===i.length&&(this.Resize(),i=this.entries,r=this.buckets,u=a%r.length),h=this.count,this.count++),i[h].hashCode=a,i[h].next=r[u],i[h].key=e,i[h].value=t,r[u]=h,this.version++}Resize(){let e=c.GetPrime(2*this.count),t=new Array;for(let n=0;n<e;n++)t[n]=-1;let n=new Array,r=this.entries;for(let t=0;t<e;t++)t<this.count?n[t]=r[t]:n[t]=new h;for(let r=0;r<this.count;r++){let i=n[r].hashCode%e;n[r].next=t[i],t[i]=r}this.buckets=t,this.entries=n}*[Symbol.iterator](){if(this.entries)for(let e of this.entries)void 0!==e.key&&(yield new s.KeyValuePair(e.key,e.value))}All(e){return r.Enumerable.All(this,e)}Any(e){return r.Enumerable.Any(this,e)}AsEnumerable(){return r.Enumerable.AsEnumerable(this)}Average(e){return r.Enumerable.Average(this,e)}Concat(e){return r.Enumerable.Concat(this,e)}Contains(e,t){return r.Enumerable.Contains(this,e,t)}Count(e){return e?r.Enumerable.Count(this,e):this.count-this.freeCount}DefaultIfEmpty(e){return r.Enumerable.DefaultIfEmpty(this,e)}Distinct(e){return r.Enumerable.Distinct(this,e)}ElementAt(e){return r.Enumerable.ElementAt(this,e)}ElementAtOrDefault(e,t){return r.Enumerable.ElementAtOrDefault(this,e,t)}Except(e,t){return r.Enumerable.Except(this,e,t)}First(e){return r.Enumerable.First(this,e)}FirstOrDefault(e,t){return r.Enumerable.FirstOrDefault(this,e,t)}GroupBy(e,t,n){return r.Enumerable.GroupBy(this,e,t,n)}GroupJoin(e,t,n,i,l){return r.Enumerable.GroupJoin(this,e,t,n,i,l)}Intersect(e,t){return r.Enumerable.Intersect(this,e,t)}Join(e,t,n,i,l){return r.Enumerable.Join(this,e,t,n,i,l)}Last(e){return r.Enumerable.Last(this,e)}LastOrDefault(e,t){return r.Enumerable.LastOrDefault(this,e,t)}Max(e){return r.Enumerable.Max(this,e)}Min(e){return r.Enumerable.Min(this,e)}Reverse(){return r.Enumerable.Reverse(this)}Select(e){return r.Enumerable.Select(this,e)}SelectMany(e,t){return r.Enumerable.SelectMany(this,e,t)}SequenceEqual(e,t){return r.Enumerable.SequenceEqual(this,e,t)}Single(e){return r.Enumerable.Single(this,e)}SingleOrDefault(e,t){return r.Enumerable.SingleOrDefault(this,e,t)}Skip(e){return r.Enumerable.Skip(this,e)}SkipWhile(e){return r.Enumerable.SkipWhile(this,e)}Sum(e){return r.Enumerable.Sum(this,e)}Take(e){return r.Enumerable.Take(this,e)}TakeWhile(e){return r.Enumerable.TakeWhile(this,e)}ToArray(){return r.Enumerable.ToArray(this)}ToDictionary(e,t,n){return r.Enumerable.ToDictionary(this,e,t,n)}ToList(){return r.Enumerable.ToList(this)}Union(e,t){return r.Enumerable.Union(this,e,t)}Where(e){return r.Enumerable.Where(this,e)}}t.Dictionary=u;class h{constructor(){this.hashCode=0,this.next=-1,this.key=void 0,this.value=void 0}}var d;!function(e){e[e.None=0]="None",e[e.OverwriteExisting=1]="OverwriteExisting",e[e.ThrowOnExisting=2]="ThrowOnExisting"}(d||(d={}));class c{static IsPrime(e){if(0!=(1&e)){let t=parseInt(Math.sqrt(e).toFixed(0),10);for(let n=3;n<=t;n+=2)if(e%n==0)return!1;return!0}return 2===e}static GetPrime(e){for(let t=0;t<p.length;t++){let n=p[t];if(n>=e)return n}for(let t=1|e;t<2147483647;t+=2)if(c.IsPrime(t)&&(t-1)%c.HashPrime!=0)return t;return e}}c.HashPrime=101;const p=[3,7,11,17,23,29,37,47,59,71,89,107,131,163,197,239,293,353,431,521,631,761,919,1103,1327,1597,1931,2333,2801,3371,4049,4861,5839,7013,8419,10103,12143,14591,17519,21023,25229,30293,36353,43627,52361,62851,75431,90523,108631,130363,156437,187751,225307,270371,324449,389357,467237,560689,672827,807403,968897,1162687,1395263,1674319,2009191,2411033,2893249,3471899,4166287,4999559,5999471,7199369]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadOnlyCollection=void 0;const r=n(31),i=n(5),l=n(15);class s{constructor(e){l.throws.ThrowIfNull("list",e),this.list=e}GetEnumerator(){throw new Error("Method not implemented.")}get Length(){return this.list.Length}get IsReadOnly(){return!0}Set(e,t){throw new i.InvalidOperationException("不可向只读列表中写入数据")}Get(e){return this.list.Get(e)}Add(e){throw new i.InvalidOperationException("不可向只读列表中写入数据")}Clear(){throw new i.InvalidOperationException("不可清空只读列表")}CopyTo(e,t){this.list.CopyTo(e,t)}IndexOf(e){return this.list.IndexOf(e)}Insert(e,t){throw new i.InvalidOperationException("不可向只读列表中写入数据")}Remove(e){throw new i.InvalidOperationException("不可从只读列表中删除数据")}RemoveAt(e){throw new i.InvalidOperationException("不可从只读列表中删除数据")}[Symbol.iterator](){return this.list[Symbol.iterator]()}All(e){return r.Enumerable.All(this,e)}Any(e){return r.Enumerable.Any(this,e)}AsEnumerable(){return r.Enumerable.AsEnumerable(this)}Average(e){return r.Enumerable.Average(this,e)}Concat(e){return r.Enumerable.Concat(this,e)}Contains(e,t){return r.Enumerable.Contains(this,e,t)}Count(e){return r.Enumerable.Count(this,e)}DefaultIfEmpty(e){return r.Enumerable.DefaultIfEmpty(this,e)}Distinct(e){return r.Enumerable.Distinct(this,e)}ElementAt(e){return r.Enumerable.ElementAt(this,e)}ElementAtOrDefault(e,t){return r.Enumerable.ElementAtOrDefault(this,e,t)}Except(e,t){return r.Enumerable.Except(this,e,t)}First(e){return r.Enumerable.First(this,e)}FirstOrDefault(e,t){return r.Enumerable.FirstOrDefaultWithArray(this.list.GetItems(),e,t)}GroupBy(e,t,n){return r.Enumerable.GroupBy(this,e,t,n)}GroupJoin(e,t,n,i,l){return r.Enumerable.GroupJoin(this,e,t,n,i,l)}Intersect(e,t){return r.Enumerable.Intersect(this,e,t)}Join(e,t,n,i,l){return r.Enumerable.Join(this,e,t,n,i,l)}Last(e){return r.Enumerable.Last(this,e)}LastOrDefault(e,t){return r.Enumerable.LastOrDefault(this,e,t)}Max(e){return r.Enumerable.Max(this,e)}Min(e){return r.Enumerable.Min(this,e)}Reverse(){return r.Enumerable.Reverse(this)}Select(e){return r.Enumerable.Select(this,e)}SelectMany(e,t){return r.Enumerable.SelectMany(this,e,t)}SequenceEqual(e,t){return r.Enumerable.SequenceEqual(this,e,t)}Single(e){return r.Enumerable.Single(this,e)}SingleOrDefault(e,t){return r.Enumerable.SingleOrDefault(this,e,t)}Skip(e){return r.Enumerable.Skip(this,e)}SkipWhile(e){return r.Enumerable.SkipWhile(this,e)}Sum(e){return r.Enumerable.Sum(this,e)}Take(e){return r.Enumerable.Take(this,e)}TakeWhile(e){return r.Enumerable.TakeWhile(this,e)}ToArray(){return r.Enumerable.ToArray(this)}ToDictionary(e,t,n){return r.Enumerable.ToDictionary(this,e,t,n)}ToList(){return r.Enumerable.ToList(this)}Union(e,t){return r.Enumerable.Union(this,e,t)}Where(e){return r.Enumerable.Where(this,e)}GetItems(){return this.list.GetItems()}}t.ReadOnlyCollection=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringFormatFlags=void 0,function(e){e[e.DirectionRightToLeft=1]="DirectionRightToLeft",e[e.DirectionVertical=2]="DirectionVertical",e[e.FitBlackBox=4]="FitBlackBox",e[e.DisplayFormatControl=32]="DisplayFormatControl",e[e.NoFontFallback=1024]="NoFontFallback",e[e.MeasureTrailingSpaces=2048]="MeasureTrailingSpaces",e[e.NoWrap=4096]="NoWrap",e[e.LineLimit=8192]="LineLimit",e[e.NoClip=16384]="NoClip"}(t.StringFormatFlags||(t.StringFormatFlags={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XImage=void 0;const r=n(83);t.XImage=class{get ImageEle(){return this._img}set ImageEle(e){this._img=e}get Base64(){return r.XImageUtil.ImageToBase64(this)}get Width(){return null!=this._img?this._img.width:null}set Width(e){null!=this._img&&(this._img.width=e)}get Height(){return null!=this._img?this._img.height:null}set Height(e){null!=this._img&&(this._img.height=e)}get HorizontalResolution(){return 96}get VerticalResolution(){return 96}Clone(){return null}DeepClone(){return null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(57),i=n(34),l=n(50),s=n(85),o=n(49),a=n(495),u=n(496);t.default=class{decode(e,t=null){let n=null,l=new u.default(e.getBlackMatrix()),h=null,d=null;try{let e=l.detectMirror(!1);h=e.getPoints(),this.reportFoundResultPoints(t,h),d=(new a.default).decode(e)}catch(e){n=e}if(null==d)try{let e=l.detectMirror(!0);h=e.getPoints(),this.reportFoundResultPoints(t,h),d=(new a.default).decode(e)}catch(e){if(null!=n)throw n;throw e}let c=new r.default(d.getText(),d.getRawBytes(),d.getNumBits(),h,i.default.AZTEC,o.default.currentTimeMillis()),p=d.getByteSegments();null!=p&&c.putMetadata(s.default.BYTE_SEGMENTS,p);let f=d.getECLevel();return null!=f&&c.putMetadata(s.default.ERROR_CORRECTION_LEVEL,f),c}reportFoundResultPoints(e,t){if(null!=e){let n=e.get(l.default.NEED_RESULT_POINT_CALLBACK);null!=n&&t.forEach((e,t,r)=>{n.foundPossibleResultPoint(e)})}}reset(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(41),l=n(72);class s{constructor(e,t,n,i){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),null==t&&(t=s.INIT_SIZE),null==n&&(n=e.getWidth()/2|0),null==i&&(i=e.getHeight()/2|0);const l=t/2|0;if(this.leftInit=n-l,this.rightInit=n+l,this.upInit=i-l,this.downInit=i+l,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new r.NotFoundException}detect(){let e=this.leftInit,t=this.rightInit,n=this.upInit,i=this.downInit,l=!1,s=!0,o=!1,a=!1,u=!1,h=!1,d=!1;const c=this.width,p=this.height;for(;s;){s=!1;let r=!0;for(;(r||!a)&&t<c;)r=this.containsBlackPoint(n,i,t,!1),r?(t++,s=!0,a=!0):a||t++;if(t>=c){l=!0;break}let f=!0;for(;(f||!u)&&i<p;)f=this.containsBlackPoint(e,t,i,!0),f?(i++,s=!0,u=!0):u||i++;if(i>=p){l=!0;break}let g=!0;for(;(g||!h)&&e>=0;)g=this.containsBlackPoint(n,i,e,!1),g?(e--,s=!0,h=!0):h||e--;if(e<0){l=!0;break}let m=!0;for(;(m||!d)&&n>=0;)m=this.containsBlackPoint(e,t,n,!0),m?(n--,s=!0,d=!0):d||n--;if(n<0){l=!0;break}s&&(o=!0)}if(!l&&o){const l=t-e;let s=null;for(let t=1;null===s&&t<l;t++)s=this.getBlackPointOnSegment(e,i-t,e+t,i);if(null==s)throw new r.NotFoundException;let o=null;for(let t=1;null===o&&t<l;t++)o=this.getBlackPointOnSegment(e,n+t,e+t,n);if(null==o)throw new r.NotFoundException;let a=null;for(let e=1;null===a&&e<l;e++)a=this.getBlackPointOnSegment(t,n+e,t-e,n);if(null==a)throw new r.NotFoundException;let u=null;for(let e=1;null===u&&e<l;e++)u=this.getBlackPointOnSegment(t,i-e,t-e,i);if(null==u)throw new r.NotFoundException;return this.centerEdges(u,s,a,o)}throw new r.NotFoundException}getBlackPointOnSegment(e,t,n,r){const s=l.default.round(l.default.distance(e,t,n,r)),o=(n-e)/s,a=(r-t)/s,u=this.image;for(let n=0;n<s;n++){const r=l.default.round(e+n*o),s=l.default.round(t+n*a);if(u.get(r,s))return new i.default(r,s)}return null}centerEdges(e,t,n,r){const l=e.getX(),o=e.getY(),a=t.getX(),u=t.getY(),h=n.getX(),d=n.getY(),c=r.getX(),p=r.getY(),f=s.CORR;return l<this.width/2?[new i.default(c-f,p+f),new i.default(a+f,u+f),new i.default(h-f,d-f),new i.default(l+f,o-f)]:[new i.default(c+f,p+f),new i.default(a+f,u-f),new i.default(h-f,d+f),new i.default(l-f,o-f)]}containsBlackPoint(e,t,n,r){const i=this.image;if(r){for(let r=e;r<=t;r++)if(i.get(r,n))return!0}else for(let r=e;r<=t;r++)if(i.get(n,r))return!0;return!1}}t.default=s,s.INIT_SIZE=10,s.CORR=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t,n,r,i,l,s,o,a){this.a11=e,this.a21=t,this.a31=n,this.a12=r,this.a22=i,this.a32=l,this.a13=s,this.a23=o,this.a33=a}static quadrilateralToQuadrilateral(e,t,n,i,l,s,o,a,u,h,d,c,p,f,g,m){const E=r.quadrilateralToSquare(e,t,n,i,l,s,o,a);return r.squareToQuadrilateral(u,h,d,c,p,f,g,m).times(E)}transformPoints(e){const t=e.length,n=this.a11,r=this.a12,i=this.a13,l=this.a21,s=this.a22,o=this.a23,a=this.a31,u=this.a32,h=this.a33;for(let d=0;d<t;d+=2){const t=e[d],c=e[d+1],p=i*t+o*c+h;e[d]=(n*t+l*c+a)/p,e[d+1]=(r*t+s*c+u)/p}}transformPointsWithValues(e,t){const n=this.a11,r=this.a12,i=this.a13,l=this.a21,s=this.a22,o=this.a23,a=this.a31,u=this.a32,h=this.a33,d=e.length;for(let c=0;c<d;c++){const d=e[c],p=t[c],f=i*d+o*p+h;e[c]=(n*d+l*p+a)/f,t[c]=(r*d+s*p+u)/f}}static squareToQuadrilateral(e,t,n,i,l,s,o,a){const u=e-n+l-o,h=t-i+s-a;if(0===u&&0===h)return new r(n-e,l-n,e,i-t,s-i,t,0,0,1);{const d=n-l,c=o-l,p=i-s,f=a-s,g=d*f-c*p,m=(u*f-c*h)/g,E=(d*h-u*p)/g;return new r(n-e+m*n,o-e+E*o,e,i-t+m*i,a-t+E*a,t,m,E,1)}}static quadrilateralToSquare(e,t,n,i,l,s,o,a){return r.squareToQuadrilateral(e,t,n,i,l,s,o,a).buildAdjoint()}buildAdjoint(){return new r(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new r(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(274),l=n(275),s=n(276),o=n(50),a=n(280),u=n(500),h=n(86),d=n(5);class c extends h.default{constructor(e){super(),this.readers=[];const t=e?e.get(o.default.POSSIBLE_FORMATS):null,n=e&&void 0!==e.get(o.default.ASSUME_CODE_39_CHECK_DIGIT);t&&((t.includes(r.default.EAN_13)||t.includes(r.default.EAN_8))&&this.readers.push(new u.default(e)),t.includes(r.default.CODE_39)&&this.readers.push(new i.default(n)),t.includes(r.default.CODE_128)&&this.readers.push(new l.default),t.includes(r.default.ITF)&&this.readers.push(new a.default),t.includes(r.default.RSS_14)&&this.readers.push(new s.default)),0===this.readers.length&&(this.readers.push(new i.default),this.readers.push(new u.default(e)),this.readers.push(new l.default),this.readers.push(new a.default),this.readers.push(new s.default))}decodeRow(e,t,n){for(let r=0;r<this.readers.length;r++)try{return this.readers[r].decodeRow(e,t,n)}catch(e){}throw new d.NotFoundException}reset(){this.readers.forEach(e=>e.reset())}}t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof r))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(506),i=n(57),l=n(34),s=n(50),o=n(85),a=n(78),u=n(511),h=n(49),d=n(5);class c{constructor(){this.decoder=new r.default}decode(e,t=null){let n,r;if(null!=t&&t.has(s.default.PURE_BARCODE)){const t=c.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(t),r=c.NO_POINTS}else{const t=new u.default(e.getBlackMatrix()).detect();n=this.decoder.decode(t.getBits()),r=t.getPoints()}const a=n.getRawBytes(),d=new i.default(n.getText(),a,8*a.length,r,l.default.DATA_MATRIX,h.default.currentTimeMillis()),p=n.getByteSegments();null!=p&&d.putMetadata(o.default.BYTE_SEGMENTS,p);const f=n.getECLevel();return null!=f&&d.putMetadata(o.default.ERROR_CORRECTION_LEVEL,f),d}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(null==t||null==n)throw new d.NotFoundException;const r=this.moduleSize(t,e);let i=t[1];const l=n[1];let s=t[0];const o=(n[0]-s+1)/r,u=(l-i+1)/r;if(o<=0||u<=0)throw new d.NotFoundException;const h=r/2;i+=h,s+=h;const c=new a.default(o,u);for(let t=0;t<u;t++){const n=i+t*r;for(let i=0;i<o;i++)e.get(s+i*r,n)&&c.set(i,t)}return c}static moduleSize(e,t){const n=t.getWidth();let r=e[0];const i=e[1];for(;r<n&&t.get(r,i);)r++;if(r===n)throw new d.NotFoundException;const l=r-e[0];if(0===l)throw new d.NotFoundException;return l}}t.default=c,c.NO_POINTS=[]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.default=class{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new r.IllegalArgumentException(""+e);let t=0,n=this.bitOffset,i=this.byteOffset;const l=this.bytes;if(n>0){const r=8-n,s=e<r?e:r,o=r-s,a=255>>8-s<<o;t=(l[i]&a)>>o,e-=s,n+=s,8===n&&(n=0,i++)}if(e>0){for(;e>=8;)t=t<<8|255&l[i],i++,e-=8;if(e>0){const r=8-e,s=255>>r<<r;t=t<<e|(l[i]&s)>>r,n+=e}}return this.bitOffset=n,this.byteOffset=i,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(50),l=n(57),s=n(85),o=n(78),a=n(513),u=n(285),h=n(520),d=n(5);class c{constructor(){this.decoder=new a.default}getDecoder(){return this.decoder}decode(e,t){let n,o;if(null!=t&&void 0!==t.get(i.default.PURE_BARCODE)){const r=c.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(r,t),o=c.NO_POINTS}else{const r=new h.default(e.getBlackMatrix()).detect(t);n=this.decoder.decodeBitMatrix(r.getBits(),t),o=r.getPoints()}n.getOther()instanceof u.default&&n.getOther().applyMirroredCorrection(o);const a=new l.default(n.getText(),n.getRawBytes(),void 0,o,r.default.QR_CODE,void 0),d=n.getByteSegments();null!==d&&a.putMetadata(s.default.BYTE_SEGMENTS,d);const p=n.getECLevel();return null!==p&&a.putMetadata(s.default.ERROR_CORRECTION_LEVEL,p),n.hasStructuredAppend()&&(a.putMetadata(s.default.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),a.putMetadata(s.default.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),a}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(null===t||null===n)throw new d.NotFoundException;const r=this.moduleSize(t,e);let i=t[1],l=n[1],s=t[0],a=n[0];if(s>=a||i>=l)throw new d.NotFoundException;if(l-i!=a-s&&(a=s+(l-i),a>=e.getWidth()))throw new d.NotFoundException;const u=Math.round((a-s+1)/r),h=Math.round((l-i+1)/r);if(u<=0||h<=0)throw new d.NotFoundException;if(h!==u)throw new d.NotFoundException;const c=Math.floor(r/2);i+=c,s+=c;const p=s+Math.floor((u-1)*r)-a;if(p>0){if(p>c)throw new d.NotFoundException;s-=p}const f=i+Math.floor((h-1)*r)-l;if(f>0){if(f>c)throw new d.NotFoundException;i-=f}const g=new o.default(u,h);for(let t=0;t<h;t++){const n=i+Math.floor(t*r);for(let i=0;i<u;i++)e.get(s+Math.floor(i*r),n)&&g.set(i,t)}return g}static moduleSize(e,t){const n=t.getHeight(),r=t.getWidth();let i=e[0],l=e[1],s=!0,o=0;for(;i<r&&l<n;){if(s!==t.get(i,l)){if(5==++o)break;s=!s}i++,l++}if(i===r||l===n)throw new d.NotFoundException;return(i-e[0])/7}}t.default=c,c.NO_POINTS=new Array},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(78),i=n(284),l=n(515),s=n(516),o=n(5);class a{constructor(e,t,...n){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=n;let r=0;const i=n[0].getECCodewordsPerBlock(),l=n[0].getECBlocks();for(const e of l)r+=e.getCount()*(e.getDataCodewords()+i);this.totalCodewords=r}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!=1)throw new o.FormatException;try{return this.getVersionForNumber((e-17)/4)}catch(e){throw new o.FormatException}}static getVersionForNumber(e){if(e<1||e>40)throw new o.IllegalArgumentException;return a.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,n=0;for(let r=0;r<a.VERSION_DECODE_INFO.length;r++){const l=a.VERSION_DECODE_INFO[r];if(l===e)return a.getVersionForNumber(r+7);const s=i.default.numBitsDiffering(e,l);s<t&&(n=r+7,t=s)}return t<=3?a.getVersionForNumber(n):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new r.default(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const n=this.alignmentPatternCenters.length;for(let e=0;e<n;e++){const r=this.alignmentPatternCenters[e]-2;for(let i=0;i<n;i++)0===e&&(0===i||i===n-1)||e===n-1&&0===i||t.setRegion(this.alignmentPatternCenters[i]-2,r,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}t.default=a,a.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),a.VERSIONS=[new a(1,new Int32Array(0),new l.default(7,new s.default(1,19)),new l.default(10,new s.default(1,16)),new l.default(13,new s.default(1,13)),new l.default(17,new s.default(1,9))),new a(2,Int32Array.from([6,18]),new l.default(10,new s.default(1,34)),new l.default(16,new s.default(1,28)),new l.default(22,new s.default(1,22)),new l.default(28,new s.default(1,16))),new a(3,Int32Array.from([6,22]),new l.default(15,new s.default(1,55)),new l.default(26,new s.default(1,44)),new l.default(18,new s.default(2,17)),new l.default(22,new s.default(2,13))),new a(4,Int32Array.from([6,26]),new l.default(20,new s.default(1,80)),new l.default(18,new s.default(2,32)),new l.default(26,new s.default(2,24)),new l.default(16,new s.default(4,9))),new a(5,Int32Array.from([6,30]),new l.default(26,new s.default(1,108)),new l.default(24,new s.default(2,43)),new l.default(18,new s.default(2,15),new s.default(2,16)),new l.default(22,new s.default(2,11),new s.default(2,12))),new a(6,Int32Array.from([6,34]),new l.default(18,new s.default(2,68)),new l.default(16,new s.default(4,27)),new l.default(24,new s.default(4,19)),new l.default(28,new s.default(4,15))),new a(7,Int32Array.from([6,22,38]),new l.default(20,new s.default(2,78)),new l.default(18,new s.default(4,31)),new l.default(18,new s.default(2,14),new s.default(4,15)),new l.default(26,new s.default(4,13),new s.default(1,14))),new a(8,Int32Array.from([6,24,42]),new l.default(24,new s.default(2,97)),new l.default(22,new s.default(2,38),new s.default(2,39)),new l.default(22,new s.default(4,18),new s.default(2,19)),new l.default(26,new s.default(4,14),new s.default(2,15))),new a(9,Int32Array.from([6,26,46]),new l.default(30,new s.default(2,116)),new l.default(22,new s.default(3,36),new s.default(2,37)),new l.default(20,new s.default(4,16),new s.default(4,17)),new l.default(24,new s.default(4,12),new s.default(4,13))),new a(10,Int32Array.from([6,28,50]),new l.default(18,new s.default(2,68),new s.default(2,69)),new l.default(26,new s.default(4,43),new s.default(1,44)),new l.default(24,new s.default(6,19),new s.default(2,20)),new l.default(28,new s.default(6,15),new s.default(2,16))),new a(11,Int32Array.from([6,30,54]),new l.default(20,new s.default(4,81)),new l.default(30,new s.default(1,50),new s.default(4,51)),new l.default(28,new s.default(4,22),new s.default(4,23)),new l.default(24,new s.default(3,12),new s.default(8,13))),new a(12,Int32Array.from([6,32,58]),new l.default(24,new s.default(2,92),new s.default(2,93)),new l.default(22,new s.default(6,36),new s.default(2,37)),new l.default(26,new s.default(4,20),new s.default(6,21)),new l.default(28,new s.default(7,14),new s.default(4,15))),new a(13,Int32Array.from([6,34,62]),new l.default(26,new s.default(4,107)),new l.default(22,new s.default(8,37),new s.default(1,38)),new l.default(24,new s.default(8,20),new s.default(4,21)),new l.default(22,new s.default(12,11),new s.default(4,12))),new a(14,Int32Array.from([6,26,46,66]),new l.default(30,new s.default(3,115),new s.default(1,116)),new l.default(24,new s.default(4,40),new s.default(5,41)),new l.default(20,new s.default(11,16),new s.default(5,17)),new l.default(24,new s.default(11,12),new s.default(5,13))),new a(15,Int32Array.from([6,26,48,70]),new l.default(22,new s.default(5,87),new s.default(1,88)),new l.default(24,new s.default(5,41),new s.default(5,42)),new l.default(30,new s.default(5,24),new s.default(7,25)),new l.default(24,new s.default(11,12),new s.default(7,13))),new a(16,Int32Array.from([6,26,50,74]),new l.default(24,new s.default(5,98),new s.default(1,99)),new l.default(28,new s.default(7,45),new s.default(3,46)),new l.default(24,new s.default(15,19),new s.default(2,20)),new l.default(30,new s.default(3,15),new s.default(13,16))),new a(17,Int32Array.from([6,30,54,78]),new l.default(28,new s.default(1,107),new s.default(5,108)),new l.default(28,new s.default(10,46),new s.default(1,47)),new l.default(28,new s.default(1,22),new s.default(15,23)),new l.default(28,new s.default(2,14),new s.default(17,15))),new a(18,Int32Array.from([6,30,56,82]),new l.default(30,new s.default(5,120),new s.default(1,121)),new l.default(26,new s.default(9,43),new s.default(4,44)),new l.default(28,new s.default(17,22),new s.default(1,23)),new l.default(28,new s.default(2,14),new s.default(19,15))),new a(19,Int32Array.from([6,30,58,86]),new l.default(28,new s.default(3,113),new s.default(4,114)),new l.default(26,new s.default(3,44),new s.default(11,45)),new l.default(26,new s.default(17,21),new s.default(4,22)),new l.default(26,new s.default(9,13),new s.default(16,14))),new a(20,Int32Array.from([6,34,62,90]),new l.default(28,new s.default(3,107),new s.default(5,108)),new l.default(26,new s.default(3,41),new s.default(13,42)),new l.default(30,new s.default(15,24),new s.default(5,25)),new l.default(28,new s.default(15,15),new s.default(10,16))),new a(21,Int32Array.from([6,28,50,72,94]),new l.default(28,new s.default(4,116),new s.default(4,117)),new l.default(26,new s.default(17,42)),new l.default(28,new s.default(17,22),new s.default(6,23)),new l.default(30,new s.default(19,16),new s.default(6,17))),new a(22,Int32Array.from([6,26,50,74,98]),new l.default(28,new s.default(2,111),new s.default(7,112)),new l.default(28,new s.default(17,46)),new l.default(30,new s.default(7,24),new s.default(16,25)),new l.default(24,new s.default(34,13))),new a(23,Int32Array.from([6,30,54,78,102]),new l.default(30,new s.default(4,121),new s.default(5,122)),new l.default(28,new s.default(4,47),new s.default(14,48)),new l.default(30,new s.default(11,24),new s.default(14,25)),new l.default(30,new s.default(16,15),new s.default(14,16))),new a(24,Int32Array.from([6,28,54,80,106]),new l.default(30,new s.default(6,117),new s.default(4,118)),new l.default(28,new s.default(6,45),new s.default(14,46)),new l.default(30,new s.default(11,24),new s.default(16,25)),new l.default(30,new s.default(30,16),new s.default(2,17))),new a(25,Int32Array.from([6,32,58,84,110]),new l.default(26,new s.default(8,106),new s.default(4,107)),new l.default(28,new s.default(8,47),new s.default(13,48)),new l.default(30,new s.default(7,24),new s.default(22,25)),new l.default(30,new s.default(22,15),new s.default(13,16))),new a(26,Int32Array.from([6,30,58,86,114]),new l.default(28,new s.default(10,114),new s.default(2,115)),new l.default(28,new s.default(19,46),new s.default(4,47)),new l.default(28,new s.default(28,22),new s.default(6,23)),new l.default(30,new s.default(33,16),new s.default(4,17))),new a(27,Int32Array.from([6,34,62,90,118]),new l.default(30,new s.default(8,122),new s.default(4,123)),new l.default(28,new s.default(22,45),new s.default(3,46)),new l.default(30,new s.default(8,23),new s.default(26,24)),new l.default(30,new s.default(12,15),new s.default(28,16))),new a(28,Int32Array.from([6,26,50,74,98,122]),new l.default(30,new s.default(3,117),new s.default(10,118)),new l.default(28,new s.default(3,45),new s.default(23,46)),new l.default(30,new s.default(4,24),new s.default(31,25)),new l.default(30,new s.default(11,15),new s.default(31,16))),new a(29,Int32Array.from([6,30,54,78,102,126]),new l.default(30,new s.default(7,116),new s.default(7,117)),new l.default(28,new s.default(21,45),new s.default(7,46)),new l.default(30,new s.default(1,23),new s.default(37,24)),new l.default(30,new s.default(19,15),new s.default(26,16))),new a(30,Int32Array.from([6,26,52,78,104,130]),new l.default(30,new s.default(5,115),new s.default(10,116)),new l.default(28,new s.default(19,47),new s.default(10,48)),new l.default(30,new s.default(15,24),new s.default(25,25)),new l.default(30,new s.default(23,15),new s.default(25,16))),new a(31,Int32Array.from([6,30,56,82,108,134]),new l.default(30,new s.default(13,115),new s.default(3,116)),new l.default(28,new s.default(2,46),new s.default(29,47)),new l.default(30,new s.default(42,24),new s.default(1,25)),new l.default(30,new s.default(23,15),new s.default(28,16))),new a(32,Int32Array.from([6,34,60,86,112,138]),new l.default(30,new s.default(17,115)),new l.default(28,new s.default(10,46),new s.default(23,47)),new l.default(30,new s.default(10,24),new s.default(35,25)),new l.default(30,new s.default(19,15),new s.default(35,16))),new a(33,Int32Array.from([6,30,58,86,114,142]),new l.default(30,new s.default(17,115),new s.default(1,116)),new l.default(28,new s.default(14,46),new s.default(21,47)),new l.default(30,new s.default(29,24),new s.default(19,25)),new l.default(30,new s.default(11,15),new s.default(46,16))),new a(34,Int32Array.from([6,34,62,90,118,146]),new l.default(30,new s.default(13,115),new s.default(6,116)),new l.default(28,new s.default(14,46),new s.default(23,47)),new l.default(30,new s.default(44,24),new s.default(7,25)),new l.default(30,new s.default(59,16),new s.default(1,17))),new a(35,Int32Array.from([6,30,54,78,102,126,150]),new l.default(30,new s.default(12,121),new s.default(7,122)),new l.default(28,new s.default(12,47),new s.default(26,48)),new l.default(30,new s.default(39,24),new s.default(14,25)),new l.default(30,new s.default(22,15),new s.default(41,16))),new a(36,Int32Array.from([6,24,50,76,102,128,154]),new l.default(30,new s.default(6,121),new s.default(14,122)),new l.default(28,new s.default(6,47),new s.default(34,48)),new l.default(30,new s.default(46,24),new s.default(10,25)),new l.default(30,new s.default(2,15),new s.default(64,16))),new a(37,Int32Array.from([6,28,54,80,106,132,158]),new l.default(30,new s.default(17,122),new s.default(4,123)),new l.default(28,new s.default(29,46),new s.default(14,47)),new l.default(30,new s.default(49,24),new s.default(10,25)),new l.default(30,new s.default(24,15),new s.default(46,16))),new a(38,Int32Array.from([6,32,58,84,110,136,162]),new l.default(30,new s.default(4,122),new s.default(18,123)),new l.default(28,new s.default(13,46),new s.default(32,47)),new l.default(30,new s.default(48,24),new s.default(14,25)),new l.default(30,new s.default(42,15),new s.default(32,16))),new a(39,Int32Array.from([6,26,54,82,110,138,166]),new l.default(30,new s.default(20,117),new s.default(4,118)),new l.default(28,new s.default(40,47),new s.default(7,48)),new l.default(30,new s.default(43,24),new s.default(22,25)),new l.default(30,new s.default(10,15),new s.default(67,16))),new a(40,Int32Array.from([6,30,58,86,114,142,170]),new l.default(30,new s.default(19,118),new s.default(6,119)),new l.default(28,new s.default(18,47),new s.default(31,48)),new l.default(30,new s.default(34,24),new s.default(34,25)),new l.default(30,new s.default(20,15),new s.default(61,16)))]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.buffer=""}static form(e,t){let n=-1;return e.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,(function(e,r,i,l,s,o){if("%%"===e)return"%";if(void 0===t[++n])return;e=l?parseInt(l.substr(1)):void 0;let a,u=s?parseInt(s.substr(1)):void 0;switch(o){case"s":a=t[n];break;case"c":a=t[n][0];break;case"f":a=parseFloat(t[n]).toFixed(e);break;case"p":a=parseFloat(t[n]).toPrecision(e);break;case"e":a=parseFloat(t[n]).toExponential(e);break;case"x":a=parseInt(t[n]).toString(u||16);break;case"d":a=parseFloat(parseInt(t[n],u||10).toPrecision(e)).toFixed(0)}a="object"==typeof a?JSON.stringify(a):(+a).toString(u);let h=parseInt(i),d=i&&i[0]+""=="0"?"0":" ";for(;a.length<h;)a=void 0!==r?a+d:d+a;return a}))}format(e,...t){this.buffer+=r.form(e,t)}toString(){return this.buffer}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(158),i=n(99),l=n(114),s=n(101),o=n(293),a=n(286),u=n(205),h=n(294),d=n(546),c=n(208),p=n(547),f=n(124),g=n(548),m=n(5);class E{constructor(){}static calculateMaskPenalty(e){return h.default.applyMaskPenaltyRule1(e)+h.default.applyMaskPenaltyRule2(e)+h.default.applyMaskPenaltyRule3(e)+h.default.applyMaskPenaltyRule4(e)}static encode(e,t,n=null){let s=E.DEFAULT_BYTE_MODE_ENCODING;const o=null!==n&&void 0!==n.get(r.default.CHARACTER_SET);o&&(s=n.get(r.default.CHARACTER_SET).toString());const h=this.chooseMode(e,s),f=new i.default;if(h===a.default.BYTE&&(o||E.DEFAULT_BYTE_MODE_ENCODING!==s)){const e=l.default.getCharacterSetECIByName(s);void 0!==e&&this.appendECI(e,f)}this.appendModeInfo(h,f);const g=new i.default;let C;if(this.appendBytes(e,h,g,s),null!==n&&void 0!==n.get(r.default.QR_VERSION)){const e=Number.parseInt(n.get(r.default.QR_VERSION).toString(),10);C=u.default.getVersionForNumber(e);const i=this.calculateBitsNeeded(h,f,g,C);if(!this.willFit(i,C,t))throw new m.WriterException("Data too big for requested version")}else C=this.recommendVersion(t,h,f,g);const A=new i.default;A.appendBitArray(f);const y=h===a.default.BYTE?g.getSizeInBytes():e.length;this.appendLengthInfo(y,C,h,A),A.appendBitArray(g);const I=C.getECBlocksForLevel(t),S=C.getTotalCodewords()-I.getTotalECCodewords();this.terminateBits(S,A);const _=this.interleaveWithECBytes(A,C.getTotalCodewords(),S,I.getNumBlocks()),w=new c.default;w.setECLevel(t),w.setMode(h),w.setVersion(C);const b=C.getDimensionForVersion(),x=new d.default(b,b),P=this.chooseMaskPattern(_,t,C,x);return w.setMaskPattern(P),p.default.buildMatrix(_,t,C,P,x),w.setMatrix(x),w}static recommendVersion(e,t,n,r){const i=this.calculateBitsNeeded(t,n,r,u.default.getVersionForNumber(1)),l=this.chooseVersion(i,e),s=this.calculateBitsNeeded(t,n,r,l);return this.chooseVersion(s,e)}static calculateBitsNeeded(e,t,n,r){return t.getSize()+e.getCharacterCountBits(r)+n.getSize()}static getAlphanumericCode(e){return e<E.ALPHANUMERIC_TABLE.length?E.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(l.default.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return a.default.KANJI;let n=!1,r=!1;for(let t=0,i=e.length;t<i;++t){const i=e.charAt(t);if(E.isDigit(i))n=!0;else{if(-1===this.getAlphanumericCode(i.charCodeAt(0)))return a.default.BYTE;r=!0}}return r?a.default.ALPHANUMERIC:n?a.default.NUMERIC:a.default.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=f.default.encode(e,l.default.SJIS)}catch(e){return!1}const n=t.length;if(n%2!=0)return!1;for(let e=0;e<n;e+=2){const n=255&t[e];if((n<129||n>159)&&(n<224||n>235))return!1}return!0}static chooseMaskPattern(e,t,n,r){let i=Number.MAX_SAFE_INTEGER,l=-1;for(let s=0;s<c.default.NUM_MASK_PATTERNS;s++){p.default.buildMatrix(e,t,n,s,r);let o=this.calculateMaskPenalty(r);o<i&&(i=o,l=s)}return l}static chooseVersion(e,t){for(let n=1;n<=40;n++){const r=u.default.getVersionForNumber(n);if(E.willFit(e,r,t))return r}throw new m.WriterException("Data too big")}static willFit(e,t,n){return t.getTotalCodewords()-t.getECBlocksForLevel(n).getTotalECCodewords()>=(e+7)/8}static terminateBits(e,t){const n=8*e;if(t.getSize()>n)throw new m.WriterException("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(let e=0;e<4&&t.getSize()<n;++e)t.appendBit(!1);const r=7&t.getSize();if(r>0)for(let e=r;e<8;e++)t.appendBit(!1);const i=e-t.getSizeInBytes();for(let e=0;e<i;++e)t.appendBits(0==(1&e)?236:17,8);if(t.getSize()!==n)throw new m.WriterException("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,n,r,i,l){if(r>=n)throw new m.WriterException("Block ID too large");const s=e%n,o=n-s,a=Math.floor(e/n),u=a+1,h=Math.floor(t/n),d=h+1,c=a-h,p=u-d;if(c!==p)throw new m.WriterException("EC bytes mismatch");if(n!==o+s)throw new m.WriterException("RS blocks mismatch");if(e!==(h+c)*o+(d+p)*s)throw new m.WriterException("Total bytes mismatch");r<o?(i[0]=h,l[0]=c):(i[0]=d,l[0]=p)}static interleaveWithECBytes(e,t,n,r){if(e.getSizeInBytes()!==n)throw new m.WriterException("Number of bits and data bytes does not match");let l=0,s=0,o=0;const a=new Array;for(let i=0;i<r;++i){const u=new Int32Array(1),h=new Int32Array(1);E.getNumDataBytesAndNumECBytesForBlockID(t,n,r,i,u,h);const d=u[0],c=new Uint8Array(d);e.toBytes(8*l,c,0,d);const p=E.generateECBytes(c,h[0]);a.push(new g.default(c,p)),s=Math.max(s,d),o=Math.max(o,p.length),l+=u[0]}if(n!==l)throw new m.WriterException("Data bytes does not match offset");const u=new i.default;for(let e=0;e<s;++e)for(const t of a){const n=t.getDataBytes();e<n.length&&u.appendBits(n[e],8)}for(let e=0;e<o;++e)for(const t of a){const n=t.getErrorCorrectionBytes();e<n.length&&u.appendBits(n[e],8)}if(t!==u.getSizeInBytes())throw new m.WriterException("Interleaving error: "+t+" and "+u.getSizeInBytes()+" differ.");return u}static generateECBytes(e,t){const n=e.length,r=new Int32Array(n+t);for(let t=0;t<n;t++)r[t]=255&e[t];new o.default(s.default.QR_CODE_FIELD_256).encode(r,t);const i=new Uint8Array(t);for(let e=0;e<t;e++)i[e]=r[n+e];return i}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,n,r){const i=n.getCharacterCountBits(t);if(e>=1<<i)throw new m.WriterException(e+" is bigger than "+((1<<i)-1));r.appendBits(e,i)}static appendBytes(e,t,n,r){switch(t){case a.default.NUMERIC:E.appendNumericBytes(e,n);break;case a.default.ALPHANUMERIC:E.appendAlphanumericBytes(e,n);break;case a.default.BYTE:E.append8BitBytes(e,n,r);break;case a.default.KANJI:E.appendKanjiBytes(e,n);break;default:throw new m.WriterException("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=E.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=E.getDigit(e.charAt(r));if(r+2<n){const n=E.getDigit(e.charAt(r+1)),l=E.getDigit(e.charAt(r+2));t.appendBits(100*i+10*n+l,10),r+=3}else if(r+1<n){const n=E.getDigit(e.charAt(r+1));t.appendBits(10*i+n,7),r+=2}else t.appendBits(i,4),r++}}static appendAlphanumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=E.getAlphanumericCode(e.charCodeAt(r));if(-1===i)throw new m.WriterException;if(r+1<n){const n=E.getAlphanumericCode(e.charCodeAt(r+1));if(-1===n)throw new m.WriterException;t.appendBits(45*i+n,11),r+=2}else t.appendBits(i,6),r++}}static append8BitBytes(e,t,n){let r;try{r=f.default.encode(e,n)}catch(e){throw new m.WriterException(e)}for(let e=0,n=r.length;e!==n;e++){const n=r[e];t.appendBits(n,8)}}static appendKanjiBytes(e,t){let n;try{n=f.default.encode(e,l.default.SJIS)}catch(e){throw new m.WriterException(e)}const r=n.length;for(let e=0;e<r;e+=2){const r=(255&n[e])<<8&4294967295|255&n[e+1];let i=-1;if(r>=33088&&r<=40956?i=r-33088:r>=57408&&r<=60351&&(i=r-49472),-1===i)throw new m.WriterException("Invalid byte sequence");const l=192*(i>>8)+(255&i);t.appendBits(l,13)}}static appendECI(e,t){t.appendBits(a.default.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}t.default=E,E.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),E.DEFAULT_BYTE_MODE_ENCODING=l.default.UTF8.getName()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(21);class i{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new r.default;return e.append("<<\n"),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append("\n ecLevel: "),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append("\n version: "),e.append(this.version?this.version.toString():"null"),e.append("\n maskPattern: "),e.append(this.maskPattern.toString()),this.matrix?(e.append("\n matrix:\n"),e.append(this.matrix.toString())):e.append("\n matrix: null\n"),e.append(">>\n"),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<i.NUM_MASK_PATTERNS}}t.default=i,i.NUM_MASK_PATTERNS=8},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XFontStyle=void 0;const r=n(51),i=(n(301),n(3)),l=n(8),s=n(103),o=n(160),a=(n(35),n(4));class u{constructor(e){this.propList=null,this.isDefault=!1,this.defaultStyle=null,this.isDefault=!1,this.propList=new o.XPropertyCollection,this.propList.XmlEleName="_Alone_FntStyle_",this.CopyFrom(e)}set Default(e){this.isDefault=e}SetPropList(e){this.propList=e}get DefaultFntStyle(){let e=null;return e=this.isDefault?this:null==this.defaultStyle?null:this.defaultStyle.XFontStyle,e}set DefaultStyle(e){this.isDefault||(this.defaultStyle=e)}get FontName(){let e,t=this.propList.GetPropValue("FontName");if(null!=t)e=t;else if(this.isDefault)e=u.DefaultFnt.Name;else{let t=this.DefaultFntStyle;e=null==t?u.DefaultFnt.Name:t.FontName}return e}set FontName(e){if(!this.isDefault){let t=this.DefaultFntStyle;null!=t&&this.propList.ModifyProperty("FontName",e,t.FontName)}}SetDefaultFntNameSz(e,t,n){null!=e&&null!=e&&t>0&&(this.propList.ModifyProperty("FontName",e,null),this.propList.ModifyProperty("FontSize",t,0),this.propList.ModifyProperty("FontSizeName",n,""))}get FontSize(){let e,t=this.propList.GetPropValue("FontSize"),n=l.CNumUtil.TryParseFloat(t,-1);if(n>0)e=n;else if(this.isDefault)e=u.DefaultFnt.SizeInPoints;else{let t=this.DefaultFntStyle;e=null==t?u.DefaultFnt.SizeInPoints:t.FontSize}return e}set FontSize(e){if(!this.isDefault){let t=this.DefaultFntStyle;null!=t&&this.propList.ModifyProperty("FontSize",e.toString(),t.FontSize.toString())}}get IsBold(){let e=this.propList.GetPropValue("Bold");return l.CNumUtil.TryParseBool(e,!1)}set IsBold(e){this.isDefault||this.propList.ModifyProperty("Bold",l.CNumUtil.ToStringForBool(e),"false")}get IsItalic(){let e=this.propList.GetPropValue("Italic");return l.CNumUtil.TryParseBool(e,!1)}set IsItalic(e){this.isDefault||this.propList.ModifyProperty("Italic",l.CNumUtil.ToStringForBool(e),"false")}get IsUnderline(){let e=this.propList.GetPropValue("Underline");return l.CNumUtil.TryParseBool(e,!1)}set IsUnderline(e){this.isDefault||this.propList.ModifyProperty("Underline",l.CNumUtil.ToStringForBool(e),"false")}get IsStrikeout(){let e=this.propList.GetPropValue("Strikeout");return l.CNumUtil.TryParseBool(e,!1)}set IsStrikeout(e){this.isDefault||this.propList.ModifyProperty("Strikeout",l.CNumUtil.ToStringForBool(e),"false")}_Clear_FontAttrs(){this.propList.RemoveProperties(["FontName","FontSize","FontSizeName","Bold","Italic","Strikeout"])}IsDefaultStyleValid(){return null!=this.defaultStyle}GetPropValue(e){let t;return t=null==this.propList||0==this.propList.Count()?null:this.propList.GetPropValue(e),t}UpdateFontAttrs(e){if(null!=e&&!this.isDefault){this._Clear_FontAttrs();let t=this.DefaultFntStyle,n=null==t?u.DefaultFnt:t.BuildFont();if(!u._IsDocDftFont(e.Name,e.SizeInPoints,e.Style,n)){this.propList.ModifyProperty("FontName",e.Name,n.Name),this.propList.ModifyProperty("FontSize",e.SizeInPoints.toString(),n.SizeInPoints.toString());e.Style;e.Bold&&this.propList.ModifyProperty("Bold","true",null),e.Italic&&this.propList.ModifyProperty("Italic","true",null),e.Strikeout&&this.propList.ModifyProperty("Strikeout","true",null)}}}BuildFont(){let e;if(this.isDefault){return e=new r.Font(this.FontName,this.FontSize),e}let t=this.DefaultFntStyle;if(null==t)return e=null,e;let n=t.BuildFont();if(null==this.propList||this.propList.IsEmpty())return e=n,e;let i=this.FontName;if(a.default.IsNullOrEmpty(i))return e=n,e;let l=this.FontSize;if(l<=0)return e=n,e;let o=s.FontStyle.Regular;return this.IsBold&&(o|=s.FontStyle.Bold),this.IsItalic&&(o|=s.FontStyle.Italic),this.IsStrikeout&&(o|=s.FontStyle.Strikeout),u._IsDocDftFont(i,l,o,n)?(e=n,e):(o=u._CorrectFntStyle(i,o),e=new r.Font(i,l,o),e)}static _CorrectFntStyle(e,t){return t}CopyFrom(e){if(null!=e&&(!e.isDefault||"_Alone_FntStyle_"==this.propList.XmlEleName)){let t=["FontName","FontSize","FontSizeName","Bold","Italic","Strikeout","Underline"];for(let n=0;n<t.length;n++){let r=t[n],i=e.propList.GetPropValue(r);this.propList.ModifyProperty(r,i,null)}}}static _IsDocDftFont(e,t,n,r){let i=r.Name==e,l=r.SizeInPoints==t,s=r.Style===n;return i&&l&&s}Clear(e=!1){this.isDefault=!1,"_Alone_FntStyle_"==this.propList.XmlEleName?this.propList.Clear():e&&this._Clear_FontAttrs()}get FontSizeName(){let e;if(null!=this.propList){this.propList.GetPropValue("FontSizeName")}let t=this.FontSize;return e=t,e}set FontSizeName(e){a.default.IsNullOrEmpty(e)&&(e=null),this.propList.ModifyProperty("FontSizeName",e,null)}}t.XFontStyle=u,u.AloneFntStyleXmlName="_Alone_FntStyle_",u.DefaultFnt=new r.Font("宋体",12),u.lock_fntfamily=new Object,u.FntFamily_Cache=new i.Dictionary},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XVirtualManualCRStyle=void 0;const r=n(58),i=n(131);class l extends r.XBaseEleStyle{constructor(){super(!1)}get HAlign(){let e=this.propList.GetPropValue("Align");return null==e&&(e=l.Default_HAlign),e}set HAlign(e){this.propList.ModifyProperty("Align",e,"BothEnds")}get HAlign_ENumVal(){let e=this.HAlign;return i.StyleHAlignVals.GetEnumHAlign(e)}set HAlign_ENumVal(e){let t=i.StyleHAlignVals.GetHAlignStrVal(e);this.HAlign=t}}t.XVirtualManualCRStyle=l,l.Default_HAlign="BothEnds"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XEleCtntLine=void 0;const r=n(3),i=n(10),l=n(11),s=n(17),o=n(9),a=n(578),u=n(579),h=n(0),d=n(35),c=n(131),p=n(21),f=n(36);class g extends a.InfCtntLine{constructor(){super(),this.line_asst=null,this.prevLine=null,this.inxInView=0,this.nextLine=null,this.isFirstLineOfParagraph=!1,this.container=null,this._isSplit=!1,this._isDocFirstLine=!1,this.index=0,this.colInx=-1,this.bounds=o.RectangleF.Empty,this.pageView=null,this.relEleParagraph=null,this.maxCharHeight=0,this.extLeading=0,this.childEleList=null,this.hasCtEle=!1,this.wordSpacing=0,this.valignStyle=l.ENumVAlignStyle.NONE,this.arrPalinesInx=null,this.DiagLeft=0,this.realPos=s.PointF.Empty,this.childEleList=new r.List,this.line_asst=new u.XEleCtntLineAssist(this)}get IsSplit(){return this._isSplit}set IsSplit(e){this._isSplit=e}get IsDocFirstLine(){return this._isDocFirstLine}set IsDocFirstLine(e){this._isDocFirstLine=e}get LineAssist(){return this.line_asst}get IndexInView(){return this.inxInView}set IndexInView(e){this.inxInView=e}get Index(){return this.index}set Index(e){this.index=e,this.inxInView=e}get ColInx(){return this.colInx}set ColInx(e){this.colInx=e}get IsFirstLineOfParagraph(){return this.isFirstLineOfParagraph}set IsFirstLineOfParagraph(e){this.isFirstLineOfParagraph=e}get PrevLine(){return this.prevLine}set PrevLine(e){this.prevLine=e}get NextLine(){return this.nextLine}set NextLine(e){this.nextLine=e}get Bounds(){return this.bounds}get X(){return this.bounds.X}get Y(){return this.bounds.Y}get Width(){return this.bounds.Width}get Height(){return this.bounds.Height}get RealLeft(){return this.realPos.X}set RealLeft(e){this.realPos.X=e}get RealTop(){return this.realPos.Y}set RealTop(e){this.realPos.Y=e}get Container(){return this.container}set Container(e){this.container=e}get PageView(){return this.pageView}set PageView(e){this.pageView=e}get RelEleParagraph(){return this.relEleParagraph}set RelEleParagraph(e){this.relEleParagraph=e}get RelEleParagraphStyle(){let e;if(null==this.RelEleParagraph)e=null;else{e=this.RelEleParagraph.EleStyle}return e}get MaxCharHeight(){return this.maxCharHeight}get ExtLeading(){return this.extLeading}get FirstElement(){let e;return e=null==this.childEleList||this.childEleList.Count()<=0?null:this.childEleList.Get(0),e}get LastElement(){if(null==this.childEleList)return null;let e=this.childEleList.Count();return e<=0?null:this.childEleList.Get(e-1)}get ChildEleList(){return this.childEleList}get ElementCnt(){return null==this.childEleList?0:this.childEleList.Count()}get HasCtEle(){return this.hasCtEle}get InnerText(){let e=new p.default;for(let t of this.childEleList)e.append(t.GetInnerText(!1));let t=e.toString();return e.setLengthToZero(),t}Clear(){this.index=0,this.colInx=-1,this.container=null,this.arrPalinesInx=null,this.inxInView=0,this.childEleList.Clear(),this.hasCtEle=!1,this.pageView=null,this.relEleParagraph=null,this.isFirstLineOfParagraph=!1,this.wordSpacing=0,this.maxCharHeight=0,this.extLeading=0,this.valignStyle=l.ENumVAlignStyle.NONE,this.bounds=o.RectangleF.Empty,this.realPos=s.PointF.Empty,this.prevLine=null,this.nextLine=null}ClearArrPalinesInx(){this.arrPalinesInx=null}SetNewNext(e){let t=this.nextLine;this.nextLine=e,null!=t&&(t.prevLine=e),null!=e&&(e.prevLine=this,e.nextLine=t)}GetAlignLeft(e){if(null==this.container)return 0;let t=0,n=this.container.EleStyle.ElePadd.Left,r=this.GetValidWidth_Subfield(300),s=this.RelEleParagraphStyle;if(null!=s)switch(s.HAlign_ENumVal){case l.ENumHAlignStyle.CENTER:t=(r-this.bounds.Width)/2;break;case l.ENumHAlignStyle.RIGHT:t=r-this.bounds.Width;break;default:t=0}return t+=n,t=t<0?0:i.DPITransUtil.TransFloatVal(t,300,e),t}GetBoundsDPI(e){let t=this.bounds.Clone();return i.DPITransUtil.TransRectF(t,300,t,e),t}SetPositionDPI(e,t,n){let r=1;n>0&&300!=n&&(r=300/n),e>=0&&(this.bounds.X=e*r),t>=0&&(this.bounds.Y=t*r)}GetRealPosDPI(e){let t=this.realPos;return t=i.DPITransUtil.TransPointF(t,300,s.PointF.Empty,e),t}GetRealLineIndent(e){let t=this.RelEleParagraphStyle;return null==t?0:t.GetLineIndentDPI(this.IsFirstLineOfParagraph,e)}GetRealParaghSpacingAfter(e){if(!this.IsEndWithManualCR())return 0;let t=this.RelEleParagraphStyle;return null==t?0:t.GetSpacingAfterDPI(e)}GetRealParaghSpacingBefore(e){if(!this.IsFirstLineOfParagraph)return 0;let t=this.RelEleParagraphStyle;if(null==t)return 0;let n=t.GetSpacingBeforeDPI(e),r=this.RelEleParagraph.FindPrevParagh(null);if(null!=r){n-=r.ParaghStyle.GetSpacingAfterDPI(e),n<0&&(n=0)}return n}IndexOfElement(e){return null==e?-1:this.childEleList.IndexOf(e)}GetEleByInx(e){let t;return t=e<0||e>=this.childEleList.Count()?null:this.childEleList.Get(e),t}GetNextEle(e){if(null==e)return null;if(e==this.LastElement)return null;let t=null,n=!1;for(let r of this.childEleList)if(r==e)n=!0;else if(n){t=r;break}return t}GetAllEles(){return null==this.childEleList?null:this.childEleList.ToArray()}GetElesInRange(e,t){let n=this.ElementCnt;if(t<0&&(t=n-1),e<0||t<e||t>=n)return null;let r=this.childEleList.GetRange(e,t-e+1),i=r.ToArray();r.Clear();let l=i;for(let e=0;e<l.length;e++){let t=l[e];null!=t&&(t instanceof h.XTextTable||r.Add(t))}return i=r.ToArray(),r.Clear(),i}AddEle(e){null!=e&&(this.childEleList.Add(e),e.OwnerLine=this,e instanceof h.XBaseContainer&&(this.hasCtEle=!0),this.UpdateExtLeading(e instanceof h.XCharacterEle?e:null))}ReplaceEleAtInx(e,t){e>=0&&e<this.childEleList.Count()&&null!=t&&t.CanBeInline(!1)&&(this.childEleList.Set(e,t),t.OwnerLine=this,t instanceof h.XBaseContainer&&(this.hasCtEle=!0),this.UpdateExtLeading(t instanceof h.XCharacterEle?t:null))}AddEles(e){if(null!=e&&0!=e.length)for(let t=0;t<e.length;t++){let n=e[t];this.AddEle(n)}}IsEndWithManualCR(){return this.LastElement instanceof h.XParagraphFlag}IsEndWithPageBreak(){return this.LastElement instanceof h.XPageBreakLabel}HasPageBreakEle(){let e=this.ElementCnt;if(e<=0)return!1;if(e>=2){if(this.childEleList.Get(e-2)instanceof h.XPageBreakLabel)return!0}if(e>=1){if(this.childEleList.Get(e-1)instanceof h.XPageBreakLabel)return!0}return!1}IsLineAtPosY(e,t){e=i.DPITransUtil.TransFloatVal(e,t,300);let n=this.Bounds;return n.Height=this.line_asst.GetLineFullHeight(300,!0),d.CommDefines.IsNumBetween(e,n.Top,n.Bottom)}GetWordSpacing(e){return i.DPITransUtil.TransFloatVal(this.wordSpacing,300,e)}GetVAlignStyle(e=!1){if(!e&&this.valignStyle!=l.ENumVAlignStyle.NONE)return this.valignStyle;if(this.valignStyle=l.ENumVAlignStyle.NONE,this.childEleList.Count()<=0)return this.valignStyle;for(let e of this.childEleList)if(e instanceof h.XBaseResizableElement){this.valignStyle=e.EleStyle.VAlign_ENumVal;break}return this.valignStyle}ReCalcLineSize(){if(this.maxCharHeight=0,this.bounds.Width=this.bounds.Height=0,this.childEleList.Count()>0)if(h.XDomUtil.IsTableLine(this)){let e=this.line_asst.GetTableLineAttrs(300);null==e||e.IsHidden||(this.bounds.Width=e.SumCellWidth,this.bounds.Height=e.MaxCellHeightWithMinRowSpan)}else{let e=null==this.RelEleParagraphStyle?l.ENumHAlignStyle.NONE:this.RelEleParagraphStyle.HAlign_ENumVal;this.bounds.Width=this.GetRealLineIndent(300);let t=null;for(let n of this.childEleList)this._UpdateLineWidth(n,t,e),this._UpdateLineHeight(n),t=n;340282347e30==this.bounds.Height&&(this.bounds.Height=0)}}_UpdateLineWidth(e,t,n){if(!(e instanceof h.XTextTableCell)){let r=!0;if(e instanceof h.XParagraphFlag&&(null!=t&&t instanceof h.XTextTable||c.StyleHAlignVals.IsUnusualHAlign(n))&&(r=!1),r){let t=e.Width;this.bounds.Width=this.bounds.Width+t}}}_UpdateLineHeight(e){if(!(e instanceof h.XTextTableCell)){let t=e.Height;if(t>this.bounds.Height&&(this.bounds.Height=t,e instanceof h.XTextTable&&(this.bounds.Height=this.bounds.Height)),e instanceof h.XCharacterEle||e instanceof h.XLabelEle){let n=e.GetInnerText(!1);const r=/(^\s+)|(\s+$)|\s+/g;null!=n&&(n=n.replace(r,()=>""));const i=!f.StringUtils.IsNullOrEmpty(n);t>this.maxCharHeight&&i&&(this.maxCharHeight=t)}}}ReCalcElesLocation(e){e||(this.wordSpacing=this._CalcWordSpacing()),this._UpdateElePosXY(e)}_CalcWordSpacing(){if(this.IsEndWithPageBreak())return 0;let e=0,t=this.IsEndWithManualCR(),n=null==this.RelEleParagraphStyle?l.ENumHAlignStyle.NONE:this.RelEleParagraphStyle.HAlign_ENumVal;if(n==l.ENumHAlignStyle.Scattered||n==l.ENumHAlignStyle.BothEnds&&!t){e=this.GetValidWidth_Subfield(300),e-=this.bounds.Width;let n=this.childEleList.Count()-1;t&&n--,n>0&&(e/=n)}return e}GetValidWidth_Subfield(e){let t=this.Container.GetColumnsParam(),n=null!=t&&t.ColsCnt>1,r=this.Container.GetValidWidth(e),i=n?t.GetColWidth(0,e):r;return this.DiagLeft>0&&(i-=this.DiagLeft),i}_UpdateElePosXY(e){let t=this.GetRealParaghSpacingBefore(300),n=this.bounds.Height,r=this.line_asst.GetLineFullHeight(300,!1),s=this.GetVAlignStyle(!1),o=0;for(let a of this.childEleList){const u=a instanceof h.XCharacterEle||a instanceof h.XLabelEle,d=u||a instanceof h.XParagraphFlag;let c=a.Bounds;if(!(a instanceof h.XTextTableCell)){if(!e&&this.wordSpacing>0&&(c.X+=o*this.wordSpacing,o>0&&a instanceof h.XParagraphFlag&&(c.X-=this.wordSpacing)),c.Y<=0){if(c.Height<n){let e=0;switch(s){case l.ENumVAlignStyle.TOP:if(u){const t=this.maxCharHeight-c.Height;t>0&&(e+=.9*t)}break;case l.ENumVAlignStyle.BOTTOM:e=n-c.Height;break;case l.ENumVAlignStyle.MIDDLE:case l.ENumVAlignStyle.NONE:if(e=(n-c.Height)/2,u){const t=(this.maxCharHeight-c.Height)/2;t>0&&(e+=.9*t)}}e>0&&a instanceof h.XTextTable?e-=i.DPITransUtil.TransFloatVal(1,96,300):c.Height<this.maxCharHeight&&d&&(e-=this.extLeading),c.Y+=e}n<r&&(c.Y+=(r-n)/2),c.Y+=t}o++,a.SetPositionDPI(c.X,c.Y,300)}}}UpdateExtLeading(e){if(null==e)return;let t=e.EleStyle.Font;if(null==t)return;h.XCharacterEle.Fnt_Mtc.SetFont(t);let n=h.XCharacterEle.Fnt_Mtc.GetFntExtLeading();n=i.DPITransUtil.TransIntVal(n,96,300),n>this.extLeading&&(this.extLeading=n)}GetLineNestLayerNo(){return this._RecalcPalinesIndex(),null==this.arrPalinesInx?-1:this.arrPalinesInx.length-1}GetLineNestLayerNoStr(){return this._RecalcPalinesIndex(),null==this.arrPalinesInx||0==this.arrPalinesInx.length?"[empty]":".".concat(this.arrPalinesInx.toString())}CmprByLineInx(e){if(null==e)return 1;this.ClearArrPalinesInx(),e.ClearArrPalinesInx(),this._RecalcPalinesIndex(),e._RecalcPalinesIndex();let t=0;for(let n=0;n<this.arrPalinesInx.length&&!(n>=e.arrPalinesInx.length);n++){let r=this.arrPalinesInx[n]-e.arrPalinesInx[n];if(0!=r){t=r>0?1:-1;break}}return t}_RecalcPalinesIndex(){if(null==this.arrPalinesInx){let e=new r.List,t=this;for(;null!=t;)0==e.Count()?e.Add(t.Index):e.Insert(0,t.Index),t=null==t.container?null:t.container.OwnerLine;null!=this.PageView&&(0==e.Count()?e.Add(this.PageView.PageIx):e.Insert(0,this.PageView.PageIx)),this.arrPalinesInx=e.ToArray()}}GetElesIter(){if(null==this.childEleList)return null;let e=this.childEleList.GetEnumerator();return e.Reset(),e}getMaxBaseEleWidth(){if(!(this.ElementCnt>0))return 0;let e=0;const t=this.childEleList.ToArray();for(let n=0;n<this.ElementCnt;n++){const r=t[n];r.Width>e&&(e=r.Width)}return e}}t.XEleCtntLine=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberWrapper=void 0;t.NumberWrapper=class{constructor(e){this._value=e}get Value(){return this._value}set Value(e){this._value=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanWrapper=void 0;t.BooleanWrapper=class{constructor(e){this._value=e}get Value(){return this._value}set Value(e){this._value=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IXCursorEleUndo=void 0;t.IXCursorEleUndo=class{get IsCaretVisible(){return!1}get CursorUndoEle(){return null}set CursorUndoEle(e){}get CursorRedoEle(){return null}set CursorRedoEle(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XElementInx=void 0;t.XElementInx=class{constructor(e){this.eleXID=null,this.childEleIx=-1,this.atLineIx=-1,this.eleObj=null,this.eleXID=e,this.childEleIx=-1}get EleXID(){return this.eleXID}set EleXID(e){this.eleXID=e}get ChildEleIx(){return this.childEleIx}set ChildEleIx(e){this.childEleIx=e}get AtLineIx(){let e;return e=null!=this.eleObj?this.eleObj.OwnerLineInx:this.atLineIx,e}set AtLineIx(e){this.atLineIx=e}GetAtLineIx(){let e;return e=null!=this.eleObj?this.eleObj.OwnerLineInx:this.atLineIx,e}IsValid(){return null!=this.eleXID}get EleObj(){return this.eleObj}set EleObj(e){this.eleObj=e,null!=e&&(this.eleXID=e.XID,this.childEleIx=-1,this.atLineIx=-1)}Equals(e){let t;if(this==e)t=!0;else{let n=e;t=null!=n&&this.eleXID==n.eleXID&&this.childEleIx==n.childEleIx}return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDataSource=void 0;const r=n(3),i=n(87),l=n(14),s=n(8),o=n(4);class a{constructor(){this._MultiSelect=!1,this._ListValueFormatString=null,this._ListValueSeparatorChar=null,this.dataList=new r.List}get EditStyle(){return this.editStyle}set EditStyle(e){this.editStyle=e}get DataList(){return this.dataList}set DataList(e){this.dataList=e,this.dataList=e}get MultiSelect(){return this._MultiSelect}set MultiSelect(e){this._MultiSelect=e}get ListValueFormatString(){return this._ListValueFormatString}set ListValueFormatString(e){this._ListValueFormatString=e}get ListValueSeparatorChar(){return this._ListValueSeparatorChar}set ListValueSeparatorChar(e){this._ListValueSeparatorChar=e}get DataCnt(){return this.dataList.Count()}Clone(){let e=new a;return Object.assign(e,this),e}DeepCopy(){let e=this.Clone();if(null==e)return null;e.DataList=new r.List;for(let t of this.DataList)e.AddData2(t.Key,t.Value,t.GroupNum,t.Index);return e}L_CreateXmlSelItem(e,t){let n=e.createElement("Item"),r=e.createElement("ID");r.textContent=t.Key;let i=e.createElement("Text");null!=t.Value&&(i.textContent=t.Value),n.appendChild(r),n.appendChild(i);let l=e.createElement("Index");if(l.textContent=t.Index.toString(),n.appendChild(l),!o.default.IsNullOrEmpty(t.GroupNum)){let r=e.createElement("GroupNum");r.textContent=t.GroupNum,n.appendChild(r)}return n}Clear(){this.dataList.Clear()}L_CreateSelItemInfo(e,t){let n=l.XmlDomUtil.GetSingleNode(e,"ID"),r=null==n?null:n.textContent;if(o.default.IsNullOrEmpty(r))return;n=l.XmlDomUtil.GetSingleNode(e,"Text");let a=null==n?null:n.textContent;n=l.XmlDomUtil.GetSingleNode(e,"GroupNum");let u=null==n?null:n.textContent;n=l.XmlDomUtil.GetSingleNode(e,"Index");let h=0;h=null==n||-1==s.CNumUtil.TryParseInt(n.textContent,-1)?t:s.CNumUtil.TryParseInt(n.textContent,-1);let d=new i.SelEleItemInfo;return d.Key=r,d.Value=a,d.Index=h,d.GroupNum=u,d}AddData1(e){null!=e&&this.dataList.Add(e)}AddData2(e,t,n,r){if(o.default.IsNullOrEmpty(e))return null;let l=new i.SelEleItemInfo;return l.Key=e,l.Value=t,l.GroupNum=n,l.Index=r,this.dataList.Add(l),l}FromXML(e){if(this.dataList.Clear(),null==e)return;let t=l.XmlDomUtil.GetSingleNode(e,"EditStyle");this.editStyle=null==t?null:t.textContent,t=l.XmlDomUtil.GetSingleNode(e,"MultiSelect"),null!=t&&(this.MultiSelect=s.CNumUtil.TryParseBool(t.textContent,!1)),t=l.XmlDomUtil.GetSingleNode(e,"ListValueFormatString"),this.ListValueFormatString=null==t?null:t.textContent,t=l.XmlDomUtil.GetSingleNode(e,"ListValueSeparatorChar"),this.ListValueSeparatorChar=null==t?null:t.textContent;let n=l.XmlDomUtil.GetSingleNode(e,"ListSource");if(null==n)return;if(t=l.XmlDomUtil.GetSingleNode(n,"Items"),null==t||0==t.children.length)return;let r=t.children;for(let e=0;e<r.length;e++){let t=r[e],n=this.L_CreateSelItemInfo(t,e+1);if(null==n)continue;this.AddData1(n);const i=l.XmlDomUtil.GetSingleNode(t,"Items");if(null!=i&&i.children.length>0){const e=i.children;for(let t=0;t<e.length;t++){const i=e[t],l=this.L_CreateSelItemInfo(i,r.length+t+1);null!=l&&n.ChildEleItems.Add(l)}}}}ToXML(e){let t=e.createElement("FieldSettings"),n=e.createElement("EditStyle");n.textContent=this.editStyle,t.appendChild(n);let r=e.createElement("MultiSelect");r.textContent=s.CNumUtil.ToStringForBool(this.MultiSelect),t.appendChild(r);let i=e.createElement("ListValueFormatString");i.textContent=this.ListValueFormatString,t.appendChild(i);let l=e.createElement("ListValueSeparatorChar");l.textContent=this.ListValueSeparatorChar,t.appendChild(l);let a=e.createElement("ListSource");t.appendChild(a);let u=e.createElement("Items");a.appendChild(u);for(let t of this.dataList)if(!o.default.IsNullOrEmpty(t.Key)&&null!=t.Value){let n=this.L_CreateXmlSelItem(e,t);u.appendChild(n)}return t}}t.XDataSource=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDataBinding=void 0;const r=n(14),i=n(8);class l{constructor(){this._dataSource=null,this._bindingPath=null,this._readOnly=!1}get DataSource(){return this._dataSource}set DataSource(e){this._dataSource=e}get BindingPath(){return this._bindingPath}set BindingPath(e){this._bindingPath=e}get Readonly(){return this._readOnly}set Readonly(e){this._readOnly=e}Clone(){let e=new l;return Object.assign(e,this),e}DeepCopy(){return this.Clone()}ToXML(e){let t=e.createElement("ValueBinding"),n=e.createElement("Readonly");return n.textContent=i.CNumUtil.ToStringForBool(this.Readonly),t.appendChild(n),n=e.createElement("DataSource"),n.textContent=this.DataSource,t.appendChild(n),n=e.createElement("BindingPath"),n.textContent=this.BindingPath,t.appendChild(n),t}FromXML(e){if(null==e)return;let t=r.XmlDomUtil.GetSingleNode(e,"Readonly");null!=t&&(this.Readonly=i.CNumUtil.TryParseBool(t.textContent,!1)),t=r.XmlDomUtil.GetSingleNode(e,"DataSource"),null!=t&&(this.DataSource=t.textContent),t=r.XmlDomUtil.GetSingleNode(e,"BindingPath"),null!=t&&(this.BindingPath=t.textContent)}}t.XDataBinding=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XValueFormater=void 0;const r=n(46),i=n(14),l=n(4);class s{constructor(){this._Style=null,this._format="yyyy-MM-dd"}get Format(){return this._format}set Format(e){this.PreFormat=this._format,this._format=e,l.default.IsNullOrEmpty(this._format)||null!=this.DateFormatChanged&&this.DateFormatChanged(this._format)}get PreFormat(){return this._preFormat}set PreFormat(e){this._preFormat=e}Clone(){let e=new s;return Object.assign(e,this),e}DeepClone(){return this.Clone()}get Style(){return this._Style}set Style(e){this._Style=e}ToXML(e,t=null){let n=e.createElement("DisplayFormat");if(null!=this.Style){let t=e.createElement("Style");t.textContent=r.XValueFormatStyle[this.Style].toString(),n.appendChild(t)}if(null!=this.Format){let t=e.createElement("Format");t.textContent=this.Format,n.appendChild(t)}return n}FromXML(e){if(null==e)return;let t=i.XmlDomUtil.GetSingleNode(e,"Style");if(null!=t){let e=t.textContent;l.default.IsNullOrEmpty(e)||(this.Style=r.XValueFormatStyle[e])}t=i.XmlDomUtil.GetSingleNode(e,"Format"),null!=t&&(this.Format=t.textContent.replace(" "," "),l.default.IsNullOrEmpty(this.Format)&&(this.Format="yyyy-MM-dd"))}}t.XValueFormater=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseChoiceEle=void 0;const r=n(3),i=n(46),l=n(8),s=n(11),o=n(44),a=n(37),u=n(9),h=n(10),d=n(56),c=n(104),p=n(0),f=n(2),g=n(35),m=n(4);class E extends p.XBaseElement{constructor(){super(),this._spaceWidth=4,this._chkErrorType=i.CheckErrorType.None,this._ValueBinding=null,super.FormatBrushEnable=!0,this._rowDrawDic=new r.Dictionary,this.VAlign_Mark=""}get RadioDefalutHeight(){return 10}get _leftPrex(){return 1}get Default_ShowStyle(){return""}get Decode(){return this.attrList.GetPropValue("decode")}set Decode(e){this.attrList.ModifyProperty("decode",e,null)}get DecodeName(){return this.attrList.GetPropValue("decodeName")}set DecodeName(e){this.attrList.ModifyProperty("decodeName",e,null)}get DeValueCode(){return this.attrList.GetPropValue("deValueCode")}set DeValueCode(e){this.attrList.ModifyProperty("deValueCode",e,null)}get CheckedValue(){let e,t=this.propList.GetPropValue("CheckedValue");return e=t?t.toString():"",e}set CheckedValue(e){this.propList.ModifyProperty("CheckedValue",e,null)}get Name(){return this.propList.GetPropValue("Name")}set Name(e){this.propList.ModifyProperty("Name",e,null)}get RuntimeVisible(){return this.propList.GetPropValue("RuntimeVisible")}set RuntimeVisible(e){this.propList.ModifyProperty("RuntimeVisible",e,null)}get GroupName(){return this.propList.GetPropValue("GroupName")}set GroupName(e){this.propList.ModifyProperty("GroupName",e,null)}set Gender(e){this.propList.ModifyProperty("Gender",e,null)}get MaxAge(){return this.propList.GetPropValue("MaxAge")}set MaxAge(e){this.propList.ModifyProperty("MaxAge",e,null)}get MinAge(){return this.propList.GetPropValue("MinAge")}set MinAge(e){this.propList.ModifyProperty("MinAge",e,null)}get Checked(){let e=this.propList.GetPropValue("Checked");return l.CNumUtil.TryParseBool(e,!1)}set Checked(e){this.Checked!=e&&(this.OwnerDocPanel.IsChanged=!0,this.propList.ModifyProperty("Checked",e,!1),o.TextDocApiUtil.M_InnerEleExcScrExp(this,this.Document,null),this.ResetBrotherEleCheckStatus(),this.NotifyLayoutChanged(!0,!1))}get ExpessionArray(){return[this.Text_Expression]}set ExpessionArray(e){null!=e&&null!=e[0]&&(this.Text_Expression=e[0])}get Text_Expression(){return this.attrList.GetPropValue("DefaultEventExpression")}set Text_Expression(e){this.attrList.ModifyProperty("DefaultEventExpression",e,null)}get IsShowRightText(){let e=this.propList.GetPropValue("IsShowRightText");return l.CNumUtil.TryParseBool(e,!0)}set IsShowRightText(e){this.propList.ModifyProperty("IsShowRightText",e,!0)}get QuoteSource(){let e=this.propList.GetPropValue("QuoteSource");return l.CNumUtil.TryParseBool(e,!1)}set QuoteSource(e){this.propList.ModifyProperty("QuoteSource",e,!1)}get QuoteTarget(){let e=this.propList.GetPropValue("QuoteTarget");return l.CNumUtil.TryParseBool(e,!1)}set QuoteTarget(e){this.propList.ModifyProperty("QuoteTarget",e,!1)}get OnlyPrintCheckedItem(){let e=this.propList.GetPropValue("OnlyPrintCheckedItem");return l.CNumUtil.TryParseBool(e,!1)}set OnlyPrintCheckedItem(e){this.propList.ModifyProperty("OnlyPrintCheckedItem",e,!1)}get TextShowRight(){let e=this.propList.GetPropValue("TextShowRight");return l.CNumUtil.TryParseBool(e,!0)}set TextShowRight(e){this.propList.ModifyProperty("TextShowRight",e,!0)}get Grp_StrongShow(){let e=this.propList.GetPropValue("Grp_StrongShow");return l.CNumUtil.TryParseBool(e,!1)}set Grp_StrongShow(e){this.propList.ModifyProperty("Grp_StrongShow",e,!1)}get ControlStyle(){return this.propList.GetPropValue("ControlStyle")}set ControlStyle(e){this.propList.ModifyProperty("ControlStyle",e,null)}get Caption(){return this.propList.GetPropValue("Caption")}set Caption(e){this.propList.ModifyProperty("Caption",e,null)}get ValueBinding(){return this._ValueBinding}set ValueBinding(e){this._ValueBinding=e}get BaseChoiceShowStyle(){let e,t=this.propList.GetPropValue("Base_ChoiceShowStyle");return e=m.default.IsNullOrEmpty(t)?this.Default_ShowStyle:t,e}set BaseChoiceShowStyle(e){this.propList.ModifyProperty("Base_ChoiceShowStyle",e,this.Default_ShowStyle)}get IsMustCheck(){let e=this.propList.GetPropValue("IsMustCheck");return l.CNumUtil.TryParseBool(e,!1)}set IsMustCheck(e){this.propList.ModifyProperty("IsMustCheck",e,!1)}get VAlign_Mark(){let e=this.propList.GetPropValue("VAlign_Mark");return m.default.IsNullOrEmpty(e)&&(e="Center"),e}set VAlign_Mark(e){this.propList.ModifyProperty("VAlign_Mark",e,"Center")}get EleToolTip(){return this.propList.GetPropValue("EleToolTip")}set EleToolTip(e){super.ToolTip=e,this.propList.ModifyProperty("EleToolTip",e,"")}get SourceName(){return this.propList.GetPropValue("SourceName")}set SourceName(e){super.SourceName=e,this.propList.ModifyProperty("SourceName",e,"")}get PropertyName(){return this.propList.GetPropValue("PropertyName")}set PropertyName(e){super.PropertyName=e,this.propList.ModifyProperty("PropertyName",e,"")}get Id(){return super.GrpID}set Id(e){super.GrpID=e}get CanReflect(){return!0}get IsGroupEle(){return!0}get ShowName(){return this.Name+"_"+this.Caption}get ScriptInnerValue(){let e;return e=this.Checked?this.CheckedValue:"0",e}get ExpTypeArray(){return["SetValue","SetCheck","SetVisible"]}GetType(){return"IScriptMsg"}get IsUseXId(){return!0}get CheckError_Type(){return this._chkErrorType}set CheckError_Type(e){this._chkErrorType=e}get ChkFailTipArray(){return[this.Name,this.Caption,super.GrpID]}get DrawTxtFormat(){return d.StringFormat.GenericTypographic}get EleCursorAllowSide(){return f.ENumEleCursorSide.Left}UpdateInnerText(e,t,n){let r=this.CheckedValue;if(this.Checked=!1,this instanceof p.XRadioBoxEle&&r==e&&(this.Checked=!0),this instanceof p.XCheckBoxEle&&e instanceof Array)for(var i=0;i<e.length;i++)r==e[i]&&(this.Checked=!0)}UpdateEleAttrFgHide(e,t){super.Attr_FgHide!=e&&(super.Attr_FgHide=e,o.TextDocApiUtil.M_InnerEleExcScrExp(this,this.Document,t))}StartValueValidate(e,t=null){let n;if(!this.IsMustCheck)return n=!0,n;let r=o.TextDocApiUtil.GetElesByEleGrpId(this.Document,super.GrpID,[this.EleTypeName]);if(null==r||0==r.Count())return n=!0,n;let l=!1;for(let e of r){let t=e instanceof E?e:null;if(null!=t&&t.Checked){l=!0;break}}if(!l)for(let e of r){let t=e instanceof E?e:null;null!=t&&(t.CheckError_Type=i.CheckErrorType.MustChoose)}return n=l,n}get IsPrint(){let e=this.propList.GetPropValue("IsPrint");return l.CNumUtil.TryParseBool(e,!0)}set IsPrint(e){this.propList.ModifyProperty("IsPrint",e,!0)}CanBeInline(e=!1){if(!e)return!0;if(null!=this&&!1===this.IsPrint)return!1;let t=p.XDomUtil.GetParentXInput(this);return(null==t||!1!==t.IsPrint)&&(0!=this.Checked||!this.OnlyPrintCheckedItem)}ReCalcBaseSize(){if(null!=this.OwnerLine&&!this.IsLayoutValid){const e=this.EleStyle;if(null!=e){const t=e.Font;if(null!=t){const e=h.DPITransUtil.TransFloatVal(t.SizeInPoints,72,96);let n=this.GetChoiceEleValidWidth(!1);n=Math.floor(1e4*n)/1e4;const r=n-this.RadioDefalutHeight-this._spaceWidth-this._leftPrex;let i=0;if(this.IsShowRightText&&(i=g.CommDefines.MeasureText1(this.Caption,t,96).Width),i<=r){let t=i+this.RadioDefalutHeight+this._spaceWidth+this._leftPrex;this.SetSizeDPI(t,e,96)}else{let t=Math.ceil(i/r),l=e,s=!1;const o=this.GetLineSpaceTimes(s),a=o[0];if(s=o[1],s){l=e+h.DPITransUtil.TransFloatVal(a,72,96)}else l=e*a,this.SetSizeDPI(n,l,96);l*=t,this.SetSizeDPI(n,l,96)}this.BulidRowDrawDic(),this.IsLayoutValid=!0}}}}ReCalcBaseSizeBeforeAddToLine(e,t){let n=null;if(!this.IsLayoutValid){const r=this.EleStyle;if(null!=r){const i=r.Font;if(null!=i){const r=h.DPITransUtil.TransFloatVal(i.SizeInPoints,72,96);let l=0;this.IsShowRightText&&(l=g.CommDefines.MeasureText1(this.Caption,i,96).Width);let s=l+this.RadioDefalutHeight+this._spaceWidth+this._leftPrex;if(n=s,null==e)this.SetSizeDPI(s,r,96);else{let n=h.DPITransUtil.TransFloatVal(e-t,300,96);e=h.DPITransUtil.TransFloatVal(e,300,96),n=Math.floor(1e4*n)/1e4;const i=n-this.RadioDefalutHeight-this._spaceWidth-this._leftPrex;if(e<s){let e=Math.ceil(l/i),t=r,s=!1;const o=this.GetLineSpaceTimes(s),a=o[0];if(s=o[1],s){t=r+h.DPITransUtil.TransFloatVal(a,72,96)}else t=r*a,this.SetSizeDPI(n,t,96);t*=e,this.SetSizeDPI(n,t,96)}else this.SetSizeDPI(s,r,96)}this.BulidRowDrawDic(),this.IsLayoutValid=!0}}}return n}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r),super.GrpID=e.GrpID}GetInnerText(e,t=!1){let n;return n=e?this.Caption:super.EleStyle.DeleterIndex>=0||null==this.Caption?"":this.Caption,t&&!this.Checked?"":n}SetAttribute(e,t){this.attrList.ModifyProperty(e,t,null)}SetProp(e,t){this.propList.ModifyProperty(e,t,null)}GetTextRect(e){let t;if(this.IsShowRightText){let n=super.GetBoundsDPI(96);n=new u.RectangleF(n.X+this.RadioDefalutHeight+this._spaceWidth+this._leftPrex,n.Y+1,n.Width-this.RadioDefalutHeight-this._spaceWidth-this._leftPrex,n.Height),this.TextShowRight||(n.X-=this.RadioDefalutHeight+this._spaceWidth+this._leftPrex),h.DPITransUtil.TransRectF(n,96,n,e),t=n}else t=u.RectangleF.Empty;return t}GetTitleRect(e){let t=this.VAlign_Mark;if(m.default.IsNullOrEmpty(t)){let e=this.GetVAlgin();t=c.StyleVAlignVals.GetVAlignStrVal(e)}let n=super.GetBoundsDPI(96),r=0,i=t;if(null!=i){let e=super.EleStyle.Font.Height;e<=0&&(e=h.DPITransUtil.TransFloatVal(super.EleStyle.Font.SizeInPoints,72,96)),"Top"!=i?"Center"!=i?"Bottom"==i&&n.Height>this.RadioDefalutHeight&&(r=n.Height-e+(e-this.RadioDefalutHeight)/2):n.Height>this.RadioDefalutHeight&&(r=(n.Height-this.RadioDefalutHeight)/2):r=(e-this.RadioDefalutHeight)/2}return n=new u.RectangleF(n.X+this._leftPrex,n.Y+r,this.RadioDefalutHeight,this.RadioDefalutHeight),this.TextShowRight||(n.X+=this.GetTextRect(96).Width+this._spaceWidth/2),h.DPITransUtil.TransRectF(n,96,n,e),n}BulidRowDrawDic(){if(this._rowDrawDic.Clear(),!m.default.IsNullOrEmpty(this.Caption)){let e=0,t="",n=1,r=this.GetTextRect(96);for(let i=0;i<this.Caption.length;i++){let l=this.Caption[i],s=g.CommDefines.MeasureText(l.toString(),super.EleStyle.Font,96).Width;e+=s,Math.floor(e)>Math.floor(r.Width)?(this._rowDrawDic.Add(n,t),t=l.toString(),n++,e=s):t+=l}e>a.TextDocApiConst.FloatComparePrecision&&this._rowDrawDic.Add(n,t)}}ResetBrotherEleCheckStatus(){if(this.IsMustCheck&&this.Checked){let e=o.TextDocApiUtil.GetElesByEleGrpId(this.Document,super.GrpID,[this.EleTypeName]);if(null!=e&&0!=e.Count())for(let t of e){let e=t instanceof E?t:null;null!=e&&e.CheckError_Type!=i.CheckErrorType.None&&(e.CheckError_Type=i.CheckErrorType.None)}}}GetChoiceEleValidWidth(e){let t;return t=null==this.OwnerLine?-1:p.XDomUtil.GetParentValidWidth(this,e),t}GetLineSpaceTimes(e){if(null==this.OwnerLine||null==this.OwnerLine.RelEleParagraphStyle)return[1,e];const t=this.OwnerLine.RelEleParagraphStyle.LineSpacingStyle;return null==t||"SpaceSingle"==t?[1,e]:"Space1pt5"==t?[1.5,e]:"SpaceDouble"==t?[2,e]:"SpaceSpecify"==t?(e=!0,[this.OwnerLine.RelEleParagraphStyle.LineSpacing,!0]):"SpaceMultiple"==t?[this.OwnerLine.RelEleParagraphStyle.LineSpacing,e]:void 0}GetVAlgin(){let e;return e=null==super.OwnerLine?s.ENumVAlignStyle.BOTTOM:super.OwnerLine.RelEleParagraphStyle.VAlign_ENumVal,e}GetRowDrawDic(){return this._rowDrawDic}FromXML(e){super.FromXML(e)}}t.XBaseChoiceEle=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XChoiceGroupEle=void 0;const r=n(3);class i extends r.List{get ElementInfo(){return this._elementInfo}set ElementInfo(e){this._elementInfo=e}get InputType(){return this._InputType}set InputType(e){this._InputType=e}}t.XChoiceGroupEle=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InsertBtnInfo=void 0;t.InsertBtnInfo=class{constructor(){this.grpId=null,this.type=null,this._text=null,this._deletable=!0,this._eventType=null,this._icon=null,this._iconWidth=24,this._iconHeight=24,this._toolTip=null,this._FirstExcScriptName=null,this._SecondExcScriptName=null,this._BorderStyle=null,this._BorderColor=null,this._BackColor=null,this._codeEditInfo=null}get GrpId(){return this.grpId}set GrpId(e){this.grpId=e}get Type(){return this.type}set Type(e){this.type=e}get Text(){return this._text}set Text(e){this._text=e}get Deletable(){return this._deletable}set Deletable(e){this._deletable=e}get EventType(){return this._eventType}set EventType(e){this._eventType=e}get Icon(){return this._icon}set Icon(e){this._icon=e}get IconWidth(){return this._iconWidth}set IconWidth(e){this._iconWidth=e}get IconHeight(){return this._iconHeight}set IconHeight(e){this._iconHeight=e}get ToolTip(){return this._toolTip}set ToolTip(e){this._toolTip=e}get FirstExcScriptName(){return this._FirstExcScriptName}set FirstExcScriptName(e){this._FirstExcScriptName=e}get SecondExcScriptName(){return this._SecondExcScriptName}set SecondExcScriptName(e){this._SecondExcScriptName=e}get BorderStyle(){return this._BorderStyle}set BorderStyle(e){this._BorderStyle=e}get BorderColor(){return this._BorderColor}set BorderColor(e){this._BorderColor=e}get BackColor(){return this._BackColor}set BackColor(e){this._BackColor=e}get CodeEditInfo(){return this._codeEditInfo}set CodeEditInfo(e){this._codeEditInfo=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InsertMedExpressionItemInfo=void 0;const r=n(169);t.InsertMedExpressionItemInfo=class{constructor(){this.ItemInfo=new r.MedExpressionItemInfo,this.VAlign="Center"}get No(){return this._No}set No(e){this._No=e}get Type(){return this._Type}set Type(e){this._Type=e}get Gender(){return this._gender}get Name_de(){return this.name_de}set Name_de(e){this.name_de=e}get ValueCode_de(){return this.valuecode_de}get conceptDomainCode(){return this._conceptDomainCode}set conceptDomainCode(e){this._conceptDomainCode=e}set ValueCode_de(e){this.valuecode_de=e}set Gender(e){this._gender=e}get MaxAge(){return this._maxAge}set MaxAge(e){this._maxAge=e}get MinAge(){return this._minAge}set MinAge(e){this._minAge=e}get Name(){return this._Name}set Name(e){this._Name=e}get VAlign(){return this._VAlign}set VAlign(e){this._VAlign=e}get ItemInfo(){return this._ItemInfo}set ItemInfo(e){this._ItemInfo=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stack=void 0;t.Stack=class{constructor(){this.arr=[]}get Count(){return this.arr.length}Clear(){this.arr=[]}Contains(e){return this.arr.indexOf(e)>=0}Peek(){return this.arr.length<=0?null:this.arr[0]}Pop(){return this.arr.length<=0?null:this.arr.pop()}Push(e){this.arr.push(e)}ToArray(){return[].concat(this.arr)}ToString(){let e="";for(let t of this.arr)e+=t+"";return e}}},function(e,t,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var l=typeof r;if("string"===l||"number"===l)e.push(r);else if(Array.isArray(r)){if(r.length){var s=i.apply(null,r);s&&e.push(s)}}else if("object"===l)if(r.toString===Object.prototype.toString)for(var o in r)n.call(r,o)&&r[o]&&e.push(o);else e.push(r.toString())}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XRadioBoxEle=void 0;const r=n(80),i=n(0);class l extends i.XBaseChoiceEle{get EleTypeName(){return"XTextRadioBox"}get RadioDefalutHeight(){return 10}get Default_ShowStyle(){return"RadioBox"}get ElementInfo(){return r.XInputUtil.GetInstance().BulidEleInfo_InputGroup(this)}}t.XRadioBoxEle=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListSernoStyleVals=t.ENumSerType=void 0;const r=n(8),i=n(328);var l;!function(e){e[e.None=0]="None",e[e.Arabic=1]="Arabic",e[e.Roman=2]="Roman",e[e.ABC=3]="ABC",e[e.Chinese=4]="Chinese",e[e.ChsGanZhiOR=5]="ChsGanZhiOR",e[e.ChsGanZhiAND=6]="ChsGanZhiAND",e[e.Other=20]="Other"}(l=t.ENumSerType||(t.ENumSerType={}));class s{static GetShowVal(e){let t=null;switch(e){case"None":t="无";break;case"Arabic":t="1, 2, 3";break;case"LowLetter":t="a, b, c";break;case"UpLetter":t="A, B, C";break;case"LowRoman":t="i, ii, iii";break;case"UpRoman":t="I, II, III";break;case"SimpleChinese":t="一, 二, 三";break;case"TraditionalChinese":t="壹, 贰, 叁"}return t}static BuildSernoStr(e,t){let n;if(e<0)n=r.CNumUtil.ToStringForNum(e);else{let r=l.None,s=!1;switch(t){case"Arabic":r=l.Arabic,s=!1;break;case"LowLetter":case"UpLetter":r=l.ABC,s="UpLetter"==t;break;case"LowRoman":case"UpRoman":r=l.Roman,s="UpRoman"==t;break;case"SimpleChinese":case"TraditionalChinese":r=l.Chinese,s="TraditionalChinese"==t}n=i.SerCodeUtil.GetSerCode(e,r,s)}return n}}t.ListSernoStyleVals=s,s.None="None",s.Arabic="Arabic",s.LowLetter="LowLetter",s.UpLetter="UpLetter",s.LowRoman="LowRoman",s.UpRoman="UpRoman",s.SimpleChinese="SimpleChinese",s.TraditionalChinese="TraditionalChinese"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCodeEle=void 0;const r=n(8),i=n(25),l=n(667),s=n(167),o=n(44),a=n(133),u=n(0),h=n(43),d=n(10),c=n(2),p=n(4);class f extends u.XBaseResizableElement{constructor(){super(),this._labelTextShowSizeF=i.SizeF.Empty,this._codeInfo=null,this.DataImageBase64="data:image/png;base64",this.CodeInfo=new l.CodeInfo}get EleTypeName(){return"XBarcodeField"}get PageNumStyle(){return this.propList.GetPropValue("ListSernoStyle")}set PageNumStyle(e){this.propList.ModifyProperty("ListSernoStyle",e,null)}get LabelTextShowSizeF(){return this._labelTextShowSizeF}get EleCursorAllowSide(){return c.ENumEleCursorSide.Left}get CodeInfo(){return this._codeInfo}set CodeInfo(e){this._codeInfo=e}get DrawImage(){return this._image}get BarcodeInfo(){return this.BulidBarcodeInfo()}get Name(){return this.propList.GetPropValue("Name")}set Name(e){this.propList.ModifyProperty("Name",e,null)}set EnableValueValidate(e){this.propList.ModifyProperty("EnableValueValidate",e,null)}get EnableValueValidate(){return this.propList.GetPropValue("EnableValueValidate")}set BarcodeStyle(e){this.propList.ModifyProperty("BarcodeStyle",e,null)}get BarcodeStyle(){return this.propList.GetPropValue("BarcodeStyle")}get ShowText(){let e=this.propList.GetPropValue("ShowText");return r.CNumUtil.TryParseBool(e,!1)}set ShowText(e){this.propList.ModifyProperty("ShowText",e,!1)}get MinBarWidth(){let e=this.propList.GetPropValue("MinBarWidth");return r.CNumUtil.TryParseFloat(e,7)}set MinBarWidth(e){this.propList.ModifyProperty("MinBarWidth",e,!1)}get MinBarHeight(){let e=this.propList.GetPropValue("MinBarHeight");return r.CNumUtil.TryParseFloat(e,74)}set MinBarHeight(e){this.propList.ModifyProperty("MinBarHeight",e,!1)}get IsQrCode(){let e=this.propList.GetPropValue("IsQrCode");return r.CNumUtil.TryParseBool(e,!1)}set IsQrCode(e){this.propList.ModifyProperty("IsQrCode",e,!1)}set TextAlignment(e){this.propList.ModifyProperty("TextAlignment",e,null)}get TextAlignment(){return this.propList.GetPropValue("TextAlignment")}set Type(e){this.propList.ModifyProperty("Type",e,null)}get Type(){return this.propList.GetPropValue("Type")}set DataEleName(e){this.propList.ModifyProperty("DataEleName",e,null)}get DataEleName(){return this.propList.GetPropValue("DataEleName")}set DataEleCode(e){this.propList.ModifyProperty("DataEleCode",e,null)}get DataEleCode(){return this.propList.GetPropValue("DataEleCode")}set SourceName(e){this.propList.ModifyProperty("SourceName",e,null)}get SourceName(){return this.propList.GetPropValue("SourceName")}set Expression(e){this.propList.ModifyProperty("Expression",e,null)}get Expression(){return this.propList.GetPropValue("Expression")}set PropName(e){this.propList.ModifyProperty("PropName",e,null)}get PropName(){return this.propList.GetPropValue("PropName")}set LabelText(e){this.propList.ModifyProperty("LabelText",e,null)}get LabelText(){return this.propList.GetPropValue("LabelText")}set LabelShowPosition(e){this.propList.ModifyProperty("LabelShowPosition",e,null)}get LabelShowPosition(){let e=this.propList.GetPropValue("LabelShowPosition"),t=e;return p.default.IsNullOrEmpty(t)&&(t="Bottom"),e}get IsShowLabelText(){let e=this.propList.GetPropValue("IsShowLabelText");return r.CNumUtil.TryParseBool(e,!1)}set IsShowLabelText(e){this.propList.ModifyProperty("IsShowLabelText",e,!1)}get IsAllowDrag(){let e=this.propList.GetPropValue("IsAllowDrag");return r.CNumUtil.TryParseBool(e,!1)}set IsAllowDrag(e){this.propList.ModifyProperty("IsAllowDrag",e,!1)}get IsGroupEle(){return!1}get ShowName(){return this.Name}get CanReflect(){return!0}get ExpessionArray(){return[this.Expression]}set ExpessionArray(e){null!=e&&null!=e[0]&&(this.Expression=e[0])}get ExpTypeArray(){return["SetValue"]}GetType(){return"IScriptMsg"}get ScriptInnerValue(){return o.TextDocApiUtil.GetInnerValue(this,!1,!0)}get IsUseXId(){return!0}get Id(){return super.GrpID}UpdateInnerText(e,t=null,n){this.CodeInfo.CodeValue=e,this.InitSizeByXml()}UpdateEleAttrFgHide(e,t){super.Attr_FgHide!=e&&(super.Attr_FgHide=e,o.TextDocApiUtil.M_InnerEleExcScrExp(this,this.Document,t))}get GetDataImageBase64(){return this.DataImageBase64}set SetDataImageBase64(e){this.DataImageBase64=e}SetImageByValue(e){let t=a.XCodeUtil.GetInstance();t.InitCodeUtil(),this._image=t.BuildQRcode(e)}InitSizeByXml(){let e=a.XCodeUtil.GetInstance();if(e.InitCodeUtil(),this.IsQrCode)this._image=e.BuildQRcode(this.CodeInfo.CodeValue),this.SetDataImageBase64=e.BuildQRcodeBase64();else{e.SetBarCodeTextVisible(this.ShowText);let t=e.GetBarCodeTypeByStr(this.BarcodeStyle),n=e.BuildBarcode(t,this.CodeInfo.CodeValue,this.MinBarWidth,this.MinBarHeight,super.EleStyle.ForeColor,super.EleStyle.BackgroundColor,this.ShowText);null!=n&&(this._image=n.Image)}this.InitDrawSize()}InitDrawSize(){let e;if(this.IsQrCode){let t=a.XCodeUtil.GetInstance().GetQrCodeTypeByStr(this.BarcodeStyle);e=a.XCodeUtil.GetInstance().GetQrCodeSizeF(t,this.CodeInfo.CodeValue)}else e=a.XCodeUtil.GetInstance().GetBarCodeDefaultShowSize(this.MinBarWidth,this.MinBarHeight);let t=e,n=super.EleStyle.Font;if(null==n)return this.SetSizeDPI(t.Width,t.Height,96),void(this.IsLayoutValid=!0);let r=t;if(this.IsShowLabelText){let e=h.GrapUtil.MeasureStrSize(null,n,1e3,this.LabelText);e.Height=d.DPITransUtil.TransFloatVal(n.SizeInPoints,72,96),this._labelTextShowSizeF=e;let t=this.LabelShowPosition;null!=t&&("Left"!=t&&"Right"!=t?"Top"!=t&&"Bottom"!=t||(r=new i.SizeF(r.Width,r.Height+e.Height)):r=new i.SizeF(r.Width+e.Width,r.Height)),r=new i.SizeF(r.Width>e.Width?r.Width:e.Width,r.Height)}this.SetSizeDPI(r.Width,r.Height,96),this.IsLayoutValid=!0}BulidBarcodeInfo(){let e=new s.BarcodeInfo;return e.Type=this.Type,e.CodeChoiceStyle=this.IsQrCode?s.CodeType.QRcode:s.CodeType.Barcode,this.IsQrCode||(e.BarcodeLineWidth=this.MinBarWidth,e.BarcodeLineHeight=this.MinBarHeight,e.IsShowText=this.ShowText,e.TextAlignStyleStr=this.TextAlignment),e.CodeStyleStr=this.BarcodeStyle,e.No=this.Id,e.Name=this.Name,e.DataEleName=this.DataEleName,e.DateEleCode=this.DataEleCode,e.SourceName=this.SourceName,e.PropName=this.PropName,e.Content=this.CodeInfo.CodeValue,e.LabelText=this.LabelText,e.IsShowLabelText=this.IsShowLabelText,e.LabelShowPosition=this.LabelShowPosition,e.CptID=this.CptID,e.Attr_FgHide=this.Attr_FgHide,e.ExtendAttr1=this.ExtendAttr1,e.IsAllowDrag=this.IsAllowDrag,e.GetEditBarcodeImage=this.DrawImage.Clone(),e}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r),e instanceof f&&this.InitCodeEle(e.BarcodeInfo)}GetInnerText(e){let t;return t=this.IsQrCode?"二维码":"条形码",t}ReCalcBaseSize(){super.ReCalcBaseSize(),this.IsLayoutValid||(this.InitDrawSize(),this.IsLayoutValid=!0)}InitCodeEle(e,t=!1){this.CodeInfo.CodeValue=e.Content,this._image=e.GetEditBarcodeImage,t||(this.Type=e.Type,this.IsQrCode=e.CodeChoiceStyle==s.CodeType.QRcode,this.IsQrCode||(this.MinBarWidth=e.BarcodeLineWidth,this.MinBarHeight=e.BarcodeLineHeight,this.ShowText=e.IsShowText,this.TextAlignment=e.TextAlignStyleStr),this.BarcodeStyle=e.CodeStyleStr,super.GrpID=e.No,this.Name=e.Name,this.DataEleName=e.DataEleName,this.DataEleCode=e.DateEleCode,this.SourceName=e.SourceName,this.PropName=e.PropName,this.LabelText=e.LabelText,this.IsShowLabelText=e.IsShowLabelText,this.LabelShowPosition=e.LabelShowPosition,this.CptID=e.CptID,this.Attr_FgHide=e.Attr_FgHide,this.ExtendAttr1=e.ExtendAttr1,this.IsAllowDrag=e.IsAllowDrag,this.InitDrawSize())}FromXML(e){super.FromXML(e),this.CodeInfo.FromXML(e),this.InitSizeByXml()}ToXML(e){let t=super.ToXML(e);if(null==t)return null;let n=this.CodeInfo.ToXML(e);return t.appendChild(n),t}}t.XCodeEle=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MedExpressionFactory=void 0;const r=n(3),i=n(25),l=n(4),s=n(671),o=n(672),a=n(673),u=n(674);class h{constructor(){}static GetInstance(){return null==h._instance&&(h._instance=new h),h._instance}GetMensesExpression(e){let t;if(l.default.IsNullOrEmpty(e))return t=null,t;let n=e.split(",");return n.length<6?(t=null,t):(t=new o.MedicineOneToFourBasicExpressionInfo,t.FirstMenstruationAge=n[0],t.MenstruationCycle=n[1],t.Cycle=n[2],t.EndMenstruationAge=n[3],t.IsShowFirstMenstruationAgeDate=n[4],t.IsShowEndMenstruationAgeDate=n[5],t)}GetMensesExpression2(e){let t;if(l.default.IsNullOrEmpty(e))return t=null,t;let n=e.split(",");return n.length<4?(t=null,t):(t=new o.MedicineOneToFourBasicExpressionInfo,t.FirstMenstruationAge=n[0],t.MenstruationCycle=n[1],t.EndMenstruationAge=n[2],t.Cycle=n[3],t)}GetMensesExpression3(e){let t;if(l.default.IsNullOrEmpty(e))return t=null,t;let n=e.split(",");return n.length<4?(t=null,t):(t=new o.MedicineOneToFourBasicExpressionInfo,t.FirstMenstruationAge=n[0],t.MenstruationCycle=n[1],t.Cycle=n[2],t.EndMenstruationAge=n[3],t)}GetMensesExpression4(e){let t;if(l.default.IsNullOrEmpty(e))return t=null,t;let n=e.split(",");return n.length<3?(t=null,t):(t=new o.MedicineOneToFourBasicExpressionInfo,t.FirstMenstruationAge=n[0],t.MenstruationCycle=n[1],t.Cycle=n[2],t)}GetDefaultSizeByMedStyle(e){l.default.IsNullOrEmpty(e)&&(e="FourValues");let t,n=this.GetMedExpressionDic();return t=n.ContainsKey(e)?n.Get(e):i.SizeF.Empty,t}GetMensesStr(e,t){let n;return n="FourValues1"==t?l.default.Concat([e.FirstMenstruationAge,",",e.MenstruationCycle,",",e.EndMenstruationAge,",",e.Cycle]):"ThreeValues"==t?l.default.Concat([e.FirstMenstruationAge,",",e.MenstruationCycle,",",e.Cycle]):"FourValues2"==t?l.default.Concat([e.FirstMenstruationAge,",",e.MenstruationCycle,",",e.Cycle,",",e.EndMenstruationAge]):l.default.Concat([e.FirstMenstruationAge,",",e.MenstruationCycle,",",e.Cycle,",",e.EndMenstruationAge,",",e.IsShowFirstMenstruationAgeDate,",",e.IsShowEndMenstruationAgeDate]),n}GetMedExpressionDic(){return null==this._medExpressionSizeDic&&(this._medExpressionSizeDic=new r.Dictionary,this._medExpressionSizeDic.Add("FourValues",new i.SizeF(184,56)),this._medExpressionSizeDic.Add("FourValues1",new i.SizeF(156,60)),this._medExpressionSizeDic.Add("FourValues2",new i.SizeF(200,84)),this._medExpressionSizeDic.Add("ThreeValues",new i.SizeF(128,60)),this._medExpressionSizeDic.Add("Pupil",new i.SizeF(166,70)),this._medExpressionSizeDic.Add("FetalHeart",new i.SizeF(124,70)),this._medExpressionSizeDic.Add("LightPositioning",new i.SizeF(166,70)),this._medExpressionSizeDic.Add("PainIndex",new i.SizeF(516,50)),this._medExpressionSizeDic.Add("PermanentTeethBitmap",new i.SizeF(160,50)),this._medExpressionSizeDic.Add("DeciduousTeech",new i.SizeF(300,50))),this._medExpressionSizeDic}GetLightLocationInfo(e){let t;if(l.default.IsNullOrEmpty(e))return t=null,t;let n=e.split(",");return n.length<9?t=null:(t=new s.LightOrientationPhtotoInfo,t.PupilPhtotValueFirst=n[0],t.PupilPhtotValueSecond=n[1],t.PupilPhtotValueThird=n[2],t.PupilPhtotValueFourth=n[3],t.PupilPhtotValueFifth=n[4],t.PupilPhtotValueSixth=n[5],t.PupilPhtotValueSeventh=n[6],t.PupilPhtotValueEighth=n[7],t.PupilPhtotValueNinth=n[8]),t}GetFetalHeartInfo(e){let t;if(l.default.IsNullOrEmpty(e))t=null;else{let n=e.split(",");n.length<6?t=null:(t=new a.FetalHeartPhotoInfo,t.PupilPhtotValueFirst=n[0],t.PupilPhtotValueSecond=n[1],t.PupilPhtotValueThird=n[2],t.PupilPhtotValueFourth=n[3],t.PupilPhtotValueFifth=n[4],t.PupilPhtotValueSixth=n[5])}return t}GetPupilPhotoInfo(e){let t;if(l.default.IsNullOrEmpty(e))t=null;else{let n=e.split(",");n.length<7?t=null:(t=new u.PupilPhotoInfo,t.PupilPhtotValueFirst=n[0],t.PupilPhtotValueSecond=n[1],t.PupilPhtotValueThird=n[2],t.PupilPhtotValueFourth=n[3],t.PupilPhtotValueFifth=n[4],t.PupilPhtotValueSixth=n[5],t.PupilPhtotValueSeventh=n[6])}return t}}t.MedExpressionFactory=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XShapeEle=void 0;const r=n(37),i=n(10),l=n(43),s=n(8),o=n(16),a=n(0),u=n(4),h=n(168);class d extends a.XBaseResizableElement{get EleTypeName(){return"Shape"}get ShowText(){return this.propList.GetPropValue("ShowText")}set ShowText(e){this.propList.ModifyProperty("ShowText",e,null),this.InitSizeByShowText(!0)}get Name(){return this.propList.GetPropValue("Name")}set Name(e){this.propList.ModifyProperty("Name",e,null)}get ShapeName(){return this.propList.GetPropValue("ShapeName")}set ShapeName(e){this.propList.ModifyProperty("ShapeName",e,null)}get AlignKey(){return this.propList.GetPropValue("AlignKey")}set AlignKey(e){this.propList.ModifyProperty("AlignKey",e,null)}get RectRoundAngle(){let e=this.propList.GetPropValue("RectRoundAngle");return s.CNumUtil.TryParseInt(e,4)}set RectRoundAngle(e){this.propList.ModifyProperty("RectRoundAngle",e,4)}get HorEllipseNum(){let e=this.propList.GetPropValue("HorEllipseNum");return s.CNumUtil.TryParseInt(e,2)}set HorEllipseNum(e){this.propList.ModifyProperty("HorEllipseNum",e,2)}get VerEllipseNum(){let e=this.propList.GetPropValue("VerEllipseNum");return s.CNumUtil.TryParseInt(e,1)}set VerEllipseNum(e){this.propList.ModifyProperty("VerEllipseNum",e,1)}GetInnerText(e){return"形状"+this.ShapeName}ReCalcBaseSize(){super.ReCalcBaseSize(),super.GetBoundsDPI(96).Width<r.TextDocApiConst.FloatComparePrecision&&this.InitSizeByShowText(!0)}InitSizeByShowText(e=!0){let t=super.EleStyle.Font;if(null!=t){let n=o.XDomUtil.GetParentValidWidth(this,!0);n- -1<r.TextDocApiConst.FloatComparePrecision&&(n=500);let s=l.GrapUtil.MeasureStrSize(null,t,n,this.ShowText),a=s.Width+10,u=t.Height+10;if(s.Height>u&&(u=s.Height),this.I_ChangeEleSizeByShowShape(a,u),super.MinCanDragWidth=i.DPITransUtil.TransFloatVal(a,96,300),super.MinCanDragHeight=i.DPITransUtil.TransFloatVal(u,96,300),!e){let e=i.DPITransUtil.TransFloatVal(this.Width,300,96),t=i.DPITransUtil.TransFloatVal(this.Height,300,96);if(a<=e&&u<=t)return;a<e&&(a=e),u<t&&(u=t),this.I_ChangeEleSizeByShowShape(a,u)}this.NotifyLayoutChanged(!0,!1),this.SetSizeDPI(a,u,96)}}I_ChangeEleSizeByShowShape(e,t){let n=this.ShapeName;u.default.IsNullOrEmpty(n)&&(n="CirCle"),"CirCle"===n?e>t?t=e:e=t:"Ellipse"===n&&(e>t?t=e*this.VerEllipseNum/this.HorEllipseNum:e=t*this.HorEllipseNum/this.VerEllipseNum)}get ShapeInfo(){return this.BulidShapeInfo()}BulidShapeInfo(){let e=new h.ShapeInfo;return e.No=this.GrpID,e.Type=this.EleTypeName,e.Name=this.Name,e.ShapeKey=this.ShapeName,e.ShapeText=this.ShowText,e.AlignKey=this.EleStyle.VAlign,e.RoundAngle=this.RectRoundAngle,e.HorEllipseNum=this.HorEllipseNum,e.VerEllipseNum=this.VerEllipseNum,e}}t.XShapeEle=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XRuleConstDefine=void 0;const r=n(51),i=n(7);class l{}t.XRuleConstDefine=l,l.RulerCursorWidth=12,l.TopRulerViewHeight=34,l.LeftRulerViewWidth=28,l.RulerWidth=20,l.BaseDpi=96,l.BigScaleHeight=4,l.CenterSacleHeight=3,l.SmallScaleHeight=2,l.ScaleTextFont=new r.Font("微软雅黑",7),l.ScaleTextColor=new i.Color("#000000"),l.RuleBackColor=new i.Color("#ffffff"),l.ScaleLineColor=new i.Color("#838383"),l.InValidBackColor=new i.Color("#b3b3b3"),l.MinPageMargin=8,l.PageMarginSpace=8},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RelativeUIParam=void 0;const r=n(51),i=n(25),l=n(339);class s{static get ScreenSize(){return s.RELATIVERATIO>=s.TEMPLETECHANGEDRATIO?l.ScreenSize.Large:l.ScreenSize.Medium}}t.RelativeUIParam=s,s.RELATIVETITLEWIDTH=84,s.RELATIVECELLSIZE=new i.SizeF(236,24),s.RELATIVERATIO=1366,s.Font=new r.Font("微软雅黑",12),s.TEMPLETECHANGEDRATIO=1441},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SernoPath=void 0;const r=n(117),i=n(227),l=n(328);class s{constructor(){this.arrSernoPath=[],this.arrListType=[]}Clear(){for(let e=0;e<s.MaxLen;e++)this.arrSernoPath[e]=0,this.arrListType[e]=null}SetSerno(e,t,n){this.arrSernoPath[e]=t,this.arrListType[e]=n}GetSerno(e){return this.arrSernoPath[e]}AddSerno(e,t){this.arrSernoPath[e]++;for(let n=t;n<e;n++)this.arrSernoPath[n]++}TryFillListTypes(e){for(let t=0;t<e;t++){r.ParagraphListStyleVals.IsNoneListStyle(this.arrListType[t])&&(this.arrListType[t]="ListNumberStyle")}}GetCodeStr(e,t){let n=this.arrListType[e],i=r.ParagraphListStyleVals.GetShowVal(n);t=i.length<=1?".":i[1];let l=1+this.arrSernoPath[e];return[s.GetSerCode(n,l,i[0]),t]}BuildSernoFullPath(e){let t;if(r.ParagraphListStyleVals.IsNoneListStyle(this.arrListType[e]))return t=null,null;this.TryFillListTypes(e);let n=" ",i=null;for(let t=0;t<=e;t++){const r=this.GetCodeStr(t,i);let l=r[0];i=r[1],null!=l&&(n+=l,n+=t==e?" ":i)}return t=n,t}static GetSerCode(e,t,n){let r;switch(e){case"None":return r=null,r;case"ListNumberStyle":case"ListNumberStyleArabic1":case"ListNumberStyleArabic2":return r=l.SerCodeUtil.GetSerCode(t,i.ENumSerType.Arabic,!1),r;case"ListNumberStyleNumberInCircle":return r=s.ArrNumberInCircle[t%s.ArrNumberInCircle.length],r;case"ListNumberStyleLowercaseLetter":return r=l.SerCodeUtil.GetSerCode(t,i.ENumSerType.ABC,!1),r;case"ListNumberStyleLowercaseRoman":return r=l.SerCodeUtil.GetSerCode(t,i.ENumSerType.Roman,!1),r;case"ListNumberStyleSimpChinNum1":case"ListNumberStyleSimpChinNum2":return r=l.SerCodeUtil.GetSerCode(t,i.ENumSerType.Chinese,!1),r;case"ListNumberStyleTradChinNum1":case"ListNumberStyleTradChinNum2":return r=l.SerCodeUtil.GetSerCode(t,i.ENumSerType.Chinese,!0),r;case"ListNumberStyleZodiac1":return r=l.SerCodeUtil.GetSerCode(t-1,i.ENumSerType.ChsGanZhiOR,!0),r;case"ListNumberStyleZodiac2":return r=l.SerCodeUtil.GetSerCode(t-1,i.ENumSerType.ChsGanZhiOR,!1),r}return n}}t.SernoPath=s,s.MaxLen=20,s.ArrNumberInCircle=["-","①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TooltipTestUtil=void 0;const r=n(322),i=n(59),l=n(16),s=n(10),o=n(4),a=n(176),u=n(110),h=n(39),d=n(2);t.TooltipTestUtil=class{constructor(e){this.xdocEditor=null,this.onlyShowTraceTip=!1,this.tipMgr=a.EmrTooltipManager.Instance,this.xdocEditor=e}get OnlyShowTraceTip(){return this.onlyShowTraceTip}set OnlyShowTraceTip(e){this.onlyShowTraceTip=e}RefreshTooltip(){this.tipMgr.RefreshTooltip()}SetTooltipPos(e,t){let n=this.tipMgr.TipInfo;if(o.default.IsNullOrEmpty(n.TipMsg))this.tipMgr.HideTooltip();else{let l=this.xdocEditor.MGetZoomRatio(),o=t?this.xdocEditor.M_EleEvtModel.EleMOverWrap:this.xdocEditor.M_EleEvtModel.EleClickedWrap,a=o.EleFocused;const h=this.xdocEditor.M_EleEvtModel.WorkMode!=d.ENumWorkMode.KeepTrace&&(null==a?void 0:a.IsRemoved);if(null==a||a.IsHidden(!0)||h)this.tipMgr.HideTooltip();else{let t=u.RectFUtil.ToPoint(i.ClickedElementWrapper.GetElePosInCtrl(a,o.PageFocused,l)),h=this.xdocEditor.PointToScreen(t);h.Y-=s.DPITransUtil.TransIntVal(12*(2-e),72,96),"Text_Under"==r.TextDocInitInfoExt.GetInstance().TipShowPos&&(h.Y+=a.GetBoundsDPI(96).Height+10),n.TipPos=h}}}HideToolTip(){this.tipMgr.HideTooltip()}AutoUpdateTooltip(){const e=this.xdocEditor.M_EleEvtModel;let t=e.EleMOver;const n=e.WorkMode;if(null==t)this.tipMgr.HideTooltip();else{let e=n!=d.ENumWorkMode.KeepTrace,i=null,s="Text_Under"==r.TextDocInitInfoExt.GetInstance().TipShowPos?2:0,o=e?null:l.XDomUtil.GetUserHistoryWrap(t);if(null!=o&&o.HasValidHistory()){const e=!!this.xdocEditor.M_EdtCustomEvtGrp.IsShowTraceUserId,t=o.RelEle,n=null!=t&&null!=t.EleStyle?t.EleStyle.CreatorIndex:-1,r=null!=t&&null!=t.EleStyle?t.EleStyle.DeleterIndex:-1;let l="";null!=o.AddHist&&null!=o.DelHist?(l+=h.DateTime.TimeString(o.AddHist.AddTime.Value)+"<br />",l+="由 "+o.AddHist.UserInfo.UsrName,l+=e?"("+o.AddHist.UserInfo.UsrId+")":"",l+=" 创建:<br />",l+=o.AddHist.BuildRelEleString(50)+"<br />",l+=h.DateTime.TimeString(o.DelHist.AddTime.Value)+"<br />",l+="由 "+o.DelHist.UserInfo.UsrName,l+=e?"("+o.DelHist.UserInfo.UsrId+")":"",l+=" 删除:<br />",l+=o.DelHist.BuildRelEleString(50)):null!=o.AddHist&&n>r?(l+=h.DateTime.TimeString(o.AddHist.AddTime.Value)+"<br />",l+="由 "+o.AddHist.UserInfo.UsrName,l+=e?"("+o.AddHist.UserInfo.UsrId+")":"",l+=" 创建:<br />",l+=o.AddHist.BuildRelEleString(50)):null!=o.DelHist&&r>n&&(l+=h.DateTime.TimeString(o.DelHist.AddTime.Value)+"<br />",l+="由 "+o.DelHist.UserInfo.UsrName,l+=e?"("+o.DelHist.UserInfo.UsrId+")":"",l+=" 删除:<br />",l+=o.DelHist.BuildRelEleString(50)),null!=l&&(i=l)}else this.onlyShowTraceTip||(i=l.XDomUtil.GetToolTip(t));null!=o&&o.Clear(),null!=i?(this.tipMgr.TipInfo.SetTipMsg(i),this.SetTooltipPos(s,!0)):this.tipMgr.HideTooltip()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconButtonComp=t.IconButton=void 0;const r=n(12);n(736);const i=n(22);class l extends r.PureComponent{constructor(e){super(e),this.state={active:!1}}componentDidMount(){this.props.item.React=this}setDisabled(e){this.setState({disabled:e})}setActived(e){if(this.props.switch)if(void 0===e){let e=this.props.group;e&&!this.state.active&&this.props.toolbar.itemList.forEach((t,n)=>{t.Component.Props.group==e&&t.Component.react.setState(e=>({active:!1}))}),this.setState(e=>({active:!e.active}))}else this.setState({active:e})}handleClick(e){let t;this.setActived(),t=Object.prototype.hasOwnProperty.call(this.props,"paramsVal")?this.props.paramsVal:this.props.switch?!this.state.active:null,this.props.stateRef&&(this.props.stateRef[this.props.id]=t),this.props.onItemClick(t);const{onClick:n}=this.props;n&&n(e)}render(){const{className:e,buttonIcon:t,disabled:n,id:i,title:l,group:s,value:o}=this.props;let a=e?" "+e:"",u=n?" disabled":"",h=s?" "+s:"",d=this.state.active&&this.props.switch?" active":"";return r.createElement("button",{title:l,id:i,className:"pango-editor-button"+a+u+h+d,onClick:e=>this.handleClick(e)},r.createElement("i",{className:"icon emr-icon-"+t}))}}t.IconButton=l,l.defaultProps={onClick:()=>{},className:"",buttonIcon:"",disabled:!1,id:"",title:"",group:"",item:"",onItemClick:()=>{}};class s extends i.BaseComponent{constructor(e,t){super(e,t)}setDisabled(e){this.React.setState({disabled:e})}set CommandValue(e){this.React.setActived(e)}Render(){}}t.IconButtonComp=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DropdownComp=void 0;const r=n(12);n(738);const i=n(22),l="notFound",s="disableSelection",o="checkbox",a="highlightOption",u="chip",h="singleChip",d="multiSelectContainer",c="disable_ms",p="singleSelect",f="optionListContainer",g="displayBlock",m="displayNone";class E extends r.Component{constructor(e){super(e),this.handleClickOutside=e=>{this&&this.dropdownContainer&&this.dropdownContainer.current&&(this.dropdownContainer.current.contains(e.target)||this.state.toggleOptionsList&&this.setState({toggleOptionsList:!1}))},this.state={inputValue:"",options:e.options,filteredOptions:e.options,unfilteredOptions:e.options,selectedValues:Object.assign([],e.selectedValues),preSelectedValues:Object.assign([],e.selectedValues),toggleOptionsList:!1,highlightOption:e.avoidHighlightFirstOption?-1:0,showCheckbox:e.showCheckbox,groupedObject:[]},this.dropdownContainer=r.createRef(),this.optionsListWrapper=r.createRef(),this.onChange=this.onChange.bind(this),this.toggleOptionList=this.toggleOptionList.bind(this),this.onArrowKeyNavigation=this.onArrowKeyNavigation.bind(this),this.onSelectItem=this.onSelectItem.bind(this),this.isSelectedValue=this.isSelectedValue.bind(this),this.isDisablePreSelectedValues=this.isDisablePreSelectedValues.bind(this),this.resetSelectedValues=this.resetSelectedValues.bind(this),this.getSelectedItems=this.getSelectedItems.bind(this),this.getSelectedItemsCount=this.getSelectedItemsCount.bind(this)}initSelectedValues(){const{selectedValues:e}=this.state,{singleSelect:t,onSelect:n,target:r}=this.props;if(e&&0!=e.length){n(t?e[0]:e)}}resetSelectedValues(){const{unfilteredOptions:e}=this.state;return new Promise(t=>{this.setState({selectedValues:[],preSelectedValues:[],options:e,filteredOptions:e},()=>{t(0)})})}getSelectedItems(){return this.state.selectedValues}getSelectedItemsCount(){return this.state.selectedValues.length}componentDidMount(){this.initSelectedValues(),document.addEventListener("click",this.handleClickOutside),document.addEventListener("keydown",this.onArrowKeyNavigation),this.props.item.React=this}componentDidUpdate(e){const{options:t,selectedValues:n}=this.props,{options:r,selectedValues:i}=e;JSON.stringify(r)!==JSON.stringify(t)&&this.setState({options:t,filteredOptions:t,unfilteredOptions:t}),JSON.stringify(i)!==JSON.stringify(n)&&this.setState({selectedValues:Object.assign([],n),preSelectedValues:Object.assign([],n)})}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutside),document.removeEventListener("keydown",this.onArrowKeyNavigation)}onChange(e){this.setState({inputValue:e.target.value})}onArrowKeyNavigation(e){if(!this.state.toggleOptionsList)return;const{options:t,highlightOption:n,toggleOptionsList:r,inputValue:i,selectedValues:l}=this.state;if(8===e.keyCode&&!i&&l.length&&this.onRemoveSelectedItem(l.length-1),t.length)if(38===e.keyCode)n>0?this.setState(e=>({highlightOption:e.highlightOption-1})):this.setState({highlightOption:t.length-1});else if(40===e.keyCode){n<t.length-1?this.setState(e=>({highlightOption:e.highlightOption+1})):this.setState({highlightOption:0});this.optionsListWrapper.current;this.state.highlightOption}else if("Enter"===e.key&&t.length&&r){if(-1===n)return;this.onSelectItem(t[n])}}onRemoveSelectedItem(e){let{selectedValues:t,index:n=0,isObject:r}=this.state,{displayValue:i}=this.props;const{onRemove:l,showCheckbox:s}=this.props;n=r?t.findIndex(t=>t[i]===e[i]):t.indexOf(e),t.splice(n,1),l(t,e),this.setState({selectedValues:t})}onSelectItem(e){const{selectedValues:t}=this.state,{onSelect:n,singleSelect:r,showCheckbox:i,onSelectedItem:l}=this.props;if(this.setState({inputValue:""}),r)return this.setState({highlightOption:this.state.options.indexOf(e)}),this.onSingleSelect(e),n(e),l(e),void(this.props.stateRef&&(this.props.stateRef[this.props.id]=e));this.isSelectedValue(e)?this.onRemoveSelectedItem(e):(t.push(e),n(t),this.setState({selectedValues:t}))}onSingleSelect(e){let{isObject:t}=this.props,n=this.state.options;if(t)for(let t=0;t<n.length;t++){let r=n[t];r.value==e&&(e=r)}this.setState({selectedValues:[e],toggleOptionsList:!1},()=>{this.initSelectedValues()})}isSelectedValue(e){const{isObject:t,displayValue:n}=this.props,{selectedValues:r}=this.state;return t?r.filter(t=>t[n]===e[n]).length>0:r.filter(t=>t===e).length>0}renderOptionList(){const{emptyRecordMsg:e}=this.props,{options:t}=this.state;return r.createElement("ul",{className:"optionContainer",ref:this.optionsListWrapper},0===t.length&&r.createElement("span",{className:"notFound "+l},e),this.renderNormalOption())}renderNormalOption(){const{isObject:e=!1,displayValue:t,showCheckbox:n,singleSelect:i}=this.props,{highlightOption:l}=this.state;return this.state.options.map((s,u)=>r.createElement("li",{key:"option"+u,className:(l===u?a+" highlight":"")+" option",onClick:()=>this.onSelectItem(s)},n&&!i&&r.createElement("input",{type:"checkbox",readOnly:!0,className:"checkbox "+o,checked:this.isSelectedValue(s)}),e?s[t]:(s||"").toString()))}renderSelectedList(){const{isObject:e=!1,displayValue:t,singleSelect:n,textWidth:i}=this.props,{selectedValues:l}=this.state;return 0===l.length?r.createElement("span",{className:`chip ${u} ${n&&h} `,style:{width:i+"px"}}):l.map((l,o)=>r.createElement("span",{className:`chip ${u} ${n&&h} ${this.isDisablePreSelectedValues(l)&&s}`,style:{width:i+"px"},key:o},e?l[t]:(l||"").toString()))}isDisablePreSelectedValues(e){const{isObject:t,disablePreSelectedValues:n,displayValue:r}=this.props,{preSelectedValues:i}=this.state;return!(!n||!i.length)&&(t?i.filter(t=>t[r]===e[r]).length>0:i.filter(t=>t===e).length>0)}toggleOptionList(){let e=this;const{options:t,selectedValues:n}=this.state;this.setState({toggleOptionsList:!this.state.toggleOptionsList},()=>{if(this.state.toggleOptionsList){let r=n?t.indexOf(n[0]):0;e.setState({highlightOption:r})}})}mouseOverHandle(e){e.currentTarget.classList.add("hover")}mouseOutHandle(e){e.currentTarget.classList.remove("hover")}renderMultiselectContainer(){const{inputValue:e,toggleOptionsList:t,selectedValues:n}=this.state,{placeholder:i,singleSelect:l,id:s,hidePlaceholder:o,disable:a,isShowHoverStyle:u}=this.props,h=t?"active":"";return r.createElement("div",{className:`${d} ${a?c+" disable_ms":""}`,id:s||"multiselectContainerReact",key:s,ref:this.dropdownContainer,onMouseOver:u?e=>this.mouseOverHandle(e):()=>{},onMouseOut:u?e=>this.mouseOutHandle(e):()=>{}},r.createElement("div",{className:""+(l?p:""),onClick:l?this.toggleOptionList:()=>{}},this.renderSelectedList(),r.createElement("input",{type:"text",className:"inputValueBox",id:(s||"search")+"_input",onChange:this.onChange,value:e,placeholder:l&&n.length||o&&n.length?"":i,autoComplete:"off",disabled:l||a}),r.createElement("i",{className:"icon_arrow emr-icon-arrowbottom "+h})),r.createElement("div",{className:`optionListContainer ${f} ${t?g:m}`},this.renderOptionList()))}render(){return this.renderMultiselectContainer()}}t.default=E,E.defaultProps={target:"",options:[],disablePreSelectedValues:!1,selectedValues:[],isObject:!0,displayValue:"model",textWidth:48,showCheckbox:!1,placeholder:"",emptyRecordMsg:"No Options Available",isShowHoverStyle:!1,onSelect:()=>{},onSelectedItem:()=>{},onRemove:()=>{},singleSelect:!1,id:"",avoidHighlightFirstOption:!1,hidePlaceholder:!1,stateRef:{}};class C extends i.BaseComponent{constructor(e,t){super(e,t)}get selectValue(){return this.React.getSelectedItems()[0]}set CommandValue(e){this.React.onSingleSelect(e)}Render(){}}t.DropdownComp=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DropButton=void 0;const r=n(12),i=n(74);n(744);class l extends r.Component{constructor(e){super(e),this.buttonRef=r.createRef(),this.clickHandler=e=>{const{active:t}=this.state;if(!t){let e=this.offset(this.buttonRef.current),t=e.top+24,n=e.left;this.setState({left:n,top:t})}this.setState({active:!t})},this.closeHandler=()=>{this.setState({active:!1})},this.selectHandler=e=>{this.props.onSelect(e),this.setState({active:!1})},this.state={active:!1,left:0,top:0}}offset(e){let t=null,n=null,r=e.offsetParent;for(t+=e.offsetLeft,n+=e.offsetTop;r;)t+=r.offsetLeft-r.scrollLeft,n+=r.offsetTop-r.scrollTop,r=r.offsetParent;return{left:t,top:n}}render(){let{active:e,left:t,top:n}=this.state;return r.createElement(r.Fragment,null,r.createElement("div",{ref:this.buttonRef,className:"toolbar-btn",title:this.props.title,onClick:this.clickHandler},r.createElement("i",{className:"icon emr-icon-"+this.props.buttonIcon}),r.createElement("i",{className:"icon_arrow emr-icon-arrowbottom"+(e?" active":"")})),e?r.createElement(i.default,{isShow:e,top:n,left:t,onClose:this.closeHandler},r.Children.map(this.props.children,t=>r.cloneElement(t,{onSelect:this.selectHandler,active:e}))):null)}}t.DropButton=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorButtonComp=t.ColorButton=t.ColorPicker=void 0;const r=n(12);n(746);const i=n(22),l=n(74),s=n(748),o=n(7);class a extends r.Component{constructor(e){super(e),this.clickHandler=e=>{let t=e.target.style.backgroundColor;this.props.onSelect(t)},this.clickAutoHandler=()=>{this.props.onSelect(s.autoColor)},this.closeHandler=()=>{this.props.onClose()},this.state={value:e.value||s.autoColor}}renderSelectedGroup(){return r.createElement("div",{className:"color-group-selected",onClick:this.clickAutoHandler},r.createElement("span",{className:"color-item",style:{backgroundColor:s.autoColor}}),r.createElement("span",{className:"title"},"自动"))}renderThemeGroup(){let e=[];for(let t=0;t<s.themeColorList.length;t++){let n=[];for(let e=0;e<s.themeColorList[t].length;e++)n.push(s.themeColorList[t][e]);e.push(n)}return r.createElement("div",{className:"color-group-theme",onClick:this.clickHandler},e.map((e,t)=>r.createElement("div",{key:"group_"+t,className:"item-group"},e.map((e,n)=>{let i=0===t&&0===n?"white":"";return r.createElement("span",{className:"color-item "+i,style:{backgroundColor:e},key:t+""+n})}))))}renderStandardColor(){return r.createElement("div",{className:"color-group-standard"},r.createElement("div",{className:"text"},"标准色"),r.createElement("div",{className:"item-group",onClick:this.clickHandler},s.standardColorList.map((e,t)=>r.createElement("span",{className:"color-item",style:{backgroundColor:e},key:"standard_"+t}))))}render(){let{left:e,top:t,active:n}=this.props;return n?r.createElement(l.default,{isShow:n,top:t,left:e,onClose:this.closeHandler},r.createElement("div",{className:"component-color-panel-wrap component-menu"},r.createElement("div",{className:"component-color-panel"},r.createElement("div",{className:"menu-content"},this.renderSelectedGroup(),this.renderThemeGroup(),this.renderStandardColor())))):null}}t.ColorPicker=a,a.defaultProps={value:"",stateRef:{},active:!1};class u extends r.Component{constructor(e){super(e),this.colorButtonRef=r.createRef(),this.clickHandler=e=>{this.props.onClick(e);const{active:t}=this.state;if(!t&&!this.props.isSetPopPos){let e=this.offset(this.colorButtonRef.current).top+24,t=this.offset(this.colorButtonRef.current).left;this.setState({popLeft:t,popTop:e})}this.setState({active:!t})},this.closeHandler=()=>{this.state.active&&this.setState({active:!1})},this.selectHandler=e=>{this.props.onSelect&&this.props.onSelect(e),this.setState({active:!1,value:e}),this.props.stateRef&&(this.props.stateRef[this.props.id]=e)},this.state={active:!1,popLeft:e.popLeft||0,popTop:e.popTop||0,value:""}}componentDidMount(){this.props.item.React=this}componentDidUpdate(e,t,n){const{popLeft:r,popTop:i}=this.props;e.popLeft==r&&e.popTop==i||this.setState({popLeft:r,popTop:i})}changeValue(e){this.setState({value:e})}offset(e){let t=null,n=null,r=e.offsetParent;for(t+=e.offsetLeft,n+=e.offsetTop;r;)t+=r.offsetLeft,n+=r.offsetTop,r=r.offsetParent;return{left:t,top:n}}render(){let{active:e,value:t}=this.state,{id:n,buttonIcon:i,isDestroy:l}=this.props,s=this.props.popLeft,o=this.props.popTop,u=this.state.popLeft,h=this.state.popTop,d=s||u,c=o||h,p=!l||e;return r.createElement("div",{className:"colorButton",id:n||""},r.createElement("div",{ref:this.colorButtonRef,className:"toolbar-btn color-btn",onClick:this.clickHandler},r.createElement("i",{ref:e=>this.buttonIcon=e,className:"icon emr-icon-"+i}),r.createElement("i",{className:"underline",style:{backgroundColor:t}}),r.createElement("i",{className:"icon_arrow emr-icon-arrowbottom"+(e?" active":"")})),p&&r.createElement(a,{active:e,top:c,left:d,onClose:this.closeHandler,onSelect:this.selectHandler}))}}t.ColorButton=u,u.defaultProps={onClick:()=>{},isSetPopPos:!1,isDestroy:!1};class h extends i.BaseComponent{constructor(e,t){super(e,t)}set CommandValue(e){null==e&&(e="rgba(255,255,255,1)"),e instanceof o.Color&&(e=e.ToRgbaString()),this.React.changeValue(e)}Render(){}}t.ColorButtonComp=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_AddEdtHistory=void 0;const r=n(2),i=n(0),l=n(175),s=n(349),o=n(3),a=n(7),u=n(766),h=n(350),d=n(95),c=n(1);class p extends c.XBaseAction{ActName(){return"AddEdtHistory"}constructor(){super(),super.OpType=r.ENumActOpType.CtntEdit}static CanDelWithHist(e){return!(null==e||!e.IsValid())}Execute(e){return this.resMsg.MsgLevel=1,this.resMsg.MsgStr=this.ActName+" 命令禁用Execute接口，请使用Execute3代替",this.resMsg}Execute3(e,t,n,i){this.resMsg.Clear();const l=super.GetEdtCtrl();let s;if(l.M_EleEvtModel.WorkMode==r.ENumWorkMode.Design)this.resMsg.MsgLevel=2,this.resMsg.MsgStr="编辑器当前工作模式是设计态，不能添加修订历史",s=this.resMsg;else if(null==n||n.length<=0||e==r.ENumEdtType.Other)this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName+" 命令参数值有误",s=this.resMsg;else if(l.M_EdtCustomEvtGrp.AppKeepTrace){let l=super.GetXDocFocused(),o=this._PrepareElesToBind(n);if((null==o?0:o.length)<=0)s=this.resMsg;else{let a=l.GetUserHistoryList(),u=this._GetArroundHistoryWrap(o),h=-1,c=this._BuildUserHistory(e,u,h),p=c[0];if(h=c[1],h<0&&null!=p){p.Serno=a.NextSerno;const e=p.GetArrRelEles();for(let t=0;t<e.length;t++){e[t].EleStyle.DeleterIndex=p.Serno}}let f=h<0?0:u[h].GetDstAimPos(e),g=this._BindHistoryToEles(e,l,p,f,o,t);if(this.InputParentAddHide(n),h<0)g?(a.Add(p),r.ENumEdtType.Add!=p.OpType&&r.ENumEdtType.Replace!=p.OpType||a.TrySplitArroundHistWrap(u[0],u[1],t,d.EmrInnerUtil.GetServTime()),n[0].OwnerDocPanel.IsChanged=!0):a.RevertSerno();else if(0==h){a.TryMergeArroundHistWrap(u[0],u[1],t)&&(n[0].OwnerDocPanel.IsChanged=!0)}null!=u&&(null!=u[0]&&u[0].Clear(),null!=u[1]&&u[1].Clear()),r.ENumEdtType.Replace==p.OpType&&i>-1&&p.ReplaceArr.push(i),this.resMsg.ReturnParams=p.Serno,s=this.resMsg}}else this.resMsg.MsgLevel=5,this.resMsg.MsgStr="自定义配置为不记录痕迹",s=this.resMsg;return s}InputParentAddHide(e){if(null!=e){let t=[];for(let n=0;n<e.length;n++){const r=e[n];let l=i.XDomUtil.GetParentXInput(r,!0);if(null==l)continue;const s=l.XID;if(null!=s&&-1==t.indexOf(s)&&(t.push(s),!l.Attr_FgHide&&l.ChildCount>0)){let e=new o.List;l.GetAllBaseChildren(e,!1);const t=e.ToArray();let n=!0;for(let e=0;e<t.length;e++){if(!(t[e].EleStyle.DeleterIndex>-1)){n=!1;break}}n&&(l.IsLayoutValid=!1)}}}}_PrepareElesToBind(e){let t=new o.List;for(let n=0;n<e.length;n++){let r=e[n];if(null!=r)if(r.CanBeInline(!1)||r instanceof i.XTextTableRow)t.Add(r);else if(r instanceof i.XBaseContainer){let e=!1,n=r;if(n instanceof i.XInputEle){const r=n.GetBackEle(!0),l=null!=r?r[0]:null,s=null!=r?r[1]:null;if(null!=l){i.XDomUtil.HasContent(n,!0)?n.RemoveChildren(s,1):(e=!0,n.GetAllBaseChildren(t))}}e||n.GetChildrenCanBeInline(t,!1)}}return t.ToArray()}_GetArroundHistoryWrap(e){let t=e.length,n=e[0],r=e[t-1],s=new Array(2),o=l.XHistoryUtil.GetPNEles_OnEleRange(n,r);if(null!=o)for(let e=0;e<2;e++)null!=o[e]&&(s[e]=i.XDomUtil.GetUserHistoryWrap(o[e]),0==e&&null!=s[e]&&s[e].StepUpAimPos());return s}_BuildUserHistory(e,t,n){let i=null;return n=-1,null!=t&&(n=0,i=null==t[0]?null:t[0].GetDstHist(e),null==i&&(n=1,i=null==t[1]?null:t[1].GetDstHist(e)),null==i||this._Can_ReuseHistory(i)||(i=null)),null!=i&&e!=r.ENumEdtType.Add&&e!=r.ENumEdtType.Replace||(n=-1,i=this._NewUserHistory(e)),[i,n]}_BindHistoryToEles(e,t,n,l,s,o){let a;if(null==n)a=!1;else if(null==s||s.length<=0)a=!1;else{let u=t.GetDocCtxt().ViewMode.IsCleanViewMode,d=!1,c=!1;for(let a=0;a<s.length;a++){let p=s[a];this.resMsg.Clear();let f=p.EleStyle;switch(e){case r.ENumEdtType.Add:case r.ENumEdtType.Replace:c=this._BindAddHistoryToEle(n,f),c&&(l=n.AddRelEle(l,p));break;case r.ENumEdtType.Delete:case r.ENumEdtType.Backspace:if(c=this._BindDelHistoryToEle(t,n,p,o),p.EleStyle.DeleterIndex>-1&&(p.IsRemoved=!0),c&&(l=n.AddRelEle(l,p),p instanceof i.XInputEle)){const e=p;e.EditorActiveMode="",e.IsDisSkip=!0}}if(l>=0){let e=new h.HistoryRelEleUndo(n,p,l,!0);o.AddItem(e);const r=t.GetSecurityOpts();if(null!=r){const e=null!=n&&null!=n.UserInfo?n.UserInfo.PermissionLv:1,t=super.GetEdtLoginUserInfo(),i=null!=t?t.PermLevel:1;1!=e&&i==e&&r.saveTrackStyle(e,i)}}u&&c&&p.NotifyLayoutChanged(!0,!1),c&&l>=0&&l++,d=d||c}a=d}return a}_BindAddHistoryToEle(e,t){let n;return t.CreatorIndex>=0?n=!1:(t.CreatorIndex=e.Serno,n=!0),n}_BindDelHistoryToEle(e,t,n,r){let l,s=n.EleStyle,o=s.CreatorIndex,h=s.DeleterIndex,d=s.ForeColor,c=e.GetUserHistoryList().FindBySerno(o);if(null!=c&&c.CmprPermLvTo(t)>0)this.resMsg.MsgLevel=2,this.resMsg.MsgStr="当前登陆用户权限等级="+t.UserInfo.PermissionLv+", 低于内容创建者权限等级="+c.UserInfo.PermissionLv+"，无法删除",l=!1;else if(h>=0)l=!1;else{if(s.DeleterIndex=t.Serno,s.CreatorIndex,s.HistColor=s.ForeColor,s.ForeColor=a.Color.Blue,n instanceof i.XInputBorderEle){n=n.BrotherBorderEle;let e=new u.EleHistoryUndo(n,o,h,d);r.AddItem(e)}let e=new u.EleHistoryUndo(n,o,h,d);r.AddItem(e),l=!0}return l}_Can_ReuseHistory(e){let t;if(null==e)t=!1;else{let n=super.GetEdtLoginUserInfo();t=n.IsValid()&&n.UsrId==e.UserInfo.UsrId}return t}_NewUserHistory(e){let t,n=super.GetEdtLoginUserInfo();if(n.IsValid()){let r=new s.XUserHistory(d.EmrInnerUtil.GetServTime());r.OpType=l.XHistoryUtil.MergeOpType(e),n.CopyTo(r.UserInfo),t=r}else this.resMsg.MsgLevel=2,this.resMsg.MsgStr="当前登陆用户信息无效，无法添加痕迹",super.MessageWarn(),t=null;return t}}t.A_AddEdtHistory=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditEleRangeAssist=void 0;const r=n(2),i=n(0),l=n(16),s=n(79),o=n(175),a=n(45),u=n(141),h=n(3),d=n(94),c=n(116),p=n(224),f=n(106),g=n(138),m=n(360),E=n(768),C=n(163),A=n(95),y=n(361);t.EditEleRangeAssist=class{constructor(){this.eleEvtModel=null}SetEleEvtModel(e){this.eleEvtModel=e}static ChangeOneParaghOutline(e,t,n,i,l,s){let o=e.Document.GetOutlineList();if(t){if(o.ChangeOutlineLv(e,n)){let t=new m.OutlineLvUndo(e,n,o);s.AddItem(t)}}if(i){let t=-1,n=null,i=e.AutoAddDelSernoLabel(n,t),a=i[0];if(n=i[1],t=i[2],a!=r.ENumEdtType.Other){let e=new f.EleAddDelUndo(n,t,a==r.ENumEdtType.Add);s.AddItem(e)}o.ChangeListStyle(e);let u=new E.ParaghListStyleUndo(e,l,o);s.AddItem(u)}}RemoveEleCannotAdd(e,t){let n;if(null==e)n=t;else{let r=null==t?0:t.length;if(r<=0)n=null;else{let l,s=new h.List;if(e instanceof i.XTextTableCell){for(let n=0;n<r;n++){let r=t[n];this.IsAddableByEleTp(e,r)&&s.Add(r)}l=s.ToArray(),s.Clear()}else l=t;n=l}}return n}IsAddableByEleTp(e,t){let n;if(null==e||null==t)n=!1;else{if((t instanceof i.XTextTableCell||t instanceof a.XTextTable)&&(e instanceof i.XTextTableCell||e instanceof a.XTextTable))return n=!1,n;n=!0}return n}FindXStrFromSelRange(e){let t=null==e?0:e.length,n=null;for(let r=0;r<t;r++)if(e[r].Parent instanceof s.XStringEle){n=e[r].Parent;break}return n}FindXInputStartBdrsInRange(e,t){let n,r=null==t?0:t.length;if(0==r&&null==e)n=null;else{let i=new h.List,s=l.XDomUtil.GetParentXInput(e,!1);if(null!=s){let e=s.GetChildEle(0);null!=e&&i.Add(e)}for(let e=0;e<r;e++){let n=t[e];null!=n&&n.IsStartBorder&&i.Add(n)}if(i.Count()<=0)n=null;else{let e=i.ToArray();i.Clear(),n=e}}return n}FindEleIxCannotDel(e){let t,n=null==e?0:e.length;if(n<=0)t=null;else{let r,s,o=this.eleEvtModel.WorkMode,u=new p.Stack,c=new p.Stack,f=!1,g=e[0]instanceof i.XTextTableCell?e[0]:null,m=e[n-1]instanceof i.XTextTableCell?e[n-1]:null,E=!1,C=!1;if(g instanceof i.XTextTableCell&&(E=0==g.ColIndex&&0==g.RowIndex),m instanceof i.XTextTableCell){let e=m.Granpa;e instanceof a.XTextTable&&(r=e.Rows.Length,s=e.Columns.Length),C=m.RowIndex==r-1&&m.ColIndex==s-1}let A=this.eleEvtModel.LoginUsrInfo;for(let t=0;t<n;t++){let n=e[t];if(d.EditorWorkModeUtil.ChkDelRuleForWorkMode(n,o,A))if(n instanceof i.XParagraphFlag)f||(f=!0,this._ChkDeletable_EleFirstCR(n,e[0],e[e.length-1])||(u.Push(n),c.Push(t)));else if(n instanceof i.XInputBorderEle){let e=n,r=e.BrotherBorderEle;if(!e.IsStartBorder&&u.Contains(r)){let e=null;for(;e!=r;)e=u.Pop(),c.Pop()}else u.Push(e),c.Push(t)}else l.XDomUtil.IsInnerLabelOfXInput(n,!1)&&(u.Push(n),c.Push(t));else u.Push(n),c.Push(t)}let y=new h.List;if(c.Count>0){let e=c.ToArray();c.Clear(),u.Clear(),e.Reverse(),y.AddRange(e)}y.Add(n);let I=y.ToArray();y.Clear(),t=I}return t}SplitSubRangeByTraceUser(e,t,n){let i;if(n<t)i=null;else{if(this.eleEvtModel.WorkMode!=r.ENumWorkMode.KeepTrace){let e=new y.EditEleSubRange(t);e.ToIx=n,e.AddHistUsrInfo.Clear(),i=[e]}else{let r=new h.List,s=null,o=!0,a=null;for(let i=t;i<n;i++){let t=e[i],n=l.XDomUtil.GetUserHistoryWrap(t),h=null==n?null:n.AddHist;null!=n&&n.Clear();let d=null==h||h.IsPersisted,c=null==h?null:h.UserInfo;null!=s&&u.XUserInfo.Equals(c,a)&&d==o?s.AddToIx():(s=new y.EditEleSubRange(i),s.IsAddHistPersisted=d,s.AddHistUsrInfo.CopyFrom(c),r.Add(s),a=c,o=d)}let d=r.ToArray();r.Clear(),i=d}}return i}RemoveSubRangeAsTrace(e,t,n){if(null!=t&&t.IsValid()){let l=this.eleEvtModel.LoginUsrInfo;if(null!=l)if(null==t.AddHistUsrInfo||t.IsAddHistPersisted||t.AddHistUsrInfo.UsrId!=l.UsrId){let l=t.FromIx,s=t.ToIx,o=new h.List,a=0,u=null;for(let t=l;t<s;t++){let n=e[t];n.Parent!=u&&(this._LogToDel_SubRange_OneParent(u,a,t<=0?null:e[t-1],o),u=n.Parent,a=u.GetChildInx(n))}this._LogToDel_SubRange_OneParent(u,a,s<=0?null:e[s-1],o);let d,c=o.ToArray();for(let e=0;e<c.length;e++){const t=c[e];t.IsLayoutValid=!1;if("XParagraphFlag"==t.EleTypeName||"XTextLabelElement"==t.EleTypeName||"XTextTableRow"==t.EleTypeName)if(t instanceof i.XTextTableRow)this._Remove_ChildRow_(t.Parent,t,n);else{const e=t.Parent.GetChildInx(t);this._Remove_Children_(t.Parent,e,t,n)}else null==d&&(d=[]),d.push(t)}this.eleEvtModel.AddEdtHistAct.Execute3(r.ENumEdtType.Delete,n,d),o.Clear()}else this.RemoveSubRange(e,t,n)}}_LogToDel_SubRange_OneParent(e,t,n,r){if(null!=e)if(e instanceof i.XTextTableRow)r.Add(e);else{let i=e.GetChildInx(n),l=e.GetChildren(t,i-t+1);r.AddRange(l)}}RemoveSubRange(e,t,n){if(null!=t&&t.IsValid()){let r=t.FromIx,i=t.ToIx,l=0,s=null;for(let t=r;t<i;t++){let r=e[t];r.Parent!=s&&(this._Remove_SubRange_OneParent(s,l,t<=0?null:e[t-1],n),s=r.Parent,l=s.GetChildInx(r)),this._Remove_SubRange_OneParent(s,l,i<=0?null:e[i-1],n)}}}After_DelElesRange_EleCursor(e,t){let n=c.XLineEleRange.SortFromToLineEleIx(t.FromLineEleIx,t.ToLineEleIx),l=null,s=n[1]._MovetoNextEle(!0);if(s){let e=n[1];for(l=e.RefreshEleObj(!1);l instanceof i.XTextTableCell;){if(!e._MovetoNextEle(!0)){l=null;break}l=e.RefreshEleObj(!1)}}null==l&&(null!=e?l=e instanceof i.XBaseContainer?e.GetFirstChildBaseEle(!1):e:(s=n[0]._MovetoNextEle(!1),s&&(l=n[0].RefreshEleObj(!1))));let o=this.eleEvtModel.EleClickedWrap.LineEleIxFocused;return this.eleEvtModel.WorkMode==r.ENumWorkMode.App||this.eleEvtModel.WorkMode==r.ENumWorkMode.Form?o.SetEle(l):o.ReplaceEle(l),l}UpdateXDocXinputCache(e){let t=null==e?0:e.length;if(t>0)for(let n=0;n<t;n++){let t=e[n];if(null!=t){let e=t.Parent;A.EmrInnerUtil.UpdateXDocXinputCache(e)}}}_ChkDeletable_EleFirstCR(e,t,n){let r,l=e.Parent.GetLastChildEle();if(e==l)r=!1;else{let l,s=e.OwnerLine.LineAssist.GetFirstLineOfParagraph(),o=s.FirstElement,u=n.OwnerLine.LineAssist.GetFirstLineOfParagraph();if(t instanceof i.XTextTableCell&&o instanceof a.XTextTable){let e;o instanceof i.XBaseContainer&&(e=o),l=t==e.GetFirstLine().FirstElement}else l=t==o,l=u.Index>s.Index;r=l}return r}_Remove_SubRange_OneParent(e,t,n,r){null!=e&&(e instanceof i.XTextTableRow?this._Remove_ChildRow_(e.Parent,e,r):this._Remove_Children_(e,t,n,r))}_Remove_Children_(e,t,n,r){let i=e.GetChildInx(n);if(-1!=i){let s=null==e.Document?null:e.Document.GetUserHistoryList(),a=e.GetChildEle(t),u=null;null!=s&&(u=o.XHistoryUtil.GetPNEles_OnEleRange(a,n));let h=Math.max(i-t+1,1),d=e.RemoveChildren(t,h);if(o.XHistoryUtil.RemoveHistory_OnEles(d,r),null!=s){let e=null,t=null;null!=u&&(e=l.XDomUtil.GetUserHistoryWrap(u[0]),t=l.XDomUtil.GetUserHistoryWrap(u[1])),s.TryMergeArroundHistWrap(e,t,r)}if(null!=d&&d.length>0){let e=new g.EleRangeAddDelUndo(d,t,!1);r.AddItem(e)}}}_Remove_ChildRow_(e,t,n){if(null!=t&&null!=e)if(e.Rows.Count()<=1){let t=e.Parent.RemoveChild(e),r=new f.EleAddDelUndo(e,t,!1);n.AddItem(r)}else{let r=new C.TextTableDeleteRowRedoUndo(e,t);e.Action_DeleteRow(t.GetChildEle(0)),n.AddItem(r)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FindReplaceAssistInfo=void 0;const r=n(0),i=n(79),l=n(3),s=n(4),o=n(771);t.FindReplaceAssistInfo=class{constructor(){this._togetherWithPre=!1,this._directChildEles=new l.List}GetInnerText(){let e="";for(let t=0;t<this._directChildEles.Length;t++)e+=this._directChildEles.Get(t).GetInnerText(!1);return e}get TogetherWithPre(){return this._togetherWithPre}set TogetherWithPre(e){this._togetherWithPre=e}GetBaseEles(){let e=new l.List;for(let t=0;t<this._directChildEles.Length;t++){let n=this._directChildEles.Get(t),l=n.GetInnerText(!1);if(!s.default.IsNullOrEmpty(l))if(n instanceof r.XBaseContainer){let t=n instanceof i.XStringEle?n:null;null!=t&&e.AddRange(t.GetChildArr())}else for(let t=0;t<l.length;t++)e.Add(n)}return e}AddChildEle(e){return this._directChildEles.Add(e),!1}MergeChildList(e){let t=e.DirectChildEles;this._directChildEles.AddRange(t)}get DirectChildEles(){return this._directChildEles}ClearChilds(){this._directChildEles.Clear()}GetLastBaseEle(){let e;return e=null,e}HitTest(e,t,n){let r=new l.List,i=new l.List,s=this.GetInnerText()||"";if(!s)return i;let a="";if(n?(s&&(a=s.toLowerCase()),e&&(e=e.toLowerCase())):a=s,t){let e;for(let t=0;t<e.Count();t++)r.Add(e[t].Index)}else{let t=0,n=0,i=!1;for(;-1!=t;)t=a.indexOf(e),-1!=t&&(i?n=n+t+e.length:n+=t,a=a.substr(t+e.length),i=!0,r.Add(n),t+=e.length)}let u=this.GetBaseEles();for(let t=0;t<r.Length;t++){let n=r.Get(t),l=new o.FindReplaceResultInfo;l.SourceStr=s,l.HitInx=n,l.FindText=e;for(let t=n;t<n+e.length;t++)l.AddHitEle(u.Get(t));i.Add(l)}return i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12);n(851);const i=n(76);class l extends r.Component{constructor(e){super(e),this.handleClickOutside=e=>{this&&this.dropdownContainer&&this.dropdownContainer.current&&(this.dropdownContainer.current.contains(e.target)||this.state.toggleOptionsList&&this.setState({toggleOptionsList:!1}))},this.updateEvent=e=>{this.setState(Object.assign({},e))},e.onRef&&e.onRef(this),this.state={inputValue:"",options:e.options,filteredOptions:e.options,unfilteredOptions:e.options,selectedValues:Object.assign([],e.selectedValues),preSelectedValues:Object.assign([],e.selectedValues),toggleOptionsList:!1,highlightOption:e.avoidHighlightFirstOption?-1:0,showCheckbox:e.showCheckbox,groupedObject:[],optionListLeft:0},this.dropdownContainer=r.createRef(),this.optionsListWrapper=r.createRef(),this.inputRef=r.createRef(),this.onChange=this.onChange.bind(this),this.toggleOptionList=this.toggleOptionList.bind(this),this.onArrowKeyNavigation=this.onArrowKeyNavigation.bind(this),this.onSelectItem=this.onSelectItem.bind(this),this.isSelectedValue=this.isSelectedValue.bind(this),this.isDisablePreSelectedValues=this.isDisablePreSelectedValues.bind(this),this.resetSelectedValues=this.resetSelectedValues.bind(this),this.getSelectedItems=this.getSelectedItems.bind(this),this.getSelectedItemsCount=this.getSelectedItemsCount.bind(this)}initSelectedValues(){const{selectedValues:e}=this.state,{singleSelect:t,onSelect:n,target:r}=this.props;if(e&&0!=e.length){n(t?e[0]:e)}}resetSelectedValues(){const{unfilteredOptions:e}=this.state;return new Promise(t=>{this.setState({selectedValues:[],preSelectedValues:[],options:e,filteredOptions:e},()=>{t(0)})})}getSelectedItems(){return this.state.selectedValues}getSelectedItemsCount(){return this.state.selectedValues.length}componentDidMount(){this.initSelectedValues(),document.addEventListener("click",this.handleClickOutside),document.addEventListener("keydown",this.onArrowKeyNavigation)}componentDidUpdate(e){const{options:t,selectedValues:n}=this.props,{options:r,selectedValues:i}=e;JSON.stringify(r)!==JSON.stringify(t)&&this.setState({options:t,filteredOptions:t,unfilteredOptions:t}),JSON.stringify(i)!==JSON.stringify(n)&&this.setState({selectedValues:Object.assign([],n),preSelectedValues:Object.assign([],n)})}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutside),document.removeEventListener("keydown",this.onArrowKeyNavigation)}onChange(e){}onArrowKeyNavigation(e){if(!this.state.toggleOptionsList)return;const{options:t,highlightOption:n,toggleOptionsList:r,inputValue:i,selectedValues:l}=this.state;if(8===e.keyCode&&!i&&l.length&&this.onRemoveSelectedItem(l.length-1),t.length)if(38===e.keyCode)n>0?this.setState(e=>({highlightOption:e.highlightOption-1})):this.setState({highlightOption:t.length-1});else if(40===e.keyCode){n<t.length-1?this.setState(e=>({highlightOption:e.highlightOption+1})):this.setState({highlightOption:0});this.optionsListWrapper.current;this.state.highlightOption}else if("Enter"===e.key&&t.length&&r){if(-1===n)return;this.onSelectItem(t[n])}}onRemoveSelectedItem(e){let{selectedValues:t,index:n=0,isObject:r}=this.state,{displayValue:i}=this.props;const{onRemove:l,showCheckbox:s}=this.props;n=r?t.findIndex(t=>t[i]===e[i]):t.indexOf(e),t.splice(n,1),l(t,e),this.setState({selectedValues:t})}onSelectItem(e){const{selectedValues:t}=this.state,{onSelect:n,singleSelect:r,showCheckbox:i,onSelectedItem:l}=this.props;if(this.setState({inputValue:""}),r)return this.setState({highlightOption:this.state.options.indexOf(e)}),this.onSingleSelect(e),n(e),void l(e);this.isSelectedValue(e)?this.onRemoveSelectedItem(e):(t.push(e),n(t),this.setState({selectedValues:t}))}onSingleSelect(e){this.setState({selectedValues:[e],toggleOptionsList:!1},()=>{this.initSelectedValues()})}isSelectedValue(e){const{isObject:t,displayValue:n}=this.props,{selectedValues:r}=this.state;return t?r.filter(t=>t[n]===e[n]).length>0:r.filter(t=>t===e).length>0}renderOptionList(){const{emptyRecordMsg:e}=this.props,{options:t}=this.state;return r.createElement("ul",{className:"optionContainer",ref:this.optionsListWrapper},0===t.length&&r.createElement("span",{className:"notFound notFound"},e),this.renderNormalOption())}renderNormalOption(){const{isObject:e=!1,displayValue:t,showCheckbox:n,singleSelect:i}=this.props;let{highlightOption:l,options:s,selectedValues:o}=this.state;if(-1==l&&s instanceof Array)for(let e=0;e<s.length;e++){if(s[e][t]==o[0][t]){l=e;break}}return this.state.options.map((s,o)=>r.createElement("li",{key:"option"+o,className:(l===o?"highlightOption highlight":"")+" option",onClick:()=>this.onSelectItem(s)},n&&!i&&r.createElement("input",{type:"checkbox",readOnly:!0,className:"checkbox",checked:this.isSelectedValue(s)}),e?s[t]:(s||"").toString()))}renderSelectedList(){const{width:e,height:t,isObject:n,displayValue:l,singleSelect:s,textWidth:o,suffixIcon:a,label:u}=this.props,{selectedValues:h,placeholder:d,toggleOptionsList:c}=this.state;if(0===h.length)return r.createElement(i.Input,{value:"",placeholder:d,suffixIcon:a,width:e,height:t,labelText:u.text,ref:this.inputRef});{let s=h.map((e,t)=>n?(e[l]||"").toString():e);return r.createElement(i.Input,{value:s||"",suffixIcon:a,placeholder:d,width:e,height:t,labelText:u.text})}}_getLabelWidth(){let e=this.dropdownContainer.current.getElementsByClassName("pango-editor-input-label")[0];if(e){let t=window.getComputedStyle(e,null).marginRight;return e.offsetWidth+parseInt(t.replace("px",""))}return 0}isDisablePreSelectedValues(e){const{isObject:t,disablePreSelectedValues:n,displayValue:r}=this.props,{preSelectedValues:i}=this.state;return!(!n||!i.length)&&(t?i.filter(t=>t[r]===e[r]).length>0:i.filter(t=>t===e).length>0)}toggleOptionList(){let e=this;const{options:t,selectedValues:n}=this.state;this.setState({toggleOptionsList:!this.state.toggleOptionsList},()=>{if(this.state.toggleOptionsList){let r=n?t.indexOf(n[0]):0;e.setState({highlightOption:r})}}),this.setState({optionListLeft:this._getLabelWidth()})}mouseOverHandle(e){e.currentTarget.classList.add("hover")}mouseOutHandle(e){e.currentTarget.classList.remove("hover")}renderMultiselectContainer(){const{toggleOptionsList:e,optionListLeft:t}=this.state,{singleSelect:n,className:i,id:l,hidePlaceholder:s,disable:o,isShowHoverStyle:a,top:u,left:h,width:d}=this.props;return r.createElement("div",{className:`selectContainer${o?" disable_ms":""}${i?" "+i:""}`,id:l||"selectContainer",key:l,ref:this.dropdownContainer,style:{top:u+"px",left:h+"px"},onMouseOver:a?e=>this.mouseOverHandle(e):()=>{},onMouseOut:a?e=>this.mouseOutHandle(e):()=>{}},r.createElement("div",{className:""+(n?"singleSelect":""),onClick:this.toggleOptionList},this.renderSelectedList()),r.createElement("div",{className:"optionListContainer optionListContainer "+(e?"displayBlock":"displayNone"),style:{left:t+"px",width:d+"px"}},this.renderOptionList()))}render(){return this.renderMultiselectContainer()}}t.default=l,l.defaultProps={width:200,height:32,target:"",options:[],disablePreSelectedValues:!1,selectedValues:[],isObject:!0,displayValue:"model",textWidth:48,showCheckbox:!1,placeholder:"",emptyRecordMsg:"No Options Available",isShowHoverStyle:!1,onSelect:()=>{},onSelectedItem:()=>{},onRemove:()=>{},singleSelect:!1,id:"",avoidHighlightFirstOption:!1,hidePlaceholder:!1,suffixIcon:"",label:{text:"",width:"auto",align:"left"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParagraphFormInfo=void 0;class r{get OutLineLevelDataSource(){return this._OutLineLevelDataSource}set OutLineLevelDataSource(e){this._OutLineLevelDataSource=e}get ListTabelStyleDataSourceListDataSource(){return this._ListTabelStyleDataSourceListDataSource}set ListTabelStyleDataSourceListDataSource(e){this._ListTabelStyleDataSourceListDataSource=e}get RowGapDataSourceListDataSource(){return this._RowGapDataSourceListDataSource}set RowGapDataSourceListDataSource(e){this._RowGapDataSourceListDataSource=e}get OutLineValueText(){return this._OutLineValueText}set OutLineValueText(e){this._OutLineValueText=e}get ListStyleValueText(){return this._ListStyleValueText}set ListStyleValueText(e){this._ListStyleValueText=e}get LeftShrink(){return this._LeftShrink}set LeftShrink(e){this._LeftShrink=e}get FirstRowShrink(){return this._FirstRowShrink}set FirstRowShrink(e){this._FirstRowShrink=e}get Shrink(){return this._Shrink}set Shrink(e){this._Shrink=e}get ParagraphBeforeShrink(){return this._ParagraphBeforeShrink}set ParagraphBeforeShrink(e){this._ParagraphBeforeShrink=e}get ParagraphAfterShrink(){return this._ParagraphAfterShrink}set ParagraphAfterShrink(e){this._ParagraphAfterShrink=e}get RowSpaceValueText(){return this._RowSpaceValueText}set RowSpaceValueText(e){this._RowSpaceValueText=e}get RowSpace(){return this._RowSpace}set RowSpace(e){this._RowSpace=e}get IsFirstRowShrink(){return this._IsFirstRowShrink}set IsFirstRowShrink(e){this._IsFirstRowShrink=e}get IsHangInShrink(){return this._IsHangInShrink}set IsHangInShrink(e){this._IsHangInShrink=e}get IsMoreParaList(){return this._IsMoreParaList}set IsMoreParaList(e){this._IsMoreParaList=e}get ComboBoxDefaultSelectIndex(){return this._ComboBoxDefaultSelectIndex}set ComboBoxDefaultSelectIndex(e){this._ComboBoxDefaultSelectIndex=e}static CopyInfo(e){let t=new r;if(null!=e)for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];t[n]=r}return t}}t.ParagraphFormInfo=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTableInsertColumnRedoUndo=void 0;const r=n(3),i=n(23),l=n(20);class s extends i.IXUndoable{constructor(e,t){if(super(),this.insertIndex=-1,this.table=e,this.splitCell=t,null!=this.table){this.relatedBounds=new r.List,this.relatedBounds_Disp=new r.List;for(let e=0;e<this.table.Columns.Count();e++){let t=this.table.Columns.Get(e);this.relatedBounds.Add(t.Bounds.Clone()),this.relatedBounds_Disp.Add(t.BoundsDISP.Clone())}}}SaveInsertColumn(e,t){this.insertColumn=e,this.insertIndex=t}IsValid(){return!0}CanUndo(){return!0}CanRedo(){return!0}Undo(){null!=this.insertColumn&&this.table.Undo_InsertColumn(this.insertColumn,this.relatedBounds,this.relatedBounds_Disp)}Redo(){null!=this.table&&-1!=this.insertIndex&&this.table.Action_InsertColumn_New(this.insertIndex,this.insertColumn,!1),null!=this.splitCell&&l.XTextTableUtil.newColIntoPreCol(this.splitCell)}Clear(){this.table=null,this.insertColumn=null,this.insertIndex=-1,this.relatedBounds.Clear(),this.relatedBounds_Disp.Clear()}}t.TextTableInsertColumnRedoUndo=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseA_PrintDoc=void 0;const r=n(44),i=n(40),l=n(2),s=n(246),o=n(6),a=n(260),u=n(3),h=n(383),d=n(940),c=n(941),p=n(140),f=n(30),g=n(60),m=n(1),E=n(11),C=n(387),A=n(53),y=n(67),I=n(7),S=n(942),_=n(146);class w extends m.XBaseAction{constructor(){super(),this.prtpreview_evthandler=null,this.res_prt=f.ENumEndType.Error,super.OpType=l.ENumActOpType.Save,this.prtpreview_evthandler=new c.EmrPrtPreviewEvtHandler}IsPrinted(){return this.res_prt==f.ENumEndType.DoPrint||this.res_prt==f.ENumEndType.DoExport}Execute(e){_.LoadingComp.show(),this.resMsg.Clear(),this.res_prt=f.ENumEndType.Error;let t=null==e?0:e.length,n=t<=0?null:e[0],r=t<=1?null:e[1],i=t<=2?null:e[2],l=super.GetEdtCtrl(),o=l.M_XDocsUtil;if(null==n&&(n=new Boolean(!0)),null==r&&(r=new Boolean(!0)),null==i){i=new h.EmrPrintArgs;let e=o.MGet_Document(0);i.PrtIsHori=null!=e&&e.GetPageFmt().Landscape}let c,g=null,m=null,w=null;if("PrintCurPage"==this.ActName()){let e=l.M_DocumentFocused,t=l.M_PageFocused;m=new p.PageFormat(!0),e.GetPageFmt().TranstoQiPageFmt(m,!1),null!=t&&(w=new u.List,w.Add(t.RelDocPage))}else{let e=l.M_DocumentFocused.GetPageFmt(),t=new a.XPageFmtParams;t.CopyFrom(e),e.Clear(),i.BulidQrCode?(g=o.MCopy_DocumentsWrap(null,new Boolean(r)),this.BulidQrCodeEle(i,g)):g=o.MCopy_DocumentsWrap(new Boolean(!0),new Boolean(r)),d.EmrPrintWrapper.Correct_Docs_PrtDirect(g,i.PrtIsHori);let n=new s.XPageViewBuilder;n.AddXDocWraps(g),n.RebuildFullPageViews(),w=n.GetFullPageList(),e.CopyFrom(t);let u=document.querySelector("#print-pages");u&&u.remove();let h=document.createElement("div");h.className="print-pages",h.id="print-pages",h.style.display="none",setTimeout((function(){for(let e of w){let t=e,n=new C.PageDrawArgs(E.ENumOutTp.CsPrint,0);t.CreatePageCanvas(h),t.Graphic.Resize(796,1125);let r=new A.SolidBrush(new I.Color("rgba(255,255,255,0)")),i=new y.Pen(new I.Color("rgb(0,0,0)"));t.DrawPage1(null,r,i,n)}document.getElementsByTagName("body")[0].appendChild(h);let e=window.innerHeight,t=window.innerWidth;_.LoadingComp.hide(),new S.PreviewPrint1({top:(e-420)/2,left:(t-780)/2,printList:["Microsoft Print to PDF"],list:w,onOk:function(e){l.M_ActionHandler.L_ExecuteCommand("FileSaveAs",[!1,e])},onCancel:function(){let e=document.querySelector("#print-pages");e&&e.remove()}})}))}return null==w||w.Count()<=0?(this.resMsg.MsgLevel=2,this.resMsg.MsgStr="没有可供打印的页面！",c=this.resMsg):(1==n&&this.prtpreview_evthandler.SetPageViewList(w),c=this.resMsg),c}BulidQrCodeEle(e,t){if(e.BulidQrCode&&null!=t&&0!=t.length){let n=g.EmrApiUtil.GetEmrEditWrapperCtrl(super.GetEdtCtrl()).DocWrapper;for(let l=0;l<t.length;l++){let s=t[l];if(null!=s.FirstXDoc){let t=new u.List;s.FirstXDoc.GetPagePanel(o.ENumPagePanelTp.Header).GetChildrenByType("XInputField",!0,t),s.FirstXDoc.GetPagePanel(o.ENumPagePanelTp.Body).GetChildrenByType("XInputField",!0,t),s.FirstXDoc.GetPagePanel(o.ENumPagePanelTp.Footer).GetChildrenByType("XInputField",!0,t);for(let r=0;r<t.Length;r++){let l=t[r];null!=l&&l.InputType==i.EleTypeEnum.QrCodeEle&&l.BulidQrCode(n,e.QrCodeBulidParaDic,!0)}s.FirstXDoc.RefreshLines(!0),r.TextDocApiUtil.M_SetPartEleLayoutValid(s.FirstXDoc,["XBarcodeField"]),s.FirstXDoc.RefreshLines(!0)}}}}}t.BaseA_PrintDoc=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPageViewBuilder=void 0;const r=n(3),i=n(140),l=n(0),s=n(904),o=n(377),a=n(188),u=n(6),h=n(122),d=n(213),c=n(161);class p extends h.XBaseViewBuilder{constructor(){super(),this.xdocBodyWrap=null,this.xdocWrapList=null,this.pageFmtList=null,this.pageHdFtBuilder=null,this.pageBodyBuilder=null,this.gblPageList=null,this.xdocBodyWrap=new s.XDocBodyWrap,this.xdocBodyWrap.EleStyle=c.XEleStyleFactory.CreatXEleStyle(this.xdocBodyWrap.EleTypeName),this.xdocWrapList=new r.List,this.pageFmtList=new r.List,this.pageHdFtBuilder=new h.XPagePanelViewBuilder,this.pageBodyBuilder=new h.XPagePanelViewBuilder,this.gblPageList=new r.List}get XDocWrapCnt(){return this.xdocWrapList.Count()}GetXDocWrapFirstDoc(){let e=[];for(let t of this.xdocWrapList)e.push(t.FirstXDoc);return e}Clear(){this.ClearFullPageList(),this.ClearXDocWrapList()}ClearShallowList(){this.xdocWrapList.Clear(),this.pageFmtList.Clear(),this.gblPageList.Clear()}AddXDocWrap(e,t){if(t&&this.ClearXDocWrapList(),null!=e){this.xdocWrapList.Add(e);let t=new i.PageFormat(!0);this.pageFmtList.Add(t),this._TranstoQiPageFmt(this.xdocWrapList.Get(0).FirstXDoc,t),t.IsStrip=!1,t.IsPunchPaper=!1}}AddXDocWraps(e){this.ClearXDocWrapList();let t=null==e?0:e.length;if(t>0)for(let n=0;n<t;n++)this.AddXDocWrap(e[n],!1)}GetXDocWrapIx(e){if(null==e)return-1;return this.xdocWrapList.FindIndex(0,this.xdocWrapList.Length,t=>t.ContainsXDoc(e))}GetXDocWrap(e){let t=this.xdocWrapList.Count();return t<=0||e<0||e>=t?null:this.xdocWrapList.Get(e)}GetPageFmt(e){return e<0||e>=this.pageFmtList.Count()?null:this.pageFmtList.Get(e)}IsDone(){return this.pageBodyBuilder.IsDone()}Reset(){this.pageHdFtBuilder.Reset(),this.pageBodyBuilder.Reset()}GetFirstPage(){return this.XDocWrapCnt<=0?null:this.xdocWrapList[0].GetFirstPage()}GetFullPageList(){return this.gblPageList.Clear(),this.xdocWrapList.ToArray().forEach(e=>{if(null!=e){let t=e.GetPageList();null!=t&&t.Count()>0&&this.gblPageList.AddRange(t)}}),this.gblPageList.Count(),this.gblPageList}ReplaceFullPageList(e,t){if(e<0)return;if(this.gblPageList.Count()<=0)return void this.gblPageList.AddRange(t);let n=0,r=0,i=!1,l=this.gblPageList.ToArray();for(let t=0;t<l.ToArray().length;t++){if(l[t].DocArgs.DocIx!=e){if(i)break;n++}else i=!0,r++}r<=0?this.gblPageList.AddRange(t):(this.gblPageList.RemoveRange(n,r),this.gblPageList.InsertRange(n,t.ToArray()))}GetPageView(e){if(e<0||e>=this.gblPageList.Count())return null;return this.gblPageList.Get(e).PageView}BuildBlankPage(e){if(null==e)return null;let t=e.GetDocCtxt().ViewMode.IsWebViewMode,n=this._Build_PagePanelView_(e.GetPagePanel(u.ENumPagePanelTp.Header),t),r=this._Build_PagePanelView_(e.GetPagePanel(u.ENumPagePanelTp.Footer),t),i=new l.XPagePanelView(u.ENumPagePanelTp.Body);i.Document=e;let s=new l.XPageView(e);null!=n&&s.AddChildEle(1e3,n),null!=r&&s.AddChildEle(1e3,r),s.AddChildEle(1e3,i);let o=this.GetPageView(0);if(null!=o){let e=o.DocArgs;s.DocArgs=e}else s.DocArgs=new a.DocInfoArgs(a.ENumDocTp.EmrDoc),s.DocArgs.DocIx=0,s.DocArgs.DocName=e.DocName;return s.PageIx=0,s.LocalPageIx=0,this.WrapPageView(s)}RebuildFullPageViews(){if(this.ClearFullPageList(),0==this.xdocWrapList.Count())return;let e=0,t=new d.NumberWrapper(0),n=this.xdocWrapList.Get(0).FirstXDoc;null!=n&&null!=n.FirstDocStartPageNum&&(t=new d.NumberWrapper(n.FirstDocStartPageNum));for(let n=0;n<this.xdocWrapList.Length;n++){let r=this.xdocWrapList.Get(n);r.Backup_XDocChanged(),r.ReCalcPagePanelPos();let i=this._Build_PageViewList_(r,e,t);r.Restore_XDocChanged(),r.SetVariable_PagesCnt(!0,i),e++}this.GetFullPageList(),this.ResetGolalPageNum()}RebuildXDoc(e){this.xdocWrapList.Get(this.xdocWrapList.Length-1).addTextDocument(e)}ResetGolalPageNum(){let e=0,t=[];for(let n of this.xdocWrapList){if(n.FirstXDoc.IsAssociatPageIndex&&t.length>0){for(let n=0;n<t.length;n++){t[n].SetVariable_PagesCnt(!1,e)}e=0,t=[]}e+=n.GetPageList().Count(),t.push(n)}if(t.length>0){for(let n=0;n<t.length;n++){t[n].SetVariable_PagesCnt(!1,e)}e=0,t=[]}}CloseDocByIndex(e){if(this.IsSingleXdocList()){this.xdocWrapList.Get(0).CloseDocWithIndex(e)}else for(let t of this.xdocWrapList)t.FirstXDoc.DocID==e&&this.xdocWrapList.Remove(t)}IsSingleXdocList(){let e=this.xdocWrapList.Count();return!(e>1||0==e)}RebuildXDocPageView(e){let t=this.GetXDocWrap(e),n=this.GetXDocWrap(e-1),r=null==t?null:t.GetFirstPage();if(null==r)return;let i=new d.NumberWrapper(r.PageIx);null!=n&&(i=new d.NumberWrapper(n.GetLastPage().PageIx+1)),t.FirstXDoc.IsAssociatPageIndex&&(i=new d.NumberWrapper(0));let l=t.Backup_XDocChanged(),s=this._Build_PageViewList_(t,e,i);t.Restore_XDocChanged(),t.SetVariable_PagesCnt(!0,s),this.ReplaceFullPageList(e,t.GetPageList()),this.ResetGolalPageNum();let o=!1;if(null!=l&&l.length>0)for(let e=0;e<l.length;e++)l[e]&&(o=!0);return o}_Build_PageViewList_(e,t,n){e.ClearPageList();let r=e.FirstXDoc;if(null==r)return 0;let i=new a.DocInfoArgs(a.ENumDocTp.EmrDoc);i.DocIx=t,i.DocName=r.DocName,i.FromPageIx=n.Value;let s=r.GetDocCtxt().ViewMode.IsWebViewMode;this.xdocBodyWrap.FillFromXDocsWrap(e),this.pageBodyBuilder.Reset(),this.pageBodyBuilder.SrcEle=this.xdocBodyWrap;let o=null,h=r.FirstDocStartPageNum,d=0==t&&null!=h?h:0;for(;!this.IsDone();){let t=this.xdocBodyWrap.LinesList.Get(this.pageBodyBuilder.FromLineXDomIx).ChildEleList.Get(0).Document,a=new l.XPageView(t),h=this._Build_PagePanelView_(t.GetPagePanel(u.ENumPagePanelTp.Header),s);null!=h&&a.AddChildEle(1e3,h);let c=this._Build_PagePanelView_(t.GetPagePanel(u.ENumPagePanelTp.Footer),s);null!=c&&a.AddChildEle(1e3,c),this.xdocBodyWrap.UpdateBounds(t.GetPagePanel(u.ENumPagePanelTp.Body)),this.pageBodyBuilder.Document=t,a.DocArgs=i,a.PageIx=n.Value,a.LocalPageIx=d,a.PrevPage=o;let p=this._Build_PageBodyView_(a,this.xdocBodyWrap);if(null==p)break;let f=p.LinesList;for(let e of f){this.__FindRelCmmts_(r,e,a);for(let t of e.ChildEleList)if(t instanceof l.XTextTable)for(let e of t.Rows)for(let t of e.Cells)for(let e of t.LinesList)this.__FindRelCmmts_(r,e,a)}let g=this.WrapPageView(a);g.IsSingleXDoc=this.IsSingleXDocMode(),e.AddPage(g),o=a,d++,n.Value=n.Value+1}return i.PagesCnt=d,this._RebuildPageCmmtLines(e,t),this.Reset(),d}_Build_PageBodyView_(e,t){let n=this.pageBodyBuilder.FromLineXDomIx;e.FromLineIx=n;let r=this._Build_PagePanelView_(t,!1);return null==r||r.LinesCnt<=0?null:(null!=r&&e.AddChildEle(1e3,r),this._RefreshSubLinesOwnerPageView(r,e),r)}_Build_PagePanelView_(e,t){if(null==e)return null;let n=e.PagePanelTp,r=this._GetPagePanelBuilder(n,t);if(null==r)return null;null!=r.SrcEle&&n!=u.ENumPagePanelTp.Header&&n!=u.ENumPagePanelTp.Footer||(r.Reset(),r.SrcEle=e);let i=e.Bounds.Clone(),l=e.GetValidHeight(300),s=e.GetValidWidth(300);if(n==u.ENumPagePanelTp.Body&&(i.Height=l),s<0)return null;if(l<0)return null;let o=r.BuildPanelView(i);return null!=o&&o.CalcSizeByLines(),o}_GetPagePanelBuilder(e,t){let n=null;switch(e){case u.ENumPagePanelTp.Header:case u.ENumPagePanelTp.Footer:n=t?null:this.pageHdFtBuilder;break;case u.ENumPagePanelTp.Body:n=this.pageBodyBuilder}return n}__FindRelCmmts_(e,t,n){if(null!=t&&t.ElementCnt>0){let r=e.GetPagePanel(u.ENumPagePanelTp.CmmtBar).GetLastChildEle();if(r instanceof l.XCommentEle){r.IsRelLineEleFromToValid()?this.__AddCmmts_OnPageRebuild(e,t,n):this.__AddCmmts_OnPageBuild1st(e,t,n)}}}__AddCmmts_OnPageBuild1st(e,t,n){let r=e.GetPagePanel(u.ENumPagePanelTp.CmmtBar),i=t.Index,s=r.GetChildIter();for(;s.MoveNext();){let e,r,o=s.Current;if(o instanceof l.XCommentEle){if(null==o.RelLineEleFrom||null==o.RelLineEleTo)e=o.GetRelEleInx(!0).AtLineIx;else{let t=o.RangList;for(let n=0;n<t.Length;n++)if(t.Get(n).OwnerLine&&t.Get(n).OwnerLine.ChildEleList.Count()>0){e=t.Get(n).OwnerLineInx,o.RelLineEleFrom=t.Get(n);break}}if(e>i)break;if(null==o.RelLineEleTo||null==o.RelLineEleFrom)r=o.GetRelEleInx(!1).AtLineIx;else{let e=o.RangList;for(let t=e.Length-1;t>=0;t--)if(e.Get(t).OwnerLine&&e.Get(t).OwnerLine.ChildEleList.Count()>0){r=e.Get(t).OwnerLineInx,o.RelLineEleTo=e.Get(t);break}}if(r<0||r>=i){let e=t.GetElesIter();for(;e.MoveNext();){let t=e.Current;if(o.TrySetRelFromEle(t)&&n.AddComment(o,!1),o.TrySetRelToEle(t))break}}}}}__AddCmmts_OnPageRebuild(e,t,n){let r=e.GetPagePanel(u.ENumPagePanelTp.CmmtBar),i=t.Index,s=r.GetChildIter();for(;s.MoveNext();){let e,r,o=s.Current;if(o instanceof l.XCommentEle){if(null==o.RelLineEleFrom||null==o.RelLineEleTo)e=o.GetRelEleInx(!0).AtLineIx;else{let t=o.RangList;for(let n=0;n<t.Length;n++)if(t.Get(n).OwnerLine&&t.Get(n).OwnerLine.ChildEleList.Count()>0){e=t.Get(n).OwnerLineInx,o.RelLineEleFrom=t.Get(n);break}}if(e>i)break;if(null==o.RelLineEleTo||null==o.RelLineEleFrom)r=o.GetRelEleInx(!1).AtLineIx;else{let e=o.RangList;for(let t=e.Length-1;t>=0;t--)if(e.Get(t).OwnerLine&&e.Get(t).OwnerLine.ChildEleList.Count()>0){r=e.Get(t).OwnerLineInx,o.RelLineEleTo=e.Get(t);break}}if(r<0||r>=i){t.IndexOfElement(o.RelLineEleFrom)>=0&&n.AddComment(o,!1)}}}}_RebuildPageCmmtLines(e,t){let n=e.FirstXDoc;this.GetPageFmt(t).ShowCmmtArea=n.GetPageFmt().ShowCmmtArea}IsSingleXDocMode(){let e=this.xdocWrapList.Count();return!(e>1)&&(0==e||this.xdocWrapList.Get(0).XDocsCnt<=1)}ClearXDocWrapList(){this.xdocWrapList.ToArray().forEach(e=>{e.ResetVariable_PagesCnt(!0),e.Clear()}),this.ClearShallowList()}ClearFullPageList(){this.xdocWrapList.ToArray().forEach(e=>{e.ClearPageList()}),this.gblPageList.Clear()}WrapPageView(e){if(null==e)return null;let t=new o.XPageViewPainter(e),n=e.DocArgs.DocIx,r=this.GetPageFmt(n);if(null==r){r=new i.PageFormat(!0),e.Document.GetPageFmt().TranstoQiPageFmt(r,!1)}return t.PageFormat=r,t}_TranstoQiPageFmt(e,t){let n=null==e?null:e.GetPageFmt();if(null!=n){let r=e.GetDocCtxt().ViewMode.IsWebViewMode;n.TranstoQiPageFmt(t,r)}}_RefreshSubLinesOwnerPageView(e,t){if(null!=e){let n=e.GetLinesIter();for(;n.MoveNext();){let e=n.Current;e.PageView=t;let r=e.GetElesIter();for(;r.MoveNext();){let e=r.Current;e instanceof l.XBaseContainer&&this._RefreshSubLinesOwnerPageView(e,t)}}}}}t.XPageViewBuilder=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLocation=void 0;const r=n(21),i=n(8),l=n(149);t.CLocation=class{constructor(e,t){this.pos_x_mm=0,this.pos_y_mm=0,this.conv=null,this.conv=new l.MeasureConverter,this.pos_x_mm=e,this.pos_y_mm=t}correctNegtiveLocation(){this.pos_x_mm<0&&(this.pos_x_mm=0),this.pos_y_mm<0&&(this.pos_y_mm=0)}copyFrom(e){null!=e&&(this.pos_x_mm=e.pos_x_mm,this.pos_y_mm=e.pos_y_mm)}addLocationByAnother(e){null!=e&&(this.pos_x_mm+=e.pos_x_mm,this.pos_y_mm+=e.pos_y_mm)}addLocationBySize(e){null!=e&&(this.pos_x_mm+=e.getWidthAsMM(),this.pos_y_mm+=e.getHeightAsMM())}get XAsMM(){return this.pos_x_mm}get YAsMM(){return this.pos_y_mm}set XAsMM(e){this.pos_x_mm=e}set YAsMM(e){this.pos_y_mm=e}setLocationAsMM(e,t){this.pos_x_mm=e,this.pos_y_mm=t}addLocationAsMM(e,t){this.pos_x_mm+=e,this.pos_y_mm+=t}getXAsPX(e){return this.conv.ConvMmToPx(this.pos_x_mm,e)}getYAsPX(e){return this.conv.ConvMmToPx(this.pos_y_mm,e)}setXAsPX(e,t){this.pos_x_mm=this.conv.ConvPxToMm(e,t)}setYAsPX(e,t){this.pos_y_mm=this.conv.ConvPxToMm(e,t)}setLocationAsPX(e,t,n){this.pos_x_mm=this.conv.ConvPxToMm(e,n),this.pos_y_mm=this.conv.ConvPxToMm(t,n)}addLocationAsPX(e,t,n){e=this.conv.ConvPxToMm(e,n),t=this.conv.ConvPxToMm(t,n),this.pos_x_mm+=e,this.pos_y_mm+=t}zoomLocation(e){e>0&&1!=e&&(this.pos_x_mm*=e,this.pos_y_mm*=e)}transToPoint(e,t){e.X=this.conv.ConvMmToPx(this.pos_x_mm,t),e.Y=this.conv.ConvMmToPx(this.pos_y_mm,t)}transToPointF(e,t){e.X=this.conv.ConvMmToPx(this.pos_x_mm,t),e.Y=this.conv.ConvMmToPx(this.pos_y_mm,t)}isEqual(e){return this==e||i.CNumUtil.IsEqual(this.pos_x_mm,e.pos_x_mm,.01)&&i.CNumUtil.IsEqual(this.pos_y_mm,e.pos_y_mm,.01)}ToString(){let e=new r.default;e.append("QiLocation ("),e.append(this.pos_x_mm+""),e.append(", "),e.append(this.pos_y_mm+""),e.append(")");let t=e.toString();return e.setLengthToZero(),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCommentArea=void 0;const r=n(27),i=n(926);class l extends r.BaseControl{constructor(e){super(e.dom,e),e.dom.id="pangoEditor-Commentpage"+e.PageIndex,e.dom.className="pangoEditor-Commentpage",null==this._XCommentAreaComp?this._XCommentAreaComp=new i.XCommentAreaComp(e.dom,this.InitProps):this._XCommentAreaComp.updateProps(e)}upDateCommentList(e){this._XCommentAreaComp.React.upDateCommentList(e)}GetValidateHeight(){this._XCommentAreaComp.React.GetValidateHeight()}DefaultProps(){return{PageIndex:0}}}t.XCommentArea=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageInnPoint=void 0;const r=n(385),i=n(247);t.PageInnPoint=class{constructor(){this.pageIx=-1,this.posInPage=new i.CLocation(-1,-1),this.lineLen=new r.CLength(-1)}get PageIx(){return this.pageIx}set PageIx(e){this.pageIx=e}get PosInPage(){return this.posInPage}get LineLen(){return this.lineLen}Reset(){this.pageIx=-1,this.posInPage.setLocationAsMM(-1,-1),this.lineLen.setLengthAsMM(-1)}IsValid(){return this.pageIx>=0}copyFrom(e,t){null!=e&&(e.IsValid()?(this.pageIx=e.pageIx,this.posInPage.copyFrom(e.posInPage),this.lineLen.copyFrom(e.lineLen),t>0&&1!=t&&this.posInPage.zoomLocation(1/t)):this.Reset())}IsEqualPot(e){let t;if(this==e||null==e)t=!1;else if(this.pageIx!=e.pageIx)t=!1;else{let n=this.posInPage.YAsMM-e.posInPage.YAsMM;n<-.1||n>.1?t=!1:(n=this.posInPage.XAsMM-e.posInPage.XAsMM,t=n>=-.1&&n<=.1)}return t}ToString(){let e;if(this.IsValid()){e="第"+this.pageIx+"页 "+this.posInPage+", 辅助坐标: "+this.lineLen}else e="[Not Valid]";return e}}},function(e,t,n){"use strict";(function(t){var r=n(61),i=n(958),l=n(392),s={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(a=n(393)),a),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(o(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(t||JSON.parse)(e),r.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,s=!n&&"json"===this.responseType;if(s||i&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(s){if("SyntaxError"===e.name)throw l(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){u.headers[e]=r.merge(s)})),e.exports=u}).call(this,n(957))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ZoomBase=void 0;const r=n(37),i=n(8),l=n(1);class s extends l.XBaseAction{constructor(){super(...arguments),this.ZmIO_Step=r.TextDocApiConst.ZoomStep}Execute(e){let t;if(this.resMsg.Clear(),null==e||e.length<1)this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",super.MessageWarn(),t=this.resMsg;else{let n=super.GetEdtCtrl(),r=e[0],i=n.MGetPageViewList();for(let e of i)e.PageView.RelDocPage.IsInvalidate=!0;null==r&&(r=new String("100%")),"string"==typeof r?this._Set_StrPct(r,n):this._ZoomInOut_(r,n),t=this.resMsg}return t}_Set_StrPct(e,t){let n=i.CNumUtil.TryParsePct(e,1);t.MSetZoomRatio(n,!0)}_ZoomInOut_(e,t){let n=t.MGetZoomRatio();n+=e?this.ZmIO_Step:-this.ZmIO_Step,n=this._LimitZoomRatio(n),t.MSetZoomRatio(n,!0)}_LimitZoomRatio(e){let t;return t=e<r.TextDocApiConst.MinZoomRatio?r.TextDocApiConst.MinZoomRatio:e>r.TextDocApiConst.MaxZoomRatio?r.TextDocApiConst.MaxZoomRatio:e,t}}t.A_ZoomBase=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeLineSelRangeLayer=void 0;const r=n(69),i=n(132),l=n(0),s=n(29),o=n(2),a=n(6);class u extends r.AbstractHandlerLayer{constructor(e){super(e),this.selRange=null,this.initSelEleIx=null,this.paeleInitSel=null,this.paeleMOver=null,this.wakeByShiftClick=!1,this.initSelEleIx=new i.XLineEleIx}CanWakeBySrc(e,t){this.wakeByShiftClick=!1;let n=t==o.ENumEvtSrc.MOUSE_DRAG,r=!1;return n?r=!0:(n=(e&s.Keys.Shift)==s.Keys.Shift&&t==o.ENumEvtSrc.MOUSE_LPRESS,n?(this.wakeByShiftClick=!0,r=!0):r=!1),r}TryWake(e,t){let n=!1;if(this.isWaken)n=!0;else{this.selRange=this.eleEvtModel.SelRange;let e=this.selRange.InitSelEle;if(null==e)n=!1;else{let t=(this.wakeByShiftClick?this.eleEvtModel.EleClickedWrap:this.eleEvtModel.EleMOverWrap).EleFocused;null==t?n=!1:(this.initSelEleIx.SetEle(e),this.paeleInitSel=l.XDomUtil.GetLineContainer(e),this.paeleMOver=l.XDomUtil.GetLineContainer(t),this._CanSelSpanContainer(this.paeleInitSel,this.paeleMOver)?(this.isWaken=!0,n=!0):n=!1)}}return n}Handle(e,t,n){let r=this.selRange.InitSelEle,i=this.paeleInitSel instanceof l.XTextTableCell?this.paeleInitSel:null,s=this.paeleMOver instanceof l.XTextTableCell?this.paeleMOver:null;s!=i||r instanceof l.XTextTableCell||(s=i=null),null==s?this._HandleEndWithCommLine(i):this._HandleEndWithTableLine(i,s),this.isWaken=!1}_CanSelSpanContainer(e,t){let n=!1;if(null==e||null==t)n=!1;else if(e==t)n=!0;else{let r=e.OwnerDocPanel,i=t.OwnerDocPanel;n=this.__CanSelSpanDocPanel(r,i)}return n}__CanSelSpanDocPanel(e,t){return e==t||e.PagePanelTp==a.ENumPagePanelTp.Body&&t.PagePanelTp==a.ENumPagePanelTp.Body}_HandleEndWithCommLine(e){let t=this.wakeByShiftClick?this.eleEvtModel.EleClickedWrap:this.eleEvtModel.EleMOverWrap,n=t.EleFocused;if(n instanceof l.XParagraphFlag&&t.LineEleIxFocused.AtRightHalf&&(n.Parent instanceof l.XTextTableCell||(n=t.GetNextEle(!0),(null==n||n instanceof l.XTextTable)&&(n=t.EleFocused))),this.eleEvtModel.SelRangeAct.Execute([e,n]),!this.wakeByShiftClick){this.eleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(n)}}_HandleEndWithTableLine(e,t){let n=!1;this.selRange.InitSelEle instanceof l.XTextTableCell||null==e||(n=!0),n?this.eleEvtModel.SelRangeAct.Execute([e,t]):this.eleEvtModel.SelRangeAct.Execute([null,t])}}t.ChangeLineSelRangeLayer=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ImportDoc=void 0;const r=n(2),i=n(70),l=n(6),s=n(1),o=n(732),a=n(359);class u extends s.XBaseAction{constructor(e){super(e),this.xdocLoadParam=null,super.OpType=r.ENumActOpType.CtntEdit,this.xdocLoadParam=new i.XDocLoadParam(null,r.ENumXDocPath.LocalFile)}ActName(){return"FileImport"}Execute(e){this.resMsg.Clear();let t=null==e?0:e.length,n=t<=0?null:e[0];"string"!=typeof n&&(n=null);let r,i=t<=0?null:e[1],l=super.GetEdtCtrl(),s=[{cancel:"Undo",title:"撤销"},{recover:"Redo",title:"恢复"},{cut:"Cut",title:"剪切"},{copy:"Copy",title:"复制"},{paste:"Paste",title:"粘贴"},{delete:"RemoveCurrentEmptyLine",title:"删除空行"},{clear:"FormatBrush",title:"格式刷",switch:!0},{"|":""},{fontName:"",title:"字体"},{fontSize:"",title:"字号"},{"|":""},{bold:"SetFontBold",title:"加粗",switch:!0},{italic:"SetFontItalic",title:"斜体",switch:!0},{underline:"SetTextUnderline",title:"下划线",switch:!0},{strikeThrough:"SetFontStrikeout",title:"删除线",switch:!0},{fontcolor:"SetForeColor",title:"文本颜色"},{textcolor:"SetBkgColor",title:"背景色"},{"|":""},{left:"SetAlignLeft",title:"左对齐",group:"AlginStyleGroup",switch:!0},{center:"SetAlignCenter",title:"居中对齐",group:"AlginStyleGroup",switch:!0},{right:"SetAlignRight",title:"右对齐",group:"AlginStyleGroup",switch:!0},{paragraph:"SetParagraphStyle",title:"段落",paramsVal:!0},{lineHeight:"",title:"行高设置"},{"|":""},{spechars:"InsertChar",title:"特殊字符"},{superscript:"SetSuperscript",title:"上标",group:"SupSubGroup",switch:!0},{subscript:"SetSubscript",title:"下标",group:"SupSubGroup",switch:!0},{expressioncheck:"",title:"文档校验"},{insertpic:"InsertImage",title:"插入图片"},{"|":""},{insertform:"CreateTextTable",title:"插入表格"},{insertformtop:"TextTableInsertRow_Top",title:"上方插入行"},{insertformbottom:"TextTableInsertRow_Bottom",title:"下方插入行"},{insertformleft:"TextTableInsertColumn_Left",title:"左方插入列"},{insertformright:"TextTableInsertColumn_Right",title:"右方插入列"},{deleteformrow:"TextTableDeleteRow",title:"删除表格行"}],u=[];if(i&&i.toolbarConfig){let e=i.toolbarConfig;if(e)for(let t=0;t<s.length;t++){let n=Object.keys(s[t]);for(var h=0;h<e.length;h++)if(n.indexOf(e[h])>-1){u.push(s[t]);break}}}else u=s;l.toolbar=new o.Toolbar(l.ContainerDOM.querySelector("#pango-editor-toolbar"),u,null,l),0==u.length?l.ContainerDOM.querySelector("#pango-editor-toolbar").style.display="none":l.ContainerDOM.querySelector("#pango-editor-toolbar").style.display="block";try{this.xdocLoadParam.SrcStr=n,this.xdocLoadParam.PatientInfo=a.PatientInfo.ParseObject(i?i.patient:null),this.xdocLoadParam.ShowIcon=!!i&&i.showIcon;let e=l.MLoadXmlDocument(this.xdocLoadParam);this._labelEleCreatInner(e)}catch(e){l.M_EdtCustomEvtGrp.OpenError&&l.M_EdtCustomEvtGrp.OpenError(),this.resMsg.Ex=e}return r=this.resMsg,r}_labelEleCreatInner(e){const t=e.GetPagePanel(l.ENumPagePanelTp.Body);if(t.ChildCount>0)for(let e=0;e<t.ChildEleList.Count();e++){t.ChildEleList.Get(e)}}}t.A_ImportDoc=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(31);Array.prototype.All=function(e){return r.Enumerable.All(this,e)},Array.prototype.Any=function(e){return r.Enumerable.Any(this,e)},Array.prototype.AsEnumerable=function(){return r.Enumerable.AsEnumerable(this)},Array.prototype.Average=function(e){return r.Enumerable.Average(this,e)},Array.prototype.Concat=function(e){return r.Enumerable.Concat(this,e)},Array.prototype.Contains=function(e,t){return r.Enumerable.Contains(this,e,t)},Array.prototype.Count=function(e){return r.Enumerable.Count(this,e)},Array.prototype.DefaultIfEmpty=function(e){return r.Enumerable.DefaultIfEmpty(this,e)},Array.prototype.Distinct=function(e){return r.Enumerable.Distinct(this,e)},Array.prototype.ElementAt=function(e){return r.Enumerable.ElementAt(this,e)},Array.prototype.ElementAtOrDefault=function(e,t){return r.Enumerable.ElementAtOrDefault(this,e,t)},Array.prototype.Except=function(e,t){return r.Enumerable.Except(this,e,t)},Array.prototype.First=function(e){return r.Enumerable.First(this,e)},Array.prototype.FirstOrDefault=function(e,t){return r.Enumerable.FirstOrDefaultWithArray(this,e,t)},Array.prototype.GroupBy=function(e,t,n){return r.Enumerable.GroupBy(this,e,t,n)},Array.prototype.GroupJoin=function(e,t,n,i,l){return r.Enumerable.GroupJoin(this,e,t,n,i,l)},Array.prototype.Intersect=function(e,t){return r.Enumerable.Intersect(this,e,t)},Array.prototype.Join=function(e,t,n,i,l){return r.Enumerable.Join(this,e,t,n,i,l)},Array.prototype.Last=function(e){return r.Enumerable.Last(this,e)},Array.prototype.LastOrDefault=function(e,t){return r.Enumerable.LastOrDefault(this,e,t)},Array.prototype.Max=function(e){return r.Enumerable.Max(this,e)},Array.prototype.Min=function(e){return r.Enumerable.Min(this,e)},Array.prototype.Reverse=function(){return r.Enumerable.Reverse(this)},Array.prototype.Select=function(e){return r.Enumerable.Select(this,e)},Array.prototype.SelectMany=function(e,t){return r.Enumerable.SelectMany(this,e,t)},Array.prototype.SequenceEqual=function(e,t){return r.Enumerable.SequenceEqual(this,e,t)},Array.prototype.Single=function(e){return r.Enumerable.Single(this,e)},Array.prototype.SingleOrDefault=function(e,t){return r.Enumerable.SingleOrDefault(this,e,t)},Array.prototype.Skip=function(e){return r.Enumerable.Skip(this,e)},Array.prototype.SkipWhile=function(e){return r.Enumerable.SkipWhile(this,e)},Array.prototype.Sum=function(e){return r.Enumerable.Sum(this,e)},Array.prototype.Take=function(e){return r.Enumerable.Take(this,e)},Array.prototype.TakeWhile=function(e){return r.Enumerable.TakeWhile(this,e)},Array.prototype.ToArray=function(){return r.Enumerable.ToArray(this)},Array.prototype.ToDictionary=function(e,t,n){return r.Enumerable.ToDictionary(this,e,t,n)},Array.prototype.ToList=function(){return r.Enumerable.ToList(this)},Array.prototype.Union=function(e,t){return r.Enumerable.Union(this,e,t)},Array.prototype.Where=function(e){return r.Enumerable.Where(this,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsNull=void 0,t.IsNull=function(e){return null===e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsUndefined=void 0,t.IsUndefined=function(e){return void 0===e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firstOrDefaultWithArray=t.firstOrDefault=void 0;const r=n(15);t.firstOrDefault=function(e,t,n){r.throws.ThrowIfNull("source",e);for(let t of e){if(!n)return t;if(n(t))return t}return t},t.firstOrDefaultWithArray=function(e,t,n){if(n){for(let t=0;t<e.length;t++)if(n(e[t]))return e[t];return t}return e.length>0?e[0]:t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IEnumerator=void 0;t.IEnumerator=class{constructor(e){this.list=null,this.index=-1,this.list=e}get Current(){return this.index>this.list.Count()-1?null:this.list.Get(this.index)}MoveNext(){return this.index=this.index+1,this.index<this.list.Count()}Reset(){this.index=-1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModeObj=void 0;const r=n(2);t.ViewModeObj=class{constructor(){this.viewMode=r.ENumViewMode.Init}get IsCleanViewMode(){return r.ENumViewMode.CleanView==(this.viewMode&r.ENumViewMode.CleanView)}set IsCleanViewMode(e){e?this.viewMode|=r.ENumViewMode.CleanView:this.viewMode&=r.ENumViewMode.CleanView}get IsWebViewMode(){return r.ENumViewMode.WebView==(this.viewMode&r.ENumViewMode.WebView)}set IsWebViewMode(e){e?this.viewMode|=r.ENumViewMode.WebView:this.viewMode&=r.ENumViewMode.WebView}Reset(){this.viewMode=r.ENumViewMode.Init}CopyFrom(e){this.viewMode=e.viewMode}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPageFmtParams=void 0;const r=n(82),i=n(10),l=n(11),s=n(484),o=n(14),a=n(8),u=n(115),h=n(4);class d{constructor(){this.paperKind="A4",this.width=827,this.initWidth=827,this._isAdaptive=!1,this.height=1169,this.initHeight=1169,this.gutterSide="Left",this.initGutterSide="Left",this.showCmmtArea=!1,this.landscape=!1,this.initLandscape=!1,this.paperFeedHoriz=!1,this.initPaperFeedHoriz=null,this.pageMargin=r.Padding.Empty,this.gutterMargin=0,this.initGutterMargin=0,this.headTopMargin=19.69,this.initHeadTopMargin=19.69,this.footBtmMargin=19.69,this.initFootBtmMargin=19.69,this._initIsShowHeadSptLine=!1,this._IsShowHeadSptLine=!1,this._IsShowFooterSptLine=!1,this._initIsShowFooterSptLine=!1,this.ResetPageMargin()}get PaperKind(){return this.paperKind}set PaperKind(e){this.paperKind=e}get Width(){return this.width}set Width(e){this.width=e}get IsAdaptive(){return this._isAdaptive}set IsAdaptive(e){this._isAdaptive=e}get Height(){return this.height}set Height(e){this.height=e}get WorkModePaperKind(){return this._WorkModePaperKind}set WorkModePaperKind(e){this._WorkModePaperKind=e}get WorkModeWidth(){return this._WorkModeWidth}set WorkModeWidth(e){this._WorkModeWidth=e}get WorkModeHeight(){return this._WorkModeHeight}set WorkModeHeight(e){this._WorkModeHeight=e}get PrtPaperKind(){return this._PrtPaperKind}set PrtPaperKind(e){this._PrtPaperKind=e}get PrtPaperWidth(){return this._PrtPaperWidth}set PrtPaperWidth(e){this._PrtPaperWidth=e}get PrtPaperHeight(){return this._PrtPaperHeight}set PrtPaperHeight(e){this._PrtPaperHeight=e}get IsZoomPaperPrt(){return this._isZoomPaperPrt}set IsZoomPaperPrt(e){this._isZoomPaperPrt=e}get GutterSide(){return this.gutterSide}set GutterSide(e){this.gutterSide=e}get ShowCmmtArea(){return this.showCmmtArea}set ShowCmmtArea(e){this.showCmmtArea=e}get Landscape(){return this.landscape}set Landscape(e){this.landscape=e}get PaperFeedHoriz(){return this.paperFeedHoriz}set PaperFeedHoriz(e){this.paperFeedHoriz=e}get PagePadd(){return this.pageMargin}set PagePadd(e){this.pageMargin=e}get GutterMargin(){return this.gutterMargin}set GutterMargin(e){this.gutterMargin=e}get HeadTopMargin(){return this.headTopMargin}set HeadTopMargin(e){this.headTopMargin=e}get FootBtmMargin(){return this.footBtmMargin}set FootBtmMargin(e){this.footBtmMargin=e}get IsShowHeadSptLine(){return this.IsAdaptive?this._initIsShowHeadSptLine:this._IsShowHeadSptLine}set IsShowHeadSptLine(e){this._IsShowHeadSptLine=e}get IsShowFooterSptLine(){return this.IsAdaptive?this._initIsShowFooterSptLine:this._IsShowFooterSptLine}set IsShowFooterSptLine(e){this._IsShowFooterSptLine=e}Clear(){this.paperKind="A4",this.width=827,this.height=1169,this.landscape=!1,this.paperFeedHoriz=null,this.gutterSide="Left",this.gutterMargin=0,this.ResetPageMargin()}ResetPageMargin(){this.pageMargin.Left=d.Default_PPMargin.Left,this.pageMargin.Top=d.Default_PPMargin.Top,this.pageMargin.Right=d.Default_PPMargin.Right,this.pageMargin.Bottom=d.Default_PPMargin.Bottom,this.headTopMargin=d.Default_HeadTopMargin,this.footBtmMargin=d.Default_HeadTopMargin,this.gutterSide="Left",this.gutterMargin=0}GetWidthDPI(e){return i.DPITransUtil.TransFloatVal(this.width,100,e)}GetHeightDPI(e){return i.DPITransUtil.TransFloatVal(this.height,100,e)}GetValidWidthDPI(e){let t=this.width-this.pageMargin.Left-this.pageMargin.Right;this.gutterMargin>0&&"Left"==this.gutterSide&&(t-=this.gutterMargin);return i.DPITransUtil.TransFloatVal(t,100,e)}GetValidHeightDPI(e){let t=this.height-this.pageMargin.Top-this.pageMargin.Bottom;return this.gutterMargin>0&&"Top"==this.gutterSide&&(t-=this.gutterMargin),i.DPITransUtil.TransFloatVal(t,100,e)}GetValidHeightDPI2(e){let t=this.height-this.pageMargin.Top-this.pageMargin.Bottom;return t=t-this.headTopMargin-this.footBtmMargin,this.gutterMargin>0&&"Top"==this.gutterSide&&(t-=this.gutterMargin),i.DPITransUtil.TransFloatVal(t,100,e)}GetGutterMarginDPI(e){return i.DPITransUtil.TransFloatVal(this.gutterMargin,100,e)}GetPagePaddWithGutter(){let e=this.PagePadd.Clone(),t=parseInt(this.gutterMargin+.5+"");if(this.gutterMargin>0){let n=this.gutterSide;null!=n&&("Top"!=n?"Left"==n&&(e.Left+=t):e.Top+=t)}return e}SetHeadFootPadd(e,t,n){let r,i=1;n>0&&100!=n&&(i=100/n),e>=0&&(r=i*e,r=Math.round(100*r)/100,this.headTopMargin=r),t>=0&&(r=i*t,r=Math.round(100*r)/100,this.footBtmMargin=r)}SetPagePadd(e,t,n,r,i){let l=1;i>0&&100!=i&&(l=100/i),null!=e&&(this.pageMargin.Left=Math.round(l*e+.5)),null!=t&&(this.pageMargin.Top=Math.round(l*t+.5)),null!=n&&(this.pageMargin.Right=Math.round(l*n+.5)),null!=r&&(this.pageMargin.Bottom=Math.round(l*r+.5))}SetGutterMargin(e,t){this.gutterMargin=i.DPITransUtil.TransFloatVal(e,t,100)}ReverseShowCmmtArea(){this.showCmmtArea=!this.showCmmtArea}CopyFrom(e){this.paperKind=e.paperKind,this.width=e.width,this.height=e.height,this.landscape=e.landscape,this.paperFeedHoriz=e.paperFeedHoriz,this.pageMargin=e.pageMargin,this.headTopMargin=e.headTopMargin,this.footBtmMargin=e.footBtmMargin,this.gutterSide=e.gutterSide,this.gutterMargin=e.gutterMargin,this.showCmmtArea=!1,this.IsShowHeadSptLine=e.IsShowHeadSptLine,this.IsShowFooterSptLine=e.IsShowFooterSptLine}TranstoQiPageFmt(e,t){if(null==e)return;if(e.Landscape=this.Landscape,e.PaperFeedHoriz=this.PaperFeedHoriz,t)return this._TranstoQiPageFmt_WebView(e),null;let n=this.PagePadd.Clone();if(n.Top=parseInt(this.headTopMargin+.5+""),n.Bottom=parseInt(this.footBtmMargin+.5+""),this.gutterMargin>0){u.GutterSideVals.ToENumVal(this.gutterSide)!=l.ENumGutterSide.TOP?n.Left+=this.gutterMargin+.5:n.Top+=this.gutterMargin+.5}e.SetPadding(n,96);let r=this.Width,i=this.Height,o=s.StandardPapers.GetInstance().GetStdPaperSz2(25.4*r/100,25.4*i/100);if(null!=o){let t=o.getPrtPaperCalcSize();e.SetSize(t.getWidthAsPX(96),t.getHeightAsPX(96),96),e.PpSzNo=o.getPrtPaperName()}else e.SetSize(r,i,100),e.PpSzNo="CustomQI"}_TranstoQiPageFmt_WebView(e){e.SetPadding(r.Padding.Empty,-1);let t=this.GetValidWidthDPI(100),n=this.GetValidHeightDPI(100);e.SetSize(t+5+10,n,100),e.PpSzNo="CustomQI"}ToXML(e){let t=e.createElement("PageSettings");if("A4"!=this.paperKind||this.WorkModePaperKind&&"A4"!=this.WorkModePaperKind){let n=e.createElement("PaperKind");n.textContent=this.WorkModePaperKind?this.WorkModePaperKind:this.paperKind,t.appendChild(n)}if(null!=this.PrtPaperKind){let n=e.createElement("PrtPaperKind");n.textContent=this.PrtPaperKind,t.appendChild(n)}if(null!=this.PrtPaperWidth||null!=this._PrtPaperHeight){let n=e.createElement("PrtPaperWidth");n.textContent=this.PrtPaperWidth.toString(),t.appendChild(n),n=e.createElement("PrtPaperHeight"),n.textContent=this.PrtPaperHeight.toString(),t.appendChild(n)}if(this.IsZoomPaperPrt){let n=e.createElement("IsZoomPaperPrt");n.textContent=this.IsZoomPaperPrt.toString(),t.appendChild(n)}if(827!=this.width||1169!=this.height||null!=this.WorkModeWidth&&827!=this.WorkModeWidth||null!=this.WorkModeHeight&&1169!=this.WorkModeHeight||null!=this.initWidth&&827!=this.initWidth||null!=this.initHeight&&827!=this.initHeight){let n=e.createElement("PaperWidth");n.textContent=(this.IsAdaptive?this.initWidth:this.WorkModeWidth?this.WorkModeWidth:this.width).toString(),t.appendChild(n),n=e.createElement("PaperHeight"),n.textContent=(this.IsAdaptive?this.initHeight:this.WorkModeHeight?this.WorkModeHeight:this.height).toString(),t.appendChild(n)}if(this.landscape){let n=e.createElement("Landscape");n.textContent=(this.IsAdaptive?this.initLandscape:this.landscape).toString(),t.appendChild(n)}if(1==this.paperFeedHoriz){let n=e.createElement("PaperFeedHoriz");n.textContent=(this.IsAdaptive?this.initPaperFeedHoriz:this.paperFeedHoriz).toString(),t.appendChild(n)}if(this.pageMargin!=d.Default_PPMargin){let n=e.createElement("LeftMargin");n.textContent=(this.IsAdaptive?this.pageMargin.initLeft:this.pageMargin.Left).toString(),t.appendChild(n),n=e.createElement("TopMargin"),n.textContent=(this.IsAdaptive?this.pageMargin.initTop:this.pageMargin.Top).toString(),t.appendChild(n),n=e.createElement("RightMargin"),n.textContent=(this.IsAdaptive?this.pageMargin.initRight:this.pageMargin.Right).toString(),t.appendChild(n),n=e.createElement("BottomMargin"),n.textContent=(this.IsAdaptive?this.pageMargin.initBottom:this.pageMargin.Bottom).toString(),t.appendChild(n)}if(this.gutterMargin>0){let n;h.default.IsNullOrEmpty(this.gutterSide)||(n=e.createElement("GutterSide"),n.textContent=this.IsAdaptive?this.initGutterSide:this.gutterSide,t.appendChild(n)),n=e.createElement("GutterMargin"),n.textContent=(this.IsAdaptive?this.initGutterMargin:this.gutterMargin).toString(),t.appendChild(n)}if(19.69!=this.headTopMargin){let n=e.createElement("HeadTopMargin");n.textContent=(this.IsAdaptive?this.initHeadTopMargin:this.headTopMargin).toString(),t.appendChild(n)}if(19.69!=this.footBtmMargin){let n=e.createElement("FootBtmMargin");n.textContent=(this.IsAdaptive?this.initFootBtmMargin:this.footBtmMargin).toString(),t.appendChild(n)}if(this.IsShowHeadSptLine){let n=e.createElement("IsShowHeadSptLine");n.textContent=(this.IsAdaptive?this._initIsShowHeadSptLine:this.IsShowHeadSptLine).toString(),t.appendChild(n)}if(this.IsShowFooterSptLine){let n=e.createElement("IsShowFooterSptLine");n.textContent=(this.IsAdaptive?this._initIsShowFooterSptLine:this.IsShowFooterSptLine).toString(),t.appendChild(n)}if(this.ShowCmmtArea){let n=e.createElement("ShowCmmtArea");n.textContent=this.showCmmtArea.toString(),t.appendChild(n)}return t}FromXML(e){let t=o.XmlDomUtil.GetSingleNode(e,"PaperKind"),n=null==t?null:t.textContent;this.paperKind=h.default.IsNullOrEmpty(n)?"A4":n,this.WorkModePaperKind=h.default.IsNullOrEmpty(n)?"A4":n,t=o.XmlDomUtil.GetSingleNode(e,"PaperWidth"),n=null==t?null:t.textContent,this.width=a.CNumUtil.TryParseInt(n,827),this.initWidth=a.CNumUtil.TryParseInt(n,827),this.WorkModeWidth=a.CNumUtil.TryParseInt(n,827),t=o.XmlDomUtil.GetSingleNode(e,"PaperHeight"),n=null==t?null:t.textContent,this.height=a.CNumUtil.TryParseInt(n,1169),this.initHeight=a.CNumUtil.TryParseInt(n,1169),this.WorkModeHeight=a.CNumUtil.TryParseInt(n,1169),t=o.XmlDomUtil.GetSingleNode(e,"Landscape"),n=null==t?null:t.textContent,this.landscape=a.CNumUtil.TryParseBool(n,!1),this.initLandscape=a.CNumUtil.TryParseBool(n,!1),t=o.XmlDomUtil.GetSingleNode(e,"PaperFeedHoriz"),n=null==t?null:t.textContent,h.default.IsNullOrEmpty(n)?(this.paperFeedHoriz=null,this.initPaperFeedHoriz=a.CNumUtil.TryParseBool(n,!1)):(this.paperFeedHoriz=a.CNumUtil.TryParseBool(n,!1),this.initPaperFeedHoriz=a.CNumUtil.TryParseBool(n,!1)),t=o.XmlDomUtil.GetSingleNode(e,"IsZoomPaperPrt"),n=null==t?null:t.textContent,this.IsZoomPaperPrt=a.CNumUtil.TryParseBool(n,!1),t=o.XmlDomUtil.GetSingleNode(e,"PrtPaperKind"),n=null==t?null:t.textContent,this.PrtPaperKind=h.default.IsNullOrEmpty(n)?null:n,t=o.XmlDomUtil.GetSingleNode(e,"PrtPaperWidth"),n=null==t?null:t.textContent,this.PrtPaperWidth=a.CNumUtil.TryParseInt(n,null),t=o.XmlDomUtil.GetSingleNode(e,"PrtPaperHeight"),n=null==t?null:t.textContent,this.PrtPaperHeight=a.CNumUtil.TryParseInt(n,null),null==this.PrtPaperWidth&&null==this.PrtPaperHeight||this.checkPrtParamsOnHistoryXML(),t=o.XmlDomUtil.GetSingleNode(e,"LeftMargin"),n=null==t?null:t.textContent,this.pageMargin.Left=a.CNumUtil.TryParseInt(n,d.Default_PPMargin.Left),this.pageMargin.initLeft=a.CNumUtil.TryParseInt(n,d.Default_PPMargin.Left),t=o.XmlDomUtil.GetSingleNode(e,"TopMargin"),n=null==t?null:t.textContent,this.pageMargin.Top=a.CNumUtil.TryParseInt(n,d.Default_PPMargin.Top),this.pageMargin.initTop=a.CNumUtil.TryParseInt(n,d.Default_PPMargin.Top),t=o.XmlDomUtil.GetSingleNode(e,"RightMargin"),n=null==t?null:t.textContent,this.pageMargin.Right=a.CNumUtil.TryParseInt(n,d.Default_PPMargin.Right),this.pageMargin.initRight=a.CNumUtil.TryParseInt(n,d.Default_PPMargin.Right),t=o.XmlDomUtil.GetSingleNode(e,"BottomMargin"),n=null==t?null:t.textContent,this.pageMargin.Bottom=a.CNumUtil.TryParseInt(n,d.Default_PPMargin.Bottom),this.pageMargin.initBottom=a.CNumUtil.TryParseInt(n,d.Default_PPMargin.Bottom),t=o.XmlDomUtil.GetSingleNode(e,"GutterSide"),n=null==t?null:t.textContent,this.gutterSide=h.default.IsNullOrEmpty(n)?"Left":n,this.initGutterSide=h.default.IsNullOrEmpty(n)?"Left":n,t=o.XmlDomUtil.GetSingleNode(e,"GutterMargin"),n=null==t?null:t.textContent,this.gutterMargin=a.CNumUtil.TryParseFloat(n,0),this.initGutterMargin=a.CNumUtil.TryParseFloat(n,0),t=o.XmlDomUtil.GetSingleNode(e,"HeadTopMargin"),n=null==t?null:t.textContent;let r=o.XmlDomUtil.GetSingleNode(e,"StrictUsePageSize");null!=r&&(n=null==n?"59":n),this.headTopMargin=a.CNumUtil.TryParseFloat(n,d.Default_HeadTopMargin),this.initHeadTopMargin=a.CNumUtil.TryParseFloat(n,d.Default_HeadTopMargin),t=o.XmlDomUtil.GetSingleNode(e,"FootBtmMargin"),n=null==t?null:t.textContent,this.footBtmMargin=a.CNumUtil.TryParseFloat(n,d.Default_HeadTopMargin),this.initFootBtmMargin=a.CNumUtil.TryParseFloat(n,d.Default_HeadTopMargin),t=o.XmlDomUtil.GetSingleNode(e,"IsShowHeadSptLine"),n=null==t?null:t.textContent,null!=r&&(n=null==n?"true":n),this.IsShowHeadSptLine=a.CNumUtil.TryParseBool(n,!1),this._initIsShowHeadSptLine=a.CNumUtil.TryParseBool(n,!1),t=o.XmlDomUtil.GetSingleNode(e,"ShowCmmtArea"),n=null==t?null:t.textContent,this.ShowCmmtArea=a.CNumUtil.TryParseBool(n,!1),t=o.XmlDomUtil.GetSingleNode(e,"IsShowFooterSptLine"),n=null==t?null:t.textContent,this.IsShowFooterSptLine=a.CNumUtil.TryParseBool(n,!1),this._initIsShowFooterSptLine=a.CNumUtil.TryParseBool(n,!1)}checkPrtParamsOnHistoryXML(){if("自定义大小"==this.PrtPaperKind)return;let e,t;if(null!=this.PrtPaperKind){const n=/[^0-9.]/g,r=this.PrtPaperKind.split("×");if(null!=r[0]&&(e=Number(r[0].replace(n,"")),e=e>0?a.CNumUtil.Round(e/.254,0,!0):null),null!=r[1]&&(t=Number(r[1].replace(n,"")),t=t>0?a.CNumUtil.Round(t/.254,0,!0):null),e==this.PrtPaperWidth&&t==this.PrtPaperHeight)return;if(e>0&&t>0)return this.PrtPaperWidth=e,void(this.PrtPaperHeight=t)}const n=a.CNumUtil.Round(125/.254,0,!0);return this.PrtPaperWidth<n&&this.PrtPaperHeight<n?(this.PrtPaperWidth=null,void(this.PrtPaperHeight=null)):void 0}}t.XPageFmtParams=d,d.WebView_LeftMargin=5,d.WebView_RightMargin=10,d.Default_PPKind="A4",d.Default_HeadTopMargin=19.69,d.Default_PPMargin=new r.Padding(75,100,75,100)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaperSizeExt=void 0;const r=n(485),i=n(189),l=n(8),s=n(486),o=n(21),a=n(4);class u{constructor(e){this.manual_defined=!1,this.paper_name=null,this.paper_sz=null,this.calc_paper_sz=null,this.str_buf=null,this.calc_paper_sz=new i.CSize,this.str_buf=new o.default,null==e?(this.paper_name="A4",this.calc_paper_sz.setSizeAsMM(210,297)):this.setPrtPaperSize1(e)}get IsManualDefined(){return this.manual_defined}set IsManualDefined(e){this.manual_defined=e}clear(){this.str_buf.setLengthToZero(),this.manual_defined=!1,this.paper_name=null,this.paper_sz=null,this.calc_paper_sz.setSizeAsMM(0,0)}setPrtPaperSize1(e){this.paper_sz!=e&&(this.paper_sz=e,null!=e&&(this.paper_name=e.PaperName,this.calc_paper_sz.setSizeAsPX(e.Width,e.Height,100)))}setPrtPaperSize2(e,t,n){a.default.IsNullOrEmpty(e)||(this.paper_name=e,this.calc_paper_sz.setSizeAsMM(parseInt(t+.5+""),parseInt(n+.5+"")),this.paper_sz=new r.PaperSize(e,parseInt(this.calc_paper_sz.getWidthAsPX(100)+.5+""),parseInt(this.calc_paper_sz.getHeightAsPX(100)+.5+"")))}setPrtPaperSize3(e,t,n,i){if(!a.default.IsNullOrEmpty(e)){let s=this.calc_paper_sz.getWidthAsPX(i),o=this.calc_paper_sz.getHeightAsPX(i);null!=this.paper_sz&&e==this.paper_name&&l.CNumUtil.IsEqual(s,t,.01)&&l.CNumUtil.IsEqual(o,n,.01)||(this.paper_name=e,this.calc_paper_sz.setSizeAsPX(t,n,i),this.paper_sz=new r.PaperSize(e,parseInt(this.calc_paper_sz.getWidthAsPX(100)+.5+""),parseInt(this.calc_paper_sz.getHeightAsPX(100)+.5+"")))}}setPrtPaperCustomWidth(e,t){this.paper_sz.Kind==s.PaperKind.Custom&&(t<=0?this.calc_paper_sz.setWidthAsMM(e):this.calc_paper_sz.setWidthAsPX(e,t),this.paper_sz.Width=parseInt(this.calc_paper_sz.getWidthAsPX(100)+.5+""))}getPrtPaperName(){return this.paper_name}getPrtPaperStdNO(){return u.getPrtPaperStdNO(this.paper_name)}getPrtPaperKind(){return this.paper_sz.Kind}getPrtPaperSize(){return this.paper_sz}getPrtPaperCalcSize(){return this.calc_paper_sz}static getPrtPaperStdNO(e){let t;return a.default.IsNullOrEmpty(e)?t=null:"CustomQI"==e||"自定义"==e?t="CustomQI":"STRIP"==e&&(t="STRIP"),t}copyFrom(e){null!=e&&null!=e.paper_sz&&(this.manual_defined=e.manual_defined,this.paper_name=e.paper_name,this.paper_sz=e.paper_sz,this.calc_paper_sz.copyFrom(e.calc_paper_sz))}}t.PaperSizeExt=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringTrimming=void 0,function(e){e[e.None=0]="None",e[e.Character=1]="Character",e[e.Word=2]="Word",e[e.EllipsisCharacter=3]="EllipsisCharacter",e[e.EllipsisWord=4]="EllipsisWord",e[e.EllipsisPath=5]="EllipsisPath"}(t.StringTrimming||(t.StringTrimming={}))},function(e,t,n){var r;!function(i){"use strict";var l,s="[big.js] ",o=s+"Invalid ",a=o+"decimal places",u={},h=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function d(e,t,n,r){var i=e.c;if(void 0===n&&(n=l.RM),0!==n&&1!==n&&2!==n&&3!==n)throw Error("[big.js] Invalid rounding mode");if(t<1)r=3===n&&(r||!!i[0])||0===t&&(1===n&&i[0]>=5||2===n&&(i[0]>5||5===i[0]&&(r||void 0!==i[1]))),i.length=1,r?(e.e=e.e-t+1,i[0]=1):i[0]=e.e=0;else if(t<i.length){if(r=1===n&&i[t]>=5||2===n&&(i[t]>5||5===i[t]&&(r||void 0!==i[t+1]||1&i[t-1]))||3===n&&(r||!!i[0]),i.length=t--,r)for(;++i[t]>9;)i[t]=0,t--||(++e.e,i.unshift(1));for(t=i.length;!i[--t];)i.pop()}return e}function c(e,t,n){var r=e.e,i=e.c.join(""),l=i.length;if(t)i=i.charAt(0)+(l>1?"."+i.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)i="0"+i;i="0."+i}else if(r>0)if(++r>l)for(r-=l;r--;)i+="0";else r<l&&(i=i.slice(0,r)+"."+i.slice(r));else l>1&&(i=i.charAt(0)+"."+i.slice(1));return e.s<0&&n?"-"+i:i}u.abs=function(){var e=new this.constructor(this);return e.s=1,e},u.cmp=function(e){var t,n=this,r=n.c,i=(e=new n.constructor(e)).c,l=n.s,s=e.s,o=n.e,a=e.e;if(!r[0]||!i[0])return r[0]?l:i[0]?-s:0;if(l!=s)return l;if(t=l<0,o!=a)return o>a^t?1:-1;for(s=(o=r.length)<(a=i.length)?o:a,l=-1;++l<s;)if(r[l]!=i[l])return r[l]>i[l]^t?1:-1;return o==a?0:o>a^t?1:-1},u.div=function(e){var t=this,n=t.constructor,r=t.c,i=(e=new n(e)).c,l=t.s==e.s?1:-1,s=n.DP;if(s!==~~s||s<0||s>1e6)throw Error(a);if(!i[0])throw Error("[big.js] Division by zero");if(!r[0])return new n(0*l);var o,u,h,c,p,f=i.slice(),g=o=i.length,m=r.length,E=r.slice(0,o),C=E.length,A=e,y=A.c=[],I=0,S=s+(A.e=t.e-e.e)+1;for(A.s=l,l=S<0?0:S,f.unshift(0);C++<o;)E.push(0);do{for(h=0;h<10;h++){if(o!=(C=E.length))c=o>C?1:-1;else for(p=-1,c=0;++p<o;)if(i[p]!=E[p]){c=i[p]>E[p]?1:-1;break}if(!(c<0))break;for(u=C==o?i:f;C;){if(E[--C]<u[C]){for(p=C;p&&!E[--p];)E[p]=9;--E[p],E[C]+=10}E[C]-=u[C]}for(;!E[0];)E.shift()}y[I++]=c?h:++h,E[0]&&c?E[C]=r[g]||0:E=[r[g]]}while((g++<m||void 0!==E[0])&&l--);return y[0]||1==I||(y.shift(),A.e--,S--),I>S&&d(A,S,n.RM,void 0!==E[0]),A},u.eq=function(e){return 0===this.cmp(e)},u.gt=function(e){return this.cmp(e)>0},u.gte=function(e){return this.cmp(e)>-1},u.lt=function(e){return this.cmp(e)<0},u.lte=function(e){return this.cmp(e)<1},u.minus=u.sub=function(e){var t,n,r,i,l=this,s=l.constructor,o=l.s,a=(e=new s(e)).s;if(o!=a)return e.s=-a,l.plus(e);var u=l.c.slice(),h=l.e,d=e.c,c=e.e;if(!u[0]||!d[0])return d[0]?(e.s=-a,e):new s(u[0]?l:0);if(o=h-c){for((i=o<0)?(o=-o,r=u):(c=h,r=d),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else for(n=((i=u.length<d.length)?u:d).length,o=a=0;a<n;a++)if(u[a]!=d[a]){i=u[a]<d[a];break}if(i&&(r=u,u=d,d=r,e.s=-e.s),(a=(n=d.length)-(t=u.length))>0)for(;a--;)u[t++]=0;for(a=t;n>o;){if(u[--n]<d[n]){for(t=n;t&&!u[--t];)u[t]=9;--u[t],u[n]+=10}u[n]-=d[n]}for(;0===u[--a];)u.pop();for(;0===u[0];)u.shift(),--c;return u[0]||(e.s=1,u=[c=0]),e.c=u,e.e=c,e},u.mod=function(e){var t,n=this,r=n.constructor,i=n.s,l=(e=new r(e)).s;if(!e.c[0])throw Error("[big.js] Division by zero");return n.s=e.s=1,t=1==e.cmp(n),n.s=i,e.s=l,t?new r(n):(i=r.DP,l=r.RM,r.DP=r.RM=0,n=n.div(e),r.DP=i,r.RM=l,this.minus(n.times(e)))},u.plus=u.add=function(e){var t,n=this,r=n.constructor,i=n.s,l=(e=new r(e)).s;if(i!=l)return e.s=-l,n.minus(e);var s=n.e,o=n.c,a=e.e,u=e.c;if(!o[0]||!u[0])return u[0]?e:new r(o[0]?n:0*i);if(o=o.slice(),i=s-a){for(i>0?(a=s,t=u):(i=-i,t=o),t.reverse();i--;)t.push(0);t.reverse()}for(o.length-u.length<0&&(t=u,u=o,o=t),i=u.length,l=0;i;o[i]%=10)l=(o[--i]=o[i]+u[i]+l)/10|0;for(l&&(o.unshift(l),++a),i=o.length;0===o[--i];)o.pop();return e.c=o,e.e=a,e},u.pow=function(e){var t=this,n=new t.constructor(1),r=n,i=e<0;if(e!==~~e||e<-1e6||e>1e6)throw Error(o+"exponent");for(i&&(e=-e);1&e&&(r=r.times(t)),e>>=1;)t=t.times(t);return i?n.div(r):r},u.prec=function(e,t){if(e!==~~e||e<1||e>1e6)throw Error(o+"precision");return d(new this.constructor(this),e,t)},u.round=function(e,t){if(void 0===e)e=0;else if(e!==~~e||e<-1e6||e>1e6)throw Error(a);return d(new this.constructor(this),e+this.e+1,t)},u.sqrt=function(){var e,t,n,r=this,i=r.constructor,l=r.s,o=r.e,a=new i(.5);if(!r.c[0])return new i(r);if(l<0)throw Error(s+"No square root");0===(l=Math.sqrt(r+""))||l===1/0?((t=r.c.join("")).length+o&1||(t+="0"),o=((o+1)/2|0)-(o<0||1&o),e=new i(((l=Math.sqrt(t))==1/0?"5e":(l=l.toExponential()).slice(0,l.indexOf("e")+1))+o)):e=new i(l),o=e.e+(i.DP+=4);do{n=e,e=a.times(n.plus(r.div(n)))}while(n.c.slice(0,o).join("")!==e.c.slice(0,o).join(""));return d(e,(i.DP-=4)+e.e+1,i.RM)},u.times=u.mul=function(e){var t,n=this,r=n.constructor,i=n.c,l=(e=new r(e)).c,s=i.length,o=l.length,a=n.e,u=e.e;if(e.s=n.s==e.s?1:-1,!i[0]||!l[0])return new r(0*e.s);for(e.e=a+u,s<o&&(t=i,i=l,l=t,u=s,s=o,o=u),t=new Array(u=s+o);u--;)t[u]=0;for(a=o;a--;){for(o=0,u=s+a;u>a;)o=t[u]+l[a]*i[u-a-1]+o,t[u--]=o%10,o=o/10|0;t[u]=o}for(o?++e.e:t.shift(),a=t.length;!t[--a];)t.pop();return e.c=t,e},u.toExponential=function(e,t){var n=this,r=n.c[0];if(void 0!==e){if(e!==~~e||e<0||e>1e6)throw Error(a);for(n=d(new n.constructor(n),++e,t);n.c.length<e;)n.c.push(0)}return c(n,!0,!!r)},u.toFixed=function(e,t){var n=this,r=n.c[0];if(void 0!==e){if(e!==~~e||e<0||e>1e6)throw Error(a);for(e=e+(n=d(new n.constructor(n),e+n.e+1,t)).e+1;n.c.length<e;)n.c.push(0)}return c(n,!1,!!r)},u.toJSON=u.toString=function(){var e=this,t=e.constructor;return c(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},u.toNumber=function(){var e=Number(c(this,!0,!0));if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(s+"Imprecise conversion");return e},u.toPrecision=function(e,t){var n=this,r=n.constructor,i=n.c[0];if(void 0!==e){if(e!==~~e||e<1||e>1e6)throw Error(o+"precision");for(n=d(new r(n),e,t);n.c.length<e;)n.c.push(0)}return c(n,e<=n.e||n.e<=r.NE||n.e>=r.PE,!!i)},u.valueOf=function(){var e=this,t=e.constructor;if(!0===t.strict)throw Error(s+"valueOf disallowed");return c(e,e.e<=t.NE||e.e>=t.PE,!0)},(l=function e(){function t(n){var r=this;if(!(r instanceof t))return void 0===n?e():new t(n);if(n instanceof t)r.s=n.s,r.e=n.e,r.c=n.c.slice();else{if("string"!=typeof n){if(!0===t.strict)throw TypeError(o+"number");n=0===n&&1/n<0?"-0":String(n)}!function(e,t){var n,r,i;if(!h.test(t))throw Error(o+"number");e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(n=t.indexOf("."))>-1&&(t=t.replace(".",""));(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length);for(i=t.length,r=0;r<i&&"0"==t.charAt(r);)++r;if(r==i)e.c=[e.e=0];else{for(;i>0&&"0"==t.charAt(--i););for(e.e=n-r-1,e.c=[],n=0;r<=i;)e.c[n++]=+t.charAt(r++)}}(r,n)}r.constructor=t}return t.prototype=u,t.DP=20,t.RM=1,t.NE=-7,t.PE=21,t.strict=!1,t}()).default=l.Big=l,void 0===(r=function(){return l}.call(t,n,t,e))||(e.exports=r)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);class i{constructor(e){if(this.binarizer=e,null===e)throw new r.IllegalArgumentException("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return null!==this.matrix&&void 0!==this.matrix||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,n,r){const l=this.binarizer.getLuminanceSource().crop(e,t,n,r);return new i(this.binarizer.createBinarizer(l))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new i(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new i(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch(e){return""}}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(266),i=n(78);class l extends r.default{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(null!==this.matrix)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight();if(t>=l.MINIMUM_DIMENSION&&n>=l.MINIMUM_DIMENSION){const r=e.getMatrix();let s=t>>l.BLOCK_SIZE_POWER;0!=(t&l.BLOCK_SIZE_MASK)&&s++;let o=n>>l.BLOCK_SIZE_POWER;0!=(n&l.BLOCK_SIZE_MASK)&&o++;const a=l.calculateBlackPoints(r,s,o,t,n),u=new i.default(t,n);l.calculateThresholdForBlock(r,s,o,t,n,a,u),this.matrix=u}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new l(e)}static calculateThresholdForBlock(e,t,n,r,i,s,o){const a=i-l.BLOCK_SIZE,u=r-l.BLOCK_SIZE;for(let i=0;i<n;i++){let h=i<<l.BLOCK_SIZE_POWER;h>a&&(h=a);const d=l.cap(i,2,n-3);for(let n=0;n<t;n++){let i=n<<l.BLOCK_SIZE_POWER;i>u&&(i=u);const a=l.cap(n,2,t-3);let c=0;for(let e=-2;e<=2;e++){const t=s[d+e];c+=t[a-2]+t[a-1]+t[a]+t[a+1]+t[a+2]}const p=c/25;l.thresholdBlock(e,i,h,p,r,o)}}}static cap(e,t,n){return e<t?t:e>n?n:e}static thresholdBlock(e,t,n,r,i,s){for(let o=0,a=n*i+t;o<l.BLOCK_SIZE;o++,a+=i)for(let i=0;i<l.BLOCK_SIZE;i++)(255&e[a+i])<=r&&s.set(t+i,n+o)}static calculateBlackPoints(e,t,n,r,i){const s=i-l.BLOCK_SIZE,o=r-l.BLOCK_SIZE,a=new Array(n);for(let i=0;i<n;i++){a[i]=new Int32Array(t);let n=i<<l.BLOCK_SIZE_POWER;n>s&&(n=s);for(let s=0;s<t;s++){let t=s<<l.BLOCK_SIZE_POWER;t>o&&(t=o);let u=0,h=255,d=0;for(let i=0,s=n*r+t;i<l.BLOCK_SIZE;i++,s+=r){for(let t=0;t<l.BLOCK_SIZE;t++){const n=255&e[s+t];u+=n,n<h&&(h=n),n>d&&(d=n)}if(d-h>l.MIN_DYNAMIC_RANGE)for(i++,s+=r;i<l.BLOCK_SIZE;i++,s+=r)for(let t=0;t<l.BLOCK_SIZE;t++)u+=255&e[s+t]}let c=u>>2*l.BLOCK_SIZE_POWER;if(d-h<=l.MIN_DYNAMIC_RANGE&&(c=h/2,i>0&&s>0)){const e=(a[i-1][s]+2*a[i][s-1]+a[i-1][s-1])/4;h<e&&(c=e)}a[i][s]=c}}return a}}t.default=l,l.BLOCK_SIZE_POWER=3,l.BLOCK_SIZE=1<<l.BLOCK_SIZE_POWER,l.BLOCK_SIZE_MASK=l.BLOCK_SIZE-1,l.MINIMUM_DIMENSION=5*l.BLOCK_SIZE,l.MIN_DYNAMIC_RANGE=24},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(267),l=n(99),s=n(78);class o extends i.default{constructor(e){super(e),this.luminances=o.EMPTY,this.buckets=new Int32Array(o.LUMINANCE_BUCKETS)}getBlackRow(e,t){const n=this.getLuminanceSource(),r=n.getWidth();null==t||t.getSize()<r?t=new l.default(r):t.clear(),this.initArrays(r);const i=n.getRow(e,this.luminances),s=this.buckets;for(let e=0;e<r;e++)s[(255&i[e])>>o.LUMINANCE_SHIFT]++;const a=o.estimateBlackPoint(s);if(r<3)for(let e=0;e<r;e++)(255&i[e])<a&&t.set(e);else{let e=255&i[0],n=255&i[1];for(let l=1;l<r-1;l++){const r=255&i[l+1];(4*n-e-r)/2<a&&t.set(l),e=n,n=r}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight(),r=new s.default(t,n);this.initArrays(t);const i=this.buckets;for(let r=1;r<5;r++){const l=Math.floor(n*r/5),s=e.getRow(l,this.luminances),a=Math.floor(4*t/5);for(let e=Math.floor(t/5);e<a;e++){i[(255&s[e])>>o.LUMINANCE_SHIFT]++}}const l=o.estimateBlackPoint(i),a=e.getMatrix();for(let e=0;e<n;e++){const n=e*t;for(let i=0;i<t;i++){(255&a[n+i])<l&&r.set(i,e)}}return r}createBinarizer(e){return new o(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let e=0;e<o.LUMINANCE_BUCKETS;e++)t[e]=0}static estimateBlackPoint(e){const t=e.length;let n=0,i=0,l=0;for(let r=0;r<t;r++)e[r]>l&&(i=r,l=e[r]),e[r]>n&&(n=e[r]);let s=0,a=0;for(let n=0;n<t;n++){const t=n-i,r=e[n]*t*t;r>a&&(s=n,a=r)}if(i>s){const e=i;i=s,s=e}if(s-i<=t/16)throw new r.NotFoundException;let u=s-1,h=-1;for(let t=s-1;t>i;t--){const r=t-i,l=r*r*(s-t)*(n-e[t]);l>h&&(u=t,h=l)}return u<<o.LUMINANCE_SHIFT}}t.default=o,o.LUMINANCE_BITS=5,o.LUMINANCE_SHIFT=8-o.LUMINANCE_BITS,o.LUMINANCE_BUCKETS=1<<o.LUMINANCE_BITS,o.EMPTY=Uint8ClampedArray.from([0])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTMLCanvasElementLuminanceSource=void 0;const r=n(5),i=n(126),l=n(127);class s extends l.default{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=s.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return s.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,n){const r=new Uint8ClampedArray(t*n);for(let t=0,n=0,i=e.length;t<i;t+=4,n++){let i;if(0===e[t+3])i=255;else{i=306*e[t]+601*e[t+1]+117*e[t+2]+512>>10}r[n]=i}return r}getRow(e,t){if(e<0||e>=this.getHeight())throw new r.IllegalArgumentException("Requested row is outside the image: "+e);const n=this.getWidth(),i=e*n;return null===t?t=this.buffer.slice(i,i+n):(t.length<n&&(t=new Uint8ClampedArray(n)),t.set(this.buffer.slice(i,i+n))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,n,r){return super.crop(e,t,n,r),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(null===this.tempCanvasElement){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),n=t.getContext("2d"),r=e*s.DEGREE_TO_RADIANS,i=this.canvas.width,l=this.canvas.height,o=Math.ceil(Math.abs(Math.cos(r))*i+Math.abs(Math.sin(r))*l),a=Math.ceil(Math.abs(Math.sin(r))*i+Math.abs(Math.cos(r))*l);return t.width=o,t.height=a,n.translate(o/2,a/2),n.rotate(r),n.drawImage(this.canvas,i/-2,l/-2),this.buffer=s.makeBufferFromCanvasImageData(t),this}invert(){return new i.default(this)}}t.HTMLCanvasElementLuminanceSource=s,s.DEGREE_TO_RADIANS=Math.PI/180},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoInputDevice=void 0;t.VideoInputDevice=class{constructor(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.default=class{exp(e){return this.expTable[e]}log(e){if(0===e)throw new r.IllegalArgumentException;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{static floatToIntBits(e){return e}}t.default=r,r.MAX_VALUE=Number.MAX_SAFE_INTEGER},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(273),i=n(78),l=n(199),s=n(5);class o extends r.default{sampleGrid(e,t,n,r,i,s,o,a,u,h,d,c,p,f,g,m,E,C,A){const y=l.default.quadrilateralToQuadrilateral(r,i,s,o,a,u,h,d,c,p,f,g,m,E,C,A);return this.sampleGridWithTransform(e,t,n,y)}sampleGridWithTransform(e,t,n,l){if(t<=0||n<=0)throw new s.NotFoundException;const o=new i.default(t,n),a=new Float32Array(2*t);for(let t=0;t<n;t++){const n=a.length,i=t+.5;for(let e=0;e<n;e+=2)a[e]=e/2+.5,a[e+1]=i;l.transformPoints(a),r.default.checkAndNudgePoints(e,a);try{for(let r=0;r<n;r+=2)e.get(Math.floor(a[r]),Math.floor(a[r+1]))&&o.set(r/2,t)}catch(e){throw new s.NotFoundException}}return o}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.default=class{static checkAndNudgePoints(e,t){const n=e.getWidth(),i=e.getHeight();let l=!0;for(let e=0;e<t.length&&l;e+=2){const s=Math.floor(t[e]),o=Math.floor(t[e+1]);if(s<-1||s>n||o<-1||o>i)throw new r.NotFoundException;l=!1,-1===s?(t[e]=0,l=!0):s===n&&(t[e]=n-1,l=!0),-1===o?(t[e+1]=0,l=!0):o===i&&(t[e+1]=i-1,l=!0)}l=!0;for(let e=t.length-2;e>=0&&l;e-=2){const s=Math.floor(t[e]),o=Math.floor(t[e+1]);if(s<-1||s>n||o<-1||o>i)throw new r.NotFoundException;l=!1,-1===s?(t[e]=0,l=!0):s===n&&(t[e]=n-1,l=!0),-1===o?(t[e+1]=0,l=!0):o===i&&(t[e+1]=i-1,l=!0)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(86),l=n(57),s=n(41),o=n(5);class a extends i.default{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Array(9)}decodeRow(e,t,n){let i=this.counters;i.fill(0),this.decodeRowResult="";let u,h,d=a.findAsteriskPattern(t,i),c=t.getNextSet(d[1]),p=t.getSize();do{a.recordPattern(t,c,i);let e=a.toNarrowWidePattern(i);if(e<0)throw new o.NotFoundException;u=a.patternToChar(e),this.decodeRowResult+=u,h=c;for(let e of i)c+=e;c=t.getNextSet(c)}while("*"!==u);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let f,g=0;for(let e of i)g+=e;if(c!==p&&2*(c-h-g)<g)throw new o.NotFoundException;if(this.usingCheckDigit){let e=this.decodeRowResult.length-1,t=0;for(let n=0;n<e;n++)t+=a.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(n));if(this.decodeRowResult.charAt(e)!==a.ALPHABET_STRING.charAt(t%43))throw new o.ChecksumException;this.decodeRowResult=this.decodeRowResult.substring(0,e)}if(0===this.decodeRowResult.length)throw new o.NotFoundException;f=this.extendedMode?a.decodeExtended(this.decodeRowResult):this.decodeRowResult;let m=(d[1]+d[0])/2,E=h+g/2;return new l.default(f,null,0,[new s.default(m,e),new s.default(E,e)],r.default.CODE_39,(new Date).getTime())}static findAsteriskPattern(e,t){let n=e.getSize(),r=e.getNextSet(0),i=0,l=r,s=!1,u=t.length;for(let o=r;o<n;o++)if(e.get(o)!==s)t[i]++;else{if(i===u-1){if(this.toNarrowWidePattern(t)===a.ASTERISK_ENCODING&&e.isRange(Math.max(0,l-Math.floor((o-l)/2)),l,!1))return[l,o];l+=t[0]+t[1],t.copyWithin(0,2,2+i-1),t[i-1]=0,t[i]=0,i--}else i++;t[i]=1,s=!s}throw new o.NotFoundException}static toNarrowWidePattern(e){let t,n=e.length,r=0;do{let i=2147483647;for(let t of e)t<i&&t>r&&(i=t);r=i,t=0;let l=0,s=0;for(let i=0;i<n;i++){let o=e[i];o>r&&(s|=1<<n-1-i,t++,l+=o)}if(3===t){for(let i=0;i<n&&t>0;i++){let n=e[i];if(n>r&&(t--,2*n>=l))return-1}return s}}while(t>3);return-1}static patternToChar(e){for(let t=0;t<a.CHARACTER_ENCODINGS.length;t++)if(a.CHARACTER_ENCODINGS[t]===e)return a.ALPHABET_STRING.charAt(t);if(e===a.ASTERISK_ENCODING)return"*";throw new o.NotFoundException}static decodeExtended(e){let t=e.length,n="";for(let r=0;r<t;r++){let t=e.charAt(r);if("+"===t||"$"===t||"%"===t||"/"===t){let i=e.charAt(r+1),l="\0";switch(t){case"+":if(!(i>="A"&&i<="Z"))throw new o.FormatException;l=String.fromCharCode(i.charCodeAt(0)+32);break;case"$":if(!(i>="A"&&i<="Z"))throw new o.FormatException;l=String.fromCharCode(i.charCodeAt(0)-64);break;case"%":if(i>="A"&&i<="E")l=String.fromCharCode(i.charCodeAt(0)-38);else if(i>="F"&&i<="J")l=String.fromCharCode(i.charCodeAt(0)-11);else if(i>="K"&&i<="O")l=String.fromCharCode(i.charCodeAt(0)+16);else if(i>="P"&&i<="T")l=String.fromCharCode(i.charCodeAt(0)+43);else if("U"===i)l="\0";else if("V"===i)l="@";else if("W"===i)l="`";else{if("X"!==i&&"Y"!==i&&"Z"!==i)throw new o.FormatException;l=""}break;case"/":if(i>="A"&&i<="O")l=String.fromCharCode(i.charCodeAt(0)-32);else{if("Z"!==i)throw new o.FormatException;l=":"}}n+=l,r++}else n+=t}return n}}t.default=a,a.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",a.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],a.ASTERISK_ENCODING=148},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(50),l=n(57),s=n(41),o=n(86),a=n(5);class u extends o.default{static findStartPattern(e){const t=e.getSize(),n=e.getNextSet(0);let r=0;const i=[0,0,0,0,0,0];let l=n,s=!1;for(let a=n;a<t;a++)if(e.get(a)!==s)i[r]++;else{if(5===r){let t=u.MAX_AVG_VARIANCE,n=-1;for(let e=u.CODE_START_A;e<=u.CODE_START_C;e++){const r=o.default.patternMatchVariance(i,u.CODE_PATTERNS[e],u.MAX_INDIVIDUAL_VARIANCE);r<t&&(t=r,n=e)}if(n>=0&&e.isRange(Math.max(0,l-(a-l)/2),l,!1))return[l,a,n];l+=i[0]+i[1],i.splice(0,2),i[r-1]=0,i[r]=0,r--}else r++;i[r]=1,s=!s}throw new a.NotFoundException}static decodeCode(e,t,n){o.default.recordPattern(e,n,t);let r=u.MAX_AVG_VARIANCE,i=-1;for(let e=0;e<u.CODE_PATTERNS.length;e++){const n=u.CODE_PATTERNS[e],l=this.patternMatchVariance(t,n,u.MAX_INDIVIDUAL_VARIANCE);l<r&&(r=l,i=e)}if(i>=0)return i;throw new a.NotFoundException}decodeRow(e,t,n){const o=n&&!0===n.get(i.default.ASSUME_GS1),h=u.findStartPattern(t),d=h[2];let c=0;const p=new Uint8Array(20);let f;switch(p[c++]=d,d){case u.CODE_START_A:f=u.CODE_CODE_A;break;case u.CODE_START_B:f=u.CODE_CODE_B;break;case u.CODE_START_C:f=u.CODE_CODE_C;break;default:throw new a.FormatException}let g=!1,m=!1,E="",C=h[0],A=h[1];const y=[0,0,0,0,0,0];let I=0,S=0,_=d,w=0,b=!0,x=!1,P=!1;for(;!g;){const e=m;switch(m=!1,I=S,S=u.decodeCode(t,y,A),p[c++]=S,S!==u.CODE_STOP&&(b=!0),S!==u.CODE_STOP&&(w++,_+=w*S),C=A,A+=y.reduce((e,t)=>e+t,0),S){case u.CODE_START_A:case u.CODE_START_B:case u.CODE_START_C:throw new a.FormatException}switch(f){case u.CODE_CODE_A:if(S<64)E+=P===x?String.fromCharCode(" ".charCodeAt(0)+S):String.fromCharCode(" ".charCodeAt(0)+S+128),P=!1;else if(S<96)E+=P===x?String.fromCharCode(S-64):String.fromCharCode(S+64),P=!1;else switch(S!==u.CODE_STOP&&(b=!1),S){case u.CODE_FNC_1:o&&(0===E.length?E+="]C1":E+=String.fromCharCode(29));break;case u.CODE_FNC_2:case u.CODE_FNC_3:break;case u.CODE_FNC_4_A:!x&&P?(x=!0,P=!1):x&&P?(x=!1,P=!1):P=!0;break;case u.CODE_SHIFT:m=!0,f=u.CODE_CODE_B;break;case u.CODE_CODE_B:f=u.CODE_CODE_B;break;case u.CODE_CODE_C:f=u.CODE_CODE_C;break;case u.CODE_STOP:g=!0}break;case u.CODE_CODE_B:if(S<96)E+=P===x?String.fromCharCode(" ".charCodeAt(0)+S):String.fromCharCode(" ".charCodeAt(0)+S+128),P=!1;else switch(S!==u.CODE_STOP&&(b=!1),S){case u.CODE_FNC_1:o&&(0===E.length?E+="]C1":E+=String.fromCharCode(29));break;case u.CODE_FNC_2:case u.CODE_FNC_3:break;case u.CODE_FNC_4_B:!x&&P?(x=!0,P=!1):x&&P?(x=!1,P=!1):P=!0;break;case u.CODE_SHIFT:m=!0,f=u.CODE_CODE_A;break;case u.CODE_CODE_A:f=u.CODE_CODE_A;break;case u.CODE_CODE_C:f=u.CODE_CODE_C;break;case u.CODE_STOP:g=!0}break;case u.CODE_CODE_C:if(S<100)S<10&&(E+="0"),E+=S;else switch(S!==u.CODE_STOP&&(b=!1),S){case u.CODE_FNC_1:o&&(0===E.length?E+="]C1":E+=String.fromCharCode(29));break;case u.CODE_CODE_A:f=u.CODE_CODE_A;break;case u.CODE_CODE_B:f=u.CODE_CODE_B;break;case u.CODE_STOP:g=!0}}e&&(f=f===u.CODE_CODE_A?u.CODE_CODE_B:u.CODE_CODE_A)}const v=A-C;if(A=t.getNextUnset(A),!t.isRange(A,Math.min(t.getSize(),A+(A-C)/2),!1))throw new a.NotFoundException;if(_-=w*I,_%103!==I)throw new a.ChecksumException;const T=E.length;if(0===T)throw new a.NotFoundException;T>0&&b&&(E=f===u.CODE_CODE_C?E.substring(0,T-2):E.substring(0,T-1));const M=(h[1]+h[0])/2,L=C+v/2,D=p.length,R=new Uint8Array(D);for(let e=0;e<D;e++)R[e]=p[e];const F=[new s.default(M,e),new s.default(L,e)];return new l.default(E,R,0,F,r.default.CODE_128,(new Date).getTime())}}t.default=u,u.CODE_PATTERNS=[[2,1,2,2,2,2],[2,2,2,1,2,2],[2,2,2,2,2,1],[1,2,1,2,2,3],[1,2,1,3,2,2],[1,3,1,2,2,2],[1,2,2,2,1,3],[1,2,2,3,1,2],[1,3,2,2,1,2],[2,2,1,2,1,3],[2,2,1,3,1,2],[2,3,1,2,1,2],[1,1,2,2,3,2],[1,2,2,1,3,2],[1,2,2,2,3,1],[1,1,3,2,2,2],[1,2,3,1,2,2],[1,2,3,2,2,1],[2,2,3,2,1,1],[2,2,1,1,3,2],[2,2,1,2,3,1],[2,1,3,2,1,2],[2,2,3,1,1,2],[3,1,2,1,3,1],[3,1,1,2,2,2],[3,2,1,1,2,2],[3,2,1,2,2,1],[3,1,2,2,1,2],[3,2,2,1,1,2],[3,2,2,2,1,1],[2,1,2,1,2,3],[2,1,2,3,2,1],[2,3,2,1,2,1],[1,1,1,3,2,3],[1,3,1,1,2,3],[1,3,1,3,2,1],[1,1,2,3,1,3],[1,3,2,1,1,3],[1,3,2,3,1,1],[2,1,1,3,1,3],[2,3,1,1,1,3],[2,3,1,3,1,1],[1,1,2,1,3,3],[1,1,2,3,3,1],[1,3,2,1,3,1],[1,1,3,1,2,3],[1,1,3,3,2,1],[1,3,3,1,2,1],[3,1,3,1,2,1],[2,1,1,3,3,1],[2,3,1,1,3,1],[2,1,3,1,1,3],[2,1,3,3,1,1],[2,1,3,1,3,1],[3,1,1,1,2,3],[3,1,1,3,2,1],[3,3,1,1,2,1],[3,1,2,1,1,3],[3,1,2,3,1,1],[3,3,2,1,1,1],[3,1,4,1,1,1],[2,2,1,4,1,1],[4,3,1,1,1,1],[1,1,1,2,2,4],[1,1,1,4,2,2],[1,2,1,1,2,4],[1,2,1,4,2,1],[1,4,1,1,2,2],[1,4,1,2,2,1],[1,1,2,2,1,4],[1,1,2,4,1,2],[1,2,2,1,1,4],[1,2,2,4,1,1],[1,4,2,1,1,2],[1,4,2,2,1,1],[2,4,1,2,1,1],[2,2,1,1,1,4],[4,1,3,1,1,1],[2,4,1,1,1,2],[1,3,4,1,1,1],[1,1,1,2,4,2],[1,2,1,1,4,2],[1,2,1,2,4,1],[1,1,4,2,1,2],[1,2,4,1,1,2],[1,2,4,2,1,1],[4,1,1,2,1,2],[4,2,1,1,1,2],[4,2,1,2,1,1],[2,1,2,1,4,1],[2,1,4,1,2,1],[4,1,2,1,2,1],[1,1,1,1,4,3],[1,1,1,3,4,1],[1,3,1,1,4,1],[1,1,4,1,1,3],[1,1,4,3,1,1],[4,1,1,1,1,3],[4,1,1,3,1,1],[1,1,3,1,4,1],[1,1,4,1,3,1],[3,1,1,1,4,1],[4,1,1,1,3,1],[2,1,1,4,1,2],[2,1,1,2,1,4],[2,1,1,2,3,2],[2,3,3,1,1,1,2]],u.MAX_AVG_VARIANCE=.25,u.MAX_INDIVIDUAL_VARIANCE=.7,u.CODE_SHIFT=98,u.CODE_CODE_C=99,u.CODE_CODE_B=100,u.CODE_CODE_A=101,u.CODE_FNC_1=102,u.CODE_FNC_2=97,u.CODE_FNC_3=96,u.CODE_FNC_4_A=101,u.CODE_FNC_4_B=100,u.CODE_START_A=103,u.CODE_START_B=104,u.CODE_START_C=105,u.CODE_STOP=106},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(277),i=n(499),l=n(57),s=n(50),o=n(21),a=n(34),u=n(41),h=n(278),d=n(201),c=n(72),p=n(279),f=n(49),g=n(86),m=n(5);class E extends r.default{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,n){const r=this.decodePair(t,!1,e,n);E.addOrTally(this.possibleLeftPairs,r),t.reverse();let i=this.decodePair(t,!0,e,n);E.addOrTally(this.possibleRightPairs,i),t.reverse();for(let e of this.possibleLeftPairs)if(e.getCount()>1)for(let t of this.possibleRightPairs)if(t.getCount()>1&&E.checkChecksum(e,t))return E.constructResult(e,t);throw new m.NotFoundException}static addOrTally(e,t){if(null==t)return;let n=!1;for(let r of e)if(r.getValue()===t.getValue()){r.incrementCount(),n=!0;break}n||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let n=4537077*e.getValue()+t.getValue(),r=new String(n).toString(),i=new o.default;for(let e=13-r.length;e>0;e--)i.append("0");i.append(r);let s=0;for(let e=0;e<13;e++){let t=i.charAt(e).charCodeAt(0)-"0".charCodeAt(0);s+=0==(1&e)?3*t:t}s=10-s%10,10===s&&(s=0),i.append(s.toString());let u=e.getFinderPattern().getResultPoints(),h=t.getFinderPattern().getResultPoints();return new l.default(i.toString(),null,0,[u[0],u[1],h[0],h[1]],a.default.RSS_14,(new Date).getTime())}static checkChecksum(e,t){let n=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,r=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return r>72&&r--,r>8&&r--,n===r}decodePair(e,t,n,r){try{let l=this.findFinderPattern(e,t),o=this.parseFoundFinderPattern(e,n,t,l),a=null==r?null:r.get(s.default.NEED_RESULT_POINT_CALLBACK);if(null!=a){let r=(l[0]+l[1])/2;t&&(r=e.getSize()-1-r),a.foundPossibleResultPoint(new u.default(r,n))}let h=this.decodeDataCharacter(e,o,!0),d=this.decodeDataCharacter(e,o,!1);return new i.default(1597*h.getValue()+d.getValue(),h.getChecksumPortion()+4*d.getChecksumPortion(),o)}catch(e){return null}}decodeDataCharacter(e,t,n){let r=this.getDataCharacterCounters();for(let e=0;e<r.length;e++)r[e]=0;if(n)g.default.recordPatternInReverse(e,t.getStartEnd()[0],r);else{g.default.recordPattern(e,t.getStartEnd()[1]+1,r);for(let e=0,t=r.length-1;e<t;e++,t--){let n=r[e];r[e]=r[t],r[t]=n}}let i=n?16:15,l=c.default.sum(new Int32Array(r))/i,s=this.getOddCounts(),o=this.getEvenCounts(),a=this.getOddRoundingErrors(),u=this.getEvenRoundingErrors();for(let e=0;e<r.length;e++){let t=r[e]/l,n=Math.floor(t+.5);n<1?n=1:n>8&&(n=8);let i=Math.floor(e/2);0==(1&e)?(s[i]=n,a[i]=t-n):(o[i]=n,u[i]=t-n)}this.adjustOddEvenCounts(n,i);let h=0,f=0;for(let e=s.length-1;e>=0;e--)f*=9,f+=s[e],h+=s[e];let C=0,A=0;for(let e=o.length-1;e>=0;e--)C*=9,C+=o[e],A+=o[e];let y=f+3*C;if(n){if(0!=(1&h)||h>12||h<4)throw new m.NotFoundException;let e=(12-h)/2,t=E.OUTSIDE_ODD_WIDEST[e],n=9-t,r=p.default.getRSSvalue(s,t,!1),i=p.default.getRSSvalue(o,n,!0),l=E.OUTSIDE_EVEN_TOTAL_SUBSET[e],a=E.OUTSIDE_GSUM[e];return new d.default(r*l+i+a,y)}{if(0!=(1&A)||A>10||A<4)throw new m.NotFoundException;let e=(10-A)/2,t=E.INSIDE_ODD_WIDEST[e],n=9-t,r=p.default.getRSSvalue(s,t,!0),i=p.default.getRSSvalue(o,n,!1),l=E.INSIDE_ODD_TOTAL_SUBSET[e],a=E.INSIDE_GSUM[e];return new d.default(i*l+r+a,y)}}findFinderPattern(e,t){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),l=!1,s=0;for(;s<i&&(l=!e.get(s),t!==l);)s++;let o=0,a=s;for(let t=s;t<i;t++)if(e.get(t)!==l)n[o]++;else{if(3===o){if(r.default.isFinderPattern(n))return[a,t];a+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,o--}else o++;n[o]=1,l=!l}throw new m.NotFoundException}parseFoundFinderPattern(e,t,n,r){let i=e.get(r[0]),l=r[0]-1;for(;l>=0&&i!==e.get(l);)l--;l++;let s=r[0]-l,o=this.getDecodeFinderCounters(),a=new Array(o.length);f.default.arraycopy(o,0,a,1,o.length-1),a[0]=s;let u=this.parseFinderValue(a,E.FINDER_PATTERNS),d=l,c=r[1];return n&&(d=e.getSize()-1-d,c=e.getSize()-1-c),new h.default(u,[l,r[1]],d,c,t)}adjustOddEvenCounts(e,t){let n=c.default.sum(new Int32Array(this.getOddCounts())),i=c.default.sum(new Int32Array(this.getEvenCounts())),l=!1,s=!1,o=!1,a=!1;e?(n>12?s=!0:n<4&&(l=!0),i>12?a=!0:i<4&&(o=!0)):(n>11?s=!0:n<5&&(l=!0),i>10?a=!0:i<4&&(o=!0));let u=n+i-t,h=(1&n)==(e?1:0),d=1==(1&i);if(1===u)if(h){if(d)throw new m.NotFoundException;s=!0}else{if(!d)throw new m.NotFoundException;a=!0}else if(-1===u)if(h){if(d)throw new m.NotFoundException;l=!0}else{if(!d)throw new m.NotFoundException;o=!0}else{if(0!==u)throw new m.NotFoundException;if(h){if(!d)throw new m.NotFoundException;n<i?(l=!0,a=!0):(s=!0,o=!0)}else if(d)throw new m.NotFoundException}if(l){if(s)throw new m.NotFoundException;r.default.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(s&&r.default.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(a)throw new m.NotFoundException;r.default.increment(this.getEvenCounts(),this.getOddRoundingErrors())}a&&r.default.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}t.default=E,E.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],E.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],E.OUTSIDE_GSUM=[0,161,961,2015,2715],E.INSIDE_GSUM=[0,336,1036,1516],E.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],E.INSIDE_ODD_WIDEST=[2,4,6,8],E.FINDER_PATTERNS=[[3,8,2,1],[3,5,5,1],[3,3,7,1],[3,1,9,1],[2,7,4,1],[2,5,6,1],[2,3,8,1],[1,5,7,1],[1,3,9,1]]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(86),i=n(72),l=n(5);class s extends r.default{constructor(){super(),this.decodeFinderCounters=new Array(4),this.dataCharacterCounters=new Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let n=0;n<t.length;n++)if(r.default.patternMatchVariance(e,t[n],s.MAX_INDIVIDUAL_VARIANCE)<s.MAX_AVG_VARIANCE)return n;throw new l.NotFoundException}static count(e){return i.default.sum(new Int32Array(e))}static increment(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]>r&&(r=t[i],n=i);e[n]++}static decrement(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]<r&&(r=t[i],n=i);e[n]--}static isFinderPattern(e){let t=e[0]+e[1],n=t/(t+e[2]+e[3]);if(n>=s.MIN_FINDER_PATTERN_RATIO&&n<=s.MAX_FINDER_PATTERN_RATIO){let t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;for(let r of e)r>n&&(n=r),r<t&&(t=r);return n<10*t}return!1}}t.default=s,s.MAX_AVG_VARIANCE=.2,s.MAX_INDIVIDUAL_VARIANCE=.45,s.MIN_FINDER_PATTERN_RATIO=9.5/12,s.MAX_FINDER_PATTERN_RATIO=12.5/14},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(41);class i{constructor(e,t,n,i,l){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new r.default(n,l)),this.resultPoints.push(new r.default(i,l))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof i))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{RSSUtils(){}static getRSSvalue(e,t,n){let i=0;for(let t of e)i+=t;let l=0,s=0,o=e.length;for(let a=0;a<o-1;a++){let u;for(u=1,s|=1<<a;u<e[a];u++,s&=~(1<<a)){let e=r.combins(i-u-1,o-a-2);if(n&&0===s&&i-u-(o-a-1)>=o-a-1&&(e-=r.combins(i-u-(o-a),o-a-2)),o-a-1>1){let n=0;for(let e=i-u-(o-a-2);e>t;e--)n+=r.combins(i-u-e-1,o-a-3);e-=n*(o-1-a)}else i-u>t&&e--;l+=e}i-=u}return l}static combins(e,t){let n,r;e-t>t?(r=t,n=e-t):(r=e-t,n=t);let i=1,l=1;for(let t=e;t>n;t--)i*=t,l<=r&&(i/=l,l++);for(;l<=r;)i/=l,l++;return i}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(50),l=n(57),s=n(41),o=n(86),a=n(21),u=n(49),h=n(5);class d extends o.default{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,n){let o=this.decodeStart(t),u=this.decodeEnd(t),c=new a.default;d.decodeMiddle(t,o[1],u[0],c);let p=c.toString(),f=null;null!=n&&(f=n.get(i.default.ALLOWED_LENGTHS)),null==f&&(f=d.DEFAULT_ALLOWED_LENGTHS);let g=p.length,m=!1,E=0;for(let e of f){if(g===e){m=!0;break}e>E&&(E=e)}if(!m&&g>E&&(m=!0),!m)throw new h.FormatException;const C=[new s.default(o[1],e),new s.default(u[0],e)];return new l.default(p,null,0,C,r.default.ITF,(new Date).getTime())}static decodeMiddle(e,t,n,r){let i=new Array(10),l=new Array(5),s=new Array(5);for(i.fill(0),l.fill(0),s.fill(0);t<n;){o.default.recordPattern(e,t,i);for(let e=0;e<5;e++){let t=2*e;l[e]=i[t],s[e]=i[t+1]}let n=d.decodeDigit(l);r.append(n.toString()),n=this.decodeDigit(s),r.append(n.toString()),i.forEach((function(e){t+=e}))}}decodeStart(e){let t=d.skipWhiteSpace(e),n=d.findGuardPattern(e,t,d.START_PATTERN);return this.narrowLineWidth=(n[1]-n[0])/4,this.validateQuietZone(e,n[0]),n}validateQuietZone(e,t){let n=10*this.narrowLineWidth;n=n<t?n:t;for(let r=t-1;n>0&&r>=0&&!e.get(r);r--)n--;if(0!==n)throw new h.NotFoundException}static skipWhiteSpace(e){const t=e.getSize(),n=e.getNextSet(0);if(n===t)throw new h.NotFoundException;return n}decodeEnd(e){e.reverse();try{let t,n=d.skipWhiteSpace(e);try{t=d.findGuardPattern(e,n,d.END_PATTERN_REVERSED[0])}catch(r){t=d.findGuardPattern(e,n,d.END_PATTERN_REVERSED[1])}this.validateQuietZone(e,t[0]);let r=t[0];return t[0]=e.getSize()-t[1],t[1]=e.getSize()-r,t}finally{e.reverse()}}static findGuardPattern(e,t,n){let r=n.length,i=new Array(r),l=e.getSize(),s=!1,a=0,c=t;i.fill(0);for(let h=t;h<l;h++)if(e.get(h)!==s)i[a]++;else{if(a===r-1){if(o.default.patternMatchVariance(i,n,d.MAX_INDIVIDUAL_VARIANCE)<d.MAX_AVG_VARIANCE)return[c,h];c+=i[0]+i[1],u.default.arraycopy(i,2,i,0,a-1),i[a-1]=0,i[a]=0,a--}else a++;i[a]=1,s=!s}throw new h.NotFoundException}static decodeDigit(e){let t=d.MAX_AVG_VARIANCE,n=-1,r=d.PATTERNS.length;for(let i=0;i<r;i++){let r=d.PATTERNS[i],l=o.default.patternMatchVariance(e,r,d.MAX_INDIVIDUAL_VARIANCE);l<t?(t=l,n=i):l===t&&(n=-1)}if(n>=0)return n%10;throw new h.NotFoundException}}t.default=d,d.W=3,d.w=2,d.N=1,d.PATTERNS=[[1,1,2,2,1],[2,1,1,1,2],[1,2,1,1,2],[2,2,1,1,1],[1,1,2,1,2],[2,1,2,1,1],[1,2,2,1,1],[1,1,1,2,2],[2,1,1,2,1],[1,2,1,2,1],[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]],d.MAX_AVG_VARIANCE=.38,d.MAX_INDIVIDUAL_VARIANCE=.5,d.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],d.START_PATTERN=[1,1,1,1],d.END_PATTERN_REVERSED=[[1,1,2],[1,1,3]]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(34),l=n(282);class s extends l.default{constructor(){super(),this.decodeMiddleCounters=[0,0,0,0]}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),o=t[1],a=0;for(let t=0;t<6&&o<i;t++){let i=l.default.decodeDigit(e,r,o,l.default.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+i%10);for(let e of r)o+=e;i>=10&&(a|=1<<5-t)}n=s.determineFirstDigit(n,a),o=l.default.findGuardPattern(e,o,!0,l.default.MIDDLE_PATTERN,new Array(l.default.MIDDLE_PATTERN.length).fill(0))[1];for(let t=0;t<6&&o<i;t++){let t=l.default.decodeDigit(e,r,o,l.default.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of r)o+=e}return{rowOffset:o,resultString:n}}getBarcodeFormat(){return i.default.EAN_13}static determineFirstDigit(e,t){for(let n=0;n<10;n++)if(t===this.FIRST_DIGIT_ENCODINGS[n])return e=String.fromCharCode("0".charCodeAt(0)+n)+e;throw new r.NotFoundException}}t.default=s,s.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(50),l=n(57),s=n(85),o=n(41),a=n(501),u=n(156),h=n(5);class d extends u.default{constructor(){super(),this.decodeRowStringBuffer="",d.L_AND_G_PATTERNS=d.L_PATTERNS.map((function(e){return e.slice()}));for(let e=10;e<20;e++){let t=d.L_PATTERNS[e-10],n=new Array(t.length);for(let e=0;e<t.length;e++)n[e]=t[t.length-e-1];d.L_AND_G_PATTERNS[e]=n}}decodeRow(e,t,n){let u=d.findStartGuardPattern(t),c=null==n?null:n.get(i.default.NEED_RESULT_POINT_CALLBACK);if(null!=c){const t=new o.default((u[0]+u[1])/2,e);c.foundPossibleResultPoint(t)}let p=this.decodeMiddle(t,u,this.decodeRowStringBuffer),f=p.rowOffset,g=p.resultString;if(null!=c){const t=new o.default(f,e);c.foundPossibleResultPoint(t)}let m=d.decodeEnd(t,f);if(null!=c){const t=new o.default((m[0]+m[1])/2,e);c.foundPossibleResultPoint(t)}let E=m[1],C=E+(E-m[0]);if(C>=t.getSize()||!t.isRange(E,C,!1))throw new h.NotFoundException;let A=g.toString();if(A.length<8)throw new h.FormatException;if(!d.checkChecksum(A))throw new h.ChecksumException;let y=(u[1]+u[0])/2,I=(m[1]+m[0])/2,S=this.getBarcodeFormat(),_=[new o.default(y,e),new o.default(I,e)],w=new l.default(A,null,0,_,S,(new Date).getTime()),b=0;try{let n=a.default.decodeRow(e,t,m[1]);w.putMetadata(s.default.UPC_EAN_EXTENSION,n.getText()),w.putAllMetadata(n.getResultMetadata()),w.addResultPoints(n.getResultPoints()),b=n.getText().length}catch(e){}let x=null==n?null:n.get(i.default.ALLOWED_EAN_EXTENSIONS);if(null!=x){let e=!1;for(let t in x)if(b.toString()===t){e=!0;break}if(!e)throw new h.NotFoundException}return S===r.default.EAN_13||r.default.UPC_A,w}static checkChecksum(e){return d.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(0===t)return!1;let n=parseInt(e.charAt(t-1),10);return d.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let t=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new h.FormatException;n+=t}n*=3;for(let r=t-2;r>=0;r-=2){let t=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new h.FormatException;n+=t}return(1e3-n)%10}static decodeEnd(e,t){return d.findGuardPattern(e,t,!1,d.START_END_PATTERN,new Array(d.START_END_PATTERN.length).fill(0))}}t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(50),i=n(34),l=n(204),s=n(197),o=n(200),a=n(202),u=n(287),h=n(5);t.default=class{decode(e,t){return this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return null!==this.readers&&void 0!==this.readers||this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const t=null!=e&&void 0!==e.get(r.default.TRY_HARDER),n=null==e?null:e.get(r.default.POSSIBLE_FORMATS),h=new Array;if(null!=n){const r=n.some(e=>e===i.default.UPC_A||e===i.default.UPC_E||e===i.default.EAN_13||e===i.default.EAN_8||e===i.default.CODABAR||e===i.default.CODE_39||e===i.default.CODE_93||e===i.default.CODE_128||e===i.default.ITF||e===i.default.RSS_14||e===i.default.RSS_EXPANDED);r&&!t&&h.push(new o.default(e)),n.includes(i.default.QR_CODE)&&h.push(new l.default),n.includes(i.default.DATA_MATRIX)&&h.push(new a.default),n.includes(i.default.AZTEC)&&h.push(new s.default),n.includes(i.default.PDF_417)&&h.push(new u.default),r&&t&&h.push(new o.default(e))}0===h.length&&(t||h.push(new o.default(e)),h.push(new l.default),h.push(new a.default),h.push(new s.default),h.push(new u.default),t&&h.push(new o.default(e))),this.readers=h}reset(){if(null!==this.readers)for(const e of this.readers)e.reset()}decodeInternal(e){if(null===this.readers)throw new h.ReaderException("No readers where selected, nothing can be read.");for(const t of this.readers)try{return t.decode(e,this.hints)}catch(e){if(e instanceof h.ReaderException)continue}throw new h.NotFoundException("No MultiFormat Readers were able to detect the code.")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(157),i=n(84);class l{constructor(e){this.errorCorrectionLevel=r.default.forBits(e>>3&3),this.dataMask=7&e}static numBitsDiffering(e,t){return i.default.bitCount(e^t)}static decodeFormatInformation(e,t){const n=l.doDecodeFormatInformation(e,t);return null!==n?n:l.doDecodeFormatInformation(e^l.FORMAT_INFO_MASK_QR,t^l.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let n=Number.MAX_SAFE_INTEGER,r=0;for(const i of l.FORMAT_INFO_DECODE_LOOKUP){const s=i[0];if(s===e||s===t)return new l(i[1]);let o=l.numBitsDiffering(e,s);o<n&&(r=i[1],n=o),e!==t&&(o=l.numBitsDiffering(t,s),o<n&&(r=i[1],n=o))}return n<=3?new l(r):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof l))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}t.default=l,l.FORMAT_INFO_MASK_QR=21522,l.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||null===e||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModeValues=void 0;const r=n(5);var i;!function(e){e[e.TERMINATOR=0]="TERMINATOR",e[e.NUMERIC=1]="NUMERIC",e[e.ALPHANUMERIC=2]="ALPHANUMERIC",e[e.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",e[e.BYTE=4]="BYTE",e[e.ECI=5]="ECI",e[e.KANJI=6]="KANJI",e[e.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",e[e.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",e[e.HANZI=9]="HANZI"}(i=t.ModeValues||(t.ModeValues={}));class l{constructor(e,t,n,r){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=n,this.bits=r,l.FOR_BITS.set(r,this),l.FOR_VALUE.set(e,this)}static forBits(e){const t=l.FOR_BITS.get(e);if(void 0===t)throw new r.IllegalArgumentException;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let n;return n=t<=9?0:t<=26?1:2,this.characterCountBitsForVersions[n]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof l))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}t.default=l,l.FOR_BITS=new Map,l.FOR_VALUE=new Map,l.TERMINATOR=new l(i.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),l.NUMERIC=new l(i.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),l.ALPHANUMERIC=new l(i.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),l.STRUCTURED_APPEND=new l(i.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),l.BYTE=new l(i.BYTE,"BYTE",Int32Array.from([8,16,16]),4),l.ECI=new l(i.ECI,"ECI",Int32Array.from([0,0,0]),7),l.KANJI=new l(i.KANJI,"KANJI",Int32Array.from([8,10,12]),8),l.FNC1_FIRST_POSITION=new l(i.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),l.FNC1_SECOND_POSITION=new l(i.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),l.HANZI=new l(i.HANZI,"HANZI",Int32Array.from([8,10,12]),13)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(57),l=n(102),s=n(84),o=n(85),a=n(526),u=n(528),h=n(5);class d{decode(e,t=null){let n=d.decode(e,t,!1);if(null==n||0===n.length||null==n[0])throw h.NotFoundException.getNotFoundInstance();return n[0]}decodeMultiple(e,t=null){try{return d.decode(e,t,!0)}catch(e){if(e instanceof h.FormatException||e instanceof h.ChecksumException)throw h.NotFoundException.getNotFoundInstance();throw e}}static decode(e,t,n){const l=new Array,s=a.default.detectMultiple(e,t,n);for(const e of s.getPoints()){const t=u.default.decode(s.getBits(),e[4],e[5],e[6],e[7],d.getMinCodewordWidth(e),d.getMaxCodewordWidth(e)),n=new i.default(t.getText(),t.getRawBytes(),void 0,e,r.default.PDF_417);n.putMetadata(o.default.ERROR_CORRECTION_LEVEL,t.getECLevel());const a=t.getOther();null!=a&&n.putMetadata(o.default.PDF417_EXTRA_METADATA,a),l.push(n)}return l.map(e=>e)}static getMaxWidth(e,t){return null==e||null==t?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return null==e||null==t?s.default.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(d.getMaxWidth(e[0],e[4]),d.getMaxWidth(e[6],e[2])*l.default.MODULES_IN_CODEWORD/l.default.MODULES_IN_STOP_PATTERN),Math.max(d.getMaxWidth(e[1],e[5]),d.getMaxWidth(e[7],e[3])*l.default.MODULES_IN_CODEWORD/l.default.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(d.getMinWidth(e[0],e[4]),d.getMinWidth(e[6],e[2])*l.default.MODULES_IN_CODEWORD/l.default.MODULES_IN_STOP_PATTERN),Math.min(d.getMinWidth(e[1],e[5]),d.getMinWidth(e[7],e[3])*l.default.MODULES_IN_CODEWORD/l.default.MODULES_IN_STOP_PATTERN)))}reset(){}}t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(49),l=n(21);class s{constructor(e,t){if(0===t.length)throw new r.IllegalArgumentException;this.field=e;let n=t.length;if(n>1&&0===t[0]){let e=1;for(;e<n&&0===t[e];)e++;e===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-e),i.default.arraycopy(t,e,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(0===e)return this.getCoefficient(0);if(1===e){let e=0;for(let t of this.coefficients)e=this.field.add(e,t);return e}let t=this.coefficients[0],n=this.coefficients.length;for(let r=1;r<n;r++)t=this.field.add(this.field.multiply(e,t),this.coefficients[r]);return t}add(e){if(!this.field.equals(e.field))throw new r.IllegalArgumentException("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){let e=t;t=n,n=e}let l=new Int32Array(n.length),o=n.length-t.length;i.default.arraycopy(n,0,l,0,o);for(let e=o;e<n.length;e++)l[e]=this.field.add(t[e-o],n[e]);return new s(this.field,l)}subtract(e){if(!this.field.equals(e.field))throw new r.IllegalArgumentException("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof s?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new r.IllegalArgumentException("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new s(this.field,new Int32Array([0]));let t=this.coefficients,n=t.length,i=e.coefficients,l=i.length,o=new Int32Array(n+l-1);for(let e=0;e<n;e++){let n=t[e];for(let t=0;t<l;t++)o[e+t]=this.field.add(o[e+t],this.field.multiply(n,i[t]))}return new s(this.field,o)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=this.field.subtract(0,this.coefficients[n]);return new s(this.field,t)}multiplyScalar(e){if(0===e)return new s(this.field,new Int32Array([0]));if(1===e)return this;let t=this.coefficients.length,n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new s(this.field,n)}multiplyByMonomial(e,t){if(e<0)throw new r.IllegalArgumentException;if(0===t)return new s(this.field,new Int32Array([0]));let n=this.coefficients.length,i=new Int32Array(n+e);for(let e=0;e<n;e++)i[e]=this.field.multiply(this.coefficients[e],t);return new s(this.field,i)}toString(){let e=new l.default;for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);0!==n&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),0!==t&&1===n||e.append(n),0!==t&&(1===t?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(41),i=n(5);class l{constructor(e,t,n,r,i){e instanceof l?this.constructor_2(e):this.constructor_1(e,t,n,r,i)}constructor_1(e,t,n,l,s){const o=null==t||null==n,a=null==l||null==s;if(o&&a)throw new i.NotFoundException;o?(t=new r.default(0,l.getY()),n=new r.default(0,s.getY())):a&&(l=new r.default(e.getWidth()-1,t.getY()),s=new r.default(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=l,this.bottomRight=s,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(l.getX(),s.getX())),this.minY=Math.trunc(Math.min(t.getY(),l.getY())),this.maxY=Math.trunc(Math.max(n.getY(),s.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return null==e?t:null==t?e:new l(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,n){let i=this.topLeft,s=this.bottomLeft,o=this.topRight,a=this.bottomRight;if(e>0){let t=n?this.topLeft:this.topRight,l=Math.trunc(t.getY()-e);l<0&&(l=0);let s=new r.default(t.getX(),l);n?i=s:o=s}if(t>0){let e=n?this.bottomLeft:this.bottomRight,i=Math.trunc(e.getY()+t);i>=this.image.getHeight()&&(i=this.image.getHeight()-1);let l=new r.default(e.getX(),i);n?s=l:a=l}return new l(this.image,i,s,o,a)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(206),i=n(289);class l{constructor(e){this.boundingBox=new i.default(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(null!=t)return t;for(let n=1;n<l.MAX_NEARBY_DISTANCE;n++){let r=this.imageRowToCodewordIndex(e)-n;if(r>=0&&(t=this.codewords[r],null!=t))return t;if(r=this.imageRowToCodewordIndex(e)+n,r<this.codewords.length&&(t=this.codewords[r],null!=t))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new r.default;let t=0;for(const n of this.codewords)null!=n?e.format("%3d: %3d|%3d%n",t++,n.getRowNumber(),n.getValue()):e.format("%3d:    |   %n",t++);return e.toString()}}t.default=l,l.MAX_NEARBY_DISTANCE=5},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(102);t.default=class{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);null==t&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[n,r]of this.values.entries()){const i={getKey:()=>n,getValue:()=>r};i.getValue()>e?(e=i.getValue(),t=[],t.push(i.getKey())):i.getValue()===e&&t.push(i.getKey())}return r.default.toIntArray(t)}getConfidence(e){return this.values.get(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserQRCodeSvgWriter=void 0;const r=n(158),i=n(207),l=n(157),s=n(5);class o{constructor(){this.Margin=null}set setMargin(e){this.Margin=e}write(e,t,n,a=null){if(0===e.length)throw new s.IllegalArgumentException("Found empty contents");if(t<0||n<0)throw new s.IllegalArgumentException("Requested dimensions are too small: "+t+"x"+n);let u=l.default.L,h=o.QUIET_ZONE_SIZE;null!==a&&(void 0!==a.get(r.default.ERROR_CORRECTION)&&(u=l.default.fromString(a.get(r.default.ERROR_CORRECTION).toString())),void 0!==a.get(r.default.MARGIN)&&(h=Number.parseInt(a.get(r.default.MARGIN).toString(),10))),null!=this.Margin&&(h=this.Margin);const d=i.default.encode(e,u,a);return this.renderResult(d,t,n,h)}writeToDom(e,t,n,r,i=null){"string"==typeof e&&(e=document.querySelector(e));const l=this.write(t,n,r,i);e&&e.appendChild(l)}renderResult(e,t,n,r){const i=e.getMatrix();if(null===i)throw new s.IllegalStateException;const l=i.getWidth(),o=i.getHeight(),a=l+2*r,u=o+2*r,h=Math.max(t,a),d=Math.max(n,u),c=Math.min(Math.floor(h/a),Math.floor(d/u)),p=Math.floor((h-l*c)/2),f=Math.floor((d-o*c)/2),g=this.createSVGElement(h,d);for(let e=0,t=f;e<o;e++,t+=c)for(let n=0,r=p;n<l;n++,r+=c)if(1===i.get(n,e)){const e=this.createSvgRectElement(r,t,c,c);g.appendChild(e)}return g}createSVGElement(e,t){const n=document.createElementNS(o.SVG_NS,"svg");return n.setAttributeNS(null,"height",e.toString()),n.setAttributeNS(null,"width",t.toString()),n}createSvgRectElement(e,t,n,r){const i=document.createElementNS(o.SVG_NS,"rect");return i.setAttributeNS(null,"x",e.toString()),i.setAttributeNS(null,"y",t.toString()),i.setAttributeNS(null,"height",n.toString()),i.setAttributeNS(null,"width",r.toString()),i.setAttributeNS(null,"fill","#000000"),i}}t.BrowserQRCodeSvgWriter=o,o.QUIET_ZONE_SIZE=4,o.SVG_NS="http://www.w3.org/2000/svg"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(153),i=n(49),l=n(5);t.default=class{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new r.default(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let n=t[t.length-1];const i=this.field;for(let l=t.length;l<=e;l++){const e=n.multiply(new r.default(i,Int32Array.from([1,i.exp(l-1+i.getGeneratorBase())])));t.push(e),n=e}}return t[e]}encode(e,t){if(0===t)throw new l.IllegalArgumentException("No error correction bytes");const n=e.length-t;if(n<=0)throw new l.IllegalArgumentException("No data bytes provided");const s=this.buildGenerator(t),o=new Int32Array(n);i.default.arraycopy(e,0,o,0,n);let a=new r.default(this.field,o);a=a.multiplyByMonomial(t,1);const u=a.divide(s)[1].getCoefficients(),h=t-u.length;for(let t=0;t<h;t++)e[n+t]=0;i.default.arraycopy(u,0,e,n+h,u.length)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);class i{constructor(){}static applyMaskPenaltyRule1(e){return i.applyMaskPenaltyRule1Internal(e,!0)+i.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const n=e.getArray(),r=e.getWidth(),l=e.getHeight();for(let e=0;e<l-1;e++){const i=n[e];for(let l=0;l<r-1;l++){const r=i[l];r===i[l+1]&&r===n[e+1][l]&&r===n[e+1][l+1]&&t++}}return i.N2*t}static applyMaskPenaltyRule3(e){let t=0;const n=e.getArray(),r=e.getWidth(),l=e.getHeight();for(let e=0;e<l;e++)for(let s=0;s<r;s++){const o=n[e];s+6<r&&1===o[s]&&0===o[s+1]&&1===o[s+2]&&1===o[s+3]&&1===o[s+4]&&0===o[s+5]&&1===o[s+6]&&(i.isWhiteHorizontal(o,s-4,s)||i.isWhiteHorizontal(o,s+7,s+11))&&t++,e+6<l&&1===n[e][s]&&0===n[e+1][s]&&1===n[e+2][s]&&1===n[e+3][s]&&1===n[e+4][s]&&0===n[e+5][s]&&1===n[e+6][s]&&(i.isWhiteVertical(n,s,e-4,e)||i.isWhiteVertical(n,s,e+7,e+11))&&t++}return t*i.N3}static isWhiteHorizontal(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(let r=t;r<n;r++)if(1===e[r])return!1;return!0}static isWhiteVertical(e,t,n,r){n=Math.max(n,0),r=Math.min(r,e.length);for(let i=n;i<r;i++)if(1===e[i][t])return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const n=e.getArray(),r=e.getWidth(),l=e.getHeight();for(let e=0;e<l;e++){const i=n[e];for(let e=0;e<r;e++)1===i[e]&&t++}const s=e.getHeight()*e.getWidth();return Math.floor(10*Math.abs(2*t-s)/s)*i.N4}static getDataMaskBit(e,t,n){let i,l;switch(e){case 0:i=n+t&1;break;case 1:i=1&n;break;case 2:i=t%3;break;case 3:i=(n+t)%3;break;case 4:i=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:l=n*t,i=(1&l)+l%3;break;case 6:l=n*t,i=(1&l)+l%3&1;break;case 7:l=n*t,i=l%3+(n+t&1)&1;break;default:throw new r.IllegalArgumentException("Invalid mask pattern: "+e)}return 0===i}static applyMaskPenaltyRule1Internal(e,t){let n=0;const r=t?e.getHeight():e.getWidth(),l=t?e.getWidth():e.getHeight(),s=e.getArray();for(let e=0;e<r;e++){let r=0,o=-1;for(let a=0;a<l;a++){const l=t?s[e][a]:s[a][e];l===o?r++:(r>=5&&(n+=i.N1+(r-5)),r=1,o=l)}r>=5&&(n+=i.N1+(r-5))}return n}}t.default=i,i.N1=3,i.N2=3,i.N3=40,i.N4=10},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(158),l=n(78),s=n(157),o=n(207),a=n(5);class u{encode(e,t,n,l,h){if(0===e.length)throw new a.IllegalArgumentException("Found empty contents");if(t!==r.default.QR_CODE)throw new a.IllegalArgumentException("Can only encode QR_CODE, but got "+t);if(n<0||l<0)throw new a.IllegalArgumentException(`Requested dimensions are too small: ${n}x${l}`);let d=s.default.L,c=u.QUIET_ZONE_SIZE;null!==h&&(void 0!==h.get(i.default.ERROR_CORRECTION)&&(d=s.default.fromString(h.get(i.default.ERROR_CORRECTION).toString())),void 0!==h.get(i.default.MARGIN)&&(c=Number.parseInt(h.get(i.default.MARGIN).toString(),10)));const p=o.default.encode(e,d,h);return u.renderResult(p,n,l,c)}static renderResult(e,t,n,r){const i=e.getMatrix();if(null===i)throw new a.IllegalStateException;const s=i.getWidth(),o=i.getHeight(),u=s+2*r,h=o+2*r,d=Math.max(t,u),c=Math.max(n,h),p=Math.min(Math.floor(d/u),Math.floor(c/h)),f=Math.floor((d-s*p)/2),g=Math.floor((c-o*p)/2),m=new l.default(d,c);for(let e=0,t=g;e<o;e++,t+=p)for(let n=0,r=f;n<s;n++,r+=p)1===i.get(n,e)&&m.setRegion(r,t,p,p);return m}}t.default=u,u.QUIET_ZONE_SIZE=4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(21),i=n(556),l=n(557),s=n(558),o=n(559),a=n(560),u=n(5);class h{constructor(e){this.buffer=new r.default,this.information=e}decodeAllCodes(e,t){let n=t,r=null;for(;;){let t=this.decodeGeneralPurposeField(n,r),i=o.default.parseFieldsInGeneralPurpose(t.getNewString());if(null!=i&&e.append(i),r=t.isRemaining()?""+t.getRemainingValue():null,n==t.getNewPosition())break;n=t.getNewPosition()}return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let t=this.extractNumericValueFromBitArray(e,4);return 0==t?new l.default(this.information.getSize(),l.default.FNC1,l.default.FNC1):new l.default(this.information.getSize(),t-1,l.default.FNC1)}let t=this.extractNumericValueFromBitArray(e,7),n=(t-8)/11,r=(t-8)%11;return new l.default(e+7,n,r)}extractNumericValueFromBitArray(e,t){return h.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,n){let r=0;for(let i=0;i<n;++i)e.get(t+i)&&(r|=1<<n-i-1);return r}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),null!=t&&this.buffer.append(t),this.current.setPosition(e);let n=this.parseBlocks();return null!=n&&n.isRemaining()?new s.default(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new s.default(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let n=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),!(n!=this.current.getPosition())&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return t=e.isSecondDigitFNC1()?new s.default(this.current.getPosition(),this.buffer.toString()):new s.default(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new a.default(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let e=new s.default(this.current.getPosition(),this.buffer.toString());return new a.default(!0,e)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new a.default(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let e=new s.default(this.current.getPosition(),this.buffer.toString());return new a.default(!0,e)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new a.default(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let e=new s.default(this.current.getPosition(),this.buffer.toString());return new a.default(!0,e)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new a.default(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,8);return r>=232&&r<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(15==t)return new i.default(e+5,i.default.FNC1);if(t>=5&&t<15)return new i.default(e+5,"0"+(t-5));let n,r=this.extractNumericValueFromBitArray(e,7);if(r>=64&&r<90)return new i.default(e+7,""+(r+1));if(r>=90&&r<116)return new i.default(e+7,""+(r+7));switch(this.extractNumericValueFromBitArray(e,8)){case 232:n="!";break;case 233:n='"';break;case 234:n="%";break;case 235:n="&";break;case 236:n="'";break;case 237:n="(";break;case 238:n=")";break;case 239:n="*";break;case 240:n="+";break;case 241:n=",";break;case 242:n="-";break;case 243:n=".";break;case 244:n="/";break;case 245:n=":";break;case 246:n=";";break;case 247:n="<";break;case 248:n="=";break;case 249:n=">";break;case 250:n="?";break;case 251:n="_";break;case 252:n=" ";break;default:throw new u.FormatException}return new i.default(e+8,n)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(15==t)return new i.default(e+5,i.default.FNC1);if(t>=5&&t<15)return new i.default(e+5,"0"+(t-5));let n,r=this.extractNumericValueFromBitArray(e,6);if(r>=32&&r<58)return new i.default(e+6,""+(r+33));switch(r){case 58:n="*";break;case 59:n=",";break;case 60:n="-";break;case 61:n=".";break;case 62:n="/";break;default:throw new u.IllegalStateException("Decoding invalid alphanumeric value: "+r)}return new i.default(e+6,n)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(2==t){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(296);t.default=class{constructor(e){this.information=e,this.generalDecoder=new r.default(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(299),i=n(21),l=n(5);class s extends r.default{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=s.HEADER_SIZE+r.default.GTIN_SIZE+s.WEIGHT_SIZE)throw new l.NotFoundException;let e=new i.default;return this.encodeCompressedGtin(e,s.HEADER_SIZE),this.encodeCompressedWeight(e,s.HEADER_SIZE+r.default.GTIN_SIZE,s.WEIGHT_SIZE),e.toString()}}t.default=s,s.HEADER_SIZE=5,s.WEIGHT_SIZE=15},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(159);class i extends r.default{constructor(e){super(e)}encodeCompressedWeight(e,t,n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,n);this.addWeightCode(e,r);let i=this.checkWeight(r),l=1e5;for(let t=0;t<5;++t)i/l==0&&e.append("0"),l/=10;e.append(i)}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cursors=void 0;t.Cursors=class{static get AppStarting(){return"default"}static get PanSW(){return"all-scroll"}static get PanSouth(){return"all-scroll"}static get PanSE(){return"all-scroll"}static get PanNW(){return"all-scroll"}static get PanNorth(){return"all-scroll"}static get PanNE(){return"all-scroll"}static get PanEast(){return"all-scroll"}static get NoMoveVert(){return"all-scroll"}static get NoMoveHoriz(){return"all-scroll"}static get NoMove2D(){return"all-scroll"}static get VSplit(){return"col-resize"}static get HSplit(){return"row-resize"}static get Help(){return"help"}static get WaitCursor(){return"wait"}static get UpArrow(){return"pointer"}static get SizeWE(){return"e-resize"}static get SizeNWSE(){return"se-resize"}static get SizeNS(){return"n-resize"}static get SizeNESW(){return"ne-resize"}static get SizeAll(){return"default"}static get No(){return"not-allowed"}static get IBeam(){return"text"}static get Default(){return"default"}static get Cross(){return"crosshair"}static get Arrow(){return"default"}static get PanWest(){return"default"}static get Hand(){return"pointer"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontFamily=void 0;t.FontFamily=class{constructor(e,t){this.nameEN=null,this.nameCN=null,this.nameEN=e,this.nameCN=t}IsStyleAvailable(e){return!1}GetCellAscent(e){return 0}GetCellDescent(e){return 0}GetEmHeight(e){return 0}GetLineSpacing(e){return 0}GetName(){return this.nameEN}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XLineEleRangeUtil=void 0;const r=n(116),i=n(581),l=n(582),s=n(3),o=n(0),a=n(303);class u{constructor(e){this.selRange=null,this.lastSelRects=null,this.cellRangeUtil=null,this.selRange=e,this.cellRangeUtil=new l.XTableCellRangeUtil}ClearLastSelRects(){if(null!=this.lastSelRects){let e=this.lastSelRects;for(let t=0;t<e.length;t++){e[t].Clear()}this.lastSelRects=null}}CalcLineRectRanges(e){let t;if(!e&&null!=this.lastSelRects)return t=this.lastSelRects,t;let n=new s.List,r=new s.List,l=this.FetchSelLineList(n,r);if(n.Count()<=0)return t=null,t;let a=l[0].Line,u=l[1].Line,h=l[0].EleIx,d=l[1].EleIx,c=o.XDomUtil.GetXTableOfCell(a.FirstElement instanceof o.XTextTableCell?a.FirstElement:null),p=o.XDomUtil.GetXTableOfCell(u.FirstElement instanceof o.XTextTableCell?u.FirstElement:null),f=new s.List;for(let e of n){e.GetLineNestLayerNo();let t=null,n=o.XDomUtil.GetXTableOfCell(e.FirstElement instanceof o.XTextTableCell?e.FirstElement:null);if(null!=n){let i=0,l=-1;if(n==c&&n==p){const e=r.Find(e=>n.XID==e.TableXID);i=e.FromCIX,l=e.ToCIX}if(t=e.LineAssist.GetSelRangeRects(i,l),n.BoundsDISP.Y>0&&(0==e.Index?t[0].Height+=n.BoundsDISP.Y:t[0].Y+=n.BoundsDISP.Y),null==e.NextLine){let e=n.OwnerLine.GetRealParaghSpacingAfter(96);e=Math.round(100*e)/100,e-=.5,e>0&&(t[0].Height+=e)}}else{let n=!0,r=0,i=-1;0==e.CmprByLineInx(a)?(a==u&&(i=d),r=h):0==e.CmprByLineInx(u)&&(a!=u?i=d:n=!1),n&&(t=e.LineAssist.GetSelRangeRects(r,i))}if(null!=t){let n=e.LineAssist.GetRootLine(),r=new i.OneLineSelRects(e,n.Index,t);f.Add(r)}}return this.lastSelRects=f.ToArray(),f.Clear(),t=this.lastSelRects,t}GetLineBaseElesInRange(e=!0,t=!0){let n=this.GetLineElesInRange(e,t);if((null==n?0:n.length)<=0)return null;let r=new s.List,i=new s.List,l=n;for(let n=0;n<l.length;n++){let s=l[n],a=s instanceof o.XBaseContainer?s:null;if(null==a)r.Add(s);else{i.Clear(),a.GetChildrenCanBeInline(i,!0);let n=this._FiltUnselectableEles(i,e,t);r.AddRange(n)}}return r.ToArray()}GetLineElesInRange(e=!0,t=!0,n=!1){let r=new s.List,i=new s.List,l=this.FetchSelLineList(r,i);if(r.Count()<=0)return null;const a=l[0].Line,u=l[1].Line,h=l[0].EleIx,d=l[1].EleIx,c=o.XDomUtil.GetXTableOfCell(a.FirstElement instanceof o.XTextTableCell?a.FirstElement:null),p=o.XDomUtil.GetXTableOfCell(u.FirstElement instanceof o.XTextTableCell?u.FirstElement:null);let f=new s.List,g=null;for(let e of r){e.GetLineNestLayerNo();let t=o.XDomUtil.GetXTableOfCell(e.FirstElement instanceof o.XTextTableCell?e.FirstElement:null);if(null!=t){let n=i.Find(e=>t.XID==e.TableXID);g=t==c&&t==p?e.GetElesInRange(n.FromCIX,n.ToCIX):e.GetElesInRange(0,-1)}else if(0==e.CmprByLineInx(a))g=a.Index==u.Index&&a.Container==u.Container?e.GetElesInRange(h,d):e.GetElesInRange(h,-1);else if(0==e.CmprByLineInx(u)){l[1].RefreshEleObj;a!=u&&(g=e.GetElesInRange(0,d))}else g=e.GetElesInRange(0,-1);null!=g&&f.AddRange(g)}let m=new s.List;m=n?f:this.CompleteInputHalf(f.ToArray(),d);let E=this._FiltUnselectableEles(m,e,t);return f.Clear(),E}GetLineParaghFlagsInRange(){let e,t=new s.List,n=new s.List;this.FetchSelLineList(t,n);if(t.Count()<=0)e=null;else{let r=0,i=1073741823;if(1==n.Count()){let e=n.Get(0);r=e.FromCIX,i=e.ToCIX}let l=new s.List;for(let e of t)this._RecurGetParaghElesInLine(e,r,i,l);let o=l.ToArray();l.Clear(),e=o}return e}IsInTableSelRange(){let e;if(null==this.selRange||!this.selRange.IsValid())return e=!1,e;let t=this.selRange.FromLineEle instanceof o.XTextTableCell?this.selRange.FromLineEle:null;if(null==t)return e=!1,e;let n=this.selRange.ToLineEle instanceof o.XTextTableCell?this.selRange.ToLineEle:null;if(null==n)return e=!1,e;let r=o.XDomUtil.GetXTableOfCell(t),i=o.XDomUtil.GetXTableOfCell(n);return e=null!=r&&r==i,e}GetTableCellsInRange(e){let t,n=new s.List,r=new s.List,i=this.FetchSelLineList(n,r);if(n.Count()<=0)return t=null,t;let l=i[0].Line,a=i[1].Line,u=o.XDomUtil.GetXTableOfCell(l.FirstElement),h=o.XDomUtil.GetXTableOfCell(a.FirstElement),d=new s.List,c=!1;for(let t of n){let n=o.XDomUtil.GetXTableOfCell(t.FirstElement);if(null==n||null!=e&&n!=e){if(c)break}else{null==e||c||n!=e||(c=!0);let i,l=null!=n?r.Find(e=>n.XID==e.TableXID):null;if(i=null!=l&&n==u&&n==h?t.GetElesInRange(l.FromCIX,l.ToCIX):t.GetElesInRange(0,-1),null!=i){let e=i;for(let t=0;t<e.length;t++){let n=e[t];null!=n&&d.Add(n)}}}}return t=d,t}static GetNextLine2(e,t){let n;if(null==e)return n=null,n;let r=t?e.NextLine:e.PrevLine;if(null!=r)return r=u._TrySinkNextLine2(r,t),n=r,n;let i=e.Container;for(;null!=i;){let e=i.OwnerLine;if(r=null==e?null:t?e.NextLine:e.PrevLine,null!=r)break;if(i instanceof o.XPagePanelView)i=i.GetNextPage_PanelView(t);else if(i instanceof o.XTextTableCell){let e=i;i=o.XDomUtil.GetNextTableCell(e,t)}else{let e=i.OwnerLine;i=null==e?null:e.Container}if(null==i)break}return null!=r&&(r=u._TrySinkNextLine2(r,t)),n=r,n}static _TrySinkNextLine2(e,t){let n=o.XDomUtil.GetFirstEleFromLine(e,"XTextTable");if(n=n instanceof o.XTextTable?n:null,null!=n){let r=n instanceof o.XBaseContainer?n:null;t?e=r.GetFirstLine():(e=r.GetEndLine(),r.LinesList.AsEnumerable())}return e}FetchSelLineList(e,t){if(e.Clear(),null!=t&&t.Clear(),null==this.selRange||!this.selRange.IsValid())return null;let n=r.XLineEleRange.SortFromToLineEleIx(this.selRange.FromLineEleIx,this.selRange.ToLineEleIx),i=n[0].LineContainer;if(i.LinesCnt<=0)return null;let l=null,s=null,u=n[0].Line,h=n[1].Line,d=o.XDomUtil.GetXTableOfCell(u.FirstElement instanceof o.XTextTableCell?u.FirstElement:null),c=o.XDomUtil.GetXTableOfCell(h.FirstElement instanceof o.XTextTableCell?h.FirstElement:null),p=i.LinesList.GetEnumerator();for(;;){let n=i,[r,f,g]=this._GetNextLine(i,p);if(i=f,p=g,null==r)break;if(n instanceof o.XTextTableCell&&i!=n)break;let m=o.XDomUtil.GetXTableOfCell(r.FirstElement instanceof o.XTextTableCell?r.FirstElement:null);if(null==m||m!=d&&m!=c){if(r.CmprByLineInx(u)<0)continue;if(r.CmprByLineInx(h)>0)break}n instanceof o.XTextTable&&null!=n.OwnerLine&&i!=n&&t.Exists(e=>e.TableXID==n.XID_Test)&&e.Add(n.OwnerLine),null==m?e.Add(r):(m!=l&&(s=new a.OneTableCellsRange(m.XID),s.FirstLineIx=e.Count(),null!=t&&t.Add(s),l=m),s.AddTableViewLine(r,!1))}return this.cellRangeUtil.UpdateTableCellsRangeList(t,n[0],n[1]),this.cellRangeUtil.InsertTableSelLines(t,e),n}_GetNextLine(e,t){let n,r,i=null;if(t.MoveNext()){let r=this._TrySinkNextLine(e,t);return i=r[0],n=i,[n,e=r[1],t=r[2]]}let l=!0;for(;;){if(e instanceof o.XPagePanelView)e=e.GetNextPage_PanelView(!0),r=0;else if(e instanceof o.XTextTableCell){let t=e;e=o.XDomUtil.GetNextTableCell(t,!0),r=0}else{let t=e.OwnerLine;null==t?(e=null,r=-1):(e=t.Container,r=t.Index+1)}if(null==e||e.LinesCnt<1)break;if(r-e.GetFirstLine().Index<e.LinesCnt){l=!1;break}}if(l&&(r=-1),null!=e){for(t=e.LinesList.GetEnumerator();t.MoveNext();){if(t.Current.Index>=r)break}let n=this._TrySinkNextLine(e,t);i=n[0],e=n[1],t=n[2]}return n=i,[n,e,t]}_TrySinkNextLine(e,t){let n=t.Current,r=o.XDomUtil.GetFirstEleFromLine(n,"XTextTable");return null!=r&&r instanceof o.XTextTable&&r.NumOfRows>0&&(n=(t=(e=r instanceof o.XBaseContainer?r:null).LinesList.GetEnumerator()).MoveNext()?t.Current:null),[n,e,t]}_FiltUnselectableEles(e,t=!0,n=!0){let r,i=e.ToArray();if(i.length<=0)r=i;else{e.Clear();let l=!1,s=!1,a=i;for(let r=0;r<a.length;r++){let i=a[r];null!=i&&(n&&i.EleStyle.DeleterIndex>=0?l=!0:t&&o.XDomUtil.IsBkgTextOfXInput(i)?s=!0:e.Add(i))}(l||s)&&(i=e.ToArray()),e.Clear(),r=i}return r}CompleteInputHalf(e,t){let n=[],r=new s.List;if(!(null==e||e.length<=0)){let i=[],l=0;for(;l<e.length;){let r=e[l];if(null!=r)if("XLableInputBorder"==r.EleTypeName){const e=r.Parent,t=e.StartEle.XID;r.IsStartBorder?i.push(t):-1==i.indexOf(t)&&n.unshift(e.StartEle)}else if(l==e.length-1){const n=r.OwnerLine,i=t+1;if(null!=n&&n.ElementCnt>i){const t=n.ChildEleList.Get(i);"XLableInputBorder"!=t.EleTypeName||t.IsStartBorder||null!=t.Parent&&"AlwaysVisible"!=t.Parent.BorderVisible&&e.push(t)}}l++}n.length>0&&r.AddRange(n),r.AddRange(e)}return r}_RecurGetParaghElesInLine(e,t,n,r){let i=e.RelEleParagraph;if(e.HasCtEle){let l=-1,o=e.ChildEleList;for(let e of o)if(l++,l>=t){if(l>n)break;let t=e;if(null!=t){let e=t.LinesList;if(e instanceof s.List)for(let t of e)this._RecurGetParaghElesInLine(t,0,1073741823,r)}}null==i||r.Contains(i)||r.Add(i)}else null==i||r.Contains(i)||r.Add(i)}ClearTraceEle(e){if(null==e)return null;let t=[];for(let n=0;n<e.length;n++){const r=e[n];r.EleStyle.DeleterIndex>=0||t.push(r)}return t}}t.XLineEleRangeUtil=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OneTableCellsRange=void 0;const r=n(16),i=n(3),l=n(9);t.OneTableCellsRange=class{constructor(e){this.tableXID=null,this.cellsRange=l.RectangleF.Empty,this.tableViewLinesList=null,this.firstLineIx=-1,this.tableXID=e,this.cellsRange.X=1073741823,this.cellsRange.Y=1073741823,this.tableViewLinesList=new i.List}get TableXID(){return this.tableXID}get FirstLineIx(){return this.firstLineIx}set FirstLineIx(e){this.firstLineIx=e}get FromRIX(){return this.cellsRange.Y}set FromRIX(e){this.cellsRange.Y=e}get FromCIX(){return this.cellsRange.X}set FromCIX(e){this.cellsRange.X=e}get ToRIX(){let e=this.cellsRange.Y,t=this.cellsRange.Height;return e+(t>=0?t-1:t+1)}set ToRIX(e){let t=e-this.cellsRange.Y;t+=t>=0?1:-1,this.cellsRange.Height=t}get ToCIX(){let e=this.cellsRange.X,t=this.cellsRange.Width;return e+(t>=0?t-1:t+1)}set ToCIX(e){let t=e-this.cellsRange.X;t+=t>=0?1:-1,this.cellsRange.Width=t}get RowSpan(){return this.cellsRange.Height}set RowSpan(e){this.cellsRange.Height=e}get ColSpan(){return this.cellsRange.Width}set ColSpan(e){this.cellsRange.Width=e}ClearRelLines(){this.tableViewLinesList.Clear(),this.firstLineIx=-1}AddTableViewLine(e,t=!1){null!=e&&e.ElementCnt>0&&(t&&this.tableViewLinesList.Clear(),this.tableViewLinesList.Add(e))}GetFirstTableCell(){let e;if(this.tableViewLinesList.Count()<=0)e=null;else{e=this.tableViewLinesList.Get(0).FirstElement}return e}FiltTableViewLinesInRange(){let e=new i.List;for(let t of this.tableViewLinesList){let n=this.GetTableViewOfLine(t),r=t.IndexInView+n.FromRowIx;if(r>=this.FromRIX){if(r>this.ToRIX)break;e.Add(t)}}let t=e.ToArray();return e.Clear(),t}GetTableViewOfLine(e){return r.XDomUtil.GetXTableOrViewOfCell(e.FirstElement)}CopyCellsRangeFrom(e){null!=e&&(this.cellsRange.X=e.cellsRange.X,this.cellsRange.Y=e.cellsRange.Y,this.cellsRange.Width=e.cellsRange.Width,this.cellsRange.Height=e.cellsRange.Height)}AddToRIX(e){this.cellsRange.Height=this.cellsRange.Height+e}AddToCIX(e){this.cellsRange.Width=this.cellsRange.Width+e}SortColFromTo(){let e=this.cellsRange.Width;if(e<0){let t=this.cellsRange.X;t+=e+1,this.cellsRange.X=t,this.cellsRange.Width=-e}}GetTableViewLinesIter(){let e=this.tableViewLinesList.GetEnumerator();return e.Reset(),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BorderShadingInfo=void 0;t.BorderShadingInfo=class{get IsShowTopBorder(){return this._IsShowTopBorder}set IsShowTopBorder(e){this._IsShowTopBorder=e}get IsShowBottomBorder(){return this._IsShowBottomBorder}set IsShowBottomBorder(e){this._IsShowBottomBorder=e}get IsShowHorizontalCenterBorder(){return this._IsShowHorizontalCenterBorder}set IsShowHorizontalCenterBorder(e){this._IsShowHorizontalCenterBorder=e}get IsShowLeftBorder(){return this._IsShowLeftBorder}set IsShowLeftBorder(e){this._IsShowLeftBorder=e}get IsShowRightBorder(){return this._IsShowRightBorder}set IsShowRightBorder(e){this._IsShowRightBorder=e}get IsShowVerticalCenterBorder(){return this._IsShowVerticalCenterBorder}set IsShowVerticalCenterBorder(e){this._IsShowVerticalCenterBorder=e}get DashStyle(){return this._DashStyle}set DashStyle(e){this._DashStyle=e}get TopBorderLineColor(){return this._TopBorderLineColor}set TopBorderLineColor(e){this._TopBorderLineColor=e}get BottomBorderLineColor(){return this._BottomBorderLineColor}set BottomBorderLineColor(e){this._BottomBorderLineColor=e}get LeftBorderLineColor(){return this._LeftBorderLineColor}set LeftBorderLineColor(e){this._LeftBorderLineColor=e}get RightBorderLineColor(){return this._RightBorderLineColor}set RightBorderLineColor(e){this._RightBorderLineColor=e}get BorderLineWidth(){return this._BorderLineWidth}set BorderLineWidth(e){this._BorderLineWidth=e}get ShadingBackColor(){return this._ShadingBackColor}set ShadingBackColor(e){this._ShadingBackColor=e}get ApplytoText(){return this._ApplytoText}set ApplytoText(e){this._ApplytoText=e}get Obj(){return this._Obj}set Obj(e){this._Obj=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleReplaceUndo=void 0;const r=n(0);t.EleReplaceUndo=class{constructor(e,t,n){this.paEle=null,this.oldChildEle=null,this.newChildEle=null,this.childPos=-1,this.cursorUndoEle=null,this.cursorRedoEle=null,this.paEle=null==e?null:e.Parent,this.oldChildEle=e,this.newChildEle=t,this.childPos=n}get IsCaretVisible(){return!0}get CursorUndoEle(){return this.cursorUndoEle}set CursorUndoEle(e){this.cursorUndoEle=r.XDomUtil.GetBaseElement(e)}get CursorRedoEle(){return this.cursorRedoEle}set CursorRedoEle(e){this.cursorRedoEle=e}get RelativeEle(){return this.paEle}IsValid(){return null!=this.paEle&&this.childPos>=0&&this.oldChildEle!=this.newChildEle}CanUndo(){return this.IsValid()&&null!=this.oldChildEle}CanRedo(){return this.IsValid()&&null!=this.newChildEle}Undo(){this.CanUndo()&&(this.paEle.RemoveChild(this.childPos),this.paEle.AddChildEle(this.childPos,this.oldChildEle))}Redo(){this.CanRedo()&&(this.paEle.RemoveChild(this.childPos),this.paEle.AddChildEle(this.childPos,this.newChildEle))}Clear(){this.paEle=null,this.oldChildEle=null,this.newChildEle=null,this.childPos=-1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseInputEle=t.NumInputEditorMode=void 0;const r=n(0),i=n(44),l=n(37),s=n(3),o=n(58),a=n(8),u=n(307),h=n(309),d=n(587),c=n(588),p=n(7),f=n(217),g=n(45),m=n(46),E=n(218),C=n(311),A=n(219),y=n(14),I=n(26),S=n(589),_=n(29),w=n(2),b=n(21),x=n(4);var P;!function(e){e[e.NoneDialog=0]="NoneDialog",e[e.CalculatorDiolog=1]="CalculatorDiolog",e[e.UnitListDiolog=2]="UnitListDiolog"}(P=t.NumInputEditorMode||(t.NumInputEditorMode={}));class v extends r.XBaseContainer{constructor(){super(),this._IsFocusing=!1,this._spaceCountChanged=!1,this._allowOperate=!0,this._checkErrorType=m.CheckErrorType.None,this.ValueBinding=new E.XDataBinding,this.ValidateStyle=new C.XValueValidateStyle,this.DisplayFormat=new A.XValueFormater,this.EditorActiveMode=l.TextDocApiConst.InputFormActMode,this.EditorEventActiveMode=l.TextDocApiConst.InputFormEventActMode,this._dataSrc=new f.XDataSource,this._inputAssist=new S.XBaseInputAssist(this),this.TipShowRule="FollowEleSetting",this.EnterInputField_DownKey=_.Keys.None}get EnterInputField_DownKey(){return this._EnterInputField_DownKey}set EnterInputField_DownKey(e){this._EnterInputField_DownKey=e}get IsFocusing(){return this._IsFocusing}set IsFocusing(e){this._IsFocusing=e}get EnterFocusText(){return this._EnterFocusText}set EnterFocusText(e){this._EnterFocusText=e}get Id(){return super.GrpID}set Id(e){super.GrpID=e}get Name(){return this.propList.GetPropValue("Name")}set Name(e){this.propList.ModifyProperty("Name",e,null)}get CptID(){return this.propList.GetPropValue("CptID")}set CptID(e){this.propList.ModifyProperty("CptID",e,null)}get EleToolTip(){return this.propList.GetPropValue("EleToolTip")}set EleToolTip(e){super.ToolTip=e,this.propList.ModifyProperty("EleToolTip",e,"")}get SqlShowColumNames(){return this.propList.GetPropValue("SqlShowColums")}set SqlShowColumNames(e){this.propList.ModifyProperty("SqlShowColums",e,"")}get LabelText(){return this.propList.GetPropValue("LabelText")}set LabelText(e){this.propList.ModifyProperty("LabelText",e,null)}get SuffixText(){return this.propList.GetPropValue("SuffixText")}set SuffixText(e){this.propList.ModifyProperty("SuffixText",e,null)}get Gender(){return this.propList.GetPropValue("Gender")}set Gender(e){this.propList.ModifyProperty("Gender",e,null)}get MaxAge(){return this.propList.GetPropValue("MaxAge")}set MaxAge(e){this.propList.ModifyProperty("MaxAge",e,null)}get MinAge(){return this.propList.GetPropValue("MinAge")}set MinAge(e){this.propList.ModifyProperty("MinAge",e,null)}get BackgroundText(){return this.propList.GetPropValue("BackgroundText")}set BackgroundText(e){this.propList.ModifyProperty("BackgroundText",e,null)}get DiagnoseType(){return this.propList.GetPropValue("DiagnoseType")}set DiagnoseType(e){this.propList.ModifyProperty("DiagnoseType",e,null)}get Arrangement(){return this.propList.GetPropValue("Arrangement")||""}set Arrangement(e){this.propList.ModifyProperty("Arrangement",e,"")}get SplitChar(){return this.propList.GetPropValue("SplitChar")||""}set SplitChar(e){this.propList.ModifyProperty("SplitChar",e,"")}get ShowWay(){return this.propList.GetPropValue("ShowWay")}set ShowWay(e){this.propList.ModifyProperty("ShowWay",e,null)}get InTable(){let e=this.propList.GetPropValue("InTable");return a.CNumUtil.TryParseBool(e,!1)}set InTable(e){this.propList.ModifyProperty("InTable",e,!1)}get QuoteSource(){let e=this.propList.GetPropValue("QuoteSource");return a.CNumUtil.TryParseBool(e,!1)}set QuoteSource(e){this.propList.ModifyProperty("QuoteSource",e,!1)}get QuoteTarget(){let e=this.propList.GetPropValue("QuoteTarget");return a.CNumUtil.TryParseBool(e,!1)}set QuoteTarget(e){this.propList.ModifyProperty("QuoteTarget",e,!1)}get InTableColIx(){let e=this.propList.GetPropValue("InTableColIx");return a.CNumUtil.TryParseInt(e,0)}set InTableColIx(e){this.propList.ModifyProperty("InTableColIx",e,0)}get InnerValue(){return this.GetXInputText(!1,!1,!0,!1,!1,!1,!1)}set InnerValue(e){this.propList.ModifyProperty("InnerValue",e,null)}get StartBorderText(){return this.propList.GetPropValue("StartBorderText")}set StartBorderText(e){this.propList.ModifyProperty("StartBorderText",e,null)}get EndBorderText(){return this.propList.GetPropValue("EndBorderText")}set EndBorderText(e){this.propList.ModifyProperty("EndBorderText",e,null)}get StartBorderPritnInLine(){let e=this.propList.GetPropValue("StartBorderPritnInLine");return a.CNumUtil.TryParseBool(e,!1)}set StartBorderPritnInLine(e){this.propList.ModifyProperty("StartBorderPritnInLine",e,!1)}get EndBorderPritnInLine(){let e=this.propList.GetPropValue("EndBorderPritnInLine");return a.CNumUtil.TryParseBool(e,!1)}set EndBorderPritnInLine(e){this.propList.ModifyProperty("EndBorderPritnInLine",e,!1)}get IsSensitiveInfo(){let e=this.propList.GetPropValue("IsSensitiveInfo");return a.CNumUtil.TryParseBool(e,!1)}set IsSensitiveInfo(e){this.propList.ModifyProperty("IsSensitiveInfo",e,!1)}get HasSearch(){let e=this.propList.GetPropValue("HasSearch");return a.CNumUtil.TryParseBool(e,!0)}set HasSearch(e){this.propList.ModifyProperty("HasSearch",e,!0)}get UnitText(){return this.propList.GetPropValue("UnitText")}set UnitText(e){this.propList.ModifyProperty("UnitText",e,null)}get EnableValueValidate(){let e=this.propList.GetPropValue("EnableValueValidate");return a.CNumUtil.TryParseBool(e,!1)}set EnableValueValidate(e){this.propList.ModifyProperty("EnableValueValidate",e,!1)}get IsDisSkip(){let e=this.propList.GetPropValue("IsDisSkip");return a.CNumUtil.TryParseBool(e,!1)}set IsDisSkip(e){this.propList.ModifyProperty("IsDisSkip",e,!1)}get ShowDialog(){let e=this.propList.GetPropValue("ShowDialog");return a.CNumUtil.TryParseBool(e,!0)}set ShowDialog(e){this.propList.ModifyProperty("ShowDialog",e,!0)}get EditorMode(){let e,t=this.propList.GetPropValue("EditorMode");if(x.default.IsNullOrEmpty(t)){if(this.DataSrc.DataList.Length>0)return P.UnitListDiolog;e=P.CalculatorDiolog}else e=t;return e}set EditorMode(e){this.propList.ModifyProperty("EditorMode",e,P.CalculatorDiolog)}get IsPrint(){let e=this.propList.GetPropValue("IsPrint");return a.CNumUtil.TryParseBool(e,!0)}set IsPrint(e){this.propList.ModifyProperty("IsPrint",e,!0)}get DefaultCurrentTimeFlag(){let e=this.propList.GetPropValue("DefaultCurrentTimeFlag");return a.CNumUtil.TryParseBool(e,!1)}set DefaultCurrentTimeFlag(e){this.propList.ModifyProperty("DefaultCurrentTimeFlag",e,!1)}get PrintCurrentTimeFlag(){let e=this.propList.GetPropValue("PrintCurrentTimeFlag");return a.CNumUtil.TryParseBool(e,!1)}set PrintCurrentTimeFlag(e){this.propList.ModifyProperty("PrintCurrentTimeFlag",e,!1)}get IsRefreshSysTime(){let e=this.propList.GetPropValue("IsRefreshSysTime");return a.CNumUtil.TryParseBool(e,!1)}set IsRefreshSysTime(e){this.propList.ModifyProperty("IsRefreshSysTime",e,!1)}get BorderVisible(){let e=I.TextDocInitInfo.GetInstance().InputBorderShowFlag;if(null!=e){if(!0===e)return"AlwaysVisible";if(!1===e)return"Hidden"}let t,n=this.propList.GetPropValue("BorderVisible");return t=x.default.IsNullOrEmpty(n)?"AlwaysVisible":n,t}set BorderVisible(e){this.propList.ModifyProperty("BorderVisible",e,null)}get IsBorderVisible(){return"AlwaysVisible"==this.BorderVisible}get BorderVisibleChanged(){let e=this.propList.GetPropValue("BorderVisibleChanged");return a.CNumUtil.TryParseBool(e,!1)}set BorderVisibleChanged(e){this.propList.ModifyProperty("BorderVisibleChanged",e,!1)}get BorderElementColor(){return this.propList.GetColorValue("BorderElementColor",p.Color.Black)}set BorderElementColor(e){this.propList.SetColorValue("BorderElementColor",e,p.Color.Black)}get EditorActiveMode(){return this.propList.GetPropValue("EditorActiveMode")}set EditorActiveMode(e){this.propList.ModifyProperty("EditorActiveMode",e,null)}get EditorEventActiveMode(){return this.propList.GetPropValue("EditorEventActiveMode")}set EditorEventActiveMode(e){this.propList.ModifyProperty("EditorEventActiveMode",e,null)}get SelectedIndex(){let e=this.propList.GetPropValue("SelectedIndex");return a.CNumUtil.TryParseInt(e,0)}set SelectedIndex(e){this.propList.ModifyProperty("SelectedIndex",e,0)}get DataSrc(){return this._dataSrc}set DataSrc(e){this._dataSrc=e}get IsModified(){let e=this.propList.GetPropValue("IsModified");return a.CNumUtil.TryParseBool(e,!1)}set IsModified(e){this.propList.ModifyProperty("IsModified",e,!1)}get CanEmpty(){let e=this.propList.GetPropValue("CanEmpty");return a.CNumUtil.TryParseBool(e,!0)}set CanEmpty(e){this.propList.ModifyProperty("CanEmpty",e,!0)}get SelModelStr(){let e,t=this.propList.GetPropValue("SelModel");return e=null==t||x.default.IsNullOrEmpty(t.toString())?c.FormCommonUtil.ConvertMulSelModelToStr(d.MulSelModel.Default):t,e}set SelModelStr(e){this.propList.ModifyProperty("SelModel",e,null)}get SelectIndex(){return this.propList.GetPropValue("SelectIndex")}set SelectIndex(e){this.propList.ModifyProperty("SelectIndex",e,null)}get DefalultValue(){let e,t=this.propList.GetPropValue("DefaultValue");return e=null==t?"":t,e}set DefalultValue(e){this.propList.ModifyProperty("DefaultValue",e,"")}get DiagOutStyle(){let e=this.propList.GetPropValue("DiagOutStyle");return x.default.IsNullOrEmpty(e)&&(e="All"),e}set DiagOutStyle(e){this.propList.ModifyProperty("DiagOutStyle",e,"All")}get IsAppendWrite(){let e=this.propList.GetPropValue("IsAppendWrite");return a.CNumUtil.TryParseBool(e,!1)}set IsAppendWrite(e){this.propList.ModifyProperty("IsAppendWrite",e,!1)}get RefCode(){return this.propList.GetPropValue("RefCode")}set RefCode(e){this.propList.ModifyProperty("RefCode",e,null)}get RefName(){return this.propList.GetPropValue("RefName")}set RefName(e){this.propList.ModifyProperty("RefName",e,null)}get RefActiveStyle(){return this.propList.GetPropValue("RefActiveStyle")}set RefActiveStyle(e){this.propList.ModifyProperty("RefActiveStyle",e,null)}get LastSpliteCharShowRule(){let e,t=this.propList.GetPropValue("LastSpliteCharShowRule");return e=x.default.IsNullOrEmpty(t)?"NotShow":t,e}get RefResultFormatStr(){return this.propList.GetPropValue("RefResultFormatStr")}set RefResultFormatStr(e){this.propList.ModifyProperty("RefResultFormatStr",e,"")}get RefResultIsVertLayout(){let e=this.propList.GetPropValue("RefResultIsVertLayout");return a.CNumUtil.TryParseBool(e,!1)}set RefResultIsVertLayout(e){this.propList.ModifyProperty("RefResultIsVertLayout",e,!1)}set LastSpliteCharShowRule(e){this.propList.ModifyProperty("LastSpliteCharShowRule",e,"NotShow")}get MinSpaceNumber(){let e=this.propList.GetPropValue("MinSpaceNumber");return a.CNumUtil.TryParseInt(e,0)}set MinSpaceNumber(e){e!=this.MinSpaceNumber&&(this._spaceCountChanged=!0),this.propList.ModifyProperty("MinSpaceNumber",e,0)}get IsShowUnderLine_ShowSpace(){let e=this.propList.GetPropValue("IsShowUnderLine_ShowSpace");return a.CNumUtil.TryParseBool(e,!1)}set IsShowUnderLine_ShowSpace(e){e!=this.IsShowUnderLine_ShowSpace&&(this._spaceCountChanged=!0),e?this.setUnderLine(!0):this.setUnderLine(!1),this.propList.ModifyProperty("IsShowUnderLine_ShowSpace",e,!1)}get IsGroupEle(){return!1}get ShowName(){return this.Name}get CanReflect(){return!0}get ExpessionArray(){return[this.Visible_Expression,this.NumExpression]}set ExpessionArray(e){null!=e&&(null!=e[0]&&(this.Visible_Expression=e[0]),null!=e[1]&&(this.NumExpression=e[1]))}set Visible_Expression(e){this.attrList.ModifyProperty("DefaultEventExpression",e,null)}get Visible_Expression(){return this.attrList.GetPropValue("DefaultEventExpression")}get NumExpression(){return this.propList.GetPropValue("ValueExpression")}set NumExpression(e){this.propList.ModifyProperty("ValueExpression",e,null)}get ExpTypeArray(){return["SetVisible","SetValue","SetEleStyle"]}GetType(){return"IScriptMsg"}get IsUseXId(){return!0}get RelEleIds(){return""}set RelEleIds(e){}UpdateInnerText(e,t,n){}UpdateEleAttrFgHide(e,t){super.Attr_FgHide!=e&&(super.Attr_FgHide=e,i.TextDocApiUtil.M_InnerEleExcScrExp(this,this.Document,t))}get ScriptInnerValue(){return i.TextDocApiUtil.GetInnerValue(this,!1,!0)}get InputAssist(){return this._inputAssist}SetProp(e,t){this.propList.ModifyProperty(e,t,null)}GetInnerText(e,t=!0){return this.GetXInputText(e,!1,!0,!1,!1,!1,t)}GetInnerTextWithAll(e,t=!0){return this.GetXInputText(e,!1,!0,!0,!0,!0,t)}GetInnerTextWithBase64(e){return this.GetInputTextWithBase64(e,!1,!0,!1,!1,!1,!1)}hasChildWithImag(e){return this.XInputTextHaschildWithImag(e,!1,!0,!1,!1,!1,!1)}CanBeInline(e=!1){return!1}get AllowOperate(){return this._allowOperate}set AllowOperate(e){this._allowOperate=e}get LabelTextEle(){return this._labelTextEle}get SuffixTextEle(){return this._suffixTextEle}get UnitLabelTextEle(){return this._unitTextEle}GetUnitLabelTextEle(){return this._unitTextEle}get StartEle(){return this._startEle}get EndEle(){return this._endEle}get CreateTime(){return this._createTime}set CreateTime(e){this._createTime=e}set Attr_PhaseTypeCode(e){this.attrList.ModifyProperty("gpcode",e,null)}get Attr_PhaseTypeCode(){return this.attrList.GetPropValue("gpcode")}set InputDecode(e){this.attrList.ModifyProperty("decode",e,null)}get InputDecode(){return this.attrList.GetPropValue("decode")}set InputDecodeName(e){this.attrList.ModifyProperty("decodeName",e,null)}get InputDecodeName(){return this.attrList.GetPropValue("decodeName")}set InputDeValueCode(e){this.attrList.ModifyProperty("deValueCode",e,null)}get InputDeValueCode(){return this.attrList.GetPropValue("deValueCode")}set SurePrefix(e){this.attrList.ModifyProperty("SurePrefix",e,null)}get SurePrefix(){return this.attrList.GetPropValue("SurePrefix")}set NegativePrefix(e){this.attrList.ModifyProperty("NegativePrefix",e,null)}get NegativePrefix(){return this.attrList.GetPropValue("NegativePrefix")}set Input_FgQuote(e){this.attrList.ModifyProperty("fgquote",e,!1)}get Input_FgQuote(){let e=this.attrList.GetPropValue("fgquote");return a.CNumUtil.TryParseBool(e,!1)}set Input_FgQs(e){this.attrList.ModifyProperty("fgqs",e,!1)}get Input_FgQs(){let e=this.attrList.GetPropValue("fgqs");return a.CNumUtil.TryParseBool(e,!1)}get SqlText(){return this.propList.GetPropValue("SqlText")}set SqlText(e){this.propList.ModifyProperty("SqlText",e,"")}get SqlTextDetail(){return this.propList.GetPropValue("SqlTextDetail")}set SqlTextDetail(e){this.propList.ModifyProperty("SqlTextDetail",e,"")}get TipShowRule(){return this._TipShowRule}set TipShowRule(e){this._TipShowRule=e}get CheckError_Type(){return this._checkErrorType}set CheckError_Type(e){this._checkErrorType=e}get IsError(){return this.CheckError_Type!=m.CheckErrorType.None}get ValueBinding(){return this._valueBinding}set ValueBinding(e){this._valueBinding=e}get ValidateStyle(){return this._validateStyle}set ValidateStyle(e){this._validateStyle=e}get DisplayFormat(){return this._displayFormat}set DisplayFormat(e){this._displayFormat=e}_FindChild_InnerEles(){let e;if(0==super.ChildCount)return e=null,e;let t=[];for(let e of super.ChildEleList){if(e instanceof r.XStringEle){let n=e;n.IsXInputBkgText&&(t[5]=n)}if(e instanceof r.XLabelEle){let n=e;switch(n.LabelType){case w.ENumXLabelType.XInputBorder:let i=e instanceof r.XInputBorderEle?e:null;i.IsStartBorder?t[0]=i:t[1]=i;break;case w.ENumXLabelType.XInputLabel:t[2]=n;break;case w.ENumXLabelType.XInputUnit:t[3]=n;break;case w.ENumXLabelType.XInputSuffix:t[4]=n}}}return e=t,e}CopyFrom(e,t=!1,n=!1,i=!0){super.CopyFrom(e,t,n,i);let l=e instanceof v?e:null;if(null==l)return;let s=this._FindChild_InnerEles();null!=s&&(this._startEle=s[0]instanceof r.XInputBorderEle?s[0]:null,this._endEle=s[1]instanceof r.XInputBorderEle?s[1]:null,this._labelTextEle=s[2]instanceof r.XLabelEle?s[2]:null,this._unitTextEle=s[3]instanceof r.XLabelEle?s[3]:null,this._suffixTextEle=s[4]instanceof r.XLabelEle?s[4]:null,this._backTextEle=s[5]instanceof r.XStringEle?s[5]:null),this.TipShowRule=l.TipShowRule,this._isError=l._isError,this._checkErrorType=l._checkErrorType,this._initValue=l._initValue,this._initModfied=l._initModfied,null!=l._dataSrc&&(this._dataSrc=l._dataSrc.DeepCopy()),null!=l.ValueBinding&&(this.ValueBinding=l.ValueBinding.DeepCopy()),null!=l.ValidateStyle&&(this.ValidateStyle=l.ValidateStyle.DeepCopy()),null!=l.DisplayFormat&&(this.DisplayFormat=l.DisplayFormat.DeepClone())}NeedSerialized(){return r.XDomUtil.HasValidChild(this)}M_SetBorderEleEmptyIsShow(){if(null!=this._startEle&&null!=this._endEle&&"AlwaysVisible"!=this.BorderVisible){let e=super.ChildCount<=2;this._startEle.IsShowHaveEmpty=e,this._endEle.IsShowHaveEmpty=e,this.NotifyLayoutChanged(!0,!0)}}IsInnerInputEle(e){if(null==e)return!1;if(e.Equals(this._startEle))return!0;if(e.Equals(this._endEle))return!0;if(e.Equals(this._labelTextEle))return!0;if(e.Equals(this._suffixTextEle))return!0;if(e.Equals(this._unitTextEle))return!0;let t=this.GetBackTextXStrEle();return e.Equals(t)||null!=e.Parent&&e.Parent.Equals(t)}GetXInputText(e,t,n=!0,r=!1,i=!1,l=!1,s=!1){if(0==super.ChildCount)return"";let o=this.ChildEleList;if(null==o||0==o.Count())return;let a=new b.default;for(let u of o)if(null!=u&&!(this.IsSpecialEle(u,t,r,i,l)||s&&u.IsHidden(!0)))if(u instanceof v){let s=u.GetXInputText(e,t,n,r,i,l,!1);a.append(s)}else{let t=u.GetInnerText(e);a.append(t)}let u=a.toString();return a.setLengthToZero(),u}GetInputTextWithBase64(e,t,n=!0,i=!1,l=!1,s=!1,o=!1){let a=[];if(0==super.ChildCount)return a;let u=this.ChildEleList;if(null!=u&&0!=u.Count()){for(let h of u)if(null!=h&&!(this.IsSpecialEle(h,t,i,l,s)||o&&h.IsHidden(!0)))if(h instanceof v){let r=h.GetInputTextWithBase64(e,t,n,i,l,s,!1);a.push({text:r})}else if(h instanceof r.XImageEle)a.push({image:h.ImgObj.Base64});else{let t=h.GetInnerText(e);a.push({text:t})}return a}}XInputTextHaschildWithImag(e,t,n=!0,i=!1,l=!1,s=!1,o=!1){let a=!1;if(0==super.ChildCount)return a;let u=this.ChildEleList;if(null==u||0==u.Count())return a;for(let h of u)if(null!=h&&!(this.IsSpecialEle(h,t,i,l,s)||o&&h.IsHidden(!0)))if(h instanceof v){if(a=h.XInputTextHaschildWithImag(e,t,n,i,l,s,!1),a)break}else if(h instanceof r.XImageEle){a=!0;break}return a}GetChildList(e,t,n=!0){let r=new s.List;null==t&&(t=this);for(let i of t.ChildEleList){if(e){if(i.Equals(this._unitTextEle))continue;if(i.Equals(this._suffixTextEle))continue;if(i.Equals(this._labelTextEle))continue;if(i.Equals(this._startEle))continue;if(i.Equals(this._endEle))continue;if(i.Equals(this._backTextEle))continue}else if(!n){if(i.Equals(this._startEle))continue;if(i.Equals(this._endEle))continue}r.Add(i)}return[r,t]}GetBackTextXStrEle(){if(x.default.IsNullOrEmpty(this.BackgroundText))return null;const e=null!=this.StartEle&&null!=this.StartEle.EleStyle&&this.StartEle.EleStyle.DeleterIndex>-1,t=this.GetInnerText(!0);if(e&&t)return null;let n;const i=l.TextDocApiConst.InputFieldBackTextForeColor;return null==this._backTextEle?(this._backTextEle=new r.XStringEle,this._backTextEle.IsXInputBkgText=!0,this._backTextEle.OwnerDocPanel=this.OwnerDocPanel,this._backTextEle.EleStyle.CopyFrom(super.EleStyle,!1),this._backTextEle.EleStyle.ForeColor=i,this._backTextEle.EleStyle.isDefaultForeColor=!0,this._backTextEle.EleStyle.isDefaultBackgroundColor=!0,this._backTextEle.Text=this.BackgroundText):this._backTextEle.Text!=this.BackgroundText&&(this._backTextEle.EleStyle.CopyFrom(super.EleStyle,!1),this._backTextEle.EleStyle.ForeColor=i,this._backTextEle.EleStyle.isDefaultForeColor=!0,this._backTextEle.EleStyle.isDefaultBackgroundColor=!0,this._backTextEle.Text=this.BackgroundText),n=this._backTextEle,n}IsHaveTrace(e){return null!=e.EleStyle&&(e.EleStyle.CreatorIndex>0||e.EleStyle.DeleterIndex>0)}CreateSpaceEles(e,t,n){let r=new o.XBaseEleStyle(!1);r.CopyFrom(t,!1),this.IsShowUnderLine_ShowSpace&&(r.XFontStyle.IsUnderline=!0),n.CopyFrom(r,!1);let i=new s.List;for(let t=0;t<e;t++){let e=h.XElementFactory.CreatXElement("XCharacter",null);null!=e&&(e.ChVal=" ",e.EleStyle.CopyFrom(r,!1),i.Add(e))}return i.ToArray()}Add_DocEleStyle(e,t){if(null!=t&&null!=t.Document){let n=t.Document.GetCommStyleList(),r=y.XmlDomUtil.GetSingleAttrValue(e,"StyleIndex"),i=a.CNumUtil.TryParseInt(r,-1);i>=0&&n.CopyEleStyle(i,t.EleStyle)}}Add_XmlEleStyle(e,t){if(null!=t&&null!=t.Document){let n=t.Document.GetCommStyleList().TryAddEleStyle(t.EleStyle);n>=0&&e.setAttribute("StyleIndex",n.toString())}}GetBorderEle(e){let t;return t=e?this._startEle:this._endEle,t}GetLastBaseEle(e){let t;if(e instanceof r.XBaseContainer&&(t=e),null==t)return e;let n=t.GetLastChildEle();return null==n?null:n instanceof r.XBaseContainer?this.GetLastBaseEle(n):n}GetInnerTextXStrEle(){let e,t=new s.List;super.GetChildrenByType("XString",!1,t);const n=this.GetBackTextXStrEle();for(let i of t)if(n!=i){e=i instanceof r.XStringEle?i:null;break}return e}GetXLabelList(){let e=new s.List,t=super.GetChildArr();for(let n of t)n instanceof r.XLabelEle&&e.Add(n);return e}ExistLableEle(){let e,t=this.GetXLabelList();return e=0!=t.Count()&&t.Any(e=>e.LabelType==w.ENumXLabelType.XInputLabel),e}InsertLabelText(){if(this.ExistLableEle()&&super.RemoveChildWithEle(this._labelTextEle),x.default.IsNullOrEmpty(this.LabelText))return;null==this._labelTextEle&&(this._labelTextEle=new r.XLabelEle,this._labelTextEle.LabelType=w.ENumXLabelType.XInputLabel,this._labelTextEle.EleStyle.CopyFrom(super.EleStyle,!1)),this._labelTextEle.OwnerDocPanel=this.OwnerDocPanel,null!=this.LabelText&&this.LabelText==this._labelTextEle.Text||(this._labelTextEle.Text=this.LabelText,this._labelTextEle.NotifyLayoutChanged(!0,!1)),this._labelTextEle.EleCursorAllowSide=w.ENumEleCursorSide.ForceRight;this.AddChildEle(1,this._labelTextEle)}ExistSuffixText(){let e,t=this.GetXLabelList();return e=0!=t.Count()&&t.Any(e=>e.LabelType==w.ENumXLabelType.XInputSuffix),e}InsertSuffixText(){if(this.ExistSuffixText()&&super.RemoveChildWithEle(this._suffixTextEle),x.default.IsNullOrEmpty(this.SuffixText))return;null==this._suffixTextEle&&(this._suffixTextEle=new r.XLabelEle,this._suffixTextEle.LabelType=w.ENumXLabelType.XInputSuffix,this._suffixTextEle.EleStyle.CopyFrom(super.EleStyle,!1)),this._suffixTextEle.OwnerDocPanel=this.OwnerDocPanel,null!=this.SuffixText&&this.SuffixText==this._suffixTextEle.Text||(this._suffixTextEle.Text=this.SuffixText,this._suffixTextEle.NotifyLayoutChanged(!0,!1)),this._suffixTextEle.EleCursorAllowSide=w.ENumEleCursorSide.ForceLeft;let e=super.ChildCount;e--,this.AddChildEle(e,this._suffixTextEle)}GetInsertModelCursorEle(){let e;return e="AlwaysVisible"==this.BorderVisible?this._endEle:r.XDomUtil.GetNextEle(!0,this),e}ResetInnerChildrenStyles(e){this._Reinit_BkgTextStyles(e),this._Reinit_InnerEleStyles(this._startEle,e),this._Reinit_InnerEleStyles(this._endEle,e),this._Reinit_InnerEleStyles(this._labelTextEle,e),this._Reinit_InnerEleStyles(this._unitTextEle,e),this._Reinit_InnerEleStyles(this._suffixTextEle,e),e&&this.NotifyLayoutChanged(!0,!1)}_Reinit_BkgTextStyles(e){if(null==this._backTextEle)return!1;if(this._backTextEle.ChildCount<=0)return!1;let t=l.TextDocApiConst.InputFieldBackTextForeColor;for(let e of this._backTextEle.ChildEleList){let n=e instanceof u.XCharacterEle?e:null;null!=n&&(n.EleStyle.CopyFrom(super.EleStyle,!1),n.EleStyle.ForeColor=t)}return e&&this._backTextEle.NotifyLayoutChanged(!1,!0),!0}_Reinit_InnerEleStyles(e,t){let n;if(null==e)n=!1;else{let r=e.EleStyle;r.CopyFrom(super.EleStyle,!1),r.Superscript=!1,r.Subscript=!1,t&&e.NotifyLayoutChanged(!1,!1),n=!0}return n}CorrectStyle(e){e.EleStyle}CorrectChildStyle(){if(this.ChildCount>0){let e=new s.List;this.GetAllBaseChildren(e,!1);const t=I.TextDocInitInfo.GetInstance().InputFieldForeColor,n=l.TextDocApiConst.InputFieldBackTextForeColor,r=I.TextDocInitInfo.GetInstance().InputFiled_IsDoctorEditorMode;for(let i=0;i<e.Count();i++){const l=e.Get(i),s=l.Parent,o=l.EleStyle;if(null!=o)if(null!=s&&s.IsXInputBkgText)o.ForeColor=n;else if(o.isDefaultForeColor&&(o.ForeColor=t,r)){const e=l.EleStyle.EditForeColor;null==e||e.IsEmpty()||(l.EleStyle.ForeColor=l.EleStyle.EditForeColor)}}}}UpdateText_BulidNewEles(e,t){let n;if(null==e)n=null;else{n=new s.List}return n}UpdateText_BulidNewStyle(){let e,t=this.GetChildList(!0,this,!0)[0];if(null==t||0==t.Count())null!=this.GetBackTextXStrEle()&&(super.EleStyle.XFontStyle.FontName=this._backTextEle.EleStyle.XFontStyle.FontName,super.EleStyle.XFontStyle.FontSize=this._backTextEle.EleStyle.XFontStyle.FontSize),e=super.EleStyle;else{let n=null;if(t.Get(0)instanceof r.XBaseContainer){let e=t.Get(0);e.ChildCount>0&&(n=e.GetFirstChildBaseEle(!0).EleStyle)}else n=t.Get(0).EleStyle;e=n}return e}DirectXStrEleTextModified(e){this.IsModified=this.GetXInputText(!1,!1,!0,!1,!1,!1,!1)==this._initValue?this._initModfied:e}IsSpecialEle(e,t,n=!1,r=!1,i=!1){let l=e.Equals(this._backTextEle);return(e.Equals(this._labelTextEle)&&!n||e.Equals(this._unitTextEle)&&!r||e.Equals(this._suffixTextEle)&&!i)&&(l=!0),t||(e.Equals(this._startEle)||e.Equals(this._endEle))&&(l=!0),l}LabelEquals(e,t){return null!=e&&null!=t&&(e.Text==t.Text&&e.LabelType==t.LabelType)}StringEquals(e,t){return null!=e&&null!=t&&e.Text==t.Text}SetUnDoGroup(e){this._undoGroup=e}get UndoGrp(){return this._undoGroup}GetChildArray(e){let t=super.GetChildArr(),n=new s.List,r=t;for(let t=0;t<r.length;t++){let i=r[t];!e&&this.IsHaveTrace(i)||n.Add(i)}return n.ToArray()}GetInsertIdx(){let e=1;return this.ExistLableEle()&&e++,e}GetInsertInx_Next(){return super.GetChildInx(this._endEle)}M_SetBorderPrintInLine(){this._startEle.PrintInLine=this.StartBorderPritnInLine,this._endEle.PrintInLine=this.EndBorderPritnInLine}InsertBorderEle(e=null,t=null){this.StartBorderText=I.TextDocInitInfo.GetInstance().InputFieldStartBorder,this.EndBorderText=I.TextDocInitInfo.GetInstance().InputFieldEndBorder;let n=super.ChildCount;null!=e&&(this._startEle=e),null!=t&&(this._endEle=t),null==this._endEle&&(this._endEle=new r.XInputBorderEle),this._endEle.OwnerDocPanel=this.OwnerDocPanel,this._endEle.EleStyle.CopyFrom(super.EleStyle,!1),this._endEle.Text=this.EndBorderText,this.ExistBorderEle(!1)||this.AddChildEle(n,this._endEle),null==this._startEle&&(this._startEle=new r.XInputBorderEle),this._startEle.IsStartBorder=!0,this._startEle.OwnerDocPanel=this.OwnerDocPanel,this._startEle.Text=this.StartBorderText,this._startEle.EleStyle.CopyFrom(super.EleStyle,!1),this._startEle.EleStyle.isDefaultForeColor=!0,this._startEle.EleStyle.isDefaultBackgroundColor=!0,this.ExistBorderEle(!0)||this.AddChildEle(0,this._startEle),this._startEle.BrotherBorderEle=this._endEle,this._endEle.BrotherBorderEle=this._startEle,this._startEle.SetEleStyle(this._endEle),x.default.IsNullOrEmpty(this.InnerValue)||1!=this.InnerValue.length||" "!=this.InnerValue[0]||(this.InnerValue=""),"AlwaysVisible"==this.BorderVisible||x.default.IsNullOrEmpty(this.BorderVisible)?(this._startEle.IsDrawText=!0,this._endEle.IsDrawText=!0):(this._startEle.IsDrawText=!1,this._endEle.IsDrawText=!1)}ExistBorderEle(e){let t,n=super.GetChildArr();if(null==n||0==n.length)return t=!1,t;for(let i=0;i<n.length;i++){let l=n[i];if(l instanceof r.XInputBorderEle){if(l.IsStartBorder==e)return t=!0,t}}return t=!1,t}DynamicShowHideBackEle(){this._inputAssist.DynamicShowHideBackEle()}FromXML(e){super.FromXML(e),this.InsertBorderEle(null,null),-1!=this.EleStyle.DeleterIndex&&(this.StartEle.EleStyle.DeleterIndex=this.EleStyle.DeleterIndex,this.EndEle.EleStyle.DeleterIndex=this.EleStyle.DeleterIndex),-1!=this.EleStyle.CreatorIndex&&(this.StartEle.EleStyle.CreatorIndex=this.EleStyle.CreatorIndex,this.EndEle.EleStyle.CreatorIndex=this.EleStyle.CreatorIndex)}ExistUnitLabelEle(){let e,t=this.GetXLabelList();return e=0!=t.Count()&&t.Any(e=>e.LabelType==w.ENumXLabelType.XInputUnit),e}InsertUnitLabelText(){if(this.ExistUnitLabelEle()&&super.RemoveChildWithEle(this._unitTextEle),!x.default.IsNullOrEmpty(this.UnitText)){null==this._unitTextEle&&(this._unitTextEle=new r.XLabelEle,this._unitTextEle.LabelType=w.ENumXLabelType.XInputUnit,this._unitTextEle.EleStyle.CopyFrom(super.EleStyle,!1)),this._unitTextEle.OwnerDocPanel=this.OwnerDocPanel,null!=this.UnitText&&this.UnitText==this._unitTextEle.Text||(this._unitTextEle.Text=this.UnitText,this._unitTextEle.NotifyLayoutChanged(!0,!1)),this._unitTextEle.EleCursorAllowSide=w.ENumEleCursorSide.ForceLeft;let e=super.ChildCount;e--,this.AddChildEle(e,this._unitTextEle)}}ToggleUnitToLabel(){x.default.IsNullOrEmpty(this.UnitText)||(this.SuffixText=this.UnitText,this.UnitText=null),this.InsertSuffixText()}ToXML(e){this.InnerValue=this.GetXInputText(!1,!1,!0,!1,!1,!1,!1),this.IsModified=!1,this._initValue=this.InnerValue;let t=super.ToXML(e);if(null==t)return null;let n=t.getElementsByTagName("LabelText");if(n.length>0&&this.Add_XmlEleStyle(n[0],this._labelTextEle),n=t.getElementsByTagName("UnitText"),n.length>0&&this.Add_XmlEleStyle(n[0],this._unitTextEle),n=t.getElementsByTagName("SuffixText"),n.length>0&&this.Add_XmlEleStyle(n[0],this._suffixTextEle),n=t.getElementsByTagName("StartBorderText"),n.length>0&&this.Add_XmlEleStyle(n[0],this._startEle),n=t.getElementsByTagName("EndBorderText"),n.length>0&&this.Add_XmlEleStyle(n[0],this._endEle),null!=this._dataSrc){let n=this._dataSrc.ToXML(e);t.appendChild(n)}if(null!=this.ValueBinding){let n=this.ValueBinding.ToXML(e);t.appendChild(n)}if(null!=this.ValidateStyle){let n=this.ValidateStyle.ToXML(e);t.appendChild(n)}if(null!=this.DisplayFormat){let n=this.DisplayFormat.ToXML(e,null);t.appendChild(n)}return t}get EleTypeName(){return"XInputField"}HideBackEle(){this._inputAssist.RemoveBackEle()}IsComplexInputEle(){const e=super.GetChildArr();let t;if(null==e||0==e.length)t=!1;else{let n=!1;const r=e;for(let e=0;e<r.length;e++){const t=r[e];if(t instanceof v){n=!0;break}if(t instanceof g.XTextTable){n=!0;break}}t=n}return t}}t.XBaseInputEle=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCharacterEle=void 0;const r=n(216),i=n(16),l=n(0),s=n(308),o=n(2),a=n(43),u=n(10);class h extends l.XBaseElement{constructor(e){super(),this.ch=" ",this.isSecret=!1,this.xmlEleIx=null,this.ch=e}get EleTypeName(){return"XCharacter"}get IsTabFlag(){return"\t"==this.ch}get ChVal(){return this.isSecret?"*":this.ch}UpdateChVal(e){if(this.ch==e||"\0"==e)return"\0";let t=super.Parent instanceof l.XStringEle?super.Parent:null;if(null!=t&&t instanceof l.XStringEle){let n=t.GetChildInx(this),r=t.Text.split("");r[n]=e;let i=r.toString();t.UpdateText(i)}let n=this.ch;return this.ch=e,this.IsLayoutValid=!1,n}set ChVal(e){this.ch!=e&&"\0"!=e&&(this.ch=e,this.IsLayoutValid=!1)}CanBeInline(e=!1){if(!e)return!0;let t=i.XDomUtil.GetParentXInput(this);return(null==t||!1!==t.IsPrint)&&!i.XDomUtil.IsBkgTextOfXInput(this)}GetInnerText(e){let t;return t=e?this.ChVal.toString():super.EleStyle.DeleterIndex>=0?"":this.ChVal.toString(),t}ChangeSecretType(e){super.Parent instanceof l.XStringEle||(e=o.ENumSecretType.None);let t=e!=o.ENumSecretType.None;this.isSecret!=t&&(this.isSecret=t,this.IsLayoutValid=!1)}ReCalcBaseSize(){if(!this.IsLayoutValid){let e=super.EleStyle;if(null==e)return;let t,n=e.Font;if(null==n)return;this.IsTabFlag?t=5:(t=a.GrapUtil.MeasureCharWidth(null,n,500,this.ChVal),(e.Superscript||e.Subscript)&&(t*=.62));let r=u.DPITransUtil.TransFloatVal(n.SizeInPoints,72,96);h.Fnt_Mtc.SetFont(n),this.SetSizeDPI(t,r,96),this.IsLayoutValid=!0}}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r);let i=e;null!=i&&(this.ChVal=i.ChVal)}GetParentInputField(){return super.Granpa instanceof l.XBaseInputEle?super.Granpa:null}NeedSerialized(){return!1}ToXML(e){return null}SetXmlEleIx(e,t){null==this.xmlEleIx?this.xmlEleIx=new r.XElementInx(e):this.xmlEleIx.EleXID=e,this.xmlEleIx.ChildEleIx=t}GetXmlEleIx(){return this.xmlEleIx}}t.XCharacterEle=h,h.Fnt_Mtc=new s.FontMetricUtil},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontMetricUtil=void 0;t.FontMetricUtil=class{constructor(){this.fnt=null,this.fntFamily=null,this.fntPoints=0,this.fntLineSpacing=0}SetFont(e){this.fnt=e,null!=this.fnt&&(this.fntStyle=e.Style,this.fntFamily=e.FontFamily,this.fntPoints=this.fnt.SizeInPoints,this.fntLineSpacing=this.fntFamily.GetLineSpacing(this.fntStyle))}GetFont(){return this.fnt}GetFntHeight(){return null==this.fnt?0:this.fnt.Height}GetFntAscent(){let e;if(null==this.fnt)e=0;else{let t=this.fntFamily.GetCellAscent(this.fntStyle);t=this._TransToPX(t),e=t}return e}GetFntDescent(){let e;if(null==this.fnt)e=0;else{let t=this.fntFamily.GetCellDescent(this.fntStyle);t=this._TransToPX(t),e=t}return e}GetFntEmHeight(){let e;if(null==this.fnt)e=0;else{let t=this.fntFamily.GetEmHeight(this.fntStyle);t=this._TransToPX(t),e=t}return e}GetLineSpacing(){let e;if(null==this.fnt)e=0;else{let t=this.fntFamily.GetLineSpacing(this.fntStyle);t=this._TransToPX(t),e=t}return e}GetInternalLeading(){return 0}GetFntExtLeading(){let e;if(null==this.fnt)return e=0,e;let t=this.fntFamily.GetLineSpacing(this.fntStyle)-this.fntFamily.GetCellAscent(this.fntStyle)-this.fntFamily.GetCellDescent(this.fntStyle);return t=this._TransToPX(t),e=t,e}_TransToPX(e){return 1.33333337*this.fntPoints*e/this.fntLineSpacing}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XElementFactory=void 0;const r=n(0),i=n(4),l=n(32);t.XElementFactory=class{static CreatXElement(e,t=null){if(i.default.IsNullOrEmpty(e))return null;let n=null;switch(e){case"XString":n=new r.XStringEle;break;case"XCharacter":n=new r.XCharacterEle("#");break;case"XImage":n=new r.XImageEle;break;case"XButtonEle":n=new r.XButtonEle;break;case"Fraction":n=new r.XFractionEle;break;case"XParagraphFlag":n=new r.XParagraphFlag;break;case"XPageInfo":n=new r.XPageNumEle;break;case"XLable":n=new r.XLabelEle;break;case"XTextLabelElement":n=new l.XTextLabelElement;break;case"XLableInputBorder":n=new r.XInputBorderEle;break;case"HorizontalLine":n=new r.XSpliteLineEle;break;case"XPageBreakLabel":n=new r.XPageBreakLabel;break;case"XTextTable":n=new r.XTextTable;break;case"XTextTableRow":n=new r.XTextTableRow;break;case"XTextTableCell":n=new r.XTextTableCell;break;case"XBarcodeField":n=new r.XCodeEle;break;case"XComment":n=new r.XCommentEle;break;case"XOutlineFoldIcon":n=new r.XOutlineFoldIcon;break;case"Shape":n=new r.XShapeEle;break;case"XMedicalExpressionField":n=new r.XMedicalExpressionField;break;case"XInputField":n=new r.XInputEle;break;case"XTextCheckBox":n=new r.XCheckBoxEle;break;case"XTextRadioBox":n=new r.XRadioBoxEle}return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTableDeleteColumnUndoRedo=void 0;const r=n(3),i=n(23);class l extends i.IXUndoable{constructor(e,t){super(),this.table=e,null!=this.table&&(this.table.Columns.Count()>t&&t>=0&&(this.delColumn=this.table.Columns.Get(t)),this.deleteIndex=t,this.relatedCells=new r.List,this.bounds=new r.List,this.bound_disp=new r.List,this.SpanInfo=new r.List,this.SaveRelatedCells(),this.SaveColumnInfo())}SaveRelatedCells(){if(this.relatedCells.Clear(),null!=this.table)for(let e=0;e<this.table.Rows.Length;e++)this.relatedCells.Add(this.table.Rows.Get(e).Cells.Get(this.deleteIndex))}SaveColumnInfo(){if(this.bounds.Clear(),this.bound_disp.Clear(),null!=this.table)for(let e=0;e<this.table.Columns.Length;e++){let t=this.table.Columns.Get(e);this.bounds.Add(t.Bounds.Clone()),this.bound_disp.Add(t.BoundsDISP.Clone())}}IsValid(){return!0}CanUndo(){return!0}CanRedo(){return!0}Undo(){try{if(null!=this.table&&null!=this.delColumn&&(this.table.Columns.Insert(this.deleteIndex,this.delColumn),this.table.Columns.Count()==this.bounds.Count())){let e=0;for(let t=0;t<this.table.Columns.Count();t++)this.table.Columns.Get(t).Width=this.bounds.Get(t).Width,this.table.Columns.Get(t).SetSizeDISP(this.bound_disp.Get(t).Width,-1e3),this.table.Columns.Get(t).Index=e,e++;for(let e=0;e<this.table.Rows.Count();e++)this.relatedCells.Get(e).Visible=!0,this.table.Rows.Get(e).Cells.Insert(this.deleteIndex,this.relatedCells.Get(e)),this.table.Rows.Get(e).AddChildEle(this.deleteIndex,this.relatedCells.Get(e)),0==this.deleteIndex?(this.table.Rows.Get(e).Cells.Get(1).WidhtDisp=this.table.Rows.Get(e).Cells.Get(1).Column.BoundsDISP.Width,this.table.Rows.Get(e).Cells.Get(1).SetSizeDPI(this.table.Rows.Get(e).Cells.Get(1).Column.Width,-1e3,300)):(this.table.Rows.Get(e).Cells.Get(this.deleteIndex-1).WidhtDisp=this.table.Rows.Get(e).Cells.Get(this.deleteIndex-1).Column.BoundsDISP.Width,this.table.Rows.Get(e).Cells.Get(this.deleteIndex-1).SetSizeDPI(this.table.Rows.Get(e).Cells.Get(this.deleteIndex-1).Column.Width,-1e3,300));this.table.CombineCells()}}catch(e){}}Redo(){null!=this.table&&this.deleteIndex>=0&&this.deleteIndex<this.table.Columns.Count()&&this.table.Action_DeleteColumn(this.deleteIndex)}Clear(){}}t.TextTableDeleteColumnUndoRedo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XValueValidateStyle=void 0;const r=n(46),i=n(14),l=n(8),s=n(36);class o{constructor(){this._CheckMaxValue=null,this._MaxValue=null,this._MinValue=null,this._Required=null,this.Required=!0}get MaxLength(){return this._MaxLength}set MaxLength(e){this._MaxLength=e}get MinLength(){return this._MinLength}set MinLength(e){this._MinLength=e}get CheckMaxValue(){return this._CheckMaxValue}set CheckMaxValue(e){this._CheckMaxValue=e}get MaxValue(){return this._MaxValue}set MaxValue(e){this._MaxValue=e}get MinValue(){return this._MinValue}set MinValue(e){this._MinValue=e}get CheckMinValue(){return this._CheckMinValue}set CheckMinValue(e){this._CheckMinValue=e}get Required(){return this._Required}set Required(e){this._Required=e}get ValueType(){return this._ValueType}set ValueType(e){this._ValueType=e}get CheckDecimalDigits(){return this._CheckDecimalDigits}set CheckDecimalDigits(e){this._CheckDecimalDigits=e}get MaxDecimalDigits(){return this._MaxDecimalDigits}set MaxDecimalDigits(e){this._MaxDecimalDigits=e}Clone(){let e=new o;return Object.assign(e,this),e}DeepCopy(){return this.Clone()}ToXML(e){let t=e.createElement("ValidateStyle"),n=e.createElement("CheckMinValue");return n.textContent=l.CNumUtil.ToStringForBool(this.CheckMinValue),t.appendChild(n),n=e.createElement("CheckMaxValue"),n.textContent=l.CNumUtil.ToStringForBool(this.CheckMaxValue),t.appendChild(n),n=e.createElement("Required"),n.textContent=l.CNumUtil.ToStringForBool(this.Required),t.appendChild(n),null!=this.MaxLength&&(n=e.createElement("MaxLength"),n.textContent=this.MaxLength.toString(),t.appendChild(n)),null!=this.MinLength&&(n=e.createElement("MinLength"),n.textContent=this.MinLength.toString(),t.appendChild(n)),null!=this.MaxValue&&(n=e.createElement("MaxValue"),n.textContent=this.MaxValue.toString(),t.appendChild(n)),null!=this.MinValue&&(n=e.createElement("MinValue"),n.textContent=this.MinValue.toString(),t.appendChild(n)),n=e.createElement("CheckDecimalDigits"),n.textContent=l.CNumUtil.ToStringForBool(this.CheckDecimalDigits),t.appendChild(n),null!=this.MaxDecimalDigits&&(n=e.createElement("MaxDecimalDigits"),n.textContent=this.MaxDecimalDigits.toString(),t.appendChild(n)),t}FromXML(e){if(null!=e){let t=i.XmlDomUtil.GetSingleNode(e,"CheckMinValue");null!=t&&(this.CheckMinValue=l.CNumUtil.TryParseBool(t.textContent,!1)),t=i.XmlDomUtil.GetSingleNode(e,"CheckMaxValue"),null!=t&&(this.CheckMaxValue=l.CNumUtil.TryParseBool(t.textContent,!1)),t=i.XmlDomUtil.GetSingleNode(e,"Required"),null!=t&&(this.Required=l.CNumUtil.TryParseBool(t.textContent,!1)),t=i.XmlDomUtil.GetSingleNode(e,"MaxLength"),null==t||s.StringUtils.IsNullOrEmpty(t.textContent)||(this.MaxLength=l.CNumUtil.TryParseInt(t.textContent,0)),t=i.XmlDomUtil.GetSingleNode(e,"MinLength"),null==t||s.StringUtils.IsNullOrEmpty(t.textContent)||(this.MinLength=l.CNumUtil.TryParseInt(t.textContent,0)),t=i.XmlDomUtil.GetSingleNode(e,"MaxValue"),null==t||s.StringUtils.IsNullOrEmpty(t.textContent)||(this.MaxValue=l.CNumUtil.TryParseDouble(t.textContent,0)),t=i.XmlDomUtil.GetSingleNode(e,"MinValue"),null==t||s.StringUtils.IsNullOrEmpty(t.textContent)||(this.MinValue=l.CNumUtil.TryParseDouble(t.textContent,0)),t=i.XmlDomUtil.GetSingleNode(e,"CheckDecimalDigits"),null!=t&&(this.CheckDecimalDigits=l.CNumUtil.TryParseBool(t.textContent,!1)),t=i.XmlDomUtil.GetSingleNode(e,"MaxDecimalDigits"),null==t||s.StringUtils.IsNullOrEmpty(t.textContent)||(this.MaxDecimalDigits=l.CNumUtil.TryParseInt(t.textContent,0)),this.CheckDecimalDigits&&0==this.MaxDecimalDigits&&(this.ValueType=r.XValueTypeStyle.Integer)}}}t.XValueValidateStyle=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputWildCastsConst=void 0;const r=n(3);class i{constructor(){this.WildChar_Start="{",this.WildChar_End="}",this.InputNorameEleMark="{ele_ele}",this.InputDateEleMark="{date_date}",this.InputNumEleMark="{num_num}",this.InputTextEleMark="{text_text}",this.InputSingleSelEleMark="{sinSel_sinSel}",this.InputWildKeys=["{date_date}","{num_num}","{text_text}","{ele_ele}"]}InputWildCastsConst(){this.InputWildCharDic=new r.Dictionary,this.InputWildCharDic.Add("{date_date}","6002"),this.InputWildCharDic.Add("{num_num}","6001"),this.InputWildCharDic.Add("{text_text}","5002"),this.InputWildCharDic.Add("{ele_ele}","5002")}static GetInstance(){return i._instance}}t.InputWildCastsConst=i,i._instance=new i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(135),l=s(n(136));function s(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.fontSize=!n.flat&&n.fontSize>10*n.width?10*n.width:n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(e,t){return this.text.substr(e,t)}},{key:"leftEncode",value:function(e,t){return(0,l.default)(e,t)}},{key:"rightText",value:function(e,t){return this.text.substr(e,t)}},{key:"rightEncode",value:function(e,t){return(0,l.default)(e,t)}},{key:"encodeGuarded",value:function(){var e={fontSize:this.fontSize},t={height:this.guardHeight};return[{data:i.SIDE_BIN,options:t},{data:this.leftEncode(),text:this.leftText(),options:e},{data:i.MIDDLE_BIN,options:t},{data:this.rightEncode(),text:this.rightText(),options:e},{data:i.SIDE_BIN,options:t}]}},{key:"encodeFlat",value:function(){return{data:[i.SIDE_BIN,this.leftEncode(),i.MIDDLE_BIN,this.rightEncode(),i.SIDE_BIN].join(""),text:this.text}}}]),t}(s(n(66)).default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.checksum=o;var i=l(n(136));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),-1!==e.search(/^[0-9]{11}$/)&&(e+=o(e));var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.displayValue=n.displayValue,n.fontSize>10*n.width?r.fontSize=10*n.width:r.fontSize=n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{12}$/)&&this.data[11]==o(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var e="";return e+="101",e+=(0,i.default)(this.data.substr(0,6),"LLLLLL"),e+="01010",e+=(0,i.default)(this.data.substr(6,6),"RRRRRR"),{data:e+="101",text:this.text}}},{key:"guardedEncoding",value:function(){var e=[];return this.displayValue&&e.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),e.push({data:"101"+(0,i.default)(this.data[0],"L"),options:{height:this.guardHeight}}),e.push({data:(0,i.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),e.push({data:"01010",options:{height:this.guardHeight}}),e.push({data:(0,i.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),e.push({data:(0,i.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&e.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),e}}]),t}(l(n(66)).default);function o(e){var t,n=0;for(t=1;t<11;t+=2)n+=parseInt(e[t]);for(t=0;t<11;t+=2)n+=3*parseInt(e[t]);return(10-n%10)%10}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(610),s=n(66);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"valid",value:function(){return-1!==this.data.search(/^([0-9]{2})+$/)}},{key:"encode",value:function(){var e=this,t=this.data.match(/.{2}/g).map((function(t){return e.encodePair(t)})).join("");return{data:l.START_BIN+t+l.END_BIN,text:this.text}}},{key:"encodePair",value:function(e){var t=l.BINARIES[e[1]];return l.BINARIES[e[0]].split("").map((function(e,n){return("1"===e?"111":"1")+("1"===t[n]?"000":"0")})).join("")}}]),t}(((r=s)&&r.__esModule?r:{default:r}).default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var n in t)t.hasOwnProperty(n)&&(n=t[n],"string"==typeof e[n]&&(e[n]=parseInt(e[n],10)));"string"==typeof e.displayValue&&(e.displayValue="false"!=e.displayValue);return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTotalWidthOfEncodings=t.calculateEncodingAttributes=t.getBarcodePadding=t.getEncodingHeight=t.getMaximumHeightOfEncodings=void 0;var r,i=n(166),l=(r=i)&&r.__esModule?r:{default:r};function s(e,t){return t.height+(t.displayValue&&e.text.length>0?t.fontSize+t.textMargin:0)+t.marginTop+t.marginBottom}function o(e,t,n){if(n.displayValue&&t<e){if("center"==n.textAlign)return Math.floor((e-t)/2);if("left"==n.textAlign)return 0;if("right"==n.textAlign)return Math.floor(e-t)}return 0}function a(e,t,n){var r;if(n)r=n;else{if("undefined"==typeof document)return 0;r=document.createElement("canvas").getContext("2d")}return r.font=t.fontOptions+" "+t.fontSize+"px "+t.font,r.measureText(e).width}t.getMaximumHeightOfEncodings=function(e){for(var t=0,n=0;n<e.length;n++)e[n].height>t&&(t=e[n].height);return t},t.getEncodingHeight=s,t.getBarcodePadding=o,t.calculateEncodingAttributes=function(e,t,n){for(var r=0;r<e.length;r++){var i,u=e[r],h=(0,l.default)(t,u.options);i=h.displayValue?a(u.text,h,n):0;var d=u.data.length*h.width;u.width=Math.ceil(Math.max(i,d)),u.height=s(u,h),u.barcodePadding=o(i,d,h)}},t.getTotalWidthOfEncodings=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].width;return t}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(e,n){r(this,t);var l=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return l.name="InvalidInputException",l.symbology=e,l.input=n,l.message='"'+l.input+'" is not a valid input for '+l.symbology,l}return l(t,Error),t}(),o=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="InvalidElementException",e.message="Not supported type to render on",e}return l(t,Error),t}(),a=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="NoElementException",e.message="No element to render on.",e}return l(t,Error),t}();t.InvalidInputException=s,t.InvalidElementException=o,t.NoElementException=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HorizontalLinePropertiesInfo=void 0;t.HorizontalLinePropertiesInfo=class{constructor(){this._No=null,this._Type=null,this._HorLineColor=null,this._LineWidth=null,this._LineLength=null,this._SpliteLineEleHeight=null,this._DottedLineWidth=null,this._DottedLinePadding=null,this._IsAutoWidth=null,this._ShowLineStyle=null}get No(){return this._No}set No(e){this._No=e}get Type(){return this._Type}set Type(e){this._Type=e}get HorLineColor(){return this._HorLineColor}set HorLineColor(e){this._HorLineColor=e}get LineWidth(){return this._LineWidth}set LineWidth(e){this._LineWidth=e}get LineLength(){return this._LineLength}set LineLength(e){this._LineLength=e}get SpliteLineEleHeight(){return this._SpliteLineEleHeight}set SpliteLineEleHeight(e){this._SpliteLineEleHeight=e}get DottedLineWidth(){return this._DottedLineWidth}set DottedLineWidth(e){this._DottedLineWidth=e}get DottedLinePadding(){return this._DottedLinePadding}set DottedLinePadding(e){this._DottedLinePadding=e}get IsAutoWidth(){return this._IsAutoWidth}set IsAutoWidth(e){this._IsAutoWidth=e}get ShowLineStyle(){return this._ShowLineStyle}set ShowLineStyle(e){this._ShowLineStyle=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocInnerUtil=void 0;const r=n(10),i=n(39),l=n(8);t.TextDocInnerUtil=class{static FormatDateTimeToString(e,t){let n,r=new i.DateTime;return n=i.DateTime.TryParse(e,t,r)?r.ToString(t):"",n}static ConvertFloatToCm(e,t,n){let i=2.54*r.DPITransUtil.TransFloatVal(e,t,96)/96,s="";n>0&&(s+="#.");for(let e=0;e<n;e++)s+="0";return l.CNumUtil.TryParseFloat(i.toString(),0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocInitInfoExt=void 0;class r{constructor(){this.DftBarCodeRule="Code128B",this.DftQrCodeRule="QR_CODE",this.TipShowPos="Text_Under",this.PaperFeedHoriz=new Boolean(!1),this.Outpatient_IsAutoZoom=!0}get DftBarCodeRule(){return this.dftBarCodeRule}set DftBarCodeRule(e){this.dftBarCodeRule=e}get DftQrCodeRule(){return this.dftQrCodeRule}set DftQrCodeRule(e){this.dftQrCodeRule=e}get TipShowPos(){return this.tipShowPos}set TipShowPos(e){this.tipShowPos=e}get Outpatient_IsAutoZoom(){return this.outpatient_IsAutoZoom}set Outpatient_IsAutoZoom(e){this.outpatient_IsAutoZoom=e}get PaperFeedHoriz(){return this.paperFeedHoriz}set PaperFeedHoriz(e){this.paperFeedHoriz=e}static GetInstance(){return r._textDocInitInfoExt}}t.TextDocInitInfoExt=r,r._textDocInitInfoExt=new r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XInputEleHelper=void 0;const r=n(88),i=n(13),l=n(4),s=n(0),o=n(2),a=n(3),u=n(138),h=n(40),d=n(42),c=n(59),p=n(108),f=n(224),g=n(35),m=n(312),E=n(630),C=n(44);class A{static UpdateInnerTextByClick(e,t,n,r,i){A.UpdateInput_InnerValue(e,!0,t,n,r,null),C.TextDocApiUtil.M_InnerEleExcScrExp(e,e.Document,e.UndoGrp)}static UpdateInput_InnerValue(e,t,n,r,s,o=null){if(null==e.UndoGrp){let t=new i.UndoGroup;e.SetUnDoGroup(t)}let a=l.default.IsNullOrEmpty(n);a||e.InputAssist.RemoveBackEle();let u=o;null==u&&(u=e.UpdateText_BulidNewStyle2(!0));let h=t&&null!=r;A.UpdateText_RemoveEle(e,h,r,s);let d=e.UpdateText_BulidNewEles(n,u);A.UpdateText_InsertEles(e,d,h,r),a&&e.DynamicShowHideBackEle(),e.NotifyLayoutChanged(!0,!1)}static UpdateText_RemoveEle(e,t,n,r){let i=e.I_RemoveChildAll(null,!0,r,!1);if(t){let t=new a.List;for(let e of i)e instanceof s.XBaseContainer?t.AddRange(e.GetChildArr()):t.Add(e);n.Execute3(o.ENumEdtType.Delete,e.UndoGrp,t.ToArray())}}static UpdateText_InsertEles(e,t,n,r){if(null!=t&&0!=t.Count()){e.AddChildrenEle(e.GetInsertIdx(),t.ToArray());let l=new u.EleRangeAddDelUndo(t.ToArray(),e.GetChildInx(t.Get(0)),!0);if(null!=e.UndoGrp&&e.UndoGrp.AddItem(l),n){let n=new i.UndoGroup;n.AddItem(l);let s=!1;e.InputType!=h.EleTypeEnum.SingleChoiceDropEle&&e.InputType!=h.EleTypeEnum.MoreChoiceDropEle&&e.InputType!=h.EleTypeEnum.HaveNoEle&&e.InputType!=h.EleTypeEnum.NumEle&&e.InputType!=h.EleTypeEnum.DateEle||(s=!0),r.Execute3(o.ENumEdtType.Add,n,t.ToArray())}}}static AddChild_Input(e,t,n,r=!0){e.AddChildEle(t,n),e.TextChanged(),C.TextDocApiUtil.M_InnerEleExcScrExp("IScriptMsg"==e.GetType()?e:null,e.Document,e.UndoGrp),r&&e.DynamicShowHideBackEle()}static RemoveChild_Input(e,t,n=!0){e.RemoveChild(t),e.TextChanged(),C.TextDocApiUtil.M_InnerEleExcScrExp(e,e.Document,e.UndoGrp),n&&e.DynamicShowHideBackEle()}static UpdateEleInfo(e,t){switch(e.EleToolTip=t.Text_tip,e.InputType){case h.EleTypeEnum.NormalEle:case h.EleTypeEnum.SignEle:case h.EleTypeEnum.PrescriptionEle:d.XInputFactory.GetInstance().GetCommonEle(t,e);break;case h.EleTypeEnum.SingleChoiceDropEle:case h.EleTypeEnum.MoreChoiceDropEle:case h.EleTypeEnum.HaveNoEle:d.XInputFactory.GetInstance().GetSelect(t,e);break;case h.EleTypeEnum.NumEle:d.XInputFactory.GetInstance().GetNumber(t,e);break;case h.EleTypeEnum.DateEle:d.XInputFactory.GetInstance().GetDatetime(t,e);break;case h.EleTypeEnum.TextEle:d.XInputFactory.GetInstance().GetText(t,e);break;case h.EleTypeEnum.SqlEle:d.XInputFactory.GetInstance().GetSqlInputEle(t,e);break;case h.EleTypeEnum.MacroEle:d.XInputFactory.GetInstance().GetMacroInputEle(t,e);break;case h.EleTypeEnum.BusinessStructEle:d.XInputFactory.GetInstance().GetCommonEle(t,e);break;case h.EleTypeEnum.RefEle:d.XInputFactory.GetInstance().GetRefEle(t,e);break;case h.EleTypeEnum.QrCodeEle:d.XInputFactory.GetInstance().GetBarCodeEle(t,e)}e.StartValueValidate(!0,e.EleStyle)}static AnalysisWildStr(e,t,n){let r;if(l.default.IsNullOrEmpty(e))r=null;else{let i=A.FindInputChildStr2(e),l=new a.List;for(let e of i){let r=0;if(e.IsExpression){let n=A.BulidInputEle4(e.Result,0,new f.Stack,[r],t);A.UpdateEleStyle(n,t),l.Add(n)}else l.AddRange(A.BulidXStrEle(e.Result,t,n))}r=l}return r}static BulidXStrEle(e,t,n){let r=new c.ClickedElementWrapper(!1);r.LineEleIxFocused.SetEle(n);let i=new a.List,l=p.EditEleRange.BuildElesFromStr(e,t,i,r),s=new a.List;return null!=l&&s.Add(l),s.AddRange(i),s}static UpdateEleStyle(e,t){if(0!=e.ChildCount){let n=e.GetChildArr();for(let e=0;e<n.length;e++){let r=n[e];r instanceof s.XBaseContainer?A.UpdateEleStyle(r,t):r.EleStyle.CopyFrom(t,!1)}}}static FindInputChildStr2(e){let t=new a.List,n=new f.Stack,r=0,i=new a.Dictionary;for(let t=0;t<e.length;t++){let l=e[t];"{"==l?(0==n.Count&&(r=t),n.Push(l)):"}"==l&&(n.Pop(),0==n.Count&&i.Add(r,t))}let l=new a.List(i.Keys);for(let n=0;n<i.Count();n++){let r=l[n],s=i[r];if(0==n&&r>0&&t.Add(E.InputWildCharResultInfo.CreateInstance(e.substring(0,r),!1)),t.Add(E.InputWildCharResultInfo.CreateInstance(e.substring(r,s-r+1),!0)),n<i.Count()-1){let r=l[n+1];r>s&&t.Add(E.InputWildCharResultInfo.CreateInstance(e.substring(s+1,r-s-1),!1))}else n==i.Count()-1&&s<e.length&&t.Add(E.InputWildCharResultInfo.CreateInstance(e.substring(s+1,e.length-(s+1)),!1))}return t}static BulidInputEle4(e,t,n,[r],i){let l,s=new a.List;for(let o=t;o<e.length;o++)if("{"==e[o]){n.Push(e[o]);let t=A.BulidInputEle4(e,o+1,n,[r],i);if(s.Add(t),o=r,0==n.Count)return l=t,l}else{if("}"==e[o]){let e="";for(;"{"!=n.Peek();)e+=n.Pop();e+=n.Pop(),e=g.CommDefines.ReverseString(e)+"}";let t=A.BulidXInputEleByStr(e,i);if(s.Count()>0)for(let e of s)t.AddChildEle(t.ChildCount-1,e);return r=o,l=t,l}n.Push(e[o])}return l=null,l}static BulidXInputEleByStr(e,t){let n=new r.XInputEle;n.SetAttribute("type",A.GetInputType(e));let i="",l=e.match("\\[(.*?)\\]");for(let e of l){let t=e.split(",");if(t.length>=2){let e=t[0],r=t[1];"defaultValue"==e?i=r:n.SetProp(e,r)}}let s=e.match("\\<(.*?)\\>");for(let e of s){let t=e.split(",");if(t.length>=2){let e=t[0],r=t[1];n.SetAttribute(e,r)}}return n.ReBulidInputField(i,t,!0),n}static GetInputType(e){let t=m.InputWildCastsConst.GetInstance().InputWildKeys,n="";for(let r=0;r<t.length;r++){let i=t[r],l=i.split("_");if(0==e.indexOf(l[0])&&e.endsWith(l[1]))return n=m.InputWildCastsConst.GetInstance().InputWildCharDic[i],n}return n="5002",n}}t.XInputEleHelper=A},function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable;function s(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,o,a=s(e),u=1;u<arguments.length;u++){for(var h in n=Object(arguments[u]))i.call(n,h)&&(a[h]=n[h]);if(r){o=r(n);for(var d=0;d<o.length;d++)l.call(n,o[d])&&(a[o[d]]=n[o[d]])}}return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalendarComp=t.Timepicker=void 0;const r=n(12),i=n(24);n(642);const l=n(74),s=n(22),o=n(646),a=n(39);class u extends r.Component{constructor(e){super(e),this.tableState="date",this.btnPreRef=r.createRef(),this.yearRef=r.createRef(),this.btnNextRef=r.createRef(),this.virtualRef=r.createRef(),this.popClassName="calendarpop",this.calendarId="editor-calendar-div",this.canceBtnId="calendarpopCance",this.nearNode=null,this.curentNodeIndex=null,this.dateRule=null,this.closeHandler=(e=!1)=>{"function"==typeof this.props.onClose&&this.props.onClose(e),this.curentNodeIndex=null,this.setState({isRender:!1})},this.getFormatValue=e=>{let t,n=e.value,r=(new Date).getFullYear(),i=(new Date).getMonth()+1,l=(new Date).getDate(),s=(new Date).getHours(),o=(new Date).getMinutes(),a=(new Date).getSeconds();if(e.dateFormat){-1!=e.dateFormat.toString().indexOf(" ")&&(t=!0)}if(n){const e=n.toString();let t=null,u=null;if(-1!=e.indexOf(" ")){const n=e.split(" ");t=n[0],u=n[1]}else t=e;if(t){const e=t.replace(/[^0-9]/g,(function(e,t){return"."})).split(".");e[0]>0&&e[0].toString().length<=4&&(r=e[0]),e[1]>0&&e[1]<13&&(i=e[1]),e[2]>0&&e[2]<32&&(l=e[2])}if(u){const e=u.replace(/[^0-9]/g,(function(e,t){return":"})).split(":");e[0]>=0&&e[0]<=24&&(s=e[0]),e[1]>=0&&e[1]<=60&&(o=e[1]),e[2]>=0&&e[2]<=60&&(a=e[2])}}return[t,r,i,l,s,o,a]},this.updateEvent=e=>{const{left:t,top:n,format:r,showTime:i,year:l,month:s,day:o,hour:a,minute:u,second:h}=this.state;let d=[];e.position.x!=t&&d.push({item:"left",value:e.position.x}),e.position.y!=n&&d.push({item:"top",value:e.position.y}),e.dateFormat!=r&&d.push({item:"format",value:e.dateFormat});const c=this.getFormatValue(e.value),p=c[0];if(p!=i){const e=c[4],t=c[5],n=c[6];d.push({item:"showTime",value:p}),d.push({item:"hour",value:e}),d.push({item:"minute",value:t}),d.push({item:"second",value:n})}const f=c[1],g=c[2],m=c[3];d.length>0&&this.setState((e,t)=>{let n={isRender:!0,tableData:null,statusMonth:!0,statusYear:!1,year:f,month:g,day:m,showYear:f,showMonth:g,showDay:m};return d.forEach(e=>{n[e.item]=e.value}),n})};let t=this.getRuleByFormat(e);this.dateRule=t,t.year.value=t.year.value?t.year.value:(new Date).getFullYear(),t.month.value=t.month.value?t.month.value:(new Date).getMonth()+1,t.day.value=t.day.value?t.day.value:(new Date).getDate(),t.hour.value=t.hour.value?t.hour.value:(new Date).getHours(),t.minute.value=t.minute.value?t.minute.value:(new Date).getMinutes(),t.second.value=t.second.value?t.second.value:(new Date).getSeconds();const n=t.timeShow,i=t.year.value,l=Number(t.month.value)<10?"0"+Number(t.month.value):Number(t.month.value),s=Number(t.day.value)<10?"0"+Number(t.day.value):Number(t.day.value),o=Number(t.hour.value)<10?"0"+Number(t.hour.value):Number(t.hour.value),a=Number(t.minute.value)<10?"0"+Number(t.minute.value):Number(t.minute.value),u=Number(t.second.value)<10?"0"+Number(t.second.value):Number(t.second.value);let h=e.position.y,d=e.position.x;this.state={year:i,month:l,day:s,hour:o,minute:a,second:u,showYear:i,showMonth:l,showDay:s,showTime:n,format:e.dateFormat,top:h||0,left:d||0,tableData:null,statusMonth:!!t.day.show,statusYear:!t.month.show,isRender:!0},this.props.divID&&(this.popClassName+=" "+this.props.divID),this.timepicker=r.createRef(),this.getValue=this.getValue.bind(this),this.btnKeyUpHandler=this.btnKeyUpHandler.bind(this),this.tableKeyUpHandler=this.tableKeyUpHandler.bind(this),this.btnPreKeyUpHandler=this.btnPreKeyUpHandler.bind(this),this.yearKeyUpHandler=this.yearKeyUpHandler.bind(this),this.btnNextKeyUpHandler=this.btnNextKeyUpHandler.bind(this),this.selectKeyUpEvent=this.selectKeyUpEvent.bind(this)}getRuleByFormat(e){let t,n,r=(new Date).getFullYear(),i=(new Date).getMonth()+1,l=(new Date).getDate(),s=(new Date).getHours(),o=(new Date).getMinutes(),a=(new Date).getSeconds(),u=e.dateFormat,h=e.value;if(h){n=h.replace(/[^0-9]/g,(function(e,t){return"."})).split(".")}return"yyyy年"==u?(t={dateShow:!0,timeShow:!1,year:{show:!0,value:n?n[0]:r},month:{show:!1,value:""},day:{show:!1,value:""},hour:{show:!1,value:""},minute:{show:!1,value:""},second:{show:!1,value:""}},this.tableState="year"):"yyyy年MM月"==u?(t={dateShow:!0,timeShow:!1,year:{show:!0,value:n?n[0]:r},month:{show:!0,value:n?n[1]:i},day:{show:!1,value:""},hour:{show:!1,value:""},minute:{show:!1,value:""},second:{show:!1,value:""}},this.tableState="month"):"yyyy年MM月dd日"==u||"yyyy-MM-dd"==u?(t={dateShow:!0,timeShow:!1,year:{show:!0,value:n?n[0]:r},month:{show:!0,value:n?n[1]:i},day:{show:!0,value:n?n[2]:l},hour:{show:!1,value:""},minute:{show:!1,value:""},second:{show:!1,value:""}},this.tableState="date"):"yyyy年MM月dd日HH时"==u?t={dateShow:!0,timeShow:!0,year:{show:!0,value:n?n[0]:r},month:{show:!0,value:n?n[1]:i},day:{show:!0,value:n?n[2]:l},hour:{show:!0,value:n?n[3]:s},minute:{show:!1,value:""},second:{show:!1,value:""}}:"yyyy年MM月dd日HH时mm分"==u||"yyyy-MM-dd HH:mm"==u||"yyyy年MM月dd日HH:mm"==u?t={dateShow:!0,timeShow:!0,year:{show:!0,value:n?n[0]:r},month:{show:!0,value:n?n[1]:i},day:{show:!0,value:n?n[2]:l},hour:{show:!0,value:n?n[3]:s},minute:{show:!0,value:n?n[4]:o},second:{show:!1,value:""}}:"yyyy年MM月dd日HH时mm分ss秒"==u||"yyyy-MM-dd HH:mm:ss"==u?t={dateShow:!0,timeShow:!0,year:{show:!0,value:n?n[0]:r},month:{show:!0,value:n?n[1]:i},day:{show:!0,value:n?n[2]:l},hour:{show:!0,value:n?n[3]:s},minute:{show:!0,value:n?n[4]:o},second:{show:!0,value:n?n[5]:a}}:"HH时mm分"==u||"HH:mm"==u?t={dateShow:!1,timeShow:!0,year:{show:!1,value:""},month:{show:!1,value:""},day:{show:!1,value:""},hour:{show:!0,value:n?n[0]:s},minute:{show:!0,value:n?n[1]:o},second:{show:!1,value:""}}:"HH:mm:ss"==u&&(t={dateShow:!1,timeShow:!0,year:{show:!1,value:""},month:{show:!1,value:""},day:{show:!1,value:""},hour:{show:!0,value:n?n[0]:s},minute:{show:!0,value:n?n[1]:o},second:{show:!0,value:n?n[2]:a}}),t}componentDidMount(){setTimeout(()=>this.virtualRef.current.focus(),100)}componentWillMount(){this.props.parent.React=this,this.getDateRender()}getFirstWeek(){let e=new Date(this.state.showYear+"-"+this.state.showMonth);var t=e.getFullYear(),n=e.getMonth();return new Date(t,n,1).getDay()}getDays(){let e=new Date(this.state.showYear+"-"+this.state.showMonth);var t=e.getFullYear(),n=e.getMonth();return new Date(t,n+1,0).getDate()}getPreDays(){var e=1==this.state.showMonth?Number(this.state.showYear)-1:this.state.showYear,t=1==this.state.showMonth?12:Number(this.state.showMonth)-1,n=new Date(e+"-"+t),r=n.getFullYear(),i=n.getMonth();return{beforeyear:e,beforemonth:t,beforedays:new Date(r,i+1,0).getDate()}}getDateRender(){let e=this.getFirstWeek(),t=[],n=this.getDays(),i=1;var l=1;let{beforeyear:s,beforemonth:o,beforedays:a}=this.getPreDays(),u=this.state.year,h=this.state.month,d=this.state.day,c=Number(this.state.showYear),p=Number(this.state.showMonth);var f=12==p?Number(c)+1:c,g=12==p?1:Number(p)+1;let m,E;if("date"==this.tableState){for(var C=0;C<6;C++){var A=[];if(0==e)for(var y=0;y<7;y++){if(0==C)var I={num:a-7+1+y,date:`${s}-${o<10?"0"+Number(o):o}-${a-7+1+y}`,class:"unlight"};else if(i<=n){if(u==c&&Number(h)==Number(p)&&Number(d)==Number(i))I={num:i,date:`${c}-${p<10?"0"+Number(p):p}-${i<10?"0"+i:i}`,class:"active actived"};else I={num:i,date:`${c}-${p<10?"0"+Number(p):p}-${i<10?"0"+i:i}`,class:""};i++}else{I={num:l,date:`${f}-${g<10?"0"+g:g}-${l<10?"0"+l:l}`,class:"unlight"};l++}A.push(I)}else for(y=0;y<7;y++){if(0==C)if(y<e){var S=a-e+1+y;I={num:a-e+1+y,date:`${s}-${o<10?"0"+Number(o):o}-${S<10?"0"+S:S}`,class:"unlight"}}else{if(u==c&&Number(h)==Number(p)&&Number(d)==Number(i))I={num:i,date:`${c}-${p<10?"0"+Number(p):p}-${i<10?"0"+i:i}`,class:"active actived"};else I={num:i,date:`${c}-${p<10?"0"+Number(p):p}-${i<10?"0"+i:i}`,class:""};i++}else if(i<=n){if(u==c&&Number(h)==Number(p)&&Number(d)==Number(i))I={num:i,date:`${c}-${p<10?"0"+Number(p):p}-${i<10?"0"+i:i}`,class:"active actived"};else I={num:i,date:`${c}-${p<10?"0"+Number(p):p}-${i<10?"0"+i:i}`,class:""};i++}else{I={num:l,date:`${f}-${g<10?"0"+Number(g):g}-${l<10?"0"+l:l}`,class:"unlight"};l++}A.push(I)}t.push(A)}m=t.map((e,t)=>{let n=e.map((e,t)=>e.num?r.createElement("td",{"data-date":e.date,key:t*Math.random(),className:e.class,onDoubleClick:e=>{this.dbcheckDate()},onClick:e=>{this.checkDate(e.target)}},e.num):null);return r.createElement("tr",{key:t*Math.random()},n)}),E=r.createElement(r.Fragment,null,r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"日"),r.createElement("th",null,"一"),r.createElement("th",null,"二"),r.createElement("th",null,"三"),r.createElement("th",null,"四"),r.createElement("th",null,"五"),r.createElement("th",null,"六"))),r.createElement("tbody",{className:"calendar-date"},m))}else if("month"==this.tableState){m=[[{text:"一月",number:"01"},{text:"二月",number:"02"},{text:"三月",number:"03"},{text:"四月",number:"04"}],[{text:"五月",number:"05"},{text:"六月",number:"06"},{text:"七月",number:"07"},{text:"八月",number:"08"}],[{text:"九月",number:"09"},{text:"十月",number:"10"},{text:"十一月",number:"11"},{text:"十二月",number:"12"}]];let e=m.map((e,t)=>{let n=e.map((e,t)=>e.text?r.createElement("td",{"date-number":e.number,key:t*Math.random(),className:e.number==Number(h)?"active actived":"",onDoubleClick:e=>{this.dbcheckMonth()},onClick:t=>{this.checkMonth(t.target,e.number==Number(h)?"active actived":"")}},e.text):null);return r.createElement("tr",{key:t*Math.random()},n)});E=r.createElement("tbody",{className:"calendar-month"},e)}else if("year"==this.tableState){m=[[c,c+1,c+2,c+3],[,c+4,c+5,c+6,c+7],[c+8,c+9,"",""]];let e=m.map((e,t)=>{let n=e.map((e,t)=>e?r.createElement("td",{key:t*Math.random(),className:e==u?"active actived":"",onDoubleClick:e=>{this.dbCheckYear()},onClick:t=>{this.checkYear(t.target,e==u?"active actived":"")}},e):null);return r.createElement("tr",{key:t*Math.random()},n)});E=r.createElement("tbody",{className:"calendar-year"},e)}this.setState(()=>({tableData:E}))}checkDate(e,t){if(null==e)return;if(document.getElementById(this.calendarId).querySelectorAll("td").forEach((e,n)=>{"active"!=t&&t||e.classList.remove("active"),"actived"!=t&&t||e.classList.remove("actived")}),"active"!=t&&t||e.classList.add("active"),"actived"==t||!t){e.classList.add("actived");let t=e.getAttribute("data-date");this.setState(e=>({year:t.split("-")[0],month:t.split("-")[1],day:t.split("-")[2]}))}}checkMonth(e,t){if(this.dateRule.day.show)this.setState(()=>({showMonth:e.getAttribute("date-number"),statusMonth:!0,statusYear:!1})),this.tableState="date";else{if(document.getElementById(this.calendarId).querySelectorAll("td").forEach((e,n)=>{"active"!=t&&t||e.classList.remove("active"),"actived"!=t&&t||e.classList.remove("actived")}),"active"!=t&&t||e.classList.add("active"),"actived"==t||!t){e.classList.add("actived");let t=e.getAttribute("date-number");this.setState(e=>({year:e.showYear,month:t}))}}setTimeout(()=>{this.getDateRender()})}checkYear(e,t){if(this.dateRule.month.show)this.setState(()=>({showYear:e.innerText,statusMonth:!1,statusYear:!1})),this.tableState="month";else{document.getElementById(this.calendarId).querySelectorAll("td").forEach((e,n)=>{"active"!=t&&t||e.classList.remove("active"),"actived"!=t&&t||e.classList.remove("actived")}),"active"!=t&&t||e.classList.add("active"),"actived"!=t&&t||(e.classList.add("actived"),this.setState(t=>({year:e.innerText})))}setTimeout(()=>{this.getDateRender()})}dbCheckYear(){this.okHandler(),this.closeHandler()}dbcheckDate(){this.okHandler(),this.closeHandler()}dbcheckMonth(){this.okHandler(),this.closeHandler()}changeTable(){"date"==this.tableState?(this.tableState="month",this.setState(()=>({statusMonth:!1})),this.getDateRender()):"month"==this.tableState&&(this.tableState="year",this.setState(()=>({statusYear:!0})),this.getDateRender())}prebutton(){"date"==this.tableState?this.setState(e=>{let t=Number(e.showMonth)-1<10?"0"+(Number(e.showMonth)-1):Number(e.showMonth)-1;return 1==e.showMonth?{showYear:Number(e.showYear)-1,showMonth:12}:{showMonth:t}}):"month"==this.tableState?this.setState(e=>({showYear:Number(e.showYear)-1})):"year"==this.tableState&&this.setState(e=>({showYear:Number(e.showYear)-10})),setTimeout(()=>{this.getDateRender()})}nextbutton(){"date"==this.tableState?this.setState(e=>{let t=Number(e.showMonth)+1<10?"0"+(Number(e.showMonth)+1):Number(e.showMonth)+1;return 12==e.showMonth?{showYear:Number(e.showYear)+1,showMonth:"01"}:{showMonth:t}}):"month"==this.tableState?this.setState(e=>({showYear:Number(e.showYear)+1})):"year"==this.tableState&&this.setState(e=>({showYear:Number(e.showYear)+10})),setTimeout(()=>{this.getDateRender()})}show(e,t){this.setState({left:e,top:t,isShow:!0})}getValue(){let e,t=this.state.year,n=this.state.month,r=this.state.day,i=this.state.format;return"yyyy年"==i?e=t+"年":"yyyy年MM月"==i?e=`${t}年${n}月`:"yyyy年MM月dd日"==i?e=`${t}年${n}月${r}日`:"yyyy-MM-dd"==i?e=`${t}-${n}-${r}`:"yyyy年MM月dd日HH时"==i?e=`${t}年${n}月${r}日${parseInt(this.timepicker.current.state.hour)<10?"0"+parseInt(this.timepicker.current.state.hour):parseInt(this.timepicker.current.state.hour)}时`:"yyyy年MM月dd日HH时mm分"==i?e=`${t}年${n}月${r}日${parseInt(this.timepicker.current.state.hour)<10?"0"+parseInt(this.timepicker.current.state.hour):parseInt(this.timepicker.current.state.hour)}时${parseInt(this.timepicker.current.state.minute)<10?"0"+parseInt(this.timepicker.current.state.minute):parseInt(this.timepicker.current.state.minute)}分`:"yyyy-MM-dd HH:mm"==i?e=`${t}-${n}-${r} ${parseInt(this.timepicker.current.state.hour)<10?"0"+parseInt(this.timepicker.current.state.hour):parseInt(this.timepicker.current.state.hour)}:${parseInt(this.timepicker.current.state.minute)<10?"0"+parseInt(this.timepicker.current.state.minute):parseInt(this.timepicker.current.state.minute)}`:"yyyy年MM月dd日HH:mm"==i?e=`${t}年${n}月${r}日${parseInt(this.timepicker.current.state.hour)<10?"0"+parseInt(this.timepicker.current.state.hour):parseInt(this.timepicker.current.state.hour)}:${parseInt(this.timepicker.current.state.minute)<10?"0"+parseInt(this.timepicker.current.state.minute):parseInt(this.timepicker.current.state.minute)}`:"yyyy年MM月dd日HH时mm分ss秒"==i?e=`${t}年${n}月${r}日${parseInt(this.timepicker.current.state.hour)<10?"0"+parseInt(this.timepicker.current.state.hour):parseInt(this.timepicker.current.state.hour)}时${parseInt(this.timepicker.current.state.minute)<10?"0"+parseInt(this.timepicker.current.state.minute):parseInt(this.timepicker.current.state.minute)}分${parseInt(this.timepicker.current.state.second)<10?"0"+parseInt(this.timepicker.current.state.second):parseInt(this.timepicker.current.state.second)}秒`:"yyyy-MM-dd HH:mm:ss"==i?e=`${t}-${n}-${r} ${parseInt(this.timepicker.current.state.hour)<10?"0"+parseInt(this.timepicker.current.state.hour):parseInt(this.timepicker.current.state.hour)}:${parseInt(this.timepicker.current.state.minute)<10?"0"+parseInt(this.timepicker.current.state.minute):parseInt(this.timepicker.current.state.minute)}:${parseInt(this.timepicker.current.state.second)<10?"0"+parseInt(this.timepicker.current.state.second):parseInt(this.timepicker.current.state.second)}`:"HH时mm分"==i?e=`${parseInt(this.timepicker.current.state.hour)<10?"0"+parseInt(this.timepicker.current.state.hour):parseInt(this.timepicker.current.state.hour)}时${parseInt(this.timepicker.current.state.minute)<10?"0"+parseInt(this.timepicker.current.state.minute):parseInt(this.timepicker.current.state.minute)}分`:"HH:mm"==i?e=`${parseInt(this.timepicker.current.state.hour)<10?"0"+parseInt(this.timepicker.current.state.hour):parseInt(this.timepicker.current.state.hour)}:${parseInt(this.timepicker.current.state.minute)<10?"0"+parseInt(this.timepicker.current.state.minute):parseInt(this.timepicker.current.state.minute)}`:"HH:mm:ss"==i&&(e=`${parseInt(this.timepicker.current.state.hour)<10?"0"+parseInt(this.timepicker.current.state.hour):parseInt(this.timepicker.current.state.hour)}:${parseInt(this.timepicker.current.state.minute)<10?"0"+parseInt(this.timepicker.current.state.minute):parseInt(this.timepicker.current.state.minute)}:${parseInt(this.timepicker.current.state.second)<10?"0"+parseInt(this.timepicker.current.state.second):parseInt(this.timepicker.current.state.second)}`),e}okHandler(){let e=this.getValue();this.props.onOk(e),this.curentNodeIndex=null}onCancel(){this.setState({year:"",month:"",day:"",hour:"",minute:"",second:""}),this.props.onOk("")}checkCurrentDate(){let e,t=a.DateTime.CurentTimeString,n=t.split(" ")[0],r=t.split(" ")[1],i=n.split("-")[0],l=n.split("-")[1],s=n.split("-")[2],o=r.split(":")[0],u=r.split(":")[1],h=r.split(":")[2],d=this.state.format;"yyyy年"==d?e=i+"年":"yyyy年MM月"==d?e=`${i}年${l}月`:"yyyy年MM月dd日"==d?e=`${i}年${l}月${s}日`:"yyyy-MM-dd"==d?e=`${i}-${l}-${s}`:"yyyy年MM月dd日HH时"==d?e=`${i}年${l}月${s}日${o}时`:"yyyy年MM月dd日HH时mm分"==d?e=`${i}年${l}月${s}日${o}时${u}分`:"yyyy-MM-dd HH:mm"==d?e=`${i}-${l}-${s} ${o}:${u}`:"yyyy年MM月dd日HH:mm"==d?e=`${i}年${l}月${s}日${o}:${u}`:"yyyy年MM月dd日HH时mm分ss秒"==d?e=`${i}年${l}月${s}日${o}时${u}分${h}秒`:"yyyy-MM-dd HH:mm:ss"==d?e=`${i}-${l}-${s} ${o}:${u}:${h}`:"HH时mm分"==d?e=`${o}时${u}分`:"HH:mm"==d?e=`${o}:${u}`:"HH:mm:ss"==d&&(e=`${o}:${u}:${h}`),this.props.onOk(e),this.setState({isRender:!1}),this.closeHandler()}render(){const{isRender:e}=this.state;return r.createElement(l.default,{className:this.popClassName,cancelText:"清空",onCancel:this.onCancel.bind(this),onClose:this.closeHandler.bind(this),onOk:this.okHandler.bind(this),isShow:e,isRender:e,showOkBtn:!0,showCancelBtn:!0,top:this.state.top,left:this.state.left,canceBtnId:this.canceBtnId,btnAllowEnter:!0,btnKeyUp:this.btnKeyUpHandler},r.createElement("div",{className:"calendar",id:this.calendarId},r.createElement("button",{className:"virtualRefTable",ref:this.virtualRef,onKeyUp:this.tableKeyUpHandler}),this.dateRule.dateShow?r.createElement(r.Fragment,null,r.createElement("div",{className:"statusbar"},r.createElement("button",{ref:this.btnPreRef,onClick:()=>{this.prebutton()},onKeyUp:this.btnPreKeyUpHandler},"<"),r.createElement("button",{ref:this.yearRef,onKeyUp:this.yearKeyUpHandler,className:"dateInfo",onClick:()=>{this.changeTable()}},r.createElement("label",null,r.createElement("span",null,this.state.showYear),r.createElement("span",null,this.state.statusMonth||this.state.statusYear?"-":null),r.createElement("span",null,this.state.statusMonth?this.state.showMonth:null),r.createElement("span",null,this.state.statusYear?Number(this.state.showYear)+9:null))),r.createElement("button",{ref:this.btnNextRef,onClick:()=>{this.nextbutton()},onKeyUp:this.btnNextKeyUpHandler},">")),r.createElement("table",{className:"calendartable"},this.state.tableData)):null,r.createElement("div",{style:{display:"flex",justifyContent:"space-evenly",flexWrap:"wrap"}},this.state.showTime?r.createElement(h,{hourShow:this.dateRule.hour.show,minuteShow:this.dateRule.minute.show,secondShow:this.dateRule.second.show,hour:this.state.hour,minute:this.state.minute,second:this.state.second,ref:this.timepicker,selectKeyUpEvent:this.selectKeyUpEvent}):"",r.createElement("span",{onClick:()=>{this.checkCurrentDate()},style:{fontSize:"16px",lineHeight:"52px",color:"#2d5afa",cursor:"pointer"}},"此刻"))))}getCurentNodeIndex(e,t){return null==e?t:(null==t&&(t=0),null==e.previousSibling?t:(t++,t=this.getCurentNodeIndex(e.previousSibling,t)))}btnKeyUpHandler(e){const t=e.target;if(38==e.which){const{showTime:e}=this.state;e?this.timepicker.current.selectRef.current.focus():this.nearNode.focus()}else{let n;37==e.which?n=t.previousSibling:39==e.which&&(n=t.nextSibling),null!=n&&"BUTTON"==n.nodeName.toUpperCase()&&n.focus()}}tableKeyUpHandler(e){if(13==e.which){if("date"==this.tableState)null!=this.nearNode&&this.checkDate(this.nearNode,"actived"),this.okHandler(),this.closeHandler();else if("month"==this.tableState){const{month:e,year:t,showYear:n}=this.state,r=this.nearNode.getAttribute("date-number");this.checkMonth(this.nearNode),this.nearNode=null,Number(e)==Number(r)&&Number(n)==Number(t)||this.yearRef.current.focus()}else"year"==this.tableState&&(this.checkYear(this.nearNode),this.nearNode=null,this.yearRef.current.focus());return}const t=document.getElementById(this.calendarId);let n=t.querySelector("td.active");null==n&&(n=t.querySelector("td.actived"));let r=0;null==n?(n=t.querySelector("td"),this.curentNodeIndex=0):r=null==this.curentNodeIndex?this.getCurentNodeIndex(n,null):this.curentNodeIndex;const i=n.parentNode;if(38==e.which){const e=i.previousSibling;if(null==e)return n.classList.remove("active"),this.nearNode=null,void(0==r?this.btnPreRef.current.focus():r>=i.childNodes.length-1?this.btnNextRef.current.focus():this.yearRef.current.focus());let t=e.childNodes[r];null==t&&(t=e.childNodes[0]),this.nearNode=t}else if(40==e.which){const{showTime:e}=this.state,t=i.nextSibling;if(null==t){if(n.classList.remove("active"),this.nearNode=null,e)this.timepicker.current.selectRef.current.focus();else{document.getElementById(this.canceBtnId).focus()}return}let l=t.childNodes[r];null==l&&t.childNodes.length>1&&(l=t.childNodes[t.childNodes.length-1]),null!=l&&(this.nearNode=l)}else if(37==e.which){if(0==r)return;this.curentNodeIndex=r,this.curentNodeIndex--;const e=i.childNodes[this.curentNodeIndex];this.nearNode=e}else if(39==e.which){if(r>=i.childNodes.length-1)return;this.curentNodeIndex=r,this.curentNodeIndex++;const e=i.childNodes[this.curentNodeIndex];this.nearNode=e}this.checkDate(this.nearNode,"active")}btnPreKeyUpHandler(e){if(13==e.which);else if(40==e.which){const e=document.getElementById(this.calendarId).querySelectorAll("td");if(!e)return;if(!(e.length>0))return;this.curentNodeIndex=0;const t=e[0];this.nearNode=t,this.checkDate(this.nearNode,"active"),this.virtualRef.current.focus()}else 39==e.which&&this.yearRef.current.focus()}yearKeyUpHandler(e){if(13==e.which)this.nearNode=null;else if(40==e.which){if(null==this.nearNode){const e=document.getElementById(this.calendarId).querySelectorAll("td");if(!e)return;if(!(e.length>0))return;const t=e[0].parentNode.childNodes.length;if(!(t>0))return;const n=Math.floor(t/2);this.curentNodeIndex=n;const r=e[this.curentNodeIndex];this.nearNode=r,this.curentNodeIndex=n}"date"==this.tableState?this.checkDate(this.nearNode,"active"):this.nearNode.classList.add("active"),this.virtualRef.current.focus()}else 37==e.which?this.btnPreRef.current.focus():39==e.which&&this.btnNextRef.current.focus()}btnNextKeyUpHandler(e){if(13==e.which);else if(40==e.which){const e=document.getElementById(this.calendarId).querySelectorAll("td");if(!e)return;if(!(e.length>0))return;const t=e[0].parentNode.childNodes.length;if(!(t>0))return;this.curentNodeIndex=t-1;const n=e[this.curentNodeIndex];this.nearNode=n,this.checkDate(this.nearNode,"active"),this.virtualRef.current.focus()}else 37==e.which&&this.yearRef.current.focus()}selectKeyUpEvent(e){if(37==e){const e=document.getElementById(this.calendarId).querySelectorAll("td");if(!e)return;const t=e.length;if(!(t>0))return;const n=e[t-1],r=n.parentNode.childNodes.length;if(!(r>0))return;this.curentNodeIndex=r-1,this.nearNode=n,this.checkDate(this.nearNode,"active"),this.virtualRef.current.focus()}else if(39==e){document.getElementById(this.canceBtnId).focus()}}}t.default=u;class h extends r.Component{constructor(e){super(e),this.selectRef=r.createRef(),this.hourchange=e=>{this.setState({hour:e})},this.minutechange=e=>{this.setState({minute:e})},this.secondchange=e=>{this.setState({second:e})},this.state={hour:e.hour,minute:e.minute,second:e.second,hourShow:e.hourShow,minuteShow:e.minuteShow,secondShow:e.secondShow},this.selectKeyUpHandler=this.selectKeyUpHandler.bind(this)}selectKeyUpHandler(e){const t=e.target;let n;37==e.which?n=this.getSelect(t,"previousElementSibling"):39==e.which&&(n=this.getSelect(t,"nextElementSibling")),null!=n?n.focus():this.props.selectKeyUpEvent(e.which)}getSelect(e,t){if(null==e)return null;const n=e[t];return null==n?null:"SELECT"==n.nodeName.toUpperCase()?n:this.getSelect(n,t)}renderHour(){const{hourShow:e,hour:t}=this.state;return e?r.createElement(r.Fragment,null,r.createElement(o.NumberInput,{width:"72",ref:e,step:"1",showIcon:!0,value:t,max:23,min:0,onValueChanged:this.hourchange}),r.createElement("span",null,"时")):null}renderMinute(){const{minuteShow:e,minute:t}=this.state;return e?r.createElement(r.Fragment,null,r.createElement(o.NumberInput,{width:"72",max:59,min:0,step:"1",showIcon:!0,value:t,onValueChanged:this.minutechange}),r.createElement("span",null,"分")):null}renderSecond(){const{secondShow:e,second:t}=this.state;return e?r.createElement(r.Fragment,null,r.createElement(o.NumberInput,{width:"72",max:59,min:0,step:"1",showIcon:!0,value:t,onValueChanged:this.secondchange}),r.createElement("span",null,"秒")):null}render(){let e=[],t=[],n=[];for(var i=0;i<60;i++)i<24?(e.push(i<10?"0"+i:i),t.push(i<10?"0"+i:i),n.push(i<10?"0"+i:i)):(t.push(i),n.push(i));return r.createElement("div",{className:"timecontainer"},this.renderHour(),this.renderMinute(),this.renderSecond())}}t.Timepicker=h;class d extends s.BaseComponent{constructor(e,t){super(e,t),this.updateProps=e=>{this.Child&&this.Child.updateEvent(e)}}Render(){const e=r.createElement(u,Object.assign({},this.Props,{parent:this,onRef:e=>this.Child=e}));i.render(e,document.createDocumentFragment())}}t.CalendarComp=d},function(e,t,n){var r=n(18),i=n(649);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){var r=n(18),i=n(652);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SerCodeUtil=void 0;const r=n(227),i=n(8);class l{static GetSerCode(e,t,n){let s;if(e<0)s="?";else if(r.ENumSerType.None==t)s=i.CNumUtil.ToStringForNum(e);else{let o=null;switch(t){case r.ENumSerType.Arabic:o=i.CNumUtil.ToStringForNum(e);break;case r.ENumSerType.Roman:o=l.GetCodeRoman(e,n);break;case r.ENumSerType.ABC:o=l.GetCodeABC(e,n);break;case r.ENumSerType.Chinese:o=l.GetCodeCHS(e,n);break;case r.ENumSerType.ChsGanZhiOR:o=l.GetCodeGanZhiOR(e,n);break;case r.ENumSerType.ChsGanZhiAND:o=l.GetCodeGanZhiAND(e)}s=o}return s}static GetCodeABC(e,t){let n;if(e<=0)n="?";else{e--;let r="";for(;e>=0;){let n=e%26;r=String.fromCharCode(n+(t?65:97))+r,e=(e-n)/26,e--}n=r}return n}static GetCodeRoman(e,t){let n="",r=0;for(;0!=e;)e>=l.Roman_Base[r]?(e-=l.Roman_Base[r],n+=t?l.UpRoman_Nums[r]:l.LowRoman_Nums[r]):r++;return n}static GetCodeCHS(e,t){let n="";if(0==e)n=t?l.TradChs_Nums[0]:l.SimpleChs_Nums[0];else{let r=e,i=0;for(;(r/=10)>0;)i++;let s=-1,o=0;for(r=e;r>0;){let e=r%10;if(0!=o&&(0!=e||o<=0)){n+=t?l.TradChs_Base[o]:l.SimpleChs_Base[o]}if((0!=e||0!=o&&0!=s)&&(1!=i||1!=o||1!=e)){n+=t?l.TradChs_Nums[e]:l.SimpleChs_Nums[e]}s=e,r=(r-e)/10,o++}}return n}static GetCodeGanZhiOR(e,t){let n;if(e<0)n="?";else{let r=t?l.TianganChs_Nums:l.DizhiChs_Nums;n=r[e%r.length]}return n}static GetCodeGanZhiAND(e){let t;if(e<0)t="??";else{let n=l.TianganChs_Nums.length,r=e%n,i=l.TianganChs_Nums[r];n=l.DizhiChs_Nums.length,r=e%n,t=i+l.DizhiChs_Nums[r]}return t}}t.SerCodeUtil=l,l.LowRoman_Nums=["m","cm","d","cd","c","xc","l","xl","x","ix","v","iv","i"],l.UpRoman_Nums=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],l.Roman_Base=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],l.SimpleChs_Nums=["〇","一","二","三","四","五","六","七","八","九"],l.SimpleChs_Base=["个","十","百","千","万","十万","百万","千万","亿","十亿","百亿","千亿","万亿"],l.TradChs_Nums=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],l.TradChs_Base=["个","拾","佰","仟","万","拾万","佰万","仟万","亿","拾亿","佰亿","仟亿","万亿"],l.TianganChs_Nums=["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],l.DizhiChs_Nums=["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XSpliteLineEle=void 0;const r=n(8),i=n(10),l=n(25),s=n(16),o=n(320),a=n(91),u=n(3),h=n(0),d=n(35),c=n(2),p=n(4);class f extends h.XBaseResizableElement{constructor(){super(...arguments),this.isSelected=!1,this.isDrawDashedRect=!1,this.dashedBorderRect=null,this._DottedLinePadding=null,this._DottedLineWidth=null}get EleTypeName(){return"HorizontalLine"}get IsSelected(){return this.isSelected}set IsSelected(e){this.isSelected=e}get EleCursorAllowSide(){return c.ENumEleCursorSide.Left}get IsDrawDashedRect(){return this.isDrawDashedRect}set IsDrawDashedRect(e){this.isDrawDashedRect=e}get DashedBorderRect(){return this.DashedBorderRect}set DashedBorderRect(e){this.DashedBorderRect=e}get LineHeight(){let e=this.propList.GetPropValue("Height");return r.CNumUtil.TryParseFloat(e,-1)}set LineHeight(e){this.propList.ModifyProperty("Height",e,0)}get IsAutoSuitWidth(){let e=this.propList.GetPropValue("IsAutoSuitWidth");return r.CNumUtil.TryParseBool(e,!0)}set IsAutoSuitWidth(e){this.propList.ModifyProperty("IsAutoSuitWidth",e,!0)}GetDefaultWidth(){let e,t=super.Parent;if(null==t)return-1;if(t instanceof h.XBaseInputEle&&(t=s.XDomUtil.GetTopContainer(t),null==t))return-1;if(t instanceof h.XDocPanel){let n=t.GetColumnsParam();return e=null!=n&&n.ColsCnt>1?n.GetColWidth(0,96):t.GetValidWidth(96),e}return t.GetValidWidth(96)}InitDrawSize(e,t){null==t&&(t=this);let n=s.XDomUtil.ReCalcDrawSize(t,e.Width,e.Height);this.SetSizeDPI(n.Width,n.Height,96),this.IsLayoutValid=!1}get LineLengthInCm(){let e=this.propList.GetPropValue("LineLengthInCM");return r.CNumUtil.TryParseFloat(e,-1)}set LineLengthInCm(e){this.propList.ModifyProperty("LineLengthInCM",e,-1)}get LineSize(){let e=this.propList.GetPropValue("LineSize");return r.CNumUtil.TryParseFloat(e,-1)}set LineSize(e){this.propList.ModifyProperty("LineSize",e,-1)}get ShowLineStyle(){let e=this.propList.GetPropValue("ShowLineStyle");return p.default.IsNullOrEmpty(e)&&(e="SolidLine"),e}set ShowLineStyle(e){this.propList.ModifyProperty("ShowLineStyle",e,-1)}IsWholeLineEle(){return!0}GetInnerText(e){return"分割线"}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r);let i=e;null!=i&&(this.LineLengthInCm=i.LineLengthInCm,this.LineSize=i.LineSize,super.EleStyle.ForeColor=i.EleStyle.ForeColor)}GetForbidAnchors(){let e=new u.List;return super.GetBoundsDPI(96).Height>=8?(e.Add(a.MarkPoint.LeftTop),e.Add(a.MarkPoint.LeftCenter),e.Add(a.MarkPoint.LeftBottom),e.Add(a.MarkPoint.RightTop),e.Add(a.MarkPoint.RightCenter),e.Add(a.MarkPoint.RightBottom)):(e.Add(a.MarkPoint.LeftTop),e.Add(a.MarkPoint.LeftCenter),e.Add(a.MarkPoint.LeftBottom),e.Add(a.MarkPoint.TopCenter),e.Add(a.MarkPoint.BottomCenter),e.Add(a.MarkPoint.RightTop),e.Add(a.MarkPoint.RightCenter),e.Add(a.MarkPoint.RightBottom)),e.ToArray()}get DottedLinePadding(){return this._DottedLinePadding}set DottedLinePadding(e){this._DottedLinePadding=e}get DottedLineWidth(){return this._DottedLineWidth}set DottedLineWidth(e){this._DottedLineWidth=e}InitSpliteLineEle(e,t){this.LineLengthInCm=e.LineLength,this.LineSize=e.LineWidth,super.EleStyle.ForeColor=e.HorLineColor,super.GrpID=e.No,this.IsAutoSuitWidth=e.IsAutoWidth,this.ShowLineStyle=e.ShowLineStyle,this.DottedLinePadding=e.DottedLinePadding,this.DottedLineWidth=e.DottedLineWidth;let n=d.CommDefines.ConverCmToPx(this.LineLengthInCm,96),r=e.SpliteLineEleHeight;this.InitDrawSize(new l.SizeF(n,r),t)}GetSpliteLineInfo(){return this.BulidSpliteLineInfo()}BulidSpliteLineInfo(){let e=new o.HorizontalLinePropertiesInfo;return e.Type="spliteLine",e.No=this.GrpID,e.HorLineColor=this.EleStyle.ForeColor,e.LineWidth=this.LineSize,e.LineLength=this.LineLengthInCm,e.SpliteLineEleHeight=this.GetBoundsDPI(96).Height,e.IsAutoWidth=this.IsAutoSuitWidth,e.ShowLineStyle=this.ShowLineStyle,e.DottedLineWidth=this.DottedLineWidth,e.DottedLinePadding=this.DottedLinePadding,e}ClearSelected(){this.IsSelected=!1}M_AutoSuitWidth(){if(this.IsAutoSuitWidth){let e=i.DPITransUtil.TransFloatVal(this.Height,300,96),t=new l.SizeF(this.GetDefaultWidth(),e);this.SetSizeDPI(t.Width,t.Height,96)}}}t.XSpliteLineEle=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XInputBorderEle=void 0;const r=n(162),i=n(10),l=n(2);class s extends r.XLabelEle{constructor(){super(),this._isStartBorder=!1,this._isDrawText=!1,this._isShowHaveEmpty=!1,super.LabelType=l.ENumXLabelType.XInputBorder,this.IsDrawText=!0,this.IsShowHaveEmpty=!0}get EleTypeName(){return"XLableInputBorder"}get IsStartBorder(){return this._isStartBorder}set IsStartBorder(e){this._isStartBorder=e}get IsDrawText(){return this._isDrawText}set IsDrawText(e){this._isDrawText=e}get IsShowHaveEmpty(){return this._isShowHaveEmpty}set IsShowHaveEmpty(e){this._isShowHaveEmpty=e}get PrintInLine(){return this._printInLine}set PrintInLine(e){this._printInLine=e}get BrotherBorderEle(){return this._brotherBorderEle}set BrotherBorderEle(e){this._brotherBorderEle=e}CanBeInline(e=!1){return!e||this.PrintInLine}ReCalcBaseSize(){if(super.ReCalcBaseSize(),!this.IsDrawText){let e=4;this.IsShowHaveEmpty||(e=0),this.SetSizeDPI(e,i.DPITransUtil.TransFloatVal(this.Height,300,96),96)}}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r);let i=e instanceof s?e:null;null!=i&&(this.IsStartBorder=i.IsStartBorder,this.IsDrawText=i.IsDrawText,this.IsShowHaveEmpty=i.IsShowHaveEmpty),this._brotherBorderEle=null}NotifyLayoutChanged(e=!0,t=!1){super.NotifyLayoutChanged(e,!1),null!=this._brotherBorderEle&&(this._brotherBorderEle.IsLayoutValid=this.IsLayoutValid)}GetInnerText(e){let t;return t=this.IsDrawText?super.GetInnerText(e):"",t}SetEleStyle(e){null!=e&&(super.EleStyle.Clear(),super.EleStyle=e.EleStyle)}}t.XInputBorderEle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XLabelSerno=void 0;const r=n(2),i=n(8),l=n(0),s=n(117);class o extends l.XLabelEle{constructor(){super(),super.LabelType=r.ENumXLabelType.XOutlineSerno}get RelParaghEle(){return this.relParaghEle}set RelParaghEle(e){this.relParaghEle=e}get Index(){let e=this.propList.GetPropValue("Index");return i.CNumUtil.TryParseInt(e,-1)}set Index(e){this.propList.ModifyProperty("Index",e,-1),this.IsLayoutValid=!1}get EleCursorAllowSide(){return r.ENumEleCursorSide.ForceRight}NeedSerialized(){return!1}ToXML(e){return null}RebuildText(){let e=null==this.relParaghEle?null:this.relParaghEle.ParaghStyle;const t=s.ParagraphListStyleVals.IsNoneListStyle(e.ParagraphListStyle);e.ParagraphMultiLevel?null!=this.relParaghEle.RelOutline&&(super.Text=this.relParaghEle.RelOutline.BuildFullSerno()):(null==e||t)&&(super.Text="")}}t.XLabelSerno=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XOutlineFoldIcon=void 0;const r=n(333),i=n(43),l=n(0);class s extends l.XBaseMarkContainer{constructor(){super(...arguments),this.ch="∨",this.isFolded=!1}get EleTypeName(){return"XOutlineFoldIcon"}get IsFolded(){return this.isFolded}set IsFolded(e){e!=this.isFolded&&(this.isFolded=e,this.ch=this.isFolded?">":"∨")}get IsVisible(){return this.IsFolded||super.IsVisible}set IsVisible(e){super.IsVisible=this.IsFolded||e}_InitIconSize(){let e=r.SystemFonts.DefaultFont,t=i.GrapUtil.MeasureCharWidth(null,e,500,">"),n=96*e.SizeInPoints/72;this.SetSizeDPI(2*t,n,96)}ReverseFolded(){this.IsFolded=!this.isFolded}CalcPosByRelLineEleFrom(e){if(null!=e){let t=e.X-this.Width,n=e.Y;this.SetPositionDPI(t,n,300)}}ReCalcBaseSize(){}GetInnerText(e){return this.ch}NeedSerialized(){return!1}ToXML(e){return null}}t.XOutlineFoldIcon=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemFonts=void 0;const r=n(51);t.SystemFonts=class{static CaptionFont(){return null}static SmallCaptionFont(){return null}static MenuFont(){return null}static StatusFont(){return null}static MessageBoxFont(){return null}static IconTitleFont(){return null}static get DefaultFont(){return new r.Font("微软雅黑",12)}static DialogFont(){return null}static GetFontByName(e){return null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XContainerBaseView=void 0;const r=n(0);class i extends r.XBaseContainer{NeedSerialized(){return!1}ToXML(e){return null}FromXML(e){}}t.XContainerBaseView=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventArgs=void 0;class r{static get Empty(){return new r}constructor(){}}t.EventArgs=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableRow=void 0;const r=n(3),i=n(20),l=n(10),s=n(9),o=n(14),a=n(8),u=n(0);class h extends u.XBaseContainer{constructor(){super(),this.boundsDisp=s.RectangleF.Empty,this._width=0,this._height=0,this._FixHeight=0,this._WidthDisp=-1,this.Cells=new r.List}get EleTypeName(){return"XTextTableRow"}get BoundsDISP(){return this.boundsDisp}set BoundsDISP(e){this.boundsDisp=e}get Width(){return this._width}set Width(e){this._width=e}get Height(){return this._height}set Height(e){this._height=e}get FixHeight(){return this._FixHeight}set FixHeight(e){this._FixHeight=e}get WidthDisp(){return this._WidthDisp}set WidthDisp(e){this._WidthDisp=e}get HeightDisp(){return l.DPITransUtil.TransIntVal(this.Height,300,96)}get Index(){return super.Parent.GetChildInx(this)}set Index(e){}get Cells(){return this._cells}set Cells(e){this._cells=e}SetSizeDPI(e,t,n){super.SetSizeDPI(e,t,n)}AddChildEle(e,t){return t instanceof u.XTextTableCell&&(t.LineCntChanged=null,t.LineCntChanged=this.childCell_LineCntChanged.bind(this)),super.AddChildEle(e,t)}childCell_LineCntChanged(e,t){if(null!=e&&e instanceof u.XTextTableCell&&null!=e.Parent){const t=e.Parent,n=t.Parent.Rows;let r=t.ChildEleList.GetEnumerator(),i=0,l=0,s=0,o=!0,a=null,h=[];for(;r.MoveNext();){let e=r.Current instanceof u.XTextTableCell?r.Current:null;if(null!=e){if(!e.Visible&&e.MainMergeCell&&e.MainMergeCell.RowSpan>1&&e.RowIndex>e.MainMergeCell.RowIndex&&e.RowIndex==e.MainMergeCell.RowIndex+e.MainMergeCell.RowSpan-1){h.push(e.ColIndex);const t=e.MainMergeCell;let n=t.GetRealHeight(!1);n=Math.max(n,e.FixHeight),n-=t.RowBaseHeight;const r=t.RelatedMergeCell_Down;for(let t=0;t<r.Count();t++){const i=r.Get(t);i!=e&&(n-=Math.max(i.RowBaseHeight,0))}i=Math.max(i,n),s=Math.max(s,n),(null==a||t.RowSpan<=a.RowSpan&&t.GetRealHeight(!1)>a.GetRealHeight(!1))&&(a=t)}else if(e.Visible&&e.RowSpan<=1){const t=e.GetRealHeight(!0);l=Math.max(l,t)}else if(e.Visible&&e.RowSpan>1){let t=!0;const r=e.RowIndex+1,i=e.RowIndex+e.RowSpan-1;for(let e=r;e<=i;e++){const r=n.Get(e).Cells;if(null!=r&&r.Count()>0)for(let e=0;e<r.Count();e++){if(r.Get(e).Visible){t=!1;break}}}if(t){const t=e.GetRealHeight(!0);l=Math.max(l,t)}}e.Visible&&(o=!1)}}if(r.Reset(),l=Math.max(l,i),this.Height=l>0?l:50,o)if(s>0&&null!=a){const e=a.Parent;if(null!=e){const t=e.Height,n=t+s;for(let r=0;r<e.ChildCount;r++){const i=e.ChildEleList.Get(r);Math.abs(t-i.Height)<.25&&i.SetSizeDPI(-1e3,n,300)}e.Height=n,a.FromNextHideHeight=s;for(let t=0;t<h.length;t++){const n=h[t];e.Cells.Get(n).FromNextHideHeight=s}}}else this.Height=0;else this.Height=Math.max(this.FixHeight,this.Height);for(;r.MoveNext();){let e=r.Current instanceof u.XTextTableCell?r.Current:null;if(null!=e){let t=!0;if(e.RowSpan>1&&e.Visible){e.GetRealHeight(!0)>this.Height&&(t=!1)}t&&e.SetSizeDPI(-1e3,this.Height,300)}}}}CreateCells(e=!1,t){this.ClearChildren(!0),this.Cells.Clear();let n=super.Parent instanceof u.XTextTable?super.Parent:null;if(null==n)return;let r=0;for(let l of n.Columns){let n=new u.XTextTableCell;if(n.Parent=this,n.OwnerDocPanel=this.OwnerDocPanel,n.Column=l,n.EleStyle.CopyFrom(i.XTextTableUtil.GetDefaultCellStyle(this.Document),!1),null!=t){const e=t.Cells;if(null!=e){const t=e.Get(r),i=n.EleStyle;i.BorderLeft=t.EleStyle.BorderLeft,i.BorderRight=t.EleStyle.BorderRight,i.BorderTop=t.EleStyle.BorderTop,i.BorderBottom=t.EleStyle.BorderBottom,n.setPaddLRByBorderLR()}}if(n.WidhtDisp=l.BoundsDISP.Width,n.CreateInnerElement(),n.SetSizeDPI(n.Column.Width,-1e3,300),this.AddChildEle(2147483647,n),this.Cells.Add(n),this.WidthDisp+=l.BoundsDISP.Width,e&&null!=t){const e=t.Cells;if(null!=e){const t=e.Get(r);n.Visible=t.Visible,n.ColSpan=t.ColSpan,n.WidhtDisp=t.BoundsDISP.Width,n.SetSizeDPI(t.Width,-1e3,300)}}r++}}InsertCell(e){if(!(super.Parent instanceof u.XTextTable))return;const t=super.Parent;this.WidthDisp=0;for(let n=0;n<t.Columns.Count();n++){if(n==e){let r=new u.XTextTableCell;if(r.Parent=this,r.OwnerDocPanel=this.OwnerDocPanel,r.EleStyle.CopyFrom(i.XTextTableUtil.GetDefaultCellStyle(this.Document),!1),e>=0){const t=e>0?e-1:e+1,n=this.Cells.Get(t);if(null!=n){const e=r.EleStyle;e.BorderLeft=n.EleStyle.BorderLeft,e.BorderRight=n.EleStyle.BorderRight,e.BorderTop=n.EleStyle.BorderTop,e.BorderBottom=n.EleStyle.BorderBottom,r.setPaddLRByBorderLR()}}r.CreateInnerElement(),r.Column=t.Columns.Get(n),r.WidhtDisp=t.Columns.Get(n).BoundsDISP.Width,r.SetSizeDPI(r.Column.Width,-1e3,300),this.AddChildEle(n,r),this.Cells.Insert(n,r)}else n<this.Cells.Count()&&(this.Cells.Get(n).Column=t.Columns.Get(n),this.Cells.Get(n).WidhtDisp=t.Columns.Get(n).BoundsDISP.Width,this.Cells.Get(n).SetSizeDPI(this.Cells.Get(n).Column.Width,-1e3,300));if(this.WidthDisp+=t.Columns.Get(n).BoundsDISP.Width,this.Cells.Get(n).LinesList.Count()>0){let e,t=!0,r=0;do{e=this.Cells.Get(n).LinesList.Get(r);const i=e.LastElement;this.Cells.Get(n).Width<i.Bounds.Right&&(t=!1),r++}while(t&&r<this.Cells.Get(n).LinesList.Count());this.Cells.Get(n).IsLayoutValid=t}}this.ReCalcCombined(e)}InsertCell_Withindex(e,t){this.AddChildEle(t,e),t>this.Cells.Count()?this.Cells.Add(e):this.Cells.Insert(t,e)}ReCalcCombined(e){if(e<this.Cells.Count()&&e!=this.Cells.Count()-1){const t=this.Cells.Get(e+1);if(!t.Visible&&t.MainMergeCell.RowIndex==this.Index)for(let t=e-1;t>=0;t--)if(this.Cells.Get(t).Visible){this.Cells.Get(t).ColSpan>0&&this.Cells.Get(t).ColSpan++;break}}}RedoUndo_InsertCell(e,t){let n=super.Parent instanceof u.XTextTable?super.Parent:null;if(null!=n){this.WidthDisp=0;for(let r=0;r<n.Columns.Count();r++)r==e&&(this.AddChildEle(r,t),this.Cells.Insert(r,t)),this.Cells.Get(r).Column=n.Columns.Get(r),this.Cells.Get(r).WidhtDisp=n.Columns.Get(r).BoundsDISP.Width,this.Cells.Get(r).SetSizeDPI(this.Cells.Get(r).Column.Width,-1e3,300),this.WidthDisp+=n.Columns.Get(r).BoundsDISP.Width}}CanBeInline(e=!1){return!1}SetPositionDPI(e,t,n){super.SetPositionDPI(e,t,n)}ToXML(e){let t=super.ToXML(e);return this.FixHeight>0&&t.setAttribute("FixRowHeight",this.FixHeight.toString()),t}FromXML(e){this.ClearChildren(!0),this.Cells.Clear(),super._FromXML_EleStyle(e);let t=o.XmlDomUtil.GetSingleNode(e,"XElements");if(this.FixHeight=a.CNumUtil.TryParseFloat(o.XmlDomUtil.GetSingleAttrValue(e,"FixRowHeight"),-1e3),null==t)return;let n=t.children;if(null!=n&&0!=n.length)for(let e=0;e<n.length;e++){let t=o.XmlDomUtil.GetSingleAttrValue(n[e],"xsi:type"),r=u.XElementFactory.CreatXElement(t,null);if(null!=r){r.OwnerDocPanel=this.OwnerDocPanel;let t=r instanceof u.XTextTableCell?r:null;if(null!=t){let r=super.Parent instanceof u.XTextTable?super.Parent:null;null!=r&&null!=r.Columns&&r.Columns.Count()>e&&(t.Column=r.Columns.Get(e),t.WidhtDisp=t.Column.BoundsDISP.Width,t.SetSizeDPI(t.Column.Width,this.FixHeight,300),t.FixHeight=this.FixHeight,t.FromXML(n[e]),t.setPaddLRByBorderLR(r.EleStyle.BorderVerticalCenter),this.AddChildEle(2147483647,t),this.Cells.Add(t),this.WidthDisp+=t.Column.BoundsDISP.Width)}}}}get DisSplit(){if(null==this.Cells)return!1;let e=!1;const t=this.Cells.ToArray();for(let n=0;n<t.length;n++){const r=t[n];if(e=r.DisSplit||e,e)break;if(null!=r.MainMergeCell&&(e=r.MainMergeCell.DisSplit||e),e)break}return e}}t.XTextTableRow=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrDocView=void 0;const r=n(689),i=n(10),l=n(82);class s extends r.XRulerControl{constructor(e,t){super(e),this.EleTipShowRule="FollowEleSetting",this._XDocEditableCanvas=e,this._emrWriter=t}get DocWrapper(){return this._emrWriter}get EleTipShowRule(){return this._EleTipShowRule}set EleTipShowRule(e){this._EleTipShowRule=e}tmpCanvas_NotifyZoomRChanged(e){this.SetScale(e),this.RefreshRuler()}RefreshRuler(){var e;let t,n,r,l=this.GetPageMargin(),s=0,o=0,a=0;const u=this._eleEvtModel().EleClicked;if(null!=u){const t=u.OwnPageView;if(null!=t){let n=null===(e=null==t?void 0:t.Document)||void 0===e?void 0:e.FirstDocStartPageNum;t.PageIx>=0&&(a=t.PageIx-(null!=n?n:0));const l=u.OwnerLine;if(null!=l){let e=l.RelEleParagraphStyle;null!=e&&(s=i.DPITransUtil.TransFloatVal(e.FirstLineIndent,300,96),o=i.DPITransUtil.TransFloatVal(e.LeftIndent,300,96))}r=t.GetPageRectUI(96)}}const h=this._XDocEditableCanvas.MGetArrPages();if(null!=h&&(t=h[a].PageRect.Clone(),n=this._XDocEditableCanvas.MGetWrapBound(),null!=n&&(t.X=1+n.X,t.Y=1+n.Y)),null!=h&&null!=n||(t=r,n=r),null==t||null==n)return;const d=this._XDocEditableCanvas.dom;let c=this._XDocEditableCanvas.PageContainerDom.clientWidth,p=0,f=0;if(a>0){const e=Math.floor(c/n.Width);p=(a+1)%e,p=0==p?e-1:p-1,f=Math.ceil((a+1)/e),f-=1}this.SetTopRulerWidth(n.Width,c,p),this.SetLeftRulerHeight(n.Height,f),this.SetTopRuler(t.X,t.Width,l.Left,l.Right,s,o),this.SetLeftRuler(t.Y,t.Height+1,l.Top,l.Bottom,d)}_eleEvtModel(){return this._XDocEditableCanvas.M_EleEvtModel}GetPageMargin(){let e=l.Padding.Empty,t=this._XDocEditableCanvas.M_DocumentFocused.GetPageFmt().PagePadd;return e=i.DPITransUtil.TransPadding(t,100,96),e}}t.EmrDocView=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Position=t.XToolTipRender=void 0;const r=n(5),i=n(7),l=n(51),s=n(17),o=n(25),a=n(4),u=n(232),h=n(692),d=n(693);class c{constructor(){this.autoCloseDelay=5e3,this.borderColor=new i.Color("LightBlue"),this.canShow=!0,this.maxTipWidth=286,this.text="",this.showAlways=!1,this.isBalloon=!1,this.useAnimation=!1,this.useFading=!1,this.hasDropShadow=!1,this.backColor=new i.Color("White"),this.foreColor=new i.Color("47, 47, 47"),this.toolTipIcon=h.ToolTipIcon.None,this._title="",this._topMost=!1,this.Text="",this._title="",this.Font=u.RelativeUIParam.Font,this.canShow=!0,this.maxTipWidth=286,this.InitialDelay=500,this.AutoCloseDelay=5e3,this.useAnimation=!1,this.useFading=!1,this.isBalloon=!1,this.showAlways=!1,this.hasDropShadow=!1,this._topMost=!1,this.backColor=i.Color.White,this.foreColor=i.Color.FromArgb(47,47,47),this.BorderColor=i.Color.LightBlue}get InitialDelay(){return this.initialDelay}set InitialDelay(e){this.initialDelay=e}get AutoCloseDelay(){return this.autoCloseDelay}set AutoCloseDelay(e){this.autoCloseDelay=e}get BorderColor(){return this.borderColor}set BorderColor(e){this.borderColor=e}get CanShow(){return this.canShow}set CanShow(e){e!=this.canShow&&(this.canShow=e,e||this.Hide())}get IsHandleCreate(){return this.IsHandleCreated}get IsHandleCreated(){return null!=window}get IsShowing(){return!1}get MaxTipWidth(){return this.maxTipWidth}set MaxTipWidth(e){this.maxTipWidth!=e&&(this.maxTipWidth=e)}get Text(){return this.text}set Text(e){this.text=e}get Location(){return this.location}set Location(e){this.location=e}get ShowAlways(){return this.showAlways}set ShowAlways(e){this.showAlways!=e&&(this.showAlways=e,this.IsHandleCreated&&this.RecreateHandle())}get IsBalloon(){return this.isBalloon}set IsBalloon(e){this.isBalloon!=e&&(this.isBalloon=e,this.IsHandleCreated&&this.RecreateHandle())}get UseAnimation(){return this.useAnimation}set UseAnimation(e){this.useAnimation!=e&&(this.useAnimation=e,this.IsHandleCreated&&this.RecreateHandle())}get UseFading(){return this.useFading}set UseFading(e){this.useFading!=e&&(this.useFading=e,this.IsHandleCreated&&this.RecreateHandle())}get HasDropShadow(){return this.hasDropShadow}set HasDropShadow(e){this.hasDropShadow!=e&&(this.hasDropShadow=e,this.IsHandleCreated&&this.RecreateHandle())}get BackColor(){return this.backColor}set BackColor(e){this.backColor=e,this.IsHandleCreated}get ForeColor(){return this.foreColor}set ForeColor(e){if(e.IsEmpty)throw new r.ArgumentException("鼠标提示颜色为空，ForeColor");this.foreColor=e,this.IsHandleCreated}get ToolTipIcon(){return this.toolTipIcon}set ToolTipIcon(e){if(this.toolTipIcon!=e&&(c.IsEnumValid(e,e,h.ToolTipIcon.None,h.ToolTipIcon.Error),this.toolTipIcon=e,this.toolTipIcon>0&&this.IsHandleCreated)){a.default.IsNullOrEmpty(this._title)||this._title}}RecreateHandle(){}static IsEnumValid(e,t,n,r){return t>=n&&t<=r}get Title(){return this._title}set Title(e){null==e&&(e=""),this._title!=e&&(this._title=e,this.IsHandleCreated)}get TopMost(){return this._topMost}set TopMost(e){this.TopMost!=e&&(this._topMost=e,this.IsHandleCreated&&this.RecreateHandle())}get Font(){return this._font}set Font(e){this._font=e}Hide(){null!=this.tooltip&&this.tooltip.hide()}ActivateTip(){if(!this.IsHandleCreated)throw new r.InvalidOperationException("Handle not created !");let e=this.Location;this.tooltip=new d.Tooltip({text:this.Text,top:e.Y,left:e.X}),this.tooltip.show()}Close(){this.Hide()}Show(e,t){this.canShow&&this.Show1(this.Title,e,this.ToolTipIcon,t)}Show1(e,t,n,r){this.Text=c.NormalizeTooltipText(t),this.Title=e,this.toolTipIcon=n,this.IsHandleCreated&&this.Close(),this.CreateHandle(),this.Location=r,this.ActivateTip()}Show2(e,t,n,r){this.canShow&&this.Show3(this.Title,e,this.ToolTipIcon,t,n,r)}Show3(e,t,n,r,i,l){this.Title=e,this.toolTipIcon=n,this.IsHandleCreated&&this.Close(),this.ActivateTip()}Show4(e,t){this.Show2(e,t,p.BottomRight,p.BottomLeft)}static NormalizeTooltipText(e){return null==e?null:e.trim()}GetToolTipSize(){if(!this.IsHandleCreated)return o.SizeF.Empty;let e=this.GetToolTipFont(),t=new o.SizeF(7,6);new o.SizeF(0,0);if(!a.default.IsNullOrEmpty(this.Title)){new l.Font(e.Name,e.Size,e.Style)}return t}GetToolTipFont(){return this.Font||u.RelativeUIParam.Font}GetPreferredSize(e,t,n,r){1==e.Width&&(e.Width=0),1==e.Height&&(e.Height=0),0==e.Width&&(e.Width=2147483647),0==e.Height&&(e.Height=2147483647);let i,l=t;if(e.Width-=l.Width,e.Height-=l.Height,e=new o.SizeF(Math.max(e.Width,0),Math.max(e.Height,0)),!a.default.IsNullOrEmpty(n))return i;i=new o.SizeF(0,r.Height)}CreateHandle(){}GetRelativePoint(e,t,n,r){let i=e.Location;new s.PointF(e.Width/2,e.Height/2);switch(n){case p.Center:case p.TopLeft:case p.Top:case p.TopRight:case p.BottomLeft:case p.Bottom:case p.BottomRight:case p.Left:case p.Right:}new s.PointF(t.Width/2,t.Height/2);switch(r){case p.Center:case p.TopLeft:case p.Top:case p.TopRight:case p.BottomLeft:case p.Bottom:case p.BottomRight:case p.Left:case p.Right:}return i}static EnsureInScreen(e,t){return(void 0).X>(void 0).Right&&(e.X=(void 0).Right-t.Width),(void 0).Y>(void 0).Bottom&&(e.Y=(void 0).Bottom-t.Height),e.X<(void 0).Left&&(e.X=(void 0).Left),e.Y<(void 0).Top&&(e.Y=(void 0).Top),e}Dispose(e){}}var p;t.XToolTipRender=c,c.DefaultTimerInterval=100,function(e){e[e.Center=0]="Center",e[e.Top=1]="Top",e[e.Right=2]="Right",e[e.Bottom=3]="Bottom",e[e.Left=4]="Left",e[e.TopLeft=5]="TopLeft",e[e.TopRight=6]="TopRight",e[e.BottomLeft=7]="BottomLeft",e[e.BottomRight=8]="BottomRight"}(p=t.Position||(t.Position={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenSize=void 0,function(e){e[e.Medium=0]="Medium",e[e.Small=1]="Small",e[e.Large=2]="Large"}(t.ScreenSize||(t.ScreenSize={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumUtil=void 0;t.NumUtil=class{static ConverCmToPx(e,t){return e/2.54*t}static ConvertPxToCm(e,t){return 2.54*e/t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCodePainter=void 0;const r=n(0),i=n(47),l=n(53),s=n(11),o=n(17),a=n(9),u=n(30),h=n(7),d=n(56),c=n(73),p=n(152);class f extends i.XBasePainter{PaintElement(e,t,n,i,f){let g=e;if(null!=e&&g instanceof r.XCodeEle){if(g.PageNumStyle){const e=g.CodeInfo.CodeValue,t=g.getValueByFormat(e,g.PageNumStyle);g.SetImageByValue(t),p.ImageCache.PutImage(g.DrawImage.ImageEle.src)}if(null!=g.DrawImage){let r=u.DefineDPI.GetOutDPI(f),p=g.GetBoundsDPI(r),m=new l.SolidBrush(h.Color.White);t.FillRectangle(m,p);let E=p.Width;if(g.IsShowLabelText&&null!=g.LabelText){let r=o.PointF.Empty,i=g.LabelTextShowSizeF,l=g.LabelShowPosition;null!=l&&("Left"==l?(r=new o.PointF(p.X,p.Y),E=p.Width-i.Width,p=new a.RectangleF(p.X+i.Width,p.Y,p.Width-i.Width,p.Height)):"Right"==l?(r=new o.PointF(p.Right-i.Width,p.Y),E=p.Width-i.Width,p=new a.RectangleF(p.X,p.Y,p.Width-i.Width,p.Height)):"Top"==l?(r=new o.PointF(p.X,p.Y),E=p.Height-i.Height,p=new a.RectangleF(p.X,p.Y+i.Height,p.Width,p.Height-i.Height)):"Bottom"==l&&(r=new o.PointF(p.X,p.Bottom-i.Height),E=p.Height-i.Height,p=new a.RectangleF(p.X,p.Y,p.Width,p.Height-i.Height)));let s=e.EleStyle;n.Color=s.ForeColor,t.DrawString(g.LabelText,s.Font,n,r.X,r.Y,d.StringFormat.GenericTypographic)}t.DrawImage(g.DrawImage,new a.RectangleF(p.X,p.Y,p.Width,p.Height)),f==s.ENumOutTp.UI_Show&&c.ResizeAnchorUtil.PaintEleAnchors(g,t,n,i,r)}}}}t.XCodePainter=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceStyle=void 0;const r=n(130),i=n(7),l=n(8),s=n(14);class o extends r.XBasePropList{constructor(){super(),this.permLevel=0,super.XmlEleName="TraceStyle"}get PermLevel(){return this.permLevel}set PermLevel(e){this.permLevel=e}get UnderLineColor(){return this.propList.GetColorValue("UnderLineColorString",i.Color.Blue)}set UnderLineColor(e){this.propList.SetColorValue("UnderLineColorString",e,new i.Color("#0000FF"))}get DeleteLineColor(){return this.propList.GetColorValue("DeleteLineColorString",i.Color.Red)}set DeleteLineColor(e){this.propList.SetColorValue("DeleteLineColorString",e,new i.Color("#FF0000"))}get BackgroundColor(){return this.propList.GetColorValue("BackgroundColor",i.Color.Blue)}set BackgroundColor(e){this.propList.SetColorValue("BackgroundColor",e,new i.Color("#0000FF"))}get UnderLineNum(){let e=this.propList.GetPropValue("UnderLineNum");return l.CNumUtil.TryParseInt(e,1)}set UnderLineNum(e){this.propList.ModifyProperty("UnderLineNum",e,1)}get DeleteLineNum(){let e=this.propList.GetPropValue("DeleteLineNum");return l.CNumUtil.TryParseInt(e,1)}set DeleteLineNum(e){this.propList.ModifyProperty("DeleteLineNum",e,1)}ToXML(e){let t=super.ToXML(e);return null==t&&(t=e.createElement(super.XmlEleName)),t.setAttribute("Level",this.permLevel.toString()),t}FromXML(e){super.FromXML(e),null!=e.getElementsByTagName("UnderLineColorNum")&&this.propList.ReplacePropKey("UnderLineColorNum","UnderLineNum");let t=s.XmlDomUtil.GetSingleAttrValue(e,"Level");this.permLevel=l.CNumUtil.TryParseInt(t,0)}}t.TraceStyle=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PainterUtil=void 0;const r=n(3),i=n(9),l=n(25),s=n(37),o=n(17),a=n(67),u=n(91),h=n(125);class d{constructor(){this._markPositions=new r.List,u.MarkPoint.LeftTop,u.MarkPoint.LeftCenter,u.MarkPoint.LeftBottom,u.MarkPoint.TopCenter,u.MarkPoint.BottomCenter,u.MarkPoint.RightTop,u.MarkPoint.RightCenter,u.MarkPoint.RightBottom}static GetInstance(){return null==d._instance&&(d._instance=new d),d._instance}GetImageMarks(e){return null}DrawMask(e,t){}DrawMarkPoints(e,t){d.GetInstance().GetImageMarks(t),s.TextDocApiConst.ImageMarkPointFillColor}DrawDashedRect(e,t){let n=new a.Pen(s.TextDocApiConst.ImageMarkPointFillColor);n.DashStyle=h.DashStyle.DashDotDot,n.DashPattern=[2,2],e.DrawRectangle(n,t.X,t.Y,t.Width,t.Height)}DrawDashedLine(e,t,n){let r=new a.Pen(s.TextDocApiConst.ImageMarkPointFillColor);r.DashStyle=h.DashStyle.DashDotDot,r.DashPattern=[2,2],e.DrawLine(r,t.X,t.Y,n.X,n.Y)}DrawWaveLine(e,t,n,r,i){let l=r,s=parseInt((i.X-r.X)/2+""),o=parseInt((i.Y-r.Y)/2+""),a=[],u=0;for(let e=0;e<s;e++){u+=2;let t=l.X+u,n=e%2==0?l.Y+o:l.Y;a.push([t,n])}e.DrawCurve(n,t,a)}GetMarkPointDrawRect(e,t){let n=i.RectangleF.Empty,r=s.TextDocApiConst.MarkPointWidth,a=s.TextDocApiConst.MarkPointHeight,h=new l.SizeF(r,a);switch(e){case u.MarkPoint.LeftTop:{let e=new o.PointF(t.Left,t.Top);n=new i.RectangleF(e.X,e.Y,h.Width,h.Height);break}case u.MarkPoint.LeftCenter:{let e=new o.PointF(t.Left,t.Top+t.Height/2);e=new o.PointF(e.X,e.Y-h.Height/2),n=new i.RectangleF(e.X,e.Y,h.Width,h.Height);break}case u.MarkPoint.LeftBottom:{let e=new o.PointF(t.Left,t.Bottom);e=new o.PointF(e.X,e.Y-h.Height),n=new i.RectangleF(e.X,e.Y,h.Width,h.Height);break}case u.MarkPoint.TopCenter:{let e=new o.PointF(t.Left+t.Width/2,t.Top);e=new o.PointF(e.X-h.Width/2,e.Y),n=new i.RectangleF(e.X,e.Y,h.Width,h.Height);break}case u.MarkPoint.BottomCenter:{let e=new o.PointF(t.Left+t.Width/2,t.Bottom);e=new o.PointF(e.X-h.Width/2,e.Y-h.Height),n=new i.RectangleF(e.X,e.Y,h.Width,h.Height);break}case u.MarkPoint.RightTop:{let e=new o.PointF(t.Right,t.Top);e=new o.PointF(e.X-h.Width,e.Y),n=new i.RectangleF(e.X,e.Y,h.Width,h.Height);break}case u.MarkPoint.RightCenter:{let e=new o.PointF(t.Right,t.Top+t.Height/2);e=new o.PointF(e.X-h.Width,e.Y-h.Height/2),n=new i.RectangleF(e.X,e.Y,h.Width,h.Height);break}case u.MarkPoint.RightBottom:{let e=new o.PointF(t.Right,t.Bottom);e=new o.PointF(e.X-h.Width,e.Y-h.Height),n=new i.RectangleF(e.X,e.Y,h.Width,h.Height);break}}return n}}t.PainterUtil=d,d._instance=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XInputBorderPainter=void 0;const r=n(0),i=n(173),l=n(53),s=n(67),o=n(11),a=n(2),u=n(26),h=n(118),d=n(30),c=n(7),p=n(9);class f extends i.XLabelPainter{PaintElement(e,t,n,i,l){let s=e instanceof r.XInputBorderEle?e:null;if(null!=s){let r=s.EleStyle.ForeColor,h=null;if(this._GetEmrWorkMode(s)==a.ENumWorkMode.Design&&(h=r.getOpacity()),this._GetEmrWorkMode(s)==a.ENumWorkMode.Browse)s.EleStyle.ForeColor=u.TextDocInitInfo.GetInstance().BrowerForeColor;else{let e=u.TextDocInitInfo.GetInstance().InputFieldNormalBorderColor;if(this._GetEmrWorkMode(s)==a.ENumWorkMode.Design){let t=e.ToRgbaString();if(h>0&&t){const n=/(^\s+)|(\s+$)|\s+/g;t=t.replace(n,()=>""),t=t.replace(/[,][.0-9]+[/)]/,()=>","+h+")"),e=new c.Color(t)}}s.EleStyle.ForeColor=e}l!=o.ENumOutTp.CsPrint&&(s.IsDrawText&&super.PaintElement(e,t,n,i,l),this.DrawInputMarker(t,e,l),s.EleStyle.ForeColor=r)}}DrawInputMarker(e,t,n){let i=u.TextDocInitInfo.GetInstance();if(i.InputFiled_IsShowTag&&null!=t&&!t.IsStartBorder&&!t.IsHidden(!0)){let f=r.XDomUtil.GetParentXInput(t,!1);if(null!=f&&!this.IsComplexXInput(f)&&n!=o.ENumOutTp.CsPrint&&this._GetEmrWorkMode(t)!=a.ENumWorkMode.Design){let r=t.Parent;if(null!=r){let o=e.Save();e.SmoothingMode=h.SmoothingMode.HighQuality;let f,g,m=d.DefineDPI.GetOutDPI(n),E=t.GetBoundsDPI(m);t.IsDrawText?(f=4,g=1):(f=2,g=1);let C,A=new p.RectangleF(E.Right-f,E.Bottom-g,5,5),y=new l.SolidBrush(c.Color.Transparent);if(e.FillRectangle(y,A),C=r.IsError?i.InputFiledNoPassTagColor:r.IsModified?i.InputFiledModifiedTagColor:i.InputFiledNormalTagColor,C!=c.Color.Empty){let t=new l.SolidBrush(C),n=new s.Pen(C);switch(u.TextDocInitInfo.GetInstance().InputMarkType){case a.XInputMarkType.SolidRect:e.FillRectangle(t,A);break;case a.XInputMarkType.EmptyRect:e.DrawRectangle(n,A.X,A.Y,A.Width,A.Height);break;case a.XInputMarkType.SolidCircle:e.FillEllipse(t,A);break;case a.XInputMarkType.EmptyCircle:e.DrawEllipse(n,A)}e.Restore(o)}}}}}IsComplexXInput(e){let t;if(null==e)t=!1;else{let n=!1,i=e.GetChildArr();for(let e=0;e<i.length;e++){if(i[e]instanceof r.XBaseInputEle){n=!0;break}}t=n}return t}}t.XInputBorderPainter=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocIOInfo=void 0;const r=n(26),i=n(35),l=n(2),s=n(33),o=n(62),a=n(39),u=n(4),h=n(111),d=n(14),c=n(70),p=n(89);t.XDocIOInfo=class{constructor(){this.xdoc=null,this.xdocLoadParam=null,this.xdocKey=null,this.xdocLoadParam=new c.XDocLoadParam}get XDocument(){return this.xdoc}get XDocKey(){return this.xdocKey}IsCurrXDocToNewPage(e){if(null==e||null==e.XDocument)return!0;let t=null==e?null:e.xdocLoadParam;if(this.xdocLoadParam.IsCurrDocToNewPage(t))return!0;let n=e.XDocument,r=this.XDocument,l=n.GetPageCols(),s=r.GetPageCols(),o=l.ColsCnt==s.ColsCnt;if(o&&(o=0==i.CommDefines.CmprNumVal(l.ColGap,s.ColGap,.001)),!o)return!0;let a=n.GetPageFmt(),u=r.GetPageFmt();return 0!=i.CommDefines.CmprNumVal(a.GetValidWidthDPI(-1),u.GetValidWidthDPI(-1),.001)}BuildAsString(){let e,t=null==this.xdoc?null:this.xdoc.DocName;return e=u.default.IsNullOrEmpty(t)?this.xdocKey:t,e}CrtNewXDoc(){this._Check_XDocToClose("新建空白文档")&&(this.xdocLoadParam.Clear(),this.xdocKey=null,null==this.xdoc&&(this.xdoc=new o.XTextDocument(!1),this.xdoc.AssistFunc.CalcEngine=new s.EmrCalcEngine(this.xdoc),this.xdoc.Clear()),this.xdoc.RefreshLines(!1),this.xdoc.ResetChangedFlag())}LoadXDoc(e,t){let n=null;if(null==t||!t.IsValid())return n=new h.ResMessage(1,"病历文档加载参数无效！"),n;if(!this._Check_XDocToClose("打开文档"))return null;switch(this.xdocLoadParam.CopyFrom(t),this.xdocKey=this.xdocLoadParam.Build_DocKey(),null==this.xdoc&&(this.xdoc=new o.XTextDocument(e),this.xdoc.AssistFunc.CalcEngine=new s.EmrCalcEngine(this.xdoc)),this.xdoc.GetDocParams().patientInfo=this.xdocLoadParam.PatientInfo,this.xdoc.GetDocParams().ShowIcon=this.xdocLoadParam.ShowIcon,null!=t.WorkMode&&(this.xdoc.GetDocCtxt().EmrWorkMode=t.WorkMode),this.xdocLoadParam.SrcType){case l.ENumXDocPath.LocalFile:this._LoadXDoc_LocalFile(t.SrcStr);break;case l.ENumXDocPath.RemoteFile:}if(p.MsgRegisterHandler.RegisterExpressionToMsgBus(this.xdoc),u.default.IsNullOrEmpty(this.xdocLoadParam.DocName)?this.xdocLoadParam.DocName=this.xdoc.DocName:this.xdoc.DocName=this.xdocLoadParam.DocName,null!=t.LineToPrint)try{this.xdoc.RefreshLines(t.LineToPrint)}catch(e){}return this.xdoc.ResetChangedFlag(),n}_LoadXDoc_LocalFile(e){let t=d.XmlDomUtil.parseXMLFromString(e);this.xdoc.FromXML(t)}SaveXDoc(){let e=new h.ResMessage;if(null==this.xdoc)return e.MsgLevel=2,e.MsgStr="保存病历文档时，文档对象不能为null",e;let t='<?xml version="1.0" encoding="utf-8"?>'+this._SaveXDoc_StrXML();return e.IsWarnMsg()||(this.xdoc.GetDocCtxt().LastSaveTime=a.DateTime.Now),e.ReturnParams=t,e}_SaveXDoc_StrXML(){let e=this.xdoc.ToXML(),t=d.XmlDomUtil.Xml2String(e);return this.xdocLoadParam.SrcStr=t,t}CloseXDoc(){return this._Check_XDocToClose("关闭文档")}IsChanged(){return null!=this.xdoc&&r.TextDocInitInfo.GetInstance().NeedCheckChanged&&this.xdoc.IsChanged}_Check_XDocToClose(e){return null==this.xdoc||(this.IsChanged(),this.xdoc.Clear()),!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XParagraphFlag=void 0;const r=n(105),i=n(331),l=n(117),s=n(0),o=n(2),a=n(8);class u extends s.XBaseElement{constructor(){super(),this.serno=-1,this.relOutline=null,super.FormatBrushEnable=!0}get EleTypeName(){return"XParagraphFlag"}get EleCursorAllowSide(){return o.ENumEleCursorSide.Left}get IsElement(){let e=this.propList.GetPropValue("IsElement");return a.CNumUtil.TryParseBool(e,!1)}set IsElement(e){this.propList.ModifyProperty("IsElement",e,!1)}get Serno(){return this.serno}set Serno(e){this.serno=e}CanBeInline(e=!1){if(!e)return!0;let t=s.XDomUtil.GetParentXInput(this);return(null==t||!1!==t.IsPrint)&&!s.XDomUtil.IsBkgTextOfXInput(this)}get OutLineLevel(){return null}set OutLineLevel(e){}get ListStyle(){return null}set ListStyle(e){}get IsOutlineParagraph(){return this.OutLineLevel>=0}get ParaghStyle(){return super.EleStyle instanceof r.XParagraphFlagStyle?super.EleStyle:null}FindPrevParagh(e){null!=e&&e<0&&(e=-1);let t=null,n=super.Parent.ChildEleList.GetItems();if(!(null!=n&&n.length>0&&n[n.length-1])){for(let r=0;r<n.length;r++){let i=n[r];if(i instanceof u){if(i==this)break;let n=i.OutLineLevel;(null==e||5e3==e&&n>=0||n==e)&&(t=i)}}return t}for(let r=n.length-2;r>-1;r--){let i=n[r];if(i instanceof u){if(i==this)break;let n=i.OutLineLevel;if(null==e||5e3==e&&n>=0||n==e)return t}}}get RelOutline(){return this.relOutline}set RelOutline(e){this.relOutline=e}AutoAddDelSernoLabel(e,t){let n=0;const r=super.Parent,s=this.FindPrevParagh(null);null!=s&&(n=1+r.GetChildInx(s));let a=o.ENumEdtType.Other,u=null;r.GetChildEle(n)instanceof i.XLabelSerno&&(u=r.GetChildEle(n));return l.ParagraphListStyleVals.IsNoneListStyle(this.ListStyle)?null!=u&&(r.RemoveChild(n),a=o.ENumEdtType.Delete):(null==u&&(u=new i.XLabelSerno,r.AddChildEle(n,u),a=o.ENumEdtType.Add),u.RelParaghEle=this),n,u,[a,u,n]}Clear(){this.serno=-1,this.ClearRelOutline(),super.Clear()}ClearRelOutline(){null!=this.relOutline&&(this.relOutline.RelParaghEle=null,this.relOutline=null)}ReCalcBaseSize(){if(!this.IsLayoutValid){let e=super.EleStyle.Font;if(null!=e){let t=96*e.SizeInPoints/72;this.SetSizeDPI(6,t,96),this.IsLayoutValid=!0}}}NotifyLayoutChanged(e=!0,t=!1){this._UpdateSernoLabel(),super.NotifyLayoutChanged(e,!1)}_UpdateSernoLabel(){let e=0,t=super.Parent,n=this.FindPrevParagh(null);null!=n&&(e=1+t.GetChildInx(n));let r=t.GetChildEle(e);null!=r&&r instanceof i.XLabelSerno&&(r.RelParaghEle=this,r.RebuildText())}GetInnerText(e){let t;return t=e?"\r\n":super.EleStyle.DeleterIndex>=0?"":"\r\n",t}GetParaLinesList(e){if(null!=e){e.Clear();let t=super.OwnerLine;null!=t&&t.LineAssist.GetParaLinesList(e)}}FromXML(e){super.FromXML(e)}}t.XParagraphFlag=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XButtonEle=void 0;const r=n(10),i=n(82),l=n(222),s=n(7),o=n(308),a=n(0),u=n(2),h=n(35),d=n(83);class c extends a.XBaseElement{constructor(){super(...arguments),this.BtnTextPadding=new i.Padding(4,4,4,4)}get EleTypeName(){return"XButtonEle"}get Text(){return this.propList.GetPropValue("Text")}set Text(e){this.propList.ModifyProperty("Text",e,"")}get Icon(){if(null==this.iconImage){let e=this.propList.GetPropValue("Icon");this.iconImage=d.XImageUtil.Base64ToImage(e)}return this.iconImage}set Icon(e){this.iconImage=d.XImageUtil.Base64ToImage(e),this.propList.ModifyProperty("Icon",e,"")}get IconWidth(){return this.propList.GetPropValue("IconWidth")}set IconWidth(e){this.propList.ModifyProperty("IconWidth",e,24)}get EventType(){return this.propList.GetPropValue("EventType")}set EventType(e){this.propList.ModifyProperty("EventType",e,"")}get IconHeight(){return this.propList.GetPropValue("IconHeight")}set IconHeight(e){this.propList.ModifyProperty("IconHeight",e,24)}get FirstExcScriptName(){return this.propList.GetPropValue("Script_FirstGrpName")}set FirstExcScriptName(e){this.propList.ModifyProperty("Script_FirstGrpName",e,"")}get SecondExcScriptName(){return this.propList.GetPropValue("Script_SecondGrpName")}set SecondExcScriptName(e){this.propList.ModifyProperty("Script_SecondGrpName",e,"")}get BorderStyle(){return this.propList.GetPropValue("BorderStyle")}set BorderStyle(e){this.propList.ModifyProperty("BorderStyle",e,"")}get CodeText(){return this.propList.GetPropValue("CodeText")}set CodeText(e){this.propList.ModifyProperty("CodeText",e,"")}get CodeXml(){return this.propList.GetPropValue("CodeXml")}set CodeXml(e){this.propList.ModifyProperty("CodeXml",e,"")}get ClassName(){return this.propList.GetPropValue("ClassName")}set ClassName(e){this.propList.ModifyProperty("ClassName",e,"")}get Language(){return this.propList.GetPropValue("Language")}set Language(e){this.propList.ModifyProperty("Language",e,"")}get MainMethod(){return this.propList.GetPropValue("MainMethod")}set MainMethod(e){this.propList.ModifyProperty("MainMethod",e,"")}get ImportUsingStr(){return this.propList.GetPropValue("ImportUsingStr")}set ImportUsingStr(e){this.propList.ModifyProperty("ImportUsingStr",e,"")}get EleCursorAllowSide(){return u.ENumEleCursorSide.Left}set EleCursorAllowSide(e){super.EleCursorAllowSide=e}FromXML(e){super.FromXML(e),this.InitEleSize()}InitEleSize(){if(null==this.Icon){this.IsLayoutValid=!1;let e=super.EleStyle.Font;if(null!=e){let t=h.CommDefines.MeasureText(this.Text,e,96).Width+this.BtnTextPadding.Left+this.BtnTextPadding.Right,n=r.DPITransUtil.TransFloatVal(e.SizeInPoints,72,96)+this.BtnTextPadding.Top+this.BtnTextPadding.Bottom;this.SetSizeDPI(t,n,96)}}else this.SetSizeDPI(this.IconWidth,this.IconHeight,96)}get BorderColor(){return this.propList.GetColorValue("BorderColor",s.Color.Black)}set BorderColor(e){this.propList.SetColorValue("BorderColor",e,new s.Color("#000000"))}get BtnBackColor(){return this.propList.GetColorValue("BtnBackColor",s.Color.White)}set BtnBackColor(e){this.propList.SetColorValue("BtnBackColor",e,new s.Color("#FFFFFF"))}InitByBtnInfo(e){this.Text=e.Text,super.GrpID=e.GrpId,this.FirstExcScriptName=e.FirstExcScriptName,this.SecondExcScriptName=e.SecondExcScriptName,this.BorderStyle=e.BorderStyle,this.BorderColor=e.BorderColor,this.BtnBackColor=e.BackColor,this.Deletable=e.Deletable,null!=e.Icon&&null!=e.Icon?(this.Icon=d.XImageUtil.Base64ToImage(e.Icon),this.IconWidth=e.IconWidth,this.IconHeight=e.IconHeight):this.Icon=null,null!=e.CodeEditInfo&&(this.CodeText=e.CodeEditInfo.CodeText,this.CodeXml=e.CodeEditInfo.CodeXml,this.ClassName=e.CodeEditInfo.ClassName,this.Language=e.CodeEditInfo.Language,this.MainMethod=e.CodeEditInfo.MainMethod,this.ImportUsingStr=e.CodeEditInfo.ImportUsingStr)}CanBeInline(e=!1){return"diagnosisEvent"!=this.EventType&&"importReportEvent"!=this.EventType&&"medicalHumanEvent"!=this.EventType&&"outpatientReportEvent"!=this.EventType||!!this.Document.GetDocParams().ShowIcon}get BtnInfo(){return this.BulidBtnInfo()}BulidBtnInfo(){let e=new l.InsertBtnInfo;return e.GrpId=this.GrpID,e.Type=this.EleTypeName,e.Text=this.Text,e.EventType=this.EventType,e.BorderStyle=this.BorderStyle,e.BorderColor=this.BorderColor,e.BackColor=this.BtnBackColor,e.IconWidth=this.IconWidth,e.IconHeight=this.IconHeight,e.ToolTip=this.ToolTip,e.Deletable=this.Deletable,e}}t.XButtonEle=c,c.Fnt_Mtc=new o.FontMetricUtil},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCommentEle=void 0;const r=n(0),i=n(3);class l extends r.XBaseMarkContainer{get EleTypeName(){return"XComment"}get DomHeight(){return this._domHeight}set DomHeight(e){this._domHeight=e}get PreCmmtBottom(){return this._PreCmmtBottom}set PreCmmtBottom(e){this._PreCmmtBottom=e}get RangList(){return this._RangList}set RangList(e){null==this._RangList&&(this._RangList=new i.List),this._RangList.Clear(),this._RangList.AddRange(e)}CanBeInline(e=!1){return!0}GetValidWidth(e){return null==super.Parent?0:super.Parent.GetValidWidth(e)}CalcPosByRelLineEleFrom(e){if(null!=e){let t=0,n=this.markUtil.AutoCalcCommentPosY(e);this.SetPositionDPI(t,n,300)}}}t.XCommentEle=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XUserHistory=void 0;const r=n(141),i=n(3),l=n(39),s=n(14),o=n(8),a=n(26),u=n(175),h=n(21),d=n(2),c=n(4);t.XUserHistory=class{constructor(e){this.serno=-1,this.userInfo=null,this.opType=d.ENumEdtType.Other,this.isPersisted=!1,this.relEleList=null,this.addTime=new l.DateTime,this.ReplaceArr=[],this.userInfo=new r.XUserInfo,this.addTime=e,this.relEleList=new i.List}get AddTime(){return this.addTime}set AddTime(e){this.addTime=e}get Serno(){return this.serno}set Serno(e){this.serno=e}get UserInfo(){return this.userInfo}get OpType(){return this.opType}set OpType(e){this.opType=u.XHistoryUtil.MergeOpType(e)}get IsPersisted(){return this.isPersisted}GetRelEleCnt(){return this.relEleList.Count()}GetFirstRelEle(){return this.relEleList.Count()<=0?null:this.relEleList.Get(0)}GetArrRelEles(){return this.relEleList.ToArray()}get GetRelEleIter(){return this.relEleList.GetEnumerator()}GetRelElePos(e){if(null==e)return-1;return this.relEleList.IndexOf(e)}AddRelEle(e,t){if(e<0||null==t)return-1;let n=this.relEleList.Count();return n<=0||e>=n?(this.relEleList.Add(t),n):(this.relEleList.Insert(e,t),e)}RemoveRelEle(e){let t=this.relEleList.FindIndex(0,this.relEleList.Length,t=>e.XID==t.XID);return t<0?-1:(this.relEleList.RemoveAt(t),t)}RemoveRelEleWithIndex(e){e>=0&&e<this.relEleList.Count()&&this.relEleList.RemoveAt(e)}CanMergeRelEles(e){return null!=e&&this!=e&&this.opType==e.opType&&c.default.Equals(this.userInfo.UsrId,e.userInfo.UsrId)}MergeRelEles(e){if(!this.CanMergeRelEles(e))return!1;let t=this.opType==d.ENumEdtType.Add,n=this.Serno;for(let r of e.relEleList)t?r.EleStyle.CreatorIndex=n:r.EleStyle.DeleterIndex=n;return this.relEleList.AddRange(e.relEleList),!0}UnMergeRelEles(e,t){if(!this.CanMergeRelEles(e))return!1;let n=this.GetRelEleCnt(),r=e.GetRelEleCnt();if(t<0||t+r!=n)return!1;let i=this.opType==d.ENumEdtType.Add,l=e.Serno;for(let t of e.relEleList)i?t.EleStyle.CreatorIndex=l:t.EleStyle.DeleterIndex=l;return 0==t?this.relEleList.Clear():this.relEleList.RemoveRange(t,this.GetRelEleCnt()-t),!0}CopyFrom(e,t,n){if(null!=e){t<0&&(t=0),this.opType=e.opType,this.UserInfo.CopyFrom(e.UserInfo),null!=e.AddTime&&(this.AddTime=e.AddTime),this.isPersisted=e.isPersisted;let r=e.GetRelEleCnt()-t;if(r>0){let i=this.opType==d.ENumEdtType.Add,l=this.Serno,s=e.relEleList.GetRange(t,r);n&&e.relEleList.RemoveRange(t,r);for(let e of s)i?e.EleStyle.CreatorIndex=l:e.EleStyle.DeleterIndex=l;this.relEleList.AddRange(s),s.Clear()}}}_DatetimeToString(e){let t;if(null!=e)t="";else{t=e.ToString("O")}return t}FromXML(e){let t=s.XmlDomUtil.GetSingleAttrValue(e,"sn");this.Serno=o.CNumUtil.TryParseInt(t,-1);let n=s.XmlDomUtil.GetSingleNode(e,"ID");if(this.UserInfo.UsrId=null==n?null:n.textContent,n=s.XmlDomUtil.GetSingleNode(e,"Name"),this.UserInfo.UsrName=null==n?null:n.textContent,n=s.XmlDomUtil.GetSingleNode(e,"PermissionLevel"),this.UserInfo.PermissionLv=o.CNumUtil.TryParseInt(null==n?null:n.textContent,1),null==n&&(n=s.XmlDomUtil.GetSingleNode(e,"SavedTime")),n=s.XmlDomUtil.GetSingleNode(e,"AddTime"),null!=n&&n.textContent){n=s.XmlDomUtil.GetSingleNode(e,"AddTime");let t=new l.DateTime;l.DateTime.resetValue(n.textContent,"yyyy年MM月dd日HH时mm分ss秒",t),this.addTime=t}this.isPersisted=!0}NeedSerialized(){return a.TextDocInitInfo.GetInstance().IsSaveTrace}ToXML(e){let t;if(this.NeedSerialized()){let n=e.createElement("History");this.Serno>=0&&n.setAttribute("sn",this.Serno.toString());let r=e.createElement("ID");r.textContent=this.UserInfo.UsrId,n.appendChild(r);let i=e.createElement("Name");i.textContent=this.UserInfo.UsrName,n.appendChild(i);let s=e.createElement("PermissionLevel");s.textContent=this.UserInfo.PermissionLv.toString(),n.appendChild(s);let o=e.createElement("AddTime");o.textContent=l.DateTime.TimeString(this.addTime.Value),n.appendChild(o),this.isPersisted=!0,t=n}else t=null;return t}IsValid(){return null!=this.userInfo&&this.userInfo.IsValid()}BuildRelEleString(e=50){if(0==this.relEleList.Count())return"";e<=0&&(e=50);let t=new h.default;this.relEleList.ToArray().forEach(e=>{t.append(e.GetInnerText(!0)),t.length()});let n=t.toString();return n&&n.length>e&&(n=n.substr(0,e)),n}CmprPermLvTo(e){return null==e?1:0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryRelEleUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t,n,r){super(),this.userHist=null,this.relEle=null,this.aimPos=-1,this.isAdd=!0,this.userHist=e,this.relEle=t,this.aimPos=n,this.isAdd=r}IsValid(){return null!=this.userHist&&null!=this.relEle&&this.aimPos>=0}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){this.CanUndo()&&(this.isAdd?this.userHist.RemoveRelEleWithIndex(this.aimPos):this.userHist.AddRelEle(this.aimPos,this.relEle),this.NotifyLayoutChanged())}Redo(){this.CanRedo()&&(this.isAdd?this.userHist.AddRelEle(this.aimPos,this.relEle):this.userHist.RemoveRelEleWithIndex(this.aimPos),this.NotifyLayoutChanged())}Clear(){this.userHist=null,this.relEle=null,this.aimPos=-1}NotifyLayoutChanged(){null!=this.relEle&&this.relEle.Document.GetDocCtxt().ViewMode.IsCleanViewMode&&this.relEle.NotifyLayoutChanged(!0,!1)}}t.HistoryRelEleUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommDefinesExt=void 0;const r=n(4),i=n(730);class l{static ShowMsg(e){null==e||r.default.IsNullOrEmpty(e.MsgStr)||(e.IsWarnMsg()?l.ShowWarnDlg(e.MsgStr,null):e.IsInfoMsg()&&l.ShowMsgSBar(e.MsgStr))}static ShowMsgSBar(e){i.XapCommUtil.SetStatusMsg(e,null)}static ShowMsgDlg(e,t=null){i.XapCommUtil.ShowInfo(null,e,t)}static ShowWarnDlg(e,t=null){i.XapCommUtil.ShowAlert(null,e,t)}static ShowYesNoDlg(e,t){return i.XapCommUtil.IsContinue(null,e,t)}static ShowYesNoCancelDlg(e,t){return i.XapCommUtil.IsContinueWithCancel(null,e,t)}}t.CommDefinesExt=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionWorkMode=void 0,function(e){e[e.None=0]="None",e[e.Design=1]="Design",e[e.KeepTrace=2]="KeepTrace",e[e.Application=4]="Application",e[e.Browse=8]="Browse",e[e.Default=7]="Default",e[e.All=15]="All"}(t.ActionWorkMode||(t.ActionWorkMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SeparatorLineComp=void 0,n(740);const r=n(12),i=n(22);class l extends r.PureComponent{render(){return r.createElement("span",{className:"editor-separator"})}}t.default=l;class s extends i.BaseComponent{constructor(e,t){super(e,t)}Render(){}}t.SeparatorLineComp=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableButtonComp=t.TableButton=void 0;const r=n(12);n(742);const i=n(22),l=n(237);class s extends r.Component{constructor(e){super(e),this.mouseMoveHandler=e=>{let t=e.pageX,n=e.pageY,r=e.currentTarget.parentNode;t=t-r.offsetLeft-20,n=n-r.offsetTop-22-10-10;let i=0,l=0,s=[];for(let e=0;e<10;e++){let r=[];for(let s=0;s<10;s++){let o=!1;16*s+6*s<=t&&16*e+6*e<=n&&(o=!0,i=s+1,l=e+1),r.push({active:o})}s.push(r)}this.setState({rowCount:l,colCount:i,cells:s})},this.clickHandler=()=>{let{rowCount:e,colCount:t}=this.state;this.props.onSelect({colCount:t,rowCount:e})};let t=this.initCells();this.state={rowCount:0,colCount:0,cells:t}}initCells(){let e=[];for(let t=0;t<10;t++){let t=[];for(let e=0;e<10;e++)t.push({active:!1});e.push(t)}return e}componentDidUpdate(e,t,n){e.active==this.props.active||this.props.active||this.setState({rowCount:0,colCount:0,cells:this.initCells()})}renderTitle(){let{rowCount:e,colCount:t}=this.state;return r.createElement("div",{className:"tablePick-title"},0==e&&0==t?"插入":e+"×"+t+" ","表格")}renderTable(){let{cells:e}=this.state;return r.createElement("div",{className:"tablePick-table",onMouseMove:this.mouseMoveHandler,onClick:this.clickHandler},e.map((e,t)=>r.createElement("div",{key:"row_"+t,className:"row"},e.map((e,n)=>r.createElement("div",{className:e.active?"col active":"col",key:t+""+n})))))}render(){return r.createElement(r.Fragment,null,this.renderTitle(),this.renderTable())}}s.defaultProps={active:!1};class o extends r.Component{constructor(e){super(e),this.selectHandler=e=>{this.props.onSelect&&this.props.onSelect(e.colCount,e.rowCount)}}componentDidMount(){this.props.item.React=this}render(){let{title:e,buttonIcon:t}=this.props;return r.createElement(l.DropButton,{title:e,buttonIcon:t,onSelect:this.selectHandler},r.createElement(s,null))}}t.TableButton=o;class a extends i.BaseComponent{constructor(e,t){super(e,t)}Render(){}}t.TableButtonComp=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialCharsButtonComp=t.SpecialCharsButton=void 0;const r=n(12),i=n(237),l=n(22);n(749);class s extends r.Component{constructor(e){super(e),this.clickHandler=e=>{this.props.onSelect(e.target.innerText)}}render(){return r.createElement("div",{className:"sc-picker"},["α","β","γ","δ","Ω","λ","κ","℃","℉","＋","－","×","÷","±","≤","≥","√","‰","‱","①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ","Ⅺ"].map((e,t)=>r.createElement("span",{key:t,onClick:this.clickHandler},e)))}}class o extends r.Component{constructor(e){super(e),this.selectHandler=e=>{this.props.onSelect&&this.props.onSelect(e)}}componentDidMount(){this.props.item.React=this}render(){let{title:e,buttonIcon:t}=this.props;return r.createElement(i.DropButton,{title:e,buttonIcon:t,onSelect:this.selectHandler},r.createElement(s,null))}}t.SpecialCharsButton=o;class a extends l.BaseComponent{constructor(e,t){super(e,t)}Render(){}}t.SpecialCharsButtonComp=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconButton=void 0;const r=n(235),i=n(27),l=n(0),s=n(25);class o extends i.BaseControl{constructor(e,t,n){super(e,t),this.id=t.id,t.stopEvent||(this.InitProps.onItemClick=e=>{if("InsertImage"==this.id){let e=this,t=document.getElementById("pango-editor-uploadPic");t&&(t.click(),t.onchange=()=>{if(t instanceof HTMLInputElement){let r=t.files[0],i=new FileReader;i.readAsDataURL(r),i.onload=function(r){let i=String(r.target.result),o=new l.XImageEle;o.setImgObj(i);let a=new Image;a.src=i,a.onload=function(){new s.SizeF(a.width,a.height);let r=[o,i];n.L_ExecuteCommand(e.id,r),t.value=null}}}})}else n.L_ExecuteCommand(this.id,[e])}),this.Component=new r.IconButtonComp(e,this.InitProps)}set Disabled(e){this.disabled=e,this.Component.React.setDisabled(this.disabled)}DefaultProps(){return{disabled:!1,onClick:function(){}}}}t.IconButton=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dropdown=void 0;const r=n(236),i=n(27);class l extends i.BaseControl{constructor(e,t,n){super(e,t),this.id=t.id,t.stopEvent||(this.InitProps.onSelectedItem=e=>{if("setLineHeight"==this.id){let t={};"单倍行距"==e?t={_rowPadding:"SpaceSingle",_setValue:"1"}:"1.5倍行距"==e?t={_rowPadding:"Space1pt5",_setValue:"2"}:"2倍行距"==e?t={_rowPadding:"SpaceDouble",_setValue:"3"}:"最小值"==e&&(t={_rowPadding:"SpaceExactly",_setValue:"4"}),n.L_ExecuteCommand("SetParagraphStyle",[t])}else"SetFontSize"==this.id?n.L_ExecuteCommand(this.id,[e.value,e.value]):n.L_ExecuteCommand(this.id,[e,e])}),this.Component=new r.DropdownComp(e,this.InitProps)}DefaultProps(){return{onClick:function(){}}}}t.Dropdown=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorButton=void 0;const r=n(27),i=n(238),l=n(7);class s extends r.BaseControl{constructor(e,t,n){super(e,t),this.id=t.id,t.stopEvent||(this.InitProps.onSelect=e=>{let t=new l.Color(e);n.L_ExecuteCommand(this.id,[t])}),this.Component=new i.ColorButtonComp(e,this.InitProps)}DefaultProps(){return{}}}t.ColorButton=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PatientInfo=void 0;class r{constructor(){this._copyModel="0"}get Name(){return this._name}set Name(e){this._name=e}get Age(){return this._age}set Age(e){this._age=e}get Gender(){return this._gender}set Gender(e){this._gender=e}get Id(){return this._id}set Id(e){this._id=e}get CopyModel(){return this._copyModel}set CopyModel(e){null==e&&(e="0"),"1"!=e&&"2"!=e&&"3"!=e&&(e="0"),this._copyModel=e}static ParseObject(e){if(null!=e){let t=new r;return t.Name=e.name,t.Age=e.age||0===e.age?Number(e.age):null,t.Gender=e.gender,t.Id=e.id,t.CopyModel=e.copyModel,t}return null}}t.PatientInfo=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutlineLvUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t,n){super(),this.outlineList=null,this.paraghFlag=null,this.oldLv=-1,this.newLv=-1,this.paraghFlag=e,this.outlineList=n,this.oldLv=t,null!=e&&(this.newLv=e.OutLineLevel)}IsValid(){return null!=this.paraghFlag&&null!=this.outlineList}CanUndo(){return this.IsValid()&&this.oldLv!=this.newLv}CanRedo(){return this.IsValid()&&this.oldLv!=this.newLv}Undo(){this.CanUndo()&&(this.paraghFlag.OutLineLevel=this.oldLv,this.outlineList.ChangeOutlineLv(this.paraghFlag,this.newLv))}Redo(){this.CanRedo()&&(this.paraghFlag.OutLineLevel=this.newLv,this.outlineList.ChangeOutlineLv(this.paraghFlag,this.oldLv))}Clear(){this.paraghFlag=null,this.outlineList=null,this.oldLv=this.newLv=-1}}t.OutlineLvUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditEleSubRange=void 0;const r=n(150),i=n(141);t.EditEleSubRange=class{constructor(e){this.fromIx=-1,this.len=0,this.addHistUsrInfo=new i.XUserInfo,this.isAddHistPersisted=!0,this.FromIx=e,this.Len=1}get FromIx(){return this.fromIx}set FromIx(e){this.fromIx=e}get Len(){return this.len}set Len(e){this.len=e<=0?0:e}get ToIx(){return this.FromIx+this.Len}set ToIx(e){this.Len=e-this.FromIx}get AddHistUsrInfo(){return this.addHistUsrInfo}get IsAddHistPersisted(){return this.isAddHistPersisted}set IsAddHistPersisted(e){this.isAddHistPersisted=e}IsValid(){return this.fromIx>=0&&this.len>0}AddToIx(){this.len++}GetSubEles(e){let t;if(this.IsValid()){let n=null==e?0:e.length;if(n<=0||this.fromIx>=n)t=null;else{this.fromIx+this.len>n&&(this.len=n-this.fromIx),t=new r.XBaseElement[this.len]}}else t=null;return t}ToString(){return"SubRange: ["+this.FromIx+", "+this.ToIx+"), User="+this.addHistUsrInfo.UsrName+", PermLv="+this.addHistUsrInfo.PermissionLv+", IsAddHistPersisted="+this.isAddHistPersisted}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TapType=void 0,function(e){e[e.FindTap=0]="FindTap",e[e.ReplaceTap=1]="ReplaceTap"}(t.TapType||(t.TapType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SelectRange=void 0;const r=n(2),i=n(0),l=n(1),s=n(92);class o extends l.XBaseAction{ActName(){return"SelectRange"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),l=n.M_EleEvtModel;if(null==e||e.length<1)this.resMsg.MsgLevel=2,super.GetEdtCtrl().HideMsgBox||s.MessageBoxComp.Show({title:"提示",content:this.ActName+" 调用参数有误",type:"warning",dom:super.GetEdtCtrl().ContainerDOM}),this.resMsg.MsgStr=this.ActName+" 调用参数有误",t=this.resMsg;else{const s=e[0]instanceof i.XBaseElement?e[0]:null,o=e[1]instanceof i.XBaseElement?e[1]:null,a=l.SelRange;let u=a.FromLineEle,h=a.ToLineEle;const d=s instanceof i.XBaseContainer?s:null;let c;if(c=null!=d&&null==o?this._SelectWholeContainer(d,a):this._SelectEleRange(s,o,a),c){let e=n.M_EleEvtHandler,i=a.FromLineEle,l=a.ToLineEle;null==u&&null==i||null==l&&null==h||(null==u&&null!=i||!u.Equals(i)||null==h&&null!=l||null!=h&&!h.Equals(l))&&e.OnSelRangeChanged(a),a.IsValid()&&n.M_EdtCaret.HideXCaret();let s=a.InfoUtil.CalcLineRectRanges(!0);n.RefreshPageSelRange(r.ENumBkgRectsType.SelRects,s),t=this.resMsg}else t=this.resMsg}return t}_SelectWholeContainer(e,t){return t.Clear(),e instanceof i.XStringEle?t.SelectNearXStringEle(e):t.SelectContainerLines(e),!0}_SelectEleRange(e,t,n){let r;return null==e&&null==t?r=!1:(null!=e&&n.SetFromIx(e),null!=t&&n.SetToIx(t,!0),r=!0),r}}t.A_SelectRange=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InsertPageNumbersInfo=void 0;class r{get No(){return this._No}set No(e){this._No=e}get Type(){return this._Type}set Type(e){this._Type=e}get NumberDisplayStyle(){return this._NumberDisplayStyle}set NumberDisplayStyle(e){this._NumberDisplayStyle=e}get PageChkResult(){return this._PageChkResult}set PageChkResult(e){this._PageChkResult=e}get FormatStr(){return this._FormatStr}set FormatStr(e){this._FormatStr=e}static BuildPageNumInfo(e){let t=new r;return t.No=e.GrpID,t.Type=e.EleTypeName,t.NumberDisplayStyle=e.PageNumStyle,t.FormatStr=e.FormatString,t}}t.InsertPageNumbersInfo=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XExtendEleUtil=void 0;const r=n(168),i=n(104),l=n(797),s=n(222),o=n(4);t.XExtendEleUtil=class{static BulidBtnInfoByEle(e){let t;if(null==e)t=null;else{let n=new s.InsertBtnInfo;n.Text=e.Text,n.GrpId=e.GrpID,n.FirstExcScriptName=e.FirstExcScriptName,n.SecondExcScriptName=e.SecondExcScriptName,n.BorderStyle=e.BorderStyle,n.BorderColor=e.BorderColor,n.BackColor=e.BtnBackColor,o.default.IsNullOrEmpty(e.CodeXml)||(n.CodeEditInfo=new l.CodeEditInfo,n.CodeEditInfo.CodeText=e.CodeText,n.CodeEditInfo.CodeXml=e.CodeXml,n.CodeEditInfo.ClassName=e.ClassName,n.CodeEditInfo.Language=e.Language,n.CodeEditInfo.MainMethod=e.MainMethod,n.CodeEditInfo.ImportUsingStr=e.ImportUsingStr),t=n}return t}static ReInitShapeEleByInfo(e,t){null!=e&&(e.ShowText=t.ShapeText,e.GrpID=t.No,e.Name=t.Name,e.ShapeName=t.ShapeKey,e.EleStyle.VAlign_ENumVal=i.StyleVAlignVals.GetEnumVAlign(t.AlignKey),e.RectRoundAngle=t.RoundAngle,e.HorEllipseNum=t.HorEllipseNum,e.VerEllipseNum=t.VerEllipseNum)}static BulidShapeInfoByEle(e){let t;return null==e?t=null:(t=new r.ShapeInfo,t.ShapeText=e.ShowText,t.No=e.GrpID,t.Name=e.Name,t.ShapeKey=e.ShapeName,t.AlignKey=i.StyleVAlignVals.GetVAlignStrVal(e.EleStyle.VAlign_ENumVal),t.RoundAngle=e.RectRoundAngle,t.HorEllipseNum=e.HorEllipseNum,t.VerEllipseNum=e.VerEllipseNum),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToothPositionDialog=void 0;const r=n(27),i=n(806);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.ToothPositionComp(t,this.InitProps)}DefaultProps(){return{}}}t.ToothPositionDialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseA_SetColor=void 0;const r=n(2),i=n(0),l=n(16),s=n(7),o=n(831),a=n(13),u=n(1);class h extends u.XBaseAction{constructor(){super(null),super.OpType=r.ENumActOpType.StyleEdit}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),r=e.length;r>0&&(t="string"==typeof e[0]?new s.Color(e[0]):e[0]);let i,l=r<=0?null:t;if(null==l&&null==l)return i=this.resMsg,i;let o=n.M_EleEvtModel.SelRange;if(null!=o&&o.IsValid()){let e=o.InfoUtil.GetLineBaseElesInRange(!1,!1);if(this._ChangeSelElesColor(l,e)){super._RefreshPageAndMoveCaret(!0,!0);let t=super._GetFirstEleFromRange(e);n.M_EleEvtHandler.OnEleStyleChanged(this.ActName(),t.EleStyle)}i=this.resMsg}else{let e=n.M_CaretEleStyle;this._ChangeOneColor(e,l),i=this.resMsg}return i}_ChangeSelElesColor(e,t){let n,r=null==t?0:t.length;if(r<=0)n=!1;else{let s=new a.UndoGroup,o=null,u=!1;for(let n=0;n<r;n++){let r=t[n];if(null!=r){const t=l.XDomUtil.IsInnerChildOfXInput(r);if(null!=t){if(t==o)continue;if(!t.InnerValue)continue;r=t,o=t}let n=this._BuildUndoColor(r),a=r.EleStyle,h=this._ChangeOneColor(a,e);if(u=u||h,h){n.ReadNewColor(),s.AddItem(n);let e=r;null!=e&&e instanceof i.XBaseInputEle&&e.ResetInnerChildrenStyles(!1)}else n.Clear()}}u&&(super._AddUndoItem(s),t[0].OwnerDocPanel.IsChanged=!0),n=u}return n}_ChangeOneColor(e,t){let n=!1,r=this.ActName();return null!=r&&("SetForeColor"!=r?"SetBkgColor"==r&&(n=t!=e.BackgroundColor,n&&(e.BackgroundColor=t,e.isDefaultBackgroundColor=!1)):(n=t!=e.ForeColor,n&&(e.ForeColor=t,e.isDefaultForeColor=!1))),n}_BuildUndoColor(e){let t=null,n=this.ActName();return null!=n&&("SetForeColor"!=n?"SetBkgColor"==n&&(t=new o.EleColorUndo(e,!1)):t=new o.EleColorUndo(e,!0)),t}}t.BaseA_SetColor=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetFont=void 0;const r=n(121),i=n(112);class l extends i.BaseA_SetFontDetail{ActName(){return"SetFont"}Execute(e){return this.resMsg.Clear(),this.resMsg}_ChangeEleFont(e,t){let n;if(null==t)n=!1;else{let r=!1;this._IsEqual(e,t)||(this._BuildXFontStyle(e,t),r=!0),n=r}return n}_BuildFontInfo(e){let t,n=new r.FontInfo;return null==e||(n.FontName=e.FontName,n.FontSize=e.FontSize,n.FontSizeName=e.FontSizeName,n.IsBold=e.IsBold,n.IsItatlic=e.IsItalic,n.IsDrawDeleteLine=e.IsStrikeout,n.IsDrawUnderLine=e.IsUnderline),t=n,t}_BuildXFontStyle(e,t){t.FontName=e.FontName,t.FontSize=e.FontSize,t.FontSizeName=e.FontSizeName,t.IsBold=e.IsBold,t.IsItalic=e.IsItatlic,t.IsStrikeout=e.IsDrawDeleteLine,t.IsUnderline=e.IsDrawUnderLine}_IsEqual(e,t){return null!=e&&null!=t&&e.FontName==t.FontName&&e.FontSize==t.FontSize&&e.IsBold==t.IsBold&&e.IsItatlic==t.IsItalic&&e.IsDrawDeleteLine==t.IsStrikeout&&e.IsDrawUnderLine==t.IsUnderline}}t.A_SetFont=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseA_SetSuperSubScript=void 0;const r=n(2),i=n(0),l=n(16),s=n(13),o=n(856),a=n(1);class u extends a.XBaseAction{constructor(){super(),super.OpType=r.ENumActOpType.StyleEdit}Execute(e){this.resMsg.Clear();let t,n=e[0],r=e[1],i=super.GetEdtCtrl(),l=i.M_EleEvtModel.SelRange;if(null!=l&&l.IsValid()){let e=l.InfoUtil.GetLineBaseElesInRange(!1,!1);if(this._ChangeSelElesSupbScript(e,n,r)){super._RefreshPageAndMoveCaret(!0,!0);let t=super._GetFirstEleFromRange(e);i.M_EleEvtHandler.OnEleStyleChanged(this.ActName(),t.EleStyle)}t=this.resMsg}else{let e=i.M_CaretEleStyle;null!=n?this._ChangeOneSupbScript(!0,e,n):null!=r&&this._ChangeOneSupbScript(!1,e,r),t=this.resMsg}return t}_ChangeSelElesSupbScript(e,t,n){let r,a=null==e?0:e.length;if(a<=0)r=!1;else{let u=new s.UndoGroup,h=null,d=!1;for(let r=0;r<a;r++){let s=e[r];if(null!=s){let e=l.XDomUtil.IsInnerChildOfXInput(s);if(s instanceof i.XCharacterEle||null!=e){null!=e&&(s=e,h=e);let r=s.EleStyle,l=new o.XCharSupbScriptUndo(s),a=!1;if(null!=t?a=this._ChangeOneSupbScript(!0,r,t):null!=n&&(a=this._ChangeOneSupbScript(!1,r,n)),d=d||a,a){l.ReadNewSupbScript(),u.AddItem(l);let e=s instanceof i.XBaseInputEle?s:null;null==e?s.NotifyLayoutChanged(!0,!1):e.ResetInnerChildrenStyles(!0)}else l.Clear()}}}d&&(null!=u&&(u.CursorUndoEle=u.CursorRedoEle=e[0],super._AddUndoItem(u)),e[0].OwnerDocPanel.IsChanged=!0),r=d}return r}_ChangeOneSupbScript(e,t,n){let r,i=t.Superscript,l=t.Subscript;return(e?i:l)==n?r=!1:(e?t.Superscript=n:t.Subscript=n,r=!0),r}}t.BaseA_SetSuperSubScript=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CopyInsertTableCol=void 0;const r=n(16),i=n(1);class l extends i.XBaseAction{get InsertColInxPre(){return 0}Execute(e){const t=super.GetEdtCtrl(),n=t.M_EleEvtModel,i=r.XDomUtil.GetParentCell(n.EleClicked),l=i.ColIndex+this.InsertColInxPre,s=r.XDomUtil.GetXTableOfCell(i),o=r.XDomUtil.GetCellsInSameCol(i,s),a=t.M_GetActionByName(this.RelExcuteActName);null!=a&&(this.resMsg=a.Execute(e));const u=r.XDomUtil.GetCellsByColInx(s,l);for(let e=0;e<u.length;e++){const t=u[e],n=o[e].GetChildArr();if(null!=n&&0!=n.length){t.RemoveChildren(0,t.ChildCount);const e=r.XDomUtil.CopyAllEles(n);t.AddChildrenEle(-1,e)}}return super.GetEdtCtrl().MRefreshDocView(),this.resMsg}}t.A_CopyInsertTableCol=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CopyInsertTableRow=void 0;const r=n(0),i=n(16),l=n(88),s=n(1);class o extends s.XBaseAction{get InsertRowInxPre(){return 0}Execute(e){let t=super.GetEdtCtrl(),n=null,s=!1;if(e.length>=2&&(n=e[0]instanceof r.XTextTableCell?e[0]:null,s=!0),null==n){let e=t.M_EleEvtModel;n=i.XDomUtil.GetParentCell(e.EleClicked)}let o,a=i.XDomUtil.GetXTableOfCell(n);if(null==a)o=this.resMsg;else if(a.Rows.Count()<=0)o=this.resMsg;else{let r=n.RowIndex+this.InsertRowInxPre;0;let u=i.XDomUtil.GetCellsByRowInx(a,n.RowIndex),h=t.M_GetActionByName(this.RelExcuteActName);if(null==h)o=this.resMsg;else{h.Execute(e);let t=i.XDomUtil.GetCellsByRowInx(a,r);if(null==t||0==t.length)o=this.resMsg;else{for(let e=0;e<t.length;e++){let n=t[e],r=u[e].GetChildArr();if(null!=r&&0!=r.length){n.RemoveChildren(0,n.ChildCount);let e=i.XDomUtil.CopyAllEles(r);if(null!=e&&e.length==r.length&&s)for(let t=0;t<e.length;t++){let n=e[t]instanceof l.XInputEle?e[t]:null;null!=n&&(n.GrpID=r[t].GrpID)}n.AddChildrenEle(-1,e)}}super.GetEdtCtrl().MRefreshDocView(),o=this.resMsg}}}return o}}t.A_CopyInsertTableRow=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CreateTextTable=void 0;const r=n(45),i=n(20),l=n(373),s=n(13),o=n(48),a=n(38),u=n(6);class h extends o.A_InsertElement{ActName(){return"CreateTextTable"}Execute(e){let t;this.resMsg.Clear(),this.inertTableInfo=l.InsertTableInfo.GetTextInfo();let n=e[0],i=this.getPosCID(n);if(null!=i||this.InsertValid())if(this.resMsg.MsgLevel<5)t=this.resMsg;else{let e,l,o=super.GetEdtCtrl();null!=n&&(this.inertTableInfo.No=n.elementCodeString,this.inertTableInfo.ColNum=n.columnNumberString,this.inertTableInfo.RowNum=n.lineNumberString,e=n.eleStyle,l=n.innerArr);try{if(null==this.inertTableInfo)return t=this.resMsg,t;let a=new r.XTextTable,u=o.M_EleEvtModel.EleClicked;if(null!=i){o.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.ReplaceEle(i)}else u=o.M_EleEvtModel.EleClicked;if(null==u)return this.resMsg.MsgStr="当前光标所在位置的元素对象为空",this.MessageError(),this.resMsg;let h=new s.UndoGroup;if(a.OwnerDocPanel=o.M_EleEvtModel.EleClicked.OwnerDocPanel,a.Action_CreateTextTable_New(this.inertTableInfo.RowNum,this.inertTableInfo.ColNum),null!=e){!1===e.BorderTop&&(a.EleStyle.BorderTop=!1),!1===e.BorderBottom&&(a.EleStyle.BorderBottom=!1),!1===e.BorderLeft&&(a.EleStyle.BorderLeft=!1),!1===e.BorderRight&&(a.EleStyle.BorderRight=!1);let t="";if(!1===e.BorderVerticalCenter&&(a.EleStyle.BorderVerticalCenter=!1,t+="2"),!1===e.BorderHorizontalCenter&&(a.EleStyle.BorderHorizontalCenter=!1,t+="1"),""!=t){const e=a.Rows;for(let n=0;n<e.Count();n++){const r=e.Get(n).Cells;for(let e=0;e<r.Count();e++){const n=r.Get(e);-1!=t.indexOf("1")&&(n.EleStyle.BorderTop=!1,n.EleStyle.BorderBottom=!1),-1!=t.indexOf("2")&&(n.EleStyle.BorderRight=!1,n.EleStyle.BorderLeft=!1)}}}}if(l instanceof Array&&l.length>0){const e=a.Rows;for(let t=0;t<e.Count();t++)if(l[t]instanceof Array&&l.length>0){const n=e.Get(t).Cells;for(let e=0;e<n.Count();e++){const r=l[t][e];if(r){n.Get(e).AddChildEle(0,r)}}}}return n.CptID&&(a.CptID=n.CptID),this.resMsg=super.Execute([a,h]),super._AddUndoItem(h),t=this.resMsg,t}catch(e){this.resMsg.Ex=e}t=this.resMsg}else this.resMsg.MsgStr="单元格内不允许插入表格",this.MessageError(),t=this.resMsg;return t}InsertValid(){let e=super.GetEdtCtrl().M_EleEvtModel.EleClicked;return null==i.XTextTableUtil.GetCursorCell(e)}getPosCID(e){let t;if(null!=e){const n=e.posCID;if(n){const e=super.GetEdtCtrl().M_DocumentFocused.GetPagePanel(u.ENumPagePanelTp.Body);let r=new a.List;if(e.GetChildrenByCptId(n,!0,r),r.Count()>0&&(t=r.Get(0)),null!=t){let n=e.GetChildInx(t);n++,n>0&&(t=e.GetChildEle(n))}}}return t}}t.A_CreateTextTable=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InsertTableInfo=void 0;class r{get No(){return this._No}set No(e){this._No=e}get RowNum(){return this._RowNum}set RowNum(e){this._RowNum=e}get ColNum(){return this._ColNum}set ColNum(e){this._ColNum=e}static GetTextInfo(){let e=new r;return e.No="",e.RowNum=3,e.ColNum=3,e}}t.InsertTableInfo=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTableResizeRowReduUndo=void 0;const r=n(23);class i extends r.IXUndoable{get SrcRow(){return this._SrcRow}set SrcRow(e){this._SrcRow=e}IsValid(){return!0}CanUndo(){return!0}CanRedo(){return!0}Undo(){if(null!=this.SrcRow)for(let e=0;e<this.SrcRow.Cells.Length;e++){let t=this.SrcRow.Cells.Get(e);t.FixHeight_Disp=t.PreFixHeight_Disp,t.FixHeight=t.PreFixHeight,t.AutoSize=t.PreAutoSize,t.NotifyLayoutChanged(!0,!1),this.SrcRow.FixHeight=t.FixHeight}}Redo(){if(null!=this.SrcRow)for(let e=0;e<this.SrcRow.Cells.Length;e++){let t=this.SrcRow.Cells.Get(e);t.FixHeight=t.NewFixHeight,t.FixHeight_Disp=t.NewFixHeight_Disp,t.SetSizeDPI(-1e3,t.FixHeight,300),t.AutoSize=t.NewAutoSize,t.NotifyLayoutChanged(!0,!1),this.SrcRow.FixHeight=t.FixHeight}}Clear(){}}t.TextTableResizeRowReduUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_BaseShowHideEleCode=void 0;const r=n(26),i=n(8),l=n(1);class s extends l.XBaseAction{Execute(e){if(null==e||0==e.length)return this.resMsg;const t=i.CNumUtil.TryParseBool(e[0],!1);return r.TextDocInitInfo.GetInstance().BottomToolBar_ShowEleId=t,this.resMsg}}t.A_BaseShowHideEleCode=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertDoc=void 0;const r=n(2),i=n(70),l=n(60),s=n(1),o=n(89),a=n(38),u=n(13),h=n(55),d=n(6),c=n(0),p=n(95);class f extends s.XBaseAction{constructor(e){super(e),this.xdocLoadParam=new i.XDocLoadParam,this.edt_elerange=null,super.OpType=r.ENumActOpType.CtntEdit,this.xdocLoadParam=new i.XDocLoadParam(null,r.ENumXDocPath.LocalFile),this.edt_elerange=new h.EmrEditEleRange}ActName(){return"InsertDoc"}Execute(e){this.resMsg.Clear();let t=null==e?0:e.length,n=t<=0?null:"string"==typeof e[0]?e[0]:null,r=e.length>=2&&e[1],i=e.length>=3&&e[2],s=e.length>=4?e[3]:null,h=e.length>=5?e[4]:null,f=e.length>=6&&e[5],g=e.length>=7&&!0===e[6],m=!1,E=!1,C=!1;if(t>0&&"object"==typeof e[0]){let t=e[0];n=t.srcStr,r=null!=t.removParagraphFlag&&t.removParagraphFlag,i=null!=t.isKeepTrace&&t.isKeepTrace,s=t.bussId,h=t.undoRelateId,f=!0===t.resetFontStyle||t.resetFontStyle,g=!0===t.changeFlag,m=!0===t.resetTitleToStr,E=!0===t.resetTitleDeletFlag,C=!0===t.unEditableCanDo}if(!C){let e=super.GetEdtCtrl().M_EleEvtModel.EleClicked,t=super.GetEdtCtrl().M_EleEvtModel.WorkMode;if(!this.CheckAddRule(t,e))return void(this.resMsg.CodeStr="InsertFail")}let A=null,y=super.GetEdtCtrl();try{const e=y.M_EleEvtModel,t=y.M_EdtCustomEvtGrp.AppKeepTrace;let C=e.AddEdtHistAct;t&&i||(C=null);let I=y.M_EleEvtModel.EleClickedWrap;this.edt_elerange.SetEleEvtObjs(e,y.M_EleEvtHandler);let S=new u.UndoGroup;this.edt_elerange.IsSelRangeValid()&&this.edt_elerange.DelSelRange(127,S,this.resMsg);let _=!1;if(null==A){_=!0,this.xdocLoadParam.SrcStr=n,A=l.EmrApiUtil.LoadXDocBrowse(!0,this.xdocLoadParam);let e=A.GetPagePanel(d.ENumPagePanelTp.Body);e.ChildEleList.Get(e.ChildEleList.Length-1)instanceof c.XParagraphFlag&&r&&e.ChildEleList.RemoveAt(e.ChildEleList.Length-1)}if(null!=A){this.clearKeepTrace(A.GetPagePanel(d.ENumPagePanelTp.Body));let e=new a.List;if(A.storeChildrenList(e),f){const e=super.GetXDocFocused().GetDefaultStyle(),t=e.XFontStyle.FontSize;this.setFontSizeToDocDefault(A.GetPagePanel(d.ENumPagePanelTp.Body),t)}const t=o.MsgRegisterHandler.changeAllChildrenNewIdAndXId(e,!0);o.MsgRegisterHandler.updateAllExpressStr(t[0],t[1],e)}let w=super.GetXDocFocused(),b=I.EleFocused;if(h){let e=A.GetFirstBaseChild(!1),t=A._GetLastBaseChild(!1,!1),n=A.GetPagePanel(d.ENumPagePanelTp.Body),r=e,i=t;for(;r.Parent!=n&&(r=r.Parent,null!=r););for(;i.Parent!=n&&(i=i.Parent,null!=i););r.UndoRelateId=h,i.UndoRelateId=h}let x=A.GetPagePanel(d.ENumPagePanelTp.Body),P=x.GetChildArr();if(m||E)for(let e=0;e<x.ChildEleList.Length;e++){let t=x.ChildEleList.Get(e);if(E&&this.resetDeleteFlag(t),m){let n=this.xtextLabelElementToString(t);null!=n&&x.ChildEleList.Set(e,n)}}let v=w.AssistFunc.InsertBodyFrom(A,b,!_,C,s,S);g&&this.SetTimeChangeColor(P),super._AddUndoItem(S),p.EmrInnerUtil.ResetBodyXInputCache(b.Document,y),this.resMsg.CopyFrom(v),this.resMsg.IsWarnMsg()||(super._RefreshPageAndMoveCaret(!0,!0),o.MsgRegisterHandler.RegisterExpressionToMsgBus(y.M_DocumentFocused)),b&&b.OwnerDocPanel&&(b.OwnerDocPanel.IsChanged=!0),this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}clearKeepTrace(e){if(null==e)return;let t;const n=e.EleStyle;if(null!=n&&(n.DeleterIndex>-1&&(e.Parent.RemoveChild(e),t=!0),n.CreatorIndex>-1&&(n.CreatorIndex=-1)),!t&&e instanceof c.XBaseContainer){for(let t=0;t<e.ChildEleList.ToArray().length;t++){const n=e.ChildEleList.Get(t);this.clearKeepTrace(n)}e.ChildCount<=0&&e.Parent.RemoveChild(e)}}setFontSizeToDocDefault(e,t){if(null!=e&&t>1){const n=e.EleStyle.XFontStyle;if(n.FontSize!=t&&(n.FontSize=t,e.IsLayoutValid=!1),e instanceof c.XBaseContainer&&e.ChildCount>0)for(let n=0;n<e.ChildEleList.ToArray().length;n++){const r=e.ChildEleList.Get(n);this.setFontSizeToDocDefault(r,t)}}}}t.A_InsertDoc=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPageViewPainter=void 0;const r=n(26),i=n(2),l=n(6),s=n(905),o=n(0),a=n(906),u=n(10),h=n(11),d=n(30),c=n(7),p=n(125),f=n(151),g=n(17),m=n(9),E=n(4),C=n(343),A=n(110),y=n(907),I=n(925),S=n(248);class _ extends y.XBaseContainerPainter{constructor(e){super(),this.pageFmt=null,this.pageRect=m.RectangleF.Empty,this.pageLocationUI=g.PointF.Empty,this.pageView=null,this.isSingleXDoc=!0,this.pgBodyCtntEndVLine=new a.CLinePos,this.isInvalidate=!0,this._showPageBorder=!0,this.pageView=e,this.pageView.RelDocPage=this,this.IsInvalidate=!0}set CmmtDom(e){this._cmmtDom=e}get CmmtDom(){return this._cmmtDom}get ShowPageBorder(){return this._showPageBorder}set ShowPageBorder(e){this._showPageBorder=e}get BkgColor(){return c.Color.White}set BkgColor(e){}get IsPageVisible(){return this.IsPageVisible}set IsPageVisible(e){this.IsPageVisible=e}get IsInvalidate(){return this.isInvalidate}set IsInvalidate(e){this.isInvalidate=e}set IsSingleXDoc(e){this.isSingleXDoc=e}get DefaultPageBorder(){return null==_.Dft_PgBorder&&(_.Dft_PgBorder=new s.PageBorder),_.Dft_PgBorder}get DocArgs(){return this.pageView.DocArgs}set DocArgs(e){this.pageView.DocArgs=e}get PageIx(){return this.pageView.PageIx}set PageIx(e){this.pageView.PageIx=e}get PageBorder(){return null}set PageBorder(e){}get PageFormat(){return this.pageFmt}set PageFormat(e){this.pageFmt=e,this.pageRect.Width=e.Width,this.pageRect.Height=e.Height;if(this.pageView.Document.GetDocCtxt().ViewMode.IsWebViewMode){let e=this.PageBodyCtntEndVLine;this.pageRect.Height=1+e.Pos02.getYAsPX(96)}this.pageView.SetPageSizeUI(this.pageRect.Width,this.pageRect.Height,96)}get PageBodyRect(){let e=this.pageView.GetPageBodyRect(96);return A.RectFUtil.ToRect(e)}get PageBodyCtntEndVLine(){return this._CalcPageBodyCtntEndVLine(),this.pgBodyCtntEndVLine}get PageRect(){return this.pageRect}get PageLocationUI(){return this.pageLocationUI}get PageView(){return this.pageView}get Graphic(){return this.graphic}CreatePageCanvas(e){if(null==this.graphic){let t=document.createElement("canvas");e.appendChild(t),this.SetPageCanvas(t)}}SetPageCanvas(e){null==this.graphic&&(this.graphic=new f.Graphics(e),e.srcPage=this)}GetPageRectDPI(e,t,n){t<=0&&(t=d.DefineDPI.GetOutDPI(n));let r=this.PageRect.Clone();return e&&(n!=h.ENumOutTp.UI_Show&&n!=h.ENumOutTp.UI_Print&&(e=!1),e&&(r.Location=this.PageLocationUI.Clone())),n==h.ENumOutTp.UI_Show&&(r.X++,r.Y++),u.DPITransUtil.TransRect(r,96,r,t),r}SetPageLocation(e,t,n){if(n>0&&96!=n){let r=96/n;e*=r,t*=r}this.pageRect.X=e,this.pageRect.Y=t}SetPageLocationUI(e,t,n){if(n>0&&96!=n){let r=96/n;e*=r,t*=r}this.pageLocationUI.X=e,this.pageLocationUI.Y=t,this.pageView.SetPageLocationUI(e,t,n)}Clear(){null!=this.pageView&&(this.pageView.Clear(),this.pageView=null),this.pgBodyCtntEndVLine=null}DrawPage(e,t,n,r){let i=r.OutTp,l=e.Clip,s=d.DefineDPI.GetOutDPI(i),o=this.pageView.Document.GetDocCtxt();o.PgvPaiting=this.pageView,this.pageView.PageDrawArgs=r;let a=r.ZoomRatio;a>0&&(this.zoomRatio=a,this.graphic.scale(a,a));let u=this.GetPageRectDPI(!0,s,i);e.IntersectClip(u),this.graphic.Flush(),this.graphic.ShowXParagraphFlag=e.ShowXParagraphFlag,this.graphic.ShowStatusImg=e.ShowStatusImg,this.graphic.ShowWaterMark=e.ShowWaterMark,this.graphic.EditableCanvas=e.EditableCanvas,super.Paint(this.pageView,this.graphic,t,n,i),e.Clip=l,o.PgvPaiting=null,this.zoomRatio=1;let c=this.GetPageRectDPI(!0,s,i);if(this._PaintCommentLine(this.graphic,t,n,c,i),i==h.ENumOutTp.UI_Show){let e=this.pageView.DragDashRectF;this._PaintDashRect(this.graphic,t,e,s,a);let n=this.pageView.DragDashLineF;this._PaintDashLine(this.graphic,t,n,s,a)}this.IsInvalidate=!1}DrawPage1(e,t,n,r){let i=r.OutTp,l=d.DefineDPI.GetOutDPI(i),s=this.pageView.Document.GetDocCtxt();s.PgvPaiting=this.pageView,this.pageView.PageDrawArgs=r;let o=r.ZoomRatio;if(o>0&&this.graphic.scale(o,o),this.graphic.Flush(),super.Paint(this.pageView,this.graphic,t,n,i),s.PgvPaiting=null,i==h.ENumOutTp.UI_Show){let e=this.pageView.DragDashRectF;this._PaintDashRect(this.graphic,t,e,l,o);let n=this.pageView.DragDashLineF;this._PaintDashLine(this.graphic,t,n,l,o)}}ResetPage(){this.pgBodyCtntEndVLine.Pos01.setLocationAsMM(0,0),this.pgBodyCtntEndVLine.Pos02.setLocationAsMM(0,0)}GetEleAtCtrlPos(e,t){let n=e.ClickPosInCtrl,r=n.X-this.pageLocationUI.X,i=n.Y-this.pageLocationUI.Y;this.pageView.GetEleAtPos(r,i,96,e,t)}PaintElement(e,t,n,r,i){let l=d.DefineDPI.GetOutDPI(i),s=n.Color,o=r.Color,a=r.DashStyle,c=this.GetPageRectDPI(!1,l,i);n.Color=this.BkgColor,t.FillRectangle(n,c);let p=this.pageView.Document,f=p.GetDocCtxt(),g=p.GetPageFmt(),m=g.GetPagePaddWithGutter();m=u.DPITransUtil.TransPadding(m,100,l),f.ViewMode.IsWebViewMode||(this._PaintPageHeadSptLine(t,r,c,m,i),this._PaintPageFootSptLine(t,r,c,m,i)),this._PaintPageColSptLine(t,r,c,i),i!=h.ENumOutTp.UI_Show||f.ViewMode.IsWebViewMode||(this._PaintPageMarginLines(t,r,c,m,i),this._PaintGutterLine(t,r,g,c,i));let E=this.pageView.Document.GetWaterMark();(i!=h.ENumOutTp.CsPrint||E.EditorPrintFlag)&&t.ShowWaterMark&&I.XPageViewPainterAssist.PaintWaterMark(E,t,n,r,c,m,l),this._PaintCommentArea(t,n,r,c,i),n.Color=s,r.Color=o,r.DashStyle=a}PaintChildLines(e,t,n,r,i){let s=d.DefineDPI.GetOutDPI(i),o=this.GetPageRectDPI(!1,s,i);t.TranslateTransform(o.X,o.Y),this._PaintPagePanelLines(l.ENumPagePanelTp.Header,t,n,r,i,s),this._PaintPagePanelLines(l.ENumPagePanelTp.Body,t,n,r,i,s),this._PaintPagePanelLines(l.ENumPagePanelTp.Footer,t,n,r,i,s),t.TranslateTransform(-o.X,-o.Y)}_PaintPagePanelLines(e,t,n,r,i,l){this.pageView.Document;let s=this.pageView.GetPagePanelView(e);null!=s&&super.PaintChildLines(s,t,n,r,i)}PaintBorder(e,t,n,l){if(l==h.ENumOutTp.UI_Show){let s=e.Document.GetDocCtxt().EmrWorkMode;if(i.ENumWorkMode.Browse!=s){if(!e.Document.GetDocCtxt().ViewMode.IsWebViewMode){let e=d.DefineDPI.GetOutDPI(l),i=this.GetPageRectDPI(!1,e,l);this.ShowPageBorder&&(n.Color=r.TextDocInitInfo.GetInstance().PageBorderColor,n.DashStyle=p.DashStyle.Solid,n.Width=u.DPITransUtil.TransFloatVal(2,96,e),t.DrawRectangle(n,i))}}}}PaintMaskLayer(e,t,n,r){if(r==h.ENumOutTp.UI_Show||r==h.ENumOutTp.UI_Print||r==h.ENumOutTp.CsPrint){let e=d.DefineDPI.GetOutDPI(r),s=this.GetPageRectDPI(!1,e,r);this._PaintSelFocusAreaBkg(t,n,e),this._PaintSelFocusAreaBkg(t,n,e,i.ENumBkgRectsType.HoverRects),this._PaintXDocPanelReadonlyMaskLayer(t,n,l.ENumPagePanelTp.Header,s.Location,e),this._PaintXDocPanelReadonlyMaskLayer(t,n,l.ENumPagePanelTp.Footer,s.Location,e),this._PaintXDocPanelReadonlyMaskLayer(t,n,l.ENumPagePanelTp.Body,s.Location,e)}}_CalcPageBodyCtntEndVLine(){if(this.pgBodyCtntEndVLine.Pos02.YAsMM<=0){this.pgBodyCtntEndVLine.Pos01.setLocationAsMM(0,0),this.pgBodyCtntEndVLine.Pos02.setLocationAsMM(0,0);let e=this.pageView.GetPagePanelView(l.ENumPagePanelTp.Body).GetEndLine(),t=e.RealTop;t+=e.LineAssist.GetLineFullHeight(300,!0),this.pgBodyCtntEndVLine.Pos02.setYAsPX(t,300)}}_PaintGutterLine(e,t,n,r,i){if(n.GutterMargin>0){let l=d.DefineDPI.GetOutDPI(i);t.Color=c.Color.LightGray,t.DashStyle=p.DashStyle.Custom,t.DashPattern=_.Line_DashPattern;let s=n.GetGutterMarginDPI(l)+.5;E.default.Equals(n.GutterSide,"Top")?e.DrawLine(t,r.X,r.Y+s,r.Right,r.Y+s):e.DrawLine(t,r.X+s,r.Y,r.X+s,r.Bottom)}}_PaintPageHeadSptLine(e,t,n,r,i){let s=this.PageView.Document.GetPageFmt(),o=s.IsShowHeadSptLine;if(o||i==h.ENumOutTp.UI_Show){let a=d.DefineDPI.GetOutDPI(i);t.Color=o?c.Color.Black:c.Color.LightGray,t.Width=1,t.DashStyle=p.DashStyle.Solid;let h=this.pageView.GetPagePanelView(l.ENumPagePanelTp.Header).GetValidHeight(a);h+=u.DPITransUtil.TransFloatVal(s.HeadTopMargin,100,a);const f=n.X+r.Left,g=n.Y+h,m=n.Right-r.Right,E=n.Y+h;e.DrawLine(t,f,g,m,E)}}_PaintPageFootSptLine(e,t,n,r,i){let s=this.PageView.Document.GetPageFmt().IsShowFooterSptLine;if(s||i==h.ENumOutTp.UI_Show){let o=d.DefineDPI.GetOutDPI(i);t.Color=s?c.Color.Black:c.Color.LightGray,t.Width=1,t.DashStyle=p.DashStyle.Solid;let a=this.pageView.GetPagePanelView(l.ENumPagePanelTp.Footer).GetBoundsDPI(o);const u=n.X+r.Left,h=a.Y,f=n.Right-r.Right,g=a.Y;e.DrawLine(t,u,h,f,g)}}_PaintPageColSptLine(e,t,n,r){let i=this.PageView.Document.GetPageCols(),s=i.ColsCnt;if(s>1&&i.ShowSptLine){let o=d.DefineDPI.GetOutDPI(r);if(t.Color=c.Color.Black,i.ColLineIsDashed){let e=[4,3];t.DashStyle=p.DashStyle.DashDotDot,t.DashPattern=e}else t.DashStyle=p.DashStyle.Solid;let a=this.pageView.GetPagePanelView(l.ENumPagePanelTp.Body).GetBoundsDPI(o);for(let r=0;r<s-1;r++){let l=i.CalcSptLinePos(r,o);const s=n.X+a.X+l,u=n.Y+a.Y,h=n.X+a.X+l,d=n.Y+a.Bottom;e.DrawLine(t,s,u,h,d)}}}_PaintPageMarginLines(e,t,n,r,i){let l=d.DefineDPI.GetOutDPI(i),s=u.DPITransUtil.TransIntVal(6,25.4,l);t.Color=c.Color.LightGray,t.DashStyle=p.DashStyle.Solid;for(let i=1;i<=4;i+=1)this._PaintOneMarginCorner(e,t,n,r,s,i)}_PaintOneMarginCorner(e,t,n,r,i,l){let s=[];switch(l){case 1:s[1]=new g.PointF(n.X+r.Left,n.Y+r.Top),s[0]=new g.PointF(s[1].X,s[1].Y-i),s[2]=new g.PointF(s[1].X-i,s[1].Y);break;case 2:s[1]=new g.PointF(n.Right-r.Right,n.Y+r.Top),s[0]=new g.PointF(s[1].X,s[1].Y-i),s[2]=new g.PointF(s[1].X+i,s[1].Y);break;case 3:s[1]=new g.PointF(n.Right-r.Right,n.Bottom-r.Bottom),s[0]=new g.PointF(s[1].X+i,s[1].Y),s[2]=new g.PointF(s[1].X,s[1].Y+i);break;case 4:s[1]=new g.PointF(n.X+r.Left,n.Bottom-r.Bottom),s[0]=new g.PointF(s[1].X-i,s[1].Y),s[2]=new g.PointF(s[1].X,s[1].Y+i)}e.DrawLine(t,s[0],s[1]),e.DrawLine(t,s[1],s[2])}_PaintXDocPanelReadonlyMaskLayer(e,t,n,r,i){let s=this.pageView.GetPagePanelView(n);if(null!=s&&!this._Is_BrowseWkMode()){let[o,a]=s.CalcReadOnlyRects(r,i);if(null!=o&&o.length>0)for(let r=0;r<o.length;r++){let i=a&&a.length>r?a[r]:null,s=this.isSingleXDoc?_.SingleXDocMaskColor:i||_.MultiXDocsMaskColor;n!=l.ENumPagePanelTp.Header&&n!=l.ENumPagePanelTp.Footer||(s=_.SingleXDocMaskColor),t.Color=s,e.FillRectangle(t,o[r])}}}_Is_BrowseWkMode(){let e,t=null==this.pageView?null:this.pageView.Document;if(null==t)e=!1;else{let n=t.GetDocCtxt();e=i.ENumWorkMode.Browse==n.EmrWorkMode||i.ENumWorkMode.PrintPreview==n.EmrWorkMode}return e}_PaintCommentArea(e,t,n,i,s){if(this.pageFmt.ShowCmmtArea){let t,a=this.zoomRatio,h=this.pageView.Document.GetPagePanel(l.ENumPagePanelTp.CmmtBar).ChildEleList,c=d.DefineDPI.GetOutDPI(s),f=this.pageView.Document.AssistFunc.CalcCmmtBarWidth(c),g=i.Right,m=i.Top+this.PageIx*(i.Height+8),E=i.Height,C=this.pageView.GetCommentList(),A=C.ToArray();if(A.length>0){let l;this.IsInvalidate&&(t=new S.XCommentArea({dom:this.CmmtDom,PageIndex:this.PageIx,top:m*a,left:g*a,width:f,height:E*a,cmmtList:[],deleteCmmt:function(e){for(let t of h)t==e&&h.Remove(e)},deletesubCmmt(e,t){for(let n of h){let r=n;if(r==e)for(let e of r.ItemList)e==t&&r.ItemList.Remove(t)}}}),t.upDateCommentList(A)),n.Color=r.TextDocInitInfo.GetInstance().CommentLineColor,n.Width=u.DPITransUtil.TransFloatVal(1,96,c),n.DashStyle=p.DashStyle.Dash;for(let t of C){let r=t,u=d.DefineDPI.GetOutDPI(s),h=r.RelLineEleFrom,c=h.OwnPageView.GetPagePanelView(h.OwnerDocPanel.PagePanelTp),p=r.RelLineEleTo,f=o.XDomUtil.GetParentCell(p),g=c.GetBoundsDPI(u),m=p.GetBoundsDPI(u),E=p.OwnerLine.GetBoundsDPI(u),C=0,A=0;f instanceof o.XTextTableCell&&(C=f.GetBoundsDPI(u).Left+f.EleStyle.ElePadd.Left,A=f.Parent.Parent.OwnerLine.GetBoundsDPI(u).Top+f.OwnerLine.GetBoundsDPI(u).Top);let y=g.X+m.Right+C,I=g.Top+E.Top+m.Bottom+A,S=g.Right,_=g.Top+E.Top+m.Bottom+A;e.DrawLine(n,y,I+2,S,_+2),t.PreCmmtBottom=null==l?_*a:(_*a>l?_*a:l)+3,l=t.PreCmmtBottom+t.DomHeight,e.DrawLine(n,S,_+2,i.Right,t.PreCmmtBottom/a)}this.IsInvalidate&&t.upDateCommentList([...A])}else this.IsInvalidate&&(t=new S.XCommentArea({dom:this.CmmtDom,PageIndex:this.PageIx,top:m*a,left:g*a,width:f,height:E*a,cmmtList:[]}),t.upDateCommentList(A))}}_PaintCommentLine(e,t,n,i,l){if(this.pageFmt.ShowCmmtArea){let t=this.zoomRatio,s=d.DefineDPI.GetOutDPI(l),a=this.pageView.GetCommentList();if(a.ToArray().length>0){let h;n.Color=r.TextDocInitInfo.GetInstance().CommentLineColor,n.Width=u.DPITransUtil.TransFloatVal(1,96,s),n.DashStyle=p.DashStyle.Dash;for(let r of a){let s=r,a=d.DefineDPI.GetOutDPI(l),u=s.RelLineEleFrom,c=u.OwnPageView.GetPagePanelView(u.OwnerDocPanel.PagePanelTp),p=s.RelLineEleTo,f=o.XDomUtil.GetParentCell(p),g=c.GetBoundsDPI(a),m=p.GetBoundsDPI(a),E=p.OwnerLine.GetBoundsDPI(a),C=0,A=0;f instanceof o.XTextTableCell&&(C=f.GetBoundsDPI(a).Left+f.EleStyle.ElePadd.Left,A=f.Parent.Parent.OwnerLine.GetBoundsDPI(a).Top+f.OwnerLine.GetBoundsDPI(a).Top);let y=g.X+m.Right+C,I=g.Top+E.Top+m.Bottom+A,S=g.Right,_=g.Top+E.Top+m.Bottom+A;e.DrawLine(n,y,I+2,S,_+2),r.PreCmmtBottom=null==h?_*t:(_*t>h?_*t:h)+3,h=r.PreCmmtBottom+r.DomHeight,e.DrawLine(n,S,_+2,i.Right,r.PreCmmtBottom/t)}}}}_PaintDashRect(e,t,n,r,i){n.Width>0&&n.Height>0&&(u.DPITransUtil.TransRectF(n,96,n,r),C.PainterUtil.GetInstance().DrawDashedRect(e,n))}_PaintDashLine(e,t,n,r,i){if(null!=n&&n.length>=2&&n[0]!=n[1]){if(n[1].X>=1073741820)n[1].X=this.pageRect.Width;else{let e=Math.floor(n[0].X/this.pageRect.Width),t=n[0].X%this.pageRect.Width;n[0].X=n[1].X=t-8*e-2*e}if(n[1].Y>=1073741820)n[1].Y=this.pageRect.Height;else{let e=Math.floor(n[0].Y/this.pageRect.Height),t=n[0].Y%this.pageRect.Height;n[0].Y=n[1].Y=t-8*e-2*e}u.DPITransUtil.TransPointF(n[0],96,n[0],r),u.DPITransUtil.TransPointF(n[1],96,n[1],r),C.PainterUtil.GetInstance().DrawDashedLine(e,n[0],n[1])}}_PaintSelFocusAreaBkg(e,t,n,l){const s=l||this.pageView.RectType;let o=this.pageView.GetSelRects(s);if(null!=o&&o.length>0){s==i.ENumBkgRectsType.SelRects||s==i.ENumBkgRectsType.None?t.Color=r.TextDocInitInfo.GetInstance().TextSelectBgColor:s==i.ENumBkgRectsType.FocusRects?t.Color=r.TextDocInitInfo.GetInstance().InputFieldFocusColor:s==i.ENumBkgRectsType.HoverRects&&(t.Color=r.TextDocInitInfo.GetInstance().InputFieldHoverColor);let l=o.length,a=new Array(l);for(let e=0;e<l;e++)a[e]=o[e],96!=n&&u.DPITransUtil.TransRectF(a[e],96,a[e],n);e.FillRectangles(t,a)}}_TestPaintPagePanelBorder(e,t,n){let r=this.pageView.GetPagePanelView(e);if(null!=r){let e=r.Bounds;u.DPITransUtil.TransRectF(e,300,e,96),e.X+=this.pageLocationUI.X,e.Y+=this.pageLocationUI.Y,u.DPITransUtil.TransRectF(e,96,e,n);A.RectFUtil.ToRect(e)}}}t.XPageViewPainter=_,_.UIPage_BdrWidth=2,_.Line_DashPattern=[6,3,1,3],_.SingleXDocMaskColor=new c.Color("#55FFFFFF"),_.MultiXDocsMaskColor=new c.Color("#32CCCCCC"),_.Dft_PgBorder=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XRadioBoxPainter=void 0;const r=n(26),i=n(2),l=n(0),s=n(46),o=n(104),a=n(10),u=n(11),h=n(30),d=n(7),c=n(103),p=n(67),f=n(17),g=n(9),m=n(118),E=n(53),C=n(47);class A extends C.XBasePainter{PaintElement(e,t,n,r,i){let s,o=t.Save();if(e instanceof l.XRadioBoxEle&&(s=e),null!=s){let l=h.DefineDPI.GetOutDPI(i),a=s.GetBoundsDPI(l);if(s.Grp_StrongShow){let e=new E.SolidBrush(d.Color.SpringGreen);t.FillRectangle(e,a)}A.DrawBaseChoiceMark(s,t,l,n),this._PaintUnderline_(t,r,e,a,l),this._PaintStrikeout_(t,r,e,a,l),t.Restore(o)}}static DrawBaseChoiceMark(e,t,n,r){"RadioBox"===e.BaseChoiceShowStyle?A.DrawCireleStyle(e,t,n,r):A.DrawRectStyle(e,t,n,r)}static DrawCireleStyle(e,t,n,r){let i=e.EleStyle,l=e.GetTitleRect(n),s=new p.Pen(i.ForeColor);if(t.SmoothingMode=m.SmoothingMode.HighQuality,t.DrawEllipse(s,l),e.Checked){let e=a.DPITransUtil.TransFloatVal(-2,96,n);l.Inflate(e,e);let r=new E.SolidBrush(d.Color.FromRgba(0,153,229));t.FillEllipse(r,l)}A.DrawText(e,t,i,r,n)}static DrawRectStyle(e,t,n,r){let i=e.EleStyle,l=e.GetTitleRect(n),s=new p.Pen(i.ForeColor);t.SmoothingMode=m.SmoothingMode.HighQuality,t.DrawRectangle(s,l.X,l.Y,l.Width,l.Height),e.Checked&&A.DrawCheckedFlag(t,l,d.Color.FromRgba(0,153,229),n),A.DrawText(e,t,i,r,n)}static DrawCheckedFlag(e,t,n,r){let i=[new f.PointF(t.X+t.Width/a.DPITransUtil.TransFloatVal(4.5,96,r),t.Y+t.Height/a.DPITransUtil.TransFloatVal(2.5,96,r)),new f.PointF(t.X+t.Width/a.DPITransUtil.TransFloatVal(2.5,96,r),t.Bottom-t.Height/a.DPITransUtil.TransFloatVal(3,96,r)),new f.PointF(t.Right-t.Width/a.DPITransUtil.TransFloatVal(4,96,r),t.Y+t.Height/a.DPITransUtil.TransFloatVal(4.5,96,r))];a.DPITransUtil.TransFloatVal(2,96,r);let l=new p.Pen(n);e.DrawLines(l,i)}static DrawText(e,t,n,l,o){let u=c.FontStyle.Regular;n.XFontStyle.IsUnderline&&(u|=c.FontStyle.Underline);let h=n.Font,p=e.GetTextRect(o);if(l.Color=n.BackgroundColor,l.Color!=d.Color.Empty&&t.FillRectangle(l,p),e.IsShowRightText){e.CheckError_Type==s.CheckErrorType.None?l.Color=n.ForeColor:l.Color=d.Color.Red;const u=e.Document,c=null!=u?u.GetDocCtxt().EmrWorkMode:null;null!=c&&c==i.ENumWorkMode.Browse&&n.isDefaultForeColor&&(l.Color=r.TextDocInitInfo.GetInstance().BrowerForeColor);const f=a.DPITransUtil.TransFloatVal(h.SizeInPoints,72,96);let m=a.DPITransUtil.TransFloatVal(f,96,o),E=e.GetRowDrawDic();if(E.Count()>1){let n=A.CalcuteTextDrawPreY(e,p.Height/E.Count(),m);n<0&&(n=0);let r=new g.RectangleF(p.X,p.Y+n,p.Width,p.Height/E.Count());for(let n of E)t.DrawString(n.Value,h,l,r,e.DrawTxtFormat),r.Y+=p.Height/E.Count()}else{if(null==e.Caption)return;t.DrawString(e.Caption,h,l,p.X,p.Y,e.DrawTxtFormat)}}}static CalcuteTextDrawPreY(e,t,n){let r,i=e.GetVAlgin();switch(i==u.ENumVAlignStyle.NONE&&(i=o.StyleVAlignVals.GetEnumVAlign(e.VAlign_Mark)),i){case u.ENumVAlignStyle.NONE:case u.ENumVAlignStyle.MIDDLE:r=(t-n)/2;break;case u.ENumVAlignStyle.TOP:r=0;break;default:r=t-n}return r}}t.XRadioBoxPainter=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XMedicalExpressionUtil=void 0;const r=n(229),i=n(35);class l{static GetSuitWidth(e,t,n){let r;switch(e){case"FourValues1":return r=l.GetRenderMenses2SuitWidth(t,n),r;case"FourValues2":return r=l.GetRenderMenses3SuitWidth(t,n),r;case"ThreeValues":return r=l.GetRenderMenses4SuitWidth(t,n),r;case"Pupil":return r=l.GetPupilSuitWidth(t,n),r;case"FetalHeart":return r=l.GetFetalHeartSuitWidth(t,n),r;case"LightPositioning":return r=l.GetLightLocationSuitWidth(t,n),r;case"PainIndex":return r=-1,r}return r=l.GetRenderMenses1SuitWidth(t,n),r}static GetLightLocationSuitWidth(e,t){let n,s=r.MedExpressionFactory.GetInstance().GetLightLocationInfo(e);if(null==s)n=0;else{let e=i.CommDefines.MeasureText(s.PupilPhtotValueFirst,t),r=i.CommDefines.MeasureText(s.PupilPhtotValueFourth,t),o=i.CommDefines.MeasureText(s.PupilPhtotValueSeventh,t),a=l.GetMaxWidth([e,r,o]),u=i.CommDefines.MeasureText(s.PupilPhtotValueSecond,t),h=i.CommDefines.MeasureText(s.PupilPhtotValueFifth,t),d=i.CommDefines.MeasureText(s.PupilPhtotValueEighth,t),c=l.GetMaxWidth([u,h,d]),p=i.CommDefines.MeasureText(s.PupilPhtotValueThird,t),f=i.CommDefines.MeasureText(s.PupilPhtotValueSixth,t),g=i.CommDefines.MeasureText(s.PupilPhtotValueNinth,t);n=a+c+l.GetMaxWidth([p,f,g])+16}return n}static GetFetalHeartSuitWidth(e,t){let n,s=r.MedExpressionFactory.GetInstance().GetFetalHeartInfo(e);if(null==s)n=0;else{let e=i.CommDefines.MeasureText(s.PupilPhtotValueFirst,t),r=i.CommDefines.MeasureText(s.PupilPhtotValueThird,t),o=i.CommDefines.MeasureText(s.PupilPhtotValueFifth,t),a=l.GetMaxWidth([e,r,o]),u=i.CommDefines.MeasureText(s.PupilPhtotValueSecond,t),h=i.CommDefines.MeasureText(s.PupilPhtotValueFourth,t),d=i.CommDefines.MeasureText(s.PupilPhtotValueSixth,t);n=a+l.GetMaxWidth([u,h,d])+16}return n}static GetPupilSuitWidth(e,t){let n,s=r.MedExpressionFactory.GetInstance().GetPupilPhotoInfo(e);if(null==s)n=0;else{let e=i.CommDefines.MeasureText(s.PupilPhtotValueFirst,t),r=i.CommDefines.MeasureText(s.PupilPhtotValueThird,t),o=i.CommDefines.MeasureText(s.PupilPhtotValueSixth,t),a=l.GetMaxWidth([e,r,o]),u=i.CommDefines.MeasureText(s.PupilPhtotValueFourth,t),h=i.CommDefines.MeasureText(s.PupilPhtotValueSecond,t),d=i.CommDefines.MeasureText(s.PupilPhtotValueFifth,t),c=i.CommDefines.MeasureText(s.PupilPhtotValueSeventh,t),p=l.GetMaxWidth([h,d,c]);n=a+u.Width+p+16}return n}static GetRenderMenses4SuitWidth(e,t){let n,s=r.MedExpressionFactory.GetInstance().GetMensesExpression4(e);if(null==s)n=0;else{let e=i.CommDefines.MeasureText("/",t),r=i.CommDefines.MeasureText(s.FirstMenstruationAge,t),o=i.CommDefines.MeasureText(s.MenstruationCycle,t),a=i.CommDefines.MeasureText(s.Cycle,t),u=l.GetMaxWidth([o,a]);n=r.Width+e.Width+u+16}return n}static GetRenderMenses3SuitWidth(e,t){let n,s=r.MedExpressionFactory.GetInstance().GetMensesExpression3(e);if(null==s)n=0;else{let e=i.CommDefines.MeasureText(s.FirstMenstruationAge,t),r=i.CommDefines.MeasureText(s.EndMenstruationAge,t),o=i.CommDefines.MeasureText(s.MenstruationCycle,t),a=i.CommDefines.MeasureText(s.Cycle,t);n=3*l.GetMaxWidth([e,r,o,a])+16}return n}static GetRenderMenses2SuitWidth(e,t){let n,s=r.MedExpressionFactory.GetInstance().GetMensesExpression2(e);if(null==s)n=0;else{let e=i.CommDefines.MeasureText(s.FirstMenstruationAge,t),r=i.CommDefines.MeasureText(s.EndMenstruationAge,t),o=i.CommDefines.MeasureText(s.MenstruationCycle,t),a=i.CommDefines.MeasureText(s.Cycle,t),u=l.GetMaxWidth([e,r]),h=l.GetMaxWidth([o,a]);n=2*Math.max(u,h)+16}return n}static GetRenderMenses1SuitWidth(e,t){let n,l=r.MedExpressionFactory.GetInstance().GetMensesExpression(e);if(null==l)n=0;else{let e=i.CommDefines.MeasureText(l.FirstMenstruationAge,t),r=l.Cycle.length>l.MenstruationCycle.length?l.Cycle:l.MenstruationCycle,s=i.CommDefines.MeasureText(r,t),o=i.CommDefines.MeasureText(l.EndMenstruationAge,t);n=e.Width+s.Width+o.Width+16}return n}static GetMaxWidth(e){let t=0;for(let n=0;n<e.length;n++){let r=e[n];t<r.Width&&(t=r.Width)}return t}}t.XMedicalExpressionUtil=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XViewFactory=void 0;const r=n(0),i=n(6),l=n(4),s=n(161);t.XViewFactory=class{constructor(e){}static CrtXView(e){if(l.default.IsNullOrEmpty(e))return null;let t=null;return null!=e&&("XTextHeader"==e&&(t=new r.XPagePanelView(i.ENumPagePanelTp.Header),t.EleStyle=s.XEleStyleFactory.CreatXEleStyle(t.EleTypeName)),"XTextFooter"==e&&(t=new r.XPagePanelView(i.ENumPagePanelTp.Footer),t.EleStyle=s.XEleStyleFactory.CreatXEleStyle(t.EleTypeName)),"XTextBody"==e&&(t=new r.XPagePanelView(i.ENumPagePanelTp.Body),t.EleStyle=s.XEleStyleFactory.CreatXEleStyle(t.EleTypeName)),"XTextTable"==e&&(t=new r.XTextTableView),"XTextTableCell"==e&&(t=new r.XTextTableCellView)),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableViewBuilder=void 0;const r=n(3),i=n(0),l=n(931),s=n(932),o=n(122),a=n(10),u=n(9);class h extends o.XBaseViewBuilder{constructor(){super(...arguments),this.arrCellsMergeInfo=null,this.rowMergedCellViewBuilder=new o.TableCellViewBuilder(!0),this.hideCellViewMerger=new s.TableHiddenCellMerger}AfterBuildView(e,t){super.AfterBuildView(e,t);let n=e;if(this._BuildRowMergeCellViews_TableBeginLines(n),this._BuildRowMergeCellViews_TableEndLines(n),null!=n&&n instanceof i.XTextTableView){const e=n.Bounds.Height,t=n.Bounds.Width,r=a.DPITransUtil.TransIntVal(e,300,96),i=a.DPITransUtil.TransIntVal(t,300,96);n.SetSizeDISP(i,r)}}_Init_ViewProps(e,t,n){let r=t;r.CopyFrom(e,!1,!1,!0),r.FromRowIx=n,r.BaseTable=e,super._Init_ViewProps(e,t,n)}_BuildRowMergeCellViews_TableBeginLines(e){if(!((null==e?0:e.LinesCnt)>0))return;if(!((null==this.arrCellsMergeInfo?0:this.arrCellsMergeInfo.length)>0))return;let t=e.GetFirstLine(),n=e.GetLinesIter();for(;n.MoveNext();){let e=0,t=0,r=n.Current.GetElesIter();for(;r.MoveNext();){let n=this.arrCellsMergeInfo[e];if(n.HasMoreCtnt()){let l=r.Current instanceof i.XTextTableCell?r.Current:null;if(l instanceof i.XTextTableCellView&&(l=l.BaseCell),null==l)e++;else{let r=!1;l.Visible?l==n.MainCell&&(r=!0,n.AddSumRowHeightMergedCells(l.Height)):(r=!0,n.AddSumRowHeightMergedCells(l.OwnerLine.Height),t++),r&&null==n.ReplaceCell&&(n.ReplaceCell=l),e++}}else e++}if(t<=0)break}this._BuildMergedCellsAndReplace(t,!1),this._BuildMergeHiddenCellsAndReplace(t)}_BuildRowMergeCellViews_TableEndLines(e){let t=null==e?0:e.LinesCnt;if(t>0){let n=e.NumOfColumns;this._Init_CellsMergeInfoArr(n);let l=new Array(n),s=new r.List,o=e.GetLinesArray();for(let e=t-1;e>=0;e--){let t=o[e],n=0,r=0,a=t.GetElesIter();for(;a.MoveNext();){let e=this.arrCellsMergeInfo[n];if(e.IsColScanEnd){n++;continue}let o=a.Current instanceof i.XTextTableCell?a.Current:null;null!=o?o instanceof i.XTextTableCellView&&!o.Visible?(e.IsColScanEnd=!0,n++):o.Visible?(o.RowSpan>1&&(s.Contains(t)||s.Add(t),e.MainCell=o,e.FromMainLineIx=0,e.ReplaceCell=o,e.AddSumRowHeightMergedCells(o.OwnerLine.Height)),l[n]=o,e.IsColScanEnd=!0,n++):null!=l[n]&&o.MainMergeCell!=l[n]?(e.IsColScanEnd=!0,n++):(e.AddSumRowHeightMergedCells(o.OwnerLine.Height),l[n]=o.MainMergeCell,r++,n++):(e.IsColScanEnd=!0,n++)}if(r<=0)break}s.ToArray().forEach(e=>{this._BuildMergedCellsAndReplace(e,!0)})}}_BuildMergedCellsAndReplace(e,t){if(null!=e){let n=null==this.arrCellsMergeInfo?0:this.arrCellsMergeInfo.length;if(n>0)for(let r=0;r<n;r++){let n=this.arrCellsMergeInfo[r];if(n.HasMoreCtnt()&&(!t||n.LineOfReplaceCell==e)){let t=this._SplitRowMergedCell(n,n.FromMainLineIx);null!=t&&(e.ReplaceEleAtInx(r,t),n.ResetCellViewInfo())}}}}_BuildMergeHiddenCellsAndReplace(e){let t=null==e?0:e.ElementCnt;if(t>0){let n=null,r=e.GetAllEles();for(let l=0;l<t;l++){let t=r[l]instanceof i.XTextTableCell?r[l]:null;if(null!=t&&!(t.Visible||t instanceof i.XTextTableCellView)&&t.MainMergeCell!=n){n=t.MainMergeCell,this.hideCellViewMerger.TlCellHidden=t;let r=this.hideCellViewMerger.MergeCellView();null!=r&&e.ReplaceEleAtInx(l,r)}}}}_SplitRowMergedCell(e,t){t<0&&(t=0);let n=e.MainCell;if(null==n||t>=n.LinesCnt)return null;if(this.rowMergedCellViewBuilder.SrcEle=n,this.rowMergedCellViewBuilder.FromLineXDomIx=t,null==e.ReplaceCell)return null;let r=e.ReplaceCell.Bounds;const i=new u.RectangleF(r.X,r.Y,r.Width,r.Height);i.X=e.ReplaceCell.RealLeft,i.Y=e.ReplaceCell.RealTop,i.Height=2+e.SumRowHeightMergedCells;let l=this.rowMergedCellViewBuilder.BuildView(i);return e.FromMainLineIx=this.rowMergedCellViewBuilder.FromLineXDomIx,l.Height<e.SumRowHeightMergedCells&&l.SetSizeDPI(-1,e.SumRowHeightMergedCells,300),l}_Init_CellsMergeInfoArr(e){(null==this.arrCellsMergeInfo?0:this.arrCellsMergeInfo.length)!=e&&(this.arrCellsMergeInfo=new Array(e));for(let t=0;t<e;t++)null==this.arrCellsMergeInfo[t]&&(this.arrCellsMergeInfo[t]=new l.RowMergeCellSptInfo),this.arrCellsMergeInfo[t].IsColScanEnd=!1}}t.TableViewBuilder=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPagePanelViewBuilder=void 0;const r=n(122),i=n(380);class l extends r.XBaseViewBuilder{BuildPanelView(e){let t=super.SrcEle;if(t.LinesCnt<=0)return null;let n=t.GetColumnsParam(),r=null==n?0:n.ColsCnt;if(r<=1){return super.BuildView(e)}let l=null==n?0:n.GetGapWidth(0,300),s=e.Clone(),o=i.XViewFactory.CrtXView(t.EleTypeName);o.Document=this.xdoc,this._Init_ViewProps(t,o,-1);let a=0,u=0;for(let t=0;t<r;t++){let r=null==n?0:n.GetColWidth(0,300);s.Width=n.GetColWidth(t,300),s.Height=e.Height;let i=super.BuildView(s),h=this.CopyColViewLines(i,o,t,a);if(h<=0)break;h>u&&(u=h),a+=r+l,s.X+=r+l,s.Y=e.Y}return super._ReCalc_ViewRect_(o,u),o}CopyColViewLines(e,t,n,r){if(null==e||null==t)return 0;let i=0,l=e.GetLinesIter();for(;l.MoveNext();){let e=l.Current;e.ColInx=n,e.SetPositionDPI(r,-1,300),t.AddLine(e),i+=e.LineAssist.GetLineFullHeight(300,!0)}return e.ClearLines(!1,!1),i}}t.XPagePanelViewBuilder=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrPrintArgs=void 0;const r=n(384);class i extends r.QiPrintArgs{constructor(){super(...arguments),this.cleanPrt=!0,this.bulidQrCode=!0}get CleanPrt(){return this.cleanPrt}set CleanPrt(e){this.cleanPrt=e}get BulidQrCode(){return this.bulidQrCode}set BulidQrCode(e){this.bulidQrCode=e}get PrtIsHori(){return this._prtIsHori}set PrtIsHori(e){this._prtIsHori=e}get QrCodeBulidParaDic(){return this._QrCodeBulidParaDic}set QrCodeBulidParaDic(e){this._QrCodeBulidParaDic=e}}t.EmrPrintArgs=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENum_AlterPKeyTP=t.QiPrintArgs=void 0;const r=n(385),i=n(247),l=n(189),s=n(3),o=n(335),a=n(4),u=n(935),h=n(261),d=n(936),c=n(937),p=n(939),f=n(30);class g extends o.EventArgs{constructor(){super(),this.CustmPpSzNO="CustomQI",this.printer=null,this.prt_papersz_ext=null,this.prtdir=f.EnumPaperDir.None,this.paperFeedDir=f.EnumPaperDir.None,this.prtside=f.ENumPaperSide.None,this.prtcolor=f.ENumPrtColor.None,this.printer_fixed_offset=null,this.altertive_keytp=m.None,this.altertive_prterinfo_dict=null,this.zoomout_ratio=0,this.merge_row_cnt=f.MergeCnt.Unknown_Cnt,this.merge_col_cnt=f.MergeCnt.Unknown_Cnt,this.merge_prt_gap=new r.CLength(5),this.rel_tpl_qsz=null,this.showtip_docsz_changed=!1,this.tolandscape_biggerwidth=!1,this.doc_name=null,this.doc_pgcnt=0,this.reverse_evenpages_dblmanual=!0,this.prt_copies=1,this.docpage_rangs=null,this.prt_mode=null,this.printer=new d.PrinterInfo(null),this.prt_papersz_ext=new h.PaperSizeExt,this.printer_fixed_offset=new i.CLocation(0,0),this.rel_tpl_qsz=new l.CSize,this.docpage_rangs=new p.PrintPageRanges,this.prt_mode=new c.PrintModeArgs}clear(){this.printer.Clear(),this.prt_papersz_ext.clear(),this.printer_fixed_offset.setLocationAsMM(0,0),this.altertive_keytp=m.None,null!=this.altertive_prterinfo_dict&&this.altertive_prterinfo_dict.clear(),this.zoomout_ratio=0,this.merge_row_cnt=f.MergeCnt.Unknown_Cnt,this.merge_col_cnt=f.MergeCnt.Unknown_Cnt,this.showtip_docsz_changed=!1,this.tolandscape_biggerwidth=!1,this.doc_name=null,this.doc_pgcnt=0,this.reverse_evenpages_dblmanual=!0,this.prt_copies=1,this.docpage_rangs.clear(),this.prt_mode.ResetAll()}clearTplRelated(){this.prt_papersz_ext.clear(),this.merge_row_cnt=f.MergeCnt.Unknown_Cnt,this.merge_col_cnt=f.MergeCnt.Unknown_Cnt,this.doc_name=null,this.doc_pgcnt=0,this.docpage_rangs.clear()}setByPageFmt(e){if(null==e)return;this.PrtDir=e.Landscape?f.EnumPaperDir.Horizontal:f.EnumPaperDir.Vertical,this.PaperFeedDir=1==e.PaperFeedHoriz?f.EnumPaperDir.Horizontal:f.EnumPaperDir.Vertical;let t=new u.PageFmtPortrait(e);this.prt_papersz_ext.setPrtPaperSize3(e.PpSzNo,t.GetWidth(),t.GetHeight(),f.DefineDPI.Base_WinDPI)}mergeFrom(e){null!=e&&(null==this.printer?this.printer=e.printer:this.printer.MergeFrom(e.printer),this.prt_papersz_ext.copyFrom(e.prt_papersz_ext),f.EnumPaperDir.None!=e.prtdir&&(this.prtdir=e.prtdir),f.EnumPaperDir.None!=e.paperFeedDir&&(this.paperFeedDir=e.paperFeedDir),f.ENumPaperSide.None!=e.prtside&&(this.prtside=e.prtside),f.ENumPrtColor.None!=e.prtcolor&&(this.prtcolor=e.prtcolor),this.printer_fixed_offset.copyFrom(e.printer_fixed_offset),e.altertive_keytp!=m.None&&(this.altertive_keytp=e.altertive_keytp),null!=e.altertive_prterinfo_dict?(null==this.altertive_prterinfo_dict?this.altertive_prterinfo_dict=new Map:this.altertive_prterinfo_dict.clear(),e.altertive_prterinfo_dict.forEach((e,t)=>{this.altertive_prterinfo_dict.set(t,e)})):null!=this.altertive_prterinfo_dict&&this.altertive_prterinfo_dict.clear(),e.zoomout_ratio>0&&e.zoomout_ratio<=1&&(this.zoomout_ratio=e.zoomout_ratio),f.MergeCnt.Unknown_Cnt!=e.merge_col_cnt&&(this.merge_col_cnt=e.merge_col_cnt),f.MergeCnt.Unknown_Cnt!=e.merge_row_cnt&&(this.merge_row_cnt=e.merge_row_cnt),this.showtip_docsz_changed=e.showtip_docsz_changed,this.tolandscape_biggerwidth=e.tolandscape_biggerwidth,this.reverse_evenpages_dblmanual=e.reverse_evenpages_dblmanual,a.default.IsNullOrEmpty(e.doc_name)||(this.doc_name=e.doc_name),e.prt_copies>0&&(this.prt_copies=e.prt_copies),null!=e.docpage_rangs&&e.docpage_rangs.rangeCount()>0&&this.docpage_rangs.copyFrom(e.docpage_rangs),null!=e.prt_mode&&e.prt_mode.AllowedPrintMode!=f.ENumPrtMode.None&&this.prt_mode.copyFrom(e.prt_mode))}getMergePrtGap(e){return e<=0?this.merge_prt_gap.getLengthAsMM():this.merge_prt_gap.getLengthAsPX(e)}get PrinterName(){return this.printer.PrinterName}set PrinterName(e){this.printer.PrinterName=e}GetAlterPrinterKey(e){let t=null==e?null:e.DocArgs;if(null==t)return null;let n=null;switch(this.altertive_keytp){case m.DocName:n=t.DocName;break;case m.DocPath:n=t.DocPath;break;default:n=t.PaperName}let r=e.PageFormat;if(this.IsAltertedByPaperName()&&null!=r){if(r.IsStripOrPunchPaper)n=g.StripPpSzNO;else if(a.default.Equals(this.CustmPpSzNO,n)){let e=f.DefineDPI.MM_DPI/f.DefineDPI.Base_WinDPI,t=new u.PageFmtPortrait(r);n=n+"("+e*t.GetWidth()*e*t.GetHeight()+"mm)"}}return n}GetPrinter(e){if(a.default.IsNullOrEmpty(e))return this.printer;if((null==this.altertive_prterinfo_dict?0:this.altertive_prterinfo_dict.size)<=0)return this.printer;this.IsAltertedByPaperName()&&(e=e.toUpperCase());let t=null;return t=this.altertive_prterinfo_dict.get(e),null==t&&(t=this.printer),t}GetPrinterList(){let e=new s.List;e.Add(this.printer),null!=this.altertive_prterinfo_dict&&this.altertive_prterinfo_dict.forEach((t,n)=>{e.Add(t)});let t=e.ToArray();return e.Clear(),t}getPrtPaperSizeExt(){return this.prt_papersz_ext}get PrtDir(){return this.prtdir}set PrtDir(e){this.prtdir=e}get PaperFeedDir(){return this.paperFeedDir}set PaperFeedDir(e){this.paperFeedDir=e}get PrtSide(){return this.prtside}set PrtSide(e){this.prtside=e}IsPrtSide_Double(){return this.prtside==f.ENumPaperSide.DoubleManul||this.prtside==f.ENumPaperSide.DoubleAuto}get PrtColor(){return this.prtcolor}set PrtColor(e){this.prtcolor=e}get PrinterFixedOffset(){return this.printer_fixed_offset}get Altertive_KeyTp(){return m.None==this.altertive_keytp?m.PaperName:this.altertive_keytp}set Altertive_KeyTp(e){this.altertive_keytp=e}IsAltertedByPaperName(){return m.None==this.altertive_keytp||m.PaperName==this.altertive_keytp}AddAltertivePrinter(e,t){if(a.default.IsNullOrEmpty(e)||a.default.IsNullOrEmpty(t))return!1;if(this.IsAltertedByPaperName()&&(e=e.toUpperCase(),a.default.Equals(this.CustmPpSzNO.toUpperCase(),e)))return!1;null==this.altertive_prterinfo_dict&&(this.altertive_prterinfo_dict=new Map);let n=new d.PrinterInfo(t);return this.altertive_prterinfo_dict.delete(e),this.altertive_prterinfo_dict.set(e,n),!0}DelAltertivePrinter(e){a.default.IsNullOrEmpty(e)||null==this.altertive_prterinfo_dict||(this.IsAltertedByPaperName()&&(e=e.toUpperCase()),this.altertive_prterinfo_dict.delete(e))}ClearAltertivePrinters(){null!=this.altertive_prterinfo_dict&&this.altertive_prterinfo_dict.clear()}get ZoomoutRatio(){return this.zoomout_ratio}set ZoomoutRatio(e){e<=0||e>1||(this.zoomout_ratio=e)}setMergePrtColRowCnt(e,t){this.merge_col_cnt=e,this.merge_row_cnt=t}trySetDefaultMergePrtColRowCnt(){f.MergeCnt.Unknown_Cnt==this.merge_col_cnt&&(this.merge_col_cnt=1),f.MergeCnt.Unknown_Cnt==this.merge_row_cnt&&(this.merge_row_cnt=1)}getMergePrtColCnt(){return this.merge_col_cnt}getMergePrtRowCnt(){return this.merge_row_cnt}getRelTplSz(){return this.rel_tpl_qsz}get ShowtipOnDocSzChanged(){return this.showtip_docsz_changed}set ShowtipOnDocSzChanged(e){this.showtip_docsz_changed=e}get ToLandscape_BiggerWidth(){return this.tolandscape_biggerwidth}set ToLandscape_BiggerWidth(e){this.tolandscape_biggerwidth=e}NeedPreSwapCustWH(){if(!this.tolandscape_biggerwidth)return!1;if(this.PrtDir!=f.EnumPaperDir.Vertical)return!1;let e=this.prt_papersz_ext.getPrtPaperCalcSize();return!(e.getWidthAsMM()<=e.getHeightAsMM())}get Reverse_EvenPages_DblManual(){return this.reverse_evenpages_dblmanual}set Reverse_EvenPages_DblManual(e){this.reverse_evenpages_dblmanual=e}get DocName(){return this.doc_name}set DocName(e){this.doc_name=e}get DocPageCnt(){return this.doc_pgcnt}set DocPageCnt(e){this.doc_pgcnt=e}get PrtCopies(){return this.prt_copies}set PrtCopies(e){this.prt_copies=e<=0?1:e}getDocPageRanges(){return this.docpage_rangs}getPrtModeArgs(){return this.prt_mode}getPrtFromPos(){if(null==this.prt_mode)return null;return this.prt_mode.GetPageInnRange().FromPos}}var m;t.QiPrintArgs=g,g.StripPpSzNO="STRIP",g.CustmPpSzNO_CN="自定义",function(e){e[e.None=0]="None",e[e.PaperName=1]="PaperName",e[e.DocPath=2]="DocPath",e[e.DocName=3]="DocName"}(m=t.ENum_AlterPKeyTP||(t.ENum_AlterPKeyTP={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLength=void 0;const r=n(8),i=n(149);t.CLength=class{constructor(e){this.length_mm=0,this.conv=null,this.length_mm=e,this.conv=new i.MeasureConverter}isValid(){return this.length_mm>=0}copyFrom(e){null!=e&&(this.length_mm=e.length_mm)}getLengthAsMM(){return this.length_mm}setLengthAsMM(e){this.length_mm=e}addLengthAsMM(e){this.length_mm+=e}getLengthAsPX(e){return this.conv.ConvMmToPx(this.length_mm,e)}setLengthAsPX(e,t){this.length_mm=this.conv.ConvPxToMm(e,t)}addLengthAsPX(e,t){e=this.conv.ConvPxToMm(e,t),this.length_mm+=e}myCompareTo(e,t){let n;if(null==e)n=1;else{let r=this.length_mm-e.length_mm;n=0==r||r>=-t&&r<=t?0:r>t?1:-1}return n}isEqual(e){return this==e||r.CNumUtil.IsEqual(this.length_mm,e.length_mm,.01)}ToString(){return this.length_mm.toString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageInnRange=void 0;const r=n(249);t.PageInnRange=class{constructor(){this.fromPos=null,this.toPos=null,this.fromPos=new r.PageInnPoint,this.toPos=new r.PageInnPoint}get FromPos(){return this.fromPos}get ToPos(){return this.toPos}IsValid(){let e;if(this.fromPos.IsValid())if(this.toPos.IsValid()){e=!this.fromPos.IsEqualPot(this.toPos)}else e=!1;else e=!1;return e}InvalidRange(){this.toPos.PageIx=-1}Reset(){this.fromPos.Reset(),this.toPos.Reset()}TrySwapFromTo(){if(this.IsValid()){let e=!1;if(this.fromPos.PageIx>this.toPos.PageIx){let t=this.fromPos.PageIx;this.fromPos.PageIx=this.toPos.PageIx,this.toPos.PageIx=t,e=!0}if(e||(e=this.fromPos.PageIx==this.toPos.PageIx&&this.fromPos.PosInPage.YAsMM>this.toPos.PosInPage.YAsMM),e){let e=this.fromPos.PosInPage.YAsMM;this.fromPos.PosInPage.YAsMM=this.toPos.PosInPage.YAsMM,this.toPos.PosInPage.YAsMM=e}if(this.fromPos.PosInPage.XAsMM>this.toPos.PosInPage.XAsMM){let e=this.fromPos.PosInPage.XAsMM;this.fromPos.PosInPage.XAsMM=this.toPos.PosInPage.XAsMM,this.toPos.PosInPage.XAsMM=e}}}ContainsPot(e){let t;if(null!=e&&e.IsValid())if(this.IsValid()){let n=e.PageIx,r=this.fromPos.PageIx,i=this.toPos.PageIx;if(n<r||n>i)t=!1;else{let l=e.PosInPage.XAsMM,s=this.fromPos.PosInPage.XAsMM,o=this.toPos.PosInPage.XAsMM;if(l<s||l>o)t=!1;else{let l=e.PosInPage.YAsMM,s=this.fromPos.PosInPage.YAsMM,o=this.toPos.PosInPage.YAsMM;if(n==r){if(r==i){if(l<s||l>o)return t=!1,t}else if(l<s)return t=!1,t}else if(n==i&&l>o)return t=!1,t;t=!0}}}else t=!1;else t=!1;return t}copyFrom(e){null!=e&&(this.fromPos.copyFrom(e.fromPos,-1),this.toPos.copyFrom(e.toPos,-1))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageDrawArgs=void 0;const r=n(11);t.PageDrawArgs=class{constructor(e,t){this.outTp=r.ENumOutTp.Unknown,this.curLcPageIx=-1,this.zoomRatio=1,this.prtModeArgs=null,this.outTp=e,this.zoomRatio=t}get OutTp(){return this.outTp}set OutTp(e){this.outTp=e}get CurLcPageIx(){return this.curLcPageIx}set CurLcPageIx(e){this.curLcPageIx=e}get ZoomRatio(){return this.zoomRatio}set ZoomRatio(e){this.zoomRatio=e}get PrtModeArgs(){return this.prtModeArgs}set PrtModeArgs(e){this.prtModeArgs=e}}},function(e,t,n){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},function(e,t,n){e.exports=n(952)},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(61);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var l;if(n)l=n(t);else if(r.isURLSearchParams(t))l=t.toString();else{var s=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(i(t)+"="+i(e))})))})),l=s.join("&")}if(l){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+l}return e}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(61),i=n(959),l=n(960),s=n(391),o=n(961),a=n(964),u=n(965),h=n(394);e.exports=function(e){return new Promise((function(t,n){var d=e.data,c=e.headers,p=e.responseType;r.isFormData(d)&&delete c["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var g=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";c.Authorization="Basic "+btoa(g+":"+m)}var E=o(e.baseURL,e.url);function C(){if(f){var r="getAllResponseHeaders"in f?a(f.getAllResponseHeaders()):null,l={data:p&&"text"!==p&&"json"!==p?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:r,config:e,request:f};i(t,n,l),f=null}}if(f.open(e.method.toUpperCase(),s(E,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,"onloadend"in f?f.onloadend=C:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(C)},f.onabort=function(){f&&(n(h("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){n(h("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(h(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var A=(e.withCredentials||u(E))&&e.xsrfCookieName?l.read(e.xsrfCookieName):void 0;A&&(c[e.xsrfHeaderName]=A)}"setRequestHeader"in f&&r.forEach(c,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete c[t]:f.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),p&&"json"!==p&&(f.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),n(e),f=null)})),d||(d=null),f.send(d)}))}},function(e,t,n){"use strict";var r=n(392);e.exports=function(e,t,n,i,l){var s=new Error(e);return r(s,t,n,i,l)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var r=n(61);e.exports=function(e,t){t=t||{};var n={},i=["url","method","data"],l=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function a(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function u(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=a(void 0,e[i])):n[i]=a(e[i],t[i])}r.forEach(i,(function(e){r.isUndefined(t[e])||(n[e]=a(void 0,t[e]))})),r.forEach(l,u),r.forEach(s,(function(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=a(void 0,e[i])):n[i]=a(void 0,t[i])})),r.forEach(o,(function(r){r in t?n[r]=a(e[r],t[r]):r in e&&(n[r]=a(void 0,e[r]))}));var h=i.concat(l).concat(s).concat(o),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===h.indexOf(e)}));return r.forEach(d,u),n}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){var r;window,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}({"./src/index.js":function(e,t,n){"use strict";n.r(t),n("./src/sass/index.scss");var r=n("./src/js/init.js").default.init;"undefined"!=typeof window&&(window.printJS=r),t.default=r},"./src/js/browser.js":function(e,t,n){"use strict";n.r(t);var r={isFirefox:function(){return"undefined"!=typeof InstallTrigger},isIE:function(){return-1!==navigator.userAgent.indexOf("MSIE")||!!document.documentMode},isEdge:function(){return!r.isIE()&&!!window.StyleMedia},isChrome:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return!!e.chrome},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||-1!==navigator.userAgent.toLowerCase().indexOf("safari")},isIOSChrome:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("crios")}};t.default=r},"./src/js/functions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addWrapper",(function(){return s})),n.d(t,"capitalizePrint",(function(){return o})),n.d(t,"collectStyles",(function(){return a})),n.d(t,"addHeader",(function(){return h})),n.d(t,"cleanUp",(function(){return d})),n.d(t,"isRawHTML",(function(){return c}));var r=n("./src/js/modal.js"),i=n("./src/js/browser.js");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return'<div style="font-family:'+t.font+" !important; font-size: "+t.font_size+' !important; width:100%;">'+e+"</div>"}function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}function a(e,t){for(var n="",r=(document.defaultView||window).getComputedStyle(e,""),i=0;i<r.length;i++)(-1!==t.targetStyles.indexOf("*")||-1!==t.targetStyle.indexOf(r[i])||u(t.targetStyles,r[i]))&&r.getPropertyValue(r[i])&&(n+=r[i]+":"+r.getPropertyValue(r[i])+";");return n+="max-width: "+t.maxWidth+"px !important; font-size: "+t.font_size+" !important;"}function u(e,t){for(var n=0;n<e.length;n++)if("object"===l(t)&&-1!==t.indexOf(e[n]))return!0;return!1}function h(e,t){var n=document.createElement("div");if(c(t.header))n.innerHTML=t.header;else{var r=document.createElement("h1"),i=document.createTextNode(t.header);r.appendChild(i),r.setAttribute("style",t.headerStyle),n.appendChild(r)}e.insertBefore(n,e.childNodes[0])}function d(e){e.showModal&&r.default.close(),e.onLoadingEnd&&e.onLoadingEnd(),(e.showModal||e.onLoadingStart)&&window.URL.revokeObjectURL(e.printable);var t="mouseover";(i.default.isChrome()||i.default.isFirefox())&&(t="focus"),window.addEventListener(t,(function n(){window.removeEventListener(t,n),e.onPrintDialogClose();var r=document.getElementById(e.frameId);r&&r.remove()}))}function c(e){return new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>").test(e)}},"./src/js/html.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/js/functions.js"),i=n("./src/js/print.js");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.default={print:function(e,t){var n,s="object"===l(n=e.printable)&&n&&(n instanceof HTMLElement||1===n.nodeType)?e.printable:document.getElementById(e.printable);s?(e.printableElement=function e(t,n){for(var i=t.cloneNode(),l=Array.prototype.slice.call(t.childNodes),s=0;s<l.length;s++)if(-1===n.ignoreElements.indexOf(l[s].id)){var o=e(l[s],n);i.appendChild(o)}switch(n.scanStyles&&1===t.nodeType&&i.setAttribute("style",Object(r.collectStyles)(t,n)),t.tagName){case"SELECT":i.value=t.value;break;case"CANVAS":i.getContext("2d").drawImage(t,0,0)}return i}(s,e),e.header&&Object(r.addHeader)(e.printableElement,e),i.default.send(e,t)):window.console.error("Invalid HTML element id: "+e.printable)}}},"./src/js/image.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/js/functions.js"),i=n("./src/js/print.js"),l=n("./src/js/browser.js");t.default={print:function(e,t){e.printable.constructor!==Array&&(e.printable=[e.printable]),e.printableElement=document.createElement("div"),e.printable.forEach((function(t){var n=document.createElement("img");if(n.setAttribute("style",e.imageStyle),n.src=t,l.default.isFirefox()){var r=n.src;n.src=r}var i=document.createElement("div");i.appendChild(n),e.printableElement.appendChild(i)})),e.header&&Object(r.addHeader)(e.printableElement,e),i.default.send(e,t)}}},"./src/js/init.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/js/browser.js"),i=n("./src/js/modal.js"),l=n("./src/js/pdf.js"),s=n("./src/js/html.js"),o=n("./src/js/raw-html.js"),a=n("./src/js/image.js"),u=n("./src/js/json.js");function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var d=["pdf","html","image","json","raw-html"];t.default={init:function(){var e={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(e){throw e},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},t=arguments[0];if(void 0===t)throw new Error("printJS expects at least 1 attribute.");switch(h(t)){case"string":e.printable=encodeURI(t),e.fallbackPrintable=e.printable,e.type=arguments[1]||e.type;break;case"object":for(var n in e.printable=t.printable,e.fallbackPrintable=void 0!==t.fallbackPrintable?t.fallbackPrintable:e.printable,e.fallbackPrintable=e.base64?"data:application/pdf;base64,".concat(e.fallbackPrintable):e.fallbackPrintable,e)"printable"!==n&&"fallbackPrintable"!==n&&(e[n]=void 0!==t[n]?t[n]:e[n]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+h(t))}if(!e.printable)throw new Error("Missing printable information.");if(!e.type||"string"!=typeof e.type||-1===d.indexOf(e.type.toLowerCase()))throw new Error("Invalid print type. Available types are: pdf, html, image and json.");e.showModal&&i.default.show(e),e.onLoadingStart&&e.onLoadingStart();var c=document.getElementById(e.frameId);c&&c.parentNode.removeChild(c);var p=document.createElement("iframe");switch(r.default.isFirefox()?p.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):p.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),p.setAttribute("id",e.frameId),"pdf"!==e.type&&(p.srcdoc="<html><head><title>"+e.documentTitle+"</title>",e.css&&(Array.isArray(e.css)||(e.css=[e.css]),e.css.forEach((function(e){p.srcdoc+='<link rel="stylesheet" href="'+e+'">'}))),p.srcdoc+="</head><body></body></html>"),e.type){case"pdf":if(r.default.isIE())try{var f=window.open(e.fallbackPrintable,"_blank");f.focus(),e.onIncompatibleBrowser()}catch(t){e.onError(t)}finally{e.showModal&&i.default.close(),e.onLoadingEnd&&e.onLoadingEnd()}else l.default.print(e,p);break;case"image":a.default.print(e,p);break;case"html":s.default.print(e,p);break;case"raw-html":o.default.print(e,p);break;case"json":u.default.print(e,p)}}}},"./src/js/json.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/js/functions.js"),i=n("./src/js/print.js");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.default={print:function(e,t){if("object"!==l(e.printable))throw new Error("Invalid javascript data object (JSON).");if("boolean"!=typeof e.repeatTableHeader)throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!e.properties||!Array.isArray(e.properties))throw new Error("Invalid properties array for your JSON data.");e.properties=e.properties.map((function(t){return{field:"object"===l(t)?t.field:t,displayName:"object"===l(t)?t.displayName:t,columnSize:"object"===l(t)&&t.columnSize?t.columnSize+";":100/e.properties.length+"%;"}})),e.printableElement=document.createElement("div"),e.header&&Object(r.addHeader)(e.printableElement,e),e.printableElement.innerHTML+=function(e){var t=e.printable,n=e.properties,i='<table style="border-collapse: collapse; width: 100%;">';e.repeatTableHeader&&(i+="<thead>"),i+="<tr>";for(var l=0;l<n.length;l++)i+='<th style="width:'+n[l].columnSize+";"+e.gridHeaderStyle+'">'+Object(r.capitalizePrint)(n[l].displayName)+"</th>";i+="</tr>",e.repeatTableHeader&&(i+="</thead>"),i+="<tbody>";for(var s=0;s<t.length;s++){i+="<tr>";for(var o=0;o<n.length;o++){var a=t[s],u=n[o].field.split(".");if(u.length>1)for(var h=0;h<u.length;h++)a=a[u[h]];else a=a[n[o].field];i+='<td style="width:'+n[o].columnSize+e.gridStyle+'">'+a+"</td>"}i+="</tr>"}return i+="</tbody></table>"}(e),i.default.send(e,t)}}},"./src/js/modal.js":function(e,t,n){"use strict";n.r(t);var r={show:function(e){var t=document.createElement("div");t.setAttribute("style","font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;"),t.setAttribute("id","printJS-Modal");var n=document.createElement("div");n.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var i=document.createElement("div");i.setAttribute("class","printClose"),i.setAttribute("id","printClose"),n.appendChild(i);var l=document.createElement("span");l.setAttribute("class","printSpinner"),n.appendChild(l);var s=document.createTextNode(e.modalMessage);n.appendChild(s),t.appendChild(n),document.getElementsByTagName("body")[0].appendChild(t),document.getElementById("printClose").addEventListener("click",(function(){r.close()}))},close:function(){var e=document.getElementById("printJS-Modal");e&&e.parentNode.removeChild(e)}};t.default=r},"./src/js/pdf.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/js/print.js"),i=n("./src/js/functions.js");function l(e,t,n){var i=new window.Blob([n],{type:"application/pdf"});i=window.URL.createObjectURL(i),t.setAttribute("src",i),r.default.send(e,t)}t.default={print:function(e,t){if(e.base64){var n=Uint8Array.from(atob(e.printable),(function(e){return e.charCodeAt(0)}));l(e,t,n)}else{e.printable=/^(blob|http|\/\/)/i.test(e.printable)?e.printable:window.location.origin+("/"!==e.printable.charAt(0)?"/"+e.printable:e.printable);var r=new window.XMLHttpRequest;r.responseType="arraybuffer",r.addEventListener("error",(function(){Object(i.cleanUp)(e),e.onError(r.statusText,r)})),r.addEventListener("load",(function(){if(-1===[200,201].indexOf(r.status))return Object(i.cleanUp)(e),void e.onError(r.statusText,r);l(e,t,r.response)})),r.open("GET",e.printable,!0),r.send()}}}},"./src/js/print.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/js/browser.js"),i=n("./src/js/functions.js"),l={send:function(e,t){document.getElementsByTagName("body")[0].appendChild(t);var n=document.getElementById(e.frameId);n.onload=function(){if("pdf"!==e.type){var t=n.contentWindow||n.contentDocument;if(t.document&&(t=t.document),t.body.appendChild(e.printableElement),"pdf"!==e.type&&e.style){var i=document.createElement("style");i.innerHTML=e.style,t.head.appendChild(i)}var l=t.getElementsByTagName("img");l.length>0?function(e){var t=e.map((function(e){if(e.src&&e.src!==window.location.href)return function(e){return new Promise((function(t){!function n(){e&&void 0!==e.naturalWidth&&0!==e.naturalWidth&&e.complete?t():setTimeout(n,500)}()}))}(e)}));return Promise.all(t)}(Array.from(l)).then((function(){return s(n,e)})):s(n,e)}else r.default.isFirefox()?setTimeout((function(){return s(n,e)}),1e3):s(n,e)}}};function s(e,t){try{if(e.focus(),r.default.isEdge()||r.default.isIE())try{e.contentWindow.document.execCommand("print",!1,null)}catch(t){e.contentWindow.print()}else e.contentWindow.print()}catch(e){t.onError(e)}finally{r.default.isFirefox()&&(e.style.visibility="hidden",e.style.left="-1px"),Object(i.cleanUp)(t)}}t.default=l},"./src/js/raw-html.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/js/print.js");t.default={print:function(e,t){e.printableElement=document.createElement("div"),e.printableElement.setAttribute("style","width:100%"),e.printableElement.innerHTML=e.printable,r.default.send(e,t)}}},"./src/sass/index.scss":function(e,t,n){},0:function(e,t,n){e.exports=n("./src/index.js")}}).default},e.exports=r()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutlineAddDelUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t,n){super(),this.outlineList=null,this.paraghFlag=null,this.isAdd=!0,this.paraghFlag=e,this.outlineList=t,this.isAdd=n}IsValid(){return null!=this.paraghFlag&&null!=this.outlineList}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){this.CanUndo()&&(this.isAdd?this.outlineList.Remove(this.paraghFlag,!0):this.outlineList.Add(this.paraghFlag))}Redo(){this.CanRedo()&&(this.isAdd?this.outlineList.Add(this.paraghFlag):this.outlineList.Remove(this.paraghFlag,!0))}Clear(){this.paraghFlag=null,this.outlineList=null}}t.OutlineAddDelUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoveEmptyLineUtil=void 0;const r=n(44),i=n(0),l=n(88),s=n(3);class o{static TryClearCurrLine(e,t){let n;if(this.removeReason="",o.CanRemove(e,t)){let r=t.LinesCnt,s=e.GetAllEles();if(null==s||0==s.length)n=!1;else{if("IsAll_SpaceEleAndBorderEle_BesidesPara"==this.removeReason){let t=e.RelEleParagraph,n=o.FindPrevParagh(e.RelEleParagraph);if(n.Parent instanceof l.XInputEle){let e=n.Parent;null!=e&&r>1&&e.RemoveChild(n)}if(t.Parent instanceof l.XInputEle){if(t.Parent.RemoveChild(t),null==t.Parent||i.XDomUtil.IsEleRemoved(t.Parent,!0)||i.XDomUtil.HasContent(t.Parent,!0))return!0;let e=t.Parent.GetBackTextXStrEle();if(null==e)return!0;let n=i.XDomUtil.GetXInputCtntChildIx(t.Parent);t.Parent.AddChildEle(n,e),t.Parent.EleStyle.isDefaultForeColor=!0,t.Parent.EleStyle.isDefaultBackgroundColor=!0}}else{let e=s,t=0;for(;t<e.length;){let n=e[t];t++;let r=n.Parent;if(null!=r){if(n instanceof i.XParagraphFlag&&n.IsElement)continue;if(r instanceof i.XTextTableCell&&n instanceof i.XParagraphFlag&&r.ChildCount<2)break;r.RemoveChild(n)}}}n=!0}}else n=!1;return n}static CanRemove(e,t){this.removeReason="None";let n,r=o.GetLineEleTypeList(e);if(null==r)n=!1;else{let i=!0,l=!0;if(1==r.Count()&&"XParagraphFlag"==r.Get(0)){this.removeReason="IsOnly_ParaFlagEle";let r=t.GetLastChildEle(),i=e.RelEleParagraph,l=o.FindPrevParagh(i);if(null!=i&&i.Equals(r))return n=null!=l,n;n=!0}else{for(let e=0;e<r.Length;e++){let t=r.Get(e);if("XLableInputBorder"==t)i=!1;else if("XCharacterEle_Space"!=t&&"XParagraphFlag"!=t){i=!1,l=!1;break}}i?(this.removeReason="IsAll_SpaceEle_BesidesPara",n=!0):l?(this.removeReason="IsAll_SpaceEleAndBorderEle_BesidesPara",n=!0):n=!1}}return n}static FindPrevParagh(e){let t,n=r.TextDocApiUtil.GetElesByEleType(e.Document,["XParagraphFlag"]);if(null==n||0==n.Count())t=null;else{let r=n.IndexOf(e);t=r<=0?null:n.Get(r-1)instanceof i.XParagraphFlag?n.Get(r-1):null}return t}static GetLineEleTypeList(e){let t;if(null==e)t=null;else{let n=e.GetAllEles();if(null==n||0==n.length)t=null;else{let e=new s.List,r=n;for(let t=0;t<r.length;t++){let n=r[t],i=n.EleTypeName,l=n;null!=l&&" "==l.ChVal&&(i="XCharacterEle_Space"),e.Contains(i)||e.Add(i)}t=e}}return t}}t.RemoveEmptyLineUtil=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XEleGroupInfo=void 0;t.XEleGroupInfo=class{constructor(){this._QuoteSource=!1,this._QuoteTarget=!1,this.IsShowText=!0}get XID(){return this._XID}set XID(e){this._XID=e}get GrpID(){return this._GrpID}set GrpID(e){this._GrpID=e}get TipText(){return this._TipText}set TipText(e){this._TipText=e}get ValueCode_de(){return this._ValueCode_de}set ValueCode_de(e){this._ValueCode_de=e}get SourceName(){return this._SourceName}set SourceName(e){this._SourceName=e}get PropName(){return this._PropName}set PropName(e){this._PropName=e}get Name(){return this._Name}set Name(e){this._Name=e}get CanDel(){return this._CanDel}set CanDel(e){this._CanDel=e}get IsHide(){return this._IsHide}set IsHide(e){this._IsHide=e}get IsMustChoose(){return this._IsMustChoose}set IsMustChoose(e){this._IsMustChoose=e}get EleShowText(){return this._EleShowText}set EleShowText(e){this._EleShowText=e}get EleValue(){return this._EleValue}set EleValue(e){this._EleValue=e}get OnlyPrintCheckedItem(){return this._OnlyPrintCheckedItem}set OnlyPrintCheckedItem(e){this._OnlyPrintCheckedItem=e}get IsShowText(){return this._IsShowText}set IsShowText(e){this._IsShowText=e}get IsTextRightShow(){return this._IsTextRightShow}set IsTextRightShow(e){this._IsTextRightShow=e}get Grp_IsStrongShow(){return this._Grp_IsStrongShow}set Grp_IsStrongShow(e){this._Grp_IsStrongShow=e}get BaseChoiceShowStyle(){return this._BaseChoiceShowStyle}set BaseChoiceShowStyle(e){this._BaseChoiceShowStyle=e}get Text_Expression(){return this._Text_Expression}set Text_Expression(e){this._Text_Expression=e}get VAlign(){return this._VAlign}set VAlign(e){this._VAlign=e}get CanBeInLine_StartBorder(){return this._CanBeInLine_StartBorder}set CanBeInLine_StartBorder(e){this._CanBeInLine_StartBorder=e}get CanBeInLine_EndBorder(){return this._CanBeInLine_EndBorder}set CanBeInLine_EndBorder(e){this._CanBeInLine_EndBorder=e}get Name_de(){return this._Name_de}set Name_de(e){this._Name_de=e}get conceptDomainCode(){return this._conceptDomainCode}set conceptDomainCode(e){this._conceptDomainCode=e}get ExtendAttr1(){return this._extendAttr1}set ExtendAttr1(e){this._extendAttr1=e}get IsPrint(){return this._isPrint}set IsPrint(e){this._isPrint=e}get LackEllipsisvalue(){return this._lackEllipsisvalue}get QuoteSource(){return this._QuoteSource}set QuoteSource(e){this._QuoteSource=e}get QuoteTarget(){return this._QuoteTarget}set QuoteTarget(e){this._QuoteTarget=e}set LackEllipsisvalue(e){this._lackEllipsisvalue=e}get DynamicData(){return this._dynamicData}set DynamicData(e){this._dynamicData=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestDesignerUtil=void 0;class r{static getKeyObj(){var e=window.location.href.split("?")[1],t=e?e.split("&"):null,n={};if(t){for(var r=0;r<t.length;r++){var i=t[r].split("="),l=i[0],s=i[1];n[l]=s}return n}}static PostMessage(e){if(e.length>0){let t={type:e[0],param:e[1],key:r.getKeyObj()};parent.postMessage(t,"*")}}}t.RequestDesignerUtil=r,r.protocol=window.location.protocol,r.host=window.location.host,r.pathName="/"+window.location.pathname.split("/")[1]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocIOInfoFactory=void 0;const r=n(2),i=n(0),l=n(3),s=n(351),o=n(111),a=n(345),u=n(21),h=n(4);class d{static CrtNewXDoc(e){let t=d.CloseXDocs(e);if(null!=t&&t.IsWarnMsg())return s.CommDefinesExt.ShowMsg(t),null;let n=d._Get_XDocIOInfoList(e,!0);if(null==n||n.Count()<=0)return null;let r=n.Get(0);return r.CrtNewXDoc(),r.XDocument}static LoadXDoc(e,t){let n=d.CloseXDocs(e);if(null!=n&&n.IsWarnMsg())return s.CommDefinesExt.ShowMsg(n),null;let r=d._Get_XDocIOInfoList(e,!0);if(null==r||r.Count()<=0)return null;t.LineToPrint=!1;let i=r.Get(0),l=i.LoadXDoc(!1,t);return s.CommDefinesExt.ShowMsg(l),i.XDocument}static AppendXDoc(e,t,n){let r=d._Get_XDocIOInfoList(e,!1);null==r&&(r=new l.List,d.cvsXDocsDict.Set(e,r));let i=new a.XDocIOInfo;null!=n?r.Insert(n,i):r.Add(i),t.LineToPrint=!1;let o=i.LoadXDoc(!1,t);return s.CommDefinesExt.ShowMsg(o),i.XDocument}static ReplaceXDoc(e,t,n){let r=d._Get_XDocIOInfoList(e,!1);null==r&&(r=new l.List,d.cvsXDocsDict.Set(e,r));let i=new a.XDocIOInfo;t.LineToPrint=!1;let o=i.LoadXDoc(!1,t);i.XDocument.DocID=n,s.CommDefinesExt.ShowMsg(o);for(let e=0;e<r.Length;e++){let t=r.Get(e);t.XDocument.DocID==n&&(i.XDocument.IsEditable=t.XDocument.IsEditable,i.XDocument.UnEditableColor=t.XDocument.UnEditableColor,i.XDocument.NewPage=t.XDocument.NewPage,i.XDocument.TopMarginFlag=t.XDocument.TopMarginFlag,i.XDocument.TopMargin=t.XDocument.TopMargin,r.Set(e,i))}return i.XDocument}static LoadXDocs(e,t){let n=null==t?0:t.length;if(n<=0)return null;let r=d.CloseXDocs(e);if(null!=r&&r.IsWarnMsg())return s.CommDefinesExt.ShowMsg(r),null;let i=new Array(n);for(let r=0;r<n;r++)if(null!=t[r].xdocLoadParam&&t[r].xdocLoadParam.IsValid()){let n=d._Get_XDocIOInfoList(e,!1);null==n&&(n=new l.List,d.cvsXDocsDict.Set(e,n));let o=new a.XDocIOInfo,u=o.LoadXDoc(!1,t[r].xdocLoadParam);o.XDocument.DocID=t[r].docId,o.XDocument.NewPage=!0,i[r]=o.XDocument,null!=o.XDocument&&n.Add(o),s.CommDefinesExt.ShowMsg(u)}return i}static SaveXDocs(e,t=r.ENumXDocPath.UnKnown,n){let i=d._Get_XDocIOInfoList(e,!1);if((null==i?0:i.Length)<=0)return null;let s=[];if(n.length>0)for(let e=0;e<n.length;e++){let t=n[e];s.push(t.docId)}let o=new l.List;for(let e of i){let t=null,n=e.XDocument;if(s.length>0&&-1==s.indexOf(n.DocID))continue;let r=e.SaveXDoc();t=r.IsWarnMsg()?null:r.ReturnParams;let i={docId:n.DocID,xml:t};o.Add(i)}let a=o.ToArray();return o.Clear(),a}static CloseXDocByDocId(e,t){let n=d._Get_XDocIOInfoList(e,!1);for(let e of n){e.XDocument.DocID==t&&n.Remove(e)}if(0==n.Length){d.cvsXDocsDict.Remove(e),d._Get_XDocIOInfoList(e,!0).Get(0).CrtNewXDoc()}}static CloseXDocs(e){let t,n=new o.ResMessage,r=d._Get_XDocIOInfoList(e,!1),i=null==r?0:r.Length;if(i<=0)return n.MsgLevel=5,n.MsgStr="没有打开文档，终止关闭操作。",n;let s=new l.List,a=new u.default;for(let e=0;e<i;e++){let t=r.Get(e);t.CloseXDoc()||(s.Add(t),a.append("-- "),a.append(t.BuildAsString()),a.append("\r\n"))}return r.Clear(),s.Count()>0?(r.AddRange(s),s.Clear(),n.MsgLevel=2,n.MsgStr=a.toString(),a.setLengthToZero(),t=n):(d.cvsXDocsDict.Remove(e),t=n),t}static GetXDocsLoaded(e){let t=d._Get_XDocIOInfoList(e,!1);if((null==t?0:t.Count)<=0)return null;let n=[],r=0;return t.ToArray().forEach(e=>{n[r++]=e.XDocument}),n}static GetXDocsWrapLoaded(e){let t=d._Get_XDocIOInfoList(e,!1);if(null==t)return null;let n=t.ToArray();return d.AutoWrapXDocs(n)}static AutoWrapXDocs(e){let t=null==e?0:e.length;if(t<=0)return null;let n=new l.List,r=null,s=null;for(let l=0;l<t;l++){let t=e[l];null!=t&&null!=t.XDocument&&(null==s||t.XDocument.NewPage?(s=new i.XTextDocumentsWrap(t.XDocument),n.Add(s)):s.AddXDoc(t.XDocument),r=t)}let o=n.ToArray();return n.Clear(),o}static GetXDocsCntLoaded(e){let t=d._Get_XDocIOInfoList(e,!1);return null==t?0:t.Count()}static _Get_XDocIOInfoList(e,t){if(h.default.IsNullOrEmpty(e))return null;if(d.cvsXDocsDict.ContainsKey(e))return d.cvsXDocsDict.Get(e);if(t){let t=new l.List,n=new a.XDocIOInfo;return t.Add(n),d.cvsXDocsDict.Set(e,t),t}}}t.XDocIOInfoFactory=d,d.cvsXDocsDict=new l.Dictionary},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AEleSelectBeforeLayout=void 0;const r=n(2),i=n(0),l=n(29),s=n(17),o=n(69),a=n(1107);class u extends o.AbstractHandlerLayer{constructor(e){super(e),this._canWakeNextLayer=!0,this.wakePosInEle=s.PointF.Empty}CanWakeNextLayer(){return this._canWakeNextLayer}CanWakeBySrc(e,t){return(e&l.Keys.Shift)!=l.Keys.Shift&&t==r.ENumEvtSrc.MOUSE_LPRESS}TryWake(e,t){let n;if(this.isWaken)n=!0;else{super.TryWake(e,t);let r=null==this.eleEvtModel?null:this.eleEvtModel.EleClicked;null!=r&&i.XDomUtil.IsOwnXDocPanelEditable(r)?(this.wakePosInEle.X=e,this.wakePosInEle.Y=t,super.CalcPosInEle(r,!0,this.wakePosInEle),this.isWaken=!0,n=this.isWaken):n=!1}return n}Handle(e,t,n){this._canWakeNextLayer=!0;let r=this.eleEvtModel.EleClicked,l=this._CanReSelect(r),s=r==this.eleEvtModel.LastEleClicked;if((l||!s)&&r instanceof i.XButtonEle){this._canWakeNextLayer=!1;let e=r;this._BtnEleClick(this.xdocEditor,e)}}_CanReSelect(e){return e instanceof i.XBaseChoiceEle||e instanceof i.XButtonEle}_BtnEleClick(e,t){if(null!=t){(new a.XButtonEle_EvtHandler).OnMouseClick(e,t)}}}t.AEleSelectBeforeLayout=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoNearSelRangeLayer=void 0;const r=n(2),i=n(0),l=n(69);class s extends l.AbstractHandlerLayer{constructor(e){super(e),this._xdocEditor=e}CanWakeBySrc(e,t){return t==r.ENumEvtSrc.MOUSE_DBLCLICK}CanWakeNextLayer(){let e=this._xdocEditor.M_EleEvtModel.EleClicked;return null!=i.XDomUtil.GetParentXInput(e,!1)||super.CanWakeNextLayer()}TryWake(e,t){let n;if(this.isWaken)n=!0;else{super.TryWake(e,t);let r=null==this.eleEvtModel?null:this.eleEvtModel.EleMOver,l=null==this.eleEvtModel?null:this.eleEvtModel.EleClicked instanceof i.XCharacterEle?this.eleEvtModel.EleClicked:null;null!=l&&l==r&&i.XDomUtil.IsOwnXDocPanelEditable(l)?(this.isWaken=!0,n=!0):n=!1}return n}Handle(e,t,n){let r=this.eleEvtModel.EleClicked;this.eleEvtModel.SelRangeAct.Execute([r.Parent])}}t.AutoNearSelRangeLayer=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkEleClickLayer=void 0;const r=n(2),i=n(0),l=n(69);class s extends l.AbstractHandlerLayer{constructor(e){super(e)}CanWakeBySrc(e,t){return t==r.ENumEvtSrc.MOUSE_LPRESS}TryWake(e,t){let n;if(this.isWaken)n=!0;else{super.TryWake(e,t);let r=null==this.eleEvtModel?null:this.eleEvtModel.EleClickedWrap.MarkEleClicked;null!=r&&r.IsVisible?(this.isWaken=!0,n=this.isWaken):n=!1}return n}Handle(e,t,n){let r=this.eleEvtModel.EleClickedWrap.MarkEleClicked;r instanceof i.XOutlineFoldIcon&&this._SwitchOutlineFold(r)}_SwitchOutlineFold(e){let t=null==e?null:e.OwnerLine;if(null!=t){let n=t.RelEleParagraph;if(null!=n.RelOutline){let t=!e.IsFolded;n.RelOutline.FoldOutlineContent(t)}this.xdocEditor.MRefreshDocView();let r=this.xdocEditor.M_EdtCaret.CursorEle;(null==r||r.IsHidden(!0))&&(r=e.RelLineEleFrom,this.eleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle2(r)),this.eleEvtModel.MoveCaretByCursorEle(!0)}}}t.MarkEleClickLayer=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkEleTestLayer=void 0;const r=n(2),i=n(59),l=n(0),s=n(69);class o extends s.AbstractHandlerLayer{constructor(e){super(e),this.curMarkEle=null,this.lastMarkEle=null}CanWakeBySrc(e,t){return t==r.ENumEvtSrc.MOUSE_MOVE}TryWake(e,t){let n;if(this.isWaken)n=!0;else{if(super.TryWake(e,t),this.curMarkEle=this._TryGetMarkEle(),null==this.curMarkEle&&null==this.lastMarkEle)return n=!1,n;this.isWaken=!0,n=!0}return n}Handle(e,t,n){null==this.curMarkEle?this._HideLastMarkEle():this.curMarkEle instanceof l.XOutlineFoldIcon&&this._Handle_XOutlineIcon(this.curMarkEle),this.lastMarkEle=this.curMarkEle}CanWakeNextLayer(){return!0}_Handle_XOutlineIcon(e){null==e?this._HideLastMarkEle():e!=this.lastMarkEle&&(this._HideLastMarkEle(),null!=e&&(e.IsVisible=!0,this._RefreshOutlineIconArea(e)))}_HideLastMarkEle(){null!=this.lastMarkEle&&(this.lastMarkEle.IsVisible=!1,this._RefreshOutlineIconArea(this.lastMarkEle))}_TryGetMarkEle(){let e;if(null==this.eleEvtModel)e=null;else{let t=this.eleEvtModel.EleMOverWrap,n=t.MarkEleClicked;if(null!=n)e=n;else{let n=t.EleFocused,r=null==n?null:n.OwnerLine;if(null==r)e=null;else{r=r.LineAssist.GetFirstLineOfParagraph(),e=r.LineAssist.RelOutLineFoldEle}}}return e}_RefreshOutlineIconArea(e){if(null!=e){let t=this.xdocEditor.MGetZoomRatio(),n=this.xdocEditor.M_EleEvtModel.EleMOverWrap.PageFocused,r=e.RelLineEleFrom,l=i.ClickedElementWrapper.GetElePosInCtrl(r,n,t),s=e.GetBoundsDPI(96);s.X=l.X-s.Width,s.Y=l.Y,this.xdocEditor.Invalidate()}}}t.MarkEleTestLayer=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PointTestLayer=void 0;const r=n(37),i=n(2),l=n(0),s=n(91),o=n(63),a=n(73),u=n(300),h=n(17),d=n(183),c=n(234),p=n(69);class f extends p.AbstractHandlerLayer{constructor(e){super(e),this.wakePosInEle=h.PointF.Empty,this.wakePosInCell=h.PointF.Empty,this.lastEleMOver=null,this.tipSubLayer=null,this.tipSubLayer=new c.TooltipTestUtil(e)}CanWakeBySrc(e,t){return t==i.ENumEvtSrc.MOUSE_MOVE}TryWake(e,t){let n;if(this.isWaken)n=!0;else{super.TryWake(e,t);let r=null==this.eleEvtModel?null:this.eleEvtModel.EleMOver;if(null==r&&null==this.lastEleMOver)return this._Handle_MCursor_OutOfPage()||(super.MsCursor=u.Cursors.IBeam),n=!1,n;if(this.wakePosInEle.X=this.wakePosInEle.Y=-1,this.wakePosInCell.X=this.wakePosInCell.Y=-1,null!=r){this.wakePosInEle.X=e,this.wakePosInEle.Y=t,super.CalcPosInEle(r,!1,this.wakePosInEle);let n=l.XDomUtil.GetLineContainer(r);null!=n&&n instanceof l.XTextTableCell&&(this.wakePosInCell.X=e,this.wakePosInCell.Y=t,super.CalcPosInEle(n,!1,this.wakePosInCell))}this.isWaken=!0,n=!0}return n}Handle(e,t,n){let r=this.eleEvtModel.EleMOver;this._Handle_MCursor(r),this._Handle_SubLayer(),this.lastEleMOver=r}CanWakeNextLayer(){return!0}MSet_OnlyShowTraceTip(e){null!=this.tipSubLayer&&(this.tipSubLayer.OnlyShowTraceTip=e)}_Handle_MCursor(e){this._Handle_MCursor_OutOfPage()||(d.EmrFmtBrush.GetInstance().IsEmpty()?null==e?super.MsCursor=u.Cursors.IBeam:(this._Handle_MCursor_Anchor(e)||this._Handle_MCursor_TableSptLine(e)||(super.MsCursor=u.Cursors.IBeam),this._Handle_MCursor_Other(e)):super.MsCursor=r.TextDocApiConst.FormatCursor)}_Handle_MCursor_OutOfPage(){let e;return null==super.GetActivePgview(!1)?(super.MsCursor=u.Cursors.Default,e=!0):e=!1,e}_Handle_MCursor_Anchor(e){let t,n=e;if(n instanceof l.XBaseResizableElement){let e=a.ResizeAnchorUtil.Hit_Hot(n,this.wakePosInEle,96);if(a.ResizeAnchorUtil.IsAnchorForbidden(n,e))super.MsCursor=null==n?u.Cursors.IBeam:u.Cursors.Default,t=!0;else{switch(e){case s.MarkPoint.LeftTop:case s.MarkPoint.RightBottom:super.MsCursor=u.Cursors.SizeNWSE;break;case s.MarkPoint.LeftCenter:case s.MarkPoint.RightCenter:super.MsCursor=u.Cursors.SizeWE;break;case s.MarkPoint.LeftBottom:case s.MarkPoint.RightTop:super.MsCursor=u.Cursors.SizeNESW;break;case s.MarkPoint.TopCenter:case s.MarkPoint.BottomCenter:super.MsCursor=u.Cursors.SizeNS;break;default:super.MsCursor=u.Cursors.Default}t=!0}}else t=!1;return t}_Handle_MCursor_TableSptLine(e){let t,n=l.XDomUtil.GetLineContainer(e);if(null!=n&&n instanceof l.XTextTableCell){switch(a.ResizeAnchorUtil.Hit_CellSide(n,this.wakePosInCell,96)){case o.ORIENTATION.TOP:case o.ORIENTATION.BOTTOM:super.MsCursor=u.Cursors.HSplit;break;case o.ORIENTATION.LEFT:case o.ORIENTATION.RIGHT:super.MsCursor=u.Cursors.VSplit;break;default:super.MsCursor=u.Cursors.IBeam}t=!0}else t=!1;return t}_Handle_MCursor_Other(e){e instanceof l.XBaseChoiceEle&&(super.MsCursor=u.Cursors.Default)}_Handle_SubLayer(){this.tipSubLayer.AutoUpdateTooltip()}tooltipHide(){this.tipSubLayer.HideToolTip()}}t.PointTestLayer=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocPanelEditableLayer=void 0;const r=n(2),i=n(0),l=n(69);class s extends l.AbstractHandlerLayer{constructor(e){super(e),this.wakeEle=null,this.wakeXDocPanel=null}CanWakeBySrc(e,t){return t==r.ENumEvtSrc.MOUSE_DBLCLICK}TryWake(e,t){let n;if(this.isWaken)n=!0;else{super.TryWake(e,t);let r=null==this.eleEvtModel?null:this.eleEvtModel.EleMOver,l=null==r?null:r.OwnerDocPanel;if(null==l||l.IsEditable)n=!1;else{if(r instanceof i.XBaseContainer){let n=this.eleEvtModel.EleClickedWrap;n.Backup(),n.Clear(!1),r.GetEleAtPos(e,t,96,n,!0),this.wakeEle=n.EleFocused}else this.wakeEle=r;this.wakeXDocPanel=l,this.isWaken=!0,n=this.isWaken}}return n}Handle(e,t,n){if(null!=this.wakeXDocPanel){let e=this.wakeXDocPanel.Document,t=e.GetDocCtxt().EmrWorkMode;if(t==r.ENumWorkMode.Design||t==r.ENumWorkMode.App&&this.xdocEditor.HeaderEditable){if(e.Readonly)return;e.ReverseEditableXDocPanel(),null==this.wakeEle||this.wakeEle instanceof i.XBaseContainer||(this.eleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle2(this.wakeEle),this.eleEvtModel.MoveCaretByCursorEle(!0)),this.xdocEditor.Invalidate()}}}}t.XDocPanelEditableLayer=s},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,l){function s(e){try{a(r.next(e))}catch(e){l(e)}}function o(e){try{a(r.throw(e))}catch(e){l(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}a((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AEleSelectLayer=void 0;const i=n(69),l=n(17),s=n(2),o=n(29),a=n(0),u=n(1108),h=n(186),d=n(75);class c extends i.AbstractHandlerLayer{constructor(e){super(e),this.wakePosInEle=l.PointF.Empty}CanWakeBySrc(e,t){return(e&o.Keys.Shift)!=o.Keys.Shift&&t==s.ENumEvtSrc.MOUSE_LPRESS}TryWake(e,t){let n=!1;if(this.isWaken)n=!0;else{super.TryWake(e,t);let r=null==this.eleEvtModel?null:this.eleEvtModel.EleClicked;null!=r&&a.XDomUtil.IsOwnXDocPanelEditable(r)?(this.wakePosInEle.X=e,this.wakePosInEle.Y=t,super.CalcPosInEle(r,!0,this.wakePosInEle),this.isWaken=!0,n=this.isWaken):n=!1}return n}Handle(e,t,n){return r(this,void 0,void 0,(function*(){let e=this.eleEvtModel.EleClicked,t=this._CanReSelect(e);if(e instanceof a.XImageEle&&(e.ImageType==d.ImageType.TeechBitmap||"TeechBitmap"==e.ImageType)){let t=e.DataString;this.xdocEditor.M_EdtCustomEvtGrp.ClickTeethImage&&this.xdocEditor.M_EdtCustomEvtGrp.ClickTeethImage(t)}let n=e==this.eleEvtModel.LastEleClicked;if(t||!n){if(e instanceof a.XBaseChoiceEle)this._SelectChoiceItem(e);else if(e instanceof a.XBaseResizableElement){let t=e;this._SelectResizableEle(t)}else{let t=a.XDomUtil.GetParentXInput(e,!1);null!=t&&t.StartEle!=e&&(yield this._InputFiledClick(this.xdocEditor,t instanceof a.XInputEle?t:null))}this.eleEvtModel.UpdateLastEleClicked(e,!0)}}))}_CanReSelect(e){let t=a.XDomUtil.GetParentXInput(e,!0);return e instanceof a.XBaseChoiceEle||t instanceof a.XInputEle}_InputFiledClick(e,t){return r(this,void 0,void 0,(function*(){if(null!=t){let n=new h.InputAlertFormEvtHandler(e);yield n.OnMouseClick(t);let r=!1;if(null!=this.eleEvtModel.PopCtrl&&(r=!0,!this.eleEvtModel.PopCtrl.IsUpdated&&this.eleEvtModel.PopCtrl.divID)){const e=document.querySelector("."+this.eleEvtModel.PopCtrl.divID);e&&(e.innerHTML="",e.style.display="none")}this.eleEvtModel.PopCtrl=n.InputPopControl,null!=this.eleEvtModel.PopCtrl&&(this.eleEvtModel.PopCtrl.IsDisposed=r)}}))}_SelectChoiceItem(e){(new u.GroupChoiceHandler).OnMouseClick(this.xdocEditor,e)}_SelectResizableEle(e){e.IsFocused||(e.IsFocused=!0,this.eleEvtModel.ClearSelRange(),this.eleEvtModel.SelRangeAct.Execute([e,e]))}}t.AEleSelectLayer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeXTableLayer=void 0;const r=n(69),i=n(0),l=n(63),s=n(9),o=n(2),a=n(17),u=n(73),h=n(44),d=n(43),c=n(92);class p extends r.AbstractHandlerLayer{constructor(e){super(e),this.wakeCell=null,this.wakeCellSide=l.ORIENTATION.NONE,this.origCellRect=s.RectangleF.Empty,this.reszingPos=0,this.detX=0,this.detY=0}CanWakeBySrc(e,t){return t==o.ENumEvtSrc.MOUSE_DRAG}TryWake(e,t){let n=!1;if(this.isWaken)n=!0;else{super.TryWake(e,t);let r=null==this.eleEvtModel?null:this.eleEvtModel.EleClicked;if(this.wakeCell=i.XDomUtil.GetLineContainer(r),this.wakeCell instanceof i.XTextTableCell){let r=a.PointF.Empty;r.X=e,r.Y=t,super.CalcPosInEle(this.wakeCell,!1,r),this.wakeCellSide=u.ResizeAnchorUtil.Hit_CellSide(this.wakeCell,r,96),this.isWaken=this.wakeCellSide!=l.ORIENTATION.NONE,this.isWaken?(super.CalcRectInCtrl(this.wakeCell,!1,this.origCellRect),n=this.isWaken):n=!1}else n=!1}return n}Handle(e,t,n){let r=this.wakeCell.Parent.Parent instanceof i.XTextTable?this.wakeCell.Parent.Parent:null;this.detX=parseInt(String(t)),this.detY=parseInt(String(n));let s=!1;switch(this.wakeCellSide){case l.ORIENTATION.TOP:if(!r.IsSetRowHeight)return void(this.xdocEditor.HideMsgBox||c.MessageBoxComp.Show({title:"提示",content:"表格设置了固定行高，不能调整行高",type:"error",dom:this.xdocEditor.ContainerDOM}));s=!0,this.reszingPos=this.origCellRect.Top+n;break;case l.ORIENTATION.BOTTOM:if(!r.IsSetRowHeight)return void(this.xdocEditor.HideMsgBox||c.MessageBoxComp.Show({title:"提示",content:"表格设置了固定行高，不能调整行高",type:"error",dom:this.xdocEditor.ContainerDOM}));s=!0,this.reszingPos=this.origCellRect.Bottom+n;break;case l.ORIENTATION.LEFT:if(!r.IsSetColWidth)return void(this.xdocEditor.HideMsgBox||c.MessageBoxComp.Show({title:"提示",content:"表格设置了固定列宽，不能调整列宽",type:"error",dom:this.xdocEditor.ContainerDOM}));s=!1,this.reszingPos=this.origCellRect.Left+t;break;case l.ORIENTATION.RIGHT:if(!r.IsSetColWidth)return void(this.xdocEditor.HideMsgBox||c.MessageBoxComp.Show({title:"提示",content:"表格设置了固定列宽，不能调整列宽",type:"error",dom:this.xdocEditor.ContainerDOM}));s=!1,this.reszingPos=this.origCellRect.Right+t}let o=super.GetActivePgview(!1);null!=o&&(o.SetDragDashLineF(this.reszingPos,s,!1),this.xdocEditor.Invalidate())}OnDone(){if(this.isWaken){let e=super.GetActivePgview(!1);null!=e&&e.SetDragDashLineF(-1,!0,!1);let t=this.wakeCell.Parent.Parent instanceof i.XTextTable?this.wakeCell.Parent.Parent:null;switch(this.wakeCellSide){case l.ORIENTATION.TOP:case l.ORIENTATION.BOTTOM:this._Handle_RowHeight(t,this.detY);break;case l.ORIENTATION.LEFT:case l.ORIENTATION.RIGHT:this._Handle_ColWidth(t,this.detX)}this.isWaken=!1,null!=t&&h.TextDocApiUtil.M_InnerEleExcScrExp(t,t.Document,null),this.xdocEditor.MRefreshDocView(),this.xdocEditor.M_EleEvtModel.MoveCaretByCursorEle(!1)}}_Handle_RowHeight(e,t){if(!e.IsSetRowHeight)return;let n=this.wakeCell.RowIndex;this.wakeCellSide==l.ORIENTATION.BOTTOM&&this.wakeCell.RowSpan>1?n=this.wakeCell.RelatedMergeCell_Down.Get(this.wakeCell.RelatedMergeCell_Down.Count()-1).RowIndex:this.wakeCellSide==l.ORIENTATION.TOP&&n>0&&n--,this.xdocEditor.M_GetActionByName("TextTableResizeRow").Execute([e,n,parseInt(t+.5+"")])}_Handle_ColWidth(e,t){if(!e.IsSetColWidth)return;let n=this.wakeCell.EleStyle.GetElePaddDPI(96),r=this._GetColumnsLR(e),i=this.wakeCellSide==l.ORIENTATION.LEFT;i&&(t=-t);let s=3.125*t,o=d.GrapUtil.MeasureStrSize(null,e.EleStyle.Font,500,"国").Width;o+=n.Left+n.Right;let a=3.125*o;this.xdocEditor.M_GetActionByName("TextTableResizeColumn").Execute([r[0],r[1],s,parseInt(t+.5+""),a,o,i]);for(let t of e.Rows)for(let n=0;n<t.Cells.Count();n++)t.Cells.Get(n).Column=e.Columns.Get(n),t.Cells.Get(n).WidhtDisp=e.Columns.Get(n).BoundsDISP.Width,t.Cells.Get(n).SetSizeDPI(t.Cells.Get(n).Column.Width,-1e3,300),t.Cells.Get(n).AutoSize=!1,t.Cells.Get(n).NotifyLayoutChanged(!0,!0);e.CombineCells()}_GetColumnsLR(e){let t=this.wakeCell.ColIndex;this.wakeCell.RelatedMergeCell_Right.Count()>0&&this.wakeCellSide==l.ORIENTATION.RIGHT&&(t=this.wakeCell.RelatedMergeCell_Right.Get(this.wakeCell.RelatedMergeCell_Right.Count()-1).ColIndex);let n=new Array(2),r=e.Columns;switch(this.wakeCellSide){case l.ORIENTATION.LEFT:t>=1&&(n[0]=r.Get(t-1)),n[1]=r.Get(t);break;case l.ORIENTATION.RIGHT:n[0]=r.Get(t),t<=r.Count()-2&&(n[1]=r.Get(t+1))}return n}}t.ResizeXTableLayer=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeAEleLayer=void 0;const r=n(69),i=n(17),l=n(91),s=n(9),o=n(2),a=n(73),u=n(110),h=n(0),d=n(1110);class c extends r.AbstractHandlerLayer{constructor(e){super(e),this.wakePosInEle=i.PointF.Empty,this.wakeHitAnchor=l.MarkPoint.None,this.origRect=s.RectangleF.Empty,this.rectResizing=s.RectangleF.Empty}CanWakeBySrc(e,t){return t==o.ENumEvtSrc.MOUSE_DRAG}TryWake(e,t){let n=!1;if(this.isWaken)n=!0;else{super.TryWake(e,t);let r=null==this.eleEvtModel?null:this.eleEvtModel.EleClicked,i=r;i instanceof h.XBaseResizableElement?(this.wakePosInEle.X=e,this.wakePosInEle.Y=t,super.CalcPosInEle(r,!0,this.wakePosInEle),this.wakeHitAnchor=a.ResizeAnchorUtil.Hit_Hot(i,this.wakePosInEle,96),this.isWaken=l.MarkPoint.None!=this.wakeHitAnchor,this.isWaken=this.isWaken&&!a.ResizeAnchorUtil.IsAnchorForbidden(i,this.wakeHitAnchor),this.isWaken?(super.CalcRectInCtrl(r,!0,this.origRect),n=this.isWaken):n=!1):n=!1}return n}Handle(e,t,n){let r=this.eleEvtModel.EleClicked;switch(u.RectFUtil.CopyRectF(this.origRect,this.rectResizing),this.wakeHitAnchor){case l.MarkPoint.LeftTop:this.rectResizing.X=this.rectResizing.X+t,this.rectResizing.Y=this.rectResizing.Y+n,this.rectResizing.Width=this.rectResizing.Width-t,this.rectResizing.Height=this.rectResizing.Height-n;break;case l.MarkPoint.LeftCenter:this.rectResizing.X=this.rectResizing.X+t,this.rectResizing.Width=this.rectResizing.Width-t;break;case l.MarkPoint.LeftBottom:this.rectResizing.X=this.rectResizing.X+t,this.rectResizing.Width=this.rectResizing.Width-t,this.rectResizing.Height=this.rectResizing.Height+n;break;case l.MarkPoint.TopCenter:this.rectResizing.Y=this.rectResizing.Y+n,this.rectResizing.Height=this.rectResizing.Height-n;break;case l.MarkPoint.BottomCenter:this.rectResizing.Height=this.rectResizing.Height+n;break;case l.MarkPoint.RightTop:this.rectResizing.Y=this.rectResizing.Y+n,this.rectResizing.Width=this.rectResizing.Width+t,this.rectResizing.Height=this.rectResizing.Height-n;break;case l.MarkPoint.RightCenter:this.rectResizing.Width=this.rectResizing.Width+t;break;case l.MarkPoint.RightBottom:this.rectResizing.Width=this.rectResizing.Width+t,this.rectResizing.Height=this.rectResizing.Height+n}this._CorrectNetiveDragSize(this.rectResizing),this._ConstraintWHRatio(this.rectResizing,r);let i=super.GetActivePgview(!0);null!=i&&(i.DragDashRectF=this.rectResizing,this.xdocEditor.Invalidate())}OnDone(){if(this.isWaken){let e=super.GetActivePgview(!0);null!=e&&(e.DragDashRectF=s.RectangleF.Empty);let t=this.eleEvtModel.EleClicked instanceof h.XBaseResizableElement?this.eleEvtModel.EleClicked:null,n=new d.EleResizeUndo(t);t.SetSizeDPI(this.rectResizing.Width,this.rectResizing.Height,96),n.ReadNewSize(),super.AddUndoItem(n),this.isWaken=!1,this.xdocEditor.MRefreshDocView()}}_CorrectNetiveDragSize(e){0==e.Width&&(e.Width=10),0==e.Height&&(e.Height=10),(e.Width<=0||e.Height<=0)&&(e.Width<0&&(e.Width=-e.Width,e.X-=e.Width),e.Height<0&&(e.Height=-e.Height,e.Y-=e.Height))}_ConstraintWHRatio(e,t){if(h.XDomUtil.IsFixWHRatioEle(t)){let n=t.Width/t.Height;n>0&&(e.Height=e.Width/n)}}}t.ResizeAEleLayer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AEleEdtLayer=void 0;const r=n(69),i=n(1111),l=n(1132),s=n(0),o=n(2),a=n(1149),u=n(1150);class h extends r.AbstractHandlerLayer{constructor(e){super(e),this.imgEdt=null,this.medExprEdt=null,this.fractionEdt=null,this._inputEditor=null,this.imgEdt=new i.ImgEditor(e),this.medExprEdt=new l.MedExpresEditor(e),this.fractionEdt=new u.FractionEditor(e),this._inputEditor=new a.InputEditor(e)}CanWakeBySrc(e,t){return t==o.ENumEvtSrc.MOUSE_DBLCLICK}TryWake(e,t){let n;if(this.isWaken)n=!0;else{super.TryWake(e,t);let r=null==this.eleEvtModel?null:this.eleEvtModel.EleClicked;null!=r&&s.XDomUtil.IsOwnXDocPanelEditable(r)?(this.isWaken=!0,n=this.isWaken):n=!1}return n}Handle(e,t,n){let r=this.eleEvtModel.EleClicked,i=!1,l=null;if(r instanceof s.XImageEle)i=this.imgEdt.PopEditor(r instanceof s.XImageEle?r:null);else if(r instanceof s.XMedicalExpressionField)i=this.medExprEdt.PopEditor(r instanceof s.XMedicalExpressionField?r:null),l=this.medExprEdt.EdtUndoItem;else if(r instanceof s.XFractionEle)i=this.fractionEdt.PopEditor(r instanceof s.XFractionEle?r:null);else{let e=s.XDomUtil.GetParentXInput(r,!1);null!=e&&(i=this._inputEditor.PopEditor(e instanceof s.XInputEle?e:null),l=this._inputEditor.EdtUndoItem)}super.AddUndoItem(l),this.xdocEditor.Focus(),i&&this.xdocEditor.MRefreshDocView()}}t.AEleEdtLayer=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleLogger=void 0;const r=n(111);n(39);class i{constructor(e){this.loggerName=e}static GetInstance(e){if(null==i.loggerCache&&(i.loggerCache=new Map),this.loggerCache.has(e))return i.loggerCache.get(e);let t=new i(e);return i.loggerCache.set(e,t),t}Error(e){let t,n,i;e instanceof r.ResMessage?(t=e.CodeStr,n=e.MsgStr,i=e.Ex):"string"==typeof e?(t="unknown code",n=e,i=null):"object"==typeof e&&(t="unknown code",n=JSON.stringify(e),i=null)}Warn(e){let t,n,i;e instanceof r.ResMessage?(t=e.CodeStr,n=e.MsgStr,i=e.Ex):"string"==typeof e?(t="unknown code",n=e,i=null):"object"==typeof e&&(t="unknown code",n=JSON.stringify(e),i=null)}Info(e){let t,n,i;e instanceof r.ResMessage?(t=e.CodeStr,n=e.MsgStr,i=e.Ex):"string"==typeof e?(t="unknown code",n=e,i=null):"object"==typeof e&&(t="unknown code",n=JSON.stringify(e),i=null)}Log(e,t=!0){e.IsErrorMsg()?this.Error(e):e.IsWarnMsg()?this.Warn(e):this.Info(e)}}t.SimpleLogger=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditorEleEvtHandler=void 0;const r=n(1159);t.EditorEleEvtHandler=class{constructor(e){this.xdocEditor=null,this.edtCustomEvtGrp=null,this.xdocEditor=e,this.edtCustomEvtGrp=this.xdocEditor.M_EdtCustomEvtGrp,this._inputEleHandler=new r.InputEvtHandler}OnXDocLoaded(e,t){null!=this.edtCustomEvtGrp.OnXDocLoaded&&this.edtCustomEvtGrp.OnXDocLoaded(e,t),this.xdocEditor.DefaultSetting.IsShowRule&&this.xdocEditor.M_emrDocView.RefreshRuler()}OnCursorChange(e,t){let n=this.xdocEditor.M_GetActionByName("FocusXInputEle");null!=n&&n.Execute(),null!=this.edtCustomEvtGrp.OnCursorEleChanged&&this.edtCustomEvtGrp.OnCursorEleChanged(e,t),this._inputEleHandler.OnCursorChange(this.xdocEditor,e,t)}OnSelRangeChanged(e){null!=e&&e.IsValid()&&null!=this.edtCustomEvtGrp.OnSelRangeChanged&&this.edtCustomEvtGrp.OnSelRangeChanged(e)}OnTextChanged(e){null!=e&&this._inputEleHandler.OnTextChanged(this.xdocEditor,e)}OnEleStyleChanged(e,t){null!=this.edtCustomEvtGrp.OnEleStyleChanged&&this.edtCustomEvtGrp.OnEleStyleChanged(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PangoEditor=void 0;const r=n(253),i=n(754);n(1179),n(1181),n(1183);const l=n(1188),s=n(0),o=n(1189),a=n(25),u=n(146),h=n(20),d=n(376),c=n(2),p=n(26),f=n(149),g=n(33),m=n(1193),E=n(359),C=n(180);t.PangoEditor=class{constructor(e,t){this.canvas=null,this.pangoEditorVersion="2022/08/03 09:50",this.ContainerDom=e,0==e.clientWidth||e.clientHeight,e.innerHTML=`\n            <div id="pango-editor-editor" class="pango-editor">\n                <div style="width: 100%;" id="testArea">\n                    <input type="file" id="pango-editor-uploadPic" hidden=true value="上传图片"/>\n                    <input type="file" id="pango-editor-uploadxml" accept=".xml" hidden=true value="打开文件"/>\n                </div>\n                <div id="pango-editor-toolbar" class="edui-default" style="width:100%"></div>\n                <div id="pango-editor-ruler" class="pango-editor-ruler"></div>\n                <div id="pango-editor-content-${e.id}" class="pango-editor-content"></div>\n                <div id="pango-editor-statusBar" class="pango-editor-statusBar"></div>\n            </div>\n        `,this.EventList=t,this.EventList.id=e.id,this.width=this.EventList.width,this.height=this.EventList.height,this.width&&!this.height&&(this.height=1.414286*this.width),this.ImportDoc(l.Blank.File),this.canvas.XmlOnLoadHandFlag=!0,this.canvas.AlwaysCenter=1==t.AlwaysCenter,Object.freeze(this),setTimeout(()=>{this.canvas.customEvtGrp.PageOnload&&this.canvas.customEvtGrp.PageOnload(this)},0)}postmessage(e){if(p.TextDocInitInfo.EmrRunSetting=this.EventList.id,e){let t,n=e.type,r=this;if("xmlFile"==n){let e=this.ContainerDom.querySelector("#pango-editor-uploadxml");e&&(e.click(),e.onchange=()=>{if(e instanceof HTMLInputElement){let t=e.files[0];r.LoadFile(t),e.value=null}})}else if("ImportDoc"==n)this.ImportDoc(e.param);else if("InsertParagraphsTemplate"==n)t=this.InsertParagraphsTemplate(e.param);else if("OpenAndAppendDoc"==n)t=this.OpenAndAppendDoc(e.param);else if("importMoreXml"==n)t=this.importMoreXml(e.param);else if("LookUpXmlCode"==n){t=this.ExecuteAction("LookUpXmlCode",e.param)}else if("templateSave"==n){t=this.ExecuteAction("LookUpXmlCode",e.param)}else"InsertImage"==n?this.InsertImage():"InsertImageStream"==n?this.InsertImageStream(e.type,e.param):"signature"==n?this.createSignature():"GetTextTableProperty"==n?t=this.GetTextTableProperty():"GetBorderShading"==n?(t={},t.ReturnParams=this.GetBorderShading()):"InsertTeeth"==n?t=this.ExecuteAction("InsertTeeth",[{imgObj:e.param.imgObj,teethmap:e.param.teethmap,width:e.param.width,height:e.param.height,undoRelateId:e.param.undoRelateId,useEditorTeeth:e.param.useEditorTeeth,IsImgBase64:e.param.IsImgBase64}]):"UpdateTeeth"==n?this.ExecuteAction("UpdateTeeth",[e.param.imgObj,e.param.teethmap,e.param.width,e.param.height]):"InsertSyncImg"==n?this.ExecuteAction("InsertSyncImg",[e.param]):"setValueByCptId"==n?t=this.ExecuteAction("SetValue",e.param):"FileAppend"==n?(t=this.ExecuteAction("FileAppend",e.param),this.Resize()):t=this.ExecuteAction(e.type,e.param);return t&&null!=t.ReturnParams?t=t.ReturnParams:t&&1==t.IsReturnMsg||(t=void 0),t}}OpenAndAppendDoc(e){p.TextDocInitInfo.EmrRunSetting=this.EventList.id;let t=[...e],n=null!=this.EventList.showRule&&this.EventList.showRule,r=null==this.EventList.Adaptive||this.EventList.Adaptive,i=n?150:50;if(this.ExecuteAction("FileOpen",[t[0]]),t.length>1&&this.ExecuteAction("FileAppends",t.splice(1)),r){let e=this.width?this.width:this.ContainerDom.offsetWidth-i;e=e<=0?796:e;let t=this.height?this.height:1.414286*e,n=new f.MeasureConverter,r=parseInt(n.ConvPxToMm(e,96)+""),l=parseInt(n.ConvPxToMm(t,96)+"");this.ExecuteAction("SetPageFmt",[{isAdaptive:!0,pageHeight:l,pageWidth:r}])}let l=this.canvas.All_Document;for(let e=0;e<l.length;e++)l[e].IsDocFmtChanged=!1;return{ReturnParams:[]}}importMoreXml(e){p.TextDocInitInfo.EmrRunSetting=this.EventList.id;let t,n=e.srcstr,r=e.docId,i=e.topMargin,l='<?xml version="1.0" encoding="utf-8"?>';t=n.indexOf(l)>-1?l:'<?xml version="1.0" encoding="UTF-8"?>';let s=n.split(t),o=[];for(let e=1;e<s.length;e++)1==e?o.push({srcstr:s[e],docId:r}):o.push({srcstr:s[e],topMargin:i});this.OpenAndAppendDoc(o)}ImportDoc(e){var t;let n,l=null!=this.EventList.showRule&&this.EventList.showRule;if(1==this.EventList.TeechImgType&&(C.default.TeechImg=1),p.TextDocInitInfo.EmrRunSetting=this.EventList.id,p.TextDocInitInfo.GetInstance().IsShowRule=l,p.TextDocInitInfo.GetInstance().UpdateCustom(this.EventList.UpdateTextDocInfo),p.TextDocInitInfo.GetInstance().UpdateImageUrl(this.EventList.ImageUrl),p.TextDocInitInfo.GetInstance().UpdateDefaultCurrentTimeFlag(this.EventList.DefaultCurrentTimeFlag),p.TextDocInitInfo.GetInstance().UpdateDelayedChangeInfo(this.EventList.DelayedChangeInfo),p.TextDocInitInfo.GetInstance().UpdatePatientInfo(E.PatientInfo.ParseObject(this.EventList.config?this.EventList.config.patient:null)),p.TextDocInitInfo.GetInstance().UpdateXInputJumpType(this.EventList.JumpAll),p.TextDocInitInfo.GetInstance().UpdateUseCalculatorNum(this.EventList.UseCalculatorNum),p.TextDocInitInfo.GetInstance().UpdateValidateOpenFile(this.EventList.ValidateOpenFile),n=null!=this.canvas?this.canvas.eleEvtModel.WorkMode:null!=this.EventList.workMode?c.ENumWorkMode[this.EventList.workMode]:c.ENumWorkMode.Design,!this.canvas){this.canvas=new i.XDocEditableCanvas(n,c.ENumViewMode.Init,this.ContainerDom,this.width,this.height,this.EventList.showWorkMode,this.EventList.showZoom),this.canvas.customEvtGrp.PageOnload=this.EventList.PageOnload,this.canvas.customEvtGrp.InputActiveHandler=this.EventList.InputActiveHandler,this.canvas.customEvtGrp.XmlOnLoad=this.EventList.XmlOnLoad,this.canvas.customEvtGrp.OpenError=this.EventList.OpenError,this.canvas.customEvtGrp.XmlAppend=this.EventList.XmlAppend,this.canvas.customEvtGrp.XmlAppends=this.EventList.XmlAppends,this.canvas.customEvtGrp.UpdateTeeth=this.EventList.UpdateTeeth,this.canvas.customEvtGrp.ClickTeethImage=this.EventList.ClickTeethImage,this.canvas.customEvtGrp.ButtonClick=this.EventList.ButtonClick,this.canvas.customEvtGrp.InputChange=this.EventList.InputChange,this.canvas.customEvtGrp.OnSelectChanged=this.EventList.OnSelectChanged,this.canvas.customEvtGrp.UpdateImageUrl=this.EventList.UpdateImageUrl,this.canvas.customEvtGrp.DoubleClickSyncImg=this.EventList.DoubleClickSyncImg,this.canvas.customEvtGrp.DoubleClickTitle=this.EventList.DoubleClickTitle,this.canvas.customEvtGrp.RightProperty=this.EventList.RightProperty,this.canvas.customEvtGrp.SaveAsText=this.EventList.SaveAsText,this.canvas.customEvtGrp.beforePaint=this.EventList.beforePaint,this.canvas.customEvtGrp.ImageLoadError=this.EventList.ImageLoadError,this.canvas.customEvtGrp.afterPaint=this.EventList.afterPaint,this.canvas.customEvtGrp.InputOnBlur=this.EventList.InputOnBlur,this.canvas.customEvtGrp.UpdateSyncImage=this.EventList.UpdateSyncImage,this.canvas.customEvtGrp.InputActiveWithCptId=this.EventList.InputActiveWithCptId,this.canvas.customEvtGrp.ReadOnlyInputActiveWithCptId=this.EventList.ReadOnlyInputActiveWithCptId,this.canvas.customEvtGrp.XLabelHoverBackParagraph=this.EventList.XLabelHoverBackParagraph,this.canvas.customEvtGrp.XLabelMoveOut=this.EventList.XLabelMoveOut,this.canvas.customEvtGrp.beforeArrowKeydown=this.EventList.beforeArrowKeydown,this.canvas.customEvtGrp.beforeEnterKeydown=this.EventList.beforeEnterKeydown,this.canvas.customEvtGrp.InputMouseClick=this.EventList.InputMouseClick,this.canvas.customEvtGrp.InputDoubleClick=this.EventList.InputDoubleClick,this.canvas.customEvtGrp.BeforeRightMenu=this.EventList.BeforeRightMenu,this.canvas.customEvtGrp.AfterSetPrintPreview=this.EventList.AfterSetPrintPreview,this.canvas.customEvtGrp.AfterSetWorkMode=this.EventList.AfterSetWorkMode,this.canvas.customEvtGrp.DocChanged=null===(t=this.EventList.DocChanged)||void 0===t?void 0:t.bind(this),this.canvas.customEvtGrp.PrintpreviewClick=this.EventList.PrintpreviewClick,this.canvas.customEvtGrp.BrowseRClick=this.EventList.BrowseRClick,this.canvas.customEvtGrp.customizeRightMenuArr=this.EventList.customizeRightMenu;const e=this.EventList.KeepTraceConfig;e&&(this.canvas.customEvtGrp.KeepTraceNumber=e.number),e&&(this.canvas.customEvtGrp.KeepTraceShowDate=e.date),this.canvas.customEvtGrp.OnCursorChanged=this.EventList.OnCursorChanged,this.canvas.ShowXParagraphFlag=this.EventList.showXParagraphFlag,this.canvas.PasteXtextLabelTotext=!0===this.EventList.pasteXtextLabelTotext,this.canvas.showPageDfltBorder=null==this.EventList.showPageDfltBorder||this.EventList.showPageDfltBorder,this.canvas.ConsecutiveDocBottom=null==this.EventList.ConsecutiveDocBottom?80:this.EventList.ConsecutiveDocBottom,this.canvas.customEvtGrp.ZoomChangeAfter=this.EventList.ZoomChangeAfter;let r=this.EventList.userId,l=this.EventList.userName,s=this.EventList.userLevel;if(this.canvas.MoveCaretWithImportDoc=this.EventList.MoveCaretWithImportDoc,this.canvas.HeaderEditable=!1!==this.EventList.HeaderEditable,this.canvas.M_EdtLoginUserInfo.SetUserInfo(r,l,s),null!=this.EventList.updateCustomEvtGrp){const e=this.EventList.updateCustomEvtGrp;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];this.canvas.customEvtGrp[t]=n}}}let s=[e,this.EventList.config];new r.A_ImportDoc(this.canvas).Execute(s);let o=l?150:50;if(null==this.EventList.Adaptive||this.EventList.Adaptive){let e=this.width?this.width:this.ContainerDom.offsetWidth-o;e=e<=0?796:e;let t=this.height?this.height:1.414286*e,n=new f.MeasureConverter,r=parseInt(n.ConvPxToMm(e,96)+""),i=parseInt(n.ConvPxToMm(t,96)+"");this.ExecuteAction("SetPageFmt",[{pageHeight:i,pageWidth:r,isAdaptive:!0}]);let l=this.canvas.All_Document;for(let e=0;e<l.length;e++)l[e].IsDocFmtChanged=!1}}LoadFile(e){let t=this;try{u.LoadingComp.show();let n=new FileReader;n.onload=function(){let e=this.result;t.ImportDoc(e)},n.readAsText(e)}catch(e){u.LoadingComp.hide()}}InsertDoc(e){let t=this;try{u.LoadingComp.show();let n=new FileReader;n.onload=function(){let e=[this.result];new d.A_InsertDoc(t.canvas).Execute(e)},n.readAsText(e)}catch(e){u.LoadingComp.hide()}}InsertParagraphsTemplate(e){let t=[e];return new d.A_InsertDoc(this.canvas).Execute(t)}InsertImage(){let e=this,t=this.ContainerDom.querySelector("#pango-editor-uploadPic");t&&(t.click(),t.onchange=()=>{if(t instanceof HTMLInputElement){let n=t.files[0],r=new FileReader;r.readAsDataURL(n),r.onload=function(n){let r=String(n.target.result),i=new s.XImageEle;i.setImgObj(r);let l=new Image;l.src=r,l.onload=function(){new a.SizeF(l.width,l.height);let n=[i,r];e.ExecuteAction("InsertImage",n),t.value=null}}}})}InsertImageStream(e,t){let n=t.base64,r=t.width,i=t.height,l=null==t.IsImgBase64||t.IsImgBase64,s="";if(l){let e=n.split(",");s=1==e.length?"data:image/gif;base64,"+e[0]:n}else s=n;let o=this,a=new Image;a.src=p.TextDocInitInfo.GetInstance().ImageUrl+s,r&&i?this.insertimageSync(a,r,i,n,l):a.onload=()=>{o.insertimageSync(a,r,i,n,l)}}insertimageSync(e,t,n,r,i){let l=new s.XImageEle;l.setImgObj(r,i),l.ImgObj.Width=t||e.width,l.ImgObj.Height=n||e.height;let o=[l,r,i];this.ExecuteAction("InsertImage",o)}createSignature(){let e=this,t=window.innerHeight,n=window.innerWidth;new o.Signature1({top:(t-400)/2,left:(n-800)/2,onOk:function(t){let n=new s.XImageEle;n.setImgObj(t);let r=new Image;r.src=t,r.onload=function(){new a.SizeF(r.width,r.height);let i=[n,t];e.canvas.M_ActionHandler.L_ExecuteCommand("InsertImage",i)}}})}GetTextTableProperty(){let e=this.canvas.M_EleFocused,t=h.XTextTableUtil.GetCursorTextTable(e);return null!=t&&(null.ReturnParams=h.XTextTableUtil.buildPropertiesInfo(t)),null}GetBorderShading(){let e=this.canvas.M_EleEvtModel.SelRange.InfoUtil.GetLineElesInRange(!0,!0);if(null!=e&&e.length>0){let t=e;for(let e=0;e<t.length;e++){let n=t[e];if(n instanceof s.XTextTableCell){let e=s.XDomUtil.GetXTableOfCell(n);if(null!=e)return h.XTextTableUtil.buildBorderShadingInfo(e)}}}}ExecuteAction(e,t){return null!=t&&null!=t||(t=[null]),this.canvas.M_ActionHandler.L_ExecuteCommand(e,t)}Resize(e){let t=null!=this.EventList.showRule&&this.EventList.showRule?150:50;if(null==this.EventList.Adaptive||this.EventList.Adaptive){let n=e&&e.width?e.width:this.ContainerDom.offsetWidth-t;n=n<=0?796:n;let r=e&&e.height?e.height:1.414286*n,i=new f.MeasureConverter,l=parseInt(i.ConvPxToMm(n,96)+""),s=parseInt(i.ConvPxToMm(r,96)+"");this.ExecuteAction("SetPageFmt",[{pageHeight:s,pageWidth:l,isAdaptive:!0}]);let o=this.canvas.All_Document;for(let e=0;e<o.length;e++)o[e].IsDocFmtChanged=!1}}destroyed(){this.canvas.toolbar.destroy()}activeFooter(){let e=this.canvas.All_Document;for(var t=0;t<e.length;t++){let n=new g.EmrCalcEngine(e[t]).GetXDocFooter().Document;n.ReverseEditableXDocPanel();let r=n.GetFooterLastChild();this.canvas.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(r)}this.canvas.M_EleEvtModel.MoveCaretByCursorEle(!0)}activeHeader(){let e=this.canvas.All_Document[0];e.ReverseEditableXDocPanel();let t=e.GetHeaderLastChild();this.canvas.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(t),this.canvas.M_EleEvtModel.MoveCaretByCursorEle(!0)}activebody(){let e=this.canvas.All_Document[0];e.ReverseEditableXDocPanel();let t=e.GetBodyFirstChild();this.canvas.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(t),this.canvas.M_EleEvtModel.MoveCaretByCursorEle(!0)}disableHeader(){this.canvas.All_Document[0].Readonly=!0}insertdoc(e){let t=this.canvas.M_EleEvtModel.WorkMode;if(this.canvas.M_EleEvtModel.WorkMode=c.ENumWorkMode.App,this.activeHeader(),e.mrtName){let t={type:"InsertChar",param:[e.mrtName]};this.postmessage(t)}this.activebody();let n=e.sections;for(let e=0;e<n.length;e++){let t={type:"InsertTextLabel",param:[{inpMrtDeSectionDispName:n[e].tsDisplayName,conceptDomainCode:n[e].csConceptId,conceptID:n[e].csConceptId,elementName:"aaaaa",sectionLevel:1,deleteFlag:!0,elementCode:!0,titleDescription:"aaa",saveFlag:!0,positionFlag:!0,showFlag:!0,requireFlag:!0,printFlag:!1}]};if(this.postmessage(t),n[e].narrativeBlock){let t={type:"InsertChar",param:[n[e].narrativeBlock]};this.postmessage(t)}if(e<n.length-1){let e={type:"InsertReturn",param:[]};this.postmessage(e)}}this.canvas.M_EleEvtModel.WorkMode=t}updateRightMenu(e){null!=e&&e instanceof Array&&e.length>0&&(null==this.canvas.customEvtGrp.customizeRightMenuArr&&(this.canvas.customEvtGrp.customizeRightMenuArr=[]),this.canvas.customEvtGrp.customizeRightMenuArr=[...this.canvas.customEvtGrp.customizeRightMenuArr,...e])}updateDiagTable(e,t){const n=this.canvas.customEvtGrp.xDiagTableInfo;if(null!=e&&e.id){let r=Number(e.rowIx);r>=0||(r=-1);let i=Number(e.colIx);i>=0||(i=-1),n.setEdtCtrl(this.canvas),n.SetValue([e.id,r,i,!!e.clearCell,!!e.diffRow]);!!e.moveCaretToCell&&n.updateDiagTable();const l=n.RowIx,s=n.ColIx;let o=null;if(null!=n.xTable){o={xid:n.xTable.XID};const t=n.getAllDiagEle(!!e.returnAllDiagEle);null!=t&&(o.AllDiagEleArr=t)}"function"==typeof t&&t({rowIx:l,colIx:s,xTableInfo:o})}else"function"==typeof t&&t({xTableInfo:null});n.Clear()}setEditablaDiagTable(e){if(null!=e){let t=e.xid;this.canvas.customEvtGrp.EditablaDiagTableXID=t}}changeTheme(e){m.ThemeFactory.ChangeTheme(e)}changeUnfocus(e){this.canvas.unfocus=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MD5=void 0;t.MD5=class{constructor(){this.hexcase=0,this.b64pad="",this.chrsz=8}hex_md5(e){return this.binl2hex(this.core_md5(this.str2binl(e),e.length*this.chrsz))}b64_md5(e){return this.binl2b64(this.core_md5(this.str2binl(e),e.length*this.chrsz))}str_md5(e){return this.binl2str(this.core_md5(this.str2binl(e),e.length*this.chrsz))}hex_hmac_md5(e,t){return this.binl2hex(this.core_hmac_md5(e,t))}b64_hmac_md5(e,t){return this.binl2b64(this.core_hmac_md5(e,t))}str_hmac_md5(e,t){return this.binl2str(this.core_hmac_md5(e,t))}md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc")}core_md5(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,i=-1732584194,l=271733878,s=0;s<e.length;s+=16){var o=n,a=r,u=i,h=l;n=this.md5_ff(n,r,i,l,e[s+0],7,-680876936),l=this.md5_ff(l,n,r,i,e[s+1],12,-389564586),i=this.md5_ff(i,l,n,r,e[s+2],17,606105819),r=this.md5_ff(r,i,l,n,e[s+3],22,-1044525330),n=this.md5_ff(n,r,i,l,e[s+4],7,-176418897),l=this.md5_ff(l,n,r,i,e[s+5],12,1200080426),i=this.md5_ff(i,l,n,r,e[s+6],17,-1473231341),r=this.md5_ff(r,i,l,n,e[s+7],22,-45705983),n=this.md5_ff(n,r,i,l,e[s+8],7,1770035416),l=this.md5_ff(l,n,r,i,e[s+9],12,-1958414417),i=this.md5_ff(i,l,n,r,e[s+10],17,-42063),r=this.md5_ff(r,i,l,n,e[s+11],22,-1990404162),n=this.md5_ff(n,r,i,l,e[s+12],7,1804603682),l=this.md5_ff(l,n,r,i,e[s+13],12,-40341101),i=this.md5_ff(i,l,n,r,e[s+14],17,-1502002290),r=this.md5_ff(r,i,l,n,e[s+15],22,1236535329),n=this.md5_gg(n,r,i,l,e[s+1],5,-165796510),l=this.md5_gg(l,n,r,i,e[s+6],9,-1069501632),i=this.md5_gg(i,l,n,r,e[s+11],14,643717713),r=this.md5_gg(r,i,l,n,e[s+0],20,-373897302),n=this.md5_gg(n,r,i,l,e[s+5],5,-701558691),l=this.md5_gg(l,n,r,i,e[s+10],9,38016083),i=this.md5_gg(i,l,n,r,e[s+15],14,-660478335),r=this.md5_gg(r,i,l,n,e[s+4],20,-405537848),n=this.md5_gg(n,r,i,l,e[s+9],5,568446438),l=this.md5_gg(l,n,r,i,e[s+14],9,-1019803690),i=this.md5_gg(i,l,n,r,e[s+3],14,-187363961),r=this.md5_gg(r,i,l,n,e[s+8],20,1163531501),n=this.md5_gg(n,r,i,l,e[s+13],5,-1444681467),l=this.md5_gg(l,n,r,i,e[s+2],9,-51403784),i=this.md5_gg(i,l,n,r,e[s+7],14,1735328473),r=this.md5_gg(r,i,l,n,e[s+12],20,-1926607734),n=this.md5_hh(n,r,i,l,e[s+5],4,-378558),l=this.md5_hh(l,n,r,i,e[s+8],11,-2022574463),i=this.md5_hh(i,l,n,r,e[s+11],16,1839030562),r=this.md5_hh(r,i,l,n,e[s+14],23,-35309556),n=this.md5_hh(n,r,i,l,e[s+1],4,-1530992060),l=this.md5_hh(l,n,r,i,e[s+4],11,1272893353),i=this.md5_hh(i,l,n,r,e[s+7],16,-155497632),r=this.md5_hh(r,i,l,n,e[s+10],23,-1094730640),n=this.md5_hh(n,r,i,l,e[s+13],4,681279174),l=this.md5_hh(l,n,r,i,e[s+0],11,-358537222),i=this.md5_hh(i,l,n,r,e[s+3],16,-722521979),r=this.md5_hh(r,i,l,n,e[s+6],23,76029189),n=this.md5_hh(n,r,i,l,e[s+9],4,-640364487),l=this.md5_hh(l,n,r,i,e[s+12],11,-421815835),i=this.md5_hh(i,l,n,r,e[s+15],16,530742520),r=this.md5_hh(r,i,l,n,e[s+2],23,-995338651),n=this.md5_ii(n,r,i,l,e[s+0],6,-198630844),l=this.md5_ii(l,n,r,i,e[s+7],10,1126891415),i=this.md5_ii(i,l,n,r,e[s+14],15,-1416354905),r=this.md5_ii(r,i,l,n,e[s+5],21,-57434055),n=this.md5_ii(n,r,i,l,e[s+12],6,1700485571),l=this.md5_ii(l,n,r,i,e[s+3],10,-1894986606),i=this.md5_ii(i,l,n,r,e[s+10],15,-1051523),r=this.md5_ii(r,i,l,n,e[s+1],21,-2054922799),n=this.md5_ii(n,r,i,l,e[s+8],6,1873313359),l=this.md5_ii(l,n,r,i,e[s+15],10,-30611744),i=this.md5_ii(i,l,n,r,e[s+6],15,-1560198380),r=this.md5_ii(r,i,l,n,e[s+13],21,1309151649),n=this.md5_ii(n,r,i,l,e[s+4],6,-145523070),l=this.md5_ii(l,n,r,i,e[s+11],10,-1120210379),i=this.md5_ii(i,l,n,r,e[s+2],15,718787259),r=this.md5_ii(r,i,l,n,e[s+9],21,-343485551),n=this.safe_add(n,o),r=this.safe_add(r,a),i=this.safe_add(i,u),l=this.safe_add(l,h)}return Array(n,r,i,l)}md5_cmn(e,t,n,r,i,l){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(r,l)),i),n)}md5_ff(e,t,n,r,i,l,s){return this.md5_cmn(t&n|~t&r,e,t,i,l,s)}md5_gg(e,t,n,r,i,l,s){return this.md5_cmn(t&r|n&~r,e,t,i,l,s)}md5_hh(e,t,n,r,i,l,s){return this.md5_cmn(t^n^r,e,t,i,l,s)}md5_ii(e,t,n,r,i,l,s){return this.md5_cmn(n^(t|~r),e,t,i,l,s)}core_hmac_md5(e,t){var n=this.str2binl(e);n.length>16&&(n=this.core_md5(n,e.length*this.chrsz));for(var r=Array(16),i=Array(16),l=0;l<16;l++)r[l]=909522486^n[l],i[l]=1549556828^n[l];var s=this.core_md5(r.concat(this.str2binl(t)),512+t.length*this.chrsz);return this.core_md5(i.concat(s),640)}safe_add(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}bit_rol(e,t){return e<<t|e>>>32-t}str2binl(e){for(var t=Array(),n=(1<<this.chrsz)-1,r=0;r<e.length*this.chrsz;r+=this.chrsz)t[r>>5]|=(e.charCodeAt(r/this.chrsz)&n)<<r%32;return t}binl2str(e){for(var t="",n=(1<<this.chrsz)-1,r=0;r<32*e.length;r+=this.chrsz)t+=String.fromCharCode(e[r>>5]>>>r%32&n);return t}binl2hex(e){for(var t=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<4*e.length;r++)n+=t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15);return n}binl2b64(e){for(var t="",n=0;n<4*e.length;n+=3)for(var r=(e[n>>2]>>n%4*8&255)<<16|(e[n+1>>2]>>(n+1)%4*8&255)<<8|e[n+2>>2]>>(n+2)%4*8&255,i=0;i<4;i++)8*n+6*i>32*e.length?t+=this.b64pad:t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>6*(3-i)&63);return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocContext=t.VarNames=void 0;const r=n(2),i=n(3),l=n(39),s=n(8),o=n(259);class a{}t.VarNames=a,a.PageIndex="[%PageIndex%]",a.PagesCnt="[%NumOfPages%]",a.LocalPageIndex="[%LocalPageIndex%]",a.LocalPagesCnt="[%LocalNumOfPages%]";t.XDocContext=class{constructor(){this.ctxtHMap=null,this._lastSaveTime=l.DateTime.Today(),this.pgvPainting=null,this.viewMode=new o.ViewModeObj,this.workMode=r.ENumWorkMode.Design,this.ctxtHMap=new i.Dictionary(20)}get LastSaveTime(){return this._lastSaveTime}set LastSaveTime(e){this._lastSaveTime=e}get PgvPaiting(){return this.pgvPainting}set PgvPaiting(e){this.pgvPainting=e}get ViewMode(){return this.viewMode}get EmrWorkMode(){return this.workMode}set EmrWorkMode(e){this.workMode=e}Clear(){this.ctxtHMap.Clear(),this.ResetLastSaveTime(),this.pgvPainting=null}GetValue(e){let t=this.ctxtHMap.TryGetValue(e);return t[0]?t[1]:null}SetValue(e,t){this.ctxtHMap.Set(e,t)}GetPageNumInfo(e){if(null==this.pgvPainting)return-1;let t=-1;if(null!=e){if("[%NumOfPages%]"==e||"[%LocalNumOfPages%]"==e){let n=this.GetValue(e);t=s.CNumUtil.TryParseInt(n,0)}"[%LocalPageIndex%]"==e&&(t=1+this.pgvPainting.LocalPageIx),"[%PageIndex%]"==e&&(t=1+this.pgvPainting.PageIx)}return t}CopyFrom(e){this.Clear();let t=e.ctxtHMap.GetEnumerator();for(;t.MoveNext();){let e=t.Current;this.ctxtHMap.Add(e.Key,e.Value)}this.LastSaveTime=e.LastSaveTime,this.workMode=e.workMode}ResetLastSaveTime(){this.LastSaveTime=l.DateTime.Today()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.where=t.union=t.toList=t.toDictionary=t.toArray=t.takeWhile=t.take=t.sum=t.skipWhile=t.skip=t.singleOrDefault=t.single=t.sequenceEqual=t.selectMany=t.select=t.reverse=t.min=t.max=t.lastOrDefault=t.last=t.join=t.intersect=t.groupJoin=t.groupBy=t.firstOrDefaultWithArray=t.firstOrDefault=t.first=t.except=t.empty=t.elementAtOrDefault=t.elementAt=t.distinct=t.defaultIfEmpty=t.count=t.contains=t.concat=t.average=t.asEnumerable=t.anyWithArray=t.any=t.allWithArray=t.all=void 0;var r=n(420);Object.defineProperty(t,"all",{enumerable:!0,get:function(){return r.all}}),Object.defineProperty(t,"allWithArray",{enumerable:!0,get:function(){return r.allWithArray}});var i=n(439);Object.defineProperty(t,"any",{enumerable:!0,get:function(){return i.any}}),Object.defineProperty(t,"anyWithArray",{enumerable:!0,get:function(){return i.anyWithArray}});var l=n(440);Object.defineProperty(t,"asEnumerable",{enumerable:!0,get:function(){return l.asEnumerable}});var s=n(441);Object.defineProperty(t,"average",{enumerable:!0,get:function(){return s.average}});var o=n(442);Object.defineProperty(t,"concat",{enumerable:!0,get:function(){return o.concat}});var a=n(448);Object.defineProperty(t,"contains",{enumerable:!0,get:function(){return a.contains}});var u=n(449);Object.defineProperty(t,"count",{enumerable:!0,get:function(){return u.count}});var h=n(450);Object.defineProperty(t,"defaultIfEmpty",{enumerable:!0,get:function(){return h.defaultIfEmpty}});var d=n(451);Object.defineProperty(t,"distinct",{enumerable:!0,get:function(){return d.distinct}});var c=n(452);Object.defineProperty(t,"elementAt",{enumerable:!0,get:function(){return c.elementAt}});var p=n(453);Object.defineProperty(t,"elementAtOrDefault",{enumerable:!0,get:function(){return p.elementAtOrDefault}});var f=n(454);Object.defineProperty(t,"empty",{enumerable:!0,get:function(){return f.empty}});var g=n(455);Object.defineProperty(t,"except",{enumerable:!0,get:function(){return g.except}});var m=n(456);Object.defineProperty(t,"first",{enumerable:!0,get:function(){return m.first}});var E=n(257);Object.defineProperty(t,"firstOrDefault",{enumerable:!0,get:function(){return E.firstOrDefault}});var C=n(257);Object.defineProperty(t,"firstOrDefaultWithArray",{enumerable:!0,get:function(){return C.firstOrDefaultWithArray}});var A=n(457);Object.defineProperty(t,"groupBy",{enumerable:!0,get:function(){return A.groupBy}});var y=n(459);Object.defineProperty(t,"groupJoin",{enumerable:!0,get:function(){return y.groupJoin}});var I=n(460);Object.defineProperty(t,"intersect",{enumerable:!0,get:function(){return I.intersect}});var S=n(461);Object.defineProperty(t,"join",{enumerable:!0,get:function(){return S.join}});var _=n(462);Object.defineProperty(t,"last",{enumerable:!0,get:function(){return _.last}});var w=n(463);Object.defineProperty(t,"lastOrDefault",{enumerable:!0,get:function(){return w.lastOrDefault}});var b=n(464);Object.defineProperty(t,"max",{enumerable:!0,get:function(){return b.max}});var x=n(465);Object.defineProperty(t,"min",{enumerable:!0,get:function(){return x.min}});var P=n(466);Object.defineProperty(t,"reverse",{enumerable:!0,get:function(){return P.reverse}});var v=n(467);Object.defineProperty(t,"select",{enumerable:!0,get:function(){return v.select}});var T=n(468);Object.defineProperty(t,"selectMany",{enumerable:!0,get:function(){return T.selectMany}});var M=n(469);Object.defineProperty(t,"sequenceEqual",{enumerable:!0,get:function(){return M.sequenceEqual}});var L=n(470);Object.defineProperty(t,"single",{enumerable:!0,get:function(){return L.single}});var D=n(471);Object.defineProperty(t,"singleOrDefault",{enumerable:!0,get:function(){return D.singleOrDefault}});var R=n(472);Object.defineProperty(t,"skip",{enumerable:!0,get:function(){return R.skip}});var F=n(473);Object.defineProperty(t,"skipWhile",{enumerable:!0,get:function(){return F.skipWhile}});var N=n(474);Object.defineProperty(t,"sum",{enumerable:!0,get:function(){return N.sum}});var B=n(475);Object.defineProperty(t,"take",{enumerable:!0,get:function(){return B.take}});var k=n(476);Object.defineProperty(t,"takeWhile",{enumerable:!0,get:function(){return k.takeWhile}});var O=n(477);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return O.toArray}});var G=n(478);Object.defineProperty(t,"toDictionary",{enumerable:!0,get:function(){return G.toDictionary}});var X=n(480);Object.defineProperty(t,"toList",{enumerable:!0,get:function(){return X.toList}});var V=n(481);Object.defineProperty(t,"union",{enumerable:!0,get:function(){return V.union}});var H=n(482);Object.defineProperty(t,"where",{enumerable:!0,get:function(){return H.where}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.allWithArray=t.all=void 0;const r=n(31),i=n(15);t.all=function(e,t){i.throws.ThrowIfNull("source",e),i.throws.ThrowIfNull("predicate",t);for(let n of e)if(!t(n))return!1;return r.Enumerable.Any(e)},t.allWithArray=function(e,t){i.throws.ThrowIfNull("source",e),i.throws.ThrowIfNull("predicate",t);for(let n=0;n<e.length;n++)if(!t(e[n]))return!1;return r.Enumerable.AnyWithArray(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThrowInvalidOperation=t.ThrowIfNull=void 0;const r=n(5);t.ThrowIfNull=function(e,t){if(null==t)throw new r.ArgumentNullException(e)},t.ThrowInvalidOperation=function(e){throw new r.InvalidOperationException(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentException=void 0;const r=n(5);class i extends r.Exception{constructor(e,t){super(function(e,t){if(t)return t;if(e)return`参数 ${e} 存在异常`;return"参数存在异常"}(e,t)),this.paramName=e}get ParamName(){return this.paramName}}t.ArgumentException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentNullException=void 0;const r=n(5);class i extends r.ArgumentException{constructor(e,t){super(e,function(e,t){if(t)return t;if(e)return`参数 ${e} 不可为空`;return"参数不可为空"}(e,t))}}t.ArgumentNullException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidOperationException=void 0;const r=n(190);class i extends r.Exception{constructor(e){super(e||"操作无效")}}t.InvalidOperationException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyNotFoundException=void 0;const r=n(190);class i extends r.Exception{constructor(e){super(e||"不存在的Key")}}t.KeyNotFoundException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentOutOfRangeException=void 0;const r=n(5);class i extends r.ArgumentException{constructor(e,t,n){super(e,function(e,t,n){if(n)return n;if(e)return void 0!==t?`参数 ${e} 的范围越界 ${t}`:`参数 ${e} 的范围越界`;return"数组下标越界"}(e,t,n)),this.actualValue=t}get ActualValue(){return this.actualValue}}t.ArgumentOutOfRangeException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayIndexOutOfBoundsException=void 0;const r=n(191);class i extends r.IndexOutOfBoundsException{constructor(e,t){super(t),this.index=e,this.message=t}}t.ArrayIndexOutOfBoundsException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArithmeticException=void 0;const r=n(5);class i extends r.Exception{}t.ArithmeticException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChecksumException=void 0;const r=n(5);class i extends r.Exception{static getChecksumInstance(){return new i}}t.ChecksumException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormatException=void 0;const r=n(5);class i extends r.Exception{static getFormatInstance(){return new i}}t.FormatException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IllegalArgumentException=void 0;const r=n(5);class i extends r.Exception{}t.IllegalArgumentException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IllegalStateException=void 0;const r=n(5);class i extends r.Exception{}t.IllegalStateException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundException=void 0;const r=n(5);class i extends r.Exception{static getNotFoundInstance(){return new i}}t.NotFoundException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReaderException=void 0;const r=n(5);class i extends r.Exception{}t.ReaderException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReedSolomonException=void 0;const r=n(5);class i extends r.Exception{}t.ReedSolomonException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnsupportedOperationException=void 0;const r=n(5);class i extends r.Exception{}t.UnsupportedOperationException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WriterException=void 0;const r=n(5);class i extends r.Exception{}t.WriterException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IsNullOrUndefined=void 0;const r=n(255),i=n(256);t.IsNullOrUndefined=function(e){return r.IsNull(e)||i.IsUndefined(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anyWithArray=t.any=void 0;const r=n(15);t.any=function(e,t){r.throws.ThrowIfNull("source",e),t=t||(()=>!0);for(let n of e)if(t(n))return!0;return!1},t.anyWithArray=function(e,t){if(!t)return e.length>0;for(let n=0;n<e.length;n++)if(t(e[n]))return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asEnumerable=void 0,t.asEnumerable=function(e){return[...e]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.average=void 0;const r=n(31),i=n(15),l=n(5);t.average=function(e,t){if(i.throws.ThrowIfNull("source",e),!r.Enumerable.Any(e))return null;t=t||(e=>{if(i.IsNullOrUndefined(e))return null;if("number"==typeof e)return e;throw new l.ArgumentNullException("selector","数值类型以外的数组必须传入 selector")});let n=0,s=0,o=!0;for(let r of e){let e=t(r);i.IsNullOrUndefined(e)||(o=!1,n+=e),s++}return o?null:n/s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=void 0;const r=n(31),i=n(15),l=n(97);t.concat=function(e,t){return i.throws.ThrowIfNull("first",e),i.throws.ThrowIfNull("second",t),r.Enumerable.AsEnumerable(l.concat(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=void 0,t.concat=function(e,t){return{*[Symbol.iterator](){yield*e,yield*t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distinct=void 0,t.distinct=function e(t,n){if(t){let r;n=n||((e,t)=>e===t);let i=!0,l=new Array,s=0;for(let e of t)s++,i?(r=e,i=!1):n(r,e)||l.push(e);if(s)return l.length?[r,...e(l,n)]:[r]}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.except=void 0;const r=n(192);function*i(e,t,n){for(let i of e)r.contains(t,i,n)||(yield i)}t.except=function(e,t,n){return e&&t?[...i(e,t,n=n||((e,t)=>e===t))]:e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.group=void 0,t.group=function e(t,n,r,i){if(t){let l=new Array;i=i||((e,t)=>e===t);let s={},o=!0,a=new Array,u=new Array,h=0;for(let e of t)if(o){if(null==e)continue;s.Key=n(e),a.push(r(e)),o=!1,h++}else h++,i(s.Key,n(e))?a.push(r(e)):u.push(e);return h?(s.List=a,u.length?[s,...e(u,n,r,i)]:[s]):l}return void 0===t?void 0:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.intersect=void 0;const r=n(192);function*i(e,t,n){for(let i of e)r.contains(t,i,n)&&(yield i)}t.intersect=function(e,t,n){return e&&t?[...i(e,t,n=n||((e,t)=>e===t))]:e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contains=void 0;const r=n(71),i=n(15),l=n(97);t.contains=function(e,t,n){return i.throws.ThrowIfNull("source",e),n=n||r.EqualityComparer.Default(),l.contains(e,t,(e,t)=>n.Equals(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.count=void 0;const r=n(15);t.count=function(e,t){r.throws.ThrowIfNull("source",e),t=t||(()=>!0);let n=0;for(let r of e)t(r)&&n++;return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultIfEmpty=void 0;const r=n(31),i=n(15);t.defaultIfEmpty=function(e,t){i.throws.ThrowIfNull("source",e);let n=[...e];return n.length?n:t||r.Enumerable.Empty()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distinct=void 0;const r=n(31),i=n(71),l=n(15),s=n(97);t.distinct=function(e,t){return l.throws.ThrowIfNull("source",e),r.Enumerable.Any(e)?(t=t||i.EqualityComparer.Default(),r.Enumerable.AsEnumerable(s.distinct(e,(e,n)=>t.Equals(e,n)))):r.Enumerable.Empty()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementAt=void 0;const r=n(5),i=n(15);t.elementAt=function(e,t){if(i.throws.ThrowIfNull("source",e),t<0)throw new r.ArgumentOutOfRangeException("index",t);let n=0;for(let r of e){if(n===t)return r;n++}throw new r.ArgumentOutOfRangeException("index",t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementAtOrDefault=void 0;const r=n(15);t.elementAtOrDefault=function(e,t,n){if(r.throws.ThrowIfNull("source",e),n<0)return t;let i=0;for(let t of e){if(i===n)return t;i++}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.empty=void 0,t.empty=function(){return[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.except=void 0;const r=n(31),i=n(71),l=n(15),s=n(97);t.except=function(e,t,n){return l.throws.ThrowIfNull("first",e),l.throws.ThrowIfNull("second",t),n=n||i.EqualityComparer.Default(),r.Enumerable.AsEnumerable(s.except(s.distinct(e,(e,t)=>n.Equals(e,t)),s.distinct(t,(e,t)=>n.Equals(e,t)),(e,t)=>n.Equals(e,t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.first=void 0;const r=n(15);t.first=function(e,t){r.throws.ThrowIfNull("source",e);for(let n of e){if(!t)return n;if(t(n))return n}t?r.throws.ThrowInvalidOperation("没有元素满足条件或源序列为空"):r.throws.ThrowInvalidOperation("源序列为空")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.groupBy=void 0;const r=n(31),i=n(71),l=n(458),s=n(15),o=n(97);t.groupBy=function(e,t,n,a){s.throws.ThrowIfNull("source",e),s.throws.ThrowIfNull("keySelector",t);let u=n||(e=>e);return a=a||i.EqualityComparer.Default(),r.Enumerable.AsEnumerable(o.group(e,t,u,(e,t)=>a.Equals(e,t)).map(e=>new l.Grouping(e.Key,r.Enumerable.AsEnumerable(e.List))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Grouping=void 0;const r=n(31);class i{constructor(e,t){this.key=e,this.source=t}GetEnumerator(){throw new Error("Method not implemented.")}get Key(){return this.key}get Items(){return this.source}[Symbol.iterator](){return this.source[Symbol.iterator]()}All(e){return r.Enumerable.All(this,e)}Any(e){return r.Enumerable.Any(this,e)}AsEnumerable(){return r.Enumerable.AsEnumerable(this.source)}Average(e){return r.Enumerable.Average(this,e)}Concat(e){return r.Enumerable.Concat(this,e)}Contains(e,t){return r.Enumerable.Contains(this,e,t)}Count(e){return r.Enumerable.Count(this,e)}DefaultIfEmpty(e){return r.Enumerable.DefaultIfEmpty(this,e)}Distinct(e){return r.Enumerable.Distinct(this,e)}ElementAt(e){return r.Enumerable.ElementAt(this,e)}ElementAtOrDefault(e,t){return r.Enumerable.ElementAtOrDefault(this,e,t)}Except(e,t){return r.Enumerable.Except(this,e,t)}First(e){return r.Enumerable.First(this,e)}FirstOrDefault(e,t){return r.Enumerable.FirstOrDefault(this,e,t)}GroupBy(e,t,n){return r.Enumerable.GroupBy(this,e,t,n)}GroupJoin(e,t,n,i,l){return r.Enumerable.GroupJoin(this,e,t,n,i,l)}Intersect(e,t){return r.Enumerable.Intersect(this,e,t)}Join(e,t,n,i,l){return r.Enumerable.Join(this,e,t,n,i,l)}Last(e){return r.Enumerable.Last(this,e)}LastOrDefault(e,t){return r.Enumerable.LastOrDefault(this,e,t)}Max(e){return r.Enumerable.Max(this,e)}Min(e){return r.Enumerable.Min(this,e)}Reverse(){return r.Enumerable.Reverse(this)}Select(e){return r.Enumerable.Select(this,e)}SelectMany(e,t){return r.Enumerable.SelectMany(this,e,t)}SequenceEqual(e,t){return r.Enumerable.SequenceEqual(this,e,t)}Single(e){return r.Enumerable.Single(this,e)}SingleOrDefault(e,t){return r.Enumerable.SingleOrDefault(this,e,t)}Skip(e){return r.Enumerable.Skip(this,e)}SkipWhile(e){return r.Enumerable.SkipWhile(this,e)}Sum(e){return r.Enumerable.Sum(this,e)}Take(e){return r.Enumerable.Take(this,e)}TakeWhile(e){return r.Enumerable.TakeWhile(this,e)}ToArray(){return r.Enumerable.ToArray(this)}ToDictionary(e,t,n){return r.Enumerable.ToDictionary(this,e,t,n)}ToList(){return r.Enumerable.ToList(this)}Union(e,t){return r.Enumerable.Union(this,e,t)}Where(e){return r.Enumerable.Where(this,e)}}t.Grouping=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.groupJoin=void 0;const r=n(31),i=n(71),l=n(15);t.groupJoin=function(e,t,n,s,o,a){l.throws.ThrowIfNull("outer",e),l.throws.ThrowIfNull("inner",t),l.throws.ThrowIfNull("outerKeySelector",n),l.throws.ThrowIfNull("innerKeySelector",s);let u=o||((e,t)=>({Outer:e,Inners:t}));a=a||i.EqualityComparer.Default();let h=r.Enumerable.ToList(r.Enumerable.Select(e,e=>n(e))),d=r.Enumerable.ToList(r.Enumerable.GroupBy(r.Enumerable.Where(t,e=>r.Enumerable.Contains(h,s(e),a)),e=>s(e),e=>e,a));return r.Enumerable.AsEnumerable(function*(e,t,n,i,l){for(let s of e){let e=t(s),o=r.Enumerable.FirstOrDefault(n,null,t=>l.Equals(t.Key,e));o=o?r.Enumerable.ToList(o):r.Enumerable.Empty(),yield i(s,o)}}(e,n,d,u,a))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.intersect=void 0;const r=n(31),i=n(71),l=n(15),s=n(97);t.intersect=function(e,t,n){return l.throws.ThrowIfNull("first",e),l.throws.ThrowIfNull("second",t),n=n||i.EqualityComparer.Default(),r.Enumerable.AsEnumerable(s.intersect(s.distinct(e,(e,t)=>n.Equals(e,t)),s.distinct(t,(e,t)=>n.Equals(e,t)),(e,t)=>n.Equals(e,t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.join=void 0;const r=n(31),i=n(71),l=n(15);t.join=function(e,t,n,s,o,a){l.throws.ThrowIfNull("outer",e),l.throws.ThrowIfNull("inner",t),l.throws.ThrowIfNull("outerKeySelector",n),l.throws.ThrowIfNull("innerKeySelector",s);let u=o||((e,t)=>({Outer:e,Inner:t}));a=a||i.EqualityComparer.Default();let h=r.Enumerable.ToList(r.Enumerable.Select(e,e=>n(e))),d=r.Enumerable.ToList(r.Enumerable.GroupBy(r.Enumerable.Where(t,e=>r.Enumerable.Contains(h,s(e),a)),e=>s(e),e=>e,a));return r.Enumerable.AsEnumerable(function*(e,t,n,i,l){for(let s of e){let e=t(s),o=r.Enumerable.FirstOrDefault(n,null,t=>l.Equals(t.Key,e));if(o&&r.Enumerable.Any(o))for(let e of o)yield i(s,e)}}(e,n,d,u,a))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.last=void 0;const r=n(15);t.last=function(e,t){r.throws.ThrowIfNull("source",e);let n,i=!1;for(let r of e)t?t(r)&&(n=r,i=!0):(n=r,i=!0);if(i)return n;t?r.throws.ThrowInvalidOperation("没有元素满足条件或源序列为空"):r.throws.ThrowInvalidOperation("源序列为空")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lastOrDefault=void 0;const r=n(15);t.lastOrDefault=function(e,t,n){r.throws.ThrowIfNull("source",e);let i,l=!1;for(let t of e)n?n(t)&&(i=t,l=!0):(i=t,l=!0);return l?i:t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.max=void 0;const r=n(5),i=n(15);t.max=function(e,t){i.throws.ThrowIfNull("source",e),t=t||(e=>{if(i.IsNullOrUndefined(e))return null;if("number"==typeof e)return e;throw new r.ArgumentNullException("selector","数值类型以外的数组必须传入 selector")});let n,l=!1;for(let r of e){let e=t(r);i.IsNullOrUndefined(e)||(l?e>n&&(n=e):(n=e,l=!0))}return l?n:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.min=void 0;const r=n(5),i=n(15);t.min=function(e,t){i.throws.ThrowIfNull("source",e),t=t||(e=>{if(i.IsNullOrUndefined(e))return null;if("number"==typeof e)return e;throw new r.ArgumentNullException("selector","数值类型以外的数组必须传入 selector")});let n,l=!1;for(let r of e){let e=t(r);i.IsNullOrUndefined(e)||(l?e<n&&(n=e):(n=e,l=!0))}return l?n:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reverse=void 0;const r=n(31),i=n(15);t.reverse=function(e){return i.throws.ThrowIfNull("source",e),r.Enumerable.AsEnumerable([...e].reverse())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.select=void 0;const r=n(31),i=n(15);t.select=function(e,t){return i.throws.ThrowIfNull("source",e),i.throws.ThrowIfNull("selector",t),r.Enumerable.AsEnumerable(function*(e,t){let n=0;for(let r of e)yield t(r,n++)}(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectMany=void 0;const r=n(31),i=n(15);t.selectMany=function(e,t,n){i.throws.ThrowIfNull("source",e),i.throws.ThrowIfNull("collectionSelector",t);let l=n||((e,t)=>t);return r.Enumerable.AsEnumerable(function*(e,t,n){let r=0;for(let i of e){let e=t(i,r++);if(e)for(let t of e)yield n(i,t)}}(e,t,l))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sequenceEqual=void 0;const r=n(71),i=n(15);t.sequenceEqual=function(e,t,n){i.throws.ThrowIfNull("first",e),i.throws.ThrowIfNull("second",t),n=n||r.EqualityComparer.Default();let l=e[Symbol.iterator](),s=t[Symbol.iterator]();for(;;){let e=l.next(),t=s.next();if(e.done)return t.done;if(t.done)return!1;if(!n.Equals(e.value,t.value))return!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.single=void 0;const r=n(15);t.single=function(e,t){r.throws.ThrowIfNull("source",e);let n,i=!1;for(let l of e)t?t(l)&&(i&&r.throws.ThrowInvalidOperation("输入的序列包含多个元素"),n=l,i=!0):(i&&r.throws.ThrowInvalidOperation("输入的序列包含多个元素"),n=l,i=!0);if(i)return n;t?r.throws.ThrowInvalidOperation("没有元素满足条件或源序列为空"):r.throws.ThrowInvalidOperation("源序列为空")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.singleOrDefault=void 0;const r=n(15);t.singleOrDefault=function(e,t,n){r.throws.ThrowIfNull("source",e);let i,l=!1;for(let t of e)n?n(t)&&(l&&r.throws.ThrowInvalidOperation("输入的序列包含多个元素"),i=t,l=!0):(l&&r.throws.ThrowInvalidOperation("输入的序列包含多个元素"),i=t,l=!0);return l?i:t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skip=void 0;const r=n(31),i=n(15);t.skip=function(e,t){return i.throws.ThrowIfNull("source",e),r.Enumerable.AsEnumerable(function*(e,t){let n=1;for(let r of e)n++>t&&(yield r)}(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skipWhile=void 0;const r=n(31),i=n(15);t.skipWhile=function(e,t){return i.throws.ThrowIfNull("source",e),i.throws.ThrowIfNull("predicate",t),r.Enumerable.AsEnumerable(function*(e,t){let n=0,r=!1;for(let i of e){if(!r){if(t(i,n++))continue;r=!0}yield i}}(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sum=void 0;const r=n(5),i=n(15);t.sum=function(e,t){i.throws.ThrowIfNull("source",e),t=t||(e=>{if(i.IsNullOrUndefined(e))return null;if("number"==typeof e)return e;throw new r.ArgumentNullException("selector","数值类型以外的数组必须传入 selector")});let n=0,l=!0;for(let r of e){let e=t(r);i.IsNullOrUndefined(e)||(l=!1,n+=e)}return l?null:n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.take=void 0;const r=n(31),i=n(15);t.take=function(e,t){return i.throws.ThrowIfNull("source",e),r.Enumerable.AsEnumerable(function*(e,t){let n=1;for(let r of e){if(n++>t)break;yield r}}(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.takeWhile=void 0;const r=n(31),i=n(15);t.takeWhile=function(e,t){return i.throws.ThrowIfNull("source",e),i.throws.ThrowIfNull("predicate",t),r.Enumerable.AsEnumerable(function*(e,t){let n=0;for(let r of e){if(!t(r,n++))break;yield r}}(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toArray=void 0;const r=n(15);t.toArray=function(e){return r.throws.ThrowIfNull("source",e),[...e]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toDictionary=void 0;const r=n(193),i=n(71),l=n(15);t.toDictionary=function(e,t,n,s){l.throws.ThrowIfNull("source",e),l.throws.ThrowIfNull("keySelector",t);let o=n||(e=>e);s=s||i.EqualityComparer.Default();let a=new r.Dictionary(null,s);for(let n of e){let e=t(n),r=o(n);a.Add(e,r)}return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyValuePair=void 0;t.KeyValuePair=class{constructor(e,t){this.key=e,this.value=t}get Key(){return this.key}get Value(){return this.value}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toList=void 0;const r=n(38),i=n(15);t.toList=function(e){return i.throws.ThrowIfNull("source",e),new r.List(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.union=void 0;const r=n(31),i=n(71),l=n(15),s=n(97);t.union=function(e,t,n){return l.throws.ThrowIfNull("first",e),l.throws.ThrowIfNull("second",t),n=n||i.EqualityComparer.Default(),r.Enumerable.AsEnumerable(s.distinct(s.concat(e,t),(e,t)=>n.Equals(e,t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.where=void 0;const r=n(31),i=n(15);t.where=function(e,t){return i.throws.ThrowIfNull("source",e),i.throws.ThrowIfNull("predicate",t),r.Enumerable.AsEnumerable(function*(e,t){let n=0;for(let r of e)t(r,n++)&&(yield r)}(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadOnlyList=void 0;const r=n(194);class i extends r.ReadOnlyCollection{constructor(e){super(e)}}t.ReadOnlyList=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardPapers=void 0;const r=n(261),i=n(3),l=n(4);class s{constructor(){this.Serial_A="A",this.Serial_B="B",this.Serial_C="C",this.std_ppseries_dict=null,this.std_ppseries_dict=new i.Dictionary,this._InitStdPapers(this.Serial_A,13,841,1189),this._InitStdPapers(this.Serial_B,13,1e3,1414),this._InitStdPapers(this.Serial_C,13,917,1297)}static GetInstance(){return null==s._instance&&null==s._instance&&(s._instance=new s),s._instance}GetStdPaperSz1(e){let t;if(l.default.IsNullOrEmpty(e))t=null;else if(e.length<=1)t=null;else{let n=e[0],[r,i]=this.std_ppseries_dict.TryGetValue(n);if(null==i)t=null;else{if(0==i.Count())t=null;else{let n=parseInt(e.substring(1));if(n)t=null;else if(n<0||n>=i.Count())t=null;else{t=i.Get(n)}}}}return t}GetStdPaperSz2(e,t=0){let n,r=this.GetStdPaperSz3(this.Serial_A,e,t);return null!=r?n=r:(r=this.GetStdPaperSz3(this.Serial_B,e,t),null!=r?n=r:(r=this.GetStdPaperSz3(this.Serial_C,e,t),n=null!=r?r:null)),n}GetStdPaperSz3(e,t,n=0){let r,[i,l]=this.std_ppseries_dict.TryGetValue(e);if(null==l||0==l.Count())r=null;else{let e=null;for(let r of l){let i=parseInt(r.getPrtPaperCalcSize().getWidthAsMM()-t+""),l=n<=0?0:parseInt(r.getPrtPaperCalcSize().getHeightAsMM()-n+"");if(i>=-2&&i<=2&&l>=-2&&l<=2){e=r;break}}r=e}return r}_InitStdPapers(e,t,n,s){let o=new i.List;this.std_ppseries_dict.Add(e,o);let a=n,u=s;for(let n=0;n<t;n++){let t=new r.PaperSizeExt;o.Add(t),t.setPrtPaperSize2(l.default.Format("{0}{1}",e,n),a,u);let i=u;u=a,a=i/2}}}t.StandardPapers=s,s._instance=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaperSize=void 0;t.PaperSize=class{constructor(e,t,n){}get Height(){return null}set Height(e){}get Kind(){return null}get PaperName(){return null}set PaperName(e){}get RawKind(){return null}set RawKind(e){}get Width(){return null}set Width(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaperKind=void 0,function(e){e[e.Custom=0]="Custom",e[e.Letter=1]="Letter",e[e.LetterSmall=2]="LetterSmall",e[e.Tabloid=3]="Tabloid",e[e.Ledger=4]="Ledger",e[e.Legal=5]="Legal",e[e.Statement=6]="Statement",e[e.Executive=7]="Executive",e[e.A3=8]="A3",e[e.A4=9]="A4",e[e.A4Small=10]="A4Small",e[e.A5=11]="A5",e[e.B4=12]="B4",e[e.B5=13]="B5",e[e.Folio=14]="Folio",e[e.Quarto=15]="Quarto",e[e.Standard10x14=16]="Standard10x14",e[e.Standard11x17=17]="Standard11x17",e[e.Note=18]="Note",e[e.Number9Envelope=19]="Number9Envelope",e[e.Number10Envelope=20]="Number10Envelope",e[e.Number11Envelope=21]="Number11Envelope",e[e.Number12Envelope=22]="Number12Envelope",e[e.Number14Envelope=23]="Number14Envelope",e[e.CSheet=24]="CSheet",e[e.DSheet=25]="DSheet",e[e.ESheet=26]="ESheet",e[e.DLEnvelope=27]="DLEnvelope",e[e.C5Envelope=28]="C5Envelope",e[e.C3Envelope=29]="C3Envelope",e[e.C4Envelope=30]="C4Envelope",e[e.C6Envelope=31]="C6Envelope",e[e.C65Envelope=32]="C65Envelope",e[e.B4Envelope=33]="B4Envelope",e[e.B5Envelope=34]="B5Envelope",e[e.B6Envelope=35]="B6Envelope",e[e.ItalyEnvelope=36]="ItalyEnvelope",e[e.MonarchEnvelope=37]="MonarchEnvelope",e[e.PersonalEnvelope=38]="PersonalEnvelope",e[e.USStandardFanfold=39]="USStandardFanfold",e[e.GermanStandardFanfold=40]="GermanStandardFanfold",e[e.GermanLegalFanfold=41]="GermanLegalFanfold",e[e.IsoB4=42]="IsoB4",e[e.JapanesePostcard=43]="JapanesePostcard",e[e.Standard9x11=44]="Standard9x11",e[e.Standard10x11=45]="Standard10x11",e[e.Standard15x11=46]="Standard15x11",e[e.InviteEnvelope=47]="InviteEnvelope",e[e.LetterExtra=50]="LetterExtra",e[e.LegalExtra=51]="LegalExtra",e[e.TabloidExtra=52]="TabloidExtra",e[e.A4Extra=53]="A4Extra",e[e.LetterTransverse=54]="LetterTransverse",e[e.A4Transverse=55]="A4Transverse",e[e.LetterExtraTransverse=56]="LetterExtraTransverse",e[e.APlus=57]="APlus",e[e.BPlus=58]="BPlus",e[e.LetterPlus=59]="LetterPlus",e[e.A4Plus=60]="A4Plus",e[e.A5Transverse=61]="A5Transverse",e[e.B5Transverse=62]="B5Transverse",e[e.A3Extra=63]="A3Extra",e[e.A5Extra=64]="A5Extra",e[e.B5Extra=65]="B5Extra",e[e.A2=66]="A2",e[e.A3Transverse=67]="A3Transverse",e[e.A3ExtraTransverse=68]="A3ExtraTransverse",e[e.JapaneseDoublePostcard=69]="JapaneseDoublePostcard",e[e.A6=70]="A6",e[e.JapaneseEnvelopeKakuNumber2=71]="JapaneseEnvelopeKakuNumber2",e[e.JapaneseEnvelopeKakuNumber3=72]="JapaneseEnvelopeKakuNumber3",e[e.JapaneseEnvelopeChouNumber3=73]="JapaneseEnvelopeChouNumber3",e[e.JapaneseEnvelopeChouNumber4=74]="JapaneseEnvelopeChouNumber4",e[e.LetterRotated=75]="LetterRotated",e[e.A3Rotated=76]="A3Rotated",e[e.A4Rotated=77]="A4Rotated",e[e.A5Rotated=78]="A5Rotated",e[e.B4JisRotated=79]="B4JisRotated",e[e.B5JisRotated=80]="B5JisRotated",e[e.JapanesePostcardRotated=81]="JapanesePostcardRotated",e[e.JapaneseDoublePostcardRotated=82]="JapaneseDoublePostcardRotated",e[e.A6Rotated=83]="A6Rotated",e[e.JapaneseEnvelopeKakuNumber2Rotated=84]="JapaneseEnvelopeKakuNumber2Rotated",e[e.JapaneseEnvelopeKakuNumber3Rotated=85]="JapaneseEnvelopeKakuNumber3Rotated",e[e.JapaneseEnvelopeChouNumber3Rotated=86]="JapaneseEnvelopeChouNumber3Rotated",e[e.JapaneseEnvelopeChouNumber4Rotated=87]="JapaneseEnvelopeChouNumber4Rotated",e[e.B6Jis=88]="B6Jis",e[e.B6JisRotated=89]="B6JisRotated",e[e.Standard12x11=90]="Standard12x11",e[e.JapaneseEnvelopeYouNumber4=91]="JapaneseEnvelopeYouNumber4",e[e.JapaneseEnvelopeYouNumber4Rotated=92]="JapaneseEnvelopeYouNumber4Rotated",e[e.Prc16K=93]="Prc16K",e[e.Prc32K=94]="Prc32K",e[e.Prc32KBig=95]="Prc32KBig",e[e.PrcEnvelopeNumber1=96]="PrcEnvelopeNumber1",e[e.PrcEnvelopeNumber2=97]="PrcEnvelopeNumber2",e[e.PrcEnvelopeNumber3=98]="PrcEnvelopeNumber3",e[e.PrcEnvelopeNumber4=99]="PrcEnvelopeNumber4",e[e.PrcEnvelopeNumber5=100]="PrcEnvelopeNumber5",e[e.PrcEnvelopeNumber6=101]="PrcEnvelopeNumber6",e[e.PrcEnvelopeNumber7=102]="PrcEnvelopeNumber7",e[e.PrcEnvelopeNumber8=103]="PrcEnvelopeNumber8",e[e.PrcEnvelopeNumber9=104]="PrcEnvelopeNumber9",e[e.PrcEnvelopeNumber10=105]="PrcEnvelopeNumber10",e[e.Prc16KRotated=106]="Prc16KRotated",e[e.Prc32KRotated=107]="Prc32KRotated",e[e.Prc32KBigRotated=108]="Prc32KBigRotated",e[e.PrcEnvelopeNumber1Rotated=109]="PrcEnvelopeNumber1Rotated",e[e.PrcEnvelopeNumber2Rotated=110]="PrcEnvelopeNumber2Rotated",e[e.PrcEnvelopeNumber3Rotated=111]="PrcEnvelopeNumber3Rotated",e[e.PrcEnvelopeNumber4Rotated=112]="PrcEnvelopeNumber4Rotated",e[e.PrcEnvelopeNumber5Rotated=113]="PrcEnvelopeNumber5Rotated",e[e.PrcEnvelopeNumber6Rotated=114]="PrcEnvelopeNumber6Rotated",e[e.PrcEnvelopeNumber7Rotated=115]="PrcEnvelopeNumber7Rotated",e[e.PrcEnvelopeNumber8Rotated=116]="PrcEnvelopeNumber8Rotated",e[e.PrcEnvelopeNumber9Rotated=117]="PrcEnvelopeNumber9Rotated",e[e.PrcEnvelopeNumber10Rotated=118]="PrcEnvelopeNumber10Rotated"}(t.PaperKind||(t.PaperKind={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XColumnsParams=void 0;const r=n(10),i=n(8),l=n(14),s=n(21),o=n(4);t.XColumnsParams=class{constructor(e){this.colsCnt=0,this.colGap=0,this.showSptLine=!0,this.colLineIsDashed=!1,this.isAvgWidth=!0,this.arrColsWidth=null,this.paEle=null,this.paEle=e}get ColsCnt(){return this.colsCnt}set ColsCnt(e){this.colsCnt=e<0?0:e}get ColGap(){return this.colGap}set ColGap(e){this.colGap=e<12?12:e}get ShowSptLine(){return this.showSptLine}set ShowSptLine(e){this.showSptLine=e}get ColLineIsDashed(){return this.colLineIsDashed}set ColLineIsDashed(e){this.colLineIsDashed=e}get IsAvgWidth(){return this.isAvgWidth}set IsAvgWidth(e){this.isAvgWidth=e}Clear(){this.colsCnt=0,this.arrColsWidth=null,this.colGap=12,this.showSptLine=!0}XColumnsParams(e){this.paEle=e}GetGapWidth(e,t){return r.DPITransUtil.TransFloatVal(this.colGap,300,t)}CalcSptLinePos(e,t){let n;if(!this.showSptLine)return n=0,n;let i=this.ColsCnt;if(e<0||e>=i-1)return n=-1,n;let l=0;for(let t=0;t<=e;t++)l+=this.arrColsWidth[t]+this.colGap;return l-=this.colGap/2,l=r.DPITransUtil.TransFloatVal(l,300,t),n=l,n}GetColWidth(e,t){let n,i=this.ColsCnt;if(e<0||e>=i)n=-1;else{n=r.DPITransUtil.TransFloatVal(this.arrColsWidth[e],300,t)}return n}SumColsWidth(e,t){let n,i=this.ColsCnt;if(e>=i&&(e=i),e<0||e>i)n=-1;else{let i=0;for(let t=0;t<e;t++)i+=this.arrColsWidth[t]+this.colGap;i=r.DPITransUtil.TransFloatVal(i,300,t),n=i}return n}CalcColsAvgWidth(){if(!this.isAvgWidth)return!1;this.arrColsWidth=null;let e=this.ColsCnt;if(e<=0)return!1;let t=null==this.paEle?0:this.paEle.GetValidWidth(300);if(t<=(59+this.colGap)*e-this.colGap)return!1;this.arrColsWidth=[],t-=this.colGap*(e-1);let n=t/e;for(let t=0;t<e;t++)this.arrColsWidth[t]=n;return!0}ChangeColWidth(e,t,n){let i;if(this.isAvgWidth)return i=!1,i;let l=this.ColsCnt;if(e<0||e>=l-1)return i=!1,i;t=r.DPITransUtil.TransFloatVal(t,n,300);let s=this.arrColsWidth[e]+t,o=this.arrColsWidth[e+1]-t;return s<=59||o<=59?(i=!1,i):(this.arrColsWidth[e]=s,this.arrColsWidth[e+1]=o,i=!0,i)}ParseColsWidth(e){let t;if(this.arrColsWidth=null,null==e)return t=!1,t;if(0==(e=e.trim()).length)return t=!1,t;let n=e.split("|"),r=null==n?0:n.length;if(r<=0)return t=!1,t;this.arrColsWidth=[];for(let e=0;e<r;e++)this.arrColsWidth[e]=i.CNumUtil.TryParseFloat(n[e],59);return t=!0,t}BuildColsWidthStr(){let e,t=this.ColsCnt;if(t<=0)return e=null,e;let n=new s.default;for(let e=0;e<t;e++)n.append(o.default.Format("{0:#.##}",this.arrColsWidth[e])),e!=t-1&&n.append("|");let r=n.toString();return n.setLengthToZero(),e=r,e}ToXML(e){let t=e.createElement("PageCols");t.setAttribute("cnt",this.ColsCnt.toString());let n=e.createElement("ColGap");n.textContent=this.ColGap.toString(),t.appendChild(n);let r=e.createElement("SptLine");r.textContent=i.CNumUtil.ToStringForBool(this.showSptLine),t.appendChild(r);let l=e.createElement("ColLineIsDashed");if(l.textContent=i.CNumUtil.ToStringForBool(this.colLineIsDashed),t.appendChild(l),!this.isAvgWidth){let n=e.createElement("IsAvgWidth");n.textContent=this.isAvgWidth.toString(),t.appendChild(n)}if(!this.isAvgWidth&&this.colsCnt>1){let n=e.createElement("ColsWidth");n.textContent=this.BuildColsWidthStr(),t.appendChild(n)}return t}FromXML(e){if(null==e)return;let t=l.XmlDomUtil.GetSingleAttrValue(e,"cnt");this.ColsCnt=i.CNumUtil.TryParseInt(t,1);let n=l.XmlDomUtil.GetSingleNode(e,"ColGap");t=null==n?null:n.textContent,this.ColGap=i.CNumUtil.TryParseFloat(t,12),n=l.XmlDomUtil.GetSingleNode(e,"SptLine"),t=null==n?null:n.textContent,this.ShowSptLine=i.CNumUtil.TryParseBool(t,!0),n=l.XmlDomUtil.GetSingleNode(e,"ColLineIsDashed"),t=null==n?null:n.textContent,this.ColLineIsDashed=i.CNumUtil.TryParseBool(t,!1),n=l.XmlDomUtil.GetSingleNode(e,"IsAvgWidth"),t=null==n?null:n.textContent,this.IsAvgWidth=i.CNumUtil.TryParseBool(t,!0),this.colsCnt>1&&(this.IsAvgWidth?this.CalcColsAvgWidth():(n=l.XmlDomUtil.GetSingleNode(e,"ColsWidth"),t=null==n?null:n.textContent,this.ParseColsWidth(t)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextDocumentAssist=void 0;const r=n(62),i=n(489),l=n(6),s=n(0),o=n(10),a=n(140),u=n(111),h=n(2),d=n(713),c=n(213),p=n(3),f=n(138);t.XTextDocumentAssist=class{constructor(e){this.xdoc=null,this.msgBus=null,this.xdocXInputCache=null,this.calcEngine=null,this.xdoc=e,this.xdocXInputCache=new i.XDocXInputsCache,this.msgBus=new d.EleMsgBus}get MsgBus(){return this.msgBus}get XDocXInputCache(){return this.xdocXInputCache}get CalcEngine(){return this.calcEngine}set CalcEngine(e){this.calcEngine=e}CalcPagePanelLeft(e){let t=this.xdoc.GetPageFmt();return o.DPITransUtil.TransFloatVal(t.GetPagePaddWithGutter().Left,100,e)}CalcCmmtBarLeft(e){let t=0,n=this.xdoc.GetPageFmt();return t+=o.DPITransUtil.TransFloatVal(n.GetPagePaddWithGutter().Left,100,300),t+=this.xdoc.GetPagePanel(l.ENumPagePanelTp.Body).Width,o.DPITransUtil.TransFloatVal(t,300,e)}CalcCmmtBarWidth(e){return a.PageFormat.GetCmmtAreaWidth(e)}CalcPageBodyTop(e){if(this.xdoc.GetDocCtxt().ViewMode.IsWebViewMode)return 0;let t=this._CalcPageHeadHeight(e);return t+=o.DPITransUtil.TransFloatVal(1,96,e),t}CalcPageBodyBottom(e){let t=this.xdoc.GetPageFmt(),n=this._CalcPageFootHeight(e),r=t.GetHeightDPI(e);if(r-=n,this.xdoc.GetDocCtxt().ViewMode.IsWebViewMode){let t=this._CalcPageHeadHeight(e);t+=o.DPITransUtil.TransFloatVal(1,96,e),r-=t}return r}CalcPageBodyHeight(e){let t=this.CalcPageBodyTop(e);return this.CalcPageBodyBottom(e)-t}CalcPageBodyWidth(e){let t=this.xdoc.GetPagePanel(l.ENumPagePanelTp.Body);return o.DPITransUtil.TransFloatVal(t.Width,300,e)}_CalcPageHeadHeight(e){const t=this.xdoc.GetPageFmt(),n=this.xdoc.GetPagePanel(l.ENumPagePanelTp.Header),r=o.DPITransUtil.TransFloatVal(t.HeadTopMargin,100,e);let i=n.GetLinesHeight(!1,!1,e);i+=r;const s=o.DPITransUtil.TransFloatVal(t.GetPagePaddWithGutter().Top,100,e);return i>s?i:s}_CalcPageFootHeight(e){let t=this.xdoc.GetPageFmt(),n=this.xdoc.GetPagePanel(l.ENumPagePanelTp.Footer).GetLinesHeight(!1,!1,e);n+=o.DPITransUtil.TransFloatVal(t.FootBtmMargin,100,e);let r=o.DPITransUtil.TransFloatVal(t.GetPagePaddWithGutter().Bottom,100,e);return n>r?n:r}ChangeSecretStatus(e){let t=this.xdoc.GetDocParams();if(e!=t.IsSecret){let n=h.ENumSecretType.None;e&&(n=t.SecretType),this.xdoc.GetPagePanel(l.ENumPagePanelTp.Body).ChangeSecretType(n)}}ReverseSecretStatus(){let e=this.xdoc.GetDocParams();e.ReverseSecret();let t=e.IsSecret,n=h.ENumSecretType.None;t&&(n=e.SecretType),this.xdoc.GetPagePanel(l.ENumPagePanelTp.Body).ChangeSecretType(n)}RebuildCmmtBarLines(){let e=this.xdoc.GetPageFmt(),t=this.xdoc.GetPagePanel(l.ENumPagePanelTp.CmmtBar);e.ShowCmmtArea=t.ChildCount>0}Clear(){this.xdocXInputCache.Clear()}CopyXDocument2(){let e;if(null==this.xdoc)e=null;else{let t=this.xdoc.ToXML(),n=new r.XTextDocument(!1);n.FromXML(t),n.DocName=this.xdoc.DocName,e=n}return e}InsertBodyFrom(e,t,n,r,i,o){let a,d=new u.ResMessage;if(null==e)d.MsgLevel=2,d.MsgStr="InsertBody from XTextDocument is null.",a=d;else{let u=new c.NumberWrapper(-1),g=this._Find_BodyAddToContainer(u,t,d);if(u.Value<0||null==g)a=d;else{g instanceof s.XBaseInputEle&&(g.SetUnDoGroup(o),g.HideBackEle());let c=e.GetPagePanel(l.ENumPagePanelTp.Body);if(null!=i){let e=new p.List;c.GetChildrenByTypes(["XImage","XInputField"],!0,e,!0);for(let t of e)t.bussId=i}let m,E=c.GetChildArr(),C=E.length;if(g instanceof s.XStringEle){let e=g,t=E[0];n&&(t=s.XElementFactory.CreatXElement(t.EleTypeName,null),t.CopyFrom(E[0],!0,!1,!0)),u.Value=e.SplitSelf(u.Value,t,o),null!=r&&u.Value>-1&&(m=t),g=e.Parent,u.Value++;let i=new Array(C-1);if(C>1)for(let e=1;e<E.length;e++){let t=E[e];i[e-1]=t}E=i,C--}if(C>0){if(n)for(let e=0;e<C;e++){let t=E[e];E[e]=s.XElementFactory.CreatXElement(t.EleTypeName,null),E[e].CopyFrom(t,!0,!1,!0)}g.AddChildrenEle(u.Value,E);let e=new f.EleRangeAddDelUndo(E,u.Value,!0);if(o.AddItem(e),null!=r){let e=[...E];null!=m&&(e=[m,...e]),r.Execute3(h.ENumEdtType.Add,o,e)}}s.XDomUtil.IsBkgTextOfXInput(t)&&(t=g.GetFirstChildBaseEle(!1)),d.Clear(),a=d}}return a}_Find_BodyAddToContainer(e,t,n){let r,i;if(null==t)r=this.xdoc.GetPagePanel(l.ENumPagePanelTp.Body),e.Value=2147483647;else{let o=t.OwnerDocPanel;if(null==o)return n.MsgLevel=2,n.MsgStr="Add to doc-panel is null.",i=null,i;if(o.PagePanelTp!=l.ENumPagePanelTp.Body)return n.MsgLevel=2,n.MsgStr="Cann't insert a document into header or footer area.",i=null,i;let a=s.XDomUtil.GetParentXInput(t,!0);if(null!=a&&!s.XDomUtil.HasContent(a,!1))return e.Value=a.GetInsertIdx(),i=a,i;r=t.Parent,e.Value=r.GetChildInx(t)}return e.Value<0||null==r?(n.MsgLevel=2,n.MsgStr="InsertBody find no suitable parent to insert.",i=null):i=r,i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocXInputsCache=void 0;const r=n(3),i=n(4);t.XDocXInputsCache=class{constructor(){this.xinputCache=null,this.xidMap=null,this.phaseMap=null,this._BodyXInputCache=null,this._BodyAllXInputCache=null,this._BodyXChoiceCache=null,this._BodyParTakeQuoteXChoiceCache=null,this._BodyParTakeQuoteXInputCache=null,this.xinputCache=new r.Dictionary(20),this.BodyXInputCache=new r.List,this.BodyAllXInputCache=new r.List,this.BodyXChoiceCache=new r.List,this.BodyParTakeQuoteXChoiceCache=new r.List,this.BodyParTakeQuoteXInputCache=new r.List,this.xidMap=new Map,this.phaseMap=new Map}get BodyXInputCache(){return this._BodyXInputCache}set BodyXInputCache(e){this._BodyXInputCache=e}get BodyAllXInputCache(){return this._BodyAllXInputCache}set BodyAllXInputCache(e){this._BodyAllXInputCache=e}get BodyXChoiceCache(){return this._BodyXChoiceCache}set BodyXChoiceCache(e){this._BodyXChoiceCache=e}get BodyParTakeQuoteXChoiceCache(){return this._BodyParTakeQuoteXChoiceCache}set BodyParTakeQuoteXChoiceCache(e){this._BodyParTakeQuoteXChoiceCache=e}get BodyParTakeQuoteXInputCache(){return this._BodyParTakeQuoteXInputCache}set BodyParTakeQuoteXInputCache(e){this._BodyParTakeQuoteXInputCache=e}Clear(){for(let e of this.xinputCache){e.Value.Clear()}this.xinputCache.Clear()}TryCacheXInput(e){let t;if(null==e)t=!1;else{let n=e.Attr_TypeCode;if(i.default.IsNullOrEmpty(n))t=!1;else{let[i,l]=this.xinputCache.TryGetValue(n);i&&null!=l||(l=new r.List,this.xinputCache.Add(n,l)),i=!1,"1101"==n?i=this._TryAddPhaseEle(e,l):this.IsItemExist(e.Attr_TypeCode,e.XID)||(l.Add(e),this.xidMap.set(e.Attr_TypeCode+"-"+e.XID,!0),i=!0),t=i}}return t}_FindXinputListByTpCode(e){let t,[n,r]=this.xinputCache.TryGetValue(e);return t=n&&null!=r?r:null,t}IsItemExist(e,t){return!i.default.IsNullOrEmpty(e)&&!i.default.IsNullOrEmpty(t)&&this.xidMap.has(e+"-"+t)}_TryAddPhaseEle(e,t){if(null==e||"1101"!=e.Attr_TypeCode)return!1;return!t.Exists(t=>t.Attr_PhaseTypeCode==e.Attr_PhaseTypeCode)&&(t.Add(e),!0)}IsPhaseExist(e){let t;if(i.default.IsNullOrEmpty(e))t=!1;else{this.phaseMap.has("1101-"+e);let n=this._FindXinputListByTpCode("1101");if(null==n||n.Count()<=0)t=!1;else{t=n.Exists(t=>i.default.Equals(t.Attr_PhaseTypeCode,e))}}return t}GetPhaseEle(e){if(i.default.IsNullOrEmpty(e))return null;{let t=this._FindXinputListByTpCode("1101");return null==t||t.Count()<=0?null:t.Find(t=>i.default.Equals(t.Attr_PhaseTypeCode,e))}}RemoveItem(e,t){if(i.default.IsNullOrEmpty(e)||i.default.IsNullOrEmpty(t))return null;{let n=this._FindXinputListByTpCode(e);if(null==n||n.Count()<=0)return null;{let e=n.Find(e=>i.default.Equals(e.XID,t));return null!=e&&n.Remove(e),e}}}GetItem(e,t){if(i.default.IsNullOrEmpty(e)||i.default.IsNullOrEmpty(t))return null;{let n=this._FindXinputListByTpCode(e);return null==n||n.Count()<=0?null:n.Find(e=>i.default.Equals(e.XID,t))}}GetAllItems(){let e=new r.List;for(let t of this.xinputCache){let n=t.Value;e.AddRange(n)}let t=e.ToArray();return e.Clear(),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HotkeyPrefix=void 0,function(e){e[e.None=0]="None",e[e.Show=1]="Show",e[e.Hide=2]="Hide"}(t.HotkeyPrefix||(t.HotkeyPrefix={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Brush=void 0;t.Brush=class{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bitmap=void 0;const r=n(196);class i extends r.XImage{static FromHeightAndWidth(e,t){return null}SetResolution(e,t){return null}}t.Bitmap=i},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(494),t),i(n(498),t),i(n(98),t),i(n(505),t),i(n(512),t),i(n(544),t),i(n(545),t),i(n(292),t),i(n(549),t),i(n(268),t),i(n(550),t),i(n(269),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserAztecCodeReader=void 0;const r=n(98),i=n(197);class l extends r.BrowserCodeReader{constructor(e=500){super(new i.default,e)}}t.BrowserAztecCodeReader=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(128),i=n(101),l=n(129),s=n(36),o=n(84),a=n(5);var u;!function(e){e[e.UPPER=0]="UPPER",e[e.LOWER=1]="LOWER",e[e.MIXED=2]="MIXED",e[e.DIGIT=3]="DIGIT",e[e.PUNCT=4]="PUNCT",e[e.BINARY=5]="BINARY"}(u||(u={}));class h{decode(e){this.ddata=e;let t=e.getBits(),n=this.extractBits(t),i=this.correctBits(n),l=h.convertBoolArrayToByteArray(i),s=h.getEncodedData(i),o=new r.default(l,s,null,null);return o.setNumBits(i.length),o}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,n=u.UPPER,r=u.UPPER,i="",l=0;for(;l<t;)if(r===u.BINARY){if(t-l<5)break;let o=h.readCode(e,l,5);if(l+=5,0===o){if(t-l<11)break;o=h.readCode(e,l,11)+31,l+=11}for(let n=0;n<o;n++){if(t-l<8){l=t;break}const n=h.readCode(e,l,8);i+=s.StringUtils.castAsNonUtf8Char(n),l+=8}r=n}else{let s=r===u.DIGIT?4:5;if(t-l<s)break;let o=h.readCode(e,l,s);l+=s;let a=h.getCharacter(r,o);a.startsWith("CTRL_")?(n=r,r=h.getTable(a.charAt(5)),"L"===a.charAt(6)&&(n=r)):(i+=a,r=n)}return i}static getTable(e){switch(e){case"L":return u.LOWER;case"P":return u.PUNCT;case"M":return u.MIXED;case"D":return u.DIGIT;case"B":return u.BINARY;case"U":default:return u.UPPER}}static getCharacter(e,t){switch(e){case u.UPPER:return h.UPPER_TABLE[t];case u.LOWER:return h.LOWER_TABLE[t];case u.MIXED:return h.MIXED_TABLE[t];case u.PUNCT:return h.PUNCT_TABLE[t];case u.DIGIT:return h.DIGIT_TABLE[t];default:throw new a.IllegalStateException("Bad table")}}correctBits(e){let t,n;this.ddata.getNbLayers()<=2?(n=6,t=i.default.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,t=i.default.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,t=i.default.AZTEC_DATA_10):(n=12,t=i.default.AZTEC_DATA_12);let r=this.ddata.getNbDatablocks(),s=e.length/n;if(s<r)throw new a.FormatException;let o=e.length%n,u=new Int32Array(s);for(let t=0;t<s;t++,o+=n)u[t]=h.readCode(e,o,n);try{new l.default(t).decode(u,s-r)}catch(e){throw new a.FormatException(e)}let d=(1<<n)-1,c=0;for(let e=0;e<r;e++){let t=u[e];if(0===t||t===d)throw new a.FormatException;1!==t&&t!==d-1||c++}let p=new Array(r*n-c),f=0;for(let e=0;e<r;e++){let t=u[e];if(1===t||t===d-1)p.fill(t>1,f,f+n-1),f+=n-1;else for(let e=n-1;e>=0;--e)p[f++]=0!=(t&1<<e)}return p}extractBits(e){let t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),r=(t?11:14)+4*n,i=new Int32Array(r),l=new Array(this.totalBitsInLayer(n,t));if(t)for(let e=0;e<i.length;e++)i[e]=e;else{let e=r+1+2*o.default.truncDivision(o.default.truncDivision(r,2)-1,15),t=r/2,n=o.default.truncDivision(e,2);for(let e=0;e<t;e++){let r=e+o.default.truncDivision(e,15);i[t-e-1]=n-r-1,i[t+e]=n+r+1}}for(let s=0,o=0;s<n;s++){let a=4*(n-s)+(t?9:12),u=2*s,h=r-1-u;for(let t=0;t<a;t++){let n=2*t;for(let r=0;r<2;r++)l[o+n+r]=e.get(i[u+r],i[u+t]),l[o+2*a+n+r]=e.get(i[u+t],i[h-r]),l[o+4*a+n+r]=e.get(i[h-r],i[h-t]),l[o+6*a+n+r]=e.get(i[h-t],i[u+r])}o+=8*a}return l}static readCode(e,t,n){let r=0;for(let i=t;i<t+n;i++)r<<=1,e[i]&&(r|=1);return r}static readByte(e,t){let n=e.length-t;return n>=8?h.readCode(e,t,8):h.readCode(e,t,n)<<8-n}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let n=0;n<t.length;n++)t[n]=h.readByte(e,8*n);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}t.default=h,h.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],h.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],h.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","\t","\n","\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],h.PUNCT_TABLE=["","\r","\r\n",". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],h.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Point=void 0;const r=n(41),i=n(497),l=n(72),s=n(198),o=n(101),a=n(129),u=n(155),h=n(84),d=n(5);class c{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new r.default(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}t.Point=c;t.default=class{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){let e=n[0];n[0]=n[2],n[2]=e}this.extractParameters(n);let r=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),l=this.getMatrixCornerPoints(n);return new i.default(r,l,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!(this.isValidPoint(e[0])&&this.isValidPoint(e[1])&&this.isValidPoint(e[2])&&this.isValidPoint(e[3])))throw new d.NotFoundException;let t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);let r=0;for(let e=0;e<4;e++){let t=n[(this.shift+e)%4];this.compact?(r<<=7,r+=t>>1&127):(r<<=10,r+=(t>>2&992)+(t>>1&31))}let i=this.getCorrectedParameterData(r,this.compact);this.compact?(this.nbLayers=1+(i>>6),this.nbDataBlocks=1+(63&i)):(this.nbLayers=1+(i>>11),this.nbDataBlocks=1+(2047&i))}getRotation(e,t){let n=0;e.forEach((e,r,i)=>{n=(n<<3)+((e>>t-2<<1)+(1&e))}),n=((1&n)<<11)+(n>>1);for(let e=0;e<4;e++)if(h.default.bitCount(n^this.EXPECTED_CORNER_BITS[e])<=2)return e;throw new d.NotFoundException}getCorrectedParameterData(e,t){let n,r;t?(n=7,r=2):(n=10,r=4);let i=n-r,l=new Int32Array(n);for(let t=n-1;t>=0;--t)l[t]=15&e,e>>=4;try{new a.default(o.default.AZTEC_PARAM).decode(l,i)}catch(e){throw new d.NotFoundException}let s=0;for(let e=0;e<r;e++)s=(s<<4)+l[e];return s}getBullsEyeCorners(e){let t=e,n=e,i=e,l=e,s=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let e=this.getFirstDifferent(t,s,1,-1),r=this.getFirstDifferent(n,s,1,1),o=this.getFirstDifferent(i,s,-1,1),a=this.getFirstDifferent(l,s,-1,-1);if(this.nbCenterLayers>2){let n=this.distancePoint(a,e)*this.nbCenterLayers/(this.distancePoint(l,t)*(this.nbCenterLayers+2));if(n<.75||n>1.25||!this.isWhiteOrBlackRectangle(e,r,o,a))break}t=e,n=r,i=o,l=a,s=!s}if(5!==this.nbCenterLayers&&7!==this.nbCenterLayers)throw new d.NotFoundException;this.compact=5===this.nbCenterLayers;let o=new r.default(t.getX()+.5,t.getY()-.5),a=new r.default(n.getX()+.5,n.getY()+.5),u=new r.default(i.getX()-.5,i.getY()+.5),h=new r.default(l.getX()-.5,l.getY()-.5);return this.expandSquare([o,a,u,h],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,n,r;try{let i=new s.default(this.image).detect();e=i[0],t=i[1],n=i[2],r=i[3]}catch(i){let l=this.image.getWidth()/2,s=this.image.getHeight()/2;e=this.getFirstDifferent(new c(l+7,s-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new c(l+7,s+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new c(l-7,s+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new c(l-7,s-7),!1,-1,-1).toResultPoint()}let i=l.default.round((e.getX()+r.getX()+t.getX()+n.getX())/4),o=l.default.round((e.getY()+r.getY()+t.getY()+n.getY())/4);try{let l=new s.default(this.image,15,i,o).detect();e=l[0],t=l[1],n=l[2],r=l[3]}catch(l){e=this.getFirstDifferent(new c(i+7,o-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new c(i+7,o+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new c(i-7,o+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new c(i-7,o-7),!1,-1,-1).toResultPoint()}return i=l.default.round((e.getX()+r.getX()+t.getX()+n.getX())/4),o=l.default.round((e.getY()+r.getY()+t.getY()+n.getY())/4),new c(i,o)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,n,r,i){let l=u.default.getInstance(),s=this.getDimension(),o=s/2-this.nbCenterLayers,a=s/2+this.nbCenterLayers;return l.sampleGrid(e,s,s,o,o,a,o,a,a,o,a,t.getX(),t.getY(),n.getX(),n.getY(),r.getX(),r.getY(),i.getX(),i.getY())}sampleLine(e,t,n){let r=0,i=this.distanceResultPoint(e,t),s=i/n,o=e.getX(),a=e.getY(),u=s*(t.getX()-e.getX())/i,h=s*(t.getY()-e.getY())/i;for(let e=0;e<n;e++)this.image.get(l.default.round(o+e*u),l.default.round(a+e*h))&&(r|=1<<n-e-1);return r}isWhiteOrBlackRectangle(e,t,n,r){e=new c(e.getX()-3,e.getY()+3),t=new c(t.getX()-3,t.getY()-3),n=new c(n.getX()+3,n.getY()-3),r=new c(r.getX()+3,r.getY()+3);let i=this.getColor(r,e);if(0===i)return!1;let l=this.getColor(e,t);return l===i&&(l=this.getColor(t,n),l===i&&(l=this.getColor(n,r),l===i))}getColor(e,t){let n=this.distancePoint(e,t),r=(t.getX()-e.getX())/n,i=(t.getY()-e.getY())/n,s=0,o=e.getX(),a=e.getY(),u=this.image.get(e.getX(),e.getY()),h=Math.ceil(n);for(let e=0;e<h;e++)o+=r,a+=i,this.image.get(l.default.round(o),l.default.round(a))!==u&&s++;let d=s/n;return d>.1&&d<.9?0:d<=.1===u?1:-1}getFirstDifferent(e,t,n,r){let i=e.getX()+n,l=e.getY()+r;for(;this.isValid(i,l)&&this.image.get(i,l)===t;)i+=n,l+=r;for(i-=n,l-=r;this.isValid(i,l)&&this.image.get(i,l)===t;)i+=n;for(i-=n;this.isValid(i,l)&&this.image.get(i,l)===t;)l+=r;return l-=r,new c(i,l)}expandSquare(e,t,n){let i=n/(2*t),l=e[0].getX()-e[2].getX(),s=e[0].getY()-e[2].getY(),o=(e[0].getX()+e[2].getX())/2,a=(e[0].getY()+e[2].getY())/2,u=new r.default(o+i*l,a+i*s),h=new r.default(o-i*l,a-i*s);return l=e[1].getX()-e[3].getX(),s=e[1].getY()-e[3].getY(),o=(e[1].getX()+e[3].getX())/2,a=(e[1].getY()+e[3].getY())/2,[u,new r.default(o+i*l,a+i*s),h,new r.default(o-i*l,a-i*s)]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=l.default.round(e.getX()),n=l.default.round(e.getY());return this.isValid(t,n)}distancePoint(e,t){return l.default.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return l.default.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(h.default.truncDivision(this.nbLayers-4,8)+1)+15}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(154);class i extends r.default{constructor(e,t,n,r,i){super(e,t),this.compact=n,this.nbDatablocks=r,this.nbLayers=i}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserBarcodeReader=void 0;const r=n(98),i=n(200);class l extends r.BrowserCodeReader{constructor(e=500,t){super(new i.default(t),e,t)}}t.BrowserBarcodeReader=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(201);class i extends r.default{constructor(e,t,n){super(e,t),this.count=0,this.finderPattern=n}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(50),l=n(86),s=n(281),o=n(504),a=n(5);class u extends l.default{constructor(e){super();let t=null==e?null:e.get(i.default.POSSIBLE_FORMATS),n=[];null!=t&&(t.indexOf(r.default.EAN_13)>-1&&n.push(new s.default),t.indexOf(r.default.EAN_8)>-1&&n.push(new o.default)),0===n.length&&(n.push(new s.default),n.push(new o.default)),this.readers=n}decodeRow(e,t,n){for(let r of this.readers)try{return r.decodeRow(e,t,n)}catch(e){}throw new a.NotFoundException}reset(){for(let e of this.readers)e.reset()}}t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(156),i=n(502),l=n(503);class s{static decodeRow(e,t,n){let s=r.default.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return(new i.default).decodeRow(e,t,s)}catch(n){return(new l.default).decodeRow(e,t,s)}}}t.default=s,s.EXTENSION_START_PATTERN=[1,1,2]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(156),l=n(57),s=n(41),o=n(85),a=n(5);class u{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=[0,0,0,0],this.decodeRowStringBuffer=""}decodeRow(e,t,n){let i=this.decodeRowStringBuffer,o=this.decodeMiddle(t,n,i),a=i.toString(),h=u.parseExtensionString(a),d=[new s.default((n[0]+n[1])/2,e),new s.default(o,e)],c=new l.default(a,null,0,d,r.default.UPC_EAN_EXTENSION,(new Date).getTime());return null!=h&&c.putAllMetadata(h),c}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let l=e.getSize(),s=t[1],o=0;for(let t=0;t<5&&s<l;t++){let l=i.default.decodeDigit(e,r,s,i.default.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+l%10);for(let e of r)s+=e;l>=10&&(o|=1<<4-t),4!==t&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(5!==n.length)throw new a.NotFoundException;let h=this.determineCheckDigit(o);if(u.extensionChecksum(n.toString())!==h)throw new a.NotFoundException;return s}static extensionChecksum(e){let t=e.length,n=0;for(let r=t-2;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);n*=3;for(let r=t-1;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);return n*=3,n%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new a.NotFoundException}static parseExtensionString(e){if(5!==e.length)return null;let t=u.parseExtension5String(e);return null==t?null:new Map([[o.default.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="£";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t=""}let n=parseInt(e.substring(1)),r=n%100;return t+(n/100).toString()+"."+(r<10?"0"+r:r.toString())}}t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(156),l=n(57),s=n(41),o=n(85),a=n(5);class u{constructor(){this.decodeMiddleCounters=[0,0,0,0],this.decodeRowStringBuffer=""}decodeRow(e,t,n){let i=this.decodeRowStringBuffer,o=this.decodeMiddle(t,n,i),a=i.toString(),h=u.parseExtensionString(a),d=[new s.default((n[0]+n[1])/2,e),new s.default(o,e)],c=new l.default(a,null,0,d,r.default.UPC_EAN_EXTENSION,(new Date).getTime());return null!=h&&c.putAllMetadata(h),c}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let l=e.getSize(),s=t[1],o=0;for(let t=0;t<2&&s<l;t++){let l=i.default.decodeDigit(e,r,s,i.default.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+l%10);for(let e of r)s+=e;l>=10&&(o|=1<<1-t),1!==t&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(2!==n.length)throw new a.NotFoundException;if(parseInt(n.toString())%4!==o)throw new a.NotFoundException;return s}static parseExtensionString(e){return 2!==e.length?null:new Map([[o.default.ISSUE_NUMBER,parseInt(e)]])}}t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(282);class l extends i.default{constructor(){super(),this.decodeMiddleCounters=[0,0,0,0]}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let l=e.getSize(),s=t[1];for(let t=0;t<4&&s<l;t++){let t=i.default.decodeDigit(e,r,s,i.default.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of r)s+=e}s=i.default.findGuardPattern(e,s,!0,i.default.MIDDLE_PATTERN,new Array(i.default.MIDDLE_PATTERN.length).fill(0))[1];for(let t=0;t<4&&s<l;t++){let t=i.default.decodeDigit(e,r,s,i.default.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of r)s+=e}return{rowOffset:s,resultString:n}}getBarcodeFormat(){return r.default.EAN_8}}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserDatamatrixCodeReader=void 0;const r=n(98),i=n(202);class l extends r.BrowserCodeReader{constructor(e=500){super(new i.default,e)}}t.BrowserDatamatrixCodeReader=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(129),i=n(101),l=n(507),s=n(509),o=n(510),a=n(5);t.default=class{constructor(){this.rsDecoder=new r.default(i.default.DATA_MATRIX_FIELD_256)}decode(e){const t=new l.default(e),n=t.getVersion(),r=t.readCodewords(),i=s.default.getDataBlocks(r,n);let a=0;for(let e of i)a+=e.getNumDataCodewords();const u=new Uint8Array(a),h=i.length;for(let e=0;e<h;e++){const t=i[e],n=t.getCodewords(),r=t.getNumDataCodewords();this.correctErrors(n,r);for(let t=0;t<r;t++)u[t*h+e]=n[t]}return o.default.decode(u)}correctErrors(e,t){e.length;const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch(e){throw new a.ChecksumException}for(let r=0;r<t;r++)e[r]=n[r]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(78),l=n(508);class s{constructor(e){const t=e.getHeight();if(t<8||t>144||0!=(1&t))throw new r.FormatException;this.version=s.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new i.default(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),n=e.getWidth();return l.default.getVersionForDimensions(t,n)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,n=4,i=0;const l=this.mappingBitMatrix.getHeight(),s=this.mappingBitMatrix.getWidth();let o=!1,a=!1,u=!1,h=!1;do{if(n!==l||0!==i||o)if(n!==l-2||0!==i||0==(3&s)||a)if(n!==l+4||2!==i||0!=(7&s)||u)if(n!==l-2||0!==i||4!=(7&s)||h){do{n<l&&i>=0&&!this.readMappingMatrix.get(i,n)&&(e[t++]=255&this.readUtah(n,i,l,s)),n-=2,i+=2}while(n>=0&&i<s);n+=1,i+=3;do{n>=0&&i<s&&!this.readMappingMatrix.get(i,n)&&(e[t++]=255&this.readUtah(n,i,l,s)),n+=2,i-=2}while(n<l&&i>=0);n+=3,i+=1}else e[t++]=255&this.readCorner4(l,s),n-=2,i+=2,h=!0;else e[t++]=255&this.readCorner3(l,s),n-=2,i+=2,u=!0;else e[t++]=255&this.readCorner2(l,s),n-=2,i+=2,a=!0;else e[t++]=255&this.readCorner1(l,s),n-=2,i+=2,o=!0}while(n<l||i<s);if(t!==this.version.getTotalCodewords())throw new r.FormatException;return e}readModule(e,t,n,r){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=r,e+=4-(r+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,n,r){let i=0;return this.readModule(e-2,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-2,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t,n,r)&&(i|=1),i<<=1,this.readModule(e,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e,t,n,r)&&(i|=1),i}readCorner1(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}readCorner2(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner3(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner4(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new r.IllegalArgumentException("Dimension of bitMatrix must match the version size");const l=this.version.getDataRegionSizeRows(),s=this.version.getDataRegionSizeColumns(),o=t/l|0,a=n/s|0,u=o*l,h=a*s,d=new i.default(h,u);for(let t=0;t<o;++t){const n=t*l;for(let r=0;r<a;++r){const i=r*s;for(let o=0;o<l;++o){const a=t*(l+2)+1+o,u=n+o;for(let t=0;t<s;++t){const n=r*(s+2)+1+t;if(e.get(n,a)){const e=i+t;d.set(e,u)}}}}}return d}}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ECB=t.ECBlocks=void 0;const r=n(5);class i{constructor(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}t.ECBlocks=i;class l{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}t.ECB=l;class s{constructor(e,t,n,r,i,l){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=r,this.dataRegionSizeColumns=i,this.ecBlocks=l;let s=0;const o=l.getECCodewords(),a=l.getECBlocks();for(let e of a)s+=e.getCount()*(e.getDataCodewords()+o);this.totalCodewords=s}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if(0!=(1&e)||0!=(1&t))throw new r.FormatException;for(let n of s.VERSIONS)if(n.symbolSizeRows===e&&n.symbolSizeColumns===t)return n;throw new r.FormatException}toString(){return""+this.versionNumber}static buildVersions(){return[new s(1,10,10,8,8,new i(5,new l(1,3))),new s(2,12,12,10,10,new i(7,new l(1,5))),new s(3,14,14,12,12,new i(10,new l(1,8))),new s(4,16,16,14,14,new i(12,new l(1,12))),new s(5,18,18,16,16,new i(14,new l(1,18))),new s(6,20,20,18,18,new i(18,new l(1,22))),new s(7,22,22,20,20,new i(20,new l(1,30))),new s(8,24,24,22,22,new i(24,new l(1,36))),new s(9,26,26,24,24,new i(28,new l(1,44))),new s(10,32,32,14,14,new i(36,new l(1,62))),new s(11,36,36,16,16,new i(42,new l(1,86))),new s(12,40,40,18,18,new i(48,new l(1,114))),new s(13,44,44,20,20,new i(56,new l(1,144))),new s(14,48,48,22,22,new i(68,new l(1,174))),new s(15,52,52,24,24,new i(42,new l(2,102))),new s(16,64,64,14,14,new i(56,new l(2,140))),new s(17,72,72,16,16,new i(36,new l(4,92))),new s(18,80,80,18,18,new i(48,new l(4,114))),new s(19,88,88,20,20,new i(56,new l(4,144))),new s(20,96,96,22,22,new i(68,new l(4,174))),new s(21,104,104,24,24,new i(56,new l(6,136))),new s(22,120,120,18,18,new i(68,new l(6,175))),new s(23,132,132,20,20,new i(62,new l(8,163))),new s(24,144,144,22,22,new i(62,new l(8,156),new l(2,155))),new s(25,8,18,6,16,new i(7,new l(1,5))),new s(26,8,32,6,14,new i(11,new l(1,10))),new s(27,12,26,10,24,new i(14,new l(1,16))),new s(28,12,36,10,16,new i(18,new l(1,22))),new s(29,16,36,14,16,new i(24,new l(1,32))),new s(30,16,48,14,22,new i(28,new l(1,49)))]}}t.default=s,s.VERSIONS=s.buildVersions()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);class i{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const n=t.getECBlocks();let l=0;const s=n.getECBlocks();for(let e of s)l+=e.getCount();const o=new Array(l);let a=0;for(let e of s)for(let t=0;t<e.getCount();t++){const t=e.getDataCodewords(),r=n.getECCodewords()+t;o[a++]=new i(t,new Uint8Array(r))}const u=o[0].codewords.length-n.getECCodewords(),h=u-1;let d=0;for(let t=0;t<h;t++)for(let n=0;n<a;n++)o[n].codewords[t]=e[d++];const c=24===t.getVersionNumber(),p=c?8:a;for(let t=0;t<p;t++)o[t].codewords[u-1]=e[d++];const f=o[0].codewords.length;for(let t=u;t<f;t++)for(let n=0;n<a;n++){const r=c?(n+8)%a:n,i=c&&r>7?t-1:t;o[r].codewords[i]=e[d++]}if(d!==e.length)throw new r.IllegalArgumentException;return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(128),i=n(203),l=n(21),s=n(124),o=n(4),a=n(5);var u;!function(e){e[e.PAD_ENCODE=0]="PAD_ENCODE",e[e.ASCII_ENCODE=1]="ASCII_ENCODE",e[e.C40_ENCODE=2]="C40_ENCODE",e[e.TEXT_ENCODE=3]="TEXT_ENCODE",e[e.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",e[e.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",e[e.BASE256_ENCODE=6]="BASE256_ENCODE"}(u||(u={}));class h{static decode(e){const t=new i.default(e),n=new l.default,s=new l.default,o=new Array;let h=u.ASCII_ENCODE;do{if(h===u.ASCII_ENCODE)h=this.decodeAsciiSegment(t,n,s);else{switch(h){case u.C40_ENCODE:this.decodeC40Segment(t,n);break;case u.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case u.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case u.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case u.BASE256_ENCODE:this.decodeBase256Segment(t,n,o);break;default:throw new a.FormatException}h=u.ASCII_ENCODE}}while(h!==u.PAD_ENCODE&&t.available()>0);return s.length()>0&&n.append(s.toString()),new r.default(e,n.toString(),0===o.length?null:o,null)}static decodeAsciiSegment(e,t,n){let r=!1;do{let i=e.readBits(8);if(0===i)throw new a.FormatException;if(i<=128)return r&&(i+=128),t.append(String.fromCharCode(i-1)),u.ASCII_ENCODE;if(129===i)return u.PAD_ENCODE;if(i<=229){const e=i-130;e<10&&t.append("0"),t.append(""+e)}else switch(i){case 230:return u.C40_ENCODE;case 231:return u.BASE256_ENCODE;case 232:t.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:r=!0;break;case 236:t.append("[)>05"),n.insert(0,"");break;case 237:t.append("[)>06"),n.insert(0,"");break;case 238:return u.ANSIX12_ENCODE;case 239:return u.TEXT_ENCODE;case 240:return u.EDIFACT_ENCODE;case 241:break;default:if(254!==i||0!==e.available())throw new a.FormatException}}while(e.available()>0);return u.ASCII_ENCODE}static decodeC40Segment(e,t){let n=!1;const r=[];let i=0;do{if(8===e.available())return;const l=e.readBits(8);if(254===l)return;this.parseTwoBytes(l,e.readBits(8),r);for(let e=0;e<3;e++){const l=r[e];switch(i){case 0:if(l<3)i=l+1;else{if(!(l<this.C40_BASIC_SET_CHARS.length))throw new a.FormatException;{const e=this.C40_BASIC_SET_CHARS[l];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e)}}break;case 1:n?(t.append(String.fromCharCode(l+128)),n=!1):t.append(String.fromCharCode(l)),i=0;break;case 2:if(l<this.C40_SHIFT2_SET_CHARS.length){const e=this.C40_SHIFT2_SET_CHARS[l];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e)}else switch(l){case 27:t.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new a.FormatException}i=0;break;case 3:n?(t.append(String.fromCharCode(l+224)),n=!1):t.append(String.fromCharCode(l+96)),i=0;break;default:throw new a.FormatException}}}while(e.available()>0)}static decodeTextSegment(e,t){let n=!1,r=[],i=0;do{if(8===e.available())return;const l=e.readBits(8);if(254===l)return;this.parseTwoBytes(l,e.readBits(8),r);for(let e=0;e<3;e++){const l=r[e];switch(i){case 0:if(l<3)i=l+1;else{if(!(l<this.TEXT_BASIC_SET_CHARS.length))throw new a.FormatException;{const e=this.TEXT_BASIC_SET_CHARS[l];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e)}}break;case 1:n?(t.append(String.fromCharCode(l+128)),n=!1):t.append(String.fromCharCode(l)),i=0;break;case 2:if(l<this.TEXT_SHIFT2_SET_CHARS.length){const e=this.TEXT_SHIFT2_SET_CHARS[l];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e)}else switch(l){case 27:t.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new a.FormatException}i=0;break;case 3:if(!(l<this.TEXT_SHIFT3_SET_CHARS.length))throw new a.FormatException;{const e=this.TEXT_SHIFT3_SET_CHARS[l];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e),i=0}break;default:throw new a.FormatException}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const n=[];do{if(8===e.available())return;const r=e.readBits(8);if(254===r)return;this.parseTwoBytes(r,e.readBits(8),n);for(let e=0;e<3;e++){const r=n[e];switch(r){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(r<14)t.append(String.fromCharCode(r+44));else{if(!(r<40))throw new a.FormatException;t.append(String.fromCharCode(r+51))}}}}while(e.available()>0)}static parseTwoBytes(e,t,n){let r=(e<<8)+t-1,i=Math.floor(r/1600);n[0]=i,r-=1600*i,i=Math.floor(r/40),n[1]=i,n[2]=r-40*i}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let n=0;n<4;n++){let n=e.readBits(6);if(31===n){const t=8-e.getBitOffset();return void(8!==t&&e.readBits(t))}0==(32&n)&&(n|=64),t.append(String.fromCharCode(n))}}while(e.available()>0)}static decodeBase256Segment(e,t,n){let r=1+e.getByteOffset();const i=this.unrandomize255State(e.readBits(8),r++);let l;if(l=0===i?e.available()/8|0:i<250?i:250*(i-249)+this.unrandomize255State(e.readBits(8),r++),l<0)throw new a.FormatException;const u=new Uint8Array(l);for(let t=0;t<l;t++){if(e.available()<8)throw new a.FormatException;u[t]=this.unrandomize255State(e.readBits(8),r++)}n.push(u);try{t.append(s.default.decode(u,o.default.ISO88591))}catch(e){throw new a.IllegalStateException("Platform does not support required encoding: "+e.message)}}static unrandomize255State(e,t){const n=e-(149*t%255+1);return n>=0?n:n+256}}t.default=h,h.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],h.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],h.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],h.TEXT_SHIFT2_SET_CHARS=h.C40_SHIFT2_SET_CHARS,h.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(41),i=n(154),l=n(155),s=n(198),o=n(5);class a{constructor(e){this.image=e,this.rectangleDetector=new s.default(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new o.NotFoundException;t=this.shiftToModuleCenter(t);const n=t[0],r=t[1],l=t[2],s=t[3];let u=this.transitionsBetween(n,s)+1,h=this.transitionsBetween(l,s)+1;1==(1&u)&&(u+=1),1==(1&h)&&(h+=1),4*u<7*h&&4*h<7*u&&(u=h=Math.max(u,h));let d=a.sampleGrid(this.image,n,r,l,s,u,h);return new i.default(d,[n,r,l,s])}static shiftPoint(e,t,n){let i=(t.getX()-e.getX())/(n+1),l=(t.getY()-e.getY())/(n+1);return new r.default(e.getX()+i,e.getY()+l)}static moveAway(e,t,n){let i=e.getX(),l=e.getY();return i<t?i-=1:i+=1,l<n?l-=1:l+=1,new r.default(i,l)}detectSolid1(e){let t=e[0],n=e[1],r=e[3],i=e[2],l=this.transitionsBetween(t,n),s=this.transitionsBetween(n,r),o=this.transitionsBetween(r,i),a=this.transitionsBetween(i,t),u=l,h=[i,t,n,r];return u>s&&(u=s,h[0]=t,h[1]=n,h[2]=r,h[3]=i),u>o&&(u=o,h[0]=n,h[1]=r,h[2]=i,h[3]=t),u>a&&(h[0]=r,h[1]=i,h[2]=t,h[3]=n),h}detectSolid2(e){let t=e[0],n=e[1],r=e[2],i=e[3],l=this.transitionsBetween(t,i),s=a.shiftPoint(n,r,4*(l+1)),o=a.shiftPoint(r,n,4*(l+1));return this.transitionsBetween(s,t)<this.transitionsBetween(o,i)?(e[0]=t,e[1]=n,e[2]=r,e[3]=i):(e[0]=n,e[1]=r,e[2]=i,e[3]=t),e}correctTopRight(e){let t=e[0],n=e[1],i=e[2],l=e[3],s=this.transitionsBetween(t,l),o=this.transitionsBetween(n,l),u=a.shiftPoint(t,n,4*(o+1)),h=a.shiftPoint(i,n,4*(s+1));s=this.transitionsBetween(u,l),o=this.transitionsBetween(h,l);let d=new r.default(l.getX()+(i.getX()-n.getX())/(s+1),l.getY()+(i.getY()-n.getY())/(s+1)),c=new r.default(l.getX()+(t.getX()-n.getX())/(o+1),l.getY()+(t.getY()-n.getY())/(o+1));return this.isValid(d)?this.isValid(c)?this.transitionsBetween(u,d)+this.transitionsBetween(h,d)>this.transitionsBetween(u,c)+this.transitionsBetween(h,c)?d:c:d:this.isValid(c)?c:null}shiftToModuleCenter(e){let t=e[0],n=e[1],r=e[2],i=e[3],l=this.transitionsBetween(t,i)+1,s=this.transitionsBetween(r,i)+1,o=a.shiftPoint(t,n,4*s),u=a.shiftPoint(r,n,4*l);l=this.transitionsBetween(o,i)+1,s=this.transitionsBetween(u,i)+1,1==(1&l)&&(l+=1),1==(1&s)&&(s+=1);let h,d,c=(t.getX()+n.getX()+r.getX()+i.getX())/4,p=(t.getY()+n.getY()+r.getY()+i.getY())/4;return t=a.moveAway(t,c,p),n=a.moveAway(n,c,p),r=a.moveAway(r,c,p),i=a.moveAway(i,c,p),o=a.shiftPoint(t,n,4*s),o=a.shiftPoint(o,i,4*l),h=a.shiftPoint(n,t,4*s),h=a.shiftPoint(h,r,4*l),u=a.shiftPoint(r,i,4*s),u=a.shiftPoint(u,n,4*l),d=a.shiftPoint(i,r,4*s),d=a.shiftPoint(d,t,4*l),[o,h,u,d]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,n,r,i,s,o){return l.default.getInstance().sampleGrid(e,s,o,.5,.5,s-.5,.5,s-.5,o-.5,.5,o-.5,t.getX(),t.getY(),i.getX(),i.getY(),r.getX(),r.getY(),n.getX(),n.getY())}transitionsBetween(e,t){let n=Math.trunc(e.getX()),r=Math.trunc(e.getY()),i=Math.trunc(t.getX()),l=Math.trunc(t.getY()),s=Math.abs(l-r)>Math.abs(i-n);if(s){let e=n;n=r,r=e,e=i,i=l,l=e}let o=Math.abs(i-n),a=Math.abs(l-r),u=-o/2,h=r<l?1:-1,d=n<i?1:-1,c=0,p=this.image.get(s?r:n,s?n:r);for(let e=n,t=r;e!==i;e+=d){let n=this.image.get(s?t:e,s?e:t);if(n!==p&&(c++,p=n),u+=a,u>0){if(t===l)break;t+=h,u-=o}}return c}}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserMultiFormatReader=void 0;const r=n(98),i=n(283);class l extends r.BrowserCodeReader{constructor(e=null,t=500){const n=new i.default;n.setHints(e),super(n,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}t.BrowserMultiFormatReader=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(78),i=n(101),l=n(129),s=n(514),o=n(285),a=n(518),u=n(519),h=n(5);t.default=class{constructor(){this.rsDecoder=new l.default(i.default.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(r.default.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const n=new s.default(e);let r=null;try{return this.decodeBitMatrixParser(n,t)}catch(e){r=e}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();const e=this.decodeBitMatrixParser(n,t);return e.setOther(new o.default(!0)),e}catch(e){if(null!==r)throw r;throw e}}decodeBitMatrixParser(e,t){const n=e.readVersion(),r=e.readFormatInformation().getErrorCorrectionLevel(),i=e.readCodewords(),l=a.default.getDataBlocks(i,n,r);let s=0;for(const e of l)s+=e.getNumDataCodewords();const o=new Uint8Array(s);let h=0;for(const e of l){const t=e.getCodewords(),n=e.getNumDataCodewords();this.correctErrors(t,n);for(let e=0;e<n;e++)o[h++]=t[e]}return u.default.decode(o,n,r,t)}correctErrors(e,t){e.length;const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch(e){throw new h.ChecksumException}for(let r=0;r<t;r++)e[r]=n[r]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(205),i=n(284),l=n(517),s=n(5);t.default=class{constructor(e){const t=e.getHeight();if(t<21||1!=(3&t))throw new s.FormatException;this.bitMatrix=e}readFormatInformation(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;let e=0;for(let t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let t=5;t>=0;t--)e=this.copyBit(8,t,e);const t=this.bitMatrix.getHeight();let n=0;const r=t-7;for(let e=t-1;e>=r;e--)n=this.copyBit(8,e,n);for(let e=t-8;e<t;e++)n=this.copyBit(e,8,n);if(this.parsedFormatInfo=i.default.decodeFormatInformation(e,n),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new s.FormatException}readVersion(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return r.default.getVersionForNumber(t);let n=0;const i=e-11;for(let t=5;t>=0;t--)for(let r=e-9;r>=i;r--)n=this.copyBit(r,t,n);let l=r.default.decodeVersionInformation(n);if(null!==l&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;n=0;for(let t=5;t>=0;t--)for(let r=e-9;r>=i;r--)n=this.copyBit(t,r,n);if(l=r.default.decodeVersionInformation(n),null!==l&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;throw new s.FormatException}copyBit(e,t,n){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?n<<1|1:n<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),n=l.default.values.get(e.getDataMask()),r=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,r);const i=t.buildFunctionPattern();let o=!0;const a=new Uint8Array(t.getTotalCodewords());let u=0,h=0,d=0;for(let e=r-1;e>0;e-=2){6===e&&e--;for(let t=0;t<r;t++){const n=o?r-1-t:t;for(let t=0;t<2;t++)i.get(e-t,n)||(d++,h<<=1,this.bitMatrix.get(e-t,n)&&(h|=1),8===d&&(a[u++]=h,d=0,h=0))}o=!o}if(u!==t.getTotalCodewords())throw new s.FormatException;return a}remask(){if(null===this.parsedFormatInfo)return;const e=l.default.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,n=e.getWidth();t<n;t++)for(let n=t+1,r=e.getHeight();n<r;n++)e.get(t,n)!==e.get(n,t)&&(e.flip(n,t),e.flip(t,n))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const n of t)e+=n.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DataMaskValues=void 0,function(e){e[e.DATA_MASK_000=0]="DATA_MASK_000",e[e.DATA_MASK_001=1]="DATA_MASK_001",e[e.DATA_MASK_010=2]="DATA_MASK_010",e[e.DATA_MASK_011=3]="DATA_MASK_011",e[e.DATA_MASK_100=4]="DATA_MASK_100",e[e.DATA_MASK_101=5]="DATA_MASK_101",e[e.DATA_MASK_110=6]="DATA_MASK_110",e[e.DATA_MASK_111=7]="DATA_MASK_111"}(r=t.DataMaskValues||(t.DataMaskValues={}));class i{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let n=0;n<t;n++)for(let r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)}}t.default=i,i.values=new Map([[r.DATA_MASK_000,new i(r.DATA_MASK_000,(e,t)=>0==(e+t&1))],[r.DATA_MASK_001,new i(r.DATA_MASK_001,(e,t)=>0==(1&e))],[r.DATA_MASK_010,new i(r.DATA_MASK_010,(e,t)=>t%3==0)],[r.DATA_MASK_011,new i(r.DATA_MASK_011,(e,t)=>(e+t)%3==0)],[r.DATA_MASK_100,new i(r.DATA_MASK_100,(e,t)=>0==(Math.floor(e/2)+Math.floor(t/3)&1))],[r.DATA_MASK_101,new i(r.DATA_MASK_101,(e,t)=>e*t%6==0)],[r.DATA_MASK_110,new i(r.DATA_MASK_110,(e,t)=>e*t%6<3)],[r.DATA_MASK_111,new i(r.DATA_MASK_111,(e,t)=>0==(e+t+e*t%3&1))]])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);class i{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,n){if(e.length!==t.getTotalCodewords())throw new r.IllegalArgumentException;const l=t.getECBlocksForLevel(n);let s=0;const o=l.getECBlocks();for(const e of o)s+=e.getCount();const a=new Array(s);let u=0;for(const e of o)for(let t=0;t<e.getCount();t++){const t=e.getDataCodewords(),n=l.getECCodewordsPerBlock()+t;a[u++]=new i(t,new Uint8Array(n))}const h=a[0].codewords.length;let d=a.length-1;for(;d>=0;){if(a[d].codewords.length===h)break;d--}d++;const c=h-l.getECCodewordsPerBlock();let p=0;for(let t=0;t<c;t++)for(let n=0;n<u;n++)a[n].codewords[t]=e[p++];for(let t=d;t<u;t++)a[t].codewords[c]=e[p++];const f=a[0].codewords.length;for(let t=c;t<f;t++)for(let n=0;n<u;n++){const r=n<d?t:t+1;a[n].codewords[r]=e[p++]}return a}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(203),i=n(114),l=n(128),s=n(4),o=n(286),a=n(21),u=n(124),h=n(5);class d{static decode(e,t,n,s){const u=new r.default(e);let c=new a.default;const p=new Array;let f=-1,g=-1;try{let e,n=null,r=!1;do{if(u.available()<4)e=o.default.TERMINATOR;else{const t=u.readBits(4);e=o.default.forBits(t)}switch(e){case o.default.TERMINATOR:break;case o.default.FNC1_FIRST_POSITION:case o.default.FNC1_SECOND_POSITION:r=!0;break;case o.default.STRUCTURED_APPEND:if(u.available()<16)throw new h.FormatException;f=u.readBits(8),g=u.readBits(8);break;case o.default.ECI:const l=d.parseECIValue(u);if(n=i.default.getCharacterSetECIByValue(l),null===n)throw new h.FormatException;break;case o.default.HANZI:const a=u.readBits(4),m=u.readBits(e.getCharacterCountBits(t));a===d.GB2312_SUBSET&&d.decodeHanziSegment(u,c,m);break;default:const E=u.readBits(e.getCharacterCountBits(t));switch(e){case o.default.NUMERIC:d.decodeNumericSegment(u,c,E);break;case o.default.ALPHANUMERIC:d.decodeAlphanumericSegment(u,c,E,r);break;case o.default.BYTE:d.decodeByteSegment(u,c,E,n,p,s);break;case o.default.KANJI:d.decodeKanjiSegment(u,c,E);break;default:throw new h.FormatException}}}while(e!==o.default.TERMINATOR)}catch(e){throw new h.FormatException}return new l.default(e,c.toString(),0===p.length?null:p,null===n?null:n.toString(),f,g)}static decodeHanziSegment(e,t,n){if(13*n>e.available())throw new h.FormatException;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const t=e.readBits(13);let l=t/96<<8&4294967295|t%96;l+=l<959?41377:42657,r[i]=l>>8&255,r[i+1]=255&l,i+=2,n--}try{t.append(u.default.decode(r,s.default.GB2312))}catch(e){throw new h.FormatException(e)}}static decodeKanjiSegment(e,t,n){if(13*n>e.available())throw new h.FormatException;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const t=e.readBits(13);let l=t/192<<8&4294967295|t%192;l+=l<7936?33088:49472,r[i]=l>>8,r[i+1]=l,i+=2,n--}try{t.append(u.default.decode(r,s.default.SHIFT_JIS))}catch(e){throw new h.FormatException(e)}}static decodeByteSegment(e,t,n,r,i,l){if(8*n>e.available())throw new h.FormatException;const o=new Uint8Array(n);for(let t=0;t<n;t++)o[t]=e.readBits(8);let a;a=null===r?s.default.guessEncoding(o,l):r.getName();try{t.append(u.default.decode(o,a))}catch(e){throw new h.FormatException(e)}i.push(o)}static toAlphaNumericChar(e){if(e>=d.ALPHANUMERIC_CHARS.length)throw new h.FormatException;return d.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,n,r){const i=t.length();for(;n>1;){if(e.available()<11)throw new h.FormatException;const r=e.readBits(11);t.append(d.toAlphaNumericChar(Math.floor(r/45))),t.append(d.toAlphaNumericChar(r%45)),n-=2}if(1===n){if(e.available()<6)throw new h.FormatException;t.append(d.toAlphaNumericChar(e.readBits(6)))}if(r)for(let e=i;e<t.length();e++)"%"===t.charAt(e)&&(e<t.length()-1&&"%"===t.charAt(e+1)?t.deleteCharAt(e+1):t.setCharAt(e,String.fromCharCode(29)))}static decodeNumericSegment(e,t,n){for(;n>=3;){if(e.available()<10)throw new h.FormatException;const r=e.readBits(10);if(r>=1e3)throw new h.FormatException;t.append(d.toAlphaNumericChar(Math.floor(r/100))),t.append(d.toAlphaNumericChar(Math.floor(r/10)%10)),t.append(d.toAlphaNumericChar(r%10)),n-=3}if(2===n){if(e.available()<7)throw new h.FormatException;const n=e.readBits(7);if(n>=100)throw new h.FormatException;t.append(d.toAlphaNumericChar(Math.floor(n/10))),t.append(d.toAlphaNumericChar(n%10))}else if(1===n){if(e.available()<4)throw new h.FormatException;const n=e.readBits(4);if(n>=10)throw new h.FormatException;t.append(d.toAlphaNumericChar(n))}}static parseECIValue(e){const t=e.readBits(8);if(0==(128&t))return 127&t;if(128==(192&t)){return(63&t)<<8&4294967295|e.readBits(8)}if(192==(224&t)){return(31&t)<<16&4294967295|e.readBits(16)}throw new h.FormatException}}t.default=d,d.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",d.GB2312_SUBSET=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(50),i=n(41),l=n(154),s=n(155),o=n(199),a=n(72),u=n(205),h=n(521),d=n(524),c=n(5);class p{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=null==e?null:e.get(r.default.NEED_RESULT_POINT_CALLBACK);const t=new h.default(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(t)}processFinderPatternInfo(e){const t=e.getTopLeft(),n=e.getTopRight(),r=e.getBottomLeft(),i=this.calculateModuleSize(t,n,r);if(i<1)throw new c.NotFoundException("No pattern found in proccess finder.");const s=p.computeDimension(t,n,r,i),o=u.default.getProvisionalVersionForDimension(s),a=o.getDimensionForVersion()-7;let h=null;if(o.getAlignmentPatternCenters().length>0){const e=n.getX()-t.getX()+r.getX(),l=n.getY()-t.getY()+r.getY(),s=1-3/a,o=Math.floor(t.getX()+s*(e-t.getX())),u=Math.floor(t.getY()+s*(l-t.getY()));for(let e=4;e<=16;e<<=1)try{h=this.findAlignmentInRegion(i,o,u,e);break}catch(e){if(!(e instanceof c.NotFoundException))throw e}}const d=p.createTransform(t,n,r,h,s),f=p.sampleGrid(this.image,d,s);let g;return g=null===h?[r,t,n]:[r,t,n,h],new l.default(f,g)}static createTransform(e,t,n,r,i){const l=i-3.5;let s,a,u,h;return null!==r?(s=r.getX(),a=r.getY(),u=l-3,h=u):(s=t.getX()-e.getX()+n.getX(),a=t.getY()-e.getY()+n.getY(),u=l,h=l),o.default.quadrilateralToQuadrilateral(3.5,3.5,l,3.5,u,h,3.5,l,e.getX(),e.getY(),t.getX(),t.getY(),s,a,n.getX(),n.getY())}static sampleGrid(e,t,n){return s.default.getInstance().sampleGridWithTransform(e,n,n,t)}static computeDimension(e,t,n,r){const l=a.default.round(i.default.distance(e,t)/r),s=a.default.round(i.default.distance(e,n)/r);let o=Math.floor((l+s)/2)+7;switch(3&o){case 0:o++;break;case 2:o--;break;case 3:throw new c.NotFoundException("Dimensions could be not found.")}return o}calculateModuleSize(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2}calculateModuleSizeOneWay(e,t){const n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,n,r){let i=this.sizeOfBlackWhiteBlackRun(e,t,n,r),l=1,s=e-(n-e);s<0?(l=e/(e-s),s=0):s>=this.image.getWidth()&&(l=(this.image.getWidth()-1-e)/(s-e),s=this.image.getWidth()-1);let o=Math.floor(t-(r-t)*l);return l=1,o<0?(l=t/(t-o),o=0):o>=this.image.getHeight()&&(l=(this.image.getHeight()-1-t)/(o-t),o=this.image.getHeight()-1),s=Math.floor(e+(s-e)*l),i+=this.sizeOfBlackWhiteBlackRun(e,t,s,o),i-1}sizeOfBlackWhiteBlackRun(e,t,n,r){const i=Math.abs(r-t)>Math.abs(n-e);if(i){let i=e;e=t,t=i,i=n,n=r,r=i}const l=Math.abs(n-e),s=Math.abs(r-t);let o=-l/2;const u=e<n?1:-1,h=t<r?1:-1;let d=0;const c=n+u;for(let n=e,p=t;n!==c;n+=u){const u=i?p:n,c=i?n:p;if(1===d===this.image.get(u,c)){if(2===d)return a.default.distance(n,p,e,t);d++}if(o+=s,o>0){if(p===r)break;p+=h,o-=l}}return 2===d?a.default.distance(n+u,r,e,t):NaN}findAlignmentInRegion(e,t,n,r){const i=Math.floor(r*e),l=Math.max(0,t-i),s=Math.min(this.image.getWidth()-1,t+i);if(s-l<3*e)throw new c.NotFoundException("Alignment top exceeds estimated module size.");const o=Math.max(0,n-i),a=Math.min(this.image.getHeight()-1,n+i);if(a-o<3*e)throw new c.NotFoundException("Alignment bottom exceeds estimated module size.");return new d.default(this.image,l,o,s-l,a-o,e,this.resultPointCallback).find()}}t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(50),i=n(41),l=n(522),s=n(523),o=n(5);class a{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=null!=e&&void 0!==e.get(r.default.TRY_HARDER),n=null!=e&&void 0!==e.get(r.default.PURE_BARCODE),l=this.image,o=l.getHeight(),u=l.getWidth();let h=Math.floor(3*o/(4*a.MAX_MODULES));(h<a.MIN_SKIP||t)&&(h=a.MIN_SKIP);let d=!1;const c=new Int32Array(5);for(let e=h-1;e<o&&!d;e+=h){c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0;let t=0;for(let r=0;r<u;r++)if(l.get(r,e))1==(1&t)&&t++,c[t]++;else if(0==(1&t))if(4===t)if(a.foundPatternCross(c)){if(!0!==this.handlePossibleCenter(c,e,r,n)){c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,t=3;continue}if(h=2,!0===this.hasSkipped)d=this.haveMultiplyConfirmedCenters();else{const t=this.findRowSkip();t>c[2]&&(e+=t-c[2]-h,r=u-1)}t=0,c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0}else c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,t=3;else c[++t]++;else c[t]++;if(a.foundPatternCross(c)){!0===this.handlePossibleCenter(c,e,u,n)&&(h=c[0],this.hasSkipped&&(d=this.haveMultiplyConfirmedCenters()))}}const p=this.selectBestPatterns();return i.default.orderBestPatterns(p),new s.default(p)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let n=0;n<5;n++){const r=e[n];if(0===r)return!1;t+=r}if(t<7)return!1;const n=t/7,r=n/2;return Math.abs(n-e[0])<r&&Math.abs(n-e[1])<r&&Math.abs(3*n-e[2])<3*r&&Math.abs(n-e[3])<r&&Math.abs(n-e[4])<r}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,n,r){const i=this.getCrossCheckStateCount();let l=0;const s=this.image;for(;e>=l&&t>=l&&s.get(t-l,e-l);)i[2]++,l++;if(e<l||t<l)return!1;for(;e>=l&&t>=l&&!s.get(t-l,e-l)&&i[1]<=n;)i[1]++,l++;if(e<l||t<l||i[1]>n)return!1;for(;e>=l&&t>=l&&s.get(t-l,e-l)&&i[0]<=n;)i[0]++,l++;if(i[0]>n)return!1;const o=s.getHeight(),u=s.getWidth();for(l=1;e+l<o&&t+l<u&&s.get(t+l,e+l);)i[2]++,l++;if(e+l>=o||t+l>=u)return!1;for(;e+l<o&&t+l<u&&!s.get(t+l,e+l)&&i[3]<n;)i[3]++,l++;if(e+l>=o||t+l>=u||i[3]>=n)return!1;for(;e+l<o&&t+l<u&&s.get(t+l,e+l)&&i[4]<n;)i[4]++,l++;if(i[4]>=n)return!1;const h=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(h-r)<2*r&&a.foundPatternCross(i)}crossCheckVertical(e,t,n,r){const i=this.image,l=i.getHeight(),s=this.getCrossCheckStateCount();let o=e;for(;o>=0&&i.get(t,o);)s[2]++,o--;if(o<0)return NaN;for(;o>=0&&!i.get(t,o)&&s[1]<=n;)s[1]++,o--;if(o<0||s[1]>n)return NaN;for(;o>=0&&i.get(t,o)&&s[0]<=n;)s[0]++,o--;if(s[0]>n)return NaN;for(o=e+1;o<l&&i.get(t,o);)s[2]++,o++;if(o===l)return NaN;for(;o<l&&!i.get(t,o)&&s[3]<n;)s[3]++,o++;if(o===l||s[3]>=n)return NaN;for(;o<l&&i.get(t,o)&&s[4]<n;)s[4]++,o++;if(s[4]>=n)return NaN;const u=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(u-r)>=2*r?NaN:a.foundPatternCross(s)?a.centerFromEnd(s,o):NaN}crossCheckHorizontal(e,t,n,r){const i=this.image,l=i.getWidth(),s=this.getCrossCheckStateCount();let o=e;for(;o>=0&&i.get(o,t);)s[2]++,o--;if(o<0)return NaN;for(;o>=0&&!i.get(o,t)&&s[1]<=n;)s[1]++,o--;if(o<0||s[1]>n)return NaN;for(;o>=0&&i.get(o,t)&&s[0]<=n;)s[0]++,o--;if(s[0]>n)return NaN;for(o=e+1;o<l&&i.get(o,t);)s[2]++,o++;if(o===l)return NaN;for(;o<l&&!i.get(o,t)&&s[3]<n;)s[3]++,o++;if(o===l||s[3]>=n)return NaN;for(;o<l&&i.get(o,t)&&s[4]<n;)s[4]++,o++;if(s[4]>=n)return NaN;const u=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(u-r)>=r?NaN:a.foundPatternCross(s)?a.centerFromEnd(s,o):NaN}handlePossibleCenter(e,t,n,r){const i=e[0]+e[1]+e[2]+e[3]+e[4];let s=a.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(s),e[2],i);if(!isNaN(o)&&(s=this.crossCheckHorizontal(Math.floor(s),Math.floor(o),e[2],i),!isNaN(s)&&(!r||this.crossCheckDiagonal(Math.floor(o),Math.floor(s),e[2],i)))){const e=i/7;let t=!1;const n=this.possibleCenters;for(let r=0,i=n.length;r<i;r++){const i=n[r];if(i.aboutEquals(e,o,s)){n[r]=i.combineEstimate(o,s,e),t=!0;break}}if(!t){const t=new l.default(s,o,e);n.push(t),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(t)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let e=null;for(const t of this.possibleCenters)if(t.getCount()>=a.CENTER_QUORUM){if(null!=e)return this.hasSkipped=!0,Math.floor((Math.abs(e.getX()-t.getX())-Math.abs(e.getY()-t.getY()))/2);e=t}return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const n=this.possibleCenters.length;for(const n of this.possibleCenters)n.getCount()>=a.CENTER_QUORUM&&(e++,t+=n.getEstimatedModuleSize());if(e<3)return!1;const r=t/n;let i=0;for(const e of this.possibleCenters)i+=Math.abs(e.getEstimatedModuleSize()-r);return i<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new o.NotFoundException;const t=this.possibleCenters;let n;if(e>3){let r=0,i=0;for(const e of this.possibleCenters){const t=e.getEstimatedModuleSize();r+=t,i+=t*t}n=r/e;let l=Math.sqrt(i/e-n*n);t.sort((e,t)=>{const r=Math.abs(t.getEstimatedModuleSize()-n),i=Math.abs(e.getEstimatedModuleSize()-n);return r<i?-1:r>i?1:0});const s=Math.max(.2*n,l);for(let e=0;e<t.length&&t.length>3;e++){const r=t[e];Math.abs(r.getEstimatedModuleSize()-n)>s&&(t.splice(e,1),e--)}}if(t.length>3){let e=0;for(const n of t)e+=n.getEstimatedModuleSize();n=e/t.length,t.sort((e,t)=>{if(t.getCount()===e.getCount()){const r=Math.abs(t.getEstimatedModuleSize()-n),i=Math.abs(e.getEstimatedModuleSize()-n);return r<i?1:r>i?-1:0}return t.getCount()-e.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}t.default=a,a.CENTER_QUORUM=2,a.MIN_SKIP=3,a.MAX_MODULES=57},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(41);class i extends r.default{constructor(e,t,n,r){super(e,t),this.estimatedModuleSize=n,this.count=r,void 0===r&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const t=Math.abs(e-this.estimatedModuleSize);return t<=1||t<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=this.count+1,l=(this.count*this.getX()+t)/r,s=(this.count*this.getY()+e)/r,o=(this.count*this.estimatedModuleSize+n)/r;return new i(l,s,o,r)}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(525),i=n(5);class l{constructor(e,t,n,r,i,l,s){this.image=e,this.startX=t,this.startY=n,this.width=r,this.height=i,this.moduleSize=l,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,n=e+this.width,r=this.startY+t/2,l=new Int32Array(3),s=this.image;for(let i=0;i<t;i++){const t=r+(0==(1&i)?Math.floor((i+1)/2):-Math.floor((i+1)/2));l[0]=0,l[1]=0,l[2]=0;let o=e;for(;o<n&&!s.get(o,t);)o++;let a=0;for(;o<n;){if(s.get(o,t))if(1===a)l[1]++;else if(2===a){if(this.foundPatternCross(l)){const e=this.handlePossibleCenter(l,t,o);if(null!==e)return e}l[0]=l[2],l[1]=1,l[2]=0,a=1}else l[++a]++;else 1===a&&a++,l[a]++;o++}if(this.foundPatternCross(l)){const e=this.handlePossibleCenter(l,t,n);if(null!==e)return e}}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new i.NotFoundException}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,n=t/2;for(let r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0}crossCheckVertical(e,t,n,r){const i=this.image,s=i.getHeight(),o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;let a=e;for(;a>=0&&i.get(t,a)&&o[1]<=n;)o[1]++,a--;if(a<0||o[1]>n)return NaN;for(;a>=0&&!i.get(t,a)&&o[0]<=n;)o[0]++,a--;if(o[0]>n)return NaN;for(a=e+1;a<s&&i.get(t,a)&&o[1]<=n;)o[1]++,a++;if(a===s||o[1]>n)return NaN;for(;a<s&&!i.get(t,a)&&o[2]<=n;)o[2]++,a++;if(o[2]>n)return NaN;const u=o[0]+o[1]+o[2];return 5*Math.abs(u-r)>=2*r?NaN:this.foundPatternCross(o)?l.centerFromEnd(o,a):NaN}handlePossibleCenter(e,t,n){const i=e[0]+e[1]+e[2],s=l.centerFromEnd(e,n),o=this.crossCheckVertical(t,s,2*e[1],i);if(!isNaN(o)){const t=(e[0]+e[1]+e[2])/3;for(const e of this.possibleCenters)if(e.aboutEquals(t,o,s))return e.combineEstimate(o,s,t);const n=new r.default(s,o,t);this.possibleCenters.push(n),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(n)}return null}}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(41);class i extends r.default{constructor(e,t,n){super(e,t),this.estimatedModuleSize=n}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const t=Math.abs(e-this.estimatedModuleSize);return t<=1||t<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=(this.getX()+t)/2,l=(this.getY()+e)/2,s=(this.estimatedModuleSize+n)/2;return new i(r,l,s)}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(41),i=n(49),l=n(100),s=n(527);class o{static detectMultiple(e,t,n){let r=e.getBlackMatrix(),i=o.detect(n,r);return i.length||(r=r.clone(),r.rotate180(),i=o.detect(n,r)),new s.default(r,i)}static detect(e,t){const n=new Array;let r=0,i=0,l=!1;for(;r<t.getHeight();){const s=o.findVertices(t,r,i);if(null!=s[0]||null!=s[3]){if(l=!0,n.push(s),!e)break;null!=s[2]?(i=Math.trunc(s[2].getX()),r=Math.trunc(s[2].getY())):(i=Math.trunc(s[4].getX()),r=Math.trunc(s[4].getY()))}else{if(!l)break;l=!1,i=0;for(const e of n)null!=e[1]&&(r=Math.trunc(Math.max(r,e[1].getY()))),null!=e[3]&&(r=Math.max(r,Math.trunc(e[3].getY())));r+=o.ROW_STEP}}return n}static findVertices(e,t,n){const r=e.getHeight(),i=e.getWidth(),l=new Array(8);return o.copyToResult(l,o.findRowsWithPattern(e,r,i,t,n,o.START_PATTERN),o.INDEXES_START_PATTERN),null!=l[4]&&(n=Math.trunc(l[4].getX()),t=Math.trunc(l[4].getY())),o.copyToResult(l,o.findRowsWithPattern(e,r,i,t,n,o.STOP_PATTERN),o.INDEXES_STOP_PATTERN),l}static copyToResult(e,t,n){for(let r=0;r<n.length;r++)e[n[r]]=t[r]}static findRowsWithPattern(e,t,n,i,s,a){const u=new Array(4);let h=!1;const d=new Int32Array(a.length);for(;i<t;i+=o.ROW_STEP){let t=o.findGuardPattern(e,s,i,n,!1,a,d);if(null!=t){for(;i>0;){const r=o.findGuardPattern(e,s,--i,n,!1,a,d);if(null==r){i++;break}t=r}u[0]=new r.default(t[0],i),u[1]=new r.default(t[1],i),h=!0;break}}let c=i+1;if(h){let i=0,l=Int32Array.from([Math.trunc(u[0].getX()),Math.trunc(u[1].getX())]);for(;c<t;c++){const t=o.findGuardPattern(e,l[0],c,n,!1,a,d);if(null!=t&&Math.abs(l[0]-t[0])<o.MAX_PATTERN_DRIFT&&Math.abs(l[1]-t[1])<o.MAX_PATTERN_DRIFT)l=t,i=0;else{if(i>o.SKIPPED_ROW_COUNT_MAX)break;i++}}c-=i+1,u[2]=new r.default(l[0],c),u[3]=new r.default(l[1],c)}return c-i<o.BARCODE_MIN_HEIGHT&&l.default.fill(u,null),u}static findGuardPattern(e,t,n,r,s,a,u){l.default.fillWithin(u,0,u.length,0);let h=t,d=0;for(;e.get(h,n)&&h>0&&d++<o.MAX_PIXEL_DRIFT;)h--;let c=h,p=0,f=a.length;for(let t=s;c<r;c++){if(e.get(c,n)!==t)u[p]++;else{if(p===f-1){if(o.patternMatchVariance(u,a,o.MAX_INDIVIDUAL_VARIANCE)<o.MAX_AVG_VARIANCE)return new Int32Array([h,c]);h+=u[0]+u[1],i.default.arraycopy(u,2,u,0,p-1),u[p-1]=0,u[p]=0,p--}else p++;u[p]=1,t=!t}}return p===f-1&&o.patternMatchVariance(u,a,o.MAX_INDIVIDUAL_VARIANCE)<o.MAX_AVG_VARIANCE?new Int32Array([h,c-1]):null}static patternMatchVariance(e,t,n){let r=e.length,i=0,l=0;for(let n=0;n<r;n++)i+=e[n],l+=t[n];if(i<l)return 1/0;let s=i/l;n*=s;let o=0;for(let i=0;i<r;i++){let r=e[i],l=t[i]*s,a=r>l?r-l:l-r;if(a>n)return 1/0;o+=a}return o/i}}t.default=o,o.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),o.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),o.MAX_AVG_VARIANCE=.42,o.MAX_INDIVIDUAL_VARIANCE=.8,o.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),o.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),o.MAX_PIXEL_DRIFT=3,o.MAX_PATTERN_DRIFT=5,o.SKIPPED_ROW_COUNT_MAX=25,o.ROW_STEP=5,o.BARCODE_MIN_HEIGHT=10},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(72),i=n(102),l=n(529),s=n(289),o=n(532),a=n(534),u=n(290),h=n(535),d=n(291),c=n(536),p=n(537),f=n(206),g=n(5);class m{constructor(){}static decode(e,t,n,r,i,l,a){let h,d=new s.default(e,t,n,r,i),c=null,p=null;for(let n=!0;;n=!1){if(null!=t&&(c=m.getRowIndicatorColumn(e,d,t,!0,l,a)),null!=r&&(p=m.getRowIndicatorColumn(e,d,r,!1,l,a)),h=m.merge(c,p),null==h)throw g.NotFoundException.getNotFoundInstance();let i=h.getBoundingBox();if(!n||null==i||!(i.getMinY()<d.getMinY()||i.getMaxY()>d.getMaxY()))break;d=i}h.setBoundingBox(d);let f=h.getBarcodeColumnCount()+1;h.setDetectionResultColumn(0,c),h.setDetectionResultColumn(f,p);let E=null!=c;for(let t=1;t<=f;t++){let n,r=E?t:f-t;if(void 0!==h.getDetectionResultColumn(r))continue;n=0===r||r===f?new o.default(d,0===r):new u.default(d),h.setDetectionResultColumn(r,n);let i=-1,s=i;for(let t=d.getMinY();t<=d.getMaxY();t++){if(i=m.getStartColumn(h,r,t,E),i<0||i>d.getMaxX()){if(-1===s)continue;i=s}let o=m.detectCodeword(e,d.getMinX(),d.getMaxX(),E,i,t,l,a);null!=o&&(n.setCodeword(t,o),s=i,l=Math.min(l,o.getWidth()),a=Math.max(a,o.getWidth()))}}return m.createDecoderResult(h)}static merge(e,t){if(null==e&&null==t)return null;let n=m.getBarcodeMetadata(e,t);if(null==n)return null;let r=s.default.merge(m.adjustBoundingBox(e),m.adjustBoundingBox(t));return new a.default(n,r)}static adjustBoundingBox(e){if(null==e)return null;let t=e.getRowHeights();if(null==t)return null;let n=m.getMax(t),r=0;for(let e of t)if(r+=n-e,e>0)break;let i=e.getCodewords();for(let e=0;r>0&&null==i[e];e++)r--;let l=0;for(let e=t.length-1;e>=0&&(l+=n-t[e],!(t[e]>0));e--);for(let e=i.length-1;l>0&&null==i[e];e--)l--;return e.getBoundingBox().addMissingRows(r,l,e.isLeft())}static getMax(e){let t=-1;for(let n of e)t=Math.max(t,n);return t}static getBarcodeMetadata(e,t){let n,r;return null==e||null==(n=e.getBarcodeMetadata())?null==t?null:t.getBarcodeMetadata():null==t||null==(r=t.getBarcodeMetadata())?n:n.getColumnCount()!==r.getColumnCount()&&n.getErrorCorrectionLevel()!==r.getErrorCorrectionLevel()&&n.getRowCount()!==r.getRowCount()?null:n}static getRowIndicatorColumn(e,t,n,r,i,l){let s=new o.default(t,r);for(let o=0;o<2;o++){let a=0===o?1:-1,u=Math.trunc(Math.trunc(n.getX()));for(let o=Math.trunc(Math.trunc(n.getY()));o<=t.getMaxY()&&o>=t.getMinY();o+=a){let t=m.detectCodeword(e,0,e.getWidth(),r,u,o,i,l);null!=t&&(s.setCodeword(o,t),u=r?t.getStartX():t.getEndX())}}return s}static adjustCodewordCount(e,t){let n=t[0][1],r=n.getValue(),l=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-m.getNumberOfECCodeWords(e.getBarcodeECLevel());if(0===r.length){if(l<1||l>i.default.MAX_CODEWORDS_IN_BARCODE)throw g.NotFoundException.getNotFoundInstance();n.setValue(l)}else r[0]!==l&&n.setValue(l)}static createDecoderResult(e){let t=m.createBarcodeMatrix(e);m.adjustCodewordCount(e,t);let n=new Array,r=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),l=[],s=new Array;for(let i=0;i<e.getBarcodeRowCount();i++)for(let o=0;o<e.getBarcodeColumnCount();o++){let a=t[i][o+1].getValue(),u=i*e.getBarcodeColumnCount()+o;0===a.length?n.push(u):1===a.length?r[u]=a[0]:(s.push(u),l.push(a))}let o=new Array(l.length);for(let e=0;e<o.length;e++)o[e]=l[e];return m.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),r,i.default.toIntArray(n),i.default.toIntArray(s),o)}static createDecoderResultFromAmbiguousValues(e,t,n,r,i){let l=new Int32Array(r.length),s=100;for(;s-- >0;){for(let e=0;e<l.length;e++)t[r[e]]=i[e][l[e]];try{return m.decodeCodewords(t,e,n)}catch(e){if(!(e instanceof g.ChecksumException))throw e}if(0===l.length)throw g.ChecksumException.getChecksumInstance();for(let e=0;e<l.length;e++){if(l[e]<i[e].length-1){l[e]++;break}if(l[e]=0,e===l.length-1)throw g.ChecksumException.getChecksumInstance()}}throw g.ChecksumException.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let e=0;e<t.length;e++)for(let n=0;n<t[e].length;n++)t[e][n]=new d.default;let n=0;for(let r of e.getDetectionResultColumns()){if(null!=r)for(let e of r.getCodewords())if(null!=e){let r=e.getRowNumber();if(r>=0){if(r>=t.length)continue;t[r][n].setValue(e.getValue())}}n++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,n,r){let i=r?1:-1,l=null;if(m.isValidBarcodeColumn(e,t-i)&&(l=e.getDetectionResultColumn(t-i).getCodeword(n)),null!=l)return r?l.getEndX():l.getStartX();if(l=e.getDetectionResultColumn(t).getCodewordNearby(n),null!=l)return r?l.getStartX():l.getEndX();if(m.isValidBarcodeColumn(e,t-i)&&(l=e.getDetectionResultColumn(t-i).getCodewordNearby(n)),null!=l)return r?l.getEndX():l.getStartX();let s=0;for(;m.isValidBarcodeColumn(e,t-i);){t-=i;for(let n of e.getDetectionResultColumn(t).getCodewords())if(null!=n)return(r?n.getEndX():n.getStartX())+i*s*(n.getEndX()-n.getStartX());s++}return r?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,n,l,s,o,a,u){s=m.adjustCodewordStartColumn(e,t,n,l,s,o);let d,p=m.getModuleBitCount(e,t,n,l,s,o);if(null==p)return null;let f=r.default.sum(p);if(l)d=s+f;else{for(let e=0;e<p.length/2;e++){let t=p[e];p[e]=p[p.length-1-e],p[p.length-1-e]=t}d=s,s=d-f}if(!m.checkCodewordSkew(f,a,u))return null;let g=c.default.getDecodedValue(p),E=i.default.getCodeword(g);return-1===E?null:new h.default(s,d,m.getCodewordBucketNumber(g),E)}static getModuleBitCount(e,t,n,r,i,l){let s=i,o=new Int32Array(8),a=0,u=r?1:-1,h=r;for(;(r?s<n:s>=t)&&a<o.length;)e.get(s,l)===h?(o[a]++,s+=u):(a++,h=!h);return a===o.length||s===(r?n:t)&&a===o.length-1?o:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,n,r,i,l){let s=i,o=r?-1:1;for(let a=0;a<2;a++){for(;(r?s>=t:s<n)&&r===e.get(s,l);){if(Math.abs(i-s)>m.CODEWORD_SKEW_SIZE)return i;s+=o}o=-o,r=!r}return s}static checkCodewordSkew(e,t,n){return t-m.CODEWORD_SKEW_SIZE<=e&&e<=n+m.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,n){if(0===e.length)throw g.FormatException.getFormatInstance();let r=1<<t+1,i=m.correctErrors(e,n,r);m.verifyCodewordCount(e,r);let l=p.default.decode(e,""+t);return l.setErrorsCorrected(i),l.setErasures(n.length),l}static correctErrors(e,t,n){if(null!=t&&t.length>n/2+m.MAX_ERRORS||n<0||n>m.MAX_EC_CODEWORDS)throw g.ChecksumException.getChecksumInstance();return m.errorCorrection.decode(e,n,t)}static verifyCodewordCount(e,t){if(e.length<4)throw g.FormatException.getFormatInstance();let n=e[0];if(n>e.length)throw g.FormatException.getFormatInstance();if(0===n){if(!(t<e.length))throw g.FormatException.getFormatInstance();e[0]=e.length-t}}static getBitCountForCodeword(e){let t=new Int32Array(8),n=0,r=t.length-1;for(;!((1&e)!==n&&(n=1&e,r--,r<0));)t[r]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return m.getCodewordBucketNumber(m.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new f.default;for(let n=0;n<e.length;n++){t.format("Row %2d: ",n);for(let r=0;r<e[n].length;r++){let i=e[n][r];0===i.getValue().length?t.format("        ",null):t.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}t.format("%n")}return t.toString()}}t.default=m,m.CODEWORD_SKEW_SIZE=2,m.MAX_ERRORS=3,m.MAX_EC_CODEWORDS=512,m.errorCorrection=new l.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(288),i=n(530),l=n(5);t.default=class{constructor(){this.field=i.default.PDF417_GF}decode(e,t,n){let i=new r.default(this.field,e),s=new Int32Array(t),o=!1;for(let e=t;e>0;e--){let n=i.evaluateAt(this.field.exp(e));s[t-e]=n,0!==n&&(o=!0)}if(!o)return 0;let a=this.field.getOne();if(null!=n)for(const t of n){let n=this.field.exp(e.length-1-t),i=new r.default(this.field,new Int32Array([this.field.subtract(0,n),1]));a=a.multiply(i)}let u=new r.default(this.field,s),h=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),u,t),d=h[0],c=h[1],p=this.findErrorLocations(d),f=this.findErrorMagnitudes(c,d,p);for(let t=0;t<p.length;t++){let n=e.length-1-this.field.log(p[t]);if(n<0)throw l.ChecksumException.getChecksumInstance();e[n]=this.field.subtract(e[n],f[t])}return p.length}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){let n=e;e=t,t=n}let r=e,i=t,s=this.field.getZero(),o=this.field.getOne();for(;i.getDegree()>=Math.round(n/2);){let e=r,t=s;if(r=i,s=o,r.isZero())throw l.ChecksumException.getChecksumInstance();i=e;let n=this.field.getZero(),a=r.getCoefficient(r.getDegree()),u=this.field.inverse(a);for(;i.getDegree()>=r.getDegree()&&!i.isZero();){let e=i.getDegree()-r.getDegree(),t=this.field.multiply(i.getCoefficient(i.getDegree()),u);n=n.add(this.field.buildMonomial(e,t)),i=i.subtract(r.multiplyByMonomial(e,t))}o=n.multiply(s).subtract(t).negative()}let a=o.getCoefficient(0);if(0===a)throw l.ChecksumException.getChecksumInstance();let u=this.field.inverse(a);return[o.multiply(u),i.multiply(u)]}findErrorLocations(e){let t=e.getDegree(),n=new Int32Array(t),r=0;for(let i=1;i<this.field.getSize()&&r<t;i++)0===e.evaluateAt(i)&&(n[r]=this.field.inverse(i),r++);if(r!==t)throw l.ChecksumException.getChecksumInstance();return n}findErrorMagnitudes(e,t,n){let i=t.getDegree(),l=new Int32Array(i);for(let e=1;e<=i;e++)l[i-e]=this.field.multiply(e,t.getCoefficient(e));let s=new r.default(this.field,l),o=n.length,a=new Int32Array(o);for(let t=0;t<o;t++){let r=this.field.inverse(n[t]),i=this.field.subtract(0,e.evaluateAt(r)),l=this.field.inverse(s.evaluateAt(r));a[t]=this.field.multiply(i,l)}return a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(102),i=n(288),l=n(531),s=n(5);class o extends l.default{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let n=1;for(let r=0;r<e;r++)this.expTable[r]=n,n=n*t%e;for(let t=0;t<e-1;t++)this.logTable[this.expTable[t]]=t;this.zero=new i.default(this,new Int32Array([0])),this.one=new i.default(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new s.IllegalArgumentException;if(0===t)return this.zero;let n=new Int32Array(e+1);return n[0]=t,new i.default(this,n)}}t.default=o,o.PDF417_GF=new o(r.default.NUMBER_OF_CODEWORDS,3)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.default=class{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(0===e)throw new r.IllegalArgumentException;return this.logTable[e]}inverse(e){if(0===e)throw new r.ArithmeticException;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(102),i=n(533),l=n(290),s=n(291);class o extends l.default{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())null!=e&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let n=this.getBoundingBox(),r=this._isLeft?n.getTopLeft():n.getTopRight(),i=this._isLeft?n.getBottomLeft():n.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(r.getY())),s=this.imageRowToCodewordIndex(Math.trunc(i.getY())),o=-1,a=1,u=0;for(let n=l;n<s;n++){if(null==t[n])continue;let r=t[n],i=r.getRowNumber()-o;if(0===i)u++;else if(1===i)a=Math.max(a,u),u=1,o=r.getRowNumber();else if(i<0||r.getRowNumber()>=e.getRowCount()||i>n)t[n]=null;else{let e;e=a>2?(a-2)*i:i;let l=e>=n;for(let r=1;r<=e&&!l;r++)l=null!=t[n-r];l?t[n]=null:(o=r.getRowNumber(),u=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(null==e)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let e of this.getCodewords())if(null!=e){let n=e.getRowNumber();if(n>=t.length)continue;t[n]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),n=this._isLeft?t.getTopLeft():t.getTopRight(),r=this._isLeft?t.getBottomLeft():t.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(n.getY())),l=this.imageRowToCodewordIndex(Math.trunc(r.getY())),s=this.getCodewords(),o=-1,a=1,u=0;for(let t=i;t<l;t++){if(null==s[t])continue;let n=s[t];n.setRowNumberAsRowIndicatorColumn();let r=n.getRowNumber()-o;0===r?u++:1===r?(a=Math.max(a,u),u=1,o=n.getRowNumber()):n.getRowNumber()>=e.getRowCount()?s[t]=null:(o=n.getRowNumber(),u=1)}}getBarcodeMetadata(){let e=this.getCodewords(),t=new s.default,n=new s.default,l=new s.default,o=new s.default;for(let r of e){if(null==r)continue;r.setRowNumberAsRowIndicatorColumn();let e=r.getValue()%30,i=r.getRowNumber();switch(this._isLeft||(i+=2),i%3){case 0:n.setValue(3*e+1);break;case 1:o.setValue(e/3),l.setValue(e%3);break;case 2:t.setValue(e+1)}}if(0===t.getValue().length||0===n.getValue().length||0===l.getValue().length||0===o.getValue().length||t.getValue()[0]<1||n.getValue()[0]+l.getValue()[0]<r.default.MIN_ROWS_IN_BARCODE||n.getValue()[0]+l.getValue()[0]>r.default.MAX_ROWS_IN_BARCODE)return null;let a=new i.default(t.getValue()[0],n.getValue()[0],l.getValue()[0],o.getValue()[0]);return this.removeIncorrectCodewords(e,a),a}removeIncorrectCodewords(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(null==e[n])continue;let i=r.getValue()%30,l=r.getRowNumber();if(l>t.getRowCount())e[n]=null;else switch(this._isLeft||(l+=2),l%3){case 0:3*i+1!==t.getRowCountUpperPart()&&(e[n]=null);break;case 1:Math.trunc(i/3)===t.getErrorCorrectionLevel()&&i%3===t.getRowCountLowerPart()||(e[n]=null);break;case 2:i+1!==t.getColumnCount()&&(e[n]=null)}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+"\n"+super.toString()}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,r){this.columnCount=e,this.errorCorrectionLevel=r,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(102),i=n(206);class l{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e,t=r.default.MAX_CODEWORDS_IN_BARCODE;do{e=t,t=this.adjustRowNumbersAndGetCount()}while(t>0&&t<e);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){null!=e&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(0===e)return 0;for(let e=1;e<this.barcodeColumnCount+1;e++){let t=this.detectionResultColumns[e].getCodewords();for(let n=0;n<t.length;n++)null!=t[n]&&(t[n].hasValidRowNumber()||this.adjustRowNumbers(e,n,t))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(null==this.detectionResultColumns[0]||null==this.detectionResultColumns[this.barcodeColumnCount+1])return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<e.length;n++)if(null!=e[n]&&null!=t[n]&&e[n].getRowNumber()===t[n].getRowNumber())for(let t=1;t<=this.barcodeColumnCount;t++){let r=this.detectionResultColumns[t].getCodewords()[n];null!=r&&(r.setRowNumber(e[n].getRowNumber()),r.hasValidRowNumber()||(this.detectionResultColumns[t].getCodewords()[n]=null))}}adjustRowNumbersFromRRI(){if(null==this.detectionResultColumns[this.barcodeColumnCount+1])return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<t.length;n++){if(null==t[n])continue;let r=t[n].getRowNumber(),i=0;for(let t=this.barcodeColumnCount+1;t>0&&i<this.ADJUST_ROW_NUMBER_SKIP;t--){let s=this.detectionResultColumns[t].getCodewords()[n];null!=s&&(i=l.adjustRowNumberIfValid(r,i,s),s.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(null==this.detectionResultColumns[0])return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let n=0;n<t.length;n++){if(null==t[n])continue;let r=t[n].getRowNumber(),i=0;for(let t=1;t<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;t++){let s=this.detectionResultColumns[t].getCodewords()[n];null!=s&&(i=l.adjustRowNumberIfValid(r,i,s),s.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,n){return null==n||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,n){let r=n[t],i=this.detectionResultColumns[e-1].getCodewords(),s=i;null!=this.detectionResultColumns[e+1]&&(s=this.detectionResultColumns[e+1].getCodewords());let o=new Array(14);o[2]=i[t],o[3]=s[t],t>0&&(o[0]=n[t-1],o[4]=i[t-1],o[5]=s[t-1]),t>1&&(o[8]=n[t-2],o[10]=i[t-2],o[11]=s[t-2]),t<n.length-1&&(o[1]=n[t+1],o[6]=i[t+1],o[7]=s[t+1]),t<n.length-2&&(o[9]=n[t+2],o[12]=i[t+2],o[13]=s[t+2]);for(let e of o)if(l.adjustRowNumber(r,e))return}static adjustRowNumber(e,t){return null!=t&&(!(!t.hasValidRowNumber()||t.getBucket()!==e.getBucket())&&(e.setRowNumber(t.getRowNumber()),!0))}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];null==e&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new i.default;for(let n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(let e=0;e<this.barcodeColumnCount+2;e++){if(null==this.detectionResultColumns[e]){t.format("    |   ");continue}let r=this.detectionResultColumns[e].getCodewords()[n];null!=r?t.format(" %3d|%3d",r.getRowNumber(),r.getValue()):t.format("    |   ")}t.format("%n")}return t.toString()}}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t,n,i){this.rowNumber=r.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(n),this.value=Math.trunc(i)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==r.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(3*Math.trunc(this.value/30)+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}t.default=r,r.BARCODE_ROW_UNKNOWN=-1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(72),i=n(102),l=n(271);class s{static initialize(){for(let e=0;e<i.default.SYMBOL_TABLE.length;e++){let t=i.default.SYMBOL_TABLE[e],n=1&t;for(let r=0;r<i.default.BARS_IN_MODULE;r++){let l=0;for(;(1&t)===n;)l+=1,t>>=1;n=1&t,s.RATIOS_TABLE[e]||(s.RATIOS_TABLE[e]=new Array(i.default.BARS_IN_MODULE)),s.RATIOS_TABLE[e][i.default.BARS_IN_MODULE-r-1]=Math.fround(l/i.default.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=s.getDecodedCodewordValue(s.sampleBitCounts(e));return-1!==t?t:s.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=r.default.sum(e),n=new Int32Array(i.default.BARS_IN_MODULE),l=0,s=0;for(let r=0;r<i.default.MODULES_IN_CODEWORD;r++){let o=t/(2*i.default.MODULES_IN_CODEWORD)+r*t/i.default.MODULES_IN_CODEWORD;s+e[l]<=o&&(s+=e[l],l++),n[l]++}return n}static getDecodedCodewordValue(e){let t=s.getBitValue(e);return-1===i.default.getCodeword(t)?-1:t}static getBitValue(e){let t=0;for(let n=0;n<e.length;n++)for(let r=0;r<e[n];r++)t=t<<1|(n%2==0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=r.default.sum(e),n=new Array(i.default.BARS_IN_MODULE);if(t>1)for(let r=0;r<n.length;r++)n[r]=Math.fround(e[r]/t);let o=l.default.MAX_VALUE,a=-1;this.bSymbolTableReady||s.initialize();for(let e=0;e<s.RATIOS_TABLE.length;e++){let t=0,r=s.RATIOS_TABLE[e];for(let e=0;e<i.default.BARS_IN_MODULE;e++){let i=Math.fround(r[e]-n[e]);if(t+=Math.fround(i*i),t>=o)break}t<o&&(o=t,a=i.default.SYMBOL_TABLE[e])}return a}}t.default=s,s.bSymbolTableReady=!1,s.RATIOS_TABLE=new Array(i.default.SYMBOL_TABLE.length).map(e=>new Array(i.default.BARS_IN_MODULE))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(114),i=n(128),l=n(538),s=n(100),o=n(21),a=n(84),u=n(539),h=n(540),d=n(124),c=n(5);var p;let f;function g(e){if(void 0===f&&(f=!0),null===f)throw new Error("BigInt is not supported!");return null}!function(e){e[e.ALPHA=0]="ALPHA",e[e.LOWER=1]="LOWER",e[e.MIXED=2]="MIXED",e[e.PUNCT=3]="PUNCT",e[e.ALPHA_SHIFT=4]="ALPHA_SHIFT",e[e.PUNCT_SHIFT=5]="PUNCT_SHIFT"}(p||(p={}));class m{static decode(e,t){let n=new o.default(""),s=r.default.ISO8859_1;n.enableDecoding(s);let a=1,u=e[a++],h=new l.default;for(;a<e[0];){switch(u){case m.TEXT_COMPACTION_MODE_LATCH:a=m.textCompaction(e,a,n);break;case m.BYTE_COMPACTION_MODE_LATCH:case m.BYTE_COMPACTION_MODE_LATCH_6:a=m.byteCompaction(u,e,s,a,n);break;case m.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[a++]);break;case m.NUMERIC_COMPACTION_MODE_LATCH:a=m.numericCompaction(e,a,n);break;case m.ECI_CHARSET:r.default.getCharacterSetECIByValue(e[a++]);break;case m.ECI_GENERAL_PURPOSE:a+=2;break;case m.ECI_USER_DEFINED:a++;break;case m.BEGIN_MACRO_PDF417_CONTROL_BLOCK:a=m.decodeMacroBlock(e,a,h);break;case m.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case m.MACRO_PDF417_TERMINATOR:throw new c.FormatException;default:a--,a=m.textCompaction(e,a,n)}if(!(a<e.length))throw c.FormatException.getFormatInstance();u=e[a++]}if(0===n.length())throw c.FormatException.getFormatInstance();let d=new i.default(null,n.toString(),null,t);return d.setOther(h),d}static decodeMacroBlock(e,t,n){if(t+m.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw c.FormatException.getFormatInstance();let r=new Int32Array(m.NUMBER_OF_SEQUENCE_CODEWORDS);for(let n=0;n<m.NUMBER_OF_SEQUENCE_CODEWORDS;n++,t++)r[n]=e[t];n.setSegmentIndex(a.default.parseInt(m.decodeBase900toBase10(r,m.NUMBER_OF_SEQUENCE_CODEWORDS)));let i=new o.default;t=m.textCompaction(e,t,i),n.setFileId(i.toString());let l=-1;for(e[t]===m.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(l=t+1);t<e[0];)switch(e[t]){case m.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(e[++t]){case m.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let r=new o.default;t=m.textCompaction(e,t+1,r),n.setFileName(r.toString());break;case m.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let i=new o.default;t=m.textCompaction(e,t+1,i),n.setSender(i.toString());break;case m.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let l=new o.default;t=m.textCompaction(e,t+1,l),n.setAddressee(l.toString());break;case m.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let s=new o.default;t=m.numericCompaction(e,t+1,s),n.setSegmentCount(a.default.parseInt(s.toString()));break;case m.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let h=new o.default;t=m.numericCompaction(e,t+1,h),n.setTimestamp(u.default.parseLong(h.toString()));break;case m.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let d=new o.default;t=m.numericCompaction(e,t+1,d),n.setChecksum(a.default.parseInt(d.toString()));break;case m.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let p=new o.default;t=m.numericCompaction(e,t+1,p),n.setFileSize(u.default.parseLong(p.toString()));break;default:throw c.FormatException.getFormatInstance()}break;case m.MACRO_PDF417_TERMINATOR:t++,n.setLastSegment(!0);break;default:throw c.FormatException.getFormatInstance()}if(-1!==l){let r=t-l;n.isLastSegment()&&r--,n.setOptionalData(s.default.copyOfRange(e,l,l+r))}return t}static textCompaction(e,t,n){let r=new Int32Array(2*(e[0]-t)),i=new Int32Array(2*(e[0]-t)),l=0,s=!1;for(;t<e[0]&&!s;){let n=e[t++];if(n<m.TEXT_COMPACTION_MODE_LATCH)r[l]=n/30,r[l+1]=n%30,l+=2;else switch(n){case m.TEXT_COMPACTION_MODE_LATCH:r[l++]=m.TEXT_COMPACTION_MODE_LATCH;break;case m.BYTE_COMPACTION_MODE_LATCH:case m.BYTE_COMPACTION_MODE_LATCH_6:case m.NUMERIC_COMPACTION_MODE_LATCH:case m.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case m.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case m.MACRO_PDF417_TERMINATOR:t--,s=!0;break;case m.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r[l]=m.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,n=e[t++],i[l]=n,l++}}return m.decodeTextCompaction(r,i,l,n),t}static decodeTextCompaction(e,t,n,r){let i=p.ALPHA,l=p.ALPHA,s=0;for(;s<n;){let n=e[s],o="";switch(i){case p.ALPHA:if(n<26)o=String.fromCharCode(65+n);else switch(n){case 26:o=" ";break;case m.LL:i=p.LOWER;break;case m.ML:i=p.MIXED;break;case m.PS:l=i,i=p.PUNCT_SHIFT;break;case m.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[s]);break;case m.TEXT_COMPACTION_MODE_LATCH:i=p.ALPHA}break;case p.LOWER:if(n<26)o=String.fromCharCode(97+n);else switch(n){case 26:o=" ";break;case m.AS:l=i,i=p.ALPHA_SHIFT;break;case m.ML:i=p.MIXED;break;case m.PS:l=i,i=p.PUNCT_SHIFT;break;case m.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[s]);break;case m.TEXT_COMPACTION_MODE_LATCH:i=p.ALPHA}break;case p.MIXED:if(n<m.PL)o=m.MIXED_CHARS[n];else switch(n){case m.PL:i=p.PUNCT;break;case 26:o=" ";break;case m.LL:i=p.LOWER;break;case m.AL:i=p.ALPHA;break;case m.PS:l=i,i=p.PUNCT_SHIFT;break;case m.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[s]);break;case m.TEXT_COMPACTION_MODE_LATCH:i=p.ALPHA}break;case p.PUNCT:if(n<m.PAL)o=m.PUNCT_CHARS[n];else switch(n){case m.PAL:i=p.ALPHA;break;case m.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[s]);break;case m.TEXT_COMPACTION_MODE_LATCH:i=p.ALPHA}break;case p.ALPHA_SHIFT:if(i=l,n<26)o=String.fromCharCode(65+n);else switch(n){case 26:o=" ";break;case m.TEXT_COMPACTION_MODE_LATCH:i=p.ALPHA}break;case p.PUNCT_SHIFT:if(i=l,n<m.PAL)o=m.PUNCT_CHARS[n];else switch(n){case m.PAL:i=p.ALPHA;break;case m.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[s]);break;case m.TEXT_COMPACTION_MODE_LATCH:i=p.ALPHA}}""!==o&&r.append(o),s++}}static byteCompaction(e,t,n,r,i){let l=new h.default,s=0,o=0,a=!1;switch(e){case m.BYTE_COMPACTION_MODE_LATCH:let e=new Int32Array(6),n=t[r++];for(;r<t[0]&&!a;)switch(e[s++]=n,o=900*o+n,n=t[r++],n){case m.TEXT_COMPACTION_MODE_LATCH:case m.BYTE_COMPACTION_MODE_LATCH:case m.NUMERIC_COMPACTION_MODE_LATCH:case m.BYTE_COMPACTION_MODE_LATCH_6:case m.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case m.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case m.MACRO_PDF417_TERMINATOR:r--,a=!0;break;default:if(s%5==0&&s>0){for(let e=0;e<6;++e)l.write(Number(g()>>g()));o=0,s=0}}r===t[0]&&n<m.TEXT_COMPACTION_MODE_LATCH&&(e[s++]=n);for(let t=0;t<s;t++)l.write(e[t]);break;case m.BYTE_COMPACTION_MODE_LATCH_6:for(;r<t[0]&&!a;){let e=t[r++];if(e<m.TEXT_COMPACTION_MODE_LATCH)s++,o=900*o+e;else switch(e){case m.TEXT_COMPACTION_MODE_LATCH:case m.BYTE_COMPACTION_MODE_LATCH:case m.NUMERIC_COMPACTION_MODE_LATCH:case m.BYTE_COMPACTION_MODE_LATCH_6:case m.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case m.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case m.MACRO_PDF417_TERMINATOR:r--,a=!0}if(s%5==0&&s>0){for(let e=0;e<6;++e)l.write(Number(g()>>g()));o=0,s=0}}}return i.append(d.default.decode(l.toByteArray(),n)),r}static numericCompaction(e,t,n){let r=0,i=!1,l=new Int32Array(m.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!i;){let s=e[t++];if(t===e[0]&&(i=!0),s<m.TEXT_COMPACTION_MODE_LATCH)l[r]=s,r++;else switch(s){case m.TEXT_COMPACTION_MODE_LATCH:case m.BYTE_COMPACTION_MODE_LATCH:case m.BYTE_COMPACTION_MODE_LATCH_6:case m.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case m.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case m.MACRO_PDF417_TERMINATOR:t--,i=!0}(r%m.MAX_NUMERIC_CODEWORDS==0||s===m.NUMERIC_COMPACTION_MODE_LATCH||i)&&r>0&&(n.append(m.decodeBase900toBase10(l,r)),r=0)}return t}static decodeBase900toBase10(e,t){let n=g();for(let r=0;r<t;r++)n+=m.EXP900[t-r-1]*g(e[r]);let r=n.toString();if("1"!==r.charAt(0))throw new c.FormatException;return r.substring(1)}}t.default=m,m.TEXT_COMPACTION_MODE_LATCH=900,m.BYTE_COMPACTION_MODE_LATCH=901,m.NUMERIC_COMPACTION_MODE_LATCH=902,m.BYTE_COMPACTION_MODE_LATCH_6=924,m.ECI_USER_DEFINED=925,m.ECI_GENERAL_PURPOSE=926,m.ECI_CHARSET=927,m.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,m.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,m.MACRO_PDF417_TERMINATOR=922,m.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,m.MAX_NUMERIC_CODEWORDS=15,m.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,m.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,m.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,m.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,m.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,m.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,m.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,m.PL=25,m.LL=27,m.AS=27,m.ML=28,m.AL=28,m.PS=29,m.PAL=29,m.PUNCT_CHARS=";<>@[\\]_`~!\r\t,:\n-.$/\"|*()?{}'",m.MIXED_CHARS="0123456789&\r\t,:#-.$/+%*=^",m.EXP900=function(){let e=[];e[0]=g();let t=g();e[1]=t;for(let n=2;n<16;n++)e[n]=e[n-1]*t;return e}(),m.NUMBER_OF_SEQUENCE_CODEWORDS=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{static parseLong(e,t){return parseInt(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(100),i=n(541),l=n(84),s=n(49),o=n(5),a=n(543),u=n(191);class h extends i.default{constructor(e=32){if(super(),this.count=0,e<0)throw new o.IllegalArgumentException("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let t=this.buf.length<<1;if(t-e<0&&(t=e),t<0){if(e<0)throw new a.OutOfMemoryError;t=l.default.MAX_VALUE}this.buf=r.default.copyOfUint8Array(this.buf,t)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,n){if(t<0||t>e.length||n<0||t+n-e.length>0)throw new u.IndexOutOfBoundsException;this.ensureCapacity(this.count+n),s.default.arraycopy(e,t,this.buf,this.count,n),this.count+=n}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return r.default.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?"string"==typeof e?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(191),i=n(542);t.default=class{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,n){if(null==e)throw new i.NullPointerException;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new r.IndexOutOfBoundsException;if(0!==n)for(let r=0;r<n;r++)this.write(e[t+r])}flush(){}close(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NullPointerException=void 0;const r=n(5);class i extends r.Exception{}t.NullPointerException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutOfMemoryError=void 0;const r=n(5);class i extends r.Exception{}t.OutOfMemoryError=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserPDF417Reader=void 0;const r=n(98),i=n(287);class l extends r.BrowserCodeReader{constructor(e=500){super(new i.default,e)}}t.BrowserPDF417Reader=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserQRCodeReader=void 0;const r=n(98),i=n(204);class l extends r.BrowserCodeReader{constructor(e=500){super(new i.default,e)}}t.BrowserQRCodeReader=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(100),i=n(21);class l{constructor(e,t){this.width=e,this.height=t;const n=new Array(t);for(let r=0;r!==t;r++)n[r]=new Uint8Array(e);this.bytes=n}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,n){this.bytes[t][e]=n}setBoolean(e,t,n){this.bytes[t][e]=n?1:0}clear(e){for(const t of this.bytes)r.default.fill(t,e)}equals(e){if(!(e instanceof l))return!1;const t=e;if(this.width!==t.width)return!1;if(this.height!==t.height)return!1;for(let e=0,n=this.height;e<n;++e){const n=this.bytes[e],r=t.bytes[e];for(let e=0,t=this.width;e<t;++e)if(n[e]!==r[e])return!1}return!0}toString(){const e=new i.default;for(let t=0,n=this.height;t<n;++t){const n=this.bytes[t];for(let t=0,r=this.width;t<r;++t)switch(n[t]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ")}e.append("\n")}return e.toString()}}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(99),i=n(84),l=n(208),s=n(294),o=n(5);class a{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,n,r,i){a.clearMatrix(i),a.embedBasicPatterns(n,i),a.embedTypeInfo(t,r,i),a.maybeEmbedVersionInfo(n,i),a.embedDataBits(e,r,i)}static embedBasicPatterns(e,t){a.embedPositionDetectionPatternsAndSeparators(t),a.embedDarkDotAtLeftBottomCorner(t),a.maybeEmbedPositionAdjustmentPatterns(e,t),a.embedTimingPatterns(t)}static embedTypeInfo(e,t,n){const i=new r.default;a.makeTypeInfoBits(e,t,i);for(let e=0,t=i.getSize();e<t;++e){const t=i.get(i.getSize()-1-e),r=a.TYPE_INFO_COORDINATES[e],l=r[0],s=r[1];if(n.setBoolean(l,s,t),e<8){const r=n.getWidth()-e-1,i=8;n.setBoolean(r,i,t)}else{const r=8,i=n.getHeight()-7+(e-8);n.setBoolean(r,i,t)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const n=new r.default;a.makeVersionInfoBits(e,n);let i=17;for(let e=0;e<6;++e)for(let r=0;r<3;++r){const l=n.get(i);i--,t.setBoolean(e,t.getHeight()-11+r,l),t.setBoolean(t.getHeight()-11+r,e,l)}}static embedDataBits(e,t,n){let r=0,i=-1,l=n.getWidth()-1,u=n.getHeight()-1;for(;l>0;){for(6===l&&(l-=1);u>=0&&u<n.getHeight();){for(let i=0;i<2;++i){const o=l-i;if(!a.isEmpty(n.get(o,u)))continue;let h;r<e.getSize()?(h=e.get(r),++r):h=!1,255!==t&&s.default.getDataMaskBit(t,o,u)&&(h=!h),n.setBoolean(o,u,h)}u+=i}i=-i,u+=i,l-=2}if(r!==e.getSize())throw new o.WriterException("Not all bits consumed: "+r+"/"+e.getSize())}static findMSBSet(e){return 32-i.default.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(0===t)throw new o.IllegalArgumentException("0 polynomial");const n=a.findMSBSet(t);for(e<<=n-1;a.findMSBSet(e)>=n;)e^=t<<a.findMSBSet(e)-n;return e}static makeTypeInfoBits(e,t,n){if(!l.default.isValidMaskPattern(t))throw new o.WriterException("Invalid mask pattern");const i=e.getBits()<<3|t;n.appendBits(i,5);const s=a.calculateBCHCode(i,a.TYPE_INFO_POLY);n.appendBits(s,10);const u=new r.default;if(u.appendBits(a.TYPE_INFO_MASK_PATTERN,15),n.xor(u),15!==n.getSize())throw new o.WriterException("should not happen but we got: "+n.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const n=a.calculateBCHCode(e.getVersionNumber(),a.VERSION_INFO_POLY);if(t.appendBits(n,12),18!==t.getSize())throw new o.WriterException("should not happen but we got: "+t.getSize())}static isEmpty(e){return 255===e}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const n=(t+1)%2;a.isEmpty(e.get(t,6))&&e.setNumber(t,6,n),a.isEmpty(e.get(6,t))&&e.setNumber(6,t,n)}}static embedDarkDotAtLeftBottomCorner(e){if(0===e.get(8,e.getHeight()-8))throw new o.WriterException;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,n){for(let r=0;r<8;++r){if(!a.isEmpty(n.get(e+r,t)))throw new o.WriterException;n.setNumber(e+r,t,0)}}static embedVerticalSeparationPattern(e,t,n){for(let r=0;r<7;++r){if(!a.isEmpty(n.get(e,t+r)))throw new o.WriterException;n.setNumber(e,t+r,0)}}static embedPositionAdjustmentPattern(e,t,n){for(let r=0;r<5;++r){const i=a.POSITION_ADJUSTMENT_PATTERN[r];for(let l=0;l<5;++l)n.setNumber(e+l,t+r,i[l])}}static embedPositionDetectionPattern(e,t,n){for(let r=0;r<7;++r){const i=a.POSITION_DETECTION_PATTERN[r];for(let l=0;l<7;++l)n.setNumber(e+l,t+r,i[l])}}static embedPositionDetectionPatternsAndSeparators(e){const t=a.POSITION_DETECTION_PATTERN[0].length;a.embedPositionDetectionPattern(0,0,e),a.embedPositionDetectionPattern(e.getWidth()-t,0,e),a.embedPositionDetectionPattern(0,e.getWidth()-t,e);a.embedHorizontalSeparationPattern(0,7,e),a.embedHorizontalSeparationPattern(e.getWidth()-8,7,e),a.embedHorizontalSeparationPattern(0,e.getWidth()-8,e);a.embedVerticalSeparationPattern(7,0,e),a.embedVerticalSeparationPattern(e.getHeight()-7-1,0,e),a.embedVerticalSeparationPattern(7,e.getHeight()-7,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const n=e.getVersionNumber()-1,r=a.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n];for(let e=0,n=r.length;e!==n;e++){const i=r[e];if(i>=0)for(let e=0;e!==n;e++){const n=r[e];n>=0&&a.isEmpty(t.get(n,i))&&a.embedPositionAdjustmentPattern(n-2,i-2,t)}}}}t.default=a,a.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),a.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),a.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),a.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),a.VERSION_INFO_POLY=7973,a.TYPE_INFO_POLY=1335,a.TYPE_INFO_MASK_PATTERN=21522},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(295),i=n(34),l=n(5);t.default=class{encode(e,t,n,s,o){let a;switch(t){case i.default.QR_CODE:a=new r.default;break;default:throw new l.IllegalArgumentException("No encoder available for format "+t)}return a.encode(e,t,n,s,o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(49),i=n(127),l=n(126),s=n(5);class o extends i.default{constructor(e,t,n,r,i,l,o,a){if(super(l,o),this.yuvData=e,this.dataWidth=t,this.dataHeight=n,this.left=r,this.top=i,r+l>t||i+o>n)throw new s.IllegalArgumentException("Crop rectangle does not fit within image data.");a&&this.reverseHorizontal(l,o)}getRow(e,t){if(e<0||e>=this.getHeight())throw new s.IllegalArgumentException("Requested row is outside the image: "+e);const n=this.getWidth();(null==t||t.length<n)&&(t=new Uint8ClampedArray(n));const i=(e+this.top)*this.dataWidth+this.left;return r.default.arraycopy(this.yuvData,i,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const n=e*t,i=new Uint8ClampedArray(n);let l=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return r.default.arraycopy(this.yuvData,l,i,0,n),i;for(let n=0;n<t;n++){const t=n*e;r.default.arraycopy(this.yuvData,l,i,t,e),l+=this.dataWidth}return i}isCropSupported(){return!0}crop(e,t,n,r){return new o(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,n,r,!1)}renderThumbnail(){const e=this.getWidth()/o.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/o.THUMBNAIL_SCALE_FACTOR,n=new Int32Array(e*t),r=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let l=0;l<t;l++){const t=l*e;for(let l=0;l<e;l++){const e=255&r[i+l*o.THUMBNAIL_SCALE_FACTOR];n[t+l]=4278190080|65793*e}i+=this.dataWidth*o.THUMBNAIL_SCALE_FACTOR}return n}getThumbnailWidth(){return this.getWidth()/o.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/o.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const n=this.yuvData;for(let r=0,i=this.top*this.dataWidth+this.left;r<t;r++,i+=this.dataWidth){const t=i+e/2;for(let r=i,l=i+e-1;r<t;r++,l--){const e=n[r];n[r]=n[l],n[l]=e}}}invert(){return new l.default(this)}}t.default=o,o.THUMBNAIL_SCALE_FACTOR=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(126);const r=n(126),i=n(127),l=n(49),s=n(5);class o extends i.default{constructor(e,t,n,r,i,l,o){if(super(t,n),this.dataWidth=r,this.dataHeight=i,this.left=l,this.top=o,4===e.BYTES_PER_ELEMENT){const r=t*n,i=new Uint8ClampedArray(r);for(let t=0;t<r;t++){const n=e[t],r=n>>16&255,l=n>>7&510,s=255&n;i[t]=(r+l+s)/4&255}this.luminances=i}else this.luminances=e;if(void 0===r&&(this.dataWidth=t),void 0===i&&(this.dataHeight=n),void 0===l&&(this.left=0),void 0===o&&(this.top=0),this.left+t>this.dataWidth||this.top+n>this.dataHeight)throw new s.IllegalArgumentException("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new s.IllegalArgumentException("Requested row is outside the image: "+e);const n=this.getWidth();(null==t||t.length<n)&&(t=new Uint8ClampedArray(n));const r=(e+this.top)*this.dataWidth+this.left;return l.default.arraycopy(this.luminances,r,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const n=e*t,r=new Uint8ClampedArray(n);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return l.default.arraycopy(this.luminances,i,r,0,n),r;for(let n=0;n<t;n++){const t=n*e;l.default.arraycopy(this.luminances,i,r,t,e),i+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,n,r){return new o(this.luminances,n,r,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new r.default(this)}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),i=n(57),l=n(72),s=n(277),o=n(201),a=n(278),u=n(279),h=n(555),d=n(568),c=n(569),p=n(570),f=n(49),g=n(5);class m extends s.default{constructor(){super(...arguments),this.pairs=new Array(m.MAX_PAIRS),this.rows=new Array,this.startEnd=[2]}decodeRow(e,t,n){this.pairs.length=0,this.startFromEven=!1;try{return m.constructResult(this.decodeRow2pairs(e,t))}catch(e){}return this.pairs.length=0,this.startFromEven=!0,m.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let n,r=!1;for(;!r;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(e){if(!this.pairs.length)throw new e;r=!0}if(this.checkChecksum())return this.pairs;if(n=!!this.rows.length,this.storeRow(e,!1),n){let e=this.checkRowsBoolean(!1);if(null!=e)return e;if(e=this.checkRowsBoolean(!0),null!=e)return e}throw new g.NotFoundException}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(e){}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let n=t;n<this.rows.length;n++){let t=this.rows[n];this.pairs.length=0;for(let t of e)this.pairs.push(t.getPairs());if(this.pairs.push(t.getPairs()),!m.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let r=new Array(e);r.push(t);try{return this.checkRows(r,n+1)}catch(e){}}throw new g.NotFoundException}static isValidSequence(e){for(let t of m.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let n=!0;for(let r=0;r<e.length;r++)if(e[r].getFinderPattern().getValue()!=t[r]){n=!1;break}if(n)return!0}return!1}storeRow(e,t){let n=0,r=!1,i=!1;for(;n<this.rows.length;){let t=this.rows[n];if(t.getRowNumber()>e){i=t.isEquivalent(this.pairs);break}r=t.isEquivalent(this.pairs),n++}i||r||m.isPartialRow(this.pairs,this.rows)||(this.rows.push(n,new c.default(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let n of t){if(n.getPairs().length===e.length)continue;let t=!0;for(let r of n.getPairs()){let n=!1;for(let t of e)if(d.default.equals(r,t)){n=!0;break}n||(t=!1)}}}static isPartialRow(e,t){for(let n of t){let t=!0;for(let r of e){let e=!1;for(let t of n.getPairs())if(r.equals(t)){e=!0;break}if(!e){t=!1;break}}if(t)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=p.default.buildBitArray(e),n=h.createDecoder(t).parseInformation(),l=e[0].getFinderPattern().getResultPoints(),s=e[e.length-1].getFinderPattern().getResultPoints(),o=[l[0],l[1],s[0],s[1]];return new i.default(n,null,null,o,r.default.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),n=e.getRightChar();if(null==n)return!1;let r=n.getChecksumPortion(),i=2;for(let e=1;e<this.pairs.size();++e){let t=this.pairs.get(e);r+=t.getLeftChar().getChecksumPortion(),i++;let n=t.getRightChar();null!=n&&(r+=n.getChecksumPortion(),i++)}return r%=211,211*(i-4)+r==t.getValue()}static getNextSecondBar(e,t){let n;return e.get(t)?(n=e.getNextUnset(t),n=e.getNextSet(n)):(n=e.getNextSet(t),n=e.getNextUnset(n)),n}retrieveNextPair(e,t,n){let r,i=t.length%2==0;this.startFromEven&&(i=!i);let l=!0,s=-1;do{this.findNextPair(e,t,s),r=this.parseFoundFinderPattern(e,n,i),null==r?s=m.getNextSecondBar(e,this.startEnd[0]):l=!1}while(l);let o,a=this.decodeDataCharacter(e,r,i,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new g.NotFoundException;try{o=this.decodeDataCharacter(e,r,i,!1)}catch(e){o=null}return new d.default(a,o,r,!0)}isEmptyPair(e){return 0===e.length}findNextPair(e,t,n){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i,l=e.getSize();if(n>=0)i=n;else if(this.isEmptyPair(t))i=0;else{i=t[t.length-1].getFinderPattern().getStartEnd()[1]}let s=t.length%2!=0;this.startFromEven&&(s=!s);let o=!1;for(;i<l&&(o=!e.get(i),o);)i++;let a=0,u=i;for(let t=i;t<l;t++)if(e.get(t)!=o)r[a]++;else{if(3==a){if(s&&m.reverseCounters(r),m.isFinderPattern(r))return this.startEnd[0]=u,void(this.startEnd[1]=t);s&&m.reverseCounters(r),u+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,a--}else a++;r[a]=1,o=!o}throw new g.NotFoundException}static reverseCounters(e){let t=e.length;for(let n=0;n<t/2;++n){let r=e[n];e[n]=e[t-n-1],e[t-n-1]=r}}parseFoundFinderPattern(e,t,n){let r,i,l;if(n){let t=this.startEnd[0]-1;for(;t>=0&&!e.get(t);)t--;t++,r=this.startEnd[0]-t,i=t,l=this.startEnd[1]}else i=this.startEnd[0],l=e.getNextUnset(this.startEnd[1]+1),r=l-this.startEnd[1];let s,o=this.getDecodeFinderCounters();f.default.arraycopy(o,0,o,1,o.length-1),o[0]=r;try{s=this.parseFinderValue(o,m.FINDER_PATTERNS)}catch(e){return null}return new a.default(s,[i,l],i,l,t)}decodeDataCharacter(e,t,n,r){let i=this.getDataCharacterCounters();for(let e=0;e<i.length;e++)i[e]=0;if(r)m.recordPatternInReverse(e,t.getStartEnd()[0],i);else{m.recordPattern(e,t.getStartEnd()[1],i);for(let e=0,t=i.length-1;e<t;e++,t--){let n=i[e];i[e]=i[t],i[t]=n}}let s=l.default.sum(new Int32Array(i))/17,a=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(s-a)/a>.3)throw new g.NotFoundException;let h=this.getOddCounts(),d=this.getEvenCounts(),c=this.getOddRoundingErrors(),p=this.getEvenRoundingErrors();for(let e=0;e<i.length;e++){let t=1*i[e]/s,n=t+.5;if(n<1){if(t<.3)throw new g.NotFoundException;n=1}else if(n>8){if(t>8.7)throw new g.NotFoundException;n=8}let r=e/2;0==(1&e)?(h[r]=n,c[r]=t-n):(d[r]=n,p[r]=t-n)}this.adjustOddEvenCounts(17);let f=4*t.getValue()+(n?0:2)+(r?0:1)-1,E=0,C=0;for(let e=h.length-1;e>=0;e--){if(m.isNotA1left(t,n,r)){let t=m.WEIGHTS[f][2*e];C+=h[e]*t}E+=h[e]}let A=0;for(let e=d.length-1;e>=0;e--)if(m.isNotA1left(t,n,r)){let t=m.WEIGHTS[f][2*e+1];A+=d[e]*t}let y=C+A;if(0!=(1&E)||E>13||E<4)throw new g.NotFoundException;let I=(13-E)/2,S=m.SYMBOL_WIDEST[I],_=9-S,w=u.default.getRSSvalue(h,S,!0),b=u.default.getRSSvalue(d,_,!1),x=w*m.EVEN_TOTAL_SUBSET[I]+b+m.GSUM[I];return new o.default(x,y)}static isNotA1left(e,t,n){return!(0==e.getValue()&&t&&n)}adjustOddEvenCounts(e){let t=l.default.sum(new Int32Array(this.getOddCounts())),n=l.default.sum(new Int32Array(this.getEvenCounts())),r=!1,i=!1;t>13?i=!0:t<4&&(r=!0);let s=!1,o=!1;n>13?o=!0:n<4&&(s=!0);let a=t+n-e,u=1==(1&t),h=0==(1&n);if(1==a)if(u){if(h)throw new g.NotFoundException;i=!0}else{if(!h)throw new g.NotFoundException;o=!0}else if(-1==a)if(u){if(h)throw new g.NotFoundException;r=!0}else{if(!h)throw new g.NotFoundException;s=!0}else{if(0!=a)throw new g.NotFoundException;if(u){if(!h)throw new g.NotFoundException;t<n?(r=!0,o=!0):(i=!0,s=!0)}else if(h)throw new g.NotFoundException}if(r){if(i)throw new g.NotFoundException;m.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&m.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(o)throw new g.NotFoundException;m.increment(this.getEvenCounts(),this.getOddRoundingErrors())}o&&m.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}t.default=m,m.SYMBOL_WIDEST=[7,5,4,3,1],m.EVEN_TOTAL_SUBSET=[4,20,52,104,204],m.GSUM=[0,348,1388,2948,3988],m.FINDER_PATTERNS=[[1,8,4,1],[3,6,4,1],[3,4,6,1],[3,2,8,1],[2,6,5,1],[2,2,9,1]],m.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],m.FINDER_PAT_A=0,m.FINDER_PAT_B=1,m.FINDER_PAT_C=2,m.FINDER_PAT_D=3,m.FINDER_PAT_E=4,m.FINDER_PAT_F=5,m.FINDER_PATTERN_SEQUENCES=[[m.FINDER_PAT_A,m.FINDER_PAT_A],[m.FINDER_PAT_A,m.FINDER_PAT_B,m.FINDER_PAT_B],[m.FINDER_PAT_A,m.FINDER_PAT_C,m.FINDER_PAT_B,m.FINDER_PAT_D],[m.FINDER_PAT_A,m.FINDER_PAT_E,m.FINDER_PAT_B,m.FINDER_PAT_D,m.FINDER_PAT_C],[m.FINDER_PAT_A,m.FINDER_PAT_E,m.FINDER_PAT_B,m.FINDER_PAT_D,m.FINDER_PAT_D,m.FINDER_PAT_F],[m.FINDER_PAT_A,m.FINDER_PAT_E,m.FINDER_PAT_B,m.FINDER_PAT_D,m.FINDER_PAT_E,m.FINDER_PAT_F,m.FINDER_PAT_F],[m.FINDER_PAT_A,m.FINDER_PAT_A,m.FINDER_PAT_B,m.FINDER_PAT_B,m.FINDER_PAT_C,m.FINDER_PAT_C,m.FINDER_PAT_D,m.FINDER_PAT_D],[m.FINDER_PAT_A,m.FINDER_PAT_A,m.FINDER_PAT_B,m.FINDER_PAT_B,m.FINDER_PAT_C,m.FINDER_PAT_C,m.FINDER_PAT_D,m.FINDER_PAT_E,m.FINDER_PAT_E],[m.FINDER_PAT_A,m.FINDER_PAT_A,m.FINDER_PAT_B,m.FINDER_PAT_B,m.FINDER_PAT_C,m.FINDER_PAT_C,m.FINDER_PAT_D,m.FINDER_PAT_E,m.FINDER_PAT_F,m.FINDER_PAT_F],[m.FINDER_PAT_A,m.FINDER_PAT_A,m.FINDER_PAT_B,m.FINDER_PAT_B,m.FINDER_PAT_C,m.FINDER_PAT_D,m.FINDER_PAT_D,m.FINDER_PAT_E,m.FINDER_PAT_E,m.FINDER_PAT_F,m.FINDER_PAT_F]],m.MAX_PAIRS=11},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDecoder=void 0;const r=n(296),i=n(561),l=n(562),s=n(563),o=n(564),a=n(565),u=n(566),h=n(567),d=n(5);t.createDecoder=function(e){try{if(e.get(1))return new i.default(e);if(!e.get(2))return new l.default(e);switch(r.default.extractNumericValueFromBitArray(e,1,4)){case 4:return new s.default(e);case 5:return new o.default(e)}switch(r.default.extractNumericValueFromBitArray(e,1,5)){case 12:return new a.default(e);case 13:return new u.default(e)}switch(r.default.extractNumericValueFromBitArray(e,1,7)){case 56:return new h.default(e,"310","11");case 57:return new h.default(e,"320","11");case 58:return new h.default(e,"310","13");case 59:return new h.default(e,"320","13");case 60:return new h.default(e,"310","15");case 61:return new h.default(e,"320","15");case 62:return new h.default(e,"310","17");case 63:return new h.default(e,"320","17")}}catch(t){throw new d.IllegalStateException("unknown decoder: "+e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(209);class i extends r.default{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===i.FNC1}}t.default=i,i.FNC1="$"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),i=n(209);class l extends i.default{constructor(e,t,n){if(super(e),t<0||t>10||n<0||n>10)throw new r.FormatException;this.firstDigit=t,this.secondDigit=n}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return 10*this.firstDigit+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit==l.FNC1}isSecondDigitFNC1(){return this.secondDigit==l.FNC1}isAnyFNC1(){return this.firstDigit===l.FNC1||this.secondDigit===l.FNC1}}t.default=l,l.FNC1=10},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(209);class i extends r.default{constructor(e,t,n){super(e),n?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);class i{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new r.NotFoundException;let t=e.substring(0,2);for(let n of i.TWO_DIGIT_DATA_LENGTH)if(n[0]===t)return n[1]===i.VARIABLE_LENGTH?i.processVariableAI(2,n[2],e):i.processFixedAI(2,n[1],e);if(e.length<3)throw new r.NotFoundException;let n=e.substring(0,3);for(let t of i.THREE_DIGIT_DATA_LENGTH)if(t[0]===n)return t[1]===i.VARIABLE_LENGTH?i.processVariableAI(3,t[2],e):i.processFixedAI(3,t[1],e);for(let t of i.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(t[0]===n)return t[1]===i.VARIABLE_LENGTH?i.processVariableAI(4,t[2],e):i.processFixedAI(4,t[1],e);if(e.length<4)throw new r.NotFoundException;let l=e.substring(0,4);for(let t of i.FOUR_DIGIT_DATA_LENGTH)if(t[0]===l)return t[1]===i.VARIABLE_LENGTH?i.processVariableAI(4,t[2],e):i.processFixedAI(4,t[1],e);throw new r.NotFoundException}static processFixedAI(e,t,n){if(n.length<e)throw new r.NotFoundException;let l=n.substring(0,e);if(n.length<e+t)throw new r.NotFoundException;let s=n.substring(e,e+t),o=n.substring(e+t),a="("+l+")"+s,u=i.parseFieldsInGeneralPurpose(o);return null==u?a:a+u}static processVariableAI(e,t,n){let r,l=n.substring(0,e);r=n.length<e+t?n.length:e+t;let s=n.substring(e,r),o=n.substring(r),a="("+l+")"+s,u=i.parseFieldsInGeneralPurpose(o);return null==u?a:a+u}}t.default=i,i.VARIABLE_LENGTH=[],i.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",i.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",i.VARIABLE_LENGTH,20],["22",i.VARIABLE_LENGTH,29],["30",i.VARIABLE_LENGTH,8],["37",i.VARIABLE_LENGTH,8],["90",i.VARIABLE_LENGTH,30],["91",i.VARIABLE_LENGTH,30],["92",i.VARIABLE_LENGTH,30],["93",i.VARIABLE_LENGTH,30],["94",i.VARIABLE_LENGTH,30],["95",i.VARIABLE_LENGTH,30],["96",i.VARIABLE_LENGTH,30],["97",i.VARIABLE_LENGTH,3],["98",i.VARIABLE_LENGTH,30],["99",i.VARIABLE_LENGTH,30]],i.THREE_DIGIT_DATA_LENGTH=[["240",i.VARIABLE_LENGTH,30],["241",i.VARIABLE_LENGTH,30],["242",i.VARIABLE_LENGTH,6],["250",i.VARIABLE_LENGTH,30],["251",i.VARIABLE_LENGTH,30],["253",i.VARIABLE_LENGTH,17],["254",i.VARIABLE_LENGTH,20],["400",i.VARIABLE_LENGTH,30],["401",i.VARIABLE_LENGTH,30],["402",17],["403",i.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",i.VARIABLE_LENGTH,20],["421",i.VARIABLE_LENGTH,15],["422",3],["423",i.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],i.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",i.VARIABLE_LENGTH,15],["391",i.VARIABLE_LENGTH,18],["392",i.VARIABLE_LENGTH,15],["393",i.VARIABLE_LENGTH,18],["703",i.VARIABLE_LENGTH,30]],i.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",i.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",i.VARIABLE_LENGTH,20],["8003",i.VARIABLE_LENGTH,30],["8004",i.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",i.VARIABLE_LENGTH,30],["8008",i.VARIABLE_LENGTH,12],["8018",18],["8020",i.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",i.VARIABLE_LENGTH,70],["8200",i.VARIABLE_LENGTH,70]]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(159),i=n(21);class l extends r.default{constructor(e){super(e)}parseInformation(){let e=new i.default;e.append("(01)");let t=e.length(),n=this.getGeneralDecoder().extractNumericValueFromBitArray(l.HEADER_SIZE,4);return e.append(n),this.encodeCompressedGtinWithoutAI(e,l.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,l.HEADER_SIZE+44)}}t.default=l,l.HEADER_SIZE=4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(21),i=n(297);class l extends i.default{constructor(e){super(e)}parseInformation(){let e=new r.default;return this.getGeneralDecoder().decodeAllCodes(e,l.HEADER_SIZE)}}t.default=l,l.HEADER_SIZE=5},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(298);class i extends r.default{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(298);class i extends r.default{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(159),i=n(21),l=n(5);class s extends r.default{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<s.HEADER_SIZE+r.default.GTIN_SIZE)throw new l.NotFoundException;let e=new i.default;this.encodeCompressedGtin(e,s.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(s.HEADER_SIZE+r.default.GTIN_SIZE,s.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let n=this.getGeneralDecoder().decodeGeneralPurposeField(s.HEADER_SIZE+r.default.GTIN_SIZE+s.LAST_DIGIT_SIZE,null);return e.append(n.getNewString()),e.toString()}}t.default=s,s.HEADER_SIZE=8,s.LAST_DIGIT_SIZE=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(159),i=n(21),l=n(5);class s extends r.default{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<s.HEADER_SIZE+r.default.GTIN_SIZE)throw new l.NotFoundException;let e=new i.default;this.encodeCompressedGtin(e,s.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(s.HEADER_SIZE+r.default.GTIN_SIZE,s.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let n=this.getGeneralDecoder().extractNumericValueFromBitArray(s.HEADER_SIZE+r.default.GTIN_SIZE+s.LAST_DIGIT_SIZE,s.FIRST_THREE_DIGITS_SIZE);n/100==0&&e.append("0"),n/10==0&&e.append("0"),e.append(n);let o=this.getGeneralDecoder().decodeGeneralPurposeField(s.HEADER_SIZE+r.default.GTIN_SIZE+s.LAST_DIGIT_SIZE+s.FIRST_THREE_DIGITS_SIZE,null);return e.append(o.getNewString()),e.toString()}}t.default=s,s.HEADER_SIZE=8,s.LAST_DIGIT_SIZE=2,s.FIRST_THREE_DIGITS_SIZE=10},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(299),i=n(21),l=n(5);class s extends r.default{constructor(e,t,n){super(e),this.dateCode=n,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=s.HEADER_SIZE+s.GTIN_SIZE+s.WEIGHT_SIZE+s.DATE_SIZE)throw new l.NotFoundException;let e=new i.default;return this.encodeCompressedGtin(e,s.HEADER_SIZE),this.encodeCompressedWeight(e,s.HEADER_SIZE+s.GTIN_SIZE,s.WEIGHT_SIZE),this.encodeCompressedDate(e,s.HEADER_SIZE+s.GTIN_SIZE+s.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t,s.DATE_SIZE);if(38400==n)return;e.append("("),e.append(this.dateCode),e.append(")");let r=n%32;n/=32;let i=n%12+1;n/=12;let l=n;l/10==0&&e.append("0"),e.append(l),i/10==0&&e.append("0"),e.append(i),r/10==0&&e.append("0"),e.append(r)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}t.default=s,s.HEADER_SIZE=8,s.WEIGHT_SIZE=20,s.DATE_SIZE=16},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t,n,r){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=r}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return null==this.rightchar}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(null==this.finderpattern?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof r&&(r.equalsOrNull(e.leftchar,t.leftchar)&&r.equalsOrNull(e.rightchar,t.rightchar)&&r.equalsOrNull(e.finderpattern,t.finderpattern))}static equalsOrNull(e,t){return null===e?null===t:r.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}static hashNotNull(e){return null===e?0:e.hashCode()}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof r&&(this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed)}checkEqualitity(e,t){if(!e||!t)return;let n;return e.forEach((e,r)=>{t.forEach(t=>{e.getLeftChar().getValue()===t.getLeftChar().getValue()&&e.getRightChar().getValue()===t.getRightChar().getValue()&&e.getFinderPatter().getValue()===t.getFinderPatter().getValue()&&(n=!0)})}),n}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(99);t.default=class{constructor(){}static buildBitArray(e){let t=2*e.length-1;null==e[e.length-1].getRightChar()&&(t-=1);let n=12*t,i=new r.default(n),l=0,s=e[0].getRightChar().getValue();for(let e=11;e>=0;--e)0!=(s&1<<e)&&i.set(l),l++;for(let t=1;t<e.length;++t){let n=e[t],r=n.getLeftChar().getValue();for(let e=11;e>=0;--e)0!=(r&1<<e)&&i.set(l),l++;if(null!=n.getRightChar()){let e=n.getRightChar().getValue();for(let t=11;t>=0;--t)0!=(e&1<<t)&&i.set(l),l++}}return i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XAttributeCollection=void 0;const r=n(4),i=n(14),l=n(160);class s extends l.XPropertyCollection{ToXML(e){let t=e.createElement("Attributes");return super.ToArray().forEach(n=>{if(null!=n&&null!=n.Key&&null!=n.Value){let r=e.createElement("Name");r.textContent=n.Key;let i=e.createElement("Value");i.textContent=n.Value;let l=e.createElement("Attribute");l.appendChild(r),l.appendChild(i),t.appendChild(l)}}),t}FromXML(e){if(super.Clear(),null==e||!e.hasChildNodes)return;let t=i.XmlDomUtil.GetSingleNode(e,"Attributes");if(null==t)return;let n=t.children;for(let e=0;e<n.length;e++){let t=n[e],l=i.XmlDomUtil.GetSingleNode(t,"Name"),s=null==l?null:l.textContent;if(!r.default.IsNullOrEmpty(s)){l=i.XmlDomUtil.GetSingleNode(t,"Value");let e=null==l?null:l.textContent;r.default.IsNullOrEmpty(e)||super.ModifyProperty(s,e,null)}}}}t.XAttributeCollection=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyValuePair=void 0;const r=n(7);t.KeyValuePair=class{constructor(e,t){this.key=null,this.value=null,this.key=e,this.value=t}get Value(){return this.value}set Value(e){this.value=e}get Key(){return this.key}setKey(e){this.key=e}CopyFrom(e){null!=e&&(this.key=e.key,this.value=e.value)}IsEqual(e){if(null==e)return!1;if(typeof this.Value!=typeof e.Value)return!1;let t=!1;if(this.Value instanceof r.Color){let n=this.Value,r=e.Value;n.IsEqual(r)&&(t=!0)}else t=this.Value===e.Value;let n=this.Key==e.Key;return!(!t||!n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableCellStyle=void 0;const r=n(211),i=n(10),l=n(7);class s extends r.XVirtualManualCRStyle{GetLineSpacingDPI(e){let t=1.3*super.Font.SizeInPoints;return i.DPITransUtil.TransFloatVal(t,72,300)}get BackgroundColor(){let e=this._BackgroundColor1||this.propList.GetColorValue("BackgroundColor",null);return this._BackgroundColor1||(e=l.Color.Transparent),e}set BackgroundColor(e){this._BackgroundColor1=e,this.propList.SetColorValue("BackgroundColor",e,null)}}t.XTextTableCellStyle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextLabelElementStyle=void 0;const r=n(211);class i extends r.XVirtualManualCRStyle{constructor(){super()}}t.XTextLabelElementStyle=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlNodeType=void 0,function(e){e[e.Element=1]="Element",e[e.Attribute=2]="Attribute",e[e.Text=3]="Text",e[e.CDATASection=4]="CDATASection",e[e.EntityReference=5]="EntityReference",e[e.Entity=6]="Entity",e[e.ProcessingInstrucion=7]="ProcessingInstrucion",e[e.Comment=8]="Comment",e[e.Document=9]="Document",e[e.DocumentType=10]="DocumentType",e[e.DocumentFragment=11]="DocumentFragment",e[e.Notation=12]="Notation"}(t.XmlNodeType||(t.XmlNodeType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseContainer=void 0;const r=n(10),i=n(577),l=n(3),s=n(25),o=n(14),a=n(0),u=n(214),h=n(73),d=n(63),c=n(17),p=n(21),f=n(32),g=n(26),m=n(36);class E extends a.XBaseElement{constructor(){super(),this.linesWrapSize=s.SizeF.Empty,this.childEleList=null,this.lineList=null,this.childEleList=new l.List,this.lineList=new l.List}get ChildEleList(){return this.childEleList}get ChildCount(){return null!=this.childEleList?this.childEleList.Count():0}GetChildIter(){let e=this.childEleList.GetEnumerator();return e.Reset(),e}get LinesCnt(){return null!=this.lineList?this.lineList.Count():0}get LinesList(){return this.lineList}get OwnerDocPanel(){return super.OwnerDocPanel}set OwnerDocPanel(e){super.OwnerDocPanel=e;for(let t of this.childEleList)t.OwnerDocPanel=e}GetLinesIter(){let e=this.lineList.GetEnumerator();return e.Reset(),e}ClearChildren(e=!0){if(e)for(let e of this.childEleList)e.Clear();this.childEleList.Clear(),this.ClearLines(!0,!1)}ClearLines(e,t){if(this.lineList.Count()>0&&e){for(let e of this.lineList){if(t&&e.HasCtEle){let n=e.ChildEleList;for(let e of n)e instanceof E&&e.ClearLines(!0,t)}e.Clear()}this.lineList.Clear(),this.linesWrapSize=s.SizeF.Empty,this.NotifyLayoutChanged(!1,!1)}}GetChildrenByCptId(e,t,n,r=!1){for(let i of this.childEleList){let l=i instanceof E?i:null;if(null!=l){const e=!r&&l.IsHidden();if(!a.XDomUtil.HasValidChild(l)||e)continue}e==i.CptID&&n.Add(i),t&&null!=l&&l.GetChildrenByCptId(e,!0,n,r)}}GetChildrenByXID(e,t,n,r=!1){for(let i of this.childEleList){let l=i instanceof E?i:null;if(null!=l){const e=!r&&l.IsHidden();if(!a.XDomUtil.HasValidChild(l)||e)continue}e==i.XID&&n.Add(i),t&&null!=l&&l.GetChildrenByXID(e,!0,n,r)}}GetChildrenWithRelateId(e,t,n){let r=!1,i=!1;for(let l of this.childEleList){if(r&&(t.Add(l),l.UndoRelateId==n)){i=!0;break}l.UndoRelateId==n&&(t.Add(l),r=!0,e=!1),e&&null!=l&&l instanceof E&&l.GetChildrenWithRelateId(!0,t,n)}if(r&&!i&&t.Length>0){let e=t.Get(0);t.Clear(),t.Add(e)}}GetChildrenWithBussId(e,t,n=!1){for(let r of this.childEleList){let i=r instanceof E?r:null;if(null!=i){const e=!n&&i.IsHidden();if(!a.XDomUtil.HasValidChild(i)||e)continue}r.bussId&&t.Add(r),e&&null!=i&&i.GetChildrenWithBussId(!0,t,n)}}GetChildrenNotValidate(e){let t=new l.List,n={};this.GetChildrenByTypes(["XInputField","XTextCheckBox","XTextRadioBox"],!0,t);for(let r of t)if(null!=r)if(r instanceof a.XInputEle){r.StartValueValidate(!0)||e.Add(r)}else if(r instanceof a.XBaseChoiceEle){r.StartValueValidate(!0,null)||(n[r.GrpID]||(n[r.GrpID]=[]),n[r.GrpID].push({docId:r.Document.DocID,cptId:r.CptID,msg:r.ToolTip,title:r.Name}))}for(let t in n){let r={};r={grpId:t,Name:n[t].title,ToolTip:"按钮组为必选"},e.Add(r)}}GetLastChildByTitleId(e){let t=new l.List;i.XContainerLinesCalc._RecurGetChildrenNotLined(!1,this,t);let n,r=t.ToArray(),s=!1;for(let t=0;t<r.length;t++){let i=r[t];if(i instanceof f.XTextLabelElement){if(s&&Number(n)>=Number(i.TitleLevel))return r[t-1];i.CptID==e&&(s=!0,n=i.TitleLevel)}}return s?r[r.length-1]:null}GetStringChildrenByTitleId(e,t,n){let r,s=new l.List,o=new l.List,u=!1,h=new l.List;i.XContainerLinesCalc._RecurGetChildrenNotLined(!1,this,h);let d=h.ToArray();for(let t=0;t<d.length;t++){let i=d[t];i instanceof f.XTextLabelElement&&(u&&r==i.TitleLevel&&(o.Add(d[t]),s.Add(o),u=!1),e==i.CptID&&(u=!0,o.Clear(),o.Add(d[t+1]),r=i.TitleLevel),n.Add(i)),null!=i&&i instanceof E&&(!a.XDomUtil.HasValidChild(i)||i.IsHidden())||e==i.CptID&&n.Add(i)}return 1==o.Length&&u&&(o.Add(d[d.length-1]),s.Add(o)),s}GetChildrenByTitleId(e,t,n,r=!0){let s,o=new l.List,u=new l.List,h=!1,d=new l.List;i.XContainerLinesCalc._RecurGetChildrenNotLined(!1,this,d);let c=d.ToArray();for(let t=0;t<c.length;t++){let i=c[t];i instanceof f.XTextLabelElement&&(h&&s==i.TitleLevel&&(u.Add(c[t]),o.Add(u),h=!1),e==i.CptID&&(h=!0,u.Clear(),c[t+1]instanceof a.XButtonEle&&!r?u.Add(c[t+2]):u.Add(c[t+1]),s=i.TitleLevel),n.Add(i)),null!=i&&i instanceof E&&(!a.XDomUtil.HasValidChild(i)||i.IsHidden())||e==i.CptID&&n.Add(i)}return 1==u.Length&&h&&(u.Add(c[c.length-1]),o.Add(u)),o}GetChildrenByGrpID(e,t,n,r=!1){for(let i of this.childEleList){let l=i instanceof E?i:null;if(null!=l){const e=!r&&l.IsHidden();if(!a.XDomUtil.HasValidChild(l)||e)continue}e==i.GrpID&&n.Add(i),t&&null!=l&&l.GetChildrenByGrpID(e,!0,n,r)}}GetAllChildren(e){const t=this.childEleList.GetEnumerator();for(;t.MoveNext();){const n=t.Current;null!=n&&n instanceof E&&(!a.XDomUtil.HasValidChild(n)||n.IsHidden())||e.Add(n)}}GetAllBaseChildren(e,t=!0){const n=this.childEleList.GetEnumerator();for(;n.MoveNext();){const r=n.Current;if(null!=r&&r instanceof E){if(!a.XDomUtil.HasValidChild(r))continue;if(!t&&r.IsHidden())continue;r.GetAllBaseChildren(e,t)}else!t&&r.IsHidden()||e.Add(r)}}GetChildrenByType(e,t,n,r=!1,i=!1){const l=this.childEleList.GetEnumerator();for(;l.MoveNext()&&!(i&&n.Count()>0);){const i=l.Current,s=i instanceof E?i:null;if(null!=s){const e=a.XDomUtil.HasValidChild(s),t=s.IsHidden();if(!e||!r&&t)continue}e==i.EleTypeName&&n.Add(i),t&&null!=s&&s.GetChildrenByType(e,!0,n)}}GetChildrenByTypes(e,t,n,r=!1){for(let i=0;i<this.childEleList.Count();i++){let l=this.childEleList.Get(i),s=l instanceof E?l:null;if(null!=s){const e=!r&&s.IsHidden();if(!a.XDomUtil.HasValidChild(s)||e)continue}null!=e&&e.Contains(l.EleTypeName)&&n.Add(l),t&&null!=s&&s.GetChildrenByTypes(e,!0,n,r)}}GetChildrenCanBeInline(e,t,n=!1){for(let r of this.childEleList)null!=r&&(r instanceof E?!t&&r.CanBeInline(!1)?e.Add(r):a.XDomUtil.IsBkgTextOfXInput(r)&&!n||r.GetChildrenCanBeInline(e,t):r.CanBeInline(!1)&&e.Add(r))}GetBaseChildCount(){let e=0;for(let t of this.childEleList)null!=t&&t instanceof E&&(e+=t.GetBaseChildCount());return e}AddChildEle(e,t){if(null==t)return-1;t.IsRemoved=!1,t.Parent=this,t.Parent.IsRemoved=!1,t.OwnerDocPanel=this.OwnerDocPanel,e<0&&(e=0);let n=this.ChildCount;return e>=n?(e=n,this.childEleList.Add(t)):this.childEleList.Insert(e,t),t.NotifyLayoutChanged(!0,!1),e}AddChildrenEle(e,t){let n;if(null==t||0==t.length)return n=-1,n;e<0&&(e=0);let r=this.ChildCount;return e>=r?(e=r,this.childEleList.AddRange(t)):this.childEleList.InsertRange(e,t),t.forEach(e=>{e.Parent=this,e.IsRemoved=!1,e.OwnerDocPanel=this.OwnerDocPanel}),this.IsLayoutValid=!1,n=e,n}GetChildEle(e){let t;return t=e<0||e>=this.childEleList.Count()?null:this.childEleList.Get(e),t}GetLastChildEle(){let e=this.ChildCount;return e<=0?null:this.childEleList.Get(e-1)}GetFirstChildBaseEle(e=!0){if(this.ChildCount<=0)return null;let t=null;for(let n of this.childEleList){let r;if(n instanceof E&&(r=n),null==r||a.XDomUtil.GetCtntChildCnt(r,e)>0){const r=a.XDomUtil.FullDelTrace(n);if(e||!r){t=n;break}}}if(t instanceof E){t=t.GetFirstChildBaseEle(e)}return t}GetChildBaseEle(e,t){let n=this.ChildCount,r=null;for(;e>-1&&e<n;){r=this.GetChildEle(e);const n=a.XDomUtil.HasDelTrace(r);if(r.IsHidden())e++;else if(t&&n)e++;else{let n;if(r instanceof E&&(n=r),null==n)break;if(r=n.GetFirstChildBaseEle(!t),null!=r)break;e++}}return e>=n&&(r=null),r}GetChildInx(e){let t;if(null==e||e==this)t=-1;else{t=this.childEleList.IndexOf(e)}return t}RemoveChildByEle(e){let t;if(null==e||e==this)t=-1;else{let n=this.childEleList.IndexOf(e);if(n<0)t=-1;else{this.RemoveChild(n).IsRemoved=!0,this.IsLayoutValid=!1,t=n}}return t}RemoveChild(e){if(e instanceof a.XBaseElement){if(null==e||e==this)return-1;let t=this.childEleList.IndexOf(e);return t<0?-1:(this.RemoveChild(t).IsRemoved=!0,this.IsLayoutValid=!1,t)}{if(e<0||e>=this.ChildCount)return null;let t=this.childEleList.Get(e);return this.childEleList.RemoveAt(e),t.IsRemoved=!0,this.IsLayoutValid=!1,t}}RemoveChildrenWithRange(e,t){let n;if(e<0||t<=0||e+t>this.ChildCount)return n=null,null;let r=this.childEleList.GetRange(e,t);this.childEleList.RemoveRange(e,t);for(let e of r)e.IsRemoved=!0;this.IsLayoutValid=!1;let i=r.ToArray();return r.Clear(),n=i,n}RemoveChildWithEle(e){let t;if(null==e||e==this)return t=-1,t;let n=this.childEleList.IndexOf(e);return n<0?(t=-1,t):(this.RemoveChild(n).IsRemoved=!0,this.IsLayoutValid=!1,t=n,t)}BatRemoveChildren(e){if(null==e||0==e.length)return null;let t=new l.List;for(let n=e[e.length-1];n>=0;n--){let e=this.RemoveChild(n);this.IsRemoved=!0,t.Add(e)}let n=t.ToArray();return t.Clear(),n}MergeChildrenFrom(e,t){if(null==e||this==e)return!1;if(typeof this!=typeof e)return!1;if(this.childEleList.AddRange(e.childEleList),!t)return!0;for(let t of e.childEleList)t.Parent=this,t.OwnerDocPanel=this.OwnerDocPanel;return e.ClearChildren(!1),e.IsLayoutValid=!1,this.IsLayoutValid=!1,!0}GetInnerText(e,t=!0,n=!1){let r;if(0==this.childEleList.Count())r="";else{let i=new p.default;for(let r of this.childEleList)if(null!=r&&(e||r.EleStyle.DeleterIndex<0)){if(r.IsHidden()&&!t)continue;if(r instanceof a.XInputEle){const n=r.GetInnerText(e,t);i.append(n)}else if(r instanceof a.XBaseChoiceEle)i.append(r.GetInnerText(e,n));else{const t=r.GetInnerText(e);i.append(t)}}let l=i.toString();i.setLengthToZero(),r=l}return r}GetInnerTextWithAll(e,t=!0,n=!1){let r;if(0==this.childEleList.Count())r="";else{let i=new p.default;for(let r of this.childEleList)if(null!=r&&(e||r.EleStyle.DeleterIndex<0)){if(r.IsHidden()&&!t)continue;r instanceof a.XInputEle?i.append(r.GetInnerTextWithAll(e,t)):r instanceof a.XBaseChoiceEle?i.append(r.GetInnerText(e,n)):i.append(r.GetInnerText(e))}let l=i.toString();i.setLengthToZero(),r=l}return r}GetFirstLine(){return this.LinesCnt<=0?null:this.lineList.Get(0)}GetEndLine(){let e=this.LinesCnt;return e<=0?null:this.lineList.Get(e-1)}GetLineByLineIx(e){let t=this.LinesCnt;if(t<=0)return null;let n=this.lineList.Get(0),r=this.lineList.Get(t-1);return e<n.Index||e>r.Index?null:this.lineList.Find(t=>t.Index==e)}GetLinesArray(){return null==this.lineList?[]:this.lineList.ToArray()}AddToLinesList(e){null!=e&&(this.lineList.Count()>0&&(this.lineList.Get(0).IsDocFirstLine=!0),e.AddRange(this.lineList))}GetChildArr(){return this.childEleList.ToArray()}GetSubLines(e,t){let n;if(e+t>this.LinesCnt&&(t=this.LinesCnt-e),e<0||t<=0)return n=null,n;let r=this.lineList.GetRange(e,t),i=r.ToArray();return r.Clear(),n=i,n}AddLine(e){null!=e&&(e.Container=this,this.lineList.Add(e))}AddLineToIndex(e,t){if(null!=e){e.Container=this,this.lineList.Insert(t,e);let n=null,r=null;const i=this.lineList.Count();t>0&&t<i&&(n=this.lineList.Get(t-1),n.NextLine=e),t+1<i&&t>=0&&(r=this.lineList.Get(t+1),r.PrevLine=e),e.PrevLine=n,e.NextLine=r}}RefreshLines(e){if(e||!this.IsLayoutValid){this.ClearLines(!0,!1),this._Before_BuildLines_();for(let t of this.childEleList)t instanceof E&&(t.IsHidden(!0)||t.RefreshLines(e));i.XContainerLinesCalc.CalcContentLines(this,null,e),this._After_BuildLines_(),this.IsLayoutValid=!0}}RefreshLinesWithLineRange(e,t,n){if(n||!this.IsLayoutValid){this._Before_BuildLines_();for(let r=e;r<=t;r++)for(let e of this.GetLineByLineIx(r).ChildEleList)null!=e&&e instanceof E&&(e.IsHidden(!0)||e.RefreshLines(n));i.XContainerLinesCalc.CalcContentLinesWithLineRange(e,t,this,null,n),this._After_BuildLines_(),this.IsLayoutValid=!0}}RefreshLinesBetweenEle(e,t,n){if(n||!this.IsLayoutValid){if(this._Before_BuildLines_(),null!=e&&null!=t){let[r,l]=[-1,-1];if(null!=e){let t=e;for(;t.Parent!=this;)t=t.Parent;r=this.childEleList.IndexOf(t)}if(null!=t){let e=t;for(;e.Parent!=this;)e=e.Parent;l=this.childEleList.IndexOf(e)}r=Math.max(0,r),l=Math.min(this.childEleList.Count(),l);for(let e=r;e<=l&&e<=this.childEleList.Count();e++){let t=this.childEleList.Get(e);null!=t&&t instanceof E&&(t.IsHidden(!0)||t.RefreshLines(n))}i.XContainerLinesCalc.CalcContentLinesBetweenEles(e,t,this,null,n)}this._After_BuildLines_(),this.IsLayoutValid=!0}}GetColumnsParam(){return null}GetLinesHeight(e,t,n){let i=this.linesWrapSize.Height,l=super.EleStyle.ElePadd;return e&&(i+=l.Top),t&&(i+=l.Bottom),r.DPITransUtil.TransFloatVal(i,300,n)}getMaxLineHeight(e=300){if(!(this.LinesCnt>0))return null;let t=0;const n=this.lineList.ToArray();for(let r=0;r<n.length;r++){const i=n[r];let l=!1;if(i.ElementCnt>0){const n=i.ChildEleList.ToArray();for(let r=0;r<n.length;r++){const i=n[r];if(i instanceof E){const n=i.getMaxLineHeight(e);n>t&&(t=n),null!==n&&(l=!0)}}}if(!l){const n=i.LineAssist.GetLineFullHeight(e,!0);n>t&&(t=n)}}return Math.ceil(t)}GetValidWidth(e){let t=this.EleStyle.ElePadd,n=this.Width-t.Left-t.Right;return r.DPITransUtil.TransFloatVal(n,300,e)}GetValidHeight(e){let t=this.EleStyle.ElePadd,n=this.Height-t.Top-t.Bottom;return r.DPITransUtil.TransFloatVal(n,300,e)}ReCalcBaseSize(){for(let e of this.childEleList)null!=e&&e.ReCalcBaseSize()}CalcSizeByLines(){if(!this.IsLayoutValid&&this.CanBeInline(!1)){this._Calc_LinesWrapSize();let e=super.EleStyle.ElePadd;this.SetSizeDPI(this.linesWrapSize.Width+e.Left+e.Right,this.linesWrapSize.Height+e.Top+e.Bottom,300),this.IsLayoutValid=!0}}_Calc_LinesWrapSize(){this.linesWrapSize.Width=this.linesWrapSize.Height=0;let e=0,t=0,n=0,r=0;for(let e of this.lineList){let t=e.Bounds,i=e.LineAssist.GetLineFullHeight(300,!0),l=e.ChildEleList.Count()>0?e.ChildEleList.Get(e.ChildEleList.Count()-1):null;i+=null!=(null!=l&&l instanceof a.XParagraphFlag?e.RelEleParagraphStyle:null)?e.RelEleParagraphStyle.BottomMargin:0,t.Width>n&&(n=t.Width),r+=i}e+=n,r>t&&(t=r),this.linesWrapSize.Width=e,this.linesWrapSize.Height=t}_Before_BuildLines_(){}_After_BuildLines_(){}Clear(){super.Clear(),this.ClearChildren(!0)}FromXML(e,t=!0){super.FromXML(e),t&&this.ClearChildren(!0);let n=null==this.Document||this.Document.IsCleanLoad,r=o.XmlDomUtil.GetSingleNode(e,"XElements");if(null==r)return;let i,l=r.children;if(null==l||0==l.length)return;let s=!1;for(let e=0;e<l.length;e++){let t=l[e];if("Element"!=t.nodeName)continue;let r=o.XmlDomUtil.GetSingleAttrValue(t,"xsi:type");if("XTextSubDocument"==r&&this.FromXML(t,!1),"XLineBreak"==r){r="XParagraphFlag";const n=this.DUCHANG_XLineBreak_to_XParagraphFlag(l,e);null!=n&&t.setAttribute("StyleIndex",n)}let u=a.XElementFactory.CreatXElement(r,t);if(null!=u){if(u.OwnerDocPanel=this.OwnerDocPanel,u.FromXML(t),u instanceof f.XTextLabelElement&&(s=!(m.StringUtils.IsNullOrEmpty(u.Gender)&&!u.MaxAge&&!u.MinAge)),s){if(u instanceof f.XTextLabelElement)i=a.XDomUtil.IsHideByPatient(g.TextDocInitInfo.GetInstance().PatientInfo,u.Gender,u.MaxAge,u.MinAge),i?null==u.SelfHide&&(u.SelfHide=u.Attr_FgHide):null!=u.SelfHide&&(u.Attr_FgHide=u.SelfHide),u.Attr_FgHide=u.Attr_FgHide||i;else if(u instanceof a.XImageEle||u instanceof a.XMedicalExpressionField||u instanceof a.XBaseInputEle||u instanceof a.XBaseChoiceEle){let e=a.XDomUtil.IsHideByPatient(g.TextDocInitInfo.GetInstance().PatientInfo,u.Gender,u.MaxAge,u.MinAge),t=i||e,n=u.Attr_FgHide;t?null==u.SelfHide?u.SelfHide=u.Attr_FgHide:n=u.SelfHide:null!=u.SelfHide&&(u.Attr_FgHide=u.SelfHide,n=u.SelfHide),u.Attr_FgHide=n||t}null!=i&&i?u instanceof f.XTextLabelElement||u instanceof a.XImageEle||u instanceof a.XMedicalExpressionField||u instanceof a.XBaseInputEle||u instanceof a.XBaseChoiceEle||(null==u.SelfHide?(u.SelfHide=u.Attr_FgHide,u.Attr_FgHide=!0):u.Attr_FgHide=!0):u instanceof f.XTextLabelElement||null==u.SelfHide||u instanceof a.XImageEle||u instanceof a.XMedicalExpressionField||u instanceof a.XBaseInputEle||u instanceof a.XBaseChoiceEle||null!=u.SelfHide&&(u.Attr_FgHide=u.SelfHide,u.SelfHide=null)}else if(u instanceof a.XImageEle||u instanceof a.XMedicalExpressionField||u instanceof a.XBaseInputEle||u instanceof a.XBaseChoiceEle){let e=a.XDomUtil.IsHideByPatient(g.TextDocInitInfo.GetInstance().PatientInfo,u.Gender,u.MaxAge,u.MinAge),t=u.Attr_FgHide;u.Attr_FgHide=t||e}if(n){if(u.EleStyle.DeleterIndex>=0)continue;u.EleStyle.CreatorIndex=-1}this.AddChildEle(2147483647,u),this._FromXML_AfterChildAdded(u)}}let u=o.XmlDomUtil.GetSingleNode(e,"XElementItems");if(null==u)return;let h=u.children;if(null!=h&&0!=h.length)for(let e=0;e<h.length;e++){let t=h[e];if("Element"!=t.nodeName)continue;let n=o.XmlDomUtil.GetSingleAttrValue(t,"xsi:type"),r=a.XElementFactory.CreatXElement(n,t);if(null!=r&&(r.OwnerDocPanel=this.OwnerDocPanel,r.FromXML(t),this instanceof a.XCommentEle)){this.ItemList.Add(r)}}}DUCHANG_XLineBreak_to_XParagraphFlag(e,t){for(let n=t+1;n<e.length;n++){const t=e[n];if("Element"!=t.nodeName)continue;if("XParagraphFlag"==o.XmlDomUtil.GetSingleAttrValue(t,"xsi:type")){return o.XmlDomUtil.GetSingleAttrValue(t,"StyleIndex")}}return null}_FromXML_AfterChildAdded(e){if(null!=e&&e instanceof a.XParagraphFlag){let t=-1,n=null,r=e.AutoAddDelSernoLabel(n,t);n=r[1],t=r[2],e.Serno=t,e.NotifyLayoutChanged()}}NotifyLayoutChanged(e=!0,t=!1){if(super.NotifyLayoutChanged(e,!1),t)for(let e of this.childEleList)e.NotifyLayoutChanged(!1,!0)}ToXML(e){let t=super.ToXML(e);if(null==t)return null;let n=e.createElement("XElements");if(t.appendChild(n),this.ChildCount<=0)return t;let r=this.GetChildIter(),i=r.MoveNext(),l=new u.BooleanWrapper(i);for(;l.Value;){let t=this._ToXML_ChildElePreHandler_(r,l);if(null==t)continue;let i=t.ToXMLs(e);if(null!=i)for(let e=0;e<i.length;e++)null!=i[e]&&n.appendChild(i[e]);else{let r=t.ToXML(e);null!=r&&n.appendChild(r)}}if(this instanceof a.XCommentEle){let n=e.createElement("XElementItems");if(t.appendChild(n),null!=this.ItemList&&this.ItemList.Length>0)for(let t of this.ItemList){let r=t,i=r.ToXMLs(e);if(null!=i)for(let e=0;e<i.length;e++)null!=i[e]&&n.appendChild(i[e]);else{let t=r.ToXML(e);null!=t&&n.appendChild(t)}}}return t}_ToXML_ChildElePreHandler_(e,t){let n=e.Current,r=n;if(n instanceof a.XStringEle)if(this._IsChildBkgXStrEle(n))r=null,t.Value=e.MoveNext();else{r=this._MergeStringEle_Consequent(e,t)}else t.Value=e.MoveNext();return r}_IsChildBkgXStrEle(e){let t;return!(null==e||null==e.Parent||!e.IsXInputBkgText)&&("XInputField"==this.EleTypeName&&(t=e.Parent.XID==this.XID,t))}_MergeStringEle_Consequent(e,t){let n=0,r=new a.XStringEle,i=e.Current;r.OwnerDocPanel=i.OwnerDocPanel;do{let t=e.Current;if(null==t||!(t instanceof a.XStringEle))break;let i=e.Current;if(i.IsXInputBkgText)break;r.MergeChildrenFrom(i,!1),n++}while(t.Value=e.MoveNext());return n<=0?null:r}RemoveChildren(e,t){if(e<0||t<=0||e+t>this.ChildCount)return null;let n=this.childEleList.GetRange(e,t);this.childEleList.RemoveRange(e,t);for(let e of n)e.IsRemoved=!0;this.IsLayoutValid=!1;let r=n.ToArray();return n.Clear(),r}GetChildren(e,t){return e<0||t<=0||e+t>this.ChildCount?null:this.childEleList.GetRange(e,t).ToArray()}GetLineAtPosY(e,t,n){let r,i=this.Bounds;if(i.Width<=0||i.Height<=0)return null;if(n>0&&300!=n){let r=300/n;e*=r,t*=r}let l,s=this.GetColumnsParam();if(l=null==s||s.ColsCnt<=1?i.Y<t&&t<i.Bottom:i.Contains(e,t),l){e-=i.X,t-=i.Y;let n=null;for(let e=0;e<this.lineList.Length;e++){let r=this.lineList[e];if(r.IsLineAtPosY(t,-1)){n=r;break}}r=n}else r=null;return r}GetEleAtPos(e,t,n,r,i){if(this.lineList.Length<1)return void super.GetEleAtPos(e,t,n,r,i);let l=this.Bounds;if(l.Width>0&&l.Height>0){if(n>0&&300!=n){let r=300/n;e*=r,t*=r}if(l.Contains(e,t)){if(e-=l.X,t-=l.Y,this instanceof a.XTextTableCell){if(h.ResizeAnchorUtil.Hit_Cell(this,new c.PointF(e,t),300)!=d.ORIENTATION.NONE)return}let n=super.EleStyle.ElePadd;e<n.Left?e=n.Left+1:e>l.Right-n.Right&&(e=l.Right-n.Right-1),t<n.Top?t=n.Top+1:t>l.Bottom-n.Bottom&&(t=l.Bottom-n.Bottom-1);let s=this.GetFirstLine();if(null!=s&&(this instanceof a.XPagePanelView||this instanceof a.XTextTableCell)){let e=s.Y,n=e+this.GetLinesHeight(!1,!1,300);t<=e?t=e+2:t>=n&&(t=n<2?1:n-2)}if(this instanceof a.XTextTable){t+=this.OwnerLine.RelEleParagraphStyle.SpacingBefore}for(let n of this.lineList)if(n.LineAssist.GetEleAtPos(e,t,-1,r,i),r.IsValid()||null!=r.MarkEleClicked)break;r.IsValid()||null!=r.MarkEleClicked||r.LineEleIxFocused.SetEle(this)}}}CopyFromSelRange(e,t,n,r,i){this.childEleList.Clear();let l,s=null==e?0:e.length;if(s<=0||t>=s)l=0;else if(this.CanBeInline(!1))this.CopyFrom(e[t],!0,n,r),l=1;else{let i=e[t].Parent,o=i.Parent;this.CopyFrom(i,!1,!1,!0);let u=0,h=0,d=!1;for(let l=t;l<s;l++){let t,s=e[l],c=s.Parent,p=s instanceof a.XInputBorderEle?s:null;if(c!=i){if(c.Parent!=i){if(c==o&&null!=p){!0;break}break}t=a.XElementFactory.CreatXElement(c.EleTypeName,null)}else t=a.XElementFactory.CreatXElement(s.EleTypeName,null);let f=t.CopyFromSelRange(e,l,n,r,d);if(f<=0)break;u+=f,this.AddChildEle(h++,t),l+=f-1}l=u}return l}_GetLastBaseEle(e=!0,t=!0){if(this.ChildCount<=0)return null;let n=null;for(let r=this.childEleList.Length-1;r>=0;r--){let i,l=this.childEleList.Get(r);if((!(l instanceof a.XParagraphFlag)||t)&&(l instanceof E&&(i=l),(null==i||a.XDomUtil.GetCtntChildCnt(i,e)>0)&&(e||!a.XDomUtil.FullDelTrace(l)))){n=l;break}}if(n instanceof E){n=n._GetLastBaseEle(e)}return n}getAllEleWidthCptId(e=!0,t=!0,n=!1){let r=[];if(this.ChildCount>0)for(let i=0;i<this.ChildCount;i++){const l=this.childEleList.Get(i),s=t||!l.IsHidden(),o=n||!a.XDomUtil.HasDelTrace(l);if(l.CptID&&s&&o&&r.push(l.CptID),e&&s&&o&&l instanceof E){const e=l.getAllEleWidthCptId(!0);r=[...r,...e]}}return r}setUnderLine(e){if(this.ChildCount>0)for(let t=0;t<this.ChildCount;t++){const n=this.ChildEleList.Get(t);if("XLableInputBorder"==n.EleTypeName)continue;const r=n.EleStyle;if(null!=r){const t=r.XFontStyle;null!=t&&(t.IsUnderline=e)}n instanceof E&&n.setUnderLine(e)}}validateAddLastXPaFlag(){const e=this.GetLastChildEle();if(null==e||!(e instanceof a.XParagraphFlag)){const e=this.ChildCount,t=new a.XParagraphFlag;this.AddChildEle(e,t)}}}t.XBaseContainer=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XContainerLinesCalc=void 0;const r=n(3),i=n(212),l=n(0),s=n(105),o=n(35),a=n(213),u=n(2),h=n(40),d=n(11);class c{static CalcContentLinesBetweenEles(e,t,n,i,o){if(null==n)return;if(n.IsHidden(!0))return;if(!n.CanBeInline(!1))return;let u=new r.List,h=new r.List,[d,p]=c._RecurGetChildrenNotLinedBetweenEles(o,n,h,e,t);if(-1==d&&-1==p)return;let f,g=h.Count(),m=0,E=new a.NumberWrapper(0),C=!0,A=0,y=c._FineParagraphForward(h,A);null!=y&&y.EleStyle instanceof s.XParagraphFlagStyle&&(f=y.EleStyle),null!=f&&(m=f.GetLineIndentDPI(C,-1),E.Value+=m);let I=n.GetColumnsParam(),S=null!=I&&I.ColsCnt>1,_=n.GetValidWidth(300),w=S?n.GetValidHeight(300):340282347e30,b=new a.NumberWrapper(S?0:-1),x=S?I.GetColWidth(0,300):_,P=x+(S?I.GetGapWidth(0,300):0),v=S?I.ColsCnt:0,T=x;if(!S&&n instanceof l.XDocPanel){let e=n.Document.GetPageFmt().PagePadd.Right;e*=3,T+=e}c.Line_PosY=0;let M=d;for(;;){if(p>=0&&M>p||p<0&&M==n.LinesCnt){if(n.LinesList.Count()-1<=M)break;n.LinesList.Get(M).ClearArrPalinesInx()}else n.LinesList.Get(M).Clear();M++}const L=p<0?n.LinesCnt-d:p-d+1;if(n.LinesList.RemoveRange(d,L),d>0){let e=n.LinesList.Get(d-1),t=null;n.LinesList.Count()>d&&(t=n.LinesList.Get(d)),e.NextLine=t,null!=t&&(t.PrevLine=e)}let D=n.GetLineByLineIx(d-1),R=new a.NumberWrapper(0),F=h.GetEnumerator(),N=null,B=d-1,k=0;for(;F.MoveNext();){let e=N;if(N=F.Current,N instanceof l.XTextTable&&E.Value<=m&&(E.Value=0),N instanceof l.XSpliteLineEle&&N.M_AutoSuitWidth(),c._CalcEndWord_FromIx_InLine(N,e,R,u.Count()),c._CanAddtoCurLine(N,e,E.Value,m,x,T)||u.Length<1){const e=c._AddLineEle(N,u,E);e>0&&(k=e),A++;continue}B++;let t=null;R.Value>0&&(t=c._Remove_PrevLineEndWord(u,R.Value),R.Value=-1);let r=[],i=u.Get(u.Length-1);i instanceof l.XCharacterEle&&"（"==i.ChVal&&(R.Value=u.Length-1,r=c._Remove_PrevLineEndWord(u,R.Value),r&&r.length>0&&(t&&t.length>0?t.unshift(...r):t=r));let s=c._BuildCtntLineAtIndex(n,u,y,C,B,k);if(k=0,D=s,S&&(c._Handle_NewColumn(b,v,P,w,s),s.SetPositionDPI(b.Value*P,-1,300)),u.Clear(),E.Value=0,C=null!=e&&e instanceof l.XParagraphFlag,A<g&&(y=c._FineParagraphForward(h,A),f=null==y?null:y.EleStyle,null==f||N instanceof l.XTextTable||(m=f.GetLineIndentDPI(C,-1),E.Value+=m)),null!=t){let e=0,n=t.length;for(;e<n;){const n=c._AddLineEle(t[e],u,E);n>0&&(k=n),e++}}const o=c._AddLineEle(N,u,E);o>0&&(k=o),A++}if(B++,u.Count()>0){let e=c._BuildCtntLineAtIndex(n,u,y,C,B,k);k=0,S&&(c._Handle_NewColumn(b,v,P,w,e),e.SetPositionDPI(b.Value*P,-1,300))}n.CalcSizeByLines()}static CalcContentLinesWithLineRange(e,t,n,i,o){if(null==n)return;if(n.IsHidden(!0))return;if(!n.CanBeInline(!1))return;let u=new r.List,h=new r.List;c._RecurGetChildrenNotLinedWithLineRange(o,n,h,e,t);for(let t=0;t<h.Count();t++)if(null!=h.Get(t).OwnerLine){e=h.Get(t).OwnerLineInx;break}for(let e=h.Count()-1;e>-1;e--)if(null!=h.Get(e).OwnerLine){t=h.Get(e).OwnerLineInx;break}let d=h.Count(),p=0,f=new a.NumberWrapper(0),g=!0;if(0!=e){g=n.GetLineByLineIx(e-1).LastElement instanceof l.XParagraphFlag}let m,E=0,C=c._FineParagraphForward(h,E);null!=C&&C.EleStyle instanceof s.XParagraphFlagStyle&&(m=C.EleStyle),null!=m&&(p=m.GetLineIndentDPI(g,-1),f.Value+=p);let A=n.GetColumnsParam(),y=null!=A&&A.ColsCnt>1,I=n.GetValidWidth(300),S=y?n.GetValidHeight(300):340282347e30,_=new a.NumberWrapper(y?0:-1),w=y?A.GetColWidth(0,300):I,b=w+(y?A.GetGapWidth(0,300):0),x=y?A.ColsCnt:0,P=w;if(!y&&n instanceof l.XDocPanel){let e=n.Document.GetPageFmt().PagePadd.Right;e*=3,P+=e}c.Line_PosY=0;n.GetLineByLineIx(e-1),n.GetLineByLineIx(t+1);for(let r=e;r<=t;r++)n.LinesList.Get(r).Clear();n.LinesList.RemoveRange(e,t-e+1);let v=n.GetLineByLineIx(e-1),T=new a.NumberWrapper(0),M=h.GetEnumerator(),L=null,D=e-1,R=0;for(;M.MoveNext();){let e=L;if(L=M.Current,L instanceof l.XTextTable&&f.Value<=p&&(f.Value=0),L instanceof l.XSpliteLineEle&&L.M_AutoSuitWidth(),c._CalcEndWord_FromIx_InLine(L,e,T,u.Count()),c._CanAddtoCurLine(L,e,f.Value,p,w,P)){const e=c._AddLineEle(L,u,f);e>0&&(R=e),E++;continue}D++;let t=null;T.Value>0&&(t=c._Remove_PrevLineEndWord(u,T.Value),T.Value=-1);let r=c._BuildCtntLineAtIndex(n,u,C,g,D,R);if(R=0,null!=v&&v.SetNewNext(r),v=r,y&&(c._Handle_NewColumn(_,x,b,S,r),r.SetPositionDPI(_.Value*b,-1,300)),u.Clear(),f.Value=0,g=null!=e&&e instanceof l.XParagraphFlag,E<d&&(C=c._FineParagraphForward(h,E),m=null==C?null:C.EleStyle,null==m||L instanceof l.XTextTable||(p=m.GetLineIndentDPI(g,-1),f.Value+=p)),null!=t){let e=0,n=t.length;for(;e<n;){const n=c._AddLineEle(t[e],u,f);n>0&&(R=n),e++}}const i=c._AddLineEle(L,u,f);i>0&&(R=i),E++}if(D++,u.Count()>0){let e=c._BuildCtntLineAtIndex(n,u,C,g,D,R);R=0,null!=v&&(v.SetNewNext(e),T.Value=-1),y&&(c._Handle_NewColumn(_,x,b,S,e),e.SetPositionDPI(_.Value*b,-1,300))}n.CalcSizeByLines()}static CalcContentLines(e,t,n){if(null==e)return;if(e.IsHidden(!0))return;if(!e.CanBeInline(!1))return;let i=new r.List,o=new r.List;c._RecurGetChildrenNotLined(n,e,o);let u,h=o.Count(),d=0,p=new a.NumberWrapper(0),f=!0,g=0,m=c._FineParagraphForward(o,g);null!=m&&m.EleStyle instanceof s.XParagraphFlagStyle&&(u=m.EleStyle),null!=u&&(d=u.GetLineIndentDPI(f,-1),p.Value+=d);let E=e.GetColumnsParam(),C=null!=E&&E.ColsCnt>1,A=e.GetValidWidth(300),y=C?e.GetValidHeight(300):340282347e30,I=new a.NumberWrapper(C?0:-1),S=C?E.GetColWidth(0,300):A,_=S+(C?E.GetGapWidth(0,300):0),w=C?E.ColsCnt:0,b=S;if(!C&&e instanceof l.XDocPanel){let t=e.Document.GetPageFmt().PagePadd.Right;t*=3,b+=t}c.Line_PosY=0;let x=null,P=new a.NumberWrapper(0),v=o.GetEnumerator(),T=null,M=0;for(;v.MoveNext();){let t=T;if(T=v.Current,T instanceof l.XTextTable&&p.Value<=d&&(p.Value=0),T instanceof l.XSpliteLineEle&&T.M_AutoSuitWidth(),c._CalcEndWord_FromIx_InLine(T,t,P,i.Count()),c._CanAddtoCurLine(T,t,p.Value,d,S,b)){const e=c._AddLineEle(T,i,p);e>0&&(M=e),g++;continue}let n=null;P.Value>0&&(n=c._Remove_PrevLineEndWord(i,P.Value),P.Value=-1);let r=c._BuildCtntLine(e,i,m,f,M);if(M=0,null!=x&&x.SetNewNext(r),x=r,C&&(c._Handle_NewColumn(I,w,_,y,r),r.SetPositionDPI(I.Value*_,-1,300)),i.Clear(),p.Value=0,f=null!=t&&t instanceof l.XParagraphFlag,g<h&&(m=c._FineParagraphForward(o,g),u=null==m?null:m.EleStyle instanceof s.XParagraphFlagStyle?m.EleStyle:null,null==u||T instanceof l.XTextTable||(d=u.GetLineIndentDPI(f,-1),p.Value+=d)),null!=n){let e=0,t=n.length;for(;e<t;){const t=c._AddLineEle(n[e],i,p);t>0&&(M=t),e++}}const a=c._AddLineEle(T,i,p,m,S);a>0&&(M=a),g++}if(i.Count()>0){let t=c._BuildCtntLine(e,i,m,f,M);M=0,null!=x&&(x.SetNewNext(t),P.Value=-1),C&&(c._Handle_NewColumn(I,w,_,y,t),t.SetPositionDPI(I.Value*_,-1,300))}e.CalcSizeByLines()}static _CalcEndWord_FromIx_InLine(e,t,n,r){let i=c._IsWordSpt_Ele(e),s=c._IsEle_ForceLineEnd(e);if(e instanceof l.XParagraphFlag||t instanceof l.XParagraphFlag)n.Value=-1;else if(t instanceof l.XInputBorderEle&&t.IsStartBorder)n.Value=r-1;else if(i)if(s){let e=c._IsWordSpt_Ele(t),i=c._IsEle_ForceLineEnd(t);null!=t&&!e||i||(n.Value=r-1,n.Value<0&&(n.Value=0))}else n.Value=-1;else{let e=c._IsWordSpt_Ele(t);(null==t||e)&&(n.Value=r)}}static _CanAddtoCurLine(e,t,n,r,i,s){let o=!0;if(t instanceof l.XParagraphFlag)return!1;if(e instanceof l.XParagraphFlag)return!0;let a,u=null,h=null;if(e instanceof l.XInputBorderEle&&(u=e instanceof l.XInputBorderEle?e:null,h=null==u?null:u.Parent instanceof l.XBaseInputEle?u.Parent:null),e instanceof l.XBaseChoiceEle&&(a=e.ReCalcBaseSizeBeforeAddToLine(i,n),null!=a&&i-n<a&&null!=t))return e.IsLayoutValid=!1,!1;const d=n+e.Width;let p=.5;if(e instanceof l.XTextTableCell){const t=e.Parent.Parent.Columns.Length;t>p&&(p=t)}if(d-s-p>0)o=null==t;else if(null!=t&&(c._IsEle_ForceNewLine(t)||t.IsWholeLineEle()))o=!1,t.IsWholeLineEle()&&(e instanceof l.XParagraphFlag&&e.Height<=t.Height||null!=h&&!u.IsStartBorder&&!h.IsBorderVisible)&&(o=!0);else if(c._IsEle_ForceLineEnd(e))n>i+.5*e.Width&&(o=null==t);else if(null==h||u.IsStartBorder||h.IsBorderVisible)if(e.IsWholeLineEle())o=null==t||n<=r;else if(e instanceof l.XTextTableCell){n+e.Column.Width-i-p>0&&(o=null==t)}else n+e.Width>i+p&&(o=null==t);else o=!0;return o}static _RecurGetChildrenNotLined(e,t,n){let r=!1;for(let i of t.ChildEleList){if(!i.IsHidden(!0)){const t=i.CanBeInline(e);if(r&&i instanceof l.XParagraphFlag){r=!1;continue}if(t){let e=c.CanBeInlineByDeleterIx(i);if(r&&i instanceof l.XParagraphFlag){r=!1;continue}e&&n.Add(i)}else if(i instanceof l.XBaseContainer)if(i instanceof l.XTextTable&&!i.CanBeInline(e))r=!0;else{let t=i;c._RecurGetChildrenNotLined(e,t,n)}}}}static CanBeInlineByDeleterIx(e){let t=!0;if(null!=e){const n=e.Document,r=null!=n?n.GetDocCtxt().EmrWorkMode:null,i=e.EleStyle;if(null!=r&&r!=u.ENumWorkMode.KeepTrace&&null!=i&&-1!=i.DeleterIndex&&(t=!1),null!=i&&-1==i.DeleterIndex&&!(e instanceof l.XBaseContainer)){const n=l.XDomUtil.GetParentXInput(e);if(null!=n){const e=n.StartEle;null!=e&&null!=e.EleStyle&&e.EleStyle.DeleterIndex>-1&&(t=!1)}}}else t=!1;return t}static _RecurGetChildrenNotLinedBetweenEles(e,t,n,r,i){let[s,o]=[r,i],[a,u]=[-1,-1],[h,d]=[-1,-1];if(null!=r){for(;s.Parent!=t;)s=s.Parent;a=t.ChildEleList.IndexOf(s)}if(null!=i){for(;o.Parent!=t;)o=o.Parent;u=t.ChildEleList.IndexOf(o)}if(null==s)s=t.ChildEleList.Get(0),a=0;else{let e=a;for(;e>0;){e--;const n=t.GetChildEle(e),r=n.IsHidden();let i=!1;i=n instanceof l.XStringEle?n.IsDelete():n instanceof l.XInputEle?n.StartEle.EleStyle.DeleterIndex>-1:n.EleStyle.DeleterIndex>-1,r||i||(n instanceof l.XParagraphFlag?e=-1:(s=n,a=e))}h=s.CanBeInline()?s.OwnerPanelLindeIndex:c._curFindLineIx(s,a),h=Math.max(0,h);let n=o instanceof l.XTextTable?o:null;for(e=u;!(o instanceof l.XParagraphFlag)&&e<t.ChildCount;){e++;const r=t.GetChildEle(e);r.IsHidden()||(r instanceof l.XTextTable?n=r:r instanceof l.XParagraphFlag?o=r:n=null)}o instanceof l.XParagraphFlag||(e=t.ChildCount-1,o=t.GetChildEle(e)),u=e,d=null==n?o.OwnerPanelLindeIndex:n.OwnerPanelLindeIndex}a=Math.max(a,0),u=Math.min(u,t.ChildCount);for(let r=a;r<=u;r++){let i=t.ChildEleList.Get(r);if(i.CanBeInline(e)){c.CanBeInlineByDeleterIx(i)&&n.Add(i)}else if(i instanceof l.XBaseContainer){let t=i;c._RecurGetChildrenNotLined(e,t,n)}}return[h,d]}static _curFindLineIx(e,t){let n=null;if(null!=e.ChildEleList&&e.ChildEleList.Count()>0)for(let t=0;t<e.ChildEleList.Count();t++){let r=e.GetChildEle(t);if(r.CanBeInline()){let e=!1;if(r instanceof l.XCharacterEle&&(e=r.EleStyle.DeleterIndex>-1),!e)return r.OwnerPanelLindeIndex}else if(r instanceof l.XBaseContainer&&null!=r.ChildEleList&&r.ChildEleList.Count()>0&&(n=c._curFindLineIx(r,t),n>-1))return n}else n=0==t?0:e.Parent.ChildEleList.Get(t-1).OwnerLineInx+1;return n}static _RecurGetChildrenNotLinedWithLineRange(e,t,n,r,i){let s=t.GetLineByLineIx(r).ChildEleList.Get(0);for(;s.Parent!=t;)s=s.Parent;let o=t.ChildEleList.IndexOf(s),a=t.GetLineByLineIx(i).ChildEleList.Last();for(;a.Parent!=t;)a=a.Parent;let u=t.ChildEleList.IndexOf(a);for(let r=o;r<=u;r++){let i=t.ChildEleList.Get(r);if(i.CanBeInline(e)){c.CanBeInlineByDeleterIx(i)&&n.Add(i)}else if(i instanceof l.XBaseContainer){let t=i;c._RecurGetChildrenNotLined(e,t,n)}}}static _FineParagraphForward(e,t){if(t<0||t>=e.Count())return null;let n=null,r=e.GetItems(),i=r.length;for(let e=t;e<i;e++)if(r[e]instanceof l.XParagraphFlag){n=r[e];break}return n}static _Remove_PrevLineEndWord(e,t){let n=null==e?0:e.Count();if(n<=0||t<0||t>=n)return null;let r=e.GetRange(t,n-t);return e.RemoveRange(t,n-t),r.ToArray()}static _IsWordSpt_Ele(e){if(null==e)return!1;if(!(e instanceof l.XCharacterEle))return!0;let t=e.ChVal;return t<"\0"||t>""||" "==t||"("==t||")"==t||"["==t||"]"==t||"{"==t||"}"==t}static _IsEle_ForceLineEnd(e){if(null==e)return!0;if(e instanceof l.XParagraphFlag)return!0;let t=e instanceof l.XCharacterEle?e:null;return null!=t&&(c._IsXCH_SinglePunctuation(t)||c._IsXCH_EndBrackets(t))}static _IsXCH_SinglePunctuation(e){if(null==e)return!1;let t=e.ChVal;return","==t||"，"==t||"、"==t||"."==t||"。"==t||":"==t||"："==t||";"==t||"；"==t||"?"==t||"？"==t||"!"==t||"！"==t}static _IsEle_ForceNewLine(e){return null!=e&&(e instanceof l.XParagraphFlag||e instanceof l.XPageBreakLabel)}static _IsXCH_EndBrackets(e){if(null==e)return!1;let t=e.ChVal;return")"==t||"）"==t||"]"==t||"】"==t||"}"==t||">"==t||"》"==t||"'"==t||"’"==t||'"'==t||"”"==t}static _AddLineEle(e,t,n,r,i){if(e.IsHidden(!0))return e.OwnerLine=null,0;e.DisReflash=!1,e instanceof l.XBaseChoiceEle&&e.ReCalcBaseSizeBeforeAddToLine(i,n.Value),t.Add(e);let s=0;if(1==t.Count()&&(s=this.getDiagLeft(e,r)),n.Value+=s,e.SetPositionDPI(n.Value,0,300),e instanceof l.XTextTableCell)n.Value+=e.Column.Width;else if(e instanceof l.XCharacterEle&&e.IsTabFlag){let t=o.CommDefines.CalcTabSpaceRealWidth(n.Value);e.SetSizeDPI(t,-1,300),n.Value+=t}else n.Value+=e.Width;return s}static getDiagLeft(e,t){if(null==e)return 0;if(e instanceof l.XInputBorderEle)return 0;if(e.Parent instanceof l.XStringEle&&e.Parent.IsXInputBkgText)return 0;const n=this.hasDiagnosisEleP(e);if(!n[0])return 0;const r=n[1];if("vertical"!=r.Arrangement)return 0;let i,s=0;for(;null==i&&s<r.ChildCount;){const e=r.ChildEleList.Get(s);e instanceof l.XInputBorderEle?s++:i=e}let o=!1;null!=i&&(i.CanBeInline(!1)?o=!0:i instanceof l.XBaseContainer&&(i=i.GetFirstChildBaseEle(),o=!0));let a=0;if(1==o){if(null!=t){switch(t.ParaghStyle.HAlign_ENumVal){case d.ENumHAlignStyle.CENTER:case d.ENumHAlignStyle.RIGHT:case d.ENumHAlignStyle.Scattered:o=!1}}1==o&&(a=i.Bounds.Left)}return a}static hasDiagnosisEleP(e){let t=!1,n=e.Parent;for(;null!=n&&!t;)"XInputField"==n.EleTypeName&&n.InputType==h.EleTypeEnum.DiagnosisEle?t=!0:n=n.Parent;return[t,n]}static _BuildCtntLine(e,t,n,r,s){if(null==e)return null;if(null==t||t.Count()<=0)return null;let o=new i.XEleCtntLine;return s>0&&(o.DiagLeft=s),o.Index=e.LinesCnt,o.RelEleParagraph=n,o.IsFirstLineOfParagraph=r,o.AddEles(t.ToArray()),o.SetPositionDPI(0,c.Line_PosY,300),l.XDomUtil.IsTableLine(o)||o.ReCalcLineSize(),c.Line_PosY+=o.LineAssist.GetLineFullHeight(300,!0),e instanceof l.XTextTable&&e.ReCalcLinesInnerElementSize(o),e.AddLine(o),o.ReCalcElesLocation(!1),o}static _BuildCtntLineAtIndex(e,t,n,r,s,o){if(null==e)return null;if(null==t||t.Count()<=0)return null;let a=new i.XEleCtntLine;return o>0&&(a.DiagLeft=o),a.Index=e.LinesCnt,a.RelEleParagraph=n,a.IsFirstLineOfParagraph=r,a.AddEles(t.ToArray()),a.SetPositionDPI(0,c.Line_PosY,300),l.XDomUtil.IsTableLine(a)||a.ReCalcLineSize(),c.Line_PosY+=a.LineAssist.GetLineFullHeight(300,!0),e instanceof l.XTextTable&&e.ReCalcLinesInnerElementSize(a),e.AddLineToIndex(a,s),a.ReCalcElesLocation(!1),a}static _Handle_NewColumn(e,t,n,r,i){if(e.Value<0)return!1;let l=i.LineAssist.GetLineFullHeight(300,!0),s=i.Y+l;return o.CommDefines.CmprNumVal(s,r,.5)<=0?(i.ColInx=e.Value,!1):(e.Value++,e.Value>=t&&(e.Value=0),i.ColInx=e.Value,i.SetPositionDPI(e.Value*n,0,300),c.Line_PosY=l,!0)}}t.XContainerLinesCalc=c,c.Line_PosY=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfCtntLine=void 0;const r=n(11);t.InfCtntLine=class{Clear(){}get RealLeft(){return 0}set RealLeft(e){}get RealTop(){return 0}set RealTop(e){}GetVAlignStyle(e=!1){return r.ENumVAlignStyle.NONE}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XEleCtntLineAssist=void 0;const r=n(3),i=n(10),l=n(9),s=n(0),o=n(35),a=n(580),u=n(2);t.XEleCtntLineAssist=class{constructor(e){this.line=null,this.line=e}get RelOutLineFoldEle(){let e;if(!this.line.IsFirstLineOfParagraph)return e=null,e;let t=this.line.RelEleParagraph;if(null==t||!t.IsOutlineParagraph)return e=null,e;let n=t.RelOutline;if(null==n)e=null;else{let t=n.RelOutlineFoldEle;t.RelLineEleFrom=this.line.FirstElement,e=t}return e}GetFirstLineEleOfParagraph(e=!0){let t,n=this.GetFirstLineOfParagraph();if(null==n)t=null;else{let e=null;for(let t of n.ChildEleList)if(t.EleCursorAllowSide!=u.ENumEleCursorSide.ForceRight){e=t;break}t=e}return t}GetFirstLineOfParagraph(){let e=this.line;for(;!e.IsFirstLineOfParagraph;){let t=e.PrevLine;if(null==t)break;e=t}return e}GetParaLinesList(e){if(null!=e){e.Clear();let t=this.GetFirstLineOfParagraph();if(null!=t){let n=this.line.RelEleParagraph;for(;t.RelEleParagraph==n&&(e.Add(t),t=t.NextLine,null!=t););}}}GetEleAtPos(e,t,n,r,i){if(0!=this.line.ElementCnt){let l=300;if(n>0&&n!=l){let r=l/n;e*=r,t*=r}let a=this.line.Bounds.Clone();a.X+=this.line.GetAlignLeft(l),a.Height=this.GetLineFullHeight(l,!0);let u=a.Y<t&&t<a.Bottom,h=this.line.Container.GetColumnsParam();if(null!=h&&h.ColsCnt>1){let t=h.GetColWidth(this.line.ColInx,l);u=u&&a.X<e&&e<a.X+t}if(u){if(e-=a.X,t-=a.Y,this.LocateMarkEleAtPos(e,t,r),null==r.LineEleIxFocused.MarkEle){if(this.line.ElementCnt>0)for(let n=0;n<this.line.ElementCnt;n++){let l=this.line.ChildEleList.Get(n),o=!1;if(n==this.line.ElementCnt-1){const e=this.line.NextLine;if(null!=e){const t=e.FirstElement;o=t&&t.DisReflash}}if(l.GetEleAtPos(e,t,-1,r,i,o),i&&r.IsValid()){let n=l;null!=n&&n instanceof s.XTextTableCell&&(n.Visible||null==n.MainMergeCell||(t+=this.line.Y-l.MainMergeCell.OwnerLine.Y,r.Clear(!0),n.MainMergeCell.GetEleAtPos(e,t,-1,r,i)));break}}if(i&&!r.IsValid()){let n=this.line.FirstElement;if(null!=n&&o.CommDefines.CmprNumVal(e,n.X,.001)<=0)e=n.X+1;else if(o.CommDefines.CmprNumVal(e,a.Width,.001)>=0){this.line.ElementCnt>1&&(n=this.line.LastElement),null!=n&&(e=n.X+n.Width-1)}null!=n&&n.GetEleAtPos(e,t,-1,r,i)}}}else r.LineEleIxFocused.MarkEle=null}}LocateMarkEleAtPos(e,t,n){n.LineEleIxFocused.MarkEle=null;let r=this.RelOutLineFoldEle;if(null!=r){let i=r.Bounds;i.Width>0&&i.Height>0&&i.Contains(e,t)&&(n.LineEleIxFocused.MarkEle=r)}}GetLineEditablePosX(e){let t=1;return e>0&&300!=e&&(t=e/300),t*this.line.X+this.line.GetRealLineIndent(e)}GetLineFullHeight(e,t=!0){let n=0,r=this.line.FirstElement instanceof s.XSpliteLineEle,l=this.line.RelEleParagraphStyle;r||null==l||(n=l.GetLineSpacingDPI(e));let o=this.line.Height;return o=i.DPITransUtil.TransFloatVal(o,300,e),n<o&&(n=o),t&&(this.line.IsFirstLineOfParagraph&&(n+=this.line.GetRealParaghSpacingBefore(e)),this.line.IsEndWithManualCR()&&(n+=this.line.GetRealParaghSpacingAfter(e))),n}GetTableLineAttrs(e){let t;if(!s.XDomUtil.IsTableLine(this.line))return t=null,t;let n=new a.XTableLineAttrs;n.IsHidden=!0,n.MinFixHeight=-1,n.MinCellHeight=-1,n.MaxCellHeight=0,n.MaxCellHeightWithMinRowSpan=0,n.SumCellWidth=0;let r=0,i=2147483647;for(let e of this.line.ChildEleList){let t=e instanceof s.XTextTableCell?e:null;if(null!=t){const e=!t.Visible&&t.MainMergeCell&&t.MainMergeCell.RowSpan>1&&t.RowIndex>t.MainMergeCell.RowIndex&&t.RowIndex==t.MainMergeCell.RowIndex+t.MainMergeCell.RowSpan-1,l=!t.Visible&&t.MainMergeCell&&t.MainMergeCell.RowSpan>1&&t.RowIndex>t.MainMergeCell.RowIndex&&t.FromNextHideHeight>0,o=t.Visible;if(e||l){let r=t.Height;(n.MaxCellHeight<0||r>n.MaxCellHeight)&&(n.MaxCellHeight=r);let l=t.Height;e&&l>n.MaxCellHeightWithMinRowSpan&&(i=t.RowSpan,n.MaxCellHeightWithMinRowSpan=l)}else if(o){n.IsHidden=!1,n.SumCellWidth+=t.Width;let e=t.GetLinesHeight(!0,!0,300);(n.MinCellHeight<0||e<n.MinCellHeight)&&(n.MinCellHeight=e);let l=Math.max(t.Height,e);if((n.MaxCellHeight<0||l>n.MaxCellHeight)&&(n.MaxCellHeight=l),r=50,1==t.LinesCnt?r=t.GetLinesHeight(!0,!0,300):t.LinesCnt>1&&(r=t.LinesList.Get(0).Height,r+=t.EleStyle.ElePadd.Top,r+=t.EleStyle.ElePadd.Bottom),n.MinFixHeight<0||r>n.MinFixHeight){const e=t.OwnerDocPanel;if(null!=e){r>e.Height-.25&&(r=-1)}n.MinFixHeight=r}let o=t.RowSpan<=1?1:t.RowSpan,a=t.RowBaseHeight;if(t instanceof s.XTextTableCellView)if(t.RowSpan>1){const e=t.FixHeight,n=t.LinesList;if(null!=n&&n.Length>0){const r=n.Get(0);if(null!=r){let n=0,i=r.PrevLine;if(null==i)a=t.GetLinesHeight(!0,!0,300),t.LinesCnt==t.BaseCell.LinesCnt&&t.BaseCell.FromNextHideHeight>0&&(a+=t.BaseCell.FromNextHideHeight);else{a=Math.max(e,t.BaseCell.GetLinesHeight(!0,!0,300)),a=Math.max(a,t.BaseCell.RowBaseHeight);let r=null;for(;null!=i;)(null==r||null!=i.Container&&r.XID!=i.Container.XID)&&(r=i.Container,n+=r.GetLinesHeight(!1,!1,300),null!=r.LinesList&&r.LinesCnt>0&&(i=r.LinesList.Get(0))),i=i.PrevLine;a-=n,a=Math.max(0,a)}e>0&&(a=Math.min(e,a))}}else a=0}else a=t.GetLinesHeight(!0,!0,300);o<i?(i=o,n.MaxCellHeightWithMinRowSpan=a):o==i&&a>n.MaxCellHeightWithMinRowSpan&&(n.MaxCellHeightWithMinRowSpan=a)}}}return t=n,t}GetMaxEleForUnderlinePosY(e,t){let n;if(t=0,null==e)n=null;else if(!e.EleStyle.XFontStyle.IsUnderline)return n=null,n;let r=!1,i=0,l=null;for(let n of this.line.ChildEleList)if(n.EleStyle.XFontStyle.IsUnderline){let o=n.Y+n.Height;(null==l||o>i)&&(l=n,i=o),n instanceof s.XCharacterEle&&n.EleStyle.XFontStyle.FontSize>t&&(t=n.EleStyle.XFontStyle.FontSize),null!=e&&e==n&&(r=!0)}else{if(r)break;l=null,t=0}return n=l,n}GetMaxEleForStrikeoutPosY(e,t){let n;if(t=0,null==e)n=null;else if(!e.EleStyle.XFontStyle.IsStrikeout)return n=null,n;let r=!1,i=0,l=null;for(let n of this.line.ChildEleList)if(n.EleStyle.XFontStyle.IsStrikeout){let o=n.Y+n.Height;(null==l||o>i)&&(l=n,i=o),n instanceof s.XCharacterEle&&n.EleStyle.XFontStyle.FontSize>t&&(t=n.EleStyle.XFontStyle.FontSize),null!=e&&e==n&&(r=!0)}else{if(r)break;l=null,t=0}return n=l,n}GetSelRangeRects(e,t){let n,o=this.line.ElementCnt;if(o<=0||e<0||e>=o||t>=o)return n=null,n;t<0&&(t=o-1);let a=s.XDomUtil.IsTableLine(this.line),u=this.line.RealTop;a&&(u+=i.DPITransUtil.TransFloatVal(1,96,300));let h=this.GetLineFullHeight(300,!0),d=this.line.GetAlignLeft(300),c=this.line.GetWordSpacing(300),p=l.RectangleF.Empty,f=new r.List;p.Y=u,p.Height=h;let g=0;for(let n of this.line.ChildEleList)if(!(n instanceof s.XTextTable))if(g<e)g++;else{if(t>=0&&g>t)break;if(g++,0==p.Width&&(p.X=n.RealLeft+d),a){let e=n;p.Width+=e.Column.Width}else p.Width+=n.Width+c}this.line.IsEndWithManualCR()?t>=o-1?p.Width-=2*c:t>=o-2&&(p.Width-=c):t>=o-1&&(p.Width-=this.line.GetWordSpacing(300)),f.Add(p);let m=f.ToArray();for(f.Clear(),g=0;g<m.length;g++)i.DPITransUtil.TransRectF(m[g],300,m[g],96);return n=m,n}GetRootLine(){let e;for(e=this.line;null!=e&&!(e.Container instanceof s.XDocPanel);e=e.Container.OwnerLine);return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTableLineAttrs=void 0;t.XTableLineAttrs=class{constructor(){this.isHidden=!1,this.minFixHeight=0,this.minCellHeight=0,this.maxCellHeight=0,this.maxCellHeightWithMinRowSpan=0,this.sumCellWidth=0}get IsHidden(){return this.isHidden}set IsHidden(e){this.isHidden=e}get MinFixHeight(){return this.minFixHeight}set MinFixHeight(e){this.minFixHeight=e}get MinCellHeight(){return this.minCellHeight}set MinCellHeight(e){this.minCellHeight=e}get MaxCellHeight(){return this.maxCellHeight}set MaxCellHeight(e){this.maxCellHeight=e}get MaxCellHeightWithMinRowSpan(){return this.maxCellHeightWithMinRowSpan}set MaxCellHeightWithMinRowSpan(e){this.maxCellHeightWithMinRowSpan=e}get SumCellWidth(){return this.sumCellWidth}set SumCellWidth(e){this.sumCellWidth=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OneLineSelRects=void 0;const r=n(9);t.OneLineSelRects=class{constructor(e,t,n){this.line=null,this.rootLineIx=-1,this.arrRectF=null,this.line=e,this.rootLineIx=t,this.arrRectF=n}get Line(){return this.line}RootLineIx(){return this.rootLineIx}get RectsCnt(){return null==this.arrRectF?0:this.arrRectF.length}get ArrRectF(){return this.arrRectF}get Rect1st(){return this.RectsCnt<=0?r.RectangleF.Empty:this.arrRectF[0]}get RectEnd(){let e=this.RectsCnt;return e<=0?r.RectangleF.Empty:this.arrRectF[e-1]}Clear(){this.line=null,this.rootLineIx=-1,this.arrRectF=null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTableCellRangeUtil=void 0;const r=n(0),i=n(303);t.XTableCellRangeUtil=class{UpdateTableCellsRangeList(e,t,n){if((null==e?0:e.Count())>0){let l=t.RefreshEleObj(!1),s=n.RefreshEleObj(!1),o=r.XDomUtil.GetXTableOfCell(l),a=r.XDomUtil.GetXTableOfCell(s),u=new i.OneTableCellsRange(null);u.FromRIX=null==l?0:l.RowIndex,u.ToRIX=null==s?0:s.RowIndex,null!=s&&u.AddToRIX(s.RowSpan<=1?0:s.RowSpan-1),u.FromCIX=t.EleIx,u.ToCIX=n.EleIx,null!=s&&u.AddToCIX(s.ColSpan<=1?0:s.ColSpan-1),o==a&&u.SortColFromTo();for(let t of e){let e=r.XDomUtil.GetXTableOfCell(t.GetFirstTableCell());if(null!=e)if(e!=o&&e!=a)t.FromRIX=0,t.RowSpan=e.NumOfRows,t.FromCIX=0,t.ColSpan=e.NumOfColumns;else{t.CopyCellsRangeFrom(u);let n=!0;for(;n;){let r=t.GetTableViewLinesIter();for(n=!1;r.MoveNext();){let i=r.Current,l=this._UpdateTableCellsRange(t,i,e,o,a);n=n||l}}}}}}_UpdateTableCellsRange(e,t,n,r,i){let l=!1;r!=i&&(e.FromCIX=0,e.ColSpan=n.NumOfColumns);let s=t.ChildEleList.GetEnumerator();for(;s.MoveNext();){let t=s.Current;if(null!=t&&t.Visible){let s=t.RowSpan<=1?1:t.RowSpan,o=t.ColSpan<=1?1:t.ColSpan;if(n==r&&n==i){if(t.RowIndex+s-1<e.FromRIX||t.RowIndex>e.ToRIX)continue;if(t.ColIndex+o-1<e.FromCIX||t.ColIndex>e.ToCIX)continue}else if(n==r){if(t.RowIndex+s-1<e.FromRIX)continue}else if(n==i&&t.RowIndex>e.ToRIX)continue;if(t.RowIndex<e.FromRIX){let n=e.FromRIX-t.RowIndex;e.FromRIX=t.RowIndex,e.AddToRIX(n),l=!0}if(t.RowIndex+s-1>e.ToRIX&&(e.ToRIX=t.RowIndex+s-1,l=!0),r==i){if(t.ColIndex<e.FromCIX){let n=e.FromCIX-t.ColIndex;e.FromCIX=t.ColIndex,e.AddToCIX(n),l=!0}t.ColIndex+o-1>e.ToCIX&&(e.ToCIX=t.ColIndex+o-1,l=!0)}}}return l}InsertTableSelLines(e,t){if((null==e?0:e.Count())>0){let n=0;for(let r of e)if(r.FirstLineIx>=0){let e=r.FiltTableViewLinesInRange();null!=e&&e.length>0&&(t.InsertRange(r.FirstLineIx+n,e),n+=e.length,r.ClearRelLines())}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TablePropertiesInfo=void 0;t.TablePropertiesInfo=class{get No(){return this._No}set No(e){this._No=e}get Name(){return this._Name}set Name(e){this._Name=e}get IsSetRowHeight(){return this._IsSetRowHeight}set IsSetRowHeight(e){this._IsSetRowHeight=e}get IsSetColWidth(){return this._IsSetColWidth}set IsSetColWidth(e){this._IsSetColWidth=e}get IsInsertRow(){return this._IsInsertRow}set IsInsertRow(e){this._IsInsertRow=e}get IsDeleteRow(){return this._IsDeleteRow}set IsDeleteRow(e){this._IsDeleteRow=e}get IsDeleteTable(){return this._IsDeleteTable}set IsDeleteTable(e){this._IsDeleteTable=e}get Text_Expression(){return this._Text_Expression}set Text_Expression(e){this._Text_Expression=e}get IsPrint(){return this._isPrint}set IsPrint(e){this._isPrint=e}get THeadIx(){return this._THeadIx}set THeadIx(e){this._THeadIx=e}get UserEditable(){return this._UserEditable}set UserEditable(e){this._UserEditable=e}get FullPageByLastRow(){return this._FullPageByLastRow}set FullPageByLastRow(e){this._FullPageByLastRow=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableCellPropertiesInfo=void 0;t.TableCellPropertiesInfo=class{constructor(){this._ColSpan=1,this._RowSpan=1}get No(){return this._No}set No(e){this._No=e}get DisSplit(){return this._DisSplit}set DisSplit(e){this._DisSplit=e}get Slashing(){return this._Slashing}set Slashing(e){this._Slashing=e}get UserEditable(){return this._UserEditable}set UserEditable(e){this._UserEditable=e}get ColSpan(){return this._ColSpan}set ColSpan(e){this._ColSpan=e}get RowSpan(){return this._RowSpan}set RowSpan(e){this._RowSpan=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XUserHistoryWrap=void 0;const r=n(2);t.XUserHistoryWrap=class{constructor(e){this.relEle=null,this.addHist=null,this.delHist=null,this.addHistAimPos=-1,this.delHistAimPos=-1,this.relEle=e}get RelEle(){return this.relEle}get AddHist(){return this.addHist}set AddHist(e){null!=e&&(e.OpType=r.ENumEdtType.Add),this.addHist=e}get DelHist(){return this.delHist}set DelHist(e){null!=e&&(e.OpType=r.ENumEdtType.Delete),this.delHist=e}get AddHistAimPos(){return this.addHistAimPos<0&&null!=this.addHist&&(this.addHistAimPos=this.addHist.GetRelElePos(this.relEle)),this.addHistAimPos}get DelHistAimPos(){return this.delHistAimPos<0&&null!=this.delHist&&(this.delHistAimPos=this.delHist.GetRelElePos(this.relEle)),this.delHistAimPos}Clear(){this.relEle=null,this.addHist=null,this.delHist=null}HasValidHistory(){return null!=this.relEle&&(null!=this.addHist||null!=this.delHist)}ResetAimPos(){this.addHistAimPos=-1,this.delHistAimPos=-1}StepUpAimPos(){let e=this.AddHistAimPos;e>=0&&this.addHistAimPos++,e=this.DelHistAimPos,e>=0&&this.delHistAimPos++}GetDstHist(e){let t=null;switch(e){case r.ENumEdtType.Add:t=this.addHist;break;case r.ENumEdtType.Delete:case r.ENumEdtType.Backspace:t=this.delHist}return t}GetDstAimPos(e){let t=-1;switch(e){case r.ENumEdtType.Add:t=this.AddHistAimPos;break;case r.ENumEdtType.Delete:case r.ENumEdtType.Backspace:t=this.DelHistAimPos}return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgResult=void 0;t.MsgResult=class{constructor(){this.strMsg=null,this.resLevel=5}get StrMsg(){return this.strMsg}set StrMsg(e){this.strMsg=e}get ResLevel(){return this.resLevel}set ResLevel(e){this.resLevel=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MulSelModel=void 0,function(e){e[e.Default=0]="Default",e[e.GroupSingle=1]="GroupSingle",e[e.GroupMulSel=2]="GroupMulSel"}(t.MulSelModel||(t.MulSelModel={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormCommonUtil=void 0;const r=n(35);t.FormCommonUtil=class{static ConvertMulSelModelToStr(e){return e.toString()}static ConvertIntToMulSelModel(e){return r.CommDefines.TryParseInt(e,0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseInputAssist=void 0;const r=n(79),i=n(16),l=n(106),s=n(4);t.XBaseInputAssist=class{constructor(e){this._innerInput=e}DynamicShowHideBackEle(){let e=i.XDomUtil.HasContent(this._innerInput,!0),t=!0;if(null!=this._innerInput.Document){!0&&(e=i.XDomUtil.HasContent(this._innerInput,!1),t=!1)}e||s.default.IsNullOrEmpty(this._innerInput.BackgroundText)?this.RemoveBackEle():this._innerInput.EleStyle.DeleterIndex>-1||this.InsertUpdateBackText(t)}RemoveBackEle(){let e=this.ExistBackEle();if(null!=e){if(null!=this._innerInput.UndoGrp){let t=new l.EleAddDelUndo(e,this._innerInput.GetInsertIdx(),!1);this._innerInput.UndoGrp.AddItem(t)}this._innerInput.RemoveChildWithEle(e)}}InsertUpdateBackText(e){let t=this._innerInput.GetXInputText(e,!1,!0,!1,!1,!1,!1);if(s.default.IsNullOrEmpty(t)&&!s.default.IsNullOrEmpty(this._innerInput.BackgroundText)&&!i.XDomUtil.HasContent(this._innerInput,e)){let e=this._innerInput.GetBackTextXStrEle();if(null==this.ExistBackEle()&&(this._innerInput.AddChildEle(this._innerInput.GetInsertIdx(),e),null!=this._innerInput.UndoGrp)){let t=new l.EleAddDelUndo(e,this._innerInput.GetInsertIdx(),!0);this._innerInput.UndoGrp.AddItem(t)}}}ExistBackEle(){let e,t=this._innerInput.GetChildArr();null!=t&&0!=t.length||(e=null);let n=t;for(let t=0;t<n.length;t++){let i=n[t],l=i instanceof r.XStringEle?i:null;if(null!=l&&l.IsXInputBkgText)return e=l,e}return e=null,e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XStrSplitUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t,n){super(),this.origXStr=null,this.origXStrLen=0,this.origXStrPos=-1,this.sptXChPos=-1,this.endXStr=null,this.insertEle=null,this.origXStr=e,this.origXStrLen=e.ChildCount,this.origXStrPos=t,this.sptXChPos=n}SetEndXtr(e,t){this.endXStr=e,this.insertEle=t}IsValid(){return null!=this.origXStr&&null!=this.endXStr&&this.sptXChPos>0&&this.sptXChPos<this.origXStrLen}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){if(this.CanUndo()){let e=this.endXStr.GetChildArr();this.origXStr.AddChildrenEle(this.sptXChPos,e),this.origXStr.Parent.RemoveChildrenWithRange(this.origXStrPos+1,2)}}Redo(){if(this.CanRedo()){this.origXStr.RemoveChildren(this.sptXChPos,this.origXStrLen-this.sptXChPos);let e=this.origXStr.Parent;e.AddChildEle(this.origXStrPos+1,this.endXStr),e.AddChildEle(this.origXStrPos+1,this.insertEle)}}Clear(){this.origXStr=this.endXStr=null,this.insertEle=null,this.origXStrLen=0,this.origXStrPos=-1,this.sptXChPos=-1}}t.XStrSplitUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCheckBoxEle=void 0;const r=n(46),i=n(80),l=n(0);class s extends l.XBaseChoiceEle{get EleTypeName(){return"XTextCheckBox"}get Default_ShowStyle(){return"CheckBox"}get CheckError_Type(){return super.CheckError_Type}set CheckError_Type(e){super.CheckError_Type=e,super.CheckError_Type!=r.CheckErrorType.None||(super.ToolTip=super.EleToolTip)}get RadioDefalutHeight(){return 10}get ElementInfo(){return i.XInputUtil.GetInstance().BulidEleInfo_InputGroup(this)}}t.XCheckBoxEle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XRemoveWrapper=void 0;t.XRemoveWrapper=class{constructor(){this._FromPos=-1,this._RemoveEles=null}get FromPos(){return this._FromPos}set FromPos(e){this._FromPos=e}get RemoveEles(){return this._RemoveEles}set RemoveEles(e){this._RemoveEles=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BarCodes1D=void 0;const r=n(7),i=n(34),l=n(25),s=n(594),o=n(83);t.BarCodes1D=class{constructor(){this.multiplier=7,this.textAlignment="",this.barcodeData="",this.backColor=new r.Color("#FFFFFFFF"),this.foreColor=new r.Color("0, 0, 0")}get TextVisible(){return this.textVisible}set TextVisible(e){this.textVisible=e}get AutoSize(){return this.autoSize}set AutoSize(e){this.autoSize=e}get UseTestData(){return this.useTestData}set UseTestData(e){this.useTestData=e}get Multiplier(){return this.multiplier}set Multiplier(e){this.Size=new l.SizeF(24*e,74),this.multiplier=e}get TextAlignment(){return this.textAlignment}set TextAlignment(e){this.textAlignment=e}get BarcodeData(){return this.barcodeData}set BarcodeData(e){this.barcodeData=e}IsValidBarcode(){return!!i.Symbology[this.Symbology]}get BackColor(){return this.backColor}set BackColor(e){null!=e&&(this.backColor=e)}get ForeColor(){return this.foreColor}set ForeColor(e){this.foreColor=e}SaveToBitmap(){let e,t=document.createElement("canvas"),n="CODE128",r=this.Symbology;r>=0&&r<=2||9==r?n="CODE39":r>=3&&r<=8?n="CODE128":r>=12&&r<=12?n="ITF-14":r>=13&&r<=13?n="Codabar":r>=14&&r<=14?n="MSI":r>=17&&r<=20?n="EAN / UPC":r>=10&&r<=11&&(n="Pharmacode");let i=2*this.multiplier;i=Math.max(i,12),this.Size.Height=Math.max(this.Size.Height,i);const l={format:n,height:this.Size.Height,lineColor:this.foreColor.ToRgbaString(),background:this.backColor.ToRgbaString(),margin:0,fontSize:2*this.multiplier,font:this.Font.Name,textAlign:this.textAlignment,displayValue:this.textVisible};s(t,this.barcodeData,l);let a=t.toDataURL("image/png");return e=o.XImageUtil.Base64ToImage(a),e}}},function(e,t,n){"use strict";var r=c(n(595)),i=c(n(166)),l=c(n(620)),s=c(n(621)),o=c(n(622)),a=c(n(316)),u=c(n(628)),h=n(319),d=c(n(317));function c(e){return e&&e.__esModule?e:{default:e}}var p=function(){},f=function(e,t,n){var r=new p;if(void 0===e)throw Error("No element to render on was provided.");return r._renderProperties=(0,o.default)(e),r._encodings=[],r._options=d.default,r._errorHandler=new u.default(r),void 0!==t&&((n=n||{}).format||(n.format=C()),r.options(n)[n.format](t,n).render()),r};for(var g in f.getModule=function(e){return r.default[e]},r.default)r.default.hasOwnProperty(g)&&m(r.default,g);function m(e,t){p.prototype[t]=p.prototype[t.toUpperCase()]=p.prototype[t.toLowerCase()]=function(n,r){var l=this;return l._errorHandler.wrapBarcodeCall((function(){r.text=void 0===r.text?void 0:""+r.text;var s=(0,i.default)(l._options,r);s=(0,a.default)(s);var o=e[t],u=E(n,o,s);return l._encodings.push(u),l}))}}function E(e,t,n){var r=new t(e=""+e,n);if(!r.valid())throw new h.InvalidInputException(r.constructor.name,e);var s=r.encode();s=(0,l.default)(s);for(var o=0;o<s.length;o++)s[o].options=(0,i.default)(n,s[o].options);return s}function C(){return r.default.CODE128?"CODE128":Object.keys(r.default)[0]}function A(e,t,n){t=(0,l.default)(t);for(var r=0;r<t.length;r++)t[r].options=(0,i.default)(n,t[r].options),(0,s.default)(t[r].options);(0,s.default)(n),new(0,e.renderer)(e.element,t,n).render(),e.afterRender&&e.afterRender()}p.prototype.options=function(e){return this._options=(0,i.default)(this._options,e),this},p.prototype.blank=function(e){var t=new Array(e+1).join("0");return this._encodings.push({data:t}),this},p.prototype.init=function(){var e;if(this._renderProperties)for(var t in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){e=this._renderProperties[t];var n=(0,i.default)(this._options,e.options);"auto"==n.format&&(n.format=C()),this._errorHandler.wrapBarcodeCall((function(){var t=E(n.value,r.default[n.format.toUpperCase()],n);A(e,t,n)}))}},p.prototype.render=function(){if(!this._renderProperties)throw new h.NoElementException;if(Array.isArray(this._renderProperties))for(var e=0;e<this._renderProperties.length;e++)A(this._renderProperties[e],this._encodings,this._options);else A(this._renderProperties,this._encodings,this._options);return this},p.prototype._defaults=d.default,"undefined"!=typeof window&&(window.JsBarcode=f),"undefined"!=typeof jQuery&&(jQuery.fn.JsBarcode=function(e,t){var n=[];return jQuery(this).each((function(){n.push(this)})),f(n,e,t)}),e.exports=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(596),i=n(597),l=n(603),s=n(609),o=n(612),a=n(617),u=n(618),h=n(619);t.default={CODE39:r.CODE39,CODE128:i.CODE128,CODE128A:i.CODE128A,CODE128B:i.CODE128B,CODE128C:i.CODE128C,EAN13:l.EAN13,EAN8:l.EAN8,EAN5:l.EAN5,EAN2:l.EAN2,UPC:l.UPC,UPCE:l.UPCE,ITF14:s.ITF14,ITF:s.ITF,MSI:o.MSI,MSI10:o.MSI10,MSI11:o.MSI11,MSI1010:o.MSI1010,MSI1110:o.MSI1110,pharmacode:a.pharmacode,codabar:u.codabar,GenericBarcode:h.GenericBarcode}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CODE39=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(66);var s=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=e.toUpperCase(),n.mod43&&(e+=function(e){return o[e]}(function(e){for(var t=0,n=0;n<e.length;n++)t+=h(e[n]);return t%=43}(e))),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"encode",value:function(){for(var e=u("*"),t=0;t<this.data.length;t++)e+=u(this.data[t])+"0";return{data:e+=u("*"),text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)}}]),t}(((r=l)&&r.__esModule?r:{default:r}).default),o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],a=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function u(e){return function(e){return a[e].toString(2)}(h(e))}function h(e){return o.indexOf(e)}t.CODE39=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CODE128C=t.CODE128B=t.CODE128A=t.CODE128=void 0;var r=o(n(598)),i=o(n(600)),l=o(n(601)),s=o(n(602));function o(e){return e&&e.__esModule?e:{default:e}}t.CODE128=r.default,t.CODE128A=i.default,t.CODE128B=l.default,t.CODE128C=s.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(164)),i=l(n(599));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var o=function(e){function t(e,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),/^[\x00-\x7F\xC8-\xD3]+$/.test(e))var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(0,i.default)(e),n));else r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s(r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(134),i=function(e){return e.match(new RegExp("^"+r.A_CHARS+"*"))[0].length},l=function(e){return e.match(new RegExp("^"+r.B_CHARS+"*"))[0].length},s=function(e){return e.match(new RegExp("^"+r.C_CHARS+"*"))[0]};function o(e,t){var n=t?r.A_CHARS:r.B_CHARS,i=e.match(new RegExp("^("+n+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(i)return i[1]+String.fromCharCode(204)+a(e.substring(i[1].length));var l=e.match(new RegExp("^"+n+"+"))[0];return l.length===e.length?e:l+String.fromCharCode(t?205:206)+o(e.substring(l.length),!t)}function a(e){var t=s(e),n=t.length;if(n===e.length)return e;e=e.substring(n);var r=i(e)>=l(e);return t+String.fromCharCode(r?206:205)+o(e,r)}t.default=function(e){var t=void 0;if(s(e).length>=2)t=r.C_START_CHAR+a(e);else{var n=i(e)>l(e);t=(n?r.A_START_CHAR:r.B_START_CHAR)+o(e,n)}return t.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,(function(e,t){return String.fromCharCode(203)+t}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(164),s=(r=l)&&r.__esModule?r:{default:r},o=n(134);var a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.A_START_CHAR+e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"valid",value:function(){return new RegExp("^"+o.A_CHARS+"+$").test(this.data)}}]),t}(s.default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(164),s=(r=l)&&r.__esModule?r:{default:r},o=n(134);var a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.B_START_CHAR+e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"valid",value:function(){return new RegExp("^"+o.B_CHARS+"+$").test(this.data)}}]),t}(s.default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(164),s=(r=l)&&r.__esModule?r:{default:r},o=n(134);var a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.C_START_CHAR+e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"valid",value:function(){return new RegExp("^"+o.C_CHARS+"+$").test(this.data)}}]),t}(s.default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPCE=t.UPC=t.EAN2=t.EAN5=t.EAN8=t.EAN13=void 0;var r=u(n(604)),i=u(n(605)),l=u(n(606)),s=u(n(607)),o=u(n(314)),a=u(n(608));function u(e){return e&&e.__esModule?e:{default:e}}t.EAN13=r.default,t.EAN8=i.default,t.EAN5=l.default,t.EAN2=s.default,t.UPC=o.default,t.UPCE=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var l=Object.getPrototypeOf(t);return null===l?void 0:e(l,n,r)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(r):void 0},s=n(135),o=n(313),a=(r=o)&&r.__esModule?r:{default:r};var u=function(e){return(10-e.substr(0,12).split("").map((function(e){return+e})).reduce((function(e,t,n){return n%2?e+3*t:e+t}),0)%10)%10},h=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),-1!==e.search(/^[0-9]{12}$/)&&(e+=u(e));var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.lastChar=n.lastChar,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{13}$/)&&+this.data[12]===u(this.data)}},{key:"leftText",value:function(){return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var e=this.data.substr(1,6),n=s.EAN13_STRUCTURE[this.data[0]];return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftEncode",this).call(this,e,n)}},{key:"rightText",value:function(){return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var e=this.data.substr(7,6);return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightEncode",this).call(this,e,"RRRRRR")}},{key:"encodeGuarded",value:function(){var e=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(e.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(e.push({data:"00"}),e.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),e}}]),t}(a.default);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var l=Object.getPrototypeOf(t);return null===l?void 0:e(l,n,r)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(r):void 0},s=n(313),o=(r=s)&&r.__esModule?r:{default:r};var a=function(e){return(10-e.substr(0,7).split("").map((function(e){return+e})).reduce((function(e,t,n){return n%2?e+t:e+3*t}),0)%10)%10},u=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),-1!==e.search(/^[0-9]{7}$/)&&(e+=a(e)),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{8}$/)&&+this.data[7]===a(this.data)}},{key:"leftText",value:function(){return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var e=this.data.substr(0,4);return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftEncode",this).call(this,e,"LLLL")}},{key:"rightText",value:function(){return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var e=this.data.substr(4,4);return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightEncode",this).call(this,e,"RRRR")}}]),t}(o.default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(135),l=o(n(136)),s=o(n(66));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{5}$/)}},{key:"encode",value:function(){var e,t=i.EAN5_STRUCTURE[(e=this.data,e.split("").map((function(e){return+e})).reduce((function(e,t,n){return n%2?e+9*t:e+3*t}),0)%10)];return{data:"1011"+(0,l.default)(this.data,t,"01"),text:this.text}}}]),t}(s.default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(135),l=s(n(136));function s(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{2}$/)}},{key:"encode",value:function(){var e=i.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,l.default)(this.data,e,"01"),text:this.text}}}]),t}(s(n(66)).default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=o(n(136)),l=o(n(66)),s=n(314);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],h=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],d=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));if(r.isValid=!1,-1!==e.search(/^[0-9]{6}$/))r.middleDigits=e,r.upcA=c(e,"0"),r.text=n.text||""+r.upcA[0]+e+r.upcA[r.upcA.length-1],r.isValid=!0;else{if(-1===e.search(/^[01][0-9]{7}$/))return a(r);if(r.middleDigits=e.substring(1,e.length-1),r.upcA=c(r.middleDigits,e[0]),r.upcA[r.upcA.length-1]!==e[e.length-1])return a(r);r.isValid=!0}return r.displayValue=n.displayValue,n.fontSize>10*n.width?r.fontSize=10*n.width:r.fontSize=n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var e="";return e+="101",e+=this.encodeMiddleDigits(),{data:e+="010101",text:this.text}}},{key:"guardedEncoding",value:function(){var e=[];return this.displayValue&&e.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),e.push({data:"101",options:{height:this.guardHeight}}),e.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),e.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&e.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),e}},{key:"encodeMiddleDigits",value:function(){var e=this.upcA[0],t=this.upcA[this.upcA.length-1],n=h[parseInt(t)][parseInt(e)];return(0,i.default)(this.middleDigits,n)}}]),t}(l.default);function c(e,t){for(var n=parseInt(e[e.length-1]),r=u[n],i="",l=0,o=0;o<r.length;o++){var a=r[o];i+="X"===a?e[l++]:a}return""+(i=""+t+i)+(0,s.checksum)(i)}t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ITF14=t.ITF=void 0;var r=l(n(315)),i=l(n(611));function l(e){return e&&e.__esModule?e:{default:e}}t.ITF=r.default,t.ITF14=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.START_BIN="1010",t.END_BIN="11101",t.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(315),s=(r=l)&&r.__esModule?r:{default:r};var o=function(e){var t=e.substr(0,13).split("").map((function(e){return parseInt(e,10)})).reduce((function(e,t,n){return e+t*(3-n%2*2)}),0);return 10*Math.ceil(t/10)-t},a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),-1!==e.search(/^[0-9]{13}$/)&&(e+=o(e)),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{14}$/)&&+this.data[13]===o(this.data)}}]),t}(s.default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MSI1110=t.MSI1010=t.MSI11=t.MSI10=t.MSI=void 0;var r=a(n(137)),i=a(n(613)),l=a(n(614)),s=a(n(615)),o=a(n(616));function a(e){return e&&e.__esModule?e:{default:e}}t.MSI=r.default,t.MSI10=i.default,t.MSI11=l.default,t.MSI1010=s.default,t.MSI1110=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(137),l=(r=i)&&r.__esModule?r:{default:r},s=n(165);var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e+(0,s.mod10)(e),n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(l.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(137),l=(r=i)&&r.__esModule?r:{default:r},s=n(165);var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e+(0,s.mod11)(e),n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(l.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(137),l=(r=i)&&r.__esModule?r:{default:r},s=n(165);var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e+=(0,s.mod10)(e),e+=(0,s.mod10)(e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(l.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(137),l=(r=i)&&r.__esModule?r:{default:r},s=n(165);var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e+=(0,s.mod11)(e),e+=(0,s.mod10)(e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(l.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pharmacode=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(66);var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.number=parseInt(e,10),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"encode",value:function(){for(var e=this.number,t="";!isNaN(e)&&0!=e;)e%2==0?(t="11100"+t,e=(e-2)/2):(t="100"+t,e=(e-1)/2);return{data:t=t.slice(0,-2),text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),t}(((r=l)&&r.__esModule?r:{default:r}).default);t.pharmacode=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codabar=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(66);var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),0===e.search(/^[0-9\-\$\:\.\+\/]+$/)&&(e="A"+e+"A");var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.toUpperCase(),n));return r.text=r.options.text||r.text.replace(/[A-D]/g,""),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)}},{key:"encode",value:function(){for(var e=[],t=this.getEncodings(),n=0;n<this.data.length;n++)e.push(t[this.data.charAt(n)]),n!==this.data.length-1&&e.push("0");return{text:this.text,data:e.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"101100110011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),t}(((r=l)&&r.__esModule?r:{default:r}).default);t.codabar=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GenericBarcode=void 0;var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(66);var s=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),t}(((r=l)&&r.__esModule?r:{default:r}).default);t.GenericBarcode=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[];return function e(n){if(Array.isArray(n))for(var r=0;r<n.length;r++)e(n[r]);else n.text=n.text||"",n.data=n.data||"",t.push(n)}(e),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.marginTop=e.marginTop||e.margin,e.marginBottom=e.marginBottom||e.margin,e.marginRight=e.marginRight||e.margin,e.marginLeft=e.marginLeft||e.margin,e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=o(n(623)),l=o(n(624)),s=n(319);function o(e){return e&&e.__esModule?e:{default:e}}function a(e){if("string"==typeof e)return function(e){var t=document.querySelectorAll(e);if(0===t.length)return;for(var n=[],r=0;r<t.length;r++)n.push(a(t[r]));return n}(e);if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(a(e[n]));return t}if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLImageElement)return o=e,{element:u=document.createElement("canvas"),options:(0,i.default)(o),renderer:l.default.CanvasRenderer,afterRender:function(){o.setAttribute("src",u.toDataURL())}};if(e&&e.nodeName&&"svg"===e.nodeName.toLowerCase()||"undefined"!=typeof SVGElement&&e instanceof SVGElement)return{element:e,options:(0,i.default)(e),renderer:l.default.SVGRenderer};if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement)return{element:e,options:(0,i.default)(e),renderer:l.default.CanvasRenderer};if(e&&e.getContext)return{element:e,renderer:l.default.CanvasRenderer};if(e&&"object"===(void 0===e?"undefined":r(e))&&!e.nodeName)return{element:e,renderer:l.default.ObjectRenderer};throw new s.InvalidElementException;var o,u}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(316)),i=l(n(317));function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t={};for(var n in i.default)i.default.hasOwnProperty(n)&&(e.hasAttribute("jsbarcode-"+n.toLowerCase())&&(t[n]=e.getAttribute("jsbarcode-"+n.toLowerCase())),e.hasAttribute("data-"+n.toLowerCase())&&(t[n]=e.getAttribute("data-"+n.toLowerCase())));return t.value=e.getAttribute("jsbarcode-value")||e.getAttribute("data-value"),t=(0,r.default)(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(625)),i=s(n(626)),l=s(n(627));function s(e){return e&&e.__esModule?e:{default:e}}t.default={CanvasRenderer:r.default,SVGRenderer:i.default,ObjectRenderer:l.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(166),s=(r=l)&&r.__esModule?r:{default:r},o=n(318);var a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.encodings=n,this.options=r}return i(e,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var e=0;e<this.encodings.length;e++){var t=(0,s.default)(this.options,this.encodings[e].options);this.drawCanvasBarcode(t,this.encodings[e]),this.drawCanvasText(t,this.encodings[e]),this.moveCanvasDrawing(this.encodings[e])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var e=this.canvas.getContext("2d");e.save(),(0,o.calculateEncodingAttributes)(this.encodings,this.options,e);var t=(0,o.getTotalWidthOfEncodings)(this.encodings),n=(0,o.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=t+this.options.marginLeft+this.options.marginRight,this.canvas.height=n,e.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(e.fillStyle=this.options.background,e.fillRect(0,0,this.canvas.width,this.canvas.height)),e.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(e,t){var n,r=this.canvas.getContext("2d"),i=t.data;n="top"==e.textPosition?e.marginTop+e.fontSize+e.textMargin:e.marginTop,r.fillStyle=e.lineColor;for(var l=0;l<i.length;l++){var s=l*e.width+t.barcodePadding;"1"===i[l]?r.fillRect(s,n,e.width,e.height):i[l]&&r.fillRect(s,n,e.width,e.height*i[l])}}},{key:"drawCanvasText",value:function(e,t){var n,r,i=this.canvas.getContext("2d"),l=e.fontOptions+" "+e.fontSize+"px "+e.font;e.displayValue&&(r="top"==e.textPosition?e.marginTop+e.fontSize-e.textMargin:e.height+e.textMargin+e.marginTop+e.fontSize,i.font=l,"left"==e.textAlign||t.barcodePadding>0?(n=0,i.textAlign="left"):"right"==e.textAlign?(n=t.width-1,i.textAlign="right"):(n=t.width/2,i.textAlign="center"),i.fillText(t.text,n,r))}},{key:"moveCanvasDrawing",value:function(e){this.canvas.getContext("2d").translate(e.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(166),s=(r=l)&&r.__esModule?r:{default:r},o=n(318);var a="http://www.w3.org/2000/svg",u=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.svg=t,this.encodings=n,this.options=r,this.document=r.xmlDocument||document}return i(e,[{key:"render",value:function(){var e=this.options.marginLeft;this.prepareSVG();for(var t=0;t<this.encodings.length;t++){var n=this.encodings[t],r=(0,s.default)(this.options,n.options),i=this.createGroup(e,r.marginTop,this.svg);this.setGroupOptions(i,r),this.drawSvgBarcode(i,r,n),this.drawSVGText(i,r,n),e+=n.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,o.calculateEncodingAttributes)(this.encodings,this.options);var e=(0,o.getTotalWidthOfEncodings)(this.encodings),t=(0,o.getMaximumHeightOfEncodings)(this.encodings),n=e+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(n,t),this.options.background&&this.drawRect(0,0,n,t,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(e,t,n){var r,i=n.data;r="top"==t.textPosition?t.fontSize+t.textMargin:0;for(var l=0,s=0,o=0;o<i.length;o++)s=o*t.width+n.barcodePadding,"1"===i[o]?l++:l>0&&(this.drawRect(s-t.width*l,r,t.width*l,t.height,e),l=0);l>0&&this.drawRect(s-t.width*(l-1),r,t.width*l,t.height,e)}},{key:"drawSVGText",value:function(e,t,n){var r,i,l=this.document.createElementNS(a,"text");t.displayValue&&(l.setAttribute("style","font:"+t.fontOptions+" "+t.fontSize+"px "+t.font),i="top"==t.textPosition?t.fontSize-t.textMargin:t.height+t.textMargin+t.fontSize,"left"==t.textAlign||n.barcodePadding>0?(r=0,l.setAttribute("text-anchor","start")):"right"==t.textAlign?(r=n.width-1,l.setAttribute("text-anchor","end")):(r=n.width/2,l.setAttribute("text-anchor","middle")),l.setAttribute("x",r),l.setAttribute("y",i),l.appendChild(this.document.createTextNode(n.text)),e.appendChild(l))}},{key:"setSvgAttributes",value:function(e,t){var n=this.svg;n.setAttribute("width",e+"px"),n.setAttribute("height",t+"px"),n.setAttribute("x","0px"),n.setAttribute("y","0px"),n.setAttribute("viewBox","0 0 "+e+" "+t),n.setAttribute("xmlns",a),n.setAttribute("version","1.1"),n.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(e,t,n){var r=this.document.createElementNS(a,"g");return r.setAttribute("transform","translate("+e+", "+t+")"),n.appendChild(r),r}},{key:"setGroupOptions",value:function(e,t){e.setAttribute("style","fill:"+t.lineColor+";")}},{key:"drawRect",value:function(e,t,n,r,i){var l=this.document.createElementNS(a,"rect");return l.setAttribute("x",e),l.setAttribute("y",t),l.setAttribute("width",n),l.setAttribute("height",r),i.appendChild(l),l}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.object=t,this.encodings=n,this.options=r}return r(e,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=t}return r(e,[{key:"handleCatch",value:function(e){if("InvalidInputException"!==e.name)throw e;if(this.api._options.valid===this.api._defaults.valid)throw e.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(e){try{var t=e.apply(void 0,arguments);return this.api._options.valid(!0),t}catch(e){return this.handleCatch(e),this.api}}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BulidCodeResultInfo=void 0;t.BulidCodeResultInfo=class{constructor(){this._Image=null,this._IsException=!1}get Image(){return this._Image}set Image(e){this._Image=e}get IsException(){return this._IsException}set IsException(e){this._IsException=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputWildCharResultInfo=void 0;class r{get Result(){return this._result}set Result(e){this._result=e}get IsExpression(){return this._isExpression}set IsExpression(e){this._isExpression=e}static CreateInstance(e,t){let n=new r;return n.Result=e,n.IsExpression=t,n}}t.InputWildCharResultInfo=r},function(e,t,n){"use strict";var r=n(324),i=60103,l=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var s=60109,o=60110,a=60112;t.Suspense=60113;var u=60115,h=60116;if("function"==typeof Symbol&&Symbol.for){var d=Symbol.for;i=d("react.element"),l=d("react.portal"),t.Fragment=d("react.fragment"),t.StrictMode=d("react.strict_mode"),t.Profiler=d("react.profiler"),s=d("react.provider"),o=d("react.context"),a=d("react.forward_ref"),t.Suspense=d("react.suspense"),u=d("react.memo"),h=d("react.lazy")}var c="function"==typeof Symbol&&Symbol.iterator;function p(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function m(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function E(){}function C(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(p(85));this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},E.prototype=m.prototype;var A=C.prototype=new E;A.constructor=C,r(A,m.prototype),A.isPureReactComponent=!0;var y={current:null},I=Object.prototype.hasOwnProperty,S={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,n){var r,l={},s=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)I.call(t,r)&&!S.hasOwnProperty(r)&&(l[r]=t[r]);var a=arguments.length-2;if(1===a)l.children=n;else if(1<a){for(var u=Array(a),h=0;h<a;h++)u[h]=arguments[h+2];l.children=u}if(e&&e.defaultProps)for(r in a=e.defaultProps)void 0===l[r]&&(l[r]=a[r]);return{$$typeof:i,type:e,key:s,ref:o,props:l,_owner:y.current}}function w(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}var b=/\/+/g;function x(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,n,r,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var a=!1;if(null===e)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case i:case l:a=!0}}if(a)return s=s(a=e),e=""===r?"."+x(a,0):r,Array.isArray(s)?(n="",null!=e&&(n=e.replace(b,"$&/")+"/"),P(s,t,n,"",(function(e){return e}))):null!=s&&(w(s)&&(s=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(b,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=""===r?".":r+":",Array.isArray(e))for(var u=0;u<e.length;u++){var h=r+x(o=e[u],u);a+=P(o,t,n,h,s)}else if("function"==typeof(h=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=c&&e[c]||e["@@iterator"])?e:null}(e)))for(e=h.call(e),u=0;!(o=e.next()).done;)a+=P(o=o.value,t,n,h=r+x(o,u++),s);else if("object"===o)throw t=""+e,Error(p(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return a}function v(e,t,n){if(null==e)return e;var r=[],i=0;return P(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function T(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var M={current:null};function L(){var e=M.current;if(null===e)throw Error(p(321));return e}var D={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:y,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:v,forEach:function(e,t,n){v(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return v(e,(function(){t++})),t},toArray:function(e){return v(e,(function(e){return e}))||[]},only:function(e){if(!w(e))throw Error(p(143));return e}},t.Component=m,t.PureComponent=C,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.cloneElement=function(e,t,n){if(null==e)throw Error(p(267,e));var l=r({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=y.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(h in t)I.call(t,h)&&!S.hasOwnProperty(h)&&(l[h]=void 0===t[h]&&void 0!==u?u[h]:t[h])}var h=arguments.length-2;if(1===h)l.children=n;else if(1<h){u=Array(h);for(var d=0;d<h;d++)u[d]=arguments[d+2];l.children=u}return{$$typeof:i,type:e.type,key:s,ref:o,props:l,_owner:a}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:o,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:a,render:e}},t.isValidElement=w,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return L().useCallback(e,t)},t.useContext=function(e,t){return L().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return L().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return L().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return L().useLayoutEffect(e,t)},t.useMemo=function(e,t){return L().useMemo(e,t)},t.useReducer=function(e,t,n){return L().useReducer(e,t,n)},t.useRef=function(e){return L().useRef(e)},t.useState=function(e){return L().useState(e)},t.version="17.0.1"},function(e,t,n){var r=n(18),i=n(633);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".pango-editor-text-button {\r\n    display: inline-block;\r\n    white-space: nowrap;\r\n    cursor: pointer;\r\n    -webkit-appearance: none;\r\n    text-align: center;\r\n    box-sizing: border-box;\r\n    outline: none;\r\n    margin: 0;\r\n    transition: .1s;\r\n    font-weight: 500;\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    font-size: 14px;\r\n    border-radius: 4px;\r\n    height: 26px;\r\n    width: 60px;\r\n}\r\n.pango-editor-text-button:hover,.pango-editor-text-button:active {\r\n    transition: border-color .2s cubic-bezier(.645, .045, .355, 1), background-color .3s cubic-bezier(.645, .045, .355, 1), color .2s cubic-bezier(.645, .045, .355, 1);\r\n}\r\n\r\n.pango-editor-text-button.button-primary {\r\n    background:var(--pango-editor-theme);\r\n    border: 1px solid var(--pango-editor-theme);\r\n    color: #FFFFFF;\r\n}\r\n.pango-editor-text-button.button-default {\r\n    background: #FFFFFF;\r\n    border: 1px solid var(--pango-editor-theme);\r\n    color: var(--pango-editor-theme);\r\n}\r\n\r\n.pango-editor-text-button:active {\r\n    outline: none;\r\n}\r\n\r\n.pango-editor-text-button.button-primary:hover {\r\n    background-color: var(--pango-editor-theme-hover);\r\n    border: 1px solid var(--pango-editor-theme-hover);\r\n}\r\n.pango-editor-text-button.button-primary:active,\r\n.pango-editor-text-button.button-primary:focus {\r\n    background-color: var(--pango-editor-theme-press);\r\n    border: 1px solid var(--pango-editor-theme-press);\r\n}\r\n\r\n.pango-editor-text-button.button-default:hover {\r\n    color: var(--pango-editor-theme-hover);\r\n    border: 1px solid var(--pango-editor-theme-hover);\r\n}\r\n.pango-editor-text-button.button-default:active,\r\n.pango-editor-text-button.button-default:focus{\r\n    color: var(--pango-editor-theme-press);\r\n    border: 1px solid var(--pango-editor-theme-press);\r\n    background-color: var(--pango-editor-theme-back-select);\r\n}\r\n.pango-editor-text-button .suffixIcon {\r\n    margin-left: 6px;\r\n    font-size: 12px;\r\n}\r\n",""]),e.exports=t},function(e,t,n){"use strict";var r=n(12),i=n(324),l=n(635);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));var o=new Set,a={};function u(e,t){h(e,t),h(e+"Capture",t)}function h(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var d=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p=Object.prototype.hasOwnProperty,f={},g={};function m(e,t,n,r,i,l,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=s}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){E[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];E[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){E[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){E[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){E[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){E[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){E[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){E[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){E[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var C=/[\-:]([a-z])/g;function A(e){return e[1].toUpperCase()}function y(e,t,n,r){var i=E.hasOwnProperty(t)?E[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!p.call(g,e)||!p.call(f,e)&&(c.test(e)?g[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(C,A);E[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(C,A);E[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(C,A);E[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){E[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),E.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){E[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var I=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=60103,_=60106,w=60107,b=60108,x=60114,P=60109,v=60110,T=60112,M=60113,L=60120,D=60115,R=60116,F=60121,N=60128,B=60129,k=60130,O=60131;if("function"==typeof Symbol&&Symbol.for){var G=Symbol.for;S=G("react.element"),_=G("react.portal"),w=G("react.fragment"),b=G("react.strict_mode"),x=G("react.profiler"),P=G("react.provider"),v=G("react.context"),T=G("react.forward_ref"),M=G("react.suspense"),L=G("react.suspense_list"),D=G("react.memo"),R=G("react.lazy"),F=G("react.block"),G("react.scope"),N=G("react.opaque.id"),B=G("react.debug_trace_mode"),k=G("react.offscreen"),O=G("react.legacy_hidden")}var X,V="function"==typeof Symbol&&Symbol.iterator;function H(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=V&&e[V]||e["@@iterator"])?e:null}function U(e){if(void 0===X)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);X=t&&t[1]||""}return"\n"+X+e}var W=!1;function j(e,t){if(!e||W)return"";W=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(e){if(e&&r&&"string"==typeof e.stack){for(var i=e.stack.split("\n"),l=r.stack.split("\n"),s=i.length-1,o=l.length-1;1<=s&&0<=o&&i[s]!==l[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==l[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==l[o])return"\n"+i[s].replace(" at new "," at ")}while(1<=s&&0<=o);break}}}finally{W=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function z(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 22:return e=j(e.type._render,!1);case 1:return e=j(e.type,!0);default:return""}}function Y(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case w:return"Fragment";case _:return"Portal";case x:return"Profiler";case b:return"StrictMode";case M:return"Suspense";case L:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case v:return(e.displayName||"Context")+".Consumer";case P:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case D:return Y(e.type);case F:return Y(e._render);case R:t=e._payload,e=e._init;try{return Y(e(t))}catch(e){}}return null}function Q(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,l.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Z(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=Q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ie(e,t.type,n):t.hasOwnProperty("defaultValue")&&ie(e,t.type,Q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ie(e,t,n){"number"===t&&Z(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function le(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function se(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Q(n)}}function ue(e,t){var n=Q(t.value),r=Q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function he(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var de="http://www.w3.org/1999/xhtml",ce="http://www.w3.org/2000/svg";function pe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?pe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ge,me=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e}((function(e,t){if(e.namespaceURI!==ce||"innerHTML"in e)e.innerHTML=t;else{for((ge=ge||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ge.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function Ee(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Ce={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ae=["Webkit","ms","Moz","O"];function ye(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||Ce.hasOwnProperty(e)&&Ce[e]?(""+t).trim():t+"px"}function Ie(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ye(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(Ce).forEach((function(e){Ae.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ce[t]=Ce[e]}))}));var Se=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(Se[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(s(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Pe=null,ve=null;function Te(e){if(e=Zr(e)){if("function"!=typeof xe)throw Error(s(280));var t=e.stateNode;t&&(t=ei(t),xe(e.stateNode,e.type,t))}}function Me(e){Pe?ve?ve.push(e):ve=[e]:Pe=e}function Le(){if(Pe){var e=Pe,t=ve;if(ve=Pe=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function De(e,t){return e(t)}function Re(e,t,n,r,i){return e(t,n,r,i)}function Fe(){}var Ne=De,Be=!1,ke=!1;function Oe(){null===Pe&&null===ve||(Fe(),Le())}function Ge(e,t){var n=e.stateNode;if(null===n)return null;var r=ei(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(s(231,t,typeof n));return n}var Xe=!1;if(d)try{var Ve={};Object.defineProperty(Ve,"passive",{get:function(){Xe=!0}}),window.addEventListener("test",Ve,Ve),window.removeEventListener("test",Ve,Ve)}catch(e){Xe=!1}function He(e,t,n,r,i,l,s,o,a){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(e){this.onError(e)}}var Ue=!1,We=null,je=!1,ze=null,Ye={onError:function(e){Ue=!0,We=e}};function Qe(e,t,n,r,i,l,s,o,a){Ue=!1,We=null,He.apply(Ye,arguments)}function Ke(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Je(e){if(Ke(e)!==e)throw Error(s(188))}function Ze(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ke(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var l=i.alternate;if(null===l){if(null!==(r=i.return)){n=r;continue}break}if(i.child===l.child){for(l=i.child;l;){if(l===n)return Je(i),e;if(l===r)return Je(i),t;l=l.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=l;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=l;break}if(a===r){o=!0,r=i,n=l;break}a=a.sibling}if(!o){for(a=l.child;a;){if(a===n){o=!0,n=l,r=i;break}if(a===r){o=!0,r=l,n=i;break}a=a.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function $e(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var et,tt,nt,rt,it=!1,lt=[],st=null,ot=null,at=null,ut=new Map,ht=new Map,dt=[],ct="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pt(e,t,n,r,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function ft(e,t){switch(e){case"focusin":case"focusout":st=null;break;case"dragenter":case"dragleave":ot=null;break;case"mouseover":case"mouseout":at=null;break;case"pointerover":case"pointerout":ut.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ht.delete(t.pointerId)}}function gt(e,t,n,r,i,l){return null===e||e.nativeEvent!==l?(e=pt(t,n,r,i,l),null!==t&&(null!==(t=Zr(t))&&tt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function mt(e){var t=Jr(e.target);if(null!==t){var n=Ke(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void rt(e.lanePriority,(function(){l.unstable_runWithPriority(e.priority,(function(){nt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Et(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Zr(n))&&tt(t),e.blockedOn=n,!1;t.shift()}return!0}function Ct(e,t,n){Et(e)&&n.delete(t)}function At(){for(it=!1;0<lt.length;){var e=lt[0];if(null!==e.blockedOn){null!==(e=Zr(e.blockedOn))&&et(e);break}for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&lt.shift()}null!==st&&Et(st)&&(st=null),null!==ot&&Et(ot)&&(ot=null),null!==at&&Et(at)&&(at=null),ut.forEach(Ct),ht.forEach(Ct)}function yt(e,t){e.blockedOn===t&&(e.blockedOn=null,it||(it=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,At)))}function It(e){function t(t){return yt(t,e)}if(0<lt.length){yt(lt[0],e);for(var n=1;n<lt.length;n++){var r=lt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==st&&yt(st,e),null!==ot&&yt(ot,e),null!==at&&yt(at,e),ut.forEach(t),ht.forEach(t),n=0;n<dt.length;n++)(r=dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<dt.length&&null===(n=dt[0]).blockedOn;)mt(n),null===n.blockedOn&&dt.shift()}function St(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _t={animationend:St("Animation","AnimationEnd"),animationiteration:St("Animation","AnimationIteration"),animationstart:St("Animation","AnimationStart"),transitionend:St("Transition","TransitionEnd")},wt={},bt={};function xt(e){if(wt[e])return wt[e];if(!_t[e])return e;var t,n=_t[e];for(t in n)if(n.hasOwnProperty(t)&&t in bt)return wt[e]=n[t];return e}d&&(bt=document.createElement("div").style,"AnimationEvent"in window||(delete _t.animationend.animation,delete _t.animationiteration.animation,delete _t.animationstart.animation),"TransitionEvent"in window||delete _t.transitionend.transition);var Pt=xt("animationend"),vt=xt("animationiteration"),Tt=xt("animationstart"),Mt=xt("transitionend"),Lt=new Map,Dt=new Map,Rt=["abort","abort",Pt,"animationEnd",vt,"animationIteration",Tt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Mt,"transitionEnd","waiting","waiting"];function Ft(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),Dt.set(r,t),Lt.set(r,i),u(i,[r])}}(0,l.unstable_now)();var Nt=8;function Bt(e){if(0!=(1&e))return Nt=15,1;if(0!=(2&e))return Nt=14,2;if(0!=(4&e))return Nt=13,4;var t=24&e;return 0!==t?(Nt=12,t):0!=(32&e)?(Nt=11,32):0!==(t=192&e)?(Nt=10,t):0!=(256&e)?(Nt=9,256):0!==(t=3584&e)?(Nt=8,t):0!=(4096&e)?(Nt=7,4096):0!==(t=4186112&e)?(Nt=6,t):0!==(t=62914560&e)?(Nt=5,t):67108864&e?(Nt=4,67108864):0!=(134217728&e)?(Nt=3,134217728):0!==(t=805306368&e)?(Nt=2,t):0!=(1073741824&e)?(Nt=1,1073741824):(Nt=8,e)}function kt(e,t){var n=e.pendingLanes;if(0===n)return Nt=0;var r=0,i=0,l=e.expiredLanes,s=e.suspendedLanes,o=e.pingedLanes;if(0!==l)r=l,i=Nt=15;else if(0!==(l=134217727&n)){var a=l&~s;0!==a?(r=Bt(a),i=Nt):0!==(o&=l)&&(r=Bt(o),i=Nt)}else 0!==(l=n&~s)?(r=Bt(l),i=Nt):0!==o&&(r=Bt(o),i=Nt);if(0===r)return 0;if(r=n&((0>(r=31-Ut(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0==(t&s)){if(Bt(t),i<=Nt)return t;Nt=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-Ut(t)),r|=e[n],t&=~i;return r}function Ot(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Gt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Xt(24&~t))?Gt(10,t):e;case 10:return 0===(e=Xt(192&~t))?Gt(8,t):e;case 8:return 0===(e=Xt(3584&~t))&&(0===(e=Xt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=Xt(805306368&~t))&&(t=268435456),t}throw Error(s(358,e))}function Xt(e){return e&-e}function Vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ht(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-Ut(t)]=n}var Ut=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Wt(e)/jt|0)|0},Wt=Math.log,jt=Math.LN2;var zt=l.unstable_UserBlockingPriority,Yt=l.unstable_runWithPriority,Qt=!0;function Kt(e,t,n,r){Be||Fe();var i=Jt,l=Be;Be=!0;try{Re(i,e,t,n,r)}finally{(Be=l)||Oe()}}function qt(e,t,n,r){Yt(zt,Jt.bind(null,e,t,n,r))}function Jt(e,t,n,r){var i;if(Qt)if((i=0==(4&t))&&0<lt.length&&-1<ct.indexOf(e))e=pt(null,e,t,n,r),lt.push(e);else{var l=Zt(e,t,n,r);if(null===l)i&&ft(e,r);else{if(i){if(-1<ct.indexOf(e))return e=pt(l,e,t,n,r),void lt.push(e);if(function(e,t,n,r,i){switch(t){case"focusin":return st=gt(st,e,t,n,r,i),!0;case"dragenter":return ot=gt(ot,e,t,n,r,i),!0;case"mouseover":return at=gt(at,e,t,n,r,i),!0;case"pointerover":var l=i.pointerId;return ut.set(l,gt(ut.get(l)||null,e,t,n,r,i)),!0;case"gotpointercapture":return l=i.pointerId,ht.set(l,gt(ht.get(l)||null,e,t,n,r,i)),!0}return!1}(l,e,t,n,r))return;ft(e,r)}Mr(e,t,r,null,n)}}}function Zt(e,t,n,r){var i=be(r);if(null!==(i=Jr(i))){var l=Ke(i);if(null===l)i=null;else{var s=l.tag;if(13===s){if(null!==(i=qe(l)))return i;i=null}else if(3===s){if(l.stateNode.hydrate)return 3===l.tag?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null)}}return Mr(e,t,r,i,n),null}var $t=null,en=null,tn=null;function nn(){if(tn)return tn;var e,t,n=en,r=n.length,i="value"in $t?$t.value:$t.textContent,l=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[l-t];t++);return tn=i.slice(e,1<t?1-t:void 0)}function rn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ln(){return!0}function sn(){return!1}function on(e){function t(t,n,r,i,l){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?ln:sn,this.isPropagationStopped=sn,this}return i(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ln)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ln)},persist:function(){},isPersistent:ln}),t}var an,un,hn,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(dn),pn=i({},dn,{view:0,detail:0}),fn=on(pn),gn=i({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==hn&&(hn&&"mousemove"===e.type?(an=e.screenX-hn.screenX,un=e.screenY-hn.screenY):un=an=0,hn=e),an)},movementY:function(e){return"movementY"in e?e.movementY:un}}),mn=on(gn),En=on(i({},gn,{dataTransfer:0})),Cn=on(i({},pn,{relatedTarget:0})),An=on(i({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=on(i({},dn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),In=on(i({},dn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function xn(){return bn}var Pn=on(i({},pn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=rn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?rn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?rn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),vn=on(i({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=on(i({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),Mn=on(i({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ln=on(i({},gn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Dn=[9,13,27,32],Rn=d&&"CompositionEvent"in window,Fn=null;d&&"documentMode"in document&&(Fn=document.documentMode);var Nn=d&&"TextEvent"in window&&!Fn,Bn=d&&(!Rn||Fn&&8<Fn&&11>=Fn),kn=String.fromCharCode(32),On=!1;function Gn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Un(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Wn(e,t,n,r){Me(r),0<(t=Dr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var jn=null,zn=null;function Yn(e){wr(e,0)}function Qn(e){if(J($r(e)))return e}function Kn(e,t){if("change"===e)return t}var qn=!1;if(d){var Jn;if(d){var Zn="oninput"in document;if(!Zn){var $n=document.createElement("div");$n.setAttribute("oninput","return;"),Zn="function"==typeof $n.oninput}Jn=Zn}else Jn=!1;qn=Jn&&(!document.documentMode||9<document.documentMode)}function er(){jn&&(jn.detachEvent("onpropertychange",tr),zn=jn=null)}function tr(e){if("value"===e.propertyName&&Qn(zn)){var t=[];if(Wn(t,zn,e,be(e)),e=Yn,Be)e(t);else{Be=!0;try{De(e,t)}finally{Be=!1,Oe()}}}}function nr(e,t,n){"focusin"===e?(er(),zn=n,(jn=t).attachEvent("onpropertychange",tr)):"focusout"===e&&er()}function rr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(zn)}function ir(e,t){if("click"===e)return Qn(t)}function lr(e,t){if("input"===e||"change"===e)return Qn(t)}var sr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},or=Object.prototype.hasOwnProperty;function ar(e,t){if(sr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!or.call(t,n[r])||!sr(e[n[r]],t[n[r]]))return!1;return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=Z((e=t.contentWindow).document)}return t}function cr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var pr=d&&"documentMode"in document&&11>=document.documentMode,fr=null,gr=null,mr=null,Er=!1;function Cr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Er||null==fr||fr!==Z(r)||("selectionStart"in(r=fr)&&cr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},mr&&ar(mr,r)||(mr=r,0<(r=Dr(gr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=fr)))}Ft("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ft("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ft(Rt,2);for(var Ar="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),yr=0;yr<Ar.length;yr++)Dt.set(Ar[yr],0);h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ir="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ir));function _r(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,l,o,a,u){if(Qe.apply(this,arguments),Ue){if(!Ue)throw Error(s(198));var h=We;Ue=!1,We=null,je||(je=!0,ze=h)}}(r,t,void 0,e),e.currentTarget=null}function wr(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],a=o.instance,u=o.currentTarget;if(o=o.listener,a!==l&&i.isPropagationStopped())break e;_r(i,o,u),l=a}else for(s=0;s<r.length;s++){if(a=(o=r[s]).instance,u=o.currentTarget,o=o.listener,a!==l&&i.isPropagationStopped())break e;_r(i,o,u),l=a}}}if(je)throw e=ze,je=!1,ze=null,e}function br(e,t){var n=ti(t),r=e+"__bubble";n.has(r)||(Tr(t,e,2,!1),n.add(r))}var xr="_reactListening"+Math.random().toString(36).slice(2);function Pr(e){e[xr]||(e[xr]=!0,o.forEach((function(t){Sr.has(t)||vr(t,!1,e,null),vr(t,!0,e,null)})))}function vr(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,l=n;if("selectionchange"===e&&9!==n.nodeType&&(l=n.ownerDocument),null!==r&&!t&&Sr.has(e)){if("scroll"!==e)return;i|=2,l=r}var s=ti(l),o=e+"__"+(t?"capture":"bubble");s.has(o)||(t&&(i|=4),Tr(l,e,i,t),s.add(o))}function Tr(e,t,n,r){var i=Dt.get(t);switch(void 0===i?2:i){case 0:i=Kt;break;case 1:i=qt;break;default:i=Jt}n=i.bind(null,t,n,e),i=void 0,!Xe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Mr(e,t,n,r,i){var l=r;if(0==(1&t)&&0==(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var a=s.tag;if((3===a||4===a)&&((a=s.stateNode.containerInfo)===i||8===a.nodeType&&a.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=Jr(o)))return;if(5===(a=s.tag)||6===a){r=l=s;continue e}o=o.parentNode}}r=r.return}!function(e,t,n){if(ke)return e(t,n);ke=!0;try{Ne(e,t,n)}finally{ke=!1,Oe()}}((function(){var r=l,i=be(n),s=[];e:{var o=Lt.get(e);if(void 0!==o){var a=cn,u=e;switch(e){case"keypress":if(0===rn(n))break e;case"keydown":case"keyup":a=Pn;break;case"focusin":u="focus",a=Cn;break;case"focusout":u="blur",a=Cn;break;case"beforeblur":case"afterblur":a=Cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":a=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":a=En;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":a=Tn;break;case Pt:case vt:case Tt:a=An;break;case Mt:a=Mn;break;case"scroll":a=fn;break;case"wheel":a=Ln;break;case"copy":case"cut":case"paste":a=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":a=vn}var h=0!=(4&t),d=!h&&"scroll"===e,c=h?null!==o?o+"Capture":null:o;h=[];for(var p,f=r;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==c&&(null!=(g=Ge(f,c))&&h.push(Lr(f,g,p)))),d)break;f=f.return}0<h.length&&(o=new a(o,u,null,n,i),s.push({event:o,listeners:h}))}}if(0==(7&t)){if(a="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||0!=(16&t)||!(u=n.relatedTarget||n.fromElement)||!Jr(u)&&!u[Kr])&&(a||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,a?(a=r,null!==(u=(u=n.relatedTarget||n.toElement)?Jr(u):null)&&(u!==(d=Ke(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(a=null,u=r),a!==u)){if(h=mn,g="onMouseLeave",c="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(h=vn,g="onPointerLeave",c="onPointerEnter",f="pointer"),d=null==a?o:$r(a),p=null==u?o:$r(u),(o=new h(g,f+"leave",a,n,i)).target=d,o.relatedTarget=p,g=null,Jr(i)===r&&((h=new h(c,f+"enter",u,n,i)).target=p,h.relatedTarget=d,g=h),d=g,a&&u)e:{for(c=u,f=0,p=h=a;p;p=Rr(p))f++;for(p=0,g=c;g;g=Rr(g))p++;for(;0<f-p;)h=Rr(h),f--;for(;0<p-f;)c=Rr(c),p--;for(;f--;){if(h===c||null!==c&&h===c.alternate)break e;h=Rr(h),c=Rr(c)}h=null}else h=null;null!==a&&Fr(s,o,a,h,!1),null!==u&&null!==d&&Fr(s,d,u,h,!0)}if("select"===(a=(o=r?$r(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===a&&"file"===o.type)var m=Kn;else if(Un(o))if(qn)m=lr;else{m=rr;var E=nr}else(a=o.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=ir);switch(m&&(m=m(e,r))?Wn(s,m,n,i):(E&&E(e,o,r),"focusout"===e&&(E=o._wrapperState)&&E.controlled&&"number"===o.type&&ie(o,"number",o.value)),E=r?$r(r):window,e){case"focusin":(Un(E)||"true"===E.contentEditable)&&(fr=E,gr=r,mr=null);break;case"focusout":mr=gr=fr=null;break;case"mousedown":Er=!0;break;case"contextmenu":case"mouseup":case"dragend":Er=!1,Cr(s,n,i);break;case"selectionchange":if(pr)break;case"keydown":case"keyup":Cr(s,n,i)}var C;if(Rn)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Vn?Gn(e,n)&&(A="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(A="onCompositionStart");A&&(Bn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==A?"onCompositionEnd"===A&&Vn&&(C=nn()):(en="value"in($t=i)?$t.value:$t.textContent,Vn=!0)),0<(E=Dr(r,A)).length&&(A=new In(A,e,null,n,i),s.push({event:A,listeners:E}),C?A.data=C:null!==(C=Xn(n))&&(A.data=C))),(C=Nn?function(e,t){switch(e){case"compositionend":return Xn(t);case"keypress":return 32!==t.which?null:(On=!0,kn);case"textInput":return(e=t.data)===kn&&On?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Rn&&Gn(e,t)?(e=nn(),tn=en=$t=null,Vn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))&&(0<(r=Dr(r,"onBeforeInput")).length&&(i=new In("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=C))}wr(s,t)}))}function Lr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Dr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,l=i.stateNode;5===i.tag&&null!==l&&(i=l,null!=(l=Ge(e,n))&&r.unshift(Lr(e,l,i)),null!=(l=Ge(e,t))&&r.push(Lr(e,l,i))),e=e.return}return r}function Rr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Fr(e,t,n,r,i){for(var l=t._reactName,s=[];null!==n&&n!==r;){var o=n,a=o.alternate,u=o.stateNode;if(null!==a&&a===r)break;5===o.tag&&null!==u&&(o=u,i?null!=(a=Ge(n,l))&&s.unshift(Lr(n,a,o)):i||null!=(a=Ge(n,l))&&s.push(Lr(n,a,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}function Nr(){}var Br=null,kr=null;function Or(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Gr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Xr="function"==typeof setTimeout?setTimeout:void 0,Vr="function"==typeof clearTimeout?clearTimeout:void 0;function Hr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Ur(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Wr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var jr=0;var zr=Math.random().toString(36).slice(2),Yr="__reactFiber$"+zr,Qr="__reactProps$"+zr,Kr="__reactContainer$"+zr,qr="__reactEvents$"+zr;function Jr(e){var t=e[Yr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Kr]||n[Yr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Wr(e);null!==e;){if(n=e[Yr])return n;e=Wr(e)}return t}n=(e=n).parentNode}return null}function Zr(e){return!(e=e[Yr]||e[Kr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function $r(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function ei(e){return e[Qr]||null}function ti(e){var t=e[qr];return void 0===t&&(t=e[qr]=new Set),t}var ni=[],ri=-1;function ii(e){return{current:e}}function li(e){0>ri||(e.current=ni[ri],ni[ri]=null,ri--)}function si(e,t){ri++,ni[ri]=e.current,e.current=t}var oi={},ai=ii(oi),ui=ii(!1),hi=oi;function di(e,t){var n=e.type.contextTypes;if(!n)return oi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,l={};for(i in n)l[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function ci(e){return null!=(e=e.childContextTypes)}function pi(){li(ui),li(ai)}function fi(e,t,n){if(ai.current!==oi)throw Error(s(168));si(ai,t),si(ui,n)}function gi(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var l in r=r.getChildContext())if(!(l in e))throw Error(s(108,Y(t)||"Unknown",l));return i({},n,r)}function mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||oi,hi=ai.current,si(ai,e),si(ui,ui.current),!0}function Ei(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=gi(e,t,hi),r.__reactInternalMemoizedMergedChildContext=e,li(ui),li(ai),si(ai,e)):li(ui),si(ui,n)}var Ci=null,Ai=null,yi=l.unstable_runWithPriority,Ii=l.unstable_scheduleCallback,Si=l.unstable_cancelCallback,_i=l.unstable_shouldYield,wi=l.unstable_requestPaint,bi=l.unstable_now,xi=l.unstable_getCurrentPriorityLevel,Pi=l.unstable_ImmediatePriority,vi=l.unstable_UserBlockingPriority,Ti=l.unstable_NormalPriority,Mi=l.unstable_LowPriority,Li=l.unstable_IdlePriority,Di={},Ri=void 0!==wi?wi:function(){},Fi=null,Ni=null,Bi=!1,ki=bi(),Oi=1e4>ki?bi:function(){return bi()-ki};function Gi(){switch(xi()){case Pi:return 99;case vi:return 98;case Ti:return 97;case Mi:return 96;case Li:return 95;default:throw Error(s(332))}}function Xi(e){switch(e){case 99:return Pi;case 98:return vi;case 97:return Ti;case 96:return Mi;case 95:return Li;default:throw Error(s(332))}}function Vi(e,t){return e=Xi(e),yi(e,t)}function Hi(e,t,n){return e=Xi(e),Ii(e,t,n)}function Ui(){if(null!==Ni){var e=Ni;Ni=null,Si(e)}Wi()}function Wi(){if(!Bi&&null!==Fi){Bi=!0;var e=0;try{var t=Fi;Vi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Fi=null}catch(t){throw null!==Fi&&(Fi=Fi.slice(e+1)),Ii(Pi,Ui),t}finally{Bi=!1}}}var ji=I.ReactCurrentBatchConfig;function zi(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Yi=ii(null),Qi=null,Ki=null,qi=null;function Ji(){qi=Ki=Qi=null}function Zi(e){var t=Yi.current;li(Yi),e.type._context._currentValue=t}function $i(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function el(e,t){Qi=e,qi=Ki=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(Ls=!0),e.firstContext=null)}function tl(e,t){if(qi!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(qi=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Ki){if(null===Qi)throw Error(s(308));Ki=t,Qi.dependencies={lanes:0,firstContext:t,responders:null}}else Ki=Ki.next=t;return e._currentValue}var nl=!1;function rl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function il(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ll(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function sl(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function ol(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,l=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===l?i=l=s:l=l.next=s,n=n.next}while(null!==n);null===l?i=l=t:l=l.next=t}else i=l=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:l,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function al(e,t,n,r){var l=e.updateQueue;nl=!1;var s=l.firstBaseUpdate,o=l.lastBaseUpdate,a=l.shared.pending;if(null!==a){l.shared.pending=null;var u=a,h=u.next;u.next=null,null===o?s=h:o.next=h,o=u;var d=e.alternate;if(null!==d){var c=(d=d.updateQueue).lastBaseUpdate;c!==o&&(null===c?d.firstBaseUpdate=h:c.next=h,d.lastBaseUpdate=u)}}if(null!==s){for(c=l.baseState,o=0,d=h=u=null;;){a=s.lane;var p=s.eventTime;if((r&a)===a){null!==d&&(d=d.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,g=s;switch(a=t,p=n,g.tag){case 1:if("function"==typeof(f=g.payload)){c=f.call(p,c,a);break e}c=f;break e;case 3:f.flags=-4097&f.flags|64;case 0:if(null==(a="function"==typeof(f=g.payload)?f.call(p,c,a):f))break e;c=i({},c,a);break e;case 2:nl=!0}}null!==s.callback&&(e.flags|=32,null===(a=l.effects)?l.effects=[s]:a.push(s))}else p={eventTime:p,lane:a,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(h=d=p,u=c):d=d.next=p,o|=a;if(null===(s=s.next)){if(null===(a=l.shared.pending))break;s=a.next,a.next=null,l.lastBaseUpdate=a,l.shared.pending=null}}null===d&&(u=c),l.baseState=u,l.firstBaseUpdate=h,l.lastBaseUpdate=d,Ro|=o,e.lanes=o,e.memoizedState=c}}function ul(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(s(191,i));i.call(r)}}}var hl=(new r.Component).refs;function dl(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var cl={isMounted:function(e){return!!(e=e._reactInternals)&&Ke(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ia(),i=la(e),l=ll(r,i);l.payload=t,null!=n&&(l.callback=n),sl(e,l),sa(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ia(),i=la(e),l=ll(r,i);l.tag=1,l.payload=t,null!=n&&(l.callback=n),sl(e,l),sa(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ia(),r=la(e),i=ll(n,r);i.tag=2,null!=t&&(i.callback=t),sl(e,i),sa(e,r,n)}};function pl(e,t,n,r,i,l,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,l,s):!t.prototype||!t.prototype.isPureReactComponent||(!ar(n,r)||!ar(i,l))}function fl(e,t,n){var r=!1,i=oi,l=t.contextType;return"object"==typeof l&&null!==l?l=tl(l):(i=ci(t)?hi:ai.current,l=(r=null!=(r=t.contextTypes))?di(e,i):oi),t=new t(n,l),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=cl,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=l),t}function gl(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&cl.enqueueReplaceState(t,t.state,null)}function ml(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=hl,rl(e);var l=t.contextType;"object"==typeof l&&null!==l?i.context=tl(l):(l=ci(t)?hi:ai.current,i.context=di(e,l)),al(e,n,i,r),i.state=e.memoizedState,"function"==typeof(l=t.getDerivedStateFromProps)&&(dl(e,t,l,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&cl.enqueueReplaceState(i,i.state,null),al(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4)}var El=Array.isArray;function Cl(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=r.refs;t===hl&&(t=r.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!=typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Al(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function yl(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Oa(e,t)).index=0,e.sibling=null,e}function l(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function o(t){return e&&null===t.alternate&&(t.flags=2),t}function a(e,t,n,r){return null===t||6!==t.tag?((t=Ha(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=Cl(e,t,n),r.return=e,r):((r=Ga(n.type,n.key,n.props,null,e.mode,r)).ref=Cl(e,t,n),r.return=e,r)}function h(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ua(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,l){return null===t||7!==t.tag?((t=Xa(n,e.mode,r,l)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Ha(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Ga(t.type,t.key,t.props,null,e.mode,n)).ref=Cl(e,null,t),n.return=e,n;case _:return(t=Ua(t,e.mode,n)).return=e,t}if(El(t)||H(t))return(t=Xa(t,e.mode,n,null)).return=e,t;Al(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:a(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===i?n.type===w?d(e,t,n.props.children,r,i):u(e,t,n,r):null;case _:return n.key===i?h(e,t,n,r):null}if(El(n)||H(n))return null!==i?null:d(e,t,n,r,null);Al(e,n)}return null}function f(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return a(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case S:return e=e.get(null===r.key?n:r.key)||null,r.type===w?d(t,e,r.props.children,i,r.key):u(t,e,r,i);case _:return h(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(El(r)||H(r))return d(t,e=e.get(n)||null,r,i,null);Al(t,r)}return null}function g(i,s,o,a){for(var u=null,h=null,d=s,g=s=0,m=null;null!==d&&g<o.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var E=p(i,d,o[g],a);if(null===E){null===d&&(d=m);break}e&&d&&null===E.alternate&&t(i,d),s=l(E,s,g),null===h?u=E:h.sibling=E,h=E,d=m}if(g===o.length)return n(i,d),u;if(null===d){for(;g<o.length;g++)null!==(d=c(i,o[g],a))&&(s=l(d,s,g),null===h?u=d:h.sibling=d,h=d);return u}for(d=r(i,d);g<o.length;g++)null!==(m=f(d,i,g,o[g],a))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),s=l(m,s,g),null===h?u=m:h.sibling=m,h=m);return e&&d.forEach((function(e){return t(i,e)})),u}function m(i,o,a,u){var h=H(a);if("function"!=typeof h)throw Error(s(150));if(null==(a=h.call(a)))throw Error(s(151));for(var d=h=null,g=o,m=o=0,E=null,C=a.next();null!==g&&!C.done;m++,C=a.next()){g.index>m?(E=g,g=null):E=g.sibling;var A=p(i,g,C.value,u);if(null===A){null===g&&(g=E);break}e&&g&&null===A.alternate&&t(i,g),o=l(A,o,m),null===d?h=A:d.sibling=A,d=A,g=E}if(C.done)return n(i,g),h;if(null===g){for(;!C.done;m++,C=a.next())null!==(C=c(i,C.value,u))&&(o=l(C,o,m),null===d?h=C:d.sibling=C,d=C);return h}for(g=r(i,g);!C.done;m++,C=a.next())null!==(C=f(g,i,m,C.value,u))&&(e&&null!==C.alternate&&g.delete(null===C.key?m:C.key),o=l(C,o,m),null===d?h=C:d.sibling=C,d=C);return e&&g.forEach((function(e){return t(i,e)})),h}return function(e,r,l,a){var u="object"==typeof l&&null!==l&&l.type===w&&null===l.key;u&&(l=l.props.children);var h="object"==typeof l&&null!==l;if(h)switch(l.$$typeof){case S:e:{for(h=l.key,u=r;null!==u;){if(u.key===h){switch(u.tag){case 7:if(l.type===w){n(e,u.sibling),(r=i(u,l.props.children)).return=e,e=r;break e}break;default:if(u.elementType===l.type){n(e,u.sibling),(r=i(u,l.props)).ref=Cl(e,u,l),r.return=e,e=r;break e}}n(e,u);break}t(e,u),u=u.sibling}l.type===w?((r=Xa(l.props.children,e.mode,a,l.key)).return=e,e=r):((a=Ga(l.type,l.key,l.props,null,e.mode,a)).ref=Cl(e,r,l),a.return=e,e=a)}return o(e);case _:e:{for(u=l.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===l.containerInfo&&r.stateNode.implementation===l.implementation){n(e,r.sibling),(r=i(r,l.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Ua(l,e.mode,a)).return=e,e=r}return o(e)}if("string"==typeof l||"number"==typeof l)return l=""+l,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,l)).return=e,e=r):(n(e,r),(r=Ha(l,e.mode,a)).return=e,e=r),o(e);if(El(l))return g(e,r,l,a);if(H(l))return m(e,r,l,a);if(h&&Al(e,l),void 0===l&&!u)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,Y(e.type)||"Component"))}return n(e,r)}}var Il=yl(!0),Sl=yl(!1),_l={},wl=ii(_l),bl=ii(_l),xl=ii(_l);function Pl(e){if(e===_l)throw Error(s(174));return e}function vl(e,t){switch(si(xl,t),si(bl,e),si(wl,_l),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:fe(null,"");break;default:t=fe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}li(wl),si(wl,t)}function Tl(){li(wl),li(bl),li(xl)}function Ml(e){Pl(xl.current);var t=Pl(wl.current),n=fe(t,e.type);t!==n&&(si(bl,e),si(wl,n))}function Ll(e){bl.current===e&&(li(wl),li(bl))}var Dl=ii(0);function Rl(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fl=null,Nl=null,Bl=!1;function kl(e,t){var n=Ba(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Ol(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Gl(e){if(Bl){var t=Nl;if(t){var n=t;if(!Ol(e,t)){if(!(t=Ur(n.nextSibling))||!Ol(e,t))return e.flags=-1025&e.flags|2,Bl=!1,void(Fl=e);kl(Fl,n)}Fl=e,Nl=Ur(t.firstChild)}else e.flags=-1025&e.flags|2,Bl=!1,Fl=e}}function Xl(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Fl=e}function Vl(e){if(e!==Fl)return!1;if(!Bl)return Xl(e),Bl=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Gr(t,e.memoizedProps))for(t=Nl;t;)kl(e,t),t=Ur(t.nextSibling);if(Xl(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Nl=Ur(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Nl=null}}else Nl=Fl?Ur(e.stateNode.nextSibling):null;return!0}function Hl(){Nl=Fl=null,Bl=!1}var Ul=[];function Wl(){for(var e=0;e<Ul.length;e++)Ul[e]._workInProgressVersionPrimary=null;Ul.length=0}var jl=I.ReactCurrentDispatcher,zl=I.ReactCurrentBatchConfig,Yl=0,Ql=null,Kl=null,ql=null,Jl=!1,Zl=!1;function $l(){throw Error(s(321))}function es(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ts(e,t,n,r,i,l){if(Yl=l,Ql=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,jl.current=null===e||null===e.memoizedState?Ps:vs,e=n(r,i),Zl){l=0;do{if(Zl=!1,!(25>l))throw Error(s(301));l+=1,ql=Kl=null,t.updateQueue=null,jl.current=Ts,e=n(r,i)}while(Zl)}if(jl.current=xs,t=null!==Kl&&null!==Kl.next,Yl=0,ql=Kl=Ql=null,Jl=!1,t)throw Error(s(300));return e}function ns(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ql?Ql.memoizedState=ql=e:ql=ql.next=e,ql}function rs(){if(null===Kl){var e=Ql.alternate;e=null!==e?e.memoizedState:null}else e=Kl.next;var t=null===ql?Ql.memoizedState:ql.next;if(null!==t)ql=t,Kl=e;else{if(null===e)throw Error(s(310));e={memoizedState:(Kl=e).memoizedState,baseState:Kl.baseState,baseQueue:Kl.baseQueue,queue:Kl.queue,next:null},null===ql?Ql.memoizedState=ql=e:ql=ql.next=e}return ql}function is(e,t){return"function"==typeof t?t(e):t}function ls(e){var t=rs(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=Kl,i=r.baseQueue,l=n.pending;if(null!==l){if(null!==i){var o=i.next;i.next=l.next,l.next=o}r.baseQueue=i=l,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var a=o=l=null,u=i;do{var h=u.lane;if((Yl&h)===h)null!==a&&(a=a.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===e?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===a?(o=a=d,l=r):a=a.next=d,Ql.lanes|=h,Ro|=h}u=u.next}while(null!==u&&u!==i);null===a?l=r:a.next=o,sr(r,t.memoizedState)||(Ls=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=a,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function ss(e){var t=rs(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,l=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{l=e(l,o.action),o=o.next}while(o!==i);sr(l,t.memoizedState)||(Ls=!0),t.memoizedState=l,null===t.baseQueue&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function os(e,t,n){var r=t._getVersion;r=r(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(Yl&e)===e)&&(t._workInProgressVersionPrimary=r,Ul.push(t))),e)return n(t._source);throw Ul.push(t),Error(s(350))}function as(e,t,n,r){var i=bo;if(null===i)throw Error(s(349));var l=t._getVersion,o=l(t._source),a=jl.current,u=a.useState((function(){return os(i,t,n)})),h=u[1],d=u[0];u=ql;var c=e.memoizedState,p=c.refs,f=p.getSnapshot,g=c.source;c=c.subscribe;var m=Ql;return e.memoizedState={refs:p,source:t,subscribe:r},a.useEffect((function(){p.getSnapshot=n,p.setSnapshot=h;var e=l(t._source);if(!sr(o,e)){e=n(t._source),sr(d,e)||(h(e),e=la(m),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,s=e;0<s;){var a=31-Ut(s),u=1<<a;r[a]|=e,s&=~u}}}),[n,t,r]),a.useEffect((function(){return r(t._source,(function(){var e=p.getSnapshot,n=p.setSnapshot;try{n(e(t._source));var r=la(m);i.mutableReadLanes|=r&i.pendingLanes}catch(e){n((function(){throw e}))}}))}),[t,r]),sr(f,n)&&sr(g,t)&&sr(c,r)||((e={pending:null,dispatch:null,lastRenderedReducer:is,lastRenderedState:d}).dispatch=h=bs.bind(null,Ql,e),u.queue=e,u.baseQueue=null,d=os(i,t,n),u.memoizedState=u.baseState=d),d}function us(e,t,n){return as(rs(),e,t,n)}function hs(e){var t=ns();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:is,lastRenderedState:e}).dispatch=bs.bind(null,Ql,e),[t.memoizedState,e]}function ds(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Ql.updateQueue)?(t={lastEffect:null},Ql.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function cs(e){return e={current:e},ns().memoizedState=e}function ps(){return rs().memoizedState}function fs(e,t,n,r){var i=ns();Ql.flags|=e,i.memoizedState=ds(1|t,n,void 0,void 0===r?null:r)}function gs(e,t,n,r){var i=rs();r=void 0===r?null:r;var l=void 0;if(null!==Kl){var s=Kl.memoizedState;if(l=s.destroy,null!==r&&es(r,s.deps))return void ds(t,n,l,r)}Ql.flags|=e,i.memoizedState=ds(1|t,n,l,r)}function ms(e,t){return fs(516,4,e,t)}function Es(e,t){return gs(516,4,e,t)}function Cs(e,t){return gs(4,2,e,t)}function As(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ys(e,t,n){return n=null!=n?n.concat([e]):null,gs(4,2,As.bind(null,t,e),n)}function Is(){}function Ss(e,t){var n=rs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&es(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function _s(e,t){var n=rs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&es(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ws(e,t){var n=Gi();Vi(98>n?98:n,(function(){e(!0)})),Vi(97<n?97:n,(function(){var n=zl.transition;zl.transition=1;try{e(!1),t()}finally{zl.transition=n}}))}function bs(e,t,n){var r=ia(),i=la(e),l={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},s=t.pending;if(null===s?l.next=l:(l.next=s.next,s.next=l),t.pending=l,s=e.alternate,e===Ql||null!==s&&s===Ql)Zl=Jl=!0;else{if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(l.eagerReducer=s,l.eagerState=a,sr(a,o))return}catch(e){}sa(e,i,r)}}var xs={readContext:tl,useCallback:$l,useContext:$l,useEffect:$l,useImperativeHandle:$l,useLayoutEffect:$l,useMemo:$l,useReducer:$l,useRef:$l,useState:$l,useDebugValue:$l,useDeferredValue:$l,useTransition:$l,useMutableSource:$l,useOpaqueIdentifier:$l,unstable_isNewReconciler:!1},Ps={readContext:tl,useCallback:function(e,t){return ns().memoizedState=[e,void 0===t?null:t],e},useContext:tl,useEffect:ms,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,fs(4,2,As.bind(null,t,e),n)},useLayoutEffect:function(e,t){return fs(4,2,e,t)},useMemo:function(e,t){var n=ns();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ns();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=bs.bind(null,Ql,e),[r.memoizedState,e]},useRef:cs,useState:hs,useDebugValue:Is,useDeferredValue:function(e){var t=hs(e),n=t[0],r=t[1];return ms((function(){var t=zl.transition;zl.transition=1;try{r(e)}finally{zl.transition=t}}),[e]),n},useTransition:function(){var e=hs(!1),t=e[0];return cs(e=ws.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=ns();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},as(r,e,t,n)},useOpaqueIdentifier:function(){if(Bl){var e=!1,t=function(e){return{$$typeof:N,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(jr++).toString(36))),Error(s(355))})),n=hs(t)[1];return 0==(2&Ql.mode)&&(Ql.flags|=516,ds(5,(function(){n("r:"+(jr++).toString(36))}),void 0,null)),t}return hs(t="r:"+(jr++).toString(36)),t},unstable_isNewReconciler:!1},vs={readContext:tl,useCallback:Ss,useContext:tl,useEffect:Es,useImperativeHandle:ys,useLayoutEffect:Cs,useMemo:_s,useReducer:ls,useRef:ps,useState:function(){return ls(is)},useDebugValue:Is,useDeferredValue:function(e){var t=ls(is),n=t[0],r=t[1];return Es((function(){var t=zl.transition;zl.transition=1;try{r(e)}finally{zl.transition=t}}),[e]),n},useTransition:function(){var e=ls(is)[0];return[ps().current,e]},useMutableSource:us,useOpaqueIdentifier:function(){return ls(is)[0]},unstable_isNewReconciler:!1},Ts={readContext:tl,useCallback:Ss,useContext:tl,useEffect:Es,useImperativeHandle:ys,useLayoutEffect:Cs,useMemo:_s,useReducer:ss,useRef:ps,useState:function(){return ss(is)},useDebugValue:Is,useDeferredValue:function(e){var t=ss(is),n=t[0],r=t[1];return Es((function(){var t=zl.transition;zl.transition=1;try{r(e)}finally{zl.transition=t}}),[e]),n},useTransition:function(){var e=ss(is)[0];return[ps().current,e]},useMutableSource:us,useOpaqueIdentifier:function(){return ss(is)[0]},unstable_isNewReconciler:!1},Ms=I.ReactCurrentOwner,Ls=!1;function Ds(e,t,n,r){t.child=null===e?Sl(t,null,n,r):Il(t,e.child,n,r)}function Rs(e,t,n,r,i){n=n.render;var l=t.ref;return el(t,i),r=ts(e,t,n,r,l,i),null===e||Ls?(t.flags|=1,Ds(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,$s(e,t,i))}function Fs(e,t,n,r,i,l){if(null===e){var s=n.type;return"function"!=typeof s||ka(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ga(n.type,null,r,t,t.mode,l)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ns(e,t,s,r,i,l))}return s=e.child,0==(i&l)&&(i=s.memoizedProps,(n=null!==(n=n.compare)?n:ar)(i,r)&&e.ref===t.ref)?$s(e,t,l):(t.flags|=1,(e=Oa(s,r)).ref=t.ref,e.return=t,t.child=e)}function Ns(e,t,n,r,i,l){if(null!==e&&ar(e.memoizedProps,r)&&e.ref===t.ref){if(Ls=!1,0==(l&i))return t.lanes=e.lanes,$s(e,t,l);0!=(16384&e.flags)&&(Ls=!0)}return Os(e,t,n,r,l)}function Bs(e,t,n){var r=t.pendingProps,i=r.children,l=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0==(4&t.mode))t.memoizedState={baseLanes:0},fa(t,n);else{if(0==(1073741824&n))return e=null!==l?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},fa(t,e),null;t.memoizedState={baseLanes:0},fa(t,null!==l?l.baseLanes:n)}else null!==l?(r=l.baseLanes|n,t.memoizedState=null):r=n,fa(t,r);return Ds(e,t,i,n),t.child}function ks(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Os(e,t,n,r,i){var l=ci(n)?hi:ai.current;return l=di(t,l),el(t,i),n=ts(e,t,n,r,l,i),null===e||Ls?(t.flags|=1,Ds(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,$s(e,t,i))}function Gs(e,t,n,r,i){if(ci(n)){var l=!0;mi(t)}else l=!1;if(el(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),fl(t,n,r),ml(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var a=s.context,u=n.contextType;"object"==typeof u&&null!==u?u=tl(u):u=di(t,u=ci(n)?hi:ai.current);var h=n.getDerivedStateFromProps,d="function"==typeof h||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==r||a!==u)&&gl(t,s,r,u),nl=!1;var c=t.memoizedState;s.state=c,al(t,r,s,i),a=t.memoizedState,o!==r||c!==a||ui.current||nl?("function"==typeof h&&(dl(t,n,h,r),a=t.memoizedState),(o=nl||pl(t,n,o,r,c,a,u))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4)):("function"==typeof s.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=a),s.props=r,s.state=a,s.context=u,r=o):("function"==typeof s.componentDidMount&&(t.flags|=4),r=!1)}else{s=t.stateNode,il(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:zi(t.type,o),s.props=u,d=t.pendingProps,c=s.context,"object"==typeof(a=n.contextType)&&null!==a?a=tl(a):a=di(t,a=ci(n)?hi:ai.current);var p=n.getDerivedStateFromProps;(h="function"==typeof p||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==d||c!==a)&&gl(t,s,r,a),nl=!1,c=t.memoizedState,s.state=c,al(t,r,s,i);var f=t.memoizedState;o!==d||c!==f||ui.current||nl?("function"==typeof p&&(dl(t,n,p,r),f=t.memoizedState),(u=nl||pl(t,n,u,r,c,f,a))?(h||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,a),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,a)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&c===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&c===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=a,r=u):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&c===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&c===e.memoizedState||(t.flags|=256),r=!1)}return Xs(e,t,n,r,l,i)}function Xs(e,t,n,r,i,l){ks(e,t);var s=0!=(64&t.flags);if(!r&&!s)return i&&Ei(t,n,!1),$s(e,t,l);r=t.stateNode,Ms.current=t;var o=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Il(t,e.child,null,l),t.child=Il(t,null,o,l)):Ds(e,t,o,l),t.memoizedState=r.state,i&&Ei(t,n,!0),t.child}function Vs(e){var t=e.stateNode;t.pendingContext?fi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&fi(0,t.context,!1),vl(e,t.containerInfo)}var Hs,Us,Ws,js={dehydrated:null,retryLane:0};function zs(e,t,n){var r,i=t.pendingProps,l=Dl.current,s=!1;return(r=0!=(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!=(2&l)),r?(s=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(l|=1),si(Dl,1&l),null===e?(void 0!==i.fallback&&Gl(t),e=i.children,l=i.fallback,s?(e=Ys(t,e,l,n),t.child.memoizedState={baseLanes:n},t.memoizedState=js,e):"number"==typeof i.unstable_expectedLoadTime?(e=Ys(t,e,l,n),t.child.memoizedState={baseLanes:n},t.memoizedState=js,t.lanes=33554432,e):((n=Va({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,s?(i=Ks(e,t,i.children,i.fallback,n),s=t.child,l=e.child.memoizedState,s.memoizedState=null===l?{baseLanes:n}:{baseLanes:l.baseLanes|n},s.childLanes=e.childLanes&~n,t.memoizedState=js,i):(n=Qs(e,t,i.children,n),t.memoizedState=null,n))}function Ys(e,t,n,r){var i=e.mode,l=e.child;return t={mode:"hidden",children:t},0==(2&i)&&null!==l?(l.childLanes=0,l.pendingProps=t):l=Va(t,i,0,null),n=Xa(n,i,r,null),l.return=e,n.return=e,l.sibling=n,e.child=l,n}function Qs(e,t,n,r){var i=e.child;return e=i.sibling,n=Oa(i,{mode:"visible",children:n}),0==(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function Ks(e,t,n,r,i){var l=t.mode,s=e.child;e=s.sibling;var o={mode:"hidden",children:n};return 0==(2&l)&&t.child!==s?((n=t.child).childLanes=0,n.pendingProps=o,null!==(s=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=s,s.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Oa(s,o),null!==e?r=Oa(e,r):(r=Xa(r,l,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function qs(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),$i(e.return,t)}function Js(e,t,n,r,i,l){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:l}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i,s.lastEffect=l)}function Zs(e,t,n){var r=t.pendingProps,i=r.revealOrder,l=r.tail;if(Ds(e,t,r.children,n),0!=(2&(r=Dl.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!=(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qs(e,n);else if(19===e.tag)qs(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(si(Dl,r),0==(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Rl(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Js(t,!1,i,n,l,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Rl(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Js(t,!0,n,null,l,t.lastEffect);break;case"together":Js(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function $s(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ro|=t.lanes,0!=(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Oa(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oa(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function eo(e,t){if(!Bl)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function to(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return ci(t.type)&&pi(),null;case 3:return Tl(),li(ui),li(ai),Wl(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Vl(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Ll(t);var l=Pl(xl.current);if(n=t.type,null!==e&&null!=t.stateNode)Us(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=Pl(wl.current),Vl(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Yr]=t,r[Qr]=o,n){case"dialog":br("cancel",r),br("close",r);break;case"iframe":case"object":case"embed":br("load",r);break;case"video":case"audio":for(e=0;e<Ir.length;e++)br(Ir[e],r);break;case"source":br("error",r);break;case"img":case"image":case"link":br("error",r),br("load",r);break;case"details":br("toggle",r);break;case"input":ee(r,o),br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},br("invalid",r);break;case"textarea":ae(r,o),br("invalid",r)}for(var u in _e(n,o),e=null,o)o.hasOwnProperty(u)&&(l=o[u],"children"===u?"string"==typeof l?r.textContent!==l&&(e=["children",l]):"number"==typeof l&&r.textContent!==""+l&&(e=["children",""+l]):a.hasOwnProperty(u)&&null!=l&&"onScroll"===u&&br("scroll",r));switch(n){case"input":q(r),re(r,o,!0);break;case"textarea":q(r),he(r);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(r.onclick=Nr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(u=9===l.nodeType?l:l.ownerDocument,e===de&&(e=pe(n)),e===de?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[Yr]=t,e[Qr]=r,Hs(e,t),t.stateNode=e,u=we(n,r),n){case"dialog":br("cancel",e),br("close",e),l=r;break;case"iframe":case"object":case"embed":br("load",e),l=r;break;case"video":case"audio":for(l=0;l<Ir.length;l++)br(Ir[l],e);l=r;break;case"source":br("error",e),l=r;break;case"img":case"image":case"link":br("error",e),br("load",e),l=r;break;case"details":br("toggle",e),l=r;break;case"input":ee(e,r),l=$(e,r),br("invalid",e);break;case"option":l=le(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=i({},r,{value:void 0}),br("invalid",e);break;case"textarea":ae(e,r),l=oe(e,r),br("invalid",e);break;default:l=r}_e(n,l);var h=l;for(o in h)if(h.hasOwnProperty(o)){var d=h[o];"style"===o?Ie(e,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&me(e,d):"children"===o?"string"==typeof d?("textarea"!==n||""!==d)&&Ee(e,d):"number"==typeof d&&Ee(e,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=d&&"onScroll"===o&&br("scroll",e):null!=d&&y(e,o,d,u))}switch(n){case"input":q(e),re(e,r,!1);break;case"textarea":q(e),he(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?se(e,!!r.multiple,o,!1):null!=r.defaultValue&&se(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof l.onClick&&(e.onclick=Nr)}Or(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Ws(0,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(s(166));n=Pl(xl.current),Pl(wl.current),Vl(t)?(r=t.stateNode,n=t.memoizedProps,r[Yr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Yr]=t,t.stateNode=r)}return null;case 13:return li(Dl),r=t.memoizedState,0!=(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Vl(t):n=null!==e.memoizedState,r&&!n&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&Dl.current)?0===Mo&&(Mo=3):(0!==Mo&&3!==Mo||(Mo=4),null===bo||0==(134217727&Ro)&&0==(134217727&Fo)||ha(bo,Po))),(r||n)&&(t.flags|=4),null);case 4:return Tl(),null===e&&Pr(t.stateNode.containerInfo),null;case 10:return Zi(t),null;case 17:return ci(t.type)&&pi(),null;case 19:if(li(Dl),null===(r=t.memoizedState))return null;if(o=0!=(64&t.flags),null===(u=r.rendering))if(o)eo(r,!1);else{if(0!==Mo||null!==e&&0!=(64&e.flags))for(e=t.child;null!==e;){if(null!==(u=Rl(e))){for(t.flags|=64,eo(r,!1),null!==(o=u.updateQueue)&&(t.updateQueue=o,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return si(Dl,1&Dl.current|2),t.child}e=e.sibling}null!==r.tail&&Oi()>Oo&&(t.flags|=64,o=!0,eo(r,!1),t.lanes=33554432)}else{if(!o)if(null!==(e=Rl(u))){if(t.flags|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),eo(r,!0),null===r.tail&&"hidden"===r.tailMode&&!u.alternate&&!Bl)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Oi()-r.renderingStartTime>Oo&&1073741824!==n&&(t.flags|=64,o=!0,eo(r,!1),t.lanes=33554432);r.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=r.last)?n.sibling=u:t.child=u,r.last=u)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Oi(),n.sibling=null,t=Dl.current,si(Dl,o?1&t|2:1&t),n):null;case 23:case 24:return ga(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(s(156,t.tag))}function no(e){switch(e.tag){case 1:ci(e.type)&&pi();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Tl(),li(ui),li(ai),Wl(),0!=(64&(t=e.flags)))throw Error(s(285));return e.flags=-4097&t|64,e;case 5:return Ll(e),null;case 13:return li(Dl),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return li(Dl),null;case 4:return Tl(),null;case 10:return Zi(e),null;case 23:case 24:return ga(),null;default:return null}}function ro(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var i=n}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i}}Hs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Us=function(e,t,n,r){var l=e.memoizedProps;if(l!==r){e=t.stateNode,Pl(wl.current);var s,o=null;switch(n){case"input":l=$(e,l),r=$(e,r),o=[];break;case"option":l=le(e,l),r=le(e,r),o=[];break;case"select":l=i({},l,{value:void 0}),r=i({},r,{value:void 0}),o=[];break;case"textarea":l=oe(e,l),r=oe(e,r),o=[];break;default:"function"!=typeof l.onClick&&"function"==typeof r.onClick&&(e.onclick=Nr)}for(d in _e(n,r),n=null,l)if(!r.hasOwnProperty(d)&&l.hasOwnProperty(d)&&null!=l[d])if("style"===d){var u=l[d];for(s in u)u.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(a.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var h=r[d];if(u=null!=l?l[d]:void 0,r.hasOwnProperty(d)&&h!==u&&(null!=h||null!=u))if("style"===d)if(u){for(s in u)!u.hasOwnProperty(s)||h&&h.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in h)h.hasOwnProperty(s)&&u[s]!==h[s]&&(n||(n={}),n[s]=h[s])}else n||(o||(o=[]),o.push(d,n)),n=h;else"dangerouslySetInnerHTML"===d?(h=h?h.__html:void 0,u=u?u.__html:void 0,null!=h&&u!==h&&(o=o||[]).push(d,h)):"children"===d?"string"!=typeof h&&"number"!=typeof h||(o=o||[]).push(d,""+h):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(a.hasOwnProperty(d)?(null!=h&&"onScroll"===d&&br("scroll",e),o||u===h||(o=[])):"object"==typeof h&&null!==h&&h.$$typeof===N?h.toString():(o=o||[]).push(d,h))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}},Ws=function(e,t,n,r){n!==r&&(t.flags|=4)};var io="function"==typeof WeakMap?WeakMap:Map;function lo(e,t,n){(n=ll(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ho||(Ho=!0,Uo=r)},n}function so(e,t,n){(n=ll(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return r(i)}}var l=e.stateNode;return null!==l&&"function"==typeof l.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Wo?Wo=new Set([this]):Wo.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var oo="function"==typeof WeakSet?WeakSet:Set;function ao(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){Da(e,t)}else t.current=null}function uo(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:zi(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Hr(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(s(163))}function ho(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3==(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,0!=(4&(i=i.tag))&&0!=(1&i)&&(Ta(n,e),va(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:zi(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&ul(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}ul(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Or(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&It(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(s(163))}function co(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"==typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=null!=i&&i.hasOwnProperty("display")?i.display:null,r.style.display=ye("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function po(e,t){if(Ai&&"function"==typeof Ai.onCommitFiberUnmount)try{Ai.onCommitFiberUnmount(Ci,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!=(4&r))Ta(t,n);else{r=t;try{i()}catch(e){Da(r,e)}}n=n.next}while(n!==e)}break;case 1:if(ao(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Da(t,e)}break;case 5:ao(t);break;case 4:Eo(e,t)}}function fo(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function go(e){return 5===e.tag||3===e.tag||4===e.tag}function mo(e){e:{for(var t=e.return;null!==t;){if(go(t))break e;t=t.return}throw Error(s(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.flags&&(Ee(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||go(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?function e(t,n,r){var i=t.tag,l=5===i||6===i;if(l)t=l?t.stateNode:t.stateNode.instance,n?8===r.nodeType?r.parentNode.insertBefore(t,n):r.insertBefore(t,n):(8===r.nodeType?(n=r.parentNode).insertBefore(t,r):(n=r).appendChild(t),null!==(r=r._reactRootContainer)&&void 0!==r||null!==n.onclick||(n.onclick=Nr));else if(4!==i&&null!==(t=t.child))for(e(t,n,r),t=t.sibling;null!==t;)e(t,n,r),t=t.sibling}(e,n,t):function e(t,n,r){var i=t.tag,l=5===i||6===i;if(l)t=l?t.stateNode:t.stateNode.instance,n?r.insertBefore(t,n):r.appendChild(t);else if(4!==i&&null!==(t=t.child))for(e(t,n,r),t=t.sibling;null!==t;)e(t,n,r),t=t.sibling}(e,n,t)}function Eo(e,t){for(var n,r,i=t,l=!1;;){if(!l){l=i.return;e:for(;;){if(null===l)throw Error(s(160));switch(n=l.stateNode,l.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}l=l.return}l=!0}if(5===i.tag||6===i.tag){e:for(var o=e,a=i,u=a;;)if(po(o,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===a)break e;for(;null===u.sibling;){if(null===u.return||u.return===a)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(o=n,a=i.stateNode,8===o.nodeType?o.parentNode.removeChild(a):o.removeChild(a)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(po(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(l=!1)}i.sibling.return=i.return,i=i.sibling}}function Co(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3==(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var i=null!==e?e.memoizedProps:r;e=t.type;var l=t.updateQueue;if(t.updateQueue=null,null!==l){for(n[Qr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),we(e,i),t=we(e,r),i=0;i<l.length;i+=2){var o=l[i],a=l[i+1];"style"===o?Ie(n,a):"dangerouslySetInnerHTML"===o?me(n,a):"children"===o?Ee(n,a):y(n,o,a,t)}switch(e){case"input":ne(n,r);break;case"textarea":ue(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(l=r.value)?se(n,!!r.multiple,l,!1):e!==!!r.multiple&&(null!=r.defaultValue?se(n,!!r.multiple,r.defaultValue,!0):se(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(s(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,It(n.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(ko=Oi(),co(t.child,!0)),void Ao(t);case 19:return void Ao(t);case 17:return;case 23:case 24:return void co(t,null!==t.memoizedState)}throw Error(s(163))}function Ao(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new oo),t.forEach((function(t){var r=Fa.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function yo(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Io=Math.ceil,So=I.ReactCurrentDispatcher,_o=I.ReactCurrentOwner,wo=0,bo=null,xo=null,Po=0,vo=0,To=ii(0),Mo=0,Lo=null,Do=0,Ro=0,Fo=0,No=0,Bo=null,ko=0,Oo=1/0;function Go(){Oo=Oi()+500}var Xo,Vo=null,Ho=!1,Uo=null,Wo=null,jo=!1,zo=null,Yo=90,Qo=[],Ko=[],qo=null,Jo=0,Zo=null,$o=-1,ea=0,ta=0,na=null,ra=!1;function ia(){return 0!=(48&wo)?Oi():-1!==$o?$o:$o=Oi()}function la(e){if(0==(2&(e=e.mode)))return 1;if(0==(4&e))return 99===Gi()?1:2;if(0===ea&&(ea=Do),0!==ji.transition){0!==ta&&(ta=null!==Bo?Bo.pendingLanes:0),e=ea;var t=4186112&~ta;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Gi(),0!=(4&wo)&&98===e?e=Gt(12,ea):e=Gt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ea),e}function sa(e,t,n){if(50<Jo)throw Jo=0,Zo=null,Error(s(185));if(null===(e=oa(e,t)))return null;Ht(e,t,n),e===bo&&(Fo|=t,4===Mo&&ha(e,Po));var r=Gi();1===t?0!=(8&wo)&&0==(48&wo)?da(e):(aa(e,n),0===wo&&(Go(),Ui())):(0==(4&wo)||98!==r&&99!==r||(null===qo?qo=new Set([e]):qo.add(e)),aa(e,n)),Bo=e}function oa(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function aa(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,l=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-Ut(o),u=1<<a,h=l[a];if(-1===h){if(0==(u&r)||0!=(u&i)){h=t,Bt(u);var d=Nt;l[a]=10<=d?h+250:6<=d?h+5e3:-1}}else h<=t&&(e.expiredLanes|=u);o&=~u}if(r=kt(e,e===bo?Po:0),t=Nt,0===r)null!==n&&(n!==Di&&Si(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Di&&Si(n)}15===t?(n=da.bind(null,e),null===Fi?(Fi=[n],Ni=Ii(Pi,Wi)):Fi.push(n),n=Di):14===t?n=Hi(99,da.bind(null,e)):n=Hi(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,e))}}(t),ua.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function ua(e){if($o=-1,ta=ea=0,0!=(48&wo))throw Error(s(327));var t=e.callbackNode;if(Pa()&&e.callbackNode!==t)return null;var n=kt(e,e===bo?Po:0);if(0===n)return null;var r=n,i=wo;wo|=16;var l=Ca();for(bo===e&&Po===r||(Go(),ma(e,r));;)try{Ia();break}catch(t){Ea(e,t)}if(Ji(),So.current=l,wo=i,null!==xo?r=0:(bo=null,Po=0,r=Mo),0!=(Do&Fo))ma(e,0);else if(0!==r){if(2===r&&(wo|=64,e.hydrate&&(e.hydrate=!1,Hr(e.containerInfo)),0!==(n=Ot(e))&&(r=Aa(e,n))),1===r)throw t=Lo,ma(e,0),ha(e,n),aa(e,Oi()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(s(345));case 2:wa(e);break;case 3:if(ha(e,n),(62914560&n)===n&&10<(r=ko+500-Oi())){if(0!==kt(e,0))break;if(((i=e.suspendedLanes)&n)!==n){ia(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Xr(wa.bind(null,e),r);break}wa(e);break;case 4:if(ha(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var o=31-Ut(n);l=1<<o,(o=r[o])>i&&(i=o),n&=~l}if(n=i,10<(n=(120>(n=Oi()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Io(n/1960))-n)){e.timeoutHandle=Xr(wa.bind(null,e),n);break}wa(e);break;case 5:wa(e);break;default:throw Error(s(329))}}return aa(e,Oi()),e.callbackNode===t?ua.bind(null,e):null}function ha(e,t){for(t&=~No,t&=~Fo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ut(t),r=1<<n;e[n]=-1,t&=~r}}function da(e){if(0!=(48&wo))throw Error(s(327));if(Pa(),e===bo&&0!=(e.expiredLanes&Po)){var t=Po,n=Aa(e,t);0!=(Do&Fo)&&(n=Aa(e,t=kt(e,t)))}else n=Aa(e,t=kt(e,0));if(0!==e.tag&&2===n&&(wo|=64,e.hydrate&&(e.hydrate=!1,Hr(e.containerInfo)),0!==(t=Ot(e))&&(n=Aa(e,t))),1===n)throw n=Lo,ma(e,0),ha(e,t),aa(e,Oi()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,wa(e),aa(e,Oi()),null}function ca(e,t){var n=wo;wo|=1;try{return e(t)}finally{0===(wo=n)&&(Go(),Ui())}}function pa(e,t){var n=wo;wo&=-2,wo|=8;try{return e(t)}finally{0===(wo=n)&&(Go(),Ui())}}function fa(e,t){si(To,vo),vo|=t,Do|=t}function ga(){vo=To.current,li(To)}function ma(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Vr(n)),null!==xo)for(n=xo.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&pi();break;case 3:Tl(),li(ui),li(ai),Wl();break;case 5:Ll(r);break;case 4:Tl();break;case 13:case 19:li(Dl);break;case 10:Zi(r);break;case 23:case 24:ga()}n=n.return}bo=e,xo=Oa(e.current,null),Po=vo=Do=t,Mo=0,Lo=null,No=Fo=Ro=0}function Ea(e,t){for(;;){var n=xo;try{if(Ji(),jl.current=xs,Jl){for(var r=Ql.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}Jl=!1}if(Yl=0,ql=Kl=Ql=null,Zl=!1,_o.current=null,null===n||null===n.return){Mo=1,Lo=t,xo=null;break}e:{var l=e,s=n.return,o=n,a=t;if(t=Po,o.flags|=2048,o.firstEffect=o.lastEffect=null,null!==a&&"object"==typeof a&&"function"==typeof a.then){var u=a;if(0==(2&o.mode)){var h=o.alternate;h?(o.updateQueue=h.updateQueue,o.memoizedState=h.memoizedState,o.lanes=h.lanes):(o.updateQueue=null,o.memoizedState=null)}var d=0!=(1&Dl.current),c=s;do{var p;if(p=13===c.tag){var f=c.memoizedState;if(null!==f)p=null!==f.dehydrated;else{var g=c.memoizedProps;p=void 0!==g.fallback&&(!0!==g.unstable_avoidThisFallback||!d)}}if(p){var m=c.updateQueue;if(null===m){var E=new Set;E.add(u),c.updateQueue=E}else m.add(u);if(0==(2&c.mode)){if(c.flags|=64,o.flags|=16384,o.flags&=-2981,1===o.tag)if(null===o.alternate)o.tag=17;else{var C=ll(-1,1);C.tag=2,sl(o,C)}o.lanes|=1;break e}a=void 0,o=t;var A=l.pingCache;if(null===A?(A=l.pingCache=new io,a=new Set,A.set(u,a)):void 0===(a=A.get(u))&&(a=new Set,A.set(u,a)),!a.has(o)){a.add(o);var y=Ra.bind(null,l,u,o);u.then(y,y)}c.flags|=4096,c.lanes=t;break e}c=c.return}while(null!==c);a=Error((Y(o.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Mo&&(Mo=2),a=ro(a,o),c=s;do{switch(c.tag){case 3:l=a,c.flags|=4096,t&=-t,c.lanes|=t,ol(c,lo(0,l,t));break e;case 1:l=a;var I=c.type,S=c.stateNode;if(0==(64&c.flags)&&("function"==typeof I.getDerivedStateFromError||null!==S&&"function"==typeof S.componentDidCatch&&(null===Wo||!Wo.has(S)))){c.flags|=4096,t&=-t,c.lanes|=t,ol(c,so(c,l,t));break e}}c=c.return}while(null!==c)}_a(n)}catch(e){t=e,xo===n&&null!==n&&(xo=n=n.return);continue}break}}function Ca(){var e=So.current;return So.current=xs,null===e?xs:e}function Aa(e,t){var n=wo;wo|=16;var r=Ca();for(bo===e&&Po===t||ma(e,t);;)try{ya();break}catch(t){Ea(e,t)}if(Ji(),wo=n,So.current=r,null!==xo)throw Error(s(261));return bo=null,Po=0,Mo}function ya(){for(;null!==xo;)Sa(xo)}function Ia(){for(;null!==xo&&!_i();)Sa(xo)}function Sa(e){var t=Xo(e.alternate,e,vo);e.memoizedProps=e.pendingProps,null===t?_a(e):xo=t,_o.current=null}function _a(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(2048&t.flags)){if(null!==(n=to(n,t,vo)))return void(xo=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!=(1073741824&vo)||0==(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&0==(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=no(t)))return n.flags&=2047,void(xo=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(xo=t);xo=t=e}while(null!==t);0===Mo&&(Mo=5)}function wa(e){var t=Gi();return Vi(99,ba.bind(null,e,t)),null}function ba(e,t){do{Pa()}while(null!==zo);if(0!=(48&wo))throw Error(s(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,l=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var o=e.eventTimes,a=e.expirationTimes;0<l;){var u=31-Ut(l),h=1<<u;i[u]=0,o[u]=-1,a[u]=-1,l&=~h}if(null!==qo&&0==(24&r)&&qo.has(e)&&qo.delete(e),e===bo&&(xo=bo=null,Po=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=wo,wo|=32,_o.current=null,Br=Qt,cr(o=dr())){if("selectionStart"in o)a={start:o.selectionStart,end:o.selectionEnd};else e:if(a=(a=o.ownerDocument)&&a.defaultView||window,(h=a.getSelection&&a.getSelection())&&0!==h.rangeCount){a=h.anchorNode,l=h.anchorOffset,u=h.focusNode,h=h.focusOffset;try{a.nodeType,u.nodeType}catch(e){a=null;break e}var d=0,c=-1,p=-1,f=0,g=0,m=o,E=null;t:for(;;){for(var C;m!==a||0!==l&&3!==m.nodeType||(c=d+l),m!==u||0!==h&&3!==m.nodeType||(p=d+h),3===m.nodeType&&(d+=m.nodeValue.length),null!==(C=m.firstChild);)E=m,m=C;for(;;){if(m===o)break t;if(E===a&&++f===l&&(c=d),E===u&&++g===h&&(p=d),null!==(C=m.nextSibling))break;E=(m=E).parentNode}m=C}a=-1===c||-1===p?null:{start:c,end:p}}else a=null;a=a||{start:0,end:0}}else a=null;kr={focusedElem:o,selectionRange:a},Qt=!1,na=null,ra=!1,Vo=r;do{try{xa()}catch(e){if(null===Vo)throw Error(s(330));Da(Vo,e),Vo=Vo.nextEffect}}while(null!==Vo);na=null,Vo=r;do{try{for(o=e;null!==Vo;){var A=Vo.flags;if(16&A&&Ee(Vo.stateNode,""),128&A){var y=Vo.alternate;if(null!==y){var I=y.ref;null!==I&&("function"==typeof I?I(null):I.current=null)}}switch(1038&A){case 2:mo(Vo),Vo.flags&=-3;break;case 6:mo(Vo),Vo.flags&=-3,Co(Vo.alternate,Vo);break;case 1024:Vo.flags&=-1025;break;case 1028:Vo.flags&=-1025,Co(Vo.alternate,Vo);break;case 4:Co(Vo.alternate,Vo);break;case 8:Eo(o,a=Vo);var S=a.alternate;fo(a),null!==S&&fo(S)}Vo=Vo.nextEffect}}catch(e){if(null===Vo)throw Error(s(330));Da(Vo,e),Vo=Vo.nextEffect}}while(null!==Vo);if(I=kr,y=dr(),A=I.focusedElem,o=I.selectionRange,y!==A&&A&&A.ownerDocument&&function e(t,n){return!(!t||!n)&&(t===n||(!t||3!==t.nodeType)&&(n&&3===n.nodeType?e(t,n.parentNode):"contains"in t?t.contains(n):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(n))))}(A.ownerDocument.documentElement,A)){null!==o&&cr(A)&&(y=o.start,void 0===(I=o.end)&&(I=y),"selectionStart"in A?(A.selectionStart=y,A.selectionEnd=Math.min(I,A.value.length)):(I=(y=A.ownerDocument||document)&&y.defaultView||window).getSelection&&(I=I.getSelection(),a=A.textContent.length,S=Math.min(o.start,a),o=void 0===o.end?S:Math.min(o.end,a),!I.extend&&S>o&&(a=o,o=S,S=a),a=hr(A,S),l=hr(A,o),a&&l&&(1!==I.rangeCount||I.anchorNode!==a.node||I.anchorOffset!==a.offset||I.focusNode!==l.node||I.focusOffset!==l.offset)&&((y=y.createRange()).setStart(a.node,a.offset),I.removeAllRanges(),S>o?(I.addRange(y),I.extend(l.node,l.offset)):(y.setEnd(l.node,l.offset),I.addRange(y))))),y=[];for(I=A;I=I.parentNode;)1===I.nodeType&&y.push({element:I,left:I.scrollLeft,top:I.scrollTop});for("function"==typeof A.focus&&A.focus(),A=0;A<y.length;A++)(I=y[A]).element.scrollLeft=I.left,I.element.scrollTop=I.top}Qt=!!Br,kr=Br=null,e.current=n,Vo=r;do{try{for(A=e;null!==Vo;){var _=Vo.flags;if(36&_&&ho(A,Vo.alternate,Vo),128&_){y=void 0;var w=Vo.ref;if(null!==w){var b=Vo.stateNode;switch(Vo.tag){case 5:y=b;break;default:y=b}"function"==typeof w?w(y):w.current=y}}Vo=Vo.nextEffect}}catch(e){if(null===Vo)throw Error(s(330));Da(Vo,e),Vo=Vo.nextEffect}}while(null!==Vo);Vo=null,Ri(),wo=i}else e.current=n;if(jo)jo=!1,zo=e,Yo=t;else for(Vo=r;null!==Vo;)t=Vo.nextEffect,Vo.nextEffect=null,8&Vo.flags&&((_=Vo).sibling=null,_.stateNode=null),Vo=t;if(0===(r=e.pendingLanes)&&(Wo=null),1===r?e===Zo?Jo++:(Jo=0,Zo=e):Jo=0,n=n.stateNode,Ai&&"function"==typeof Ai.onCommitFiberRoot)try{Ai.onCommitFiberRoot(Ci,n,void 0,64==(64&n.current.flags))}catch(e){}if(aa(e,Oi()),Ho)throw Ho=!1,e=Uo,Uo=null,e;return 0!=(8&wo)||Ui(),null}function xa(){for(;null!==Vo;){var e=Vo.alternate;ra||null===na||(0!=(8&Vo.flags)?$e(Vo,na)&&(ra=!0):13===Vo.tag&&yo(e,Vo)&&$e(Vo,na)&&(ra=!0));var t=Vo.flags;0!=(256&t)&&uo(e,Vo),0==(512&t)||jo||(jo=!0,Hi(97,(function(){return Pa(),null}))),Vo=Vo.nextEffect}}function Pa(){if(90!==Yo){var e=97<Yo?97:Yo;return Yo=90,Vi(e,Ma)}return!1}function va(e,t){Qo.push(t,e),jo||(jo=!0,Hi(97,(function(){return Pa(),null})))}function Ta(e,t){Ko.push(t,e),jo||(jo=!0,Hi(97,(function(){return Pa(),null})))}function Ma(){if(null===zo)return!1;var e=zo;if(zo=null,0!=(48&wo))throw Error(s(331));var t=wo;wo|=32;var n=Ko;Ko=[];for(var r=0;r<n.length;r+=2){var i=n[r],l=n[r+1],o=i.destroy;if(i.destroy=void 0,"function"==typeof o)try{o()}catch(e){if(null===l)throw Error(s(330));Da(l,e)}}for(n=Qo,Qo=[],r=0;r<n.length;r+=2){i=n[r],l=n[r+1];try{var a=i.create;i.destroy=a()}catch(e){if(null===l)throw Error(s(330));Da(l,e)}}for(a=e.current.firstEffect;null!==a;)e=a.nextEffect,a.nextEffect=null,8&a.flags&&(a.sibling=null,a.stateNode=null),a=e;return wo=t,Ui(),!0}function La(e,t,n){sl(e,t=lo(0,t=ro(n,t),1)),t=ia(),null!==(e=oa(e,1))&&(Ht(e,1,t),aa(e,t))}function Da(e,t){if(3===e.tag)La(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){La(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Wo||!Wo.has(r))){var i=so(n,e=ro(t,e),1);if(sl(n,i),i=ia(),null!==(n=oa(n,1)))Ht(n,1,i),aa(n,i);else if("function"==typeof r.componentDidCatch&&(null===Wo||!Wo.has(r)))try{r.componentDidCatch(t,e)}catch(e){}break}}n=n.return}}function Ra(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ia(),e.pingedLanes|=e.suspendedLanes&n,bo===e&&(Po&n)===n&&(4===Mo||3===Mo&&(62914560&Po)===Po&&500>Oi()-ko?ma(e,0):No|=n),aa(e,t)}function Fa(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0==(2&(t=e.mode))?t=1:0==(4&t)?t=99===Gi()?1:2:(0===ea&&(ea=Do),0===(t=Xt(62914560&~ea))&&(t=4194304))),n=ia(),null!==(e=oa(e,t))&&(Ht(e,t,n),aa(e,n))}function Na(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Ba(e,t,n,r){return new Na(e,t,n,r)}function ka(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oa(e,t){var n=e.alternate;return null===n?((n=Ba(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ga(e,t,n,r,i,l){var o=2;if(r=e,"function"==typeof e)ka(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case w:return Xa(n.children,i,l,t);case B:o=8,i|=16;break;case b:o=8,i|=1;break;case x:return(e=Ba(12,n,t,8|i)).elementType=x,e.type=x,e.lanes=l,e;case M:return(e=Ba(13,n,t,i)).type=M,e.elementType=M,e.lanes=l,e;case L:return(e=Ba(19,n,t,i)).elementType=L,e.lanes=l,e;case k:return Va(n,i,l,t);case O:return(e=Ba(24,n,t,i)).elementType=O,e.lanes=l,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case P:o=10;break e;case v:o=9;break e;case T:o=11;break e;case D:o=14;break e;case R:o=16,r=null;break e;case F:o=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ba(o,n,t,i)).elementType=e,t.type=r,t.lanes=l,t}function Xa(e,t,n,r){return(e=Ba(7,e,r,t)).lanes=n,e}function Va(e,t,n,r){return(e=Ba(23,e,r,t)).elementType=k,e.lanes=n,e}function Ha(e,t,n){return(e=Ba(6,e,null,t)).lanes=n,e}function Ua(e,t,n){return(t=Ba(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wa(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Vt(0),this.expirationTimes=Vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vt(0),this.mutableSourceEagerHydrationData=null}function ja(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function za(e,t,n,r){var i=t.current,l=ia(),o=la(i);e:if(n){t:{if(Ke(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break t;case 1:if(ci(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break t}}a=a.return}while(null!==a);throw Error(s(171))}if(1===n.tag){var u=n.type;if(ci(u)){n=gi(n,u,a);break e}}n=a}else n=oi;return null===t.context?t.context=n:t.pendingContext=n,(t=ll(l,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),sl(i,t),sa(i,o,l),o}function Ya(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Qa(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Ka(e,t){Qa(e,t),(e=e.alternate)&&Qa(e,t)}function qa(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Wa(e,t,null!=n&&!0===n.hydrate),t=Ba(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,rl(t),e[Kr]=n.current,Pr(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var i=(t=r[e])._getVersion;i=i(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,i]:n.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=n}function Ja(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Za(e,t,n,r,i){var l=n._reactRootContainer;if(l){var s=l._internalRoot;if("function"==typeof i){var o=i;i=function(){var e=Ya(s);o.call(e)}}za(t,s,e,i)}else{if(l=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new qa(e,0,t?{hydrate:!0}:void 0)}(n,r),s=l._internalRoot,"function"==typeof i){var a=i;i=function(){var e=Ya(s);a.call(e)}}pa((function(){za(t,s,e,i)}))}return Ya(s)}function $a(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ja(t))throw Error(s(200));return ja(e,t,null,n)}Xo=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||ui.current)Ls=!0;else{if(0==(n&r)){switch(Ls=!1,t.tag){case 3:Vs(t),Hl();break;case 5:Ml(t);break;case 1:ci(t.type)&&mi(t);break;case 4:vl(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var i=t.type._context;si(Yi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!=(n&t.child.childLanes)?zs(e,t,n):(si(Dl,1&Dl.current),null!==(t=$s(e,t,n))?t.sibling:null);si(Dl,1&Dl.current);break;case 19:if(r=0!=(n&t.childLanes),0!=(64&e.flags)){if(r)return Zs(e,t,n);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),si(Dl,Dl.current),r)break;return null;case 23:case 24:return t.lanes=0,Bs(e,t,n)}return $s(e,t,n)}Ls=0!=(16384&e.flags)}else Ls=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=di(t,ai.current),el(t,n),i=ts(null,t,r,e,i,n),t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,ci(r)){var l=!0;mi(t)}else l=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,rl(t);var o=r.getDerivedStateFromProps;"function"==typeof o&&dl(t,r,o,e),i.updater=cl,t.stateNode=i,i._reactInternals=t,ml(t,r,e,n),t=Xs(null,t,r,!0,l,n)}else t.tag=0,Ds(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(l=i._init)(i._payload),t.type=i,l=t.tag=function(e){if("function"==typeof e)return ka(e)?1:0;if(null!=e){if((e=e.$$typeof)===T)return 11;if(e===D)return 14}return 2}(i),e=zi(i,e),l){case 0:t=Os(null,t,i,e,n);break e;case 1:t=Gs(null,t,i,e,n);break e;case 11:t=Rs(null,t,i,e,n);break e;case 14:t=Fs(null,t,i,zi(i.type,e),r,n);break e}throw Error(s(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Os(e,t,r,i=t.elementType===r?i:zi(r,i),n);case 1:return r=t.type,i=t.pendingProps,Gs(e,t,r,i=t.elementType===r?i:zi(r,i),n);case 3:if(Vs(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,il(e,t),al(t,r,null,n),(r=t.memoizedState.element)===i)Hl(),t=$s(e,t,n);else{if((l=(i=t.stateNode).hydrate)&&(Nl=Ur(t.stateNode.containerInfo.firstChild),Fl=t,l=Bl=!0),l){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(l=e[i])._workInProgressVersionPrimary=e[i+1],Ul.push(l);for(n=Sl(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Ds(e,t,r,n),Hl();t=t.child}return t;case 5:return Ml(t),null===e&&Gl(t),r=t.type,i=t.pendingProps,l=null!==e?e.memoizedProps:null,o=i.children,Gr(r,i)?o=null:null!==l&&Gr(r,l)&&(t.flags|=16),ks(e,t),Ds(e,t,o,n),t.child;case 6:return null===e&&Gl(t),null;case 13:return zs(e,t,n);case 4:return vl(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Il(t,null,r,n):Ds(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Rs(e,t,r,i=t.elementType===r?i:zi(r,i),n);case 7:return Ds(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ds(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,o=t.memoizedProps,l=i.value;var a=t.type._context;if(si(Yi,a._currentValue),a._currentValue=l,null!==o)if(a=o.value,0===(l=sr(a,l)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(a,l):1073741823))){if(o.children===i.children&&!ui.current){t=$s(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var u=a.dependencies;if(null!==u){o=a.child;for(var h=u.firstContext;null!==h;){if(h.context===r&&0!=(h.observedBits&l)){1===a.tag&&((h=ll(-1,n&-n)).tag=2,sl(a,h)),a.lanes|=n,null!==(h=a.alternate)&&(h.lanes|=n),$i(a.return,n),u.lanes|=n;break}h=h.next}}else o=10===a.tag&&a.type===t.type?null:a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}Ds(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(l=t.pendingProps).children,el(t,n),r=r(i=tl(i,l.unstable_observedBits)),t.flags|=1,Ds(e,t,r,n),t.child;case 14:return l=zi(i=t.type,t.pendingProps),Fs(e,t,i,l=zi(i.type,l),r,n);case 15:return Ns(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:zi(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,ci(r)?(e=!0,mi(t)):e=!1,el(t,n),fl(t,r,i),ml(t,r,i,n),Xs(null,t,r,!0,e,n);case 19:return Zs(e,t,n);case 23:case 24:return Bs(e,t,n)}throw Error(s(156,t.tag))},qa.prototype.render=function(e){za(e,this._internalRoot,null,null)},qa.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;za(null,e,null,(function(){t[Kr]=null}))},et=function(e){13===e.tag&&(sa(e,4,ia()),Ka(e,4))},tt=function(e){13===e.tag&&(sa(e,67108864,ia()),Ka(e,67108864))},nt=function(e){if(13===e.tag){var t=ia(),n=la(e);sa(e,n,t),Ka(e,n)}},rt=function(e,t){return t()},xe=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ei(r);if(!i)throw Error(s(90));J(r),ne(r,i)}}}break;case"textarea":ue(e,n);break;case"select":null!=(t=n.value)&&se(e,!!n.multiple,t,!1)}},De=ca,Re=function(e,t,n,r,i){var l=wo;wo|=4;try{return Vi(98,e.bind(null,t,n,r,i))}finally{0===(wo=l)&&(Go(),Ui())}},Fe=function(){0==(49&wo)&&(function(){if(null!==qo){var e=qo;qo=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,aa(e,Oi())}))}Ui()}(),Pa())},Ne=function(e,t){var n=wo;wo|=2;try{return e(t)}finally{0===(wo=n)&&(Go(),Ui())}};var eu={Events:[Zr,$r,ei,Me,Le,Pa,{current:!1}]},tu={findFiberByHostInstance:Jr,bundleType:0,version:"17.0.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{Ci=ru.inject(nu),Ai=ru}catch(e){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=$a,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e,t){var n=wo;if(0!=(48&n))return e(t);wo|=1;try{if(e)return Vi(99,e.bind(null,t))}finally{wo=n,Ui()}},t.hydrate=function(e,t,n){if(!Ja(t))throw Error(s(200));return Za(null,e,t,!0,n)},t.render=function(e,t,n){if(!Ja(t))throw Error(s(200));return Za(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Ja(e))throw Error(s(40));return!!e._reactRootContainer&&(pa((function(){Za(null,null,e,!1,(function(){e._reactRootContainer=null,e[Kr]=null}))})),!0)},t.unstable_batchedUpdates=ca,t.unstable_createPortal=function(e,t){return $a(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ja(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Za(e,t,n,!1,r)},t.version="17.0.1"},function(e,t,n){"use strict";e.exports=n(636)},function(e,t,n){"use strict";var r,i,l,s;if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var h=null,d=null,c=function(){if(null!==h)try{var e=t.unstable_now();h(!0,e),h=null}catch(e){throw setTimeout(c,0),e}};r=function(e){null!==h?setTimeout(r,0,e):(h=e,setTimeout(c,0))},i=function(e,t){d=setTimeout(e,t)},l=function(){clearTimeout(d)},t.unstable_shouldYield=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var p=window.setTimeout,f=window.clearTimeout;if("undefined"!=typeof console){window.cancelAnimationFrame;window.requestAnimationFrame}var g=!1,m=null,E=-1,C=5,A=0;t.unstable_shouldYield=function(){return t.unstable_now()>=A},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e||(C=0<e?Math.floor(1e3/e):5)};var y=new MessageChannel,I=y.port2;y.port1.onmessage=function(){if(null!==m){var e=t.unstable_now();A=e+C;try{m(!0,e)?I.postMessage(null):(g=!1,m=null)}catch(e){throw I.postMessage(null),e}}else g=!1},r=function(e){m=e,g||(g=!0,I.postMessage(null))},i=function(e,n){E=p((function(){e(t.unstable_now())}),n)},l=function(){f(E),E=-1}}function S(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<b(i,t)))break e;e[r]=t,e[n]=i,n=r}}function _(e){return void 0===(e=e[0])?null:e}function w(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var l=2*(r+1)-1,s=e[l],o=l+1,a=e[o];if(void 0!==s&&0>b(s,n))void 0!==a&&0>b(a,s)?(e[r]=a,e[o]=n,r=o):(e[r]=s,e[l]=n,r=l);else{if(!(void 0!==a&&0>b(a,n)))break e;e[r]=a,e[o]=n,r=o}}}return t}return null}function b(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var x=[],P=[],v=1,T=null,M=3,L=!1,D=!1,R=!1;function F(e){for(var t=_(P);null!==t;){if(null===t.callback)w(P);else{if(!(t.startTime<=e))break;w(P),t.sortIndex=t.expirationTime,S(x,t)}t=_(P)}}function N(e){if(R=!1,F(e),!D)if(null!==_(x))D=!0,r(B);else{var t=_(P);null!==t&&i(N,t.startTime-e)}}function B(e,n){D=!1,R&&(R=!1,l()),L=!0;var r=M;try{for(F(n),T=_(x);null!==T&&(!(T.expirationTime>n)||e&&!t.unstable_shouldYield());){var s=T.callback;if("function"==typeof s){T.callback=null,M=T.priorityLevel;var o=s(T.expirationTime<=n);n=t.unstable_now(),"function"==typeof o?T.callback=o:T===_(x)&&w(x),F(n)}else w(x);T=_(x)}if(null!==T)var a=!0;else{var u=_(P);null!==u&&i(N,u.startTime-n),a=!1}return a}finally{T=null,M=r,L=!1}}var k=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){D||L||(D=!0,r(B))},t.unstable_getCurrentPriorityLevel=function(){return M},t.unstable_getFirstCallbackNode=function(){return _(x)},t.unstable_next=function(e){switch(M){case 1:case 2:case 3:var t=3;break;default:t=M}var n=M;M=t;try{return e()}finally{M=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=k,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=M;M=e;try{return t()}finally{M=n}},t.unstable_scheduleCallback=function(e,n,s){var o=t.unstable_now();switch("object"==typeof s&&null!==s?s="number"==typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:v++,callback:n,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,S(P,e),null===_(x)&&e===_(P)&&(R?l():R=!0,i(N,s-o))):(e.sortIndex=a,S(x,e),D||L||(D=!0,r(B))),e},t.unstable_wrapCallback=function(e){var t=M;return function(){var n=M;M=t;try{return e.apply(this,arguments)}finally{M=n}}}},function(e,t,n){var r=n(18),i=n(638);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".pango-editor-msg-dialog-mask {\r\n    position: fixed;\r\n    display: flex;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: rgba(0,0,0,0.3);\r\n    transition: background .3s;\r\n    justify-content: center;\r\n    align-items: center;\r\n    perspective: 600px;\r\n}\r\n.pango-editor-msg-dialog-wrap {\r\n    position: absolute!important;\r\n    background: #FFFFFF;\r\n    box-sizing: border-box;\r\n    /* padding: 16px; */\r\n    display: flex;\r\n    flex-direction: column;\r\n    box-shadow: 0 3px 6px -4px rgba(0,0,0,.12), 0 6px 16px 0 rgba(0,0,0,.08), 0 9px 28px 8px rgba(0,0,0,.05);\r\n    border-radius: 4px;\r\n    border-style: solid;\r\n\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%) scale(1);\r\n    transition: all .3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\r\n    opacity: 1;\r\n\r\n}\r\n\r\n.level1.pango-editor-msg-dialog-wrap {\r\n    border-radius: 2px;\r\n    border-width: 1px;\r\n    top: 40px;\r\n    /* transform: translate(-50%, 0) scale(1); */\r\n}\r\n\r\n.pango-editor-msg-dialog-wrap .pango-editor-text-button {\r\n    margin-left: 16px;\r\n}\r\n\r\n.pango-editor-msg-dialog {\r\n    position: relative;\r\n    top: 50%;\r\n    margin: -150px auto 0;\r\n    width: 372px;\r\n    height: 200px;\r\n    background: #fff;\r\n    box-shadow: 0 2px 8px 0 rgba(0,0,0,0.20);\r\n    box-sizing: border-box;\r\n    border-radius: 4px;\r\n    border-top: 6px solid #2D5AFA;\r\n    transition: transform .3s;\r\n}\r\n\r\n.pango-editor-msg-dialog-success {\r\n    border-color: #00AB44;\r\n}\r\n.pango-editor-msg-dialog-warning {\r\n    border-color: #FF8C00;\r\n}\r\n.pango-editor-msg-dialog-error {\r\n    border-color: #EC0000;\r\n}\r\n.pango-editor-msg-dialog-info {\r\n    border-color: #2D5AFA;\r\n}\r\n\r\n.pango-editor-msg-dialog_info {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 104px;\r\n    margin-top: 14px;\r\n    display: flex;\r\n}\r\n\r\n.level1 .pango-editor-msg-dialog_info{\r\n    height: auto;\r\n    margin-top: 0;\r\n}\r\n\r\n.pango-editor-msg-dialog_info .pango-editor-icon {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 40px;\r\n    height: 40px;\r\n    font-size: 20px;\r\n    flex-shrink: 0;\r\n    color: #FFFFFF;\r\n}\r\n\r\n.pango-editor-msg-dialog-wrap .pango-editor-dialog-footer {\r\n    height: 40px;\r\n    box-sizing: border-box;\r\n    border: none;\r\n}\r\n\r\n.pango-editor-msg-dialog-success .pango-editor-icon {\r\n    background-color: #00AB44;\r\n}\r\n\r\n.pango-editor-msg-dialog-warning .pango-editor-icon {\r\n    background-color: #FF8C00;\r\n}\r\n\r\n.pango-editor-msg-dialog-error .pango-editor-icon {\r\n    background-color: #EC0000;\r\n}\r\n\r\n.pango-editor-msg-dialog-info .pango-editor-icon {\r\n    background-color: #2D5AFA;\r\n}\r\n\r\n.pango-editor-msg-dialog_info {\r\n    overflow: auto;\r\n}\r\n.pango-editor-msg-dialog_info p {\r\n    margin: 0\r\n}\r\n.pango-editor-msg-dialog_info .pango-editor-msg-dialog-title {\r\n    font-size: 18px;\r\n    color: #000;\r\n    font-weight: bold;\r\n}\r\n.pango-editor-msg-dialog_info .pango-editor-msg-dialog-text {\r\n    height: 100%;\r\n    line-height: 38px;\r\n    padding-left: 15px;\r\n    font-size: 16px;\r\n    color: #000;\r\n}\r\n.pango-editor-msg-dialog_info .info {\r\n    width: 600px;\r\n    height: 100%;\r\n    background: #F9F4ED;\r\n}\r\n\r\n.pango-editor-msg-dialog-button {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 56px;\r\n}\r\n\r\n.pango-editor-dialog-enter, .pango-editor-dialog-leave {\r\n    opacity: 0;\r\n}\r\n\r\n.pango-editor-dialog-enter .pango-editor-msg-dialog, .pango-editor-dialog-leave .pango-editor-msg-dialog {\r\n    transform: rotateX(10deg);\r\n}\r\n.msg-dialog_fadeInOut {\r\n    background: rgba(0,0,0,0);\r\n}\r\n.msg-dialog_fadeInOut>.pango-editor-msg-dialog-wrap{\r\n    opacity: 0;\r\n    transform: translate(-50%, -50%) scale(0);\r\n    transition: all .3s cubic-bezier(0.6, -0.28, 0.735, 0.045);\r\n}\r\n",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallBackEvent=void 0;t.CallBackEvent=class{set EventName(e){this.eventName=e}get EventName(){return this.eventName}get CptID(){return this._cptid}set CptID(e){this._cptid=e}get DocId(){return this._docId}set DocId(e){this._docId=e}get InnerText(){return this.innerText}set InnerText(e){this.innerText=e}set EleId(e){this.eleId=e}get EleId(){return this.eleId}set Value(e){this.value=e}get Value(){return this.value}set DateTimeValue(e){this._DateTimeValue=e}get DateTimeValue(){return this._DateTimeValue}set Location(e){this._location=e}get Location(){return this._location}set bodyLocation(e){this._bodyLocation=e}get bodyLocation(){return this._bodyLocation}set editorLocation(e){this._editorLocation=e}get editorLocation(){return this._editorLocation}GetObject(){return{eventName:this.eventName,eleId:this.eleId,value:this.value,bodyLocation:this._bodyLocation,editorLocation:this._editorLocation}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventUtils=void 0;class r{static PostEventMessage(e){parent.postMessage(e.GetObject(),window.location.origin)}}t.EventUtils=r,r.TextChange="TextChange",r.DocLoaded="DocLoaded"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Calendar=void 0;const r=n(27),i=n(325),l=n(17);class s extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();if(super(t,e),null!=this._Comp&&this._Comp.Child)this._Comp.updateProps(e),this.IsUpdated=!0;else{this.divID="_CalendarComp"+(new Date).getTime();const e=Object.assign({divID:this.divID},this.InitProps);this._Comp=new i.CalendarComp(t,e),this.IsUpdated=!1}}DefaultProps(){return{dateFormat:"yyyy-MM-dd",value:"",position:new l.PointF(0,0)}}}t.Calendar=s},function(e,t,n){var r=n(18),i=n(643);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,"\r\n.calendar {\r\n    width: 294px;\r\n    padding: 0.1em 0.5em;\r\n    position: relative;\r\n    font-size: 16px;\r\n}\r\n\r\n.calendar .calendartable {\r\n    width: 100%;\r\n    height: 12em;\r\n    border-collapse: collapse;\r\n}\r\n.calendar .calendartable thead {\r\n    border-bottom: 1px solid #C9C9C9;\r\n    height: 36px;\r\n}\r\n\r\n.calendar .calendartable thead,\r\n.calendar .calendartable tbody {\r\n    text-align: center;\r\n}\r\n.calendar .calendartable tbody td {\r\n    color: #000000;\r\n    cursor: pointer;\r\n    width: 36px;\r\n    height: 36px;\r\n}\r\n.calendar .calendartable tbody td.unlight {\r\n    color: #999;\r\n}\r\n\r\n\r\n.calendar .statusbar {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    height: 2em;\r\n}\r\n\r\n.calendar .statusbar button {\r\n    width: 2.1em;\r\n    height: 1.8em;\r\n    text-align: center;\r\n    background: #FFFFFF;\r\n    color: #000000;\r\n    font-size: 16px;\r\n    border: 0;\r\n    cursor: pointer;\r\n}\r\n\r\n.calendar button.dateInfo {\r\n    flex: 1;\r\n    text-align: center;\r\n    width: auto;\r\n    margin: 0 1em;\r\n    background: transparent;\r\n    font-size: 16px;\r\n    color: #000000;\r\n    letter-spacing: 0;\r\n    font-weight: 400;\r\n    border: 0;\r\n}\r\n\r\n.calendar .timecontainer {\r\n    height: 32px;\r\n    text-align: center;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    padding: 10px 5px;\r\n    box-sizing: content-box;\r\n}\r\n.calendar .timecontainer>span {\r\n    font-size: 16px;\r\n    display: inline-block;\r\n    color: #000000;\r\n    height: 32px;\r\n    padding: 0 5px;\r\n    line-height: 32px;\r\n\r\n}\r\n.calendar .calendar-select {\r\n    width: 3.6em;\r\n    margin: 0 0.2em;\r\n}\r\n\r\n\r\n.calendar .calendar-month .active,\r\n.calendar .calendar-year .active {\r\n    background: var(--pango-editor-theme);\r\n}\r\n\r\n.calendar .calendar-month .actived,\r\n.calendar .calendar-year .actived {\r\n    position: relative;\r\n    color: #ffffff;\r\n}\r\n\r\n.calendar .calendar-date .actived {\r\n    position: relative;\r\n    color: #ffffff;\r\n}\r\n.calendar .calendar-date .actived:after {\r\n    content: '';\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n    width: 26px;\r\n    height: 26px;\r\n    border-radius: 50%;\r\n    background-color: var(--pango-editor-theme);\r\n    z-index: -1;\r\n}\r\n.popover-buttonArea button:focus,\r\n.calendar label:focus,\r\n.calendar .statusbar button:focus {\r\n    outline-color: var(--pango-editor-theme);\r\n    outline-width: 1px;\r\n    outline-offset: 0;\r\n    outline-style: auto;\r\n}\r\n.popover-buttonArea button:focus {\r\n    outline-offset: 3px;\r\n}\r\n.calendar .calendartable th button:active,\r\n.calendar .calendartable th button:hover,\r\n.calendar .calendartable th button:focus,\r\n.calendar .virtualRefTable {\r\n    background: transparent;\r\n    border: 0;\r\n    outline: 0;\r\n    width: 1px;\r\n    height: 1px;\r\n    overflow: hidden;\r\n    position: absolute;\r\n    left: 20px;\r\n    top: 35px;\r\n    z-index: -1;\r\n}\r\n",""]),e.exports=t},function(e,t,n){var r=n(18),i=n(645);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,"\r\n.pango-editor-popover .okBtn, .pango-editor-popover .cancelBtn {\r\n    margin: 8px;\r\n}\r\n.pango-editor-popover {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n    color: rgba(0, 0, 0, 0.65);\r\n    font-variant: tabular-nums;\r\n    font-feature-settings: 'tnum';\r\n     position: absolute;\r\n    z-index: 3050;\r\n    line-height: 1.5;\r\n    text-align: left;\r\n    list-style: none;\r\n    background-color: #fff;\r\n    background-clip: padding-box;\r\n    border: 1px solid #fff;\r\n    border-radius: 4px;\r\n    outline: none;\r\n    box-shadow: 0 2px 4px 0 rgba(0,0,0,0.12);\r\n}\r\n.popover-buttonArea {\r\n    height: 36px;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    align-items: center;\r\n}\r\n.popover-buttonArea button {\r\n    display: inline-block;\r\n    white-space: nowrap;\r\n    cursor: pointer;\r\n    -webkit-appearance: none;\r\n    text-align: center;\r\n    box-sizing: border-box;\r\n    outline: none;\r\n    margin: 0;\r\n    transition: .1s;\r\n    font-weight: 500;\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    font-size: 14px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    height: 26px;\r\n    width: 60px;\r\n}\r\n\r\n.popover-buttonArea button {\r\n    margin-right: 4px;\r\n    margin-bottom: 10px;\r\n}\r\n.popover-buttonArea button:last-child {\r\n    margin-right: 10px;\r\n}\r\n\r\n\r\n\r\n\r\n",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberInput=void 0,n(647);const r=n(12),i=n(12),l=n(170);class s extends r.Component{constructor(e,t){super(e,t),this.inputRef=i.createRef(),this._onBlur=(e,t)=>{var n;let{precision:r,min:i,max:l,stepStrictly:s,step:o}=this.props,a=isNaN(Number(e.target.value))?"0":e.target.value,u=a.toString().split("."),h=-1!==String(o).indexOf(".")?String(o).split(".")[1].length:0;if(r){let e=(null===(n=u[1])||void 0===n?void 0:n.length)||0,t=Number(r);a=e>=r&&0!=t?u[0]+"."+u[1].slice(0,h):u[0]+"."+"0".padEnd(t,"0")}else a=u[0];this.props.onBlur&&this.props.onBlur(e,t),this.props.required&&this.setState({isError:""===e.target.value}),a<i?a=i:a>l&&(a=l),this.setState({value:a})},this._numberInput=(e,t)=>{this.props.onKeydown&&this.props.onKeydown(e,t)},this._arrowClick=e=>{let{step:t,min:n,max:r,disabled:i}=this.props;if(i)return;let{minDisabled:l,maxDisabled:s}=this.state,o=-1!==String(t).indexOf(".")?String(t).split(".")[1].length:0;this.setState(i=>{let a,u=i.value||"",h=u.toString().split("."),d=Number(h[0]);if("add"==e){if(s)return;a=String(t?(+u+Number(t)).toFixed(o):d++)}else if("del"==e){if(l)return;a=String(t?(+u-Number(t)).toFixed(o):d--)}return l=null!=n&&Number(a)<=n,s=null!=r&&Number(a)>=r,{value:a,minDisabled:l,maxDisabled:s,isError:!1}}),this.inputRef.current.focus()},this.onValid=e=>{this.props.onValid&&this.props.onValid(e)},this.state={value:e.value||"",isError:!1,minDisabled:!1,maxDisabled:!1,errorMessage:e.errorMessage}}componentDidMount(){this._setErrorMsg()}componentDidUpdate(e,t,n){e.value!=this.props.value&&this.setState({value:this.props.value||""})}_numberChange(e,t){let{min:n,max:r}=this.props,i=e.target.value.replace(/[^\-?\d{1,}\.\d{1,}|\d{1,}]/g,""),l=""!=i&&Number(i)<=n,s=""!=i&&Number(i)>=r;this.setState({value:i,minDisabled:l,maxDisabled:s},()=>{this.props.onChange&&this.props.onChange(e,t)})}_setErrorMsg(){const{errorMessage:e,labelText:t}=this.props;e||this.setState({errorMessage:"请输入"+(t||"内容")})}render(){const{isError:e,errorMessage:t,maxDisabled:n,minDisabled:r}=this.state,{showIcon:s,visible:o,width:a,singleWidth:u=a}=this.props;return o?i.createElement(l.default,Object.assign({},this.props,this.state,{width:u||"64",inputClass:s?"pango-number-input":"",onBlur:(e,t)=>this._onBlur(e,t),onKeydown:(e,t)=>this._numberInput(e,t),onChange:(e,t)=>{this._numberChange(e,t)},onValid:this.onValid,ref:this.inputRef}),s?i.createElement("span",{className:"pango-input-suffix-wrap pango-number-input-suffix-wrap"},i.createElement("i",{className:"pango-input-icon pango-icon-reverse emr-icon-arrowbottom "+(n?"is_disabled":""),onClick:()=>this._arrowClick("add")}),i.createElement("i",{className:"pango-input-icon emr-icon-arrowbottom "+(r?"is_disabled":""),onClick:()=>this._arrowClick("del")})):null,e&&i.createElement("div",{className:"pango-input-error-message",style:{display:"block"}},t)):null}}t.NumberInput=s,s.defaultProps={visible:!0}},function(e,t,n){var r=n(18),i=n(648);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,'.pango-number-input .pango-input-inner {\r\n  padding: 0px 27px 0px 0px;\r\n  font-size: 14px;\r\n  text-align: center;\r\n}\r\n.pango-number-input:hover:not(.is-disabled).pango-input-inner {\r\n  border-color: var(--pango-editor--input-border-active-color);\r\n  box-shadow: 0 0 0 2px var(--pango-editor--input-border-active-shadow-color);\r\n}\r\n.pango-number-input:hover:not(.is-disabled).pango-input-icon {\r\n  color: var(--pango-editor--input-icon-active-color);\r\n}\r\n.pango-number-input:hover.is-disabled .pango-input-icon {\r\n  cursor: not-allowed;\r\n}\r\n.pango-number-input .pango-input-suffix-wrap {\r\n  cursor: pointer;\r\n  pointer-events: auto;\r\n  display: inline-flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  border-left: 1px solid #ddd;\r\n  right: 1px;\r\n  top: 1px;\r\n  height: calc(100% - 2px);\r\n}\r\n.pango-number-input .pango-input-suffix-wrap i{\r\n  font-size: 12px;\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: relative;\r\n}\r\n.pango-number-input .pango-input-suffix-wrap i:before {\r\n  transform: scale(.7);\r\n}\r\n.pango-number-input .pango-input-suffix-wrap i:nth-child(1) {\r\n  border-top-right-radius: 3px;\r\n}\r\n.pango-number-input .pango-input-suffix-wrap i:nth-child(1):after {\r\n  content: "";\r\n  position: absolute;\r\n  width: calc(100% - 1px);\r\n  height: 1px;\r\n  background-color: #ddd;\r\n  top: 0;\r\n}\r\n.pango-number-input .pango-input-suffix-wrap i:nth-child(2) {\r\n  border-bottom-right-radius: 3px;\r\n}\r\n.pango-number-input .pango-input-suffix-wrap i:hover {\r\n  background: #e9e9e9;\r\n}\r\n.pango-number-input .pango-input-suffix-wrap .is_disabled {\r\n  cursor: not-allowed;\r\n  opacity: 0.6;\r\n}\r\n.pango-input-icon.pango-icon-reverse {\r\n  transform: rotate(180deg);\r\n}',""]),e.exports=t},function(e,t,n){(t=n(19)(!1)).push([e.i,'input[type=number] {\r\n    -moz-appearance: textfield;\r\n}\r\ninput[type=number]::-webkit-outer-spin-button,\r\ninput[type=number]::-webkit-inner-spin-button {\r\n    -webkit-appearance: none;\r\n}\r\n\r\n\r\n.pango-input--wrap {\r\n    position: relative;\r\n    display: inline-block;\r\n    vertical-align: top;\r\n}\r\n\r\n.pango-input {\r\n    position: relative;\r\n    display: inline-block;\r\n    vertical-align: middle;\r\n    flex: 1;\r\n}\r\n\r\n.pango-input-inner {\r\n    -webkit-appearance: none;\r\n    background-color: #ffffff;\r\n    background-image: none;\r\n    border-radius: 4px;\r\n    border: 1px solid var(--pango-editor--input-border-color);\r\n    box-sizing: border-box;\r\n    color: var(--pango-editor--input-font-color);\r\n    display: inline-block;\r\n    height: 32px;\r\n    line-height: 32px;\r\n    outline: none;\r\n    padding: 0 16px;\r\n    transition: border-color .2s cubic-bezier(.645, .045, .355, 1), box-shadow .2s cubic-bezier(.645, .045, .355, 1);\r\n    width: 100%;\r\n}\r\n\r\n.pango-input-inner::placeholder {\r\n    color: var(--pango-editor--input-placeholder-color);\r\n}\r\n\r\n.pango-input-inner:hover {\r\n    border-color: var(--pango-editor--input-border-hover-color);\r\n}\r\n\r\n.pango-input-inner:focus {\r\n    border-color: var(--pango-editor-theme);\r\n    box-shadow: 0 0 0 2px var(--pango-editor--input-border-active-shadow-color);\r\n}\r\n\r\n.pango-input-icon {\r\n    color: var(--pango-editor--input-icon-color);\r\n    width: 26px;\r\n    font-size: 16px;\r\n}\r\n\r\n\r\n.pango-input-prefix>.pango-input-inner {\r\n    padding-left: 34px;\r\n}\r\n\r\n.pango-input-prefix-wrap {\r\n    position: absolute;\r\n    height: 100%;\r\n    left: 6px;\r\n    top: 0;\r\n    text-align: center;\r\n    pointer-events: none;\r\n}\r\n\r\n\r\n.pango-input-suffix>.pango-input-inner {\r\n    padding-right: 34px;\r\n}\r\n\r\n.pango-input-suffix-wrap,\r\n.pango-input-clearable-wrap {\r\n    position: absolute;\r\n    height: 100%;\r\n    right: 6px;\r\n    top: 0;\r\n    text-align: center;\r\n    pointer-events: none;\r\n}\r\n\r\n\r\n.pango-input-clearable>.pango-input-inner {\r\n    padding-right: 34px;\r\n}\r\n\r\n.pango-input-clearable.pango-input-suffix>.pango-input-inner {\r\n    padding-right: 58px;\r\n}\r\n\r\n.pango-input-clearable-wrap {\r\n    cursor: pointer;\r\n    pointer-events: all;\r\n}\r\n\r\n.pango-input-clearable.pango-input-suffix>.pango-input-clearable-wrap {\r\n    right: 34px;\r\n}\r\n\r\n.pango-input-clearable-wrap:hover>.pango-input-icon,\r\n.pango-input-inner:focus~.pango-input-prefix-wrap>.pango-input-icon,\r\n.pango-input-inner:focus~.pango-input-suffix-wrap>.pango-input-icon {\r\n    color: var(--pango-editor--input-icon-active-color);\r\n}\r\n\r\n.is-input-error .pango-input-inner {\r\n    border-color: var(--pango-editor--input-border-validate-color);\r\n    box-shadow: 0 0 0 2px var(--pango-editor--input-border-validate-shadow-color);\r\n}\r\n\r\n.pango-input-error-message {\r\n    position: absolute;\r\n    color: var(--pango-editor--input-border-validate-color);\r\n    padding-top: 2px;\r\n    font-size: var(--pango-editor--fs12px);\r\n    top: 100%;\r\n    opacity: 1;\r\n    left: 0;\r\n    line-height: 1;\r\n}\r\n\r\n.pango-input-mix {\r\n    display: inline-table;\r\n    border-collapse: separate;\r\n    border-spacing: 0;\r\n}\r\n\r\n\r\n\r\n.pango-input-prepend,\r\n.pango-input-append {\r\n    background-color: var(--pango-editor--border-input-color);\r\n    color: var(--pango-editor--font-sub-title-color);\r\n    vertical-align: middle;\r\n    display: table-cell;\r\n    position: relative;\r\n    border: 1px solid var(--pango-editor--input-border-color);\r\n    border-radius: 4px;\r\n    font-size: var(--pango-editor--fs14px);\r\n    padding: 0 16px;\r\n    width: 1px;\r\n    white-space: nowrap;\r\n}\r\n\r\n.pango-input-prepend {\r\n    border-right: 0;\r\n    border-top-right-radius: 0;\r\n    border-bottom-right-radius: 0;\r\n}\r\n\r\n.pango-input-append {\r\n    border-left: 0;\r\n    border-top-left-radius: 0;\r\n    border-bottom-left-radius: 0;\r\n}\r\n\r\n.pango-input-mix>.pango-input-inner {\r\n    vertical-align: middle;\r\n    display: table-cell;\r\n}\r\n\r\n.pango-input-mix-prepend>.pango-input-inner {\r\n    border-top-left-radius: 0;\r\n    border-bottom-left-radius: 0;\r\n}\r\n\r\n.pango-input-mix-append>.pango-input-inner {\r\n    border-top-right-radius: 0;\r\n    border-bottom-right-radius: 0;\r\n}\r\n\r\n.pango-input-button-append {\r\n    display: table-cell;\r\n    vertical-align: middle;\r\n}\r\n\r\n.pango-input-button-append>.pango-button {\r\n    border-top-left-radius: 0;\r\n    border-bottom-left-radius: 0;\r\n}\r\n\r\n.pango-input-label {\r\n    display: inline-block;\r\n    font-size: var(--pango-editor--fs16px);\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    vertical-align: middle;\r\n    margin-right: 16px;\r\n}\r\n\r\n.label-align-left {\r\n    text-align: left;\r\n}\r\n\r\n.label-align-right {\r\n    text-align: right;\r\n}\r\n\r\n.is-required>.pango-input:before {\r\n    content: "*";\r\n    position: absolute;\r\n    top: 2px;\r\n    left: -14px;\r\n    font-size: var(--pango-editor--fs18px);\r\n    color: var(--pango-editor--input-border-validate-color);\r\n}\r\n\r\n.is-disabled.pango-input {\r\n    pointer-events: none;\r\n}\r\n\r\n.is-disabled>.pango-input-inner,\r\n.is-disabled>.pango-input-inner:focus {\r\n    background: var(--pango-editor--border-input-color);\r\n    border-color: var(--pango-editor--input-border-color);\r\n    color: var(--pango-editor--input-font-disabled-color);\r\n    box-shadow: none;\r\n    cursor: not-allowed;\r\n}\r\n\r\n.is-disabled .pango-input-icon,\r\n.is-disabled>.pango-input-inner:focus+.pango-input-prefix-wrap>.pango-input-icon,\r\n.is-disabled>.pango-input-inner:focus+.pango-input-suffix-wrap>.pango-input-icon {\r\n    color: var(--pango-editor--input-font-disabled-color);\r\n}',""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Calculator=void 0;const r=n(27),i=n(651);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();if(super(t,e),null!=this._Comp&&this._Comp.Child)this._Comp.updateProps(e),this.IsUpdated=!0;else{this.divID="_CalendarComp"+(new Date).getTime();const e=Object.assign({divID:this.divID},this.InitProps);this._Comp=new i.CalculatorWithUnitComp(t,e),this.IsUpdated=!1}}DefaultProps(){return{value:"",top:0,left:0}}}t.Calculator=l},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CalculatorWithUnitComp=exports.CalculatorWithUnit=void 0;const React=__webpack_require__(12),ReactDom=__webpack_require__(24);__webpack_require__(327);const Popover_1=__webpack_require__(74),BaseComponent_1=__webpack_require__(22);class CalculatorWithUnit extends React.Component{constructor(e){super(e),this.inputRef=React.createRef(),this.tabIndex=0,this.num1="",this.num2="",this.oper="",this.canceBtnId="calculatorpopCance",this.nearNode=null,this.compositionMode=!1,this.popClassName="",this.inputHandler=e=>{if("insertCompositionText"==e.inputType){if(this.compositionMode)return void(this.compositionMode=!1);this.compositionMode=!0}e.preventDefault();let t="";switch(e.inputType){case"deleteContentBackward":t="←";break;case"deleteContentForward":case"Escape":t="AC";break;default:t=e.data}this.buttonHandler(t,!0)},this.keyHandler=e=>{if(40==e.which){const t=e.target,n=this.getNextNode(t.nextSibling.nextSibling.children[0].children[0].children[0],"INPUT");null!=n&&n.focus(),e.preventDefault()}else 13==e.which&&this.buttonHandler("=",!0)},this.keyPressHandler=e=>{let t=String.fromCharCode(e.which);/\d|\./.test(t)||e.preventDefault();const n=e.target.value;/(^\d*\.?$)|(^\d*\.?\d*$)/.test(n+t)||e.preventDefault()},this.keyUpHandler=e=>{e.target.value=e.target.value.replace(/[^0-9.]/g,"")},this.okHandler=()=>{let e=this.inputRef.current.value,t="",n=this.state.unitList;for(let e=0;e<n.length;e++){let r=n[e];if(r.checked){t=r.Value;break}}this.props.onOk&&this.props.onOk(e,t)},this.closeHandler=(e=!1)=>{"function"==typeof this.props.onClose&&this.props.onClose(e),this.setState({isRender:!1})},this.updateEvent=e=>{const{left:t,top:n,value:r}=this.state;let i=[];e.value!=r&&i.push({item:"value",value:e.value}),e.left!=t&&i.push({item:"left",value:e.left}),e.top!=n&&i.push({item:"top",value:e.top}),i.length>0&&this.setState((e,t)=>{let n={isRender:!0};return i.forEach(e=>{n[e.item]=e.value}),n})},this.buttonHandler=this.buttonHandler.bind(this),this.btnKeyUpHandler=this.btnKeyUpHandler.bind(this),this.state={isRender:!0,value:e.value,unitList:e.dataList.ToArray(),unit:e.unit},this.props.divID&&(this.popClassName+=" "+this.props.divID)}componentDidMount(){this.props.parent.React=this,this.setValue(this.state.value),setTimeout(()=>this.inputRef.current.focus(),100)}setValue(e){this.inputRef.current.value=e}buttonHandler(e,t){if(t=null!=t&&t,/[\d.]/.test(e))""==this.oper?isNaN(Number(this.num1+e))||(this.num1+=e):isNaN(Number(this.num2+e))||(this.num2+=e);else if(/[+\-*\/]/.test(e))""==this.oper?""==this.num1?"-"==e&&(this.num1=e):this.oper=e:this.calculate()&&(this.oper=e);else switch(e){case"AC":this.num1="",this.num2="",this.oper="";break;case"←":this.num2.length>0?this.num2=this.num2.substr(0,this.num2.length-1):""!=this.oper?this.oper="":this.num1.length>0&&(this.num1=this.num1.substr(0,this.num1.length-1));break;case"%":(""!=this.num1&&""==this.num2||""!=this.num2&&this.calculate())&&this.percent();break;case"=":if(t)return this.okHandler(),void this.setState({isRender:!1});this.calculate()}t||(this.inputRef.current.value=this.num1+this.oper+this.num2),this.inputRef.current.focus()}percent(){this.num1=parseFloat(this.num1)/100+""}calculate(){try{""!=this.num1&&""!=this.oper&&""!=this.num2&&(this.num1=eval(this.num1+this.oper+this.num2)+"")}catch(e){return!1}return this.oper="",this.num2="",!0}UnitClick(e,t){let n=this.state.unitList;for(let e=0;e<n.length;e++){let r=n[e];r.checked=t==r}this.setState({unitList:n})}hotKeyHandler(e,t){if(13==e.which){let n=this.state.unitList;for(let e=0;e<n.length;e++){let r=n[e];r.checked=t==r}this.setState({unitList:n}),e.target.checked=!0}else{const t=e.target;let n,r=t.labels;r&&r.length>0&&(r=r[0]),38==e.which?(n=this.getNextNode(r.previousSibling,"INPUT"),(e.altKey||null==n)&&(this.inputRef.current.focus(),n=null)):40==e.which&&(n=this.getNextNode(r.nextSibling,"INPUT"),null==n&&(this.nearNode=t,n=this.getNextNode(r.parentNode.parentNode.parentNode.nextSibling.children[0],"BUTTON"))),null!=n&&n.focus()}e.preventDefault(),e.stopPropagation()}renderUnitArea(){const e=this.state.unitList;this.state.unit;let t=e.map((e,t)=>React.createElement("label",{className:"pango-editor-unit-item "+(e.checked?"active":null),key:"radio"+t},React.createElement("input",{type:"radio",value:e.val,name:e.group||"radio",tabIndex:++this.tabIndex,defaultChecked:e.checked,onClick:t=>{this.UnitClick(t,e)},onKeyDown:t=>{this.hotKeyHandler(t,e)}}),e.Value));return React.createElement("div",{className:"pango-editor-unitList",id:"pango-editor-unitList",style:{display:"flex",flexDirection:"column"}},t)}render(){let{target:e,top:t,left:n,divID:r}=this.props,{isRender:i}=this.state;return React.createElement(Popover_1.default,{className:this.popClassName,top:t,left:n,showOkBtn:!0,showCancelBtn:!0,target:e,isShow:i,isRender:i,onOk:this.okHandler,onClose:this.closeHandler,canceBtnId:this.canceBtnId,btnAllowEnter:!0,btnKeyUp:this.btnKeyUpHandler},React.createElement("div",{className:"pango-editor-cal-input"},React.createElement("input",{className:"input-text",type:"text",ref:this.inputRef,placeholder:"请输入",onInput:this.inputHandler,onKeyDown:this.keyHandler,onKeyPress:this.keyPressHandler,onKeyUp:this.keyUpHandler}),React.createElement("i",{className:"cal-toggle-button emr-icon-designformulas"}),React.createElement("div",{className:"pango-editor-unitList",style:{height:"150px",overflow:"auto"}},this.renderUnitArea())))}btnKeyUpHandler(e){const t=e.target;if(38==e.which)e.altKey?this.inputRef.current.focus():this.nearNode.focus();else{let n;37==e.which?n=t.previousSibling:39==e.which&&(n=t.nextSibling),null!=n&&"BUTTON"==n.nodeName.toUpperCase()&&n.focus()}}getNextNode(e,t,n){if(e){if(e.nodeName.toUpperCase()==t)return e;{const r=e.children;if(r&&r.length>0){let e=null;for(let i=0;i<r.length;i++){let l=r[i];if(n>0&&null!=r[n]&&(l=r[n]),l.clientHeight>0){e=this.getNextNode(l,t);break}}return e}return null}}return null}}exports.CalculatorWithUnit=CalculatorWithUnit;class CalculatorWithUnitComp extends BaseComponent_1.BaseComponent{constructor(e,t){super(e,t),this.updateProps=e=>{this.Child&&this.Child.updateEvent(e)}}Render(){const e=React.createElement(CalculatorWithUnit,Object.assign({},this.Props,{parent:this,onRef:e=>this.Child=e}));ReactDom.render(e,document.createDocumentFragment())}}exports.CalculatorWithUnitComp=CalculatorWithUnitComp},function(e,t,n){(t=n(19)(!1)).push([e.i,".header-content {\r\n    height: 30px;\r\n}\r\n\r\n.body-content {\r\n    width: 188px;\r\n    text-align: center;\r\n    border-collapse: collapse;\r\n    margin: 6px 10px 10px 10px;\r\n}\r\n\r\n.body-content tr td {\r\n    width: 40px;\r\n    height: 30px;\r\n    border: 1px solid #d4d4d4;\r\n    cursor: pointer;\r\n}\r\n\r\n.body-content tr td button {\r\n    height: 30px;\r\n    line-height: 30px;\r\n    text-align: center;\r\n    user-select: none;\r\n    font-size: 16px;\r\n    color: #000000;\r\n    letter-spacing: 0;\r\n    font-weight: 700;\r\n\r\n    width: 100%;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    border: 0;\r\n    outline: 0;\r\n}\r\n\r\n.body-content tr td button:focus,\r\n.body-content tr td button:hover {\r\n    background-color: var(--pango-editor-theme-back-select);\r\n}\r\n\r\n.pango-editor-cal-input {\r\n    width: 188px;\r\n    margin: 10px 10px 10px 10px;\r\n}\r\n\r\n.pango-editor-cal-input .input-text {\r\n    text-align: right;\r\n    -webkit-appearance: none;\r\n    background-color: #ffffff;\r\n    background-image: none;\r\n    border-radius: 4px;\r\n    border: 1px solid #C9C9C9;\r\n    box-sizing: border-box;\r\n    color: #000000;\r\n    display: inline-block;\r\n    height: 32px;\r\n    line-height: 32px;\r\n    outline: none;\r\n    padding: 0 16px;\r\n    transition: border-color .2s cubic-bezier(.645, .045, .355, 1);\r\n    width: 160px;\r\n    margin-right: 4px;\r\n    vertical-align: middle;\r\n}\r\n\r\n.pango-editor-cal-input .input-text:focus,\r\n.pango-editor-cal-input .input-text:hover {\r\n    border-color: #999999;\r\n}\r\n\r\n.pango-editor-cal-input .cal-toggle-button {\r\n    display: inline-block;\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 23px;\r\n    vertical-align: middle;\r\n    color: var(--pango-editor-theme);\r\n    cursor: pointer;\r\n}\r\n\r\n.popover-buttonArea button:focus,\r\n.body-content tr td button:focus,\r\n.input-text:focus {\r\n    outline-color: var(--pango-editor-theme);\r\n    outline-width: 1px;\r\n    outline-offset: 0;\r\n    outline-style: auto;\r\n}\r\n\r\n.popover-buttonArea button:focus {\r\n    outline-offset: 3px;\r\n}\r\n\r\n\r\n.pango-editor-unitList::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n.pango-editor-unitList::-webkit-scrollbar-thumb {\r\n    border-left: 1px solid #ffffff;\r\n    border-right: 2px solid #ffffff;\r\n    border-radius: 4px;\r\n    background: rgba(58, 58, 58, 0.4);\r\n}\r\n\r\n.pango-editor-unit-item {\r\n    height: 32px;\r\n    line-height: 32px;\r\n}\r\n\r\n.pango-editor-unit-item:hover {\r\n    color: #565656;\r\n    background-color: #ECF0F4;\r\n}\r\n\r\n\r\n.pango-editor-unitList label:focus-within{\r\n    color: #565656;\r\n    background-color: #ECF0F4;\r\n}\r\n.pango-editor-unitList label.active {\r\n    background: rgba(142, 182, 195, 0.4);\r\n}\r\n\r\n\r\n.pango-editor-unitList>label>input {\r\n    width: 0;\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrDropDowmControl=void 0;const r=n(38),i=n(654),l=n(657);t.EmrDropDowmControl=class{constructor(){this.HasSearch=!0,this.Init()}Init(){this.DataSource=new r.List,this.SelectIndexList=new r.List}AddItems(e){if(null!=e){let t=this.DataSource.Count()-1;t<=0&&(t=0),e=this.BulidSelItems(e,t),this.DataSource.InsertRange(t,e.ToArray())}}BulidSelItems(e,t=0){let n;if(null==e||0==e.Count())n=null;else{let i=new r.List,l=0,s=0;const o=e.GetEnumerator();for(;o.MoveNext();){const n=o.Current;l++;let r,a=0;r=this.GetAllChileSelItems(i,n,a,null,t+s+e.Count()),i=r[0],a=r[1],n.Index!=t+l&&(n.Index=t+l),s=n.ChildEleItems.Count()}n=i}return n}GetAllChileSelItems(e,t,n,r,i){if(t.Level=n,n++,this.ExistSelInx(r,t.ChildEleItems)&&e.Add(t),t.ChildEleItems.Count()>0){let r=0;const l=t.ChildEleItems.GetEnumerator();for(;l.MoveNext();){const t=l.Current;r++,t.Level=n,t.Index!=i+r&&(t.Index=i+r),e.Add(t)}}return[e,n]}ExistSelInx(e,t){if(null==e)return!0;if(null==this.SelectIndexList||0==this.SelectIndexList.Count())return!1;let n=e.Index,r=-1!=this.SelectIndexList.IndexOf(n.toString());if(r)return!0;const i=e.ChildEleItems.GetEnumerator();for(;i.MoveNext();){const e=i.Current;if(r=-1!=this.SelectIndexList.IndexOf(e.Index.toString()),r)break}if(r)return!0;if(null==t)return!1;const l=t.GetEnumerator();for(;l.MoveNext();){const e=l.Current;if(r=-1!=this.SelectIndexList.IndexOf(e.Index.toString()),r)break}return r}Layout(e){null!=this.DataSource&&(this.IsMulity,this.IsHaveNoEle,this.location=e,this.CreateRenders())}CreateRenders(){let e=[];const t=this.DataSource.GetEnumerator();for(;t.MoveNext();){const n=t.Current;e.push({txt:n.Value,val:n.Index,group:n.GroupNum,level:n.Level,check:null!=this.SelectIndexList&&-1!=this.SelectIndexList.IndexOf(n.Index.toString())})}let n=this.IsMulity?"_CheckboxComp":"_RadioComp";n+=""+(new Date).getTime();const r={data:e,top:this.location.Y,left:this.location.X,inputEleXID:this.inputEleXID,disFreeInput:this.disFreeInput,hasSearch:this.HasSearch},s=Object.assign({onOk:this.SelectedEventHandler.bind(this),onClose:this.CloseEventHandler.bind(this),divID:n},r);if(this.IsMulity)null!=this._CheckboxComp&&this._CheckboxComp.Child?(this._CheckboxComp.updateProps(r),this.IsUpdated=!0):(this._CheckboxComp=new l.CheckboxComp(s),this.IsUpdated=!1,this.divID=n),this._Comp=this._CheckboxComp;else{let e=!(null==this.SelectIndexList||0==this.SelectIndexList.Count());null!=this._RadioComp&&this._RadioComp.Child?(this._RadioComp.updateProps(Object.assign({hasValue:e},r)),this.IsUpdated=!0):(this._RadioComp=new i.RadioComp(Object.assign({hasValue:e},s)),this.IsUpdated=!1,this.divID=n),this._Comp=this._RadioComp}this._showTextList=this.GetDropDownShowTextItems()}GetDropDownShowTextItems(){if(null==this.DataSource)return null;let e,t=[];const n=this.DataSource.GetEnumerator();for(;n.MoveNext();){const e=n.Current;t.push(e.Value)}return e=new r.List(t),e}CloseEventHandler(e=!1){null!=this.CloseEvent&&this.CloseEvent(e)}SelectedEventHandler(e,t=null,n=!1){null!=this.SelectedOkEvent&&(this._selectItems=this.GetSelectItems(e),this.SelectedOkEvent(this._selectItems,this.IsHaveNoEle?this.GetNotSelectItems(e):null,this.IsHaveNoEle,t,n))}GetSelectItems(e){let t=new r.List;if(e instanceof Array&&e.length>0){const n=this.DataSource.GetEnumerator();for(;n.MoveNext();){const r=n.Current;-1!=e.indexOf(r.Index.toString())&&t.Add(r)}}return t}GetNotSelectItems(e){let t=new r.List;e instanceof Array&&e.length>0||(e=[""]);const n=this.DataSource.GetEnumerator();for(;n.MoveNext();){const r=n.Current;-1==e.indexOf(r.Index.toString())&&t.Add(r)}return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadioComp=void 0;const r=n(12),i=n(24),l=n(74);n(655);const s=n(22),o=n(170);class a extends r.Component{constructor(e){super(e),this.inputRef=r.createRef(),this.labelInputRef=r.createRef(),this.firstInputRef=r.createRef(),this.lastInputRef=r.createRef(),this.tabIndex=0,this.popClassName="checkboxpop",this.countdownTime=200,this.countdownSetTimeOut=null,this.countdownValue=null,this.closeEvent=(e=!1)=>{this.countdownValue=null,"function"==typeof this.props.onClose&&this.props.onClose(e),this.setState({isRender:!1,contentData:""})},this.searchInputChange=e=>{this.setState({searchValue:e.target.value})},this.updateEvent=e=>{const{inputEleXID:t,left:n,top:r,hasSearch:i}=this.state;let l=[];e.inputEleXID!=t&&(l.push({item:"inputEleXID",value:e.inputEleXID}),l.push({item:"contentData",value:e.data})),e.left!=n&&l.push({item:"left",value:e.left}),e.top!=r&&l.push({item:"top",value:e.top}),e.hasSearch!=i&&l.push({item:"hasSearch",value:e.hasSearch}),l.length>0&&this.setState((e,t)=>{let n={isRender:!0,hiddenVal:[]};return l.forEach(e=>{n[e.item]=e.value}),n})},this.okHandler=this.okHandler.bind(this),this.EmptyValue=this.EmptyValue.bind(this),this.KeyEmptyValue=this.KeyEmptyValue.bind(this),this.keyUpHandler=this.keyUpHandler.bind(this),this.hotKeyHandler=this.hotKeyHandler.bind(this),this.DoubleClickHandler=this.DoubleClickHandler.bind(this),this.state={isRender:!0,hiddenVal:[],top:e.top||0,left:e.left||0,inputEleXID:e.inputEleXID||"",contentData:e.data||[],disFreeInput:e.disFreeInput,hasSearch:e.hasSearch,searchValue:"",hasValue:e.hasValue},this.props.divID&&(this.popClassName+=" "+this.props.divID)}componentDidMount(){setTimeout(()=>{this.labelInputRef&&this.labelInputRef.current?this.labelInputRef.current.focus():this.inputRef&&this.inputRef.current?this.inputRef.current.focus():this.firstInputRef&&this.firstInputRef.current&&this.firstInputRef.current.focus()},100)}KeyEmptyValue(e){e.which}EmptyValue(e){if(e&&e.nativeEvent&&null==this.countdownValue){const t=this,n=this.countdownTime,r=[e.target.defaultValue],i="function"==typeof this.props.onOk&&null!=r;this.countdownValue=r,clearTimeout(this.countdownSetTimeOut),this.countdownSetTimeOut=setTimeout(()=>{i&&t.props.onOk("","",!0),t.closeEvent()},n)}e.preventDefault(),e.stopPropagation()}okHandler(e){if(e&&e.nativeEvent&&null==this.countdownValue){const t=this,n=this.countdownTime,r=[e.target.defaultValue],i="function"==typeof this.props.onOk&&null!=r;this.countdownValue=r,clearTimeout(this.countdownSetTimeOut),this.countdownSetTimeOut=setTimeout(()=>{i&&t.props.onOk(r),t.closeEvent()},n)}}DoubleClickHandler(e){null!=this.countdownValue&&(clearTimeout(this.countdownSetTimeOut),"function"==typeof this.props.onOk&&this.props.onOk(this.countdownValue),this.closeEvent())}keyUpHandler(e){const{disFreeInput:t}=this.state;if(13==e.which&&t){const t=e.target.value.toString().trim();"function"==typeof this.props.onOk&&this.props.onOk(null,t),this.closeEvent()}else if(40==e.which||38==e.which){const t=e.target;if(t){const e=t.parentNode.parentNode.previousSibling;if(e){const t=this.getChildrenInput(e);null!=t&&(t.checked=!0,t.focus())}}}else{const e=this.inputRef.current.value.toString().trim();let t=[];this.state.contentData.map(n=>{n.txt||(n.txt=""),e&&-1==n.txt.indexOf(e)&&t.push(n.val.toString())}),this.setState({hiddenVal:t,searchValue:e})}}hotKeyHandler(e){if(e.preventDefault(),13==e.which)"function"==typeof this.props.onOk&&this.props.onOk([e.target.defaultValue]),this.closeEvent();else if(46==e.which)this.props.onOk("","",!0),this.closeEvent();else{let t,n=e.target.labels;n&&n.length>0&&(n=n[0]),38==e.which?(t=this.getChildrenInput(n.previousSibling),null==t&&this.lastInputRef&&this.lastInputRef.current&&(t=this.lastInputRef.current)):40==e.which&&(t=this.getChildrenInput(n.nextSibling),null==t&&this.firstInputRef&&this.firstInputRef.current&&(t=this.firstInputRef.current)),(null==t||e.altKey)&&(t=this.inputRef&&this.inputRef.current?this.inputRef.current:this.labelInputRef.current),null!=t&&t.focus()}}renderLabels(){const{contentData:e,hiddenVal:t,hasValue:n}=this.state;let i=e?e.map((i,l)=>{const s=-1!=t.indexOf(i.val.toString()),o=n&&i.check?this.labelInputRef:0==l?this.firstInputRef:l==e.length-1?this.lastInputRef:null;return r.createElement("label",{className:i.check?"active":null,key:"radio"+l,onDoubleClick:this.DoubleClickHandler,style:{display:s?"none":"block",paddingLeft:10*i.level+10+"px"}},r.createElement("input",{type:"radio",value:i.val,name:i.group||"radio",tabIndex:++this.tabIndex,defaultChecked:i.check,onClick:this.okHandler,onKeyDown:this.hotKeyHandler,ref:o}),r.createElement("span",null,i.txt),i.check?r.createElement("span",{onClick:this.EmptyValue,onKeyDown:this.KeyEmptyValue,style:{float:"right"}},"×"):"")}):"";return r.createElement("div",{className:"pango-editor-radio"},i)}render(){return r.createElement(l.default,{className:this.popClassName,onClose:this.closeEvent,showOkBtn:!1,showCancelBtn:!1,isShow:this.state.isRender,isRender:this.state.isRender,top:this.state.top,left:this.state.left},this.renderLabels(),this.state.hasSearch?r.createElement(o.default,{inputClass:"checkbox-searchvalue pango-input-prefix",value:this.state.searchValue,width:"180",ref:this.inputRef,onKeyup:this.keyUpHandler,onChange:this.searchInputChange,placeholder:"搜索选项"},r.createElement("span",{className:"pango-input-prefix-wrap"},r.createElement("i",{className:"pango-input-icon emr-icon-search",style:{lineHeight:"32px"}}))):null)}getChildrenInput(e){if(!e)return null;if("INPUT"==e.nodeName.toUpperCase())return e;{const t=e.children;if(t&&t.length>0){let e=null;for(let n=0;n<t.length;n++){const r=t[n];if(r.clientHeight>0){e=this.getChildrenInput(r);break}}return e}return null}}}class u extends s.BaseComponent{constructor(e,t=null){super(t,e),this.updateProps=e=>{this.Child&&this.Child.updateEvent(e)}}Render(){const e=r.createElement(a,Object.assign({},this.Props,{parent:this,onRef:e=>this.Child=e}));i.render(e,document.createDocumentFragment())}}t.RadioComp=u},function(e,t,n){var r=n(18),i=n(656);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".checkboxpop .customizeFocus,\r\n#checkboxpopOk:focus,\r\n#checkboxpopOk:focus {\r\n    outline-offset: 3px;\r\n}\r\n.pango-editor-radio {\r\n    overflow: auto;\r\n    max-height: 200px;\r\n    padding: 10px 0 0 0;\r\n}\r\n.pango-editor-radio label {\r\n    font-size: 16px;\r\n    color: #000000;\r\n    padding: 0 10px;\r\n    display: block;\r\n    min-height: 32px;\r\n    line-height: 32px;\r\n}\r\n.pango-editor-radio label:hover {\r\n    background: #EAEEFE;\r\n}\r\n\r\n.pango-editor-radio label>input {\r\n    vertical-align: middle;\r\n}\r\n.pango-editor-radio label>span {\r\n    margin-left: 4px;\r\n    vertical-align: middle;\r\n}\r\n.pango-editor-radio label:hover,\r\n.pango-editor-radio label:focus-within\r\n{\r\n    background: #ECF0F4;\r\n}\r\n.pango-editor-radio label.active {\r\n    background: rgba(142,182,195, 0.4);\r\n}\r\n\r\n.pango-editor-radio>label>input {\r\n    width: 0;\r\n}\r\n\r\n.checkbox-searchvalue {\r\n    margin: 0 10px 10px 10px;\r\n}\r\n\r\n.pango-editor-radio::-webkit-scrollbar {\r\n    width: 8px;     \r\n    height: 8px;\r\n}\r\n.pango-editor-radio::-webkit-scrollbar-thumb {\r\n    border-left: 1px solid #ffffff;\r\n    border-right: 2px solid #ffffff;\r\n    border-radius: 4px;\r\n    background: rgba(58,58,58,0.4);\r\n}\r\n.pango-editor-radio::-webkit-scrollbar-track {\r\n    background: #FFFFFF;\r\n}\r\n.pango-editor-radio::-webkit-scrollbar-thumb:active {\r\n    background: rgba(58,58,58,1);\r\n}\r\n\r\n",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckboxComp=void 0;const r=n(12),i=n(24),l=n(74);n(658);const s=n(22),o=n(170),a=n(139),u=n(660);class h extends r.Component{constructor(e){super(e),this.changeHandler=this.changeHandler.bind(this),this.hotKeyHandler=this.hotKeyHandler.bind(this),this.state={checked:e.item.check,preStatus:0}}render(){return r.createElement("input",{style:{width:0,margin:"3px 3px 3px 4px"},type:"checkbox",value:this.props.item.val,name:this.props.item.group||"checkbox",checked:this.state.checked,onChange:this.changeHandler,onKeyDown:this.hotKeyHandler})}componentWillReceiveProps(e){const t=e.checkstatus;this.state.preStatus!=t&&(1==t?this.setState({checked:!this.state.checked,preStatus:t}):2==t?this.setState({checked:!0,preStatus:t}):3==t&&this.setState({checked:!1,preStatus:t}))}changeHandler(e){const t=e.target.checked;this.setState({checked:t}),this.props.changeDataEvent(this.props.item.val,t)}hotKeyHandler(e){if(13==e.which){const t=e.target.checked;this.setState({checked:!t}),this.props.changeDataEvent(this.props.item.val,!t)}else this.props.hotKeyEvent(e)}}class d extends r.Component{constructor(e){super(e),this.inputRef=r.createRef(),this.confirmButtonRef=r.createRef(),this.checkAllButtonRef=r.createRef(),this.checkReverseButtonRef=r.createRef(),this.popClassName="checkboxpop",this.okBtnId="checkboxpopOk",this.searchInputChange=e=>{this.setState({searchValue:e.target.value})},this.handleButtonKeyDown=(e,t)=>{switch(e.which){case 38:if(this.inputRef&&this.inputRef.current)this.inputRef.current.focus();else{const t=e.target;if(t){const e=t.parentNode.previousSibling;if(e){const t=this.getChildrenInput(e,"BUTTON");null!=t&&t.focus()}}}break;case 37:"confirm"==t&&this.checkReverseButtonRef.current.buttonRef.current.focus(),"checkReverse"==t&&this.checkAllButtonRef.current.buttonRef.current.focus();break;case 39:"checkAll"==t&&this.checkReverseButtonRef.current.buttonRef.current.focus(),"checkReverse"==t&&this.confirmButtonRef.current.buttonRef.current.focus()}},this.checkHandler=e=>{const t=this.state.hiddenVal.length;let n=this.state.checkVal.length,r=this.state.checkValAll.length,i=[],l=[];t>0?(this.state.checkVal.map((e,t)=>{-1!=this.state.hiddenVal.indexOf(e)&&i.push(e)}),this.state.checkValAll.map((e,t)=>{-1==this.state.hiddenVal.indexOf(e)&&l.push(e)}),r-=t,n-=i.length):l=this.state.checkValAll;let s=this.state.hiddenCheckLen,o=this.state.hiddenValShow,a=[];if(o&&(r+=i.length,n+=i.length,a=i,i=[],s=0,o=!1),"checkall"==e)r==n?this.setState({checkVal:i,isCheckedAll:!1,childstatus:3,hiddenCheckLen:s,hiddenValShow:o,childCheck:a}):this.setState({checkVal:[...l,...i],isCheckedAll:!0,childstatus:2});else if("checkreverse"==e){let e=[];l.map((t,n)=>{-1==this.state.checkVal.indexOf(t)&&e.push(t)}),e=[...e,...i],this.setState({checkVal:e,isCheckedAll:!1,childstatus:1,hiddenCheckLen:s,hiddenValShow:o,childCheck:a})}},this.changeDataEvent=(e,t)=>{let n=this.state.checkVal;const r=n.indexOf(e.toString());let i=this.state.hiddenCheckLen;-1==r?t&&(n=[e.toString(),...n]):(t||n.splice(r,1),-1!=this.state.hiddenVal.indexOf(e.toString())&&i--);let l=!0;this.state.checkValAll.map(e=>{if(-1==this.state.hiddenVal.indexOf(e)&&-1==n.indexOf(e))return l=!1,!1});let s=this.state.hiddenValShow;i<=0&&(s=!1),this.setState({checkVal:n,isCheckedAll:l,hiddenCheckLen:i,hiddenValShow:s})},this.okEvent=()=>{"function"==typeof this.props.onOk&&this.props.onOk(this.state.checkVal),this.closeEvent()},this.closeEvent=(e=!1)=>{"function"==typeof this.props.onClose&&this.props.onClose(e),this.setState({isRender:!1})},this.getContentParam=e=>{let t=[],n=[],r=[],i=[],l=[],s=e.map((e,t)=>{i.push(e.val.toString()),e.check&&r.push(e.val.toString());let s=n.indexOf(e.group);return-1==s&&(s=n.length,n.push(e.group)),s++,e.groupName="组"+s,l[s-1]=e.groupName,e});return t[0]=s||[],t[1]=r||[],t[2]=i||[],t[3]=l||[],t},this.updateEvent=e=>{const{inputEleXID:t,left:n,top:r,hasSearch:i}=this.state;let l=[];if(e.inputEleXID!=t){l.push({item:"inputEleXID",value:e.inputEleXID});const t=this.getContentParam(e.data),n=t[0],r=t[1],i=t[2],s=t[3];l.push({item:"contentData",value:n}),l.push({item:"checkVal",value:r}),l.push({item:"checkValAll",value:i}),l.push({item:"groups",value:s}),l.push({item:"isCheckedAll",value:i.length==r.length})}e.left!=n&&l.push({item:"left",value:e.left}),e.top!=r&&l.push({item:"top",value:e.top}),e.hasSearch!=i&&l.push({item:"hasSearch",value:e.hasSearch}),l.length>0&&this.setState((e,t)=>{let n={isRender:!0,childstatus:0,hiddenVal:[],hiddenValShow:!1,hiddenCheckLen:0,childCheck:[]};return l.forEach(e=>{n[e.item]=e.value}),n})},this.hiddenHandler=this.hiddenHandler.bind(this),this.keyUpHandler=this.keyUpHandler.bind(this),this.keyUpCheckedHandler=this.keyUpCheckedHandler.bind(this),this.keyUpBtnHandler=this.keyUpBtnHandler.bind(this),this.hotKeyEvent=this.hotKeyEvent.bind(this);const t=this.getContentParam(e.data),n=t[0],i=t[1],l=t[2],s=t[3];this.inputRef=r.createRef(),this.state={isRender:!0,childstatus:0,hiddenVal:[],hiddenValShow:!1,hiddenCheckLen:0,childCheck:[],top:e.top||0,left:e.left||0,inputEleXID:e.inputEleXID||"",disFreeInput:e.disFreeInput,hasSearch:e.hasSearch,contentData:n||[],checkVal:i||[],checkValAll:l||[],isCheckedAll:l.length==i.length,groups:s,searchValue:""},this.props.divID&&(this.popClassName+=" "+this.props.divID)}render(){return r.createElement(l.default,{className:this.popClassName,showOkBtn:!1,okBtnId:this.okBtnId,btnAllowEnter:!0,onOk:this.okEvent,onClose:this.closeEvent,showCancelBtn:!1,isShow:this.state.isRender,isRender:this.state.isRender,top:this.state.top,left:this.state.left},this.renderLabels(),this.state.hasSearch?r.createElement(o.default,{inputClass:"pango-input-prefix",value:this.state.searchValue,left:10,width:"188",ref:this.inputRef,onKeydown:this.keyUpHandler,onChange:this.searchInputChange,placeholder:"搜索选项"},r.createElement("span",{className:"pango-input-prefix-wrap"},r.createElement("i",{className:"pango-input-icon emr-icon-search",style:{lineHeight:"32px"}}))):null,r.createElement("div",{className:"pango-editor-checkbox-button"},r.createElement(a.Button,{key:"checkall_button",type:"default",onKeyDown:e=>{this.handleButtonKeyDown(e,"checkAll")},text:"全选",ref:this.checkAllButtonRef,onClick:()=>{this.checkHandler("checkall")}}),r.createElement(a.Button,{key:"checkfan_button",type:"default",onKeyDown:e=>{this.handleButtonKeyDown(e,"checkReverse")},text:"反选",ref:this.checkReverseButtonRef,onClick:()=>{this.checkHandler("checkreverse")}}),r.createElement(a.Button,{key:"checkconfirm",type:"primary",onKeyDown:e=>{this.handleButtonKeyDown(e,"confirm")},onClick:this.okEvent,ref:this.confirmButtonRef,text:"确定"})))}componentDidMount(){setTimeout(()=>{this.inputRef&&this.inputRef.current?this.inputRef.current.focus():this.confirmButtonRef&&this.confirmButtonRef.current&&this.confirmButtonRef.current.buttonRef.current.focus()},100)}hiddenHandler(e){let{hiddenValShow:t}=this.state;t=!t,this.setState({hiddenValShow:t})}keyUpHandler(e){const{disFreeInput:t}=this.state;if(13==e.which&&t){const t=e.target.value.toString().trim();"function"==typeof this.props.onOk&&this.props.onOk(null,t),this.closeEvent()}else if(38==e.which){const t=e.target;if(t){const e=t.parentNode.parentNode.previousSibling;if(e){const t=this.getChildrenInput(e,"BUTTON");null!=t&&t.focus()}}}else if(40==e.which)this.confirmButtonRef.current.buttonRef.current.focus();else{const e=this.inputRef.current.value.toString().trim();let t=[],n=[],r=0;const i=this.state.groups.length>1&&-1!=this.state.groups.indexOf(e);this.state.contentData.map(l=>{l.txt||(l.txt=""),i?e==l.groupName?n.push(l.val.toString()):(t.push(l.val.toString()),-1!=this.state.checkVal.indexOf(l.val.toString())&&r++):e&&-1==l.txt.indexOf(e)?(t.push(l.val.toString()),-1!=this.state.checkVal.indexOf(l.val.toString())&&r++):n.push(l.val.toString())});let l=this.state.isCheckedAll;(!l||!e&&l)&&(l=!0,n.map(e=>{if(-1==this.state.checkVal.indexOf(e))return l=!1,!1})),this.setState({hiddenVal:t,searchValue:e,childstatus:0,isCheckedAll:l,hiddenCheckLen:r,childCheck:[]})}}keyUpCheckedHandler(e){13==e.which?this.checkHandler():this.hotKeyEvent(e)}keyUpBtnHandler(e){13==e.which||this.hotKeyEvent(e,"nolabels")}hotKeyEvent(e,t){const n=e.target;let r,i;if("nolabels"==t?(r=n,t=null):r=n.labels,r&&r.length>0&&(r=r[0]),38==e.which){let e=!0;for(;e;)e=r.previousSibling,i=this.getChildrenInput(e,"BUTTON"),null!=i?e=!1:r=r.previousSibling}else if(40==e.which){let n=!0;for(;n;)n=r.nextSibling,i=this.getChildrenInput(n,t),null!=i?n=!1:r=r.nextSibling;(null==i||e.altKey)&&(this.inputRef&&this.inputRef.current?this.inputRef.current.focus():this.confirmButtonRef.current.buttonRef.current.focus(),i=null)}null!=i&&i.focus()}renderLabels(){let e=this.state.contentData.map((e,t)=>{let n=1,i=!1;-1!=this.state.hiddenVal.indexOf(e.val.toString())&&(this.state.hiddenValShow&&-1!=this.state.checkVal.indexOf(e.val.toString())?(i=!1,n=.5):i=!0);const l=-1!=this.state.childCheck.indexOf(e.val.toString()),s=i&&!l?0:this.state.childstatus;return r.createElement("label",{key:"checkbox"+t,style:{display:i?"none":"block",opacity:n,paddingLeft:e.level+"em"}},r.createElement(h,{item:e,checkstatus:s,changeDataEvent:this.changeDataEvent,hotKeyEvent:this.hotKeyEvent}),r.createElement(u.default,{text:"",checked:-1!=this.state.checkVal.indexOf(e.val.toString())}),r.createElement("span",{style:{verticalAlign:"middle"}},e.txt),this.state.groups.length>1?r.createElement("span",null,e.groupName):null)});return r.createElement("div",{className:"pango-editor-checkbox"},this.state.hiddenCheckLen>0?r.createElement("button",{className:"toggle-hiddenChecked",onClick:this.hiddenHandler,onKeyDown:this.keyUpBtnHandler},"显示/隐藏选中项(",this.state.hiddenCheckLen,")"):null,e)}getChildrenInput(e,t){if(e){if(e.nodeName.toUpperCase()==t)return e;if("INPUT"==e.nodeName.toUpperCase())return e;{const n=e.children;if(n&&n.length>0){let e=null;for(let r=0;r<n.length;r++){const i=n[r];if(i.clientHeight>0){e=this.getChildrenInput(i,t);break}}return e}return null}}return null}}class c extends s.BaseComponent{constructor(e,t=null){super(t,e),this.updateProps=e=>{this.Child&&this.Child.updateEvent(e)}}Render(){const e=r.createElement(d,Object.assign({},this.Props,{parent:this,onRef:e=>this.Child=e}));i.render(e,document.createDocumentFragment())}}t.CheckboxComp=c},function(e,t,n){var r=n(18),i=n(659);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".pango-editor-checkbox {\r\n    overflow: auto;\r\n    max-height: 200px;\r\n}\r\n.pango-editor-checkbox label {\r\n    display: block;\r\n    font-weight: normal;\r\n    position: relative;\r\n    min-height: 22px;\r\n}\r\n.pango-editor-checkbox label>span {\r\n    min-width: 2em;\r\n    color: #000000;\r\n    font-size: 16px;\r\n    margin-left: 5px;\r\n}\r\n.pango-editor-checkbox label:hover,\r\n.pango-editor-checkbox label:focus-within {\r\n    background: #ECF0F4;\r\n}\r\n.pango-editor-checkbox input:checked {\r\n    background-color: rgb(203, 242, 252);\r\n}\r\n.pango-editor-checkbox-button {\r\n    margin: 8px 10px;\r\n}\r\n.pango-editor-checkbox-button button {\r\n    margin-right: 4px;\r\n}\r\n.pango-editor-checkbox-button button:last-child {\r\n    margin-right: 0;\r\n}\r\n\r\n.pango-editor-checkbox .toggle-hiddenChecked {\r\n    border: 0;\r\n    background: #ffffff;\r\n    font-size: 16px;\r\n    text-align: left;\r\n    color: var(--pango-editor-theme);\r\n    height: 32px;\r\n    width: 100%;\r\n}\r\n.pango-editor-checkbox .toggle-hiddenChecked:hover,\r\n.pango-editor-checkbox .toggle-hiddenChecked:focus{\r\n    background: #ECF0F4;\r\n}\r\n.pango-editor-checkbox .toggle-hiddenChecked:active {\r\n    background: rgba(142,182,195, 0.4);\r\n}\r\n\r\n.pango-editor-checkbox::-webkit-scrollbar {\r\n    width: 8px;     \r\n    height: 8px;\r\n}\r\n.pango-editor-checkbox::-webkit-scrollbar-thumb {\r\n    border-left: 1px solid #ffffff;\r\n    border-right: 2px solid #ffffff;\r\n    border-radius: 4px;\r\n    background: rgba(58,58,58,0.4);\r\n}\r\n.pango-editor-checkbox::-webkit-scrollbar-track {\r\n    background: #FFFFFF;\r\n}\r\n.pango-editor-checkbox::-webkit-scrollbar-thumb:active {\r\n    background: rgba(58,58,58,1);\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12);n(661);const i=n(109),l=n(12),s=n(663);t.default=({value:e,text:t,checked:n,partChecked:o=!1,showType:a="normal",disabled:u,labelText:h,labelAlign:d,labelWidth:c,height:p="32",onCheck:f,inGroup:g,visible:m=!0,position:E,left:C,top:A,onValueChanged:y,required:I,errorMessage:S,isVerify:_,onValid:w})=>{const[b,x]=r.useState(n),[P,v]=r.useState(""),[T,M]=r.useState(!0),L=e=>{u||(y&&y(!b,e),f&&f(!b,e),x(!b),e.stopPropagation())},D=()=>{let e={position:E};const t={top:A+"px",left:C+"px",display:m?"inline-block":"none"};return Object.assign(t,e),t};r.useEffect(()=>{_&&w&&w((()=>{if(u)return!0;let t;return I&&!e?(v(S||(h?h+"为必选项":"该项为必选项")),M(!1),t=!1):(v(""),M(!0),t=!0),t})())},[_]),r.useEffect(()=>{x(n)},[n]);const R=e=>l.createElement(s.default,{type:e,labelText:h,labelAlign:d,labelHeight:p,visible:m,labelWidth:c}),F=()=>{let e=-14;return h&&(e=c?Number(c)+2:i.DomUtils.textWidth(h,"font-size-16")+2),e},N=()=>{if(I)return l.createElement("span",{className:"required-flag",style:{left:F()+"px"}},"*")},B=()=>{if(!T)return l.createElement("div",{className:"pango-input-error-message",style:{left:F()+14+"px"}},P)};return l.createElement(l.Fragment,null,g?l.createElement(l.Fragment,null,"normal"===a?l.createElement(l.Fragment,null,R("input"),N(),l.createElement("div",{className:`pango-checkgroup-item pango-check ${o?"is-partcheck":b?"is-checked":""} ${u?"is-disabled":""} ${I?"is-required":""}`,onClick:L,style:D()},l.createElement("span",{className:"pango-check-input"},l.createElement("span",{className:"pango-check-input-inner"})),l.createElement("span",{className:"pango-check-label"},t)),B()):l.createElement(l.Fragment,null,R("input"),N(),l.createElement("div",{className:`pango-checkgroup-item pango-check-button ${b?"is-checked":""} ${u?"is-disabled":""} ${I?"is-required":""}`,onClick:L,style:D()},l.createElement("span",{className:"pango-check-button-inner"},t)),B())):l.createElement("div",{style:D()},"normal"===a?l.createElement(l.Fragment,null,R("input"),N(),l.createElement("div",{className:`pango-check ${o?"is-partcheck":b?"is-checked":""} ${u?"is-disabled":""} ${I?"is-required":""}`,style:{height:p+"px",lineHeight:p+"px"},onClick:L},l.createElement("span",{className:"pango-check-input"},l.createElement("span",{className:"pango-check-input-inner"})),t?l.createElement("span",{className:"pango-check-label"},t):null),B()):l.createElement(l.Fragment,null,R("input"),N(),l.createElement("div",{className:`pango-check-button ${b?"is-checked":""} ${u?"is-disabled":""} ${I?"is-required":""}`,onClick:L},l.createElement("span",{className:"pango-check-button-inner"},t)),B())))}},function(e,t,n){var r=n(18),i=n(662);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,'\r\n.pango-check {\r\n    position: relative;\r\n    cursor: pointer;\r\n    display: inline-block;\r\n    white-space: nowrap;\r\n    outline: none;\r\n    font-size: 0;\r\n    margin-right: 32px;\r\n    vertical-align: middle;\r\n    line-height: 32px;\r\n    user-select: none;\r\n}\r\n\r\n.pango-check:last-of-type {\r\n    margin-right: 0;\r\n}\r\n\r\n.pango-check-input {\r\n    white-space: nowrap;\r\n    outline: none;\r\n    display: inline-block;\r\n    line-height: 24px;\r\n    position: relative;\r\n    vertical-align: middle;\r\n}\r\n\r\n.pango-check-input-inner {\r\n    border: 1px solid var(--pango-editor--input-border-color);\r\n    border-radius: 2px;\r\n    width: 16px;\r\n    height: 16px;\r\n    background-color: #ffffff;\r\n    position: relative;\r\n    display: inline-block;\r\n    box-sizing: border-box;\r\n    vertical-align: middle;\r\n    transition: border-color .25s cubic-bezier(.71, -.46, .29, 1.46), background-color .25s cubic-bezier(.71, -.46, .29, 1.46);\r\n}\r\n\r\n.pango-check-input-inner:before {\r\n    box-sizing: content-box;\r\n    content: "";\r\n    border: 1px solid #ffffff;\r\n    border-left: 0;\r\n    border-top: 0;\r\n    height: 8px;\r\n    left: 5px;\r\n    position: absolute;\r\n    top: 1px;\r\n    transform: rotate(45deg) scaleY(0);\r\n    width: 3px;\r\n    transition: transform .15s ease-in .05s;\r\n    transform-origin: center;\r\n}\r\n\r\n.pango-check:hover .pango-check-input-inner {\r\n    border-color: var(--pango-editor-theme-hover);\r\n}\r\n\r\n.is-partcheck .pango-check-input-inner,\r\n.is-checked .pango-check-input-inner {\r\n    border-color: var(--pango-editor-theme);\r\n    background-color: var(--pango-editor-theme);\r\n}\r\n\r\n.is-checked .pango-check-input-inner:before {\r\n    transform: rotate(45deg) scaleY(1);\r\n}\r\n\r\n.is-partcheck .pango-check-input-inner:after {\r\n    content: "";\r\n    position: absolute;\r\n    display: block;\r\n    background-color: #ffffff;\r\n    height: 2px;\r\n    transform: scale(.5);\r\n    left: 0;\r\n    right: 0;\r\n    top: 6px;\r\n}\r\n\r\n.pango-check-label {\r\n    font-size: var(--pango-editor--fs14px);\r\n    padding-left: 8px;\r\n    display: inline-block;\r\n    line-height: 24px;\r\n    vertical-align: middle;\r\n    color: var(--pango-editor--input-font-color);\r\n}\r\n\r\n.is-checked .pango-check-label {\r\n    color: var(--pango-editor--input-font-color);\r\n}\r\n\r\n.is-disabled {\r\n    cursor: not-allowed !important;\r\n}\r\n\r\n.is-disabled .pango-check-input-inner,\r\n.is-disabled .pango-check:hover .pango-check-input-inner {\r\n    border-color: var(--pango-editor--input-border-color);\r\n    background-color: var(--pango-editor--border-input-color);\r\n}\r\n\r\n.is-disabled.is-checked .pango-check-input-inner:before {\r\n    border-color: var(--pango-editor--input-border-color);\r\n}\r\n\r\n.is-disabled .pango-check-label {\r\n    color: var(--pango-editor--input-font-disabled-color);\r\n}\r\n\r\n.pango-check-button {\r\n    display: inline-block;\r\n    white-space: nowrap;\r\n    outline: none;\r\n    font-size: 0;\r\n    vertical-align: top;\r\n    line-height: 26px;\r\n    user-select: none;\r\n}\r\n\r\n.pango-check-button,\r\n.pango-check-button-inner {\r\n    position: relative;\r\n    display: inline-block;\r\n    outline: none;\r\n}\r\n\r\n.pango-check-button {\r\n    cursor: pointer;\r\n}\r\n\r\n.pango-check-button-inner {\r\n    white-space: nowrap;\r\n    vertical-align: middle;\r\n    border-radius: 4px;\r\n    background: #ffffff;\r\n    border: 1px solid var(--pango-editor--input-border-color);\r\n    color: var(--pango-editor--input-font-color);\r\n    -webkit-appearance: none;\r\n    text-align: center;\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    transition: all .2s cubic-bezier(.645, .045, .355, 1);\r\n    padding: 0 16px;\r\n    font-size: var(--pango-editor--fs14px);\r\n}\r\n\r\n.pango-checkgroup-item:first-of-type>.pango-check-button-inner {\r\n    border-left: 1px solid var(--pango-editor--input-border-color);\r\n    border-radius: 4px 0 0 4px;\r\n    box-shadow: none!important;\r\n}\r\n\r\n.pango-checkgroup-item .pango-check-button-inner {\r\n    border-left: 0;\r\n    border-radius: 0;\r\n}\r\n\r\n.pango-checkgroup-item:last-of-type>.pango-check-button-inner {\r\n    border-radius: 0 4px 4px 0;\r\n}\r\n\r\n.pango-check-button:hover .pango-check-button-inner {\r\n    border-color: var(--pango-editor--input-border-active-color);\r\n    box-shadow: -1px 0 0 0 var(--pango-editor--input-border-active-color);\r\n}\r\n\r\n.is-checked>.pango-check-button-inner,\r\n.is-checked.pango-check-button:first-of-type>.pango-check-button-inner {\r\n    color: #ffffff;\r\n    background-color: var(--pango-editor--input-border-active-color);\r\n    border-color: var(--pango-editor--input-border-active-color);\r\n    box-shadow: -1px 0 0 0 var(--pango-editor--input-border-active-color);\r\n}\r\n\r\n.is-disabled.pango-check-button {\r\n    cursor: not-allowed;\r\n}\r\n\r\n.is-disabled .pango-check-button-inner,\r\n.is-disabled.pango-check-button:hover .pango-check-button-inner {\r\n    border-color: var(--pango-editor--input-border-color);\r\n    box-shadow: none;\r\n    color: var(--pango-editor--input-font-disabled-color);\r\n    background-color: #ffffff;\r\n}\r\n\r\n.is-disabled.is-checked .pango-check-button-inner,\r\n.is-disabled.is-checked.pango-check-button:hover .pango-check-button-inner {\r\n    background-color: var(--pango-editor--border-input-color);\r\n    box-shadow: none;\r\n}\r\n\r\n.pango-checkgroup {\r\n    display: inline-block;\r\n    vertical-align: middle;\r\n}\r\n\r\n.label-align-left {\r\n    text-align: left;\r\n}\r\n\r\n.label-align-right {\r\n    text-align: right;\r\n}\r\n\r\n.required-flag {\r\n    position: absolute;\r\n    top: 2px;\r\n    left: -14px;\r\n    font-size: var(--pango-editor--fs18px);\r\n    color: var(--pango-editor--input-border-validate-color);\r\n}',""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(225),i=n(12),l=n(109);t.default=({labelText:e,labelAlign:t,labelWidth:n,labelHeight:s,position:o,top:a,left:u,type:h="input",visible:d=!0,labelPosition:c})=>{if(e){let p=t||"left";const f=r.default(`pango-${h}-label`,{["label-align-"+p]:p});let g=parseInt(n),m=l.DomUtils.textWidth(e,"font-size-16");e&&("auto"===n||0==g||isNaN(g))&&(g=m);let E=parseInt(s)+"px",C={width:g,lineHeight:"top"==c?1:E,display:d?"inline-block":"none"};return null!=o&&(C.position=o),null!=a&&(C.top=a+"px"),null!=u&&(C.left=u+"px"),i.createElement("label",{className:f,style:C},e)}return i.createElement(i.Fragment,null)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Calculator1=void 0;const r=n(27),i=n(665);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();if(super(t,e),null!=this._Comp&&this._Comp.Child)this._Comp.updateProps(e),this.IsUpdated=!0;else{this.divID="_CalendarComp"+(new Date).getTime();const e=Object.assign({divID:this.divID},this.InitProps);this._Comp=new i.CalculatorComp(t,e),this.IsUpdated=!1}}DefaultProps(){return{value:"",top:0,left:0}}}t.Calculator1=l},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CalculatorComp=exports.Calculator=void 0;const React=__webpack_require__(12),ReactDom=__webpack_require__(24);__webpack_require__(327);const Popover_1=__webpack_require__(74),BaseComponent_1=__webpack_require__(22);class CalButton extends React.Component{constructor(e){super(e),this.clickHandler=this.clickHandler.bind(this),this.keyUpBtnHandler=this.keyUpBtnHandler.bind(this)}clickHandler(e){this.props.onButtonClick(e.target.innerHTML)}keyUpBtnHandler(e){13==e.which?this.props.onButtonClick(e.target.innerHTML):this.props.keyUpBtnEvent(e)}render(){return React.createElement("button",{onClick:this.clickHandler,onKeyUp:this.keyUpBtnHandler},this.props.text)}}class Calculator extends React.Component{constructor(e){super(e),this.inputRef=React.createRef(),this.num1="",this.num2="",this.oper="",this.canceBtnId="calculatorpopCance",this.nearNode=null,this.curentNodeIndex=0,this.compositionMode=!1,this.popClassName="",this.inputHandler=e=>{if("insertCompositionText"==e.inputType){if(this.compositionMode)return void(this.compositionMode=!1);this.compositionMode=!0}e.preventDefault();let t="";switch(e.inputType){case"deleteContentBackward":t="←";break;case"deleteContentForward":case"Escape":t="AC";break;default:t=e.data}this.buttonHandler(t,!0),this.curentNodeIndex=0},this.keyHandler=e=>{if(40==e.which){const t=e.target,n=this.getNextNode(t.nextSibling,"TD");null!=n&&n.firstChild.focus()}else 13==e.which&&(this.buttonHandler("=",!0),this.curentNodeIndex=0)},this.keyPressHandler=e=>{let t=String.fromCharCode(e.which);/\d|\./.test(t)||e.preventDefault();const n=e.target.value;/(^\d*\.?$)|(^\d*\.?\d*$)/.test(n+t)||e.preventDefault()},this.keyUpHandler=e=>{e.target.value=e.target.value.replace(/[^0-9.]/g,"")},this.okHandler=()=>{""!=this.num1&&""!=this.oper&&""!=this.num2&&this.inputRef.current.value==this.num1+this.oper+this.num2?this.calculate():this.num1=this.inputRef.current.value,this.props.onOk&&this.props.onOk(this.num1)},this.closeHandler=(e=!1)=>{"function"==typeof this.props.onClose&&this.props.onClose(e),this.setState({isRender:!1})},this.calToggle=()=>{this.setState({showCalculator:!this.state.showCalculator})},this.updateEvent=e=>{const{left:t,top:n,value:r}=this.state;let i=[];e.value!=r&&i.push({item:"value",value:e.value}),e.left!=t&&i.push({item:"left",value:e.left}),e.top!=n&&i.push({item:"top",value:e.top}),i.length>0&&this.setState((e,t)=>{let n={isRender:!0};return i.forEach(e=>{n[e.item]=e.value}),n})},this.buttonHandler=this.buttonHandler.bind(this),this.btnKeyUpHandler=this.btnKeyUpHandler.bind(this),this.keyUpBtnEvent=this.keyUpBtnEvent.bind(this),this.state={isRender:!0,value:e.value,showCalculator:!0},this.props.divID&&(this.popClassName+=" "+this.props.divID)}componentDidMount(){this.props.parent.React=this,this.setValue(this.state.value),setTimeout(()=>{var e,t;return null===(t=null===(e=this.inputRef)||void 0===e?void 0:e.current)||void 0===t?void 0:t.focus()},100)}setValue(e){this.num1=e,this.num2="",this.oper="",this.inputRef.current.value=e}buttonHandler(e,t){if(t=null!=t&&t,/[\d.]/.test(e))""==this.oper?isNaN(Number(this.num1+e))||(this.num1+=e):isNaN(Number(this.num2+e))||(this.num2+=e);else if(/[+\-*\/]/.test(e))""==this.oper?""==this.num1?"-"==e&&(this.num1=e):this.oper=e:this.calculate()&&(this.oper=e);else switch(e){case"AC":this.num1="",this.num2="",this.oper="";break;case"←":this.num2.length>0?this.num2=this.num2.substr(0,this.num2.length-1):""!=this.oper?this.oper="":this.num1.length>0&&(this.num1=this.num1.substr(0,this.num1.length-1));break;case"%":(""!=this.num1&&""==this.num2||""!=this.num2&&this.calculate())&&this.percent();break;case"=":if(t)return this.okHandler(),this.setState({isRender:!1}),void this.closeHandler();this.calculate()}t||(this.inputRef.current.value=this.num1+this.oper+this.num2),this.inputRef.current.focus()}percent(){this.num1=parseFloat(this.num1)/100+""}calculate(){try{""!=this.num1&&""!=this.oper&&""!=this.num2&&(this.num1=eval(this.num1+this.oper+this.num2)+"")}catch(e){return!1}return this.oper="",this.num2="",!0}renderButton(){let e=[["%","AC","←","/"],["7","8","9","*"],["4","5","6","-"],["1","2","3","+"],["0",".","="]].map((e,t)=>{let n=e.map((e,n)=>4==t&&2==n?React.createElement("td",{colSpan:2,key:t+""+n},React.createElement(CalButton,{onButtonClick:this.buttonHandler,keyUpBtnEvent:this.keyUpBtnEvent,text:e})):React.createElement("td",{key:t+""+n},React.createElement(CalButton,{onButtonClick:this.buttonHandler,keyUpBtnEvent:this.keyUpBtnEvent,text:e})));return React.createElement("tr",{key:t},n)});return React.createElement("table",{className:"body-content"},React.createElement("tbody",null,e))}render(){let{target:e,top:t,left:n,divID:r}=this.props,{isRender:i,showCalculator:l}=this.state;return React.createElement(Popover_1.default,{className:this.popClassName,top:t,left:n,showOkBtn:l,showCancelBtn:l,target:e,isShow:i,isRender:i,onOk:this.okHandler,onClose:this.closeHandler,canceBtnId:this.canceBtnId,btnAllowEnter:!0,btnKeyUp:this.btnKeyUpHandler},React.createElement("div",{className:"pango-editor-cal-input"},React.createElement("input",{className:"input-text",type:"text",ref:this.inputRef,placeholder:"请输入",onInput:this.inputHandler,onKeyDown:this.keyHandler,onKeyPress:this.keyPressHandler,onKeyUp:this.keyUpHandler}),React.createElement("span",{className:"cal-toggle-button emr-icon-designformulas",onClick:this.calToggle})),l?this.renderButton():null)}keyUpBtnEvent(e){const t=e.target;let n,r=t.parentNode;if(37==e.which)n=r.previousSibling,null!=n&&this.curentNodeIndex>0&&this.curentNodeIndex--;else if(39==e.which)n=r.nextSibling,null!=n&&this.curentNodeIndex++;else if(38==e.which){r=r.parentNode;let t=!0,i=r.previousSibling;if(i)for(;t;)i.children[this.curentNodeIndex]?t=!1:this.curentNodeIndex>0?this.curentNodeIndex--:t=!1;n=this.getNextNode(r.previousSibling,"TD",this.curentNodeIndex),(e.altKey||null==n)&&(this.inputRef.current.focus(),n=null,this.curentNodeIndex=0)}else if(40==e.which){r=r.parentNode;let e=!0,i=r.nextSibling;if(i)for(;e;)i.children[this.curentNodeIndex]?e=!1:this.curentNodeIndex>0?this.curentNodeIndex--:e=!1;if(n=this.getNextNode(r.nextSibling,"TD",this.curentNodeIndex),null==n){this.nearNode=t;document.getElementById(this.canceBtnId).focus()}}null!=n&&n.firstChild.focus()}btnKeyUpHandler(e){const t=e.target;if(38==e.which)e.altKey?this.inputRef.current.focus():this.nearNode.focus();else{let n;37==e.which?n=t.previousSibling:39==e.which&&(n=t.nextSibling),null!=n&&"BUTTON"==n.nodeName.toUpperCase()&&n.focus()}}getNextNode(e,t,n){if(e){if(e.nodeName.toUpperCase()==t)return e;{const r=e.children;if(r&&r.length>0){let e=null;for(let i=0;i<r.length;i++){let l=r[i];if(n>0&&null!=r[n]&&(l=r[n]),l.clientHeight>0){e=this.getNextNode(l,t);break}}return e}return null}}return null}}exports.Calculator=Calculator;class CalculatorComp extends BaseComponent_1.BaseComponent{constructor(e,t){super(e,t),this.updateProps=e=>{this.Child&&this.Child.updateEvent(e)}}Render(){const e=React.createElement(Calculator,Object.assign({},this.Props,{parent:this,onRef:e=>this.Child=e}));ReactDom.render(e,document.createDocumentFragment())}}exports.CalculatorComp=CalculatorComp},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseResizableElement=void 0;const r=n(2),i=n(8),l=n(91),s=n(0),o=n(4),a=n(227);class u extends s.XBaseElement{constructor(){super(...arguments),this._IsUniformScale=!1,this.isFocused=!1}get IsUniformScale(){return this._IsUniformScale}set IsUniformScale(e){this._IsUniformScale=e}get EleCursorAllowSide(){return r.ENumEleCursorSide.Left}get IsFocused(){return this.isFocused}set IsFocused(e){this.isFocused=e}get Width(){return super.Width}set Width(e){this.IsAutoWidth||this.propList.ModifyProperty("Width",e,0),super.SetSizeDPI(e,-1,300),this.IsLayoutValid=!1}get Height(){return super.Height}set Height(e){this.IsAutoHeight||this.propList.ModifyProperty("Height",e,0),super.SetSizeDPI(-1,e,300),this.IsLayoutValid=!1}get MinCanDragWidth(){let e=this.propList.GetPropValue("MinWidth");return i.CNumUtil.TryParseFloat(e,-1)}set MinCanDragWidth(e){this.propList.ModifyProperty("MinWidth",e,-1)}get MinCanDragHeight(){let e=this.propList.GetPropValue("MinWidth");return i.CNumUtil.TryParseFloat(e,-1)}set MinCanDragHeight(e){this.propList.ModifyProperty("MinWidth",e,-1)}get IsAutoWidth(){let e=this.propList.GetPropValue("AutoWidth");return i.CNumUtil.TryParseBool(e,!1)}set IsAutoWidth(e){this.propList.ModifyProperty("AutoWidth",e,!1)}get IsAutoHeight(){let e=this.propList.GetPropValue("AutoHeight");return i.CNumUtil.TryParseBool(e,!1)}set IsAutoHeight(e){this.propList.ModifyProperty("AutoHeight",e,!1)}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r),super.SetSizeDPI(e.Width,e.Height,300)}SetSizeDPI(e,t,n){let r=1;n>0&&300!=n&&(r=300/n),e*=r,t*=r,this.I_ChangeSizeByMinSize(e,t),e>0&&!this.IsAutoWidth&&this.propList.ModifyProperty("Width",e,0),t>0&&!this.IsAutoHeight&&this.propList.ModifyProperty("Height",t,0),super.SetSizeDPI(e,t,300),this.IsLayoutValid=!1}I_ChangeSizeByMinSize(e,t){let n=this.MinCanDragHeight,r=this.MinCanDragHeight;n>=0&&r>=0&&(t<r&&(t=r),e<n&&(e=n))}GetForbidAnchors(){let e=null;return this.IsAutoHeight?e=[l.MarkPoint.LeftTop,l.MarkPoint.LeftBottom,l.MarkPoint.TopCenter,l.MarkPoint.BottomCenter,l.MarkPoint.RightTop,l.MarkPoint.RightBottom]:this.IsAutoWidth&&(e=[l.MarkPoint.LeftTop,l.MarkPoint.RightTop,l.MarkPoint.LeftCenter,l.MarkPoint.RightCenter,l.MarkPoint.LeftBottom,l.MarkPoint.RightBottom]),e}_AfterFromXML_(){let e=0;if(!this.IsAutoWidth){let t=this.propList.GetPropValue("Width");e=i.CNumUtil.TryParseFloat(t,0)}let t=0;if(!this.IsAutoHeight){let e=this.propList.GetPropValue("Height");t=i.CNumUtil.TryParseFloat(e,0)}super.SetSizeDPI(e,t,300)}getValueByFormat(e,t){let n=e;if(o.default.IsNullOrEmpty(n))return"";let r=this.Document;if(null==r)return n;let i=r.GetDocCtxt(),l="";if(l="[%PageIndex%]",-1!=n.indexOf(l)){let e=i.GetPageNumInfo(l);e>0&&(n=n.replace(l,a.ListSernoStyleVals.BuildSernoStr(e,t)))}if(l="[%NumOfPages%]",-1!=n.indexOf(l)){let e=i.GetPageNumInfo(l);e>0&&(n=n.replace(l,a.ListSernoStyleVals.BuildSernoStr(e,t)))}if(l="[%LocalPageIndex%]",-1!=n.indexOf(l)){let e=i.GetPageNumInfo(l);e>0&&(n=n.replace(l,a.ListSernoStyleVals.BuildSernoStr(e,t)))}if(l="[%LocalNumOfPages%]",-1!=n.indexOf(l)){let e=i.GetPageNumInfo(l);e>0&&(n=n.replace(l,a.ListSernoStyleVals.BuildSernoStr(e,t)))}return n}}t.XBaseResizableElement=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeInfo=void 0;const r=n(14);t.CodeInfo=class extends Object{constructor(){super(...arguments),this._CodeValue=null}get CodeValue(){return this._CodeValue}set CodeValue(e){this._CodeValue=e}Clone(){return null}DeepClone(){return this.Clone()}ToXML(e){let t=e.createElement("XElements"),n=e.createElement("Element");t.appendChild(n);let r=e.createElement("Text");return r.textContent=this.CodeValue,n.appendChild(r),t}FromXML(e){let t=r.XmlDomUtil.GetSingleNode(e,"XElements");if(null!=t){let e=r.XmlDomUtil.GetSingleNode(t,"Element");if(null!=e){let t=r.XmlDomUtil.GetSingleNode(e,"Text");null!=t&&(this.CodeValue=t.textContent)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XImageInfo=void 0;const r=n(14),i=n(8),l=n(4);t.XImageInfo=class{constructor(){this._No=null,this._Title=null,this._Name_de=null,this._Gender=null,this._MaxAge=null,this._Width=null,this._Height=null,this._MinAge=null,this._HorizontalResolution=null,this._VerticalResolution=null,this._ImgBase64=null,this._isImgBase64=!0,this._attr_FgHide=null,this._deletable=null}get No(){return this._No}set No(e){this._No=e}get Title(){return this._Title}set Title(e){this._Title=e}get Name_de(){return this._Name_de}set Name_de(e){this._Name_de=e}get Gender(){return this._Gender}set Gender(e){this._Gender=e}get MaxAge(){return this._MaxAge}set MaxAge(e){this._MaxAge=e}get Width(){return this._Width}set Width(e){this._Width=e}get Height(){return this._Height}set Height(e){this._Height=e}get MinAge(){return this._MinAge}set MinAge(e){this._MinAge=e}get HorizontalResolution(){return this._HorizontalResolution}set HorizontalResolution(e){this._HorizontalResolution=e}get VerticalResolution(){return this._VerticalResolution}set VerticalResolution(e){this._VerticalResolution=e}get ImgBase64(){return this._ImgBase64}set ImgBase64(e){this._ImgBase64=e}get IsImgBase64(){return this._isImgBase64}set IsImgBase64(e){this._isImgBase64=e}get ImageWebUrl(){return this._ImageWebUrl}set ImageWebUrl(e){this._ImageWebUrl=e}get Name(){return this._Name}set Name(e){this._Name=e}get Attr_FgHide(){return this._attr_FgHide}set Attr_FgHide(e){this._attr_FgHide=e}get Deletable(){return this._deletable}set Deletable(e){this._deletable=e}Clear(){this.HorizontalResolution=0,this.VerticalResolution=0,this.ImgBase64=""}CopyFrom(e){this.HorizontalResolution=e.HorizontalResolution,this.VerticalResolution=e.VerticalResolution,this.ImgBase64=e.ImgBase64}ToXML(e){let t;if(l.default.IsNullOrEmpty(this.ImgBase64))t=null;else{let n=e.createElement("Image"),r=e.createElement("HorizontalResolution");r.innerText=this.HorizontalResolution.toString(),n.appendChild(r),r=e.createElement("VerticalResolution"),r.innerText=this.VerticalResolution.toString(),n.appendChild(r),r=e.createElement("IsImgBase64"),r.textContent=this.IsImgBase64.toString(),n.appendChild(r),null!=this.ImageWebUrl&&(r=e.createElement("ImageWebUrl"),r.textContent=this.ImageWebUrl.toString(),n.appendChild(r)),null!=this.Name&&(r=e.createElement("Name"),r.textContent=this.Name.toString(),n.appendChild(r)),r=e.createElement("ImageDataBase64String"),this.IsImgBase64?r.textContent=decodeURIComponent(this.ImgBase64):r.textContent=this.ImgBase64,n.appendChild(r),t=n}return t}FromXML(e){if(null!=e){let t=r.XmlDomUtil.GetSingleNode(e,"HorizontalResolution");null!=t&&(this.HorizontalResolution=i.CNumUtil.TryParseFloat(t.textContent,0)),t=r.XmlDomUtil.GetSingleNode(e,"VerticalResolution"),null!=t&&(this.VerticalResolution=i.CNumUtil.TryParseFloat(t.textContent,0)),t=r.XmlDomUtil.GetSingleNode(e,"IsImgBase64"),null!=t&&(this.IsImgBase64=i.CNumUtil.TryParseBool(t.textContent,!0)),t=r.XmlDomUtil.GetSingleNode(e,"ImageDataBase64String"),null!=t&&(this.ImgBase64=decodeURIComponent(t.textContent)),t=r.XmlDomUtil.GetSingleNode(e,"ImageWebUrl"),null!=t&&(this.ImageWebUrl=t.textContent),t=r.XmlDomUtil.GetSingleNode(e,"Name"),null!=t&&(this.Name=t.textContent)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XMedicalExpressionField=void 0;const r=n(0),i=n(670),l=n(171),s=n(223),o=n(104),a=n(169),u=n(229),h=n(25),d=n(2),c=n(4),p=n(44);class f extends r.XBaseResizableElement{constructor(){super(),this._expressionInfo=null,this._medExpInfo=null,this.ExpressionInfo=new i.MedicalExpressionInfo}get EleTypeName(){return"XMedicalExpressionField"}get ExpressionInfo(){return this._expressionInfo}set ExpressionInfo(e){this._expressionInfo=e,this._expressionInfo.MedValueChanged=this._expressionInfo_MedValueChanged.bind(this)}_expressionInfo_MedValueChanged(e){let t=!1;switch(this.ExpressionStyle){case"FourValues":case"FourValues1":case"FourValues2":t=!0}t&&p.TextDocApiUtil.M_InnerEleExcScrExp(this,this.Document,null)}get Gender(){return this.propList.GetPropValue("Gender")}CanBeInline(e=!1){if(e){let e=this.ExpressionFormInfo.ItemInfo.Type,t=this.ExpressionFormInfo.ItemInfo.DefaultValue;switch(e){case"FourValues":if("初潮年龄,经期,周期,绝经年龄,false,false"==t)return!1;break;case"FourValues1":case"FourValues2":if("初潮年龄,经期,绝经年龄,周期"==t)return!1;break;case"ThreeValues":if("初潮年龄,经期,周期"==t)return!1;break;case"Pupil":if(",,,,,,"==t)return!1;break;case"LightPositioning":if(",,,,,,,,"==t)return!1;break;case"FetalHeart":if(",,,,,"==t)return!1}}return!0}set Gender(e){this.propList.ModifyProperty("Gender",e,null)}get MaxAge(){return this.propList.GetPropValue("MaxAge")}set MaxAge(e){this.propList.ModifyProperty("MaxAge",e,null)}get MinAge(){return this.propList.GetPropValue("MinAge")}set MinAge(e){this.propList.ModifyProperty("MinAge",e,null)}get IsSelected(){return this._IsSelected}set IsSelected(e){this._IsSelected=e}get IsDrawDashedRect(){return this._IsDrawDashedRect}set IsDrawDashedRect(e){this._IsDrawDashedRect=e}get DashedBorderRect(){return this._DashedBorderRect}set DashedBorderRect(e){this._DashedBorderRect=e}get Name(){return this.propList.GetPropValue("Name")}set Name(e){this.propList.ModifyProperty("Name",e,null)}get ExpressionStyle(){return this.propList.GetPropValue("ExpressionStyle")}set ExpressionStyle(e){this.propList.ModifyProperty("ExpressionStyle",e,null)}get Area_VAlign(){let e,t=this.propList.GetPropValue("Area_VAlign");return e=c.default.IsNullOrEmpty(t)?"Center":t,e}set Area_VAlign(e){this.propList.ModifyProperty("Area_VAlign",e,"Center")}get Area_HAlign(){let e,t=this.propList.GetPropValue("Area_HAlign");return e=c.default.IsNullOrEmpty(t)?"Center":t,e}set Area_HAlign(e){this.propList.ModifyProperty("Area_HAlign",e,"Center")}get MedExpSettingInfo(){return this.ReBulidMedExpSettingInfo(),this._medExpInfo}ReBulidMedExpSettingInfo(){if(null!=this._medExpInfo&&this._medExpInfo instanceof l.RulerInfo){let e=this._medExpInfo;e.VAlignStr=this.Area_VAlign,e.HAlignStr=this.Area_HAlign,this._medExpInfo=e}}set MedExpSettingInfo(e){this._medExpInfo=e,this.MedExpSettingInfoChanged()}MedExpSettingInfoChanged(){if(null!=this._medExpInfo&&this._medExpInfo instanceof l.RulerInfo){let e=this._medExpInfo;this.Area_VAlign=e.VAlignStr,this.Area_HAlign=e.HAlignStr}}get Id(){return super.GrpID}set Id(e){super.GrpID=e}get CanReflect(){return"PainIndex"==this.ExpressionStyle}get IsGroupEle(){return!1}get ShowName(){let e;if("PainIndex"==this.ExpressionStyle)if(this._medExpInfo instanceof l.RulerInfo){e=this._medExpInfo.Name}else e=this.Name;else e=this.Name;return e}get ScriptInnerValue(){return this._expressionInfo.MedicalValue}get EndMenstruationAge(){const e=this._expressionInfo.MedicalValue;if(!e)return"";let t,n="";switch(this.ExpressionStyle){case"FourValues":t=u.MedExpressionFactory.GetInstance().GetMensesExpression(e);break;case"FourValues1":t=u.MedExpressionFactory.GetInstance().GetMensesExpression2(e);break;case"FourValues2":t=u.MedExpressionFactory.GetInstance().GetMensesExpression3(e)}return t&&(n=t.EndMenstruationAge),n||(n=""),n}get ExpessionArray(){let e;if("PainIndex"==this.ExpressionStyle)if(this._medExpInfo instanceof l.RulerInfo){e=[this._medExpInfo.ExprssionText]}else e=null;else e=null;return e}set ExpessionArray(e){null!=e&&null!=e[0]&&null!=this._medExpInfo&&this._medExpInfo instanceof l.RulerInfo&&(this._medExpInfo.ExprssionText=e[0])}get ExpTypeArray(){return["SetVisible"]}GetType(){return"IScriptMsg"}get IsUseXId(){return!0}get EleCursorAllowSide(){return d.ENumEleCursorSide.Left}UpdateInnerText(e,t,n){this._expressionInfo.MedicalValue=e,this.NotifyLayoutChanged(!0,!1)}UpdateEleAttrFgHide(e,t){super.Attr_FgHide!=e&&(super.Attr_FgHide=e,p.TextDocApiUtil.M_InnerEleExcScrExp(this,this.Document,t))}GetInnerText(e){return"医学表达式"}get ExpressionFormInfo(){return this.BulidMedicalFormInfo()}BulidMedicalFormInfo(){let e=new a.MedExpressionItemInfo;e.DefaultValue=this._expressionInfo.MedicalValue,e.Type=this.ExpressionStyle;let t=new s.InsertMedExpressionItemInfo;return t.No=this.GrpID,t.Type=this.EleTypeName,t.Name=this.Name,t.VAlign=o.StyleVAlignVals.GetVAlignStrVal(super.EleStyle.VAlign_ENumVal),t.ItemInfo=e,t.Gender=this.Gender,t.MaxAge=this.MaxAge,t.MinAge=this.MinAge,t.conceptDomainCode=this.CptID,t.ValueCode_de=this.GetAttribute("deValueCode"),t.Name_de=this.GetAttribute("decodeName"),t}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,t,n,r);let i=e instanceof f?e:null;if(null!=i&&null!=i.ExpressionFormInfo){let e=i.ExpressionFormInfo;e.ItemInfo.DefaultValue=i.ExpressionInfo.MedicalValue,this.InitMeicalExpression(e,null,!1)}}InitMeicalExpression(e,t,n=!0){if(this.Name=e.Name,this._expressionInfo.MedicalValue=e.ItemInfo.DefaultValue,this.ExpressionStyle=e.ItemInfo.Type,this.Gender=e.Gender,this.MaxAge=e.MaxAge,this.MinAge=e.MinAge,this.CptID=e.conceptDomainCode,this.SetAttribute("deValueCode",e.ValueCode_de),this.SetAttribute("decodeName",e.Name_de),super.EleStyle.VAlign_ENumVal=o.StyleVAlignVals.GetEnumVAlign(e.VAlign),n){let e=u.MedExpressionFactory.GetInstance().GetDefaultSizeByMedStyle(this.ExpressionStyle);this.InitDrawSize(e,t)}}InitDrawSize(e,t=null){e!=h.SizeF.Empty&&(this.SetSizeDPI(e.Width,e.Height,96),this.IsLayoutValid=!1)}GetMedExpInfo(){let e=new s.InsertMedExpressionItemInfo;return e.Name=this.Name,e.VAlign=o.StyleVAlignVals.GetVAlignStrVal(super.EleStyle.VAlign_ENumVal),e.ItemInfo=new a.MedExpressionItemInfo,e.ItemInfo.Type=this.ExpressionStyle,e}FromXML(e){super.FromXML(e),this._expressionInfo.FromXML(e),"PainIndex"==this.ExpressionStyle&&(this._medExpInfo=new l.RulerInfo("Default"),this._medExpInfo.FromXML(e))}ToXML(e){let t=super.ToXML(e);if(null==t)return null;let n=this._expressionInfo.ToXML(e);if(t.appendChild(n),null!=this._medExpInfo&&"PainIndex"==this.ExpressionStyle){let n=this._medExpInfo;null!=n&&t.appendChild(n.ToXML(e))}return t}}t.XMedicalExpressionField=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MedicalExpressionInfo=void 0;const r=n(14);t.MedicalExpressionInfo=class{constructor(){this._medicalValue=""}get MedicalValue(){return this._medicalValue}set MedicalValue(e){this._medicalValue=e,null!=this.MedValueChanged&&this.MedValueChanged(e)}ToXML(e){let t=e.createElement("XElements"),n=e.createElement("Element");t.appendChild(n);let r=e.createElement("Text");return r.textContent=this.MedicalValue,n.appendChild(r),t}FromXML(e){let t=r.XmlDomUtil.GetSingleNode(e,"XElements");if(null!=t){let e=r.XmlDomUtil.GetSingleNode(t,"Element");if(null!=e){let t=r.XmlDomUtil.GetSingleNode(e,"Text");null!=t&&(this.MedicalValue=t.textContent)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LightOrientationPhtotoInfo=void 0;const r=n(4);class i{get PupilPhtotValueFirst(){return this._PupilPhtotValueFirst}set PupilPhtotValueFirst(e){this._PupilPhtotValueFirst=e}get PupilPhtotValueSecond(){return this._PupilPhtotValueSecond}set PupilPhtotValueSecond(e){this._PupilPhtotValueSecond=e}get PupilPhtotValueThird(){return this._PupilPhtotValueThird}set PupilPhtotValueThird(e){this._PupilPhtotValueThird=e}get PupilPhtotValueFourth(){return this._PupilPhtotValueFourth}set PupilPhtotValueFourth(e){this._PupilPhtotValueFourth=e}get PupilPhtotValueFifth(){return this._PupilPhtotValueFifth}set PupilPhtotValueFifth(e){this._PupilPhtotValueFifth=e}get PupilPhtotValueSixth(){return this._PupilPhtotValueSixth}set PupilPhtotValueSixth(e){this._PupilPhtotValueSixth=e}get PupilPhtotValueNinth(){return this._PupilPhtotValueNinth}set PupilPhtotValueNinth(e){this._PupilPhtotValueNinth=e}get GetTextInfoPupilPhtotValueSixth(){return this._GetTextInfoPupilPhtotValueSixth}set GetTextInfoPupilPhtotValueSixth(e){this._GetTextInfoPupilPhtotValueSixth=e}get PupilPhtotValueSeventh(){return this._PupilPhtotValueSeventh}set PupilPhtotValueSeventh(e){this._PupilPhtotValueSeventh=e}get PupilPhtotValueEighth(){return this._PupilPhtotValueEighth}set PupilPhtotValueEighth(e){this._PupilPhtotValueEighth=e}IsEmpty(){return r.default.IsNullOrEmpty(this.PupilPhtotValueFirst)&&r.default.IsNullOrEmpty(this.PupilPhtotValueSecond)&&r.default.IsNullOrEmpty(this.PupilPhtotValueThird)&&r.default.IsNullOrEmpty(this.PupilPhtotValueFourth)&&r.default.IsNullOrEmpty(this.PupilPhtotValueFifth)&&r.default.IsNullOrEmpty(this.PupilPhtotValueSixth)&&r.default.IsNullOrEmpty(this.PupilPhtotValueSeventh)&&r.default.IsNullOrEmpty(this.PupilPhtotValueEighth)&&r.default.IsNullOrEmpty(this.PupilPhtotValueNinth)}GetTextInfo(){return new i}ToString(){return r.default.Concat([this.PupilPhtotValueFirst,",",this.PupilPhtotValueSecond,",",this.PupilPhtotValueThird,",",this.PupilPhtotValueFourth,",",this.PupilPhtotValueFifth,",",this.PupilPhtotValueSixth,",",this.PupilPhtotValueSeventh,",",this.PupilPhtotValueEighth,",",this.PupilPhtotValueNinth])}}t.LightOrientationPhtotoInfo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MedicineOneToFourBasicExpressionInfo=void 0;const r=n(4);class i{get FirstMenstruationAge(){return this._FirstMenstruationAge}set FirstMenstruationAge(e){this._FirstMenstruationAge=e}get MenstruationCycle(){return this._MenstruationCycle}set MenstruationCycle(e){this._MenstruationCycle=e}get EndMenstruationAge(){return this._EndMenstruationAge}set EndMenstruationAge(e){this._EndMenstruationAge=e}get Cycle(){return this._Cycle}set Cycle(e){this._Cycle=e}get IsShowFirstMenstruationAgeDate(){return this._IsShowFirstMenstruationAgeDate}set IsShowFirstMenstruationAgeDate(e){this._IsShowFirstMenstruationAgeDate=e}get IsShowEndMenstruationAgeDate(){return this._IsShowEndMenstruationAgeDate}set IsShowEndMenstruationAgeDate(e){this._IsShowEndMenstruationAgeDate=e}get MenstruationCycleDataSource(){return this._MenstruationCycleDataSource}set MenstruationCycleDataSource(e){this._MenstruationCycleDataSource=e}get MenstruationCycleSelectIndex(){return this._MenstruationCycleSelectIndex}set MenstruationCycleSelectIndex(e){this._MenstruationCycleSelectIndex=e}get CycleSelectIndex(){return this._CycleSelectIndex}set CycleSelectIndex(e){this._CycleSelectIndex=e}GetTextInfo(){let e=new i;return e.FirstMenstruationAge="Value1",e.MenstruationCycle="Value2",e.Cycle="Value1",e}IsEmpty(){return r.default.IsNullOrEmpty(this.FirstMenstruationAge)&&r.default.IsNullOrEmpty(this.MenstruationCycle)&&r.default.IsNullOrEmpty(this.EndMenstruationAge)&&r.default.IsNullOrEmpty(this.Cycle)}}t.MedicineOneToFourBasicExpressionInfo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetalHeartPhotoInfo=void 0;class r{get PupilPhtotValueFirst(){return this._pupilPhtotValueFirst}set PupilPhtotValueFirst(e){this._pupilPhtotValueFirst=e}get PupilPhtotValueSecond(){return this._pupilPhtotValueSecond}set PupilPhtotValueSecond(e){this._pupilPhtotValueSecond=e}get PupilPhtotValueThird(){return this._pupilPhtotValueThird}set PupilPhtotValueThird(e){this._pupilPhtotValueThird=e}get PupilPhtotValueFourth(){return this._pupilPhtotValueFourth}set PupilPhtotValueFourth(e){this._pupilPhtotValueFourth=e}get PupilPhtotValueFifth(){return this._pupilPhtotValueFifth}set PupilPhtotValueFifth(e){this._pupilPhtotValueFifth=e}get PupilPhtotValueSixth(){return this._pupilPhtotValueSixth}set PupilPhtotValueSixth(e){this._pupilPhtotValueSixth=e}GetTextInfo(){let e=new r;return e.PupilPhtotValueFirst="Value1",e.PupilPhtotValueSecond="Value2",e.PupilPhtotValueThird="Value3",e.PupilPhtotValueFourth="Value4",e.PupilPhtotValueFifth="Value5",e.PupilPhtotValueSixth="Value6",e}IsEmpty(){return!(this._pupilPhtotValueFirst||this._pupilPhtotValueSecond||this._pupilPhtotValueThird||this._pupilPhtotValueFourth||this._pupilPhtotValueFifth||this._pupilPhtotValueSixth)}ToString(){return this._pupilPhtotValueFirst+","+this._pupilPhtotValueSecond+","+this._pupilPhtotValueThird+","+this._pupilPhtotValueFourth+","+this._pupilPhtotValueFifth+","+this._pupilPhtotValueSixth}}t.FetalHeartPhotoInfo=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PupilPhotoInfo=void 0;class r{get PupilPhtotValueFirst(){return this._pupilPhtotValueFirst}set PupilPhtotValueFirst(e){this._pupilPhtotValueFirst=e}get PupilPhtotValueSecond(){return this._pupilPhtotValueSecond}set PupilPhtotValueSecond(e){this._pupilPhtotValueSecond=e}get PupilPhtotValueThird(){return this._pupilPhtotValueThird}set PupilPhtotValueThird(e){this._pupilPhtotValueThird=e}get PupilPhtotValueFourth(){return this._pupilPhtotValueFourth}set PupilPhtotValueFourth(e){this._pupilPhtotValueFourth=e}get PupilPhtotValueFifth(){return this._pupilPhtotValueFifth}set PupilPhtotValueFifth(e){this._pupilPhtotValueFifth=e}get PupilPhtotValueSixth(){return this._pupilPhtotValueSixth}set PupilPhtotValueSixth(e){this._pupilPhtotValueSixth=e}get PupilPhtotValueSeventh(){return this._pupilPhtotValueSeventh}set PupilPhtotValueSeventh(e){this._pupilPhtotValueSeventh=e}GetTextInfo(){let e=new r;return e.PupilPhtotValueFirst="Value1",e.PupilPhtotValueSecond="Value2",e.PupilPhtotValueThird="Value3",e.PupilPhtotValueFourth="Value4",e.PupilPhtotValueFifth="Value5",e.PupilPhtotValueSixth="Value6",e.PupilPhtotValueSeventh="Value7",e}IsEmpty(){return!(this._pupilPhtotValueFirst||this._pupilPhtotValueSecond||this._pupilPhtotValueThird||this._pupilPhtotValueFourth||this._pupilPhtotValueFifth||this._pupilPhtotValueSixth||this._pupilPhtotValueSeventh)}ToString(){return this._pupilPhtotValueFirst+","+this._pupilPhtotValueSecond+","+this._pupilPhtotValueThird+","+this._pupilPhtotValueFourth+","+this._pupilPhtotValueFifth+","+this._pupilPhtotValueSixth+","+this._pupilPhtotValueSeventh}}t.PupilPhotoInfo=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XEmptyLineSpaceEle=void 0;const r=n(329);class i extends r.XSpliteLineEle{get EleTypeName(){return"XEmptyLineSpace"}IsWholeLineEle(){return!0}ReCalcBaseSize(){this.SetSizeDPI(1,1,96),super.ReCalcBaseSize()}}t.XEmptyLineSpaceEle=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPageBreakLabel=void 0;const r=n(51),i=n(103),l=n(7),s=n(43),o=n(0),a=n(14);class u extends o.XLabelEle{constructor(){super(),super.Text=u.PgBrk_Text,super.EleStyle.ForeColor=l.Color.Gray,super.EleStyle.XFontStyle.UpdateFontAttrs(u.PgBrk_DftFont)}get EleTypeName(){return"XPageBreakLabel"}ReCalcBaseSize(){if(!this.IsLayoutValid){let e=s.GrapUtil.MeasureStrSize(null,u.PgBrk_DftFont,1e3,super.Text);this.SetSizeDPI(e.Width,e.Height,96),this.IsLayoutValid=!0}}GetInnerText(e){return u.PgBrk_Text}NeedSerialized(){return!0}FromXML(e){super._FromXML_EleStyle(e);let t=a.XmlDomUtil.GetSingleNode(e,"XID");null!=t&&(super.XID_Test=t.textContent)}}t.XPageBreakLabel=u,u.PgBrk_Text="-----分页符-----",u.PgBrk_DftFont=new r.Font("NSimsun",10.5,i.FontStyle.Regular)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseMarkContainer=void 0;const r=n(678),i=n(39),l=n(216),s=n(0),o=n(4),a=n(21),u=n(8),h=n(3);class d extends s.XBaseContainer{constructor(){super(),this.itemList=new h.List,this.markUtil=new r.XMarkEleUtil,this.markUtil.CalcMarkElePos=this.CalcPosByRelLineEleFrom.bind(this)}get IsVisible(){return this.markUtil.IsVisible}set IsVisible(e){this.markUtil.IsVisible=e}get RelLineEleFrom(){return this.markUtil.RelLineEleFrom}set RelLineEleFrom(e){this.markUtil.RelLineEleFrom=e,null!=e&&(super.OwnerLine=e.OwnerLine)}get RelLineEleTo(){return this.markUtil.RelLineEleTo}set RelLineEleTo(e){if(this instanceof s.XCommentEle){let t=new h.List;if(this.RelLineEleFrom.OwnerLine.Container==e.OwnerLine.Container){let n=this.RelLineEleFrom.OwnerLine.Container,r=this.RelLineEleFrom.OwnerLine.IndexInView,i=e.OwnerLine.IndexInView;for(let l=r;l<=i;l++){let s=n.LinesList.Get(l);if(r==i){let n=s.ChildEleList.IndexOf(this.RelLineEleFrom),r=s.ChildEleList.IndexOf(e),i=s.ChildEleList.GetRange(n,r-n+1);t.AddRange(i)}else if(l==r){let e=s.ChildEleList.IndexOf(this.RelLineEleFrom),n=s.ChildEleList.GetRange(e,s.ChildEleList.Length-e);t.AddRange(n)}else if(l==i){let n=s.ChildEleList.IndexOf(e),r=s.ChildEleList.GetRange(0,n+1);t.AddRange(r)}else t.AddRange(s.ChildEleList)}this.RangList=t}else{this.RelLineEleFrom.OwnerLine.Container,e.OwnerLine.Container;s.XTextTable}}this.markUtil.RelLineEleTo=e}get UserID(){return this.propList.GetPropValue("ID")}set UserID(e){this.propList.ModifyProperty("ID",e,null)}get UserName(){return this.propList.GetPropValue("Name")}set UserName(e){this.propList.ModifyProperty("Name",e,null)}get AddTime(){return this.propList.GetPropValue("AddTime")}get Status(){let e=this.propList.GetPropValue("Status");return u.CNumUtil.TryParseBool(e,!1)}set Status(e){this.propList.ModifyProperty("Status",e,!1)}_ParseDatetime(e){let t,n=i.DateTime.Now;if(o.default.IsNullOrEmpty(e))t=n;else{i.DateTime.TryParse(e,"yyyyMMddHHmmss",n);t=n}return t}set AddTime(e){this.propList.ModifyProperty("AddTime",e,null)}GetRelEleInx(e){return e?this.markUtil.FromEleInx:this.markUtil.ToEleInx}IsRelLineEleFromToValid(){return this.markUtil.IsRelLineEleValid(!0)&&this.markUtil.IsRelLineEleValid(!1)}IsRelFromToSameEle(){return this.RelLineEleFrom==this.RelLineEleTo}TrySetRelFromEle(e){let t;if(null==e)return t=!1,t;if(this.markUtil.IsRelLineEleValid(!0))return t=e.XID===this.markUtil.FromEleInx.EleXID,t;let n=e.Parent,r=this.markUtil.FromEleInx.ChildEleIx;if((r>=0?n.XID:e.XID)!=this.markUtil.FromEleInx.EleXID)return t=!1,t;let i=r>=0?n.GetChildEle(r):e;return this.RelLineEleFrom=i,this.markUtil.FromEleInx===this.markUtil.ToEleInx&&(this.markUtil.RelLineEleTo=i),t=!0,t}TrySetRelToEle(e){let t;if(null==e)return t=!1,t;if(this.markUtil.IsRelLineEleValid(!1))return t=e.XID===this.markUtil.ToEleInx.EleXID,t;let n=e.Parent,r=this.markUtil.ToEleInx.ChildEleIx;if((r>=0?n.XID:e.XID)!=this.markUtil.ToEleInx.EleXID)return t=!1,t;let i=r>=0?n.GetChildEle(r):e;return this.RelLineEleTo=i,t=!0,t}get IsFocused(){return this.markUtil.IsFocused}set IsFocused(e){this.markUtil.IsFocused=e}get ItemList(){return this.itemList}AutoFormatAddTime(){return this.AddTime}ToXML(e){return this._BuildRelEleRange_BeforeToXML(),super.ToXML(e)}FromXML(e){if(super.FromXML(e),this instanceof s.XCommentEle&&2==this.ChildEleList.Length){let e=new s.XStringEle;e.Text="",this.AddChildEle(2,e)}this._ParseRelEleRange_AfterFromXML()}_BuildRelEleRange_BeforeToXML(){let e=new a.default,t=[this.markUtil.RelLineEleFrom,this.markUtil.RelLineEleTo];for(let n=0;n<t.length;n++){let r=t[n];if(null!=r)if(r.NeedSerialized())e.append(String(r.OwnerLineInx)).append(",").append(r.XID).append(",").append(String(-1)).append(";");else{let t=r instanceof s.XCharacterEle?r:null,n=null==t?null:t.GetXmlEleIx();null!=n&&(e.append(String(r.OwnerLineInx)).append(","),e.append(n.EleXID).append(","),e.append(String(n.ChildEleIx)).append(";"))}}let n=e.toString();e.Clear(),0==n.length&&(n=null),this.propList.ModifyProperty("OnEleRange",n,null)}_ParseRelEleRange_AfterFromXML(){let e=this.propList.GetPropValue("OnEleRange");if(!o.default.IsNullOrEmpty(e)){let t=e.split(";");if(null!=t&&t.length>=2)for(let e=0;e<2;e++){let n=t[e],r=n.indexOf(","),i=r<=0?-1:n.indexOf(",",r+1);if(r>0&&i>0){let t=u.CNumUtil.TryParseInt(n.substring(0,r),-1),s=n.substring(r+1,i),o=u.CNumUtil.TryParseInt(n.substring(i+1),-1),a=new l.XElementInx(s);a.ChildEleIx=o,a.AtLineIx=t,0==e?this.markUtil.FromEleInx=a:this.markUtil.ToEleInx=a}}}}}t.XBaseMarkContainer=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XMarkEleUtil=void 0;const r=n(116),i=n(216);t.XMarkEleUtil=class{constructor(){this.isVisible=!1,this.isFocused=!1,this.fromEleInx=null,this.toEleInx=null,this.relEleRange=null,this.fromEleInx=new i.XElementInx,this.toEleInx=new i.XElementInx,this.relEleRange=new r.XLineEleRange}get IsVisible(){return this.isVisible}set IsVisible(e){this.isVisible=e}get IsFocused(){return this.isFocused}set IsFocused(e){this.isFocused=e}get FromEleInx(){return this.fromEleInx}set FromEleInx(e){this.fromEleInx=e}get ToEleInx(){return this.toEleInx}set ToEleInx(e){this.toEleInx=e}get RelLineEleFrom(){return this.relEleRange.FromLineEle}set RelLineEleFrom(e){this.relEleRange.SetFromIx(e),this.fromEleInx.EleObj=e,null!=this.CalcMarkElePos&&this.CalcMarkElePos(e)}get RelLineEleTo(){return this.relEleRange.ToLineEle}set RelLineEleTo(e){this.relEleRange.SetToIx(e,!0),this.toEleInx.EleObj=e}IsRelLineEleValid(e){let t=e?this.relEleRange.FromLineEleIx:this.relEleRange.ToLineEleIx;return null!=t&&t.IsValid()}AutoCalcCommentPosY(e){let t,n=e.RealTop;e.OwnerLine;return t=n,t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XContainerColView=void 0;const r=n(334);class i extends r.XContainerBaseView{get EleTypeName(){return"[XContainerColView]"}}t.XContainerColView=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPageView=void 0;const r=n(9),i=n(17),l=n(10),s=n(3),o=n(0),a=n(6),u=n(2),h=n(132);class d extends o.XContainerBaseView{constructor(e){super(),this.xdoc=null,this.drawArgs=null,this.docArgs=null,this.pageIx=-1,this.localPageIx=-1,this._fromLineIx=0,this._ToLineIx=0,this.pageRectUI=r.RectangleF.Empty,this.dragDashLineF=[],this.prevPage=null,this.nextPage=null,this.cmmtList=null,this.relDocPage=null,this.arrFocusRectF=null,this.arrSelRectF=null,this.rectType=u.ENumBkgRectsType.None,this.dragDashRectF=r.RectangleF.Empty,this.xdoc=e,this.cmmtList=new s.List}get EleTypeName(){return"[XPageView]"}get PageDrawArgs(){return this.drawArgs}set PageDrawArgs(e){this.drawArgs=e}get DocArgs(){return this.docArgs}set DocArgs(e){this.docArgs=e}get PageIx(){return this.pageIx}set PageIx(e){this.pageIx=e}get LocalPageIx(){return this.localPageIx}set LocalPageIx(e){this.localPageIx=e}get FromLineIx(){return this._fromLineIx}set FromLineIx(e){this._fromLineIx=e}get ToLineIx(){let e=this.GetPagePanelView(a.ENumPagePanelTp.Body).LinesCnt;return this.FromLineIx+e-1}GetPageRectUI(e){let t=r.RectangleF.Empty;return l.DPITransUtil.TransRectF(this.pageRectUI,300,t,e),t}get DragDashLineF(){return this.dragDashLineF}set DragDashLineF(e){this.dragDashLineF=e}SetDragDashLineF(e,t,n=!1){if(e<0)return void(this.dragDashLineF[0]=this.dragDashLineF[1]=i.PointF.Empty);let l=r.RectangleF.Empty;n?l=this.GetPageRectUI(96):(l.X=l.Y=0,l.Width=l.Height=1073741823),this.dragDashLineF=t?[new i.PointF(l.X,e),new i.PointF(l.Right,e)]:[new i.PointF(e,l.Y),new i.PointF(e,l.Bottom)]}get PrevPage(){return this.prevPage}set PrevPage(e){this.prevPage=e,null!=e&&(e.nextPage=this)}get NextPage(){return this.nextPage}get FirstPage(){let e=this;for(;;){let t=e.PrevPage;if(null==t)break;e=t}return e}get Document(){return this.xdoc}SetPageLocationUI(e,t,n){if(n>0&&300!=n){let r=300/n;e=e*r+.5,t=t*r+.5}this.pageRectUI.X=e,this.pageRectUI.Y=t}SetPageSizeUI(e,t,n){if(n>0&&300!=n){let r=300/n;e=e*r+.5,t=t*r+.5}this.pageRectUI.Width=e,this.pageRectUI.Height=t}GetPageBodyRect(e){let t=this.Document,n=t.AssistFunc.CalcPagePanelLeft(e),i=t.AssistFunc.CalcPageBodyTop(e),l=t.AssistFunc.CalcPageBodyBottom(e),s=t.AssistFunc.CalcPageBodyWidth(e);return new r.RectangleF(n,i,s,l-i)}AddComment(e,t){if(null!=e){let n=this.Document;if(t){n.GetPagePanel(a.ENumPagePanelTp.CmmtBar).AddChildCmmt(e),e.RefreshLines(!1)}this.AddChildCmmt(e)}}AddChildCmmt(e){if(this.cmmtList.Length<=0)return void this.cmmtList.Insert(0,e);let t=e.RelLineEleFrom,n=new h.XLineEleIx;n.SetEle2(t);let r=0;for(let e of this.cmmtList){let t=e;if(null==t)r++;else{let e=t.RelLineEleFrom,i=new h.XLineEleIx;if(i.SetEle2(e),n.CompareTo(i)<0)break;r++}}this.cmmtList.Insert(r,e)}GetPagePanelView(e){let t=null,n=super.GetChildIter();for(;n.MoveNext();){let r=n.Current;if(null!=r&&r.PagePanelTp==e){t=r;break}}return t}get RelDocPage(){return this.relDocPage}set RelDocPage(e){this.relDocPage=e}GetCommentIter(){let e=this.cmmtList.GetEnumerator();return e.Reset(),e}GetCommentList(){return this.cmmtList}GetSelRects(e){return e==u.ENumBkgRectsType.HoverRects?this.arrFocusRectF:this.arrSelRectF}FiltLineSelRects(e,t){let n=null==t?0:t.length;if(n<=0)return null;let r=new s.List,i=0;for(;i<n;){let n=t[i];e==a.ENumPagePanelTp.Body?n.Line&&this==n.Line.PageView?(r.AddRange(n.ArrRectF),i++):i++:(r.AddRange(n.ArrRectF),i++)}return r.ToArray()}ClearSelRects(e){for(let t=this;null!=t;t=t.NextPage)e==u.ENumBkgRectsType.HoverRects||e==u.ENumBkgRectsType.FocusRects?t.arrFocusRectF=null:t.arrSelRectF=null}get RectType(){return this.rectType}SetSelRects(e,t){e==u.ENumBkgRectsType.HoverRects?this.arrFocusRectF=t:(this.rectType=e,this.arrSelRectF=t)}get DragDashRectF(){return this.dragDashRectF}set DragDashRectF(e){this.dragDashRectF=e}GetEleAtPos(e,t,n,r,i){if(n>0&&300!=n){let r=300/n;e*=r,t*=r}let l=this.xdoc.GetDocCtxt().ViewMode.IsWebViewMode,s=this.Document.GetPageFmt(),o=s.PagePadd,u=3*s.Width,h=3*o.Left,d=3*o.Right;l||(e<=h?e=h+2:e>=u-d&&(e=u-d-2));let c=this.GetPagePanelView(a.ENumPagePanelTp.Body);if(null!=c&&(c.GetEleAtPos(e,t,-1,r,i),r.IsValid()))return;let p=this.GetPagePanelView(a.ENumPagePanelTp.Header);if(null!=p&&(p.GetEleAtPos(e,t,-1,r,i),r.IsValid()))return;let f=this.GetPagePanelView(a.ENumPagePanelTp.Footer);null!=f&&(f.GetEleAtPos(e,t,-1,r,i),r.IsValid())}}t.XPageView=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocPanel=void 0;const r=n(6),i=n(0),l=n(10);class s extends i.XBaseContainer{constructor(e){super(),this.pagePanelTp=r.ENumPagePanelTp.Body,this.isEditable=!1,this.isChanged=!1,this.xdoc=null,this.pagePanelTp=e}get EleTypeName(){let e=null;switch(this.pagePanelTp){case r.ENumPagePanelTp.Header:e="XTextHeader";break;case r.ENumPagePanelTp.Body:e="XTextBody";break;case r.ENumPagePanelTp.Footer:e="XTextFooter";break;case r.ENumPagePanelTp.CmmtBar:e="XDocComment"}return e}get IsEditable(){return this.isEditable}set IsEditable(e){this.isEditable=e}get IsChanged(){return this.isChanged}set IsChanged(e){this.isChanged=e}get Document(){return this.xdoc}set Document(e){this.xdoc=e}get OwnerDocPanel(){return this}set OwnerDocPanel(e){}get PagePanelTp(){return this.pagePanelTp}Clear(){super.Clear(),this.isEditable=!1,this.isChanged=!1}GetValidWidth(e){if(null==this.xdoc)return 0;let t=this.xdoc.GetPageFmt().GetValidWidthDPI(300);return t=l.DPITransUtil.TransFloatVal(t,300,e),t}GetValidHeight(e){if(null==this.xdoc)return 0;let t=0;switch(this.pagePanelTp){case r.ENumPagePanelTp.Header:t=super.GetLinesHeight(!1,!1,e);break;case r.ENumPagePanelTp.Body:t=this.xdoc.AssistFunc.CalcPageBodyHeight(e);break;case r.ENumPagePanelTp.Footer:t=super.GetLinesHeight(!1,!1,e)}return t}SetPositionDPI(e,t,n){if(null==this.xdoc)return;let i=this.xdoc.GetPageFmt(),s=this.xdoc.GetDocCtxt().ViewMode,o=i.GetPagePaddWithGutter();o=l.DPITransUtil.TransPadding(o,100,300);let a=i.GetWidthDPI(300),u=i.GetHeightDPI(300);switch(e=o.Left,s.IsWebViewMode&&(e=l.DPITransUtil.TransFloatVal(5,100,300)),this.pagePanelTp){case r.ENumPagePanelTp.Header:t=l.DPITransUtil.TransFloatVal(i.HeadTopMargin,100,300);break;case r.ENumPagePanelTp.Body:t=this.xdoc.AssistFunc.CalcPageBodyTop(300);break;case r.ENumPagePanelTp.Footer:let n=l.DPITransUtil.TransFloatVal(i.FootBtmMargin,100,300);t=u-this.Height-n;break;case r.ENumPagePanelTp.CmmtBar:e+=a,t=0}super.SetPositionDPI(e,t,300)}CalcSizeByLines(){if(!this.IsLayoutValid){super._Calc_LinesWrapSize();let e=300,t=this.GetValidWidth(e),n=this.GetValidHeight(e);this.SetSizeDPI(t,n,e),this.IsLayoutValid=!0}}GetColumnsParam(){if(this.PagePanelTp!=r.ENumPagePanelTp.Body)return null;let e=this.Document;return null==e?null:e.GetPageCols()}}t.XDocPanel=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocPanelCmmt=void 0;const r=n(3),i=n(0),l=n(6),s=n(132);class o extends i.XDocPanel{constructor(){super(l.ENumPagePanelTp.CmmtBar),this.lineEleIx=null,this.lineEleIx=new s.XLineEleIx}GetValidWidth(e){let t;if(null==this.Document)t=0;else{t=this.Document.AssistFunc.CalcCmmtBarWidth(e)}return t}CalcSizeByLines(){this.IsLayoutValid}AddChildCmmt(e){if(super.ChildCount<=0)return void super.AddChildEle(0,e);let t=e.RelLineEleFrom,n=new s.XLineEleIx;n.SetEle2(t);let r=0,i=super.GetChildIter();for(;i.MoveNext();){let e=i.Current;if(null==e)r++;else{let t=e.RelLineEleFrom;if(this.lineEleIx.SetEle2(t),n.CompareTo(this.lineEleIx)<0)break;r++}}super.AddChildEle(r,e)}UpdateRelFromToBeforeDel(e){if(super.ChildCount>0){let t=null,n=new r.List,i=0,l=super.GetChildIter();for(;l.MoveNext();){let r=l.Current;null==r||(t=null,r.RelLineEleFrom==e?t=!0:r.RelLineEleTo==e&&(t=!1),null!=t||1==t&&r.IsRelFromToSameEle()&&n.Add(i)),i++}let s=n.ToArray();this.BatRemoveChildren(s)}}}t.XDocPanelCmmt=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPagePanelView=void 0;const r=n(9),i=n(3),l=n(0),s=n(6);class o extends l.XDocPanel{constructor(e){super(e)}get OwnPageView(){return super.Parent}get IsEditable(){let e=super.GetFirstLine();return this._Is_EditableLine(e)}CalcReadOnlyRects(e,t){let n;if(super.PagePanelTp==s.ENumPagePanelTp.CmmtBar)return n=null,[n,null];let l=super.GetBoundsDPI(t);l.X+=e.X,l.Y+=e.Y;let o=super.GetFirstLine();if(!this._Has_MultiXDocs())return n=this._Is_EditableLine(o)?null:[l],[n,null];let a=r.RectangleF.Empty,u=new i.List,h=[],d=null;for(let e of this.lineList){let n=e.FirstElement?e.FirstElement.Document:null;if(n!=d){if(null!=d){d.GetPagePanel(s.ENumPagePanelTp.Body).IsEditable||(a.X+=l.X,a.Y+=l.Y,u.Add(a),h.push(d.UnEditableColor))}a=e.GetBoundsDPI(t),a.Height=e.LineAssist.GetLineFullHeight(t,!0)-3,a.Width=l.Width,d=n}else a.Height+=e.LineAssist.GetLineFullHeight(t,!0)}if(null!=d){d.GetPagePanel(s.ENumPagePanelTp.Body).IsEditable||(a.X+=l.X,a.Y+=l.Y,u.Add(a),h.push(d.UnEditableColor))}let c=u.ToArray();return u.Clear(),[c,h]}_Is_EditableLine(e){let t,n=null==e?null:e.FirstElement;if(null==n)t=!1;else{let e=n.OwnerDocPanel;t=null!=e&&e.IsEditable}return t}NeedSerialized(){return!1}_Has_MultiXDocs(){if(super.PagePanelTp!=s.ENumPagePanelTp.Body)return!1;let e=super.GetFirstLine(),t=super.GetEndLine();return e!=t&&(e.FirstElement?e.FirstElement.Document:null)!=(t.FirstElement?t.FirstElement.Document:null)}GetNextPage_PanelView(e){if(super.PagePanelTp!=s.ENumPagePanelTp.Body)return null;let t=this.OwnPageView,n=e?t.NextPage:t.PrevPage;if(null==n)return null;let r=n.GetPagePanelView(s.ENumPagePanelTp.Body);return r instanceof o?r:null}GetPagePanelView(e){let t=null;for(let n of super.ChildEleList){let r=n;if(null!=r&&r.PagePanelTp==e){t=r;break}}return t}}t.XPagePanelView=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextDocumentsWrap=void 0;const r=n(44),i=n(6),l=n(3),s=n(0),o=n(21);class a extends s.XBaseContainer{constructor(e){super(),this.docWrapIx=-1,this.xdocList=null,this.arrXDocChangedBak=null,this.pageList=null,this.xdocList=new l.List,this.AddXDoc(e)}get EleTypeName(){return"[XTextDocumentsWrap]"}get XDocWrapIx(){return this.docWrapIx}set XDocWrapIx(e){this.docWrapIx=e}get XDocsCnt(){return null==this.xdocList?0:this.xdocList.Count()}get FirstXDoc(){return this.XDocsCnt<=0?null:this.xdocList.Get(0)}get Document(){return null}Clear(){super.Clear(),this.xdocList.ToArray().forEach(e=>{null!=e&&e.Clear()}),this.xdocList.Clear(),this.arrXDocChangedBak=null,this.ClearPageList()}GetFirstPage(){return null==this.pageList||this.pageList.Count()<=0?null:this.pageList.Get(0)}GetLastPage(){return null==this.pageList||this.pageList.Count()<=0?null:this.pageList.Get(this.pageList.Length-1)}GetPageList(){return this.pageList}AddPage(e){if(null==e)return;null==this.pageList&&(this.pageList=new l.List),e.PageView.Document.GetDocCtxt().PgvPaiting=e.PageView,this.pageList.Add(e)}ClearPageList(){null!=this.pageList&&this.pageList.Count()>0&&(this.pageList.ToArray().forEach(e=>{if(null!=e){e.PageView.ClearLines(!1,!1)}}),this.pageList.Clear()),this.ResetVariable_PagesCnt(!0)}MergeXDocsName(e){let t=this.XDocsCnt;if(t<=0)return"";null==e&&(e="");let n=0,r=new o.default;return this.xdocList.ToArray().forEach(i=>{r.append(i.DocName),n++<t-1&&r.append(e)}),r.toString()}ContainsXDoc(e){return this.XDocsCnt>0&&this.xdocList.Contains(e)}GetXDocBodiesArr(){if(this.XDocsCnt<=0)return null;let e=[],t=0;for(let n of this.xdocList)e[t++]=n.GetPagePanel(i.ENumPagePanelTp.Body);return e}GetXDocs(){let e=[];for(let t of this.xdocList)e.push(t);return e}AddXDoc(e){null!=e&&(null==this.xdocList&&(this.xdocList=new l.List),this.xdocList.Add(e))}addTextDocument(e){this.xdocList.Add(e)}CloseDocWithIndex(e){for(let t of this.xdocList)t.DocID==e&&this.xdocList.Remove(t)}CopyXDocWrapFrom(e){this.Clear();let t=null==e?null:e.xdocList;if(null!=t&&t.Count()>0)for(let e of t)if(null!=e){let t=e.AssistFunc.CopyXDocument2();this.AddXDoc(t)}}IsEqualTo(e){if(null==e)return!1;if(this==e)return!0;if(this.XDocsCnt!=e.XDocsCnt)return!1;let t=!0,n=this.xdocList.GetEnumerator(),r=e.xdocList.GetEnumerator();for(;n.MoveNext()&&r.MoveNext();){if(n.Current!=r.Current){t=!1;break}}return t}ResetVariable_PagesCnt(e){this.xdocList.ToArray().forEach(t=>{let n=t.GetDocCtxt();e&&n.SetValue("[%LocalNumOfPages%]",0),n.SetValue("[%NumOfPages%]",0)})}SetVariable_PagesCnt(e,t){for(let n of this.xdocList)n.GetDocCtxt().SetValue(e?"[%LocalNumOfPages%]":"[%NumOfPages%]",t)}RefreshXDocWrapLines(e){0!=this.XDocsCnt&&this.xdocList.ToArray().forEach(t=>{null!=t&&(t.RefreshLines(e),r.TextDocApiUtil.M_SetPartEleLayoutValid(t,["XTextRadioBox","XTextCheckBox"]),t.RefreshLines(e))})}ReCalcPagePanelPos(){if(0!=this.XDocsCnt)for(let e of this.xdocList)e.ReCalcPagePanelPos()}Backup_XDocChanged(){if(0==(null==this.xdocList?0:this.xdocList.Count))return;this.arrXDocChangedBak=[];let e=0;for(let t of this.xdocList)this.arrXDocChangedBak[e++]=t.IsChanged;return this.arrXDocChangedBak}Restore_XDocChanged(){if(null==this.arrXDocChangedBak)return;let e=0;for(let t of this.xdocList)this.arrXDocChangedBak[e++]||t.ResetChangedFlag();this.arrXDocChangedBak=null}}t.XTextDocumentsWrap=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableCell=void 0;const r=n(3),i=n(10),l=n(9),s=n(64),o=n(20),a=n(335),u=n(8),h=n(14),d=n(0),c=n(4),p=n(21);class f extends d.XBaseContainer{constructor(){super(),this.boundsDisp=l.RectangleF.Empty,this._widhtDisp=null,this._fixHeight=null,this._FromNextHideHeight=0,this._visible=!0,this._column=null,this._fixHeight_Disp=null,this._styleIndex=null,this._autoSize=null,this._rowSpan=1,this._colSpan=1,this._relatedMergeCell_Right=new r.List,this._relatedMergeCell_Down=new r.List,this._mainMergeCell=null,this._name=null,this._preFixHeight=null,this.preFixHeight_Disp=null,this._newFixHeight=null,this._newFixHeight_Disp=null,this._preAutoSize=null,this._newAutoSize=null,this._preElements=null,this._newElements=null,this._DisSplit=null,this._Slashing=null,this._SplitConByFixed=null,this.Visible=!0,this.AutoSize=!0,this.FixHeight_Disp=-1,this.FixHeight=-1,this.propupHeight=!1,this._relatedMergeCell_Down=new r.List,this._relatedMergeCell_Down=new r.List}GetLinesHeight(e,t,n){let r=this.linesWrapSize.Height,l=super.EleStyle.ElePadd;return e&&(r+=l.Top),t&&(r+=l.Bottom),i.DPITransUtil.TransFloatVal(r,300,n)}get EleTypeName(){return"XTextTableCell"}get BoundsDISP(){return this.boundsDisp}set BoundsDISP(e){this.boundsDisp=e}get PropupHeight(){return this.propupHeight}set PropupHeight(e){this.propupHeight=e}get ColumnBaseWidth(){let e;return e=null==this.Column?0:this.Column.Width,e}get Bounds(){return super.Bounds}get WidhtDisp(){return this._widhtDisp}set WidhtDisp(e){this._widhtDisp=e}get HeightDisp(){let e;return e=null!=super.Parent?i.DPITransUtil.TransIntVal(super.Parent.Height,300,96):0,e}get RowBaseHeight(){let e;return e=null!=super.Parent?super.Parent.Height:0,e}get FixHeight(){return this._fixHeight}set FixHeight(e){this._fixHeight=e}get FromNextHideHeight(){return this._FromNextHideHeight}set FromNextHideHeight(e){this._FromNextHideHeight=e}get Code(){return o.XTextTableUtil.TransformNumToAlpha(this.ColIndex)+this.RowIndex}get Visible(){return this._visible}set Visible(e){this._visible=e}get Column(){return this._column}set Column(e){this._column=e}get Select(){return this._select}set Select(e){this._select=e}get FixHeight_Disp(){return this._fixHeight_Disp}set FixHeight_Disp(e){this._fixHeight_Disp=e}get StyleIndex(){return this._styleIndex}set StyleIndex(e){this._styleIndex=e}get RowIndex(){let e;return e=super.Parent instanceof d.XTextTableRow?super.Parent.Index:-1,e}set RowIndex(e){}get ColIndex(){let e;return e=null!=this.Column?this.Column.Index:-1,e}get AutoSize(){return this._autoSize}set AutoSize(e){this._autoSize=e}get CellAlign(){return o.XTextTableUtil.GetCellAlignEnum(this.CellVAlignStr)}set CellAlign(e){this.CellVAlignStr=o.XTextTableUtil.GetCellAlignStr(e)}get CellVAlignStr(){let e=this.propList.GetPropValue("CellVAlignStr");return(null==e||c.default.IsNullOrEmpty(e.toString()))&&(e=s.XTextTableCellAlign.TOP.toString()),e.toString()}set CellVAlignStr(e){this.propList.ModifyProperty("CellVAlignStr",e,s.XTextTableCellAlign.TOP)}get RowSpan(){return this._rowSpan<=1?1:this._rowSpan}set RowSpan(e){this._rowSpan=e,this.propList.ModifyProperty("RowSpan",this._rowSpan,1)}get ColSpan(){return this._colSpan<=1?1:this._colSpan}set ColSpan(e){this._colSpan=e,this.propList.ModifyProperty("ColSpan",this._colSpan,1)}get RelatedMergeCell_Right(){return this._relatedMergeCell_Right}set RelatedMergeCell_Right(e){this._relatedMergeCell_Right=e}get RelatedMergeCell_Down(){return this._relatedMergeCell_Down}set RelatedMergeCell_Down(e){this._relatedMergeCell_Down=e}get MainMergeCell(){return this._mainMergeCell}set MainMergeCell(e){this._mainMergeCell=e}get IsUseXId(){return!0}get Id(){return super.GrpID}set Id(e){super.GrpID=e}get Name(){return this._name}get CanReflect(){return!1}get IsGroupEle(){return!1}get ShowName(){return this.Name}get PreFixHeight(){return this._preFixHeight}set PreFixHeight(e){this._preFixHeight=e}get PreFixHeight_Disp(){return this.preFixHeight_Disp}set PreFixHeight_Disp(e){this.preFixHeight_Disp=e}get NewFixHeight(){return this._newFixHeight}set NewFixHeight(e){this._newFixHeight=e}get NewFixHeight_Disp(){return this._newFixHeight_Disp}set NewFixHeight_Disp(e){this._newFixHeight_Disp=e}get PreAutoSize(){return this._preAutoSize}set PreAutoSize(e){this._preAutoSize=e}get NewAutoSize(){return this._newAutoSize}set NewAutoSize(e){this._newAutoSize=e}get PreElements(){return this._preElements}set PreElements(e){this._preElements=e}get NewElements(){return this._newElements}set NewElements(e){this._newElements=e}UpdateEleAttrFgHide(e,t){}CalcSizeByLines(){if(super._Calc_LinesWrapSize(),this.Visible){let e=0,t=0;if(this.SplitConByFixed&&this.FixHeight>0&&null!=this.lineList){for(let n of this.lineList){const r=n.LineAssist.GetLineFullHeight(300,!0);if(e>0&&e+r>this.FixHeight){if(n.ElementCnt>0)for(let e=0;e<n.ChildEleList.Length;e++){n.ChildEleList.Get(e).DisReflash=!0}}else e+=r,t++}if(t>0&&this.lineList.Length>t){const e=this.lineList.Length-t;this.lineList.RemoveRange(t,e)}}let n=this.GetRealHeight(!0);if(this.RowSpan>1&&this.RelatedMergeCell_Down.Count()>0){n=this.Height;let e=this.GetMergeCellTotalHeight(!0);n=n>=e?n:e}this.SetSizeDPI(-1,n,300),this.RowSpan<2?null!=this.LineCntChanged&&this.LineCntChanged(this,a.EventArgs.Empty):this.GetCombinCell_MaxHeight_New()}else null!=this.LineCntChanged&&this.LineCntChanged(this,a.EventArgs.Empty)}GetCombinCell_MaxHeight_New(){if(this.RowSpan>=2){let e=new r.List;e.Add(this);let t=this.Height;for(let n of super.Parent.ChildEleList){let r=n instanceof f?n:null;if(null!=r&&r.RowSpan>=2&&r.RowSpan==this.RowSpan&&r!=this){let n=r.GetRealHeight(!0);t=t>n?t:n,e.Add(r)}}for(let n of e)n.SetSizeDPI(-1e3,t,300);let n=this.GetMergeCellTotalHeight(!1);if(n>0){let e=t-n,r=this.RelatedMergeCell_Down.Get(this.RelatedMergeCell_Down.Count()-1);for(let t of r.Parent.ChildEleList){let n=t instanceof f?t:null;n.SetSizeDPI(-1e3,e,300),n.MainMergeCell==this&&n.NotifyLayoutChanged(!0,!1)}}}}GetMergeCellTotalHeight(e=!0){let t=this.RowBaseHeight;if(this.RowSpan>1){for(let e=0;e<this.RelatedMergeCell_Down.Count()-1;e++)t+=this.RelatedMergeCell_Down.Get(e).RowBaseHeight;if(e){let e=0;const n=this.RelatedMergeCell_Down.Count()-1,r=this.RelatedMergeCell_Down.Get(n),i=r.Parent;for(let t=0;t<i.ChildCount;t++){const n=i.Cells.Get(t);if(null!=n&&n.RowSpan<=1&&r.ColIndex!=t&&n.MainMergeCell!=this)if(n.Visible){const t=n.GetRealHeight(!0);t>e&&(e=t)}else{if(n.MainMergeCell&&n.MainMergeCell.RowSpan>1&&n.RowIndex>n.MainMergeCell.RowIndex&&n.RowIndex==n.MainMergeCell.RowIndex+n.MainMergeCell.RowSpan-1){const t=n.RowBaseHeight;t>e&&(e=t)}}}t+=e;const l=r.FixHeight;t=Math.max(t,l)}}return t}CalcLineHeight(e){let t=super.GetLinesIter(),n=0,r=0;for(;t.MoveNext()&&!(e>0&&r>=e);){r++,n+=t.Current.LineAssist.GetLineFullHeight(300,!0)}return n}RefreshInnerLines(e,t){if(null==super.OwnerLine)return;let n=this.CalcLineHeight();this.CellAlign==s.XTextTableCellAlign.MIDDLE?t+=(this.Height-super.EleStyle.ElePadd.Top-super.EleStyle.ElePadd.Bottom-n)/2:this.CellAlign==s.XTextTableCellAlign.BOTTOM&&(t+=this.Height-this.CalcLineHeight()-super.EleStyle.ElePadd.Bottom-super.EleStyle.ElePadd.Top);let r=this.lineList;for(let n=0;n<r.Count();n++)r.Get(n).RealLeft=e,r.Get(n).RealTop=t+super.EleStyle.ElePadd.Top,t+=r.Get(n).LineAssist.GetLineFullHeight(300,!0)}CreateInnerElement(){let e=new d.XParagraphFlag;e.OwnerDocPanel=this.OwnerDocPanel,this.AddChildEle(2147483647,e)}SetPositionDISP(e,t){-1e3!=e&&(this.boundsDisp.X=e),-1e3!=t&&(this.boundsDisp.Y=t)}SetPositionDPI(e,t,n){super.SetPositionDPI(e,t,n);let r=super.GetLinesIter(),i=super.EleStyle.ElePadd.Top,l=new p.default;for(this.CellAlign==s.XTextTableCellAlign.MIDDLE?i+=(this.Height-super.EleStyle.ElePadd.Top-super.EleStyle.ElePadd.Bottom-this.CalcLineHeight())/2:this.CellAlign==s.XTextTableCellAlign.BOTTOM&&(i=this.Height-this.CalcLineHeight()-super.EleStyle.ElePadd.Top-super.EleStyle.ElePadd.Bottom);r.MoveNext();){let e=r.Current;e.SetPositionDPI(0,i,n);e.GetElesIter(),e.Bounds;l.append("\r\n"),i+=e.LineAssist.GetLineFullHeight(300,!0)}this.innerText=l.toString()}RemoveChildren(e,t){return this.PreElements=super.RemoveChildren(e,t),this.NewElements=super.GetChildArr(),this.PreElements}SetSizeDPI(e,t,n,r=!0){96==n&&t>0?t=t>this.FixHeight_Disp||!r?t:this.FixHeight_Disp:300==n&&t>0&&(t=t>this.FixHeight||!r?t:this.FixHeight),super.SetSizeDPI(e,t,n)}RestoreCellSize(){null!=this.Column&&(this.WidhtDisp=this.Column.BoundsDISP.Width,this.SetSizeDPI(this.Column.Width,-1e3,300))}GetCharacterEle(){let e=new r.List;return this.GetCharacterEleWithPara(this,e),e}GetCharacterEleWithPara(e,t){for(let n of e.ChildEleList)n instanceof d.XBaseContainer?this.GetCharacterEleWithPara(n,t):t.Add(n)}GetRealHeight(e=!1){let t=0;for(let e of this.lineList)t+=e.LineAssist.GetLineFullHeight(300,!0);return t+=super.EleStyle.ElePadd.Top+super.EleStyle.ElePadd.Bottom,e&&(t=t>this.FixHeight?t:this.FixHeight),t}GetValidWidth(e){const t=super.EleStyle.ElePadd.Left,n=super.EleStyle.ElePadd.Right;return i.DPITransUtil.TransFloatVal(this.Bounds.Width-t-n,300,e)}CopyFrom(e,t=!1,n=!1,r=!0){super.CopyFrom(e,null,n,r),this.OwnerDocPanel=e.OwnerDocPanel,this.Column=e.Column,this.BoundsDISP=e.BoundsDISP,this.WidhtDisp=e.WidhtDisp,this.RowIndex=e.RowIndex,this.ColSpan=e.ColSpan,this.innerText=e.innerText,this.SetSizeDPI(e.Bounds.Width,e.Bounds.Height,300),super.EleStyle.CopyFrom(e.EleStyle,!1),t&&this.CopyChildEle(e,n,r)}CopyChildEle(e,t=!1,n=!0){let r=e.GetCharacterEle().ToArray();if(null==r)return;let i=null==r?0:r.length,l=0;for(;l<i;){let e,i=r[l],s=i.Parent;e=s.CanBeInline(!1)?d.XElementFactory.CreatXElement(i.EleTypeName,null):d.XElementFactory.CreatXElement(s.EleTypeName,null);let o=e.CopyFromSelRange(r,l,t,n,!1);if(o<=0)break;l+=o,this.AddChildEle(2147483647,e)}}setPaddLRByBorderLR(e=null){const t=super.EleStyle;if(null!=t){let n=t.BorderLeft,r=t.BorderRight;if("表格"==t.RightApplytoText&&(n=e,r=e),n&&r?t.ElePaddLeft=o.XTextTableUtil.PaddingLR:0!=this.ColIndex?t.ElePaddLeft=4:t.ElePaddLeft=1,r&&n)t.ElePaddRight=o.XTextTableUtil.PaddingLR;else{const e=null!=this._column&&null!=this._column.Parent?this._column.Parent:null,n=null!=e?e.NumOfColumns:0;n>0&&this.ColIndex+this.ColSpan>=n?t.ElePaddRight=4:t.ElePaddRight=1}}}FromXML(e){super.FromXML(e),this.innerText=e.textContent.trim(),this.StyleIndex=u.CNumUtil.TryParseInt(h.XmlDomUtil.GetSingleAttrValue(e,"StyleIndex"),-1),this.StyleIndex>0&&o.XTextTableUtil.StyleList.CopyEleStyle(this.StyleIndex,super.EleStyle);h.XmlDomUtil.GetSingleNode(e,"XElements").getElementsByTagName("Element");e.getElementsByTagName("ColSpan").length>0&&(this.ColSpan=parseInt(e.getElementsByTagName("ColSpan")[0].innerHTML)),e.getElementsByTagName("RowSpan").length>0&&(this.RowSpan=parseInt(e.getElementsByTagName("RowSpan")[0].innerHTML)),this.validateAddLastXPaFlag()}ToXML(e){o.XTextTableUtil.spanValidate(this);let t=super.ToXML(e);return null==t?null:t}get DisSplit(){if(null==this._DisSplit){const e=this.attrList.GetPropValue("DisSplit");this._DisSplit=u.CNumUtil.TryParseBool(e,!1)}return this._DisSplit}set DisSplit(e){this._DisSplit=!!e;const t=u.CNumUtil.ToStringForBool(this._DisSplit);this.attrList.ModifyProperty("DisSplit",t,"false")}get Slashing(){if(null==this._Slashing){const e=this.attrList.GetPropValue("Slashing");this._Slashing=u.CNumUtil.TryParseBool(e,!1)}return this._Slashing}set Slashing(e){this._Slashing=!!e;const t=u.CNumUtil.ToStringForBool(this._Slashing);this.attrList.ModifyProperty("Slashing",t,"false")}get SplitConByFixed(){if(null==this._SplitConByFixed){const e=this.attrList.GetPropValue("SplitConByFixed");this._SplitConByFixed=u.CNumUtil.TryParseBool(e,!1)}return this._SplitConByFixed}set SplitConByFixed(e){this._SplitConByFixed=!!e;const t=u.CNumUtil.ToStringForBool(this._SplitConByFixed);this.attrList.ModifyProperty("SplitConByFixed",t,"false")}get fixedCellVAlign(){return this._fixedCellVAlign}set fixedCellVAlign(e){this._fixedCellVAlign=e}}t.XTextTableCell=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableCellView=void 0;const r=n(0);class i extends r.XTextTableCell{constructor(){super(...arguments),this._baseCell=null}get EleTypeName(){return"XTextTableCell"}get BaseCell(){return this._baseCell}set BaseCell(e){this._baseCell=e}AddChildEle(e,t){return-1}CalcSizeByLines(){super._Calc_LinesWrapSize();let e=super.GetRealHeight(!1),t=!0,n=this.FixHeight;if(n>0&&null!=this._baseCell){if(this._baseCell.Height-.5>n)t=!1;else if(this.Visible&&this.LinesCnt>0&&this._baseCell.LinesCnt>0){const t=this.lineList.Get(0).Index;let r=this._baseCell.GetLinesHeight(!0,!0,300);for(let e=this._baseCell.LinesCnt-1;e>=t;e--){r-=this._baseCell.LinesList.Get(e).Height}n-=r-e}else n=0}t&&(e=e>n?e:n),e+=super.EleStyle.ElePadd.Top+super.EleStyle.ElePadd.Bottom,this.SetSizeDPI(-1,e,300,!1)}CopyFrom(e,t=!1,n=!1,r=!0){let i=e;null!=i&&(this.OwnerDocPanel=e.OwnerDocPanel,super.Column=i.Column,super.BoundsDISP=i.BoundsDISP,super.WidhtDisp=i.WidhtDisp,super.RowIndex=i.RowIndex,super.ColSpan=i.ColSpan,super.RowSpan=i.RowSpan,super.FixHeight=i.FixHeight,this.SetSizeDPI(i.Bounds.Width,i.Bounds.Height,300),super.EleStyle.CopyFrom(i.EleStyle,!1))}GetInnerText(e){return this.BaseCell.GetInnerText(e)}}t.XTextTableCellView=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableView=void 0;const r=n(0),i=n(9);class l extends r.XBaseContainer{constructor(){super(...arguments),this._BaseCell=null,this.boundsDisp=i.RectangleF.Empty,this._IsShowBorderHideLine=!1,this._isFollowParagraphFlag=!1,this._ID=null,this._IsDeleteRow=!1,this._IsDeleteTable=!1,this._IsSetColWidth=!1,this._IsInsertRow=!1,this._IsSetRowHeight=!1,this._IsShowCellCode=!1,this._FromRowIx=0,this._UsingCellBorderSetting=!1}get EleTypeName(){return"XTextTable"}get BaseCell(){return this._BaseCell}set BaseCell(e){this._BaseCell=e}get BoundsDISP(){return this.boundsDisp}set BoundsDISP(e){this.boundsDisp=e}SetSizeDISP(e,t){-1e3!=e&&(this.boundsDisp.Width=e),-1e3!=t&&(this.boundsDisp.Height=t)}get IsShowBorderHideLine(){return this._IsShowBorderHideLine}set IsShowBorderHideLine(e){this._IsShowBorderHideLine=e}get IsFollowParagraphFlag(){return this._isFollowParagraphFlag}set IsFollowParagraphFlag(e){this._isFollowParagraphFlag=e}get ID(){return this._ID}set ID(e){this._ID=e}get IsDeleteRow(){return this._IsDeleteRow}set IsDeleteRow(e){this._IsDeleteRow=e}get IsDeleteTable(){return this._IsDeleteTable}set IsDeleteTable(e){this._IsDeleteTable=e}get IsSetColWidth(){return this._IsSetColWidth}set IsSetColWidth(e){this._IsSetColWidth=e}get IsInsertRow(){return this._IsInsertRow}set IsInsertRow(e){this._IsInsertRow=e}get IsSetRowHeight(){return this._IsSetRowHeight}set IsSetRowHeight(e){this._IsSetRowHeight=e}get IsShowCellCode(){return this._IsShowCellCode}set IsShowCellCode(e){this._IsShowCellCode=e}get NumOfRows(){return super.LinesCnt}get FromRowIx(){return this._FromRowIx}set FromRowIx(e){this._FromRowIx=e}get UsingCellBorderSetting(){return this._UsingCellBorderSetting}set UsingCellBorderSetting(e){this._UsingCellBorderSetting=e}get NumOfColumns(){return this.numOfColumns}set NumOfColumns(e){this.numOfColumns=e}get BaseTable(){return this.baseTable}set BaseTable(e){this.baseTable=e}SetPositionDPI(e,t,n){super.SetPositionDPI(e,t,n);let r=0,i=super.GetLinesIter();for(;i.MoveNext();){let e=i.Current;e.IndexInView=r++;let t=e.GetElesIter();for(;t.MoveNext();){let n=t.Current;null!=n&&(n.RowIndex=e.IndexInView)}}this.CombineCells()}CombineCells(){}CopyFrom(e,t=!1,n=!1,i=!0){e instanceof r.XTextTable&&(this.OwnerDocPanel=e.OwnerDocPanel,super.EleStyle.CopyFrom(e.EleStyle,!1),this.IsShowBorderHideLine=e.IsShowBorderHideLine,this.IsFollowParagraphFlag=e.IsFollowParagraphFlag,this.NumOfColumns=e.NumOfColumns,this.NotifyLayoutChanged(!0,!1),e.NotifyLayoutChanged(!0,!1)),super.CopyFrom(e,t,n,i)}RefreshInnerLines(){if(null!=super.OwnerLine){let e=super.OwnerLine.RealTop,t=super.OwnerLine.RealLeft,n=this.lineList.ToArray();for(let i=0;i<n.length;i++){n[i].RealLeft=super.OwnerLine.RealLeft,n[i].RealTop=e;for(let e of n[i].ChildEleList){let n=e instanceof r.XTextTableCell?e:null;null!=n&&(n.RefreshInnerLines(super.OwnerLine.RealLeft+n.Bounds.X,super.OwnerLine.RealTop+n.OwnerLine.Bounds.Y),t+=n.Column.Width)}e+=n[i].Bounds.Height}}}}t.XTextTableView=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XFractionEle=void 0;const r=n(172),i=n(60),l=n(25),s=n(43),o=n(37),a=n(0),u=n(2),h=n(4);class d extends a.XBaseElement{get EleTypeName(){return"Fraction"}get FractionType(){return i.EmrApiUtil.ConvertStrToFractionType(this.FractionTypeStr)}set FractionType(e){this.FractionTypeStr=i.EmrApiUtil.ConvertFractionTypeToStr(e)}get EleCursorAllowSide(){return u.ENumEleCursorSide.Left}get Numerator(){return this.propList.GetPropValue("Numerator")}set Numerator(e){this.propList.ModifyProperty("Numerator",e,null)}get Denominator(){return this.propList.GetPropValue("Denominator")}set Denominator(e){this.propList.ModifyProperty("Denominator",e,null)}get FractionTypeStr(){return this.propList.GetPropValue("FractionType")}set FractionTypeStr(e){this.propList.ModifyProperty("FractionType",e,null)}ReCalcBaseSize(){if(!this.IsLayoutValid){let e=super.EleStyle;if(null!=e){let t=e.Font;if(null!=t){let e=this.CalcuatorFractionSize(t);this.SetSizeDPI(e.Width,e.Height,96),this.IsLayoutValid=!0}}}}CalcuatorFractionSize(e){let t,n=s.GrapUtil.MeasureStrSize(null,e,0,this.Denominator||"a");if(this.FractionType==r.FractionType.Vert){let r=2*(n.Height+o.TextDocApiConst.FractionEleEmptyHeight)+1;if(h.default.IsNullOrEmpty(this.Numerator)&&h.default.IsNullOrEmpty(this.Denominator))t=new l.SizeF(n.Height+2*o.TextDocApiConst.FractionLeftRightEmptyWidth,r);else{let n=Math.max(this.GetNumeratorWidth(e),this.GetDnominatorWidth(e))+2*o.TextDocApiConst.FractionLeftRightEmptyWidth;t=new l.SizeF(n,r)}}else if(this.FractionType==r.FractionType.Oblique){let r=2*(n.Height+o.TextDocApiConst.FractionEleEmptyHeight);if(h.default.IsNullOrEmpty(this.Numerator)&&h.default.IsNullOrEmpty(this.Denominator)){let e=2*r+2*o.TextDocApiConst.FractionLeftRightEmptyWidth+o.TextDocApiConst.FractionHert_LineWidth;t=new l.SizeF(e,r)}else{let n=this.GetNumeratorWidth(e)+this.GetDnominatorWidth(e)+2*o.TextDocApiConst.FractionLeftRightEmptyWidth+o.TextDocApiConst.FractionHert_LineWidth;t=new l.SizeF(n,r)}}else if(this.FractionType==r.FractionType.Hert){let r=n.Height+o.TextDocApiConst.FractionEleEmptyHeight;if(h.default.IsNullOrEmpty(this.Numerator)&&h.default.IsNullOrEmpty(this.Denominator)){let e=2*r+2*o.TextDocApiConst.FractionLeftRightEmptyWidth+o.TextDocApiConst.FractionHert_LineWidth;t=new l.SizeF(e,r)}else{let n=this.GetNumeratorWidth(e)+this.GetDnominatorWidth(e)+2*o.TextDocApiConst.FractionLeftRightEmptyWidth+o.TextDocApiConst.FractionHert_LineWidth;t=new l.SizeF(n,r)}}else t=l.SizeF.Empty;return t}InitFractionEle(e,t,n){this.FractionType=n,this.Numerator=e,this.Denominator=t,this.NotifyLayoutChanged(!0,!1)}GetNumeratorWidth(e){return s.GrapUtil.MeasureStrSize(null,e,1e3,this.Numerator).Width}GetDnominatorWidth(e){return s.GrapUtil.MeasureStrSize(null,e,1e3,this.Denominator).Width}}t.XFractionEle=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XRulerControl=void 0;const r=n(690),i=n(695),l=n(231),s=n(9),o=n(151),a=n(10);t.XRulerControl=class{constructor(e){this.rulerId="pango-editor-ruler",this.rulerTopId="pango-editor-ruler-top",this.rulerLeftId="pango-editor-ruler-left",this.dashDotDotId="pango-editor-ruler_dashDotDot",this.rulerTopGraphics=null,this.rulerLeftGraphics=null,this.deviation=.99,this.rulerTopCursorOffset=0,this.rulerTopMarginLeft=0,this.rulerDomMarginLeft=0,this.zmRatio=1,this.edtCtrl=e;let t=null,n=null;this.rulerDom.childElementCount>0?(t=this.rulerDom.childNodes[0],n=this.edtCtrl.ContainerDOM.querySelector("#"+this.rulerLeftId)):(t=document.createElement("canvas"),t.setAttribute("id",this.rulerTopId),n=document.createElement("canvas"),n.setAttribute("id",this.rulerLeftId)),this.rulerTopGraphics=new o.Graphics(t),this.rulerLeftGraphics=new o.Graphics(n),this.rulerTopCanvas=t,this.rulerLeftCanvas=n,this._leftRulerRender=new r.XLeftRulerRender,this._topRulerRender=new i.XTopRulerRender,this.UnBindEvtHandler(),this.BindEvtHandler()}get rulerDom(){return this.edtCtrl.ContainerDOM.querySelector("#"+this.rulerId)}get M_topRulerRender(){return this._topRulerRender}BindEvtHandler(){this.rulerLeftCanvas.addEventListener("mousemove",this.rulerLeftMove.bind(this)),this.rulerLeftCanvas.addEventListener("mousedown",this.rulerLeftDown.bind(this)),this.rulerLeftCanvas.addEventListener("mouseup",this.rulerLeftUp.bind(this)),this.rulerLeftCanvas.addEventListener("mouseout",this.rulerLeftUp.bind(this)),this.rulerTopCanvas.addEventListener("mousemove",this.rulerTopMove.bind(this)),this.rulerTopCanvas.addEventListener("mousedown",this.rulerTopDown.bind(this)),this.rulerTopCanvas.addEventListener("mouseup",this.rulerTopUp.bind(this)),this.rulerTopCanvas.addEventListener("mouseout",this.rulerTopUp.bind(this))}UnBindEvtHandler(){this.rulerLeftCanvas.removeEventListener("mousemove",this.rulerLeftMove.bind(this)),this.rulerLeftCanvas.removeEventListener("mousedown",this.rulerLeftDown.bind(this)),this.rulerLeftCanvas.removeEventListener("mouseup",this.rulerLeftUp.bind(this)),this.rulerLeftCanvas.removeEventListener("mouseout",this.rulerLeftUp.bind(this)),this.rulerTopCanvas.removeEventListener("mousemove",this.rulerTopMove.bind(this)),this.rulerTopCanvas.removeEventListener("mousedown",this.rulerTopDown.bind(this)),this.rulerTopCanvas.removeEventListener("mouseup",this.rulerTopUp.bind(this)),this.rulerTopCanvas.removeEventListener("mouseout",this.rulerTopUp.bind(this))}rulerLeftMove(e){if(this.rulerLeftDowning){const t=e.offsetY/this.zmRatio;return this.rulerLeftHeadAct?this._leftRulerRender.HeadHeight=t-this._leftRulerRender.Bound.Y:this.rulerLeftFootAct&&(this._leftRulerRender.FooterHeight=this._leftRulerRender.Bound.Bottom-t),this._leftRulerRender.Render(this.rulerLeftGraphics),void this._PadDashDotDot("Y",this._clientY(e.clientY))}const t=this._leftRulerRender.HeadHeight+this._leftRulerRender.Bound.Y,n=this._leftRulerRender.Bound.Bottom-this._leftRulerRender.FooterHeight,r=t*this.zmRatio,i=n*this.zmRatio;Math.abs(e.offsetY-r)<=this.deviation?(this.rulerLeftHeadAct=!0,this.rulerLeftCanvas.style.cursor="ns-resize",this.rulerLeftDashMin=e.clientY-this._leftRulerRender.HeadHeight+l.XRuleConstDefine.MinPageMargin,this.rulerLeftDashMax=e.clientY-this._leftRulerRender.HeadHeight+this._leftRulerRender.MaxHeadHeight):Math.abs(e.offsetY-i)<=this.deviation?(this.rulerLeftFootAct=!0,this.rulerLeftCanvas.style.cursor="ns-resize",this.rulerLeftDashMin=e.clientY-(this._leftRulerRender.MaxFooterHeight-this._leftRulerRender.FooterHeight),this.rulerLeftDashMax=this.rulerLeftDashMin+(this._leftRulerRender.MaxFooterHeight-l.XRuleConstDefine.MinPageMargin)):(this.rulerLeftHeadAct=!1,this.rulerLeftFootAct=!1,this.rulerLeftCanvas.style.cursor="default")}rulerLeftDown(e){(this.rulerLeftHeadAct||this.rulerLeftFootAct)&&(this.rulerLeftDowning=!0,this._GenDashDotDot(),this._PadDashDotDot("Y",this._clientY(e.clientY)))}rulerLeftUp(e){if(this.rulerLeftDowning){this.rulerLeftDowning=!1,this.dashDotDotDiv.remove();let e=this.edtCtrl.M_DocumentFocused;if(this.rulerLeftHeadAct){let t=this._leftRulerRender.HeadHeight;t=a.DPITransUtil.TransIntVal(t,96,100),e.GetPageFmt().PagePadd.Top=t}else if(this.rulerLeftFootAct){let t=this._leftRulerRender.FooterHeight;t=a.DPITransUtil.TransIntVal(t,96,100),e.GetPageFmt().PagePadd.Bottom=t}this.edtCtrl.MRefreshDocView(),this.edtCtrl.M_EleEvtModel.MoveCaretByCursorEle(!1)}}_clientY(e){let t=e;return t=Math.max(this.rulerLeftDashMin,t),t=Math.min(this.rulerLeftDashMax,t),t}rulerTopMove(e){if(this.rulerTopDowning){const t=e.offsetX/this.zmRatio,n=(e.offsetX-this.offsetX_pre)/this.zmRatio;return this.rulerTopFirstLineAct?(this._topRulerRender.FirstLineIndent+=n,this.offsetX_pre=e.offsetX):this.rulerTopLeftIndentAct?(this._topRulerRender.LeftIndent+=n,this.offsetX_pre=e.offsetX):this.rulerTopPageRightAct?this._topRulerRender.PageRightMargin=this._topRulerRender.Bound.Right-t:this.rulerTopPageLeftAct&&(this._topRulerRender.PageLeftMargin=t-this._topRulerRender.Bound.X),this._topRulerRender.Render(this.rulerTopGraphics),void this._PadDashDotDot("X",this._clientX(e.clientX),e.clientY)}const t=this._topRulerRender.Bound.X+this._topRulerRender.PageLeftMargin+this._topRulerRender.LeftIndent+this._topRulerRender.FirstLineIndent-l.XRuleConstDefine.RulerCursorWidth/2,n=this._topRulerRender.Bound.Y,r=l.XRuleConstDefine.RulerCursorWidth,i=l.XRuleConstDefine.RulerCursorWidth/2+l.XRuleConstDefine.RulerCursorWidth/4,o=this._topRulerRender.Bound.X+this._topRulerRender.PageLeftMargin+this._topRulerRender.LeftIndent-l.XRuleConstDefine.RulerCursorWidth/2,a=this._topRulerRender.Bound.Bottom-i,u=r,h=i,d=new s.RectangleF(t*this.zmRatio,n*this.zmRatio,r*this.zmRatio,i*this.zmRatio),c=new s.RectangleF(o*this.zmRatio,a*this.zmRatio,u*this.zmRatio,h*this.zmRatio),p=this._topRulerRender.Bound.Right-this._topRulerRender.PageRightMargin,f=this._topRulerRender.PageLeftMargin+this._topRulerRender.Bound.X,g=p*this.zmRatio,m=f*this.zmRatio;this.rulerTopCursorOffset=0,d.Contains(e.offsetX,e.offsetY)?(this.rulerTopFirstLineAct=!0,this.rulerTopCanvas.style.cursor="default",this.rulerTopCursorOffset=e.offsetX-(d.X+d.Width/2),this.rulerTopDashMin=e.clientX-this.rulerTopCursorOffset-this._topRulerRender.FirstLineIndent-this._topRulerRender.LeftIndent,this.rulerTopDashMax=this.rulerTopDashMin+this._topRulerRender.MaxFirstLineIndent+this._topRulerRender.LeftIndent):c.Contains(e.offsetX,e.offsetY)?(this.rulerTopLeftIndentAct=!0,this.rulerTopCanvas.style.cursor="default",this.rulerTopCursorOffset=e.offsetX-(c.X+c.Width/2),this.rulerTopDashMin=e.clientX-this.rulerTopCursorOffset-this._topRulerRender.LeftIndent,this._topRulerRender.FirstLineIndent<0&&(this.rulerTopDashMin-=Math.min(0,this._topRulerRender.FirstLineIndent+this._topRulerRender.PageLeftMargin)),this.rulerTopDashMax=this.rulerTopDashMin+this._topRulerRender.MaxLeftIndent):Math.abs(e.offsetX-g)<=this.deviation?(this.rulerTopPageRightAct=!0,this.rulerTopCanvas.style.cursor="ew-resize",this.rulerTopDashMin=e.clientX-(this._topRulerRender.MaxPageRightMargin-this._topRulerRender.PageRightMargin),this.rulerTopDashMax=this.rulerTopDashMin+(this._topRulerRender.MaxPageRightMargin-l.XRuleConstDefine.MinPageMargin)):Math.abs(e.offsetX-m)<=this.deviation?(this.rulerTopPageLeftAct=!0,this.rulerTopCanvas.style.cursor="ew-resize",this.rulerTopDashMin=e.clientX-this._topRulerRender.PageLeftMargin+l.XRuleConstDefine.MinPageMargin,this.rulerTopDashMax=e.clientX-this._topRulerRender.PageLeftMargin+this._topRulerRender.MaxPageLeftMargin):(this.rulerTopPageLeftAct=!1,this.rulerTopPageRightAct=!1,this.rulerTopFirstLineAct=!1,this.rulerTopLeftIndentAct=!1,this.rulerTopCanvas.style.cursor="default")}rulerTopDown(e){(this.rulerTopPageLeftAct||this.rulerTopPageRightAct||this.rulerTopFirstLineAct||this.rulerTopLeftIndentAct)&&(this.rulerTopDowning=!0,this.offsetX_pre=e.offsetX,this._GenDashDotDot(),this._PadDashDotDot("X",this._clientX(e.clientX),e.clientY))}rulerTopUp(e){if(this.rulerTopDowning){this.rulerTopDowning=!1,this.dashDotDotDiv.remove();let e=this.edtCtrl.M_DocumentFocused,t=this.edtCtrl.M_LineFocused;if(this.rulerTopFirstLineAct){let e=this._topRulerRender.FirstLineIndent;e=a.DPITransUtil.TransFloatVal(e,96,300),t.RelEleParagraphStyle.FirstLineIndent=e}else if(this.rulerTopLeftIndentAct){let e=this._topRulerRender.LeftIndent;e=a.DPITransUtil.TransFloatVal(e,96,300),t.RelEleParagraphStyle.LeftIndent=e}else if(this.rulerTopPageRightAct){let t=this._topRulerRender.PageRightMargin;t=a.DPITransUtil.TransIntVal(t,96,100),e.GetPageFmt().PagePadd.Right=t}else if(this.rulerTopPageLeftAct){let t=this._topRulerRender.PageLeftMargin;t=a.DPITransUtil.TransIntVal(t,96,100),e.GetPageFmt().PagePadd.Left=t}t.RelEleParagraph.Parent.IsLayoutValid=!1,this.edtCtrl.MRefreshDocView(),this.edtCtrl.M_EleEvtModel.MoveCaretByCursorEle(!1)}}_clientX(e){let t=e-this.rulerTopCursorOffset*this.zmRatio;return t=Math.max(this.rulerTopDashMin,t),t=Math.min(this.rulerTopDashMax,t),t}_GenDashDotDot(){let e=null;this.edtCtrl.ContainerDOM.querySelector("#"+this.dashDotDotId)?e=this.edtCtrl.ContainerDOM.querySelector("#"+this.dashDotDotId):(e=document.createElement("div"),e.setAttribute("id",this.dashDotDotId),e.style.position="fixed",e.style.zIndex="1",this.rulerDom.appendChild(e)),this.dashDotDotDiv=e}_PadDashDotDot(e,t,n=0){"X"==e?(this.dashDotDotDiv.style.bottom="0px",this.dashDotDotDiv.style.top=n+"px",this.dashDotDotDiv.style.left=t+"px",this.dashDotDotDiv.style.borderLeft="1px dashed #646464"):"Y"==e&&(this.dashDotDotDiv.style.left="0px",this.dashDotDotDiv.style.right="0px",this.dashDotDotDiv.style.top=t+"px",this.dashDotDotDiv.style.borderTop="1px dashed #646464")}HideRuler(){this.edtCtrl.ContainerDOM.querySelector("#"+this.rulerTopId).remove(),this.edtCtrl.ContainerDOM.querySelector("#"+this.rulerLeftId).remove(),this._topRuleVisible=!1,this._leftRuleVisible=!1}ShowRuler(){this._topRuleVisible=!0,this._leftRuleVisible=!0}IsShowingRule(){return this._topRuleVisible&&this._leftRuleVisible}SetTopRuler(e,t,n,r,i,o){this._topRulerRender.PageLeftMargin=n,this._topRulerRender.PageRightMargin=r,this._topRulerRender.FirstLineIndent=i,this._topRulerRender.LeftIndent=o,this._topRulerRender.Bound=new s.RectangleF(e,0,t,l.XRuleConstDefine.TopRulerViewHeight),this._topRuleVisible&&(this._topRulerRender.Render(this.rulerTopGraphics),this.rulerDom.appendChild(this.rulerTopCanvas))}SetTopRulerWidth(e,t,n){this.rulerTopGraphics.Resize(e,l.XRuleConstDefine.TopRulerViewHeight*this.zmRatio),this.rulerDom.style.width=t>0?t+"px":"auto",this.rulerTopMarginLeft=n*e,this.rulerTopCanvas.style.marginLeft=this.rulerTopMarginLeft+"px"}SetLeftRuler(e,t,n,r,i){this._leftRulerRender.HeadHeight=n,this._leftRulerRender.FooterHeight=r,this._leftRulerRender.Bound=new s.RectangleF(0,e/this.zmRatio,l.XRuleConstDefine.LeftRulerViewWidth,t),this._leftRuleVisible&&(this._leftRulerRender.Render(this.rulerLeftGraphics),null==i&&(i=this.rulerDom),i.appendChild(this.rulerLeftCanvas))}SetLeftRulerHeight(e,t){e=e-8+8*this.zmRatio,this.rulerLeftGraphics.Resize(l.XRuleConstDefine.LeftRulerViewWidth*this.zmRatio,e),this.rulerLeftCanvas.style.top=t*e+"px"}SetScale(e){this.zmRatio=e,this._topRulerRender.M_SetScale(e,e),this._leftRulerRender.M_SetScale(e,e);const t=this._leftRuleVisible?Math.ceil(l.XRuleConstDefine.LeftRulerViewWidth*e):28;this.edtCtrl.dom.style.padding="0 "+t+"px";const n=this.edtCtrl.EditorWidth?this.edtCtrl.EditorWidth:this.edtCtrl.dom.clientWidth;let r;this.edtCtrl.PageContainerDom.clientWidth>n-2*t?(this.rulerDomMarginLeft=t,r=t+"px",this.edtCtrl.dom.style.paddingRight="0px"):(this.rulerDomMarginLeft=0,r="auto"),this.edtCtrl.AlwaysCenter&&(r="auto"),this.edtCtrl.PageContainerDom.style.left=r,this.rulerDom.style.marginLeft=r,this.rulerTopCanvas.style.marginLeft=this.rulerTopMarginLeft+"px"}OnScrollValChanged(e){const t=this.rulerDomMarginLeft-e;t>0?(this.rulerDom.style.marginLeft=t+"px",this.rulerTopCanvas.style.marginLeft=this.rulerTopMarginLeft+"px"):t<0?(this.rulerDom.style.marginLeft="0px",this.rulerTopCanvas.style.marginLeft=this.rulerTopMarginLeft+t+"px"):(this.rulerDom.style.marginLeft="auto",this.rulerTopCanvas.style.marginLeft=this.rulerTopMarginLeft+"px")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XLeftRulerRender=void 0;const r=n(53),i=n(67),l=n(231),s=n(56),o=n(90),a=n(691),u=n(9),h=n(17),d=n(340),c=n(25);t.XLeftRulerRender=class{constructor(){this.minConHeight=4*l.XRuleConstDefine.PageMarginSpace,this.headHeight=76,this.footerHeight=76,this._linePen=new i.Pen(l.XRuleConstDefine.ScaleLineColor),this._ruleBackBrush=new r.SolidBrush(l.XRuleConstDefine.RuleBackColor),this._textFont=l.XRuleConstDefine.ScaleTextFont,this._textBrush=new r.SolidBrush(l.XRuleConstDefine.ScaleTextColor),this._inValidRectBrush=new r.SolidBrush(l.XRuleConstDefine.InValidBackColor),this._rightFormat=new s.StringFormat(null),this._rightFormat.Alignment=o.StringAlignment.Center,this._rightFormat.LineAlignment=o.StringAlignment.Center,this._headerToolTip=new a.XToolTipManager("上边距"),this._footerToolTip=new a.XToolTipManager("下边距"),this._scaleX=1,this._scaleY=1}get Bound(){return this.bound}set Bound(e){this.bound=e,this.LocationChanged()}Render(e){e.scale(this._scaleX,this._scaleY),e.Flush(),this.DrawRule(e)}DrawRule(e){e.FillRectangle(this._ruleBackBrush,this._ruleRect),e.FillRectangle(this._inValidRectBrush,this._headRect),e.FillRectangle(this._inValidRectBrush,this._footRect),e.DrawLine(this._linePen,new h.PointF(this._ruleRect.Left,this._ruleRect.Top),new h.PointF(this._ruleRect.Left,this._ruleRect.Bottom)),e.DrawLine(this._linePen,new h.PointF(this._ruleRect.Right,this._ruleRect.Top),new h.PointF(this._ruleRect.Right,this._ruleRect.Bottom));let t=d.NumUtil.ConvertPxToCm(this._ruleRect.Height,l.XRuleConstDefine.BaseDpi);for(let n=0;n<=Math.ceil(t);n++)for(let r=1;r<=5;r++){if(0==n&&5!=r)continue;let i=n-1+.2*r;if(i>t)break;let s=l.XRuleConstDefine.SmallScaleHeight;5==r?s=l.XRuleConstDefine.BigScaleHeight:3==r&&(s=l.XRuleConstDefine.CenterSacleHeight);let o=this._ruleRect.Top+d.NumUtil.ConverCmToPx(i,l.XRuleConstDefine.BaseDpi),a=new h.PointF(this._ruleRect.Right,o),p=new h.PointF(this._ruleRect.Right-s,o);if(e.DrawLine(this._linePen,a,p),5==r){const t=c.SizeF.Empty,r=this._ruleRect.X+(this._ruleRect.Width-l.XRuleConstDefine.BigScaleHeight)/2;let i,s=new u.RectangleF(r,o-t.Height/2,t.Width,t.Height);i=this._rightFormat,e.DrawString(n.toString(),this._textFont,this._textBrush,s,i)}}}LocationChanged(){if(this.bound instanceof u.RectangleF){const e=(this.bound.Width-l.XRuleConstDefine.RulerWidth)/2-1;this._ruleRect=new u.RectangleF(this.bound.X+e,this.bound.Y,l.XRuleConstDefine.RulerWidth,this.bound.Height),this._headRect=new u.RectangleF(this._ruleRect.X,this._ruleRect.Y,this._ruleRect.Width,this.headHeight),this._footRect=new u.RectangleF(this._ruleRect.X,this._ruleRect.Bottom-this.FooterHeight,this._ruleRect.Width,this.FooterHeight),this.maxHeadHeight=this._footRect.Y-this._ruleRect.Y-this.minConHeight,this.maxFooterHeight=this._ruleRect.Height-this._headRect.Height-this.minConHeight}}get MaxHeadHeight(){return this.maxHeadHeight}get HeadHeight(){return this.headHeight}set HeadHeight(e){let t=e;null!=this.maxHeadHeight&&(t=Math.min(this.maxHeadHeight,t)),this.headHeight=Math.max(l.XRuleConstDefine.MinPageMargin,t),this.LocationChanged()}get MaxFooterHeight(){return this.maxFooterHeight}get FooterHeight(){return this.footerHeight}set FooterHeight(e){let t=e;null!=this.maxFooterHeight&&(t=Math.min(this.maxFooterHeight,t)),this.footerHeight=Math.max(l.XRuleConstDefine.MinPageMargin,t),this.LocationChanged()}M_SetScale(e,t){this._scaleX=e,this._scaleY=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XToolTipManager=void 0;const r=n(338),i=n(4);t.XToolTipManager=class{constructor(e){this._toolTip=new r.XToolTipRender,this._defaultToolTip=e}IsShowingToolTip(){return this._toolTip.IsShowing}HideTooltip(){this._toolTip.Hide()}ShowCurrentTooltip(e="",t){i.default.IsNullOrEmpty(e)&&(e=this._defaultToolTip),this._toolTip.IsShowing}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToolTipIcon=void 0,function(e){e[e.None=0]="None",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(t.ToolTipIcon||(t.ToolTipIcon={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tooltip=void 0;const r=n(694),i=n(27);class l extends i.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new r.TooltipComp(t,this.InitProps)}show(){this.Component.React.show()}hide(){this.Component.React.hide()}DefaultProps(){return{text:"",top:0,left:0}}}t.Tooltip=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TooltipComp=void 0;const r=n(12),i=n(24),l=n(22),s=n(74);class o extends r.Component{constructor(e){super(e),this.state={isShow:!1},this.state={isRender:!0}}componentDidMount(){this.props.parent.React=this}show(){this.setState({isRender:!0})}hide(){this.setState({isRender:!1})}isShow(){return this.state.isRender}render(){let{top:e,left:t,text:n}=this.props,{isRender:i}=this.state;return i?r.createElement(s.default,{top:e,left:t,showOkBtn:!1,showCancelBtn:!1,isShow:!0},r.createElement("div",{style:{padding:"4px"},dangerouslySetInnerHTML:{__html:n}})):null}}class a extends l.BaseComponent{constructor(e,t){super(e,t)}show(){this.React.show()}hide(){this.React.hide()}Render(){i.render(r.createElement(o,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.TooltipComp=a,t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTopRulerRender=void 0;const r=n(53),i=n(7),l=n(67),s=n(231),o=n(56),a=n(90),u=n(9),h=n(17),d=n(340),c=n(25),p=n(118);t.XTopRulerRender=class{constructor(){this.minConHeight=2*s.XRuleConstDefine.PageMarginSpace,this.pageLeftMargin=76,this.pageRightMargin=76,this.firstLineIndent=0,this.leftIndent=0,this._linePen=new l.Pen(s.XRuleConstDefine.ScaleLineColor),this._ruleBackBrush=new r.SolidBrush(s.XRuleConstDefine.RuleBackColor),this._textFont=s.XRuleConstDefine.ScaleTextFont,this._invalidAreaBrush=new r.SolidBrush(s.XRuleConstDefine.InValidBackColor),this._centerFormat=new o.StringFormat(null),this._centerFormat.Alignment=a.StringAlignment.Center,this._centerFormat.LineAlignment=a.StringAlignment.Center,this._textBrush=new r.SolidBrush(s.XRuleConstDefine.ScaleTextColor),this._ruleCursorDrawPen=new l.Pen(new i.Color("#909090")),this._ruleCursorPathFillBrush=new r.SolidBrush(new i.Color("#ffffff")),this._scaleX=1,this._scaleY=1}get Bound(){return this.bound}set Bound(e){this.bound=e,this.LocationChanged()}Render(e){e.scale(this._scaleX,this._scaleY),e.Flush(),this.DrawRule(e),this.DrawRuleCursor(e)}DrawRule(e){e.FillRectangle(this._ruleBackBrush,this._ruleRect),e.FillRectangle(this._invalidAreaBrush,this._leftMarginRect),e.FillRectangle(this._invalidAreaBrush,this._rightMarginRect),e.DrawLine(this._linePen,new h.PointF(this._ruleRect.Left,this._ruleRect.Top),new h.PointF(this._ruleRect.Right,this._ruleRect.Top)),e.DrawLine(this._linePen,new h.PointF(this._ruleRect.Left,this._ruleRect.Bottom),new h.PointF(this._ruleRect.Right,this._ruleRect.Bottom));let t=d.NumUtil.ConvertPxToCm(this.bound.Width,s.XRuleConstDefine.BaseDpi);for(let n=0;n<=Math.floor(t);n++)for(let t=1;t<=5;t++){if(0==n&&5!=t)continue;let r=s.XRuleConstDefine.SmallScaleHeight,i=n-1+.2*t;5==t?r=s.XRuleConstDefine.BigScaleHeight:3==t&&(r=s.XRuleConstDefine.CenterSacleHeight);let l=this._ruleRect.X+d.NumUtil.ConverCmToPx(i,s.XRuleConstDefine.BaseDpi),p=new h.PointF(l,this._ruleRect.Bottom-r),f=new h.PointF(l,this._ruleRect.Bottom);if(e.DrawLine(this._linePen,p,f),5==t){let t,r=c.SizeF.Empty,i=new u.RectangleF(l-r.Width/2,this._ruleRect.Y,r.Width,this._ruleRect.Height);0==n?(t=new o.StringFormat(null),t.Alignment=a.StringAlignment.Near,t.LineAlignment=a.StringAlignment.Center):t=this._centerFormat,e.DrawString(n.toString(),this._textFont,this._textBrush,i,t)}}}DrawRuleCursor(e){e.SmoothingMode=p.SmoothingMode.HighQuality,this.RefreshRuleCursorPath(),e.DrawPolygon(this._topCursorPoints,this._ruleCursorPathFillBrush,this._ruleCursorDrawPen),e.DrawPolygon(this._bottomCursorPoints,this._ruleCursorPathFillBrush,this._ruleCursorDrawPen)}RefreshRuleCursorPath(){let e=this.bound.X+this._topRuleCursorPreX,t=[new h.PointF(e,this._ruleRect.Top-6),new h.PointF(e+s.XRuleConstDefine.RulerCursorWidth,this._ruleRect.Top-6),new h.PointF(e+s.XRuleConstDefine.RulerCursorWidth,this._ruleRect.Top),new h.PointF(e+s.XRuleConstDefine.RulerCursorWidth/2,this._ruleRect.Top+6),new h.PointF(e,this._ruleRect.Top)];this._topCursorPoints=t;let n=this.bound.X+this._bottomRuleCursorPreX,r=[new h.PointF(n,this._ruleRect.Bottom+2),new h.PointF(n,this._ruleRect.Bottom-2),new h.PointF(n+s.XRuleConstDefine.RulerCursorWidth/2,this._ruleRect.Bottom-6),new h.PointF(n+s.XRuleConstDefine.RulerCursorWidth,this._ruleRect.Bottom-2),new h.PointF(n+s.XRuleConstDefine.RulerCursorWidth,this._ruleRect.Bottom+2),new h.PointF(n,this._ruleRect.Bottom+2),new h.PointF(n,this._ruleRect.Bottom+6),new h.PointF(n+s.XRuleConstDefine.RulerCursorWidth,this._ruleRect.Bottom+6),new h.PointF(n+s.XRuleConstDefine.RulerCursorWidth,this._ruleRect.Bottom+2)];this._bottomCursorPoints=r}LocationChanged(){this.bound instanceof u.RectangleF&&(this._ruleRect=new u.RectangleF(this.bound.X,this.bound.Y+6,this.bound.Width,s.XRuleConstDefine.RulerWidth),this._leftMarginRect=new u.RectangleF(this._ruleRect.X,this._ruleRect.Y,this.pageLeftMargin,this._ruleRect.Height),this._rightMarginRect=new u.RectangleF(this._ruleRect.X+this._ruleRect.Width-this.pageRightMargin,this._ruleRect.Y,this.pageRightMargin,this._ruleRect.Height),this._topRuleCursorPreX=this.pageLeftMargin+this.leftIndent+this.firstLineIndent,this._topRuleCursorPreX>0&&(this._topRuleCursorPreX-=s.XRuleConstDefine.RulerCursorWidth/2),this._bottomRuleCursorPreX=this.pageLeftMargin+this.leftIndent,this._bottomRuleCursorPreX>0&&(this._bottomRuleCursorPreX-=s.XRuleConstDefine.RulerCursorWidth/2),this.maxFirstLineIndent=this._ruleRect.Width-this._rightMarginRect.Width-this._leftMarginRect.Width-this.leftIndent-this.minConHeight,this.maxLeftIndent=this._ruleRect.Width-this._rightMarginRect.Width-this._leftMarginRect.Width-this.firstLineIndent-this.minConHeight,this.maxPageLeftMargin=this._ruleRect.Width-this._rightMarginRect.Width-this.firstLineIndent-this.leftIndent-this.minConHeight,this.maxPageRightMargin=this._ruleRect.Width-this._leftMarginRect.Width-this.firstLineIndent-this.leftIndent-this.minConHeight)}get MaxPageLeftMargin(){return this.maxPageLeftMargin}get PageLeftMargin(){return this.pageLeftMargin}set PageLeftMargin(e){let t=e;null!=this.maxPageLeftMargin&&(t=Math.min(this.maxPageLeftMargin,t)),this.pageLeftMargin=Math.max(s.XRuleConstDefine.MinPageMargin,t),this.LocationChanged()}get MaxPageRightMargin(){return this.maxPageRightMargin}get PageRightMargin(){return this.pageRightMargin}set PageRightMargin(e){let t=e;null!=this.maxPageRightMargin&&(t=Math.min(this.maxPageRightMargin,t)),this.pageRightMargin=Math.max(s.XRuleConstDefine.MinPageMargin,t),this.LocationChanged()}get minFirstLineIndent(){if(this.leftIndent<0){const e=this.pageLeftMargin-Math.abs(this.leftIndent);return e>=0?-1*e:e||0}if(this.leftIndent>=0){return-1*(Math.abs(this.pageLeftMargin)+Math.abs(this.leftIndent))}return 0}get MinFirstLineIndent(){return this.minFirstLineIndent}get MaxFirstLineIndent(){return this.maxFirstLineIndent}get FirstLineIndent(){return this.firstLineIndent}set FirstLineIndent(e){let t=e;null!=this.maxFirstLineIndent&&(t=Math.min(this.maxFirstLineIndent,t)),this.firstLineIndent=Math.max(this.minFirstLineIndent,t),this.LocationChanged()}get minLeftIndent(){if(this.firstLineIndent<0){const e=this.pageLeftMargin-Math.abs(this.firstLineIndent);return e>=0?-1*e:e||0}return this.pageLeftMargin>=0?-1*this.pageLeftMargin:this.pageLeftMargin||0}get MinLeftIndent(){return this.minLeftIndent}get MaxLeftIndent(){return this.maxLeftIndent}get LeftIndent(){return this.leftIndent}set LeftIndent(e){let t=e;null!=this.maxLeftIndent&&(t=Math.min(this.maxLeftIndent,t)),this.leftIndent=Math.max(this.minLeftIndent,t),this.LocationChanged()}M_SetScale(e,t){this._scaleX=e,this._scaleY=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Type=void 0;t.Type=class{constructor(e){this._type_name=e}IsAssignableFrom(e){return this._type_name==e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlagPainter=void 0;const r=n(26),i=n(2),l=n(342),s=n(7),o=n(17),a=n(343);class u{static Chk_TraceTp(e){let t,n=e.DeleterIndex;return n>=0?t=i.ENumEdtType.Delete:(n=e.CreatorIndex,t=n>=0?i.ENumEdtType.Add:i.ENumEdtType.Other),t}static Paint_AddTraceFlag(e,t,n,r){u._Paint_TraceFlag(!0,e,t,n,r)}static Paint_DelTraceFlag(e,t,n,r){u._Paint_TraceFlag(!1,e,t,n,r)}static _Paint_TraceFlag(e,t,n,r,i){let s=t.EleStyle,h=e?s.CreatorIndex:s.DeleterIndex,d=u._Get_TraceStyle_(t.Document,h);const c=this.CustomTraceStyle();null==d&&(d=new l.TraceStyle);let p=null!=d?d.DeleteLineColor:null;null!=c&&(p=c.DeleteLineColor);const f=null!=d?d.DeleteLineNum:null;let g,m,E=r.Width,C=r.Color,A=1;if(r.Width=1,e){let e;e=d.UnderLineColor,null!=c&&(e=c.UnderLineColor),r.Color=e,g=d.UnderLineNum,A+=1,m=i.Bottom}else r.Color=p||this.DeleteLineColor,g=f||this.DeleteLineNum,A+=2,m=i.Y+(i.Height-(g-1)*A+1)/2;a.PainterUtil.GetInstance().DrawWaveLine(n,t,r,new o.PointF(i.Left,m),new o.PointF(i.Right,m+4)),r.Width=E,r.Color=C}static CustomTraceStyle(){let e;if(!r.TextDocInitInfo.GetInstance().InputFiled_IsDoctorEditorMode){e=new l.TraceStyle;const t=r.TextDocInitInfo.GetInstance().TraceAddLineColor,n=r.TextDocInitInfo.GetInstance().TraceDeleteLineColor;null!=t&&(e.UnderLineColor=t),null!=n&&(e.DeleteLineColor=n)}return e}static _Get_TraceStyle_(e,t){const n=e.GetUserHistoryList().FindBySerno(t);if(null==n)return null;if(null==n.UserInfo)return null;const r=n.UserInfo.PermissionLv,i=e.GetDebugOpts();if(null==i)return new l.TraceStyle;const s=i.OwnerInfo;if(null==s)return new l.TraceStyle;const o=s.PermissionLv,a=e.GetSecurityOpts();if(null==a)return new l.TraceStyle;return a.saveTrackStyle(r,o)}}t.TraceFlagPainter=u,u.DeleteLineColor=s.Color.Red,u.DeleteLineNum=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleAttrUndo=void 0;const r=n(23),i=n(36);class l extends r.IXUndoable{constructor(e,t,n,r,i){super(),this._nowEle=e,this._attrName=t,this._oldAttrValue=n,this._newAttrValue=r,this._dftValue=i}IsValid(){return null!=this._nowEle&&!i.StringUtils.IsNullOrEmpty(this._attrName)}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){this._nowEle.M_SetAttribute(this._attrName,this._oldAttrValue,this._dftValue),this._nowEle.NotifyLayoutChanged(!0,!0)}Redo(){this._nowEle.M_SetAttribute(this._attrName,this._newAttrValue,this._dftValue),this._nowEle.NotifyLayoutChanged(!0,!0)}Clear(){this._attrName=""}}t.EleAttrUndo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalcEngine=void 0;const r=n(93),i=n(3),l=n(700),s=n(701),o=n(119),a=n(702),u=n(703),h=n(704),d=n(705),c=n(706),p=n(707),f=n(708);t.CalcEngine=class{constructor(){this._decimal=".",this._listSep=",",this._tkTbl=this.GetSymbolTable(),this._fnTbl=this.GetFunctionTable(),this._vars=new i.Dictionary}FalseGetToken(){let e=Math.floor(this._ptr);this.GetToken(),this._ptr=e}Parse(e){this._expr=e,this._len=this._expr.length,this._ptr=0,this._len>0&&"="==this._expr[0]&&this._ptr++;let t=this.ParseExpression();for(this.FalseGetToken();this._token.ID!=o.TKID.END;)t.Evaluate(),t=this.ParseExpression(),this.FalseGetToken();if(this._token.ID!=o.TKID.END)throw"_token.ID != TKID.END";return this._optimize&&null!=t&&(t=t.Optimize()),t}Evaluate(e){return null}get CacheExpressions(){return null!=this._cache}set CacheExpressions(e){e!=this.CacheExpressions&&(this._cache=e?new s.ExpressionCache(this):null)}get OptimizeExpressions(){return this._optimize}set OptimizeExpressions(e){this._optimize=e}get IdentifierChars(){return this._idChars}set IdentifierChars(e){this._idChars=e}RegisterFunction(e,t,n,r){const i=new l.FunctionDefinition(t,n,r);this._fnTbl.Add(e,i)}GetExternalObject(e){return null}get DataContext(){return this._dataContext}set DataContext(e){this._dataContext=e}GetSymbolTable(){return null==this._tkTbl&&(this._tkTbl=new i.Dictionary,this.AddToken("+",o.TKID.ADD,o.TKTYPE.ADDSUB),this.AddToken("-",o.TKID.SUB,o.TKTYPE.ADDSUB),this.AddToken("(",o.TKID.OPEN,o.TKTYPE.GROUP),this.AddToken(")",o.TKID.CLOSE,o.TKTYPE.GROUP),this.AddToken("*",o.TKID.MUL,o.TKTYPE.MULDIV),this.AddToken(".",o.TKID.PERIOD,o.TKTYPE.GROUP),this.AddToken("/",o.TKID.DIV,o.TKTYPE.MULDIV),this.AddToken("\\",o.TKID.DIVINT,o.TKTYPE.MULDIV),this.AddToken("=",o.TKID.EQ,o.TKTYPE.COMPARE),this.AddToken(">",o.TKID.GT,o.TKTYPE.COMPARE),this.AddToken("<",o.TKID.LT,o.TKTYPE.COMPARE),this.AddToken("^",o.TKID.POWER,o.TKTYPE.POWER),this.AddToken("<>",o.TKID.NE,o.TKTYPE.COMPARE),this.AddToken(">=",o.TKID.GE,o.TKTYPE.COMPARE),this.AddToken("<=",o.TKID.LE,o.TKTYPE.COMPARE),this.AddToken(":",o.TKID.ASSIGN,o.TKTYPE.ASSIGN),this.AddToken(":=",o.TKID.ASSIGN,o.TKTYPE.ASSIGN),this.AddToken(";",o.TKID.SEMI,o.TKTYPE.SEMI)),this._tkTbl}AddToken(e,t,n){const r=new o.Token(e,t,n);this._tkTbl.Add(e,r)}GetFunctionTable(){return null==this._fnTbl&&(this._fnTbl=new i.Dictionary),this._fnTbl}ParseExpression(){return this.GetToken(),this.ParseAssign()}ParseAssign(){for(var e=this.ParseCompare();this._token.Type==o.TKTYPE.ASSIGN;){var t=this._token;this.GetToken();var n=this.ParseCompare();e=new c.AssignExpression(t,e,n,this)}return e}ParseCompare(){let e=this.ParseAddSub();for(;this._token.Type==o.TKTYPE.COMPARE;){const t=this._token;this.GetToken();const n=this.ParseAddSub();e=new p.BinaryExpression(t,e,n)}return e}ParseAddSub(){for(var e=this.ParseMulDiv();this._token.Type==o.TKTYPE.ADDSUB;){var t=this._token;this.GetToken();var n=this.ParseMulDiv();e=new p.BinaryExpression(t,e,n)}return e}ParseMulDiv(){for(var e=this.ParsePower();this._token.Type==o.TKTYPE.MULDIV;){var t=this._token;this.GetToken();var n=this.ParsePower();e=new p.BinaryExpression(t,e,n)}return e}ParsePower(){for(var e=this.ParseUnary();this._token.Type==o.TKTYPE.POWER;){var t=this._token;this.GetToken();var n=this.ParseUnary();e=new p.BinaryExpression(t,e,n)}return e}ParseUnary(){const e=this._token.ID,t=e==o.TKID.ADD,n=e==o.TKID.SUB;if(t||n){var r=this._token;this.GetToken();var i=this.ParseAtom();return new f.UnaryExpression(r,i)}return this.ParseAtom()}ParseAtom(){let e,t=null,n=null;switch(this._token.Type){case o.TKTYPE.LITERAL:t=new r.Expression(this._token);break;case o.TKTYPE.SEMI:break;case o.TKTYPE.IDENTIFIER:if(e=this._token.Value.toString(),this._token.ID==o.TKID.VAR){t=new r.Expression(this._token);break}const p=this._fnTbl.TryGetValue(e);if(n=p[1],p[0]){var l=this.GetParameters(),s=null==l?0:l.Count();if(-1!=n.ParmMin&&s<n.ParmMin)throw"Too few parameters.";if(-1!=n.ParmMax&&s>n.ParmMax)throw"Too many parameters.";t=new a.FunctionExpression(n,l);break}if(this._vars.ContainsKey(e)){t=new u.VariableExpression(this._vars,e);break}var c=this.GetExternalObject(e);if(null!=c){t=new h.XObjectExpression(c);break}if(null!=this.DataContext){let e=new i.List;for(let t=this._token;null!=t;t=this.GetMember()){const n=t.Value.toString(),r=this.GetParameters(),i=new d.BindingInfo(n,r);e.Add(i)}t=new d.BindingExpression(this,e);break}throw"不正确的标识符";case o.TKTYPE.GROUP:let f=this._token.ID;if(f!=o.TKID.OPEN)throw"无效的表达式，必须小括号开始!";if(this.GetToken(),t=this.ParseCompare(),f=this._token.ID,f!=o.TKID.CLOSE)throw"无效的表达式，必须小括号结束!"}if(null==t)throw"表达式分析失败，没有解析到结果！";return this.GetToken(),t}GetToken(){for(;this._ptr<this._len&&this._expr[this._ptr]<=" ";)this._ptr++;if(this._ptr>=this._len)return void(this._token=new o.Token(null,o.TKID.END,o.TKTYPE.GROUP));let e,t=!1,n=this._expr[this._ptr],r=n>="a"&&n<="z"||n>="A"&&n<="Z";if("0"==this._expr[this._ptr].toString()&&0==this._ptr?1==this._len?t=!0:"."!=this._expr[1].toString()&&"-"!=this._expr[1].toString()&&"+"!=this._expr[1].toString()&&"*"!=this._expr[1].toString()&&"/"!=this._expr[1].toString()||(t=!0):n>="0"&&n<="9"&&(t=!0),!r&&!t){var i=this._ptr+1<this._len?this._expr[this._ptr+1]:0;if(!(n==this._decimal&&i>="0"&&i<="9")){if(n==this._listSep)return this._token=new o.Token(n,o.TKID.COMMA,o.TKTYPE.GROUP),void this._ptr++;let e;const t=this._tkTbl.TryGetValue(n);if(e=t[1],t[0]){if(this._token=e,this._ptr++,this._ptr<this._len&&(">"==n||"<"==n||":"==n)){const t=this._tkTbl.TryGetValue(this._expr.substring(this._ptr-1,2));e=t[1],t[0]&&(this._token=e,this._ptr++)}return}}}if(t||n==this._decimal){let t=!1,r=!1,i=-1,l=0;for(e=0;e+this._ptr<this._len;e++)if(n=this._expr[this._ptr+e],n>="0"&&n<="9")l=10*l+Number(n),i>-1&&(i*=10);else if(n==this._decimal&&i<0)i=1;else{if("E"!=n&&"e"!=n||t){if(n==this._percent){r=!0,e++;break}break}t=!0,n=this._expr[this._ptr+e+1],"+"!=n&&"-"!=n||e++}if(t)this._expr.substring(this._ptr,e);else i>1&&(l/=i),r&&(l/=100);return this._token=new o.Token(l.toString(),o.TKID.ATOM,o.TKTYPE.LITERAL),void(this._ptr+=e)}if('"'==n){for(e=1;e+this._ptr<this._len;e++){if(n=this._expr[this._ptr+e],'"'!=n)continue;if('"'!=(e+this._ptr<this._len-1?this._expr[this._ptr+e+1]:" "))break;e++}if('"'!=n)throw"Can't find final quote.";const t=this._ptr+e,r=this._expr.substring(this._ptr+1,t);return this._ptr+=e+1,void(this._token=new o.Token(r.replace('""','"'),o.TKID.ATOM,o.TKTYPE.LITERAL))}if("#"==n){for(e=1;e+this._ptr<this._len&&(n=this._expr[this._ptr+e],"#"!=n);e++);if("#"!=n)throw"Can't find final date delimiter ('#').";const t=this._ptr+e,r=this._expr.substring(this._ptr+1,t);return this._ptr+=e+1,void(this._token=new o.Token(new Date(r).getTime().toString(),o.TKID.ATOM,o.TKTYPE.LITERAL))}if(!r&&"_"!=n&&(null==this._idChars||this._idChars.indexOf(n)<0))throw"Identifier expected.";for(e=1;e+this._ptr<this._len&&(n=this._expr[this._ptr+e],r=n>="a"&&n<="z"||n>="A"&&n<="Z",t=n>="0"&&n<="9",r||t||"_"==n||!(null==this._idChars||this._idChars.indexOf(n)<0));e++);const l=this._ptr+e,s=this._expr.substring(this._ptr,l);this._ptr+=e;let a=this._ptr;for(;a<this._len&&this._expr[a]<=" ";)a++;this._expr.length>1&&":"==this._expr[a]&&"="==this._expr[a+1]?this._token=new o.Token(s,o.TKID.VAR,o.TKTYPE.IDENTIFIER):this._token=new o.Token(s,o.TKID.ATOM,o.TKTYPE.IDENTIFIER)}GetParameters(){let e=this._ptr;const t=this._token;this.GetToken();let n=this._token.ID;if(n!=o.TKID.OPEN)return this._ptr=e,this._token=t,null;if(e=this._ptr,this.GetToken(),n=this._token.ID,n==o.TKID.CLOSE)return null;this._ptr=e;var r=new i.List,l=this.ParseExpression();for(r.Add(l);this._token.ID==o.TKID.COMMA;)l=this.ParseExpression(),r.Add(l);if(n=this._token.ID,n!=o.TKID.CLOSE)throw"this._token.ID != TKID.CLOSE";return r}GetMember(){var e=this._ptr,t=this._token;if(this.GetToken(),this._token.ID!=o.TKID.PERIOD)return this._ptr=e,this._token=t,null;if(this.GetToken(),this._token.Type!=o.TKTYPE.IDENTIFIER)throw"Identifier expected";return this._token}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDefinition=void 0;t.FunctionDefinition=class{constructor(e,t,n){this.ParmMin=e,this.ParmMax=t,this.Function=n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionCache=void 0;t.ExpressionCache=class{constructor(e){this._ce=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionExpression=void 0;const r=n(93),i=n(119);class l extends r.Expression{constructor(e,t){super(null),this._fn=e,this._parms=t}Evaluate(){return this._fn.Function(this._parms)}Optimize(){let e=!0;if(null!=this._parms)for(let t=0;t<this._parms.Count();t++){const n=this._parms[t].Optimize();this._parms[t]=n,n._token.Type!=i.TKTYPE.LITERAL&&(e=!1)}return e?new r.Expression(this.Evaluate()):this}}t.FunctionExpression=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariableExpression=void 0;const r=n(93);class i extends r.Expression{constructor(e,t){super(null),this._dct=e,this._name=t}Evaluate(){return this._dct[this._name]}}t.VariableExpression=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XObjectExpression=void 0;const r=n(93);class i extends r.Expression{constructor(e){super(null),this._value=e}Evaluate(){return this._value}}t.XObjectExpression=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingFlags=t.BindingInfo=t.BindingExpression=void 0;const r=n(93),i=n(36);class l extends r.Expression{constructor(e,t){super(null),this._ce=e,this._bindingPath=t}Evaluate(){return this.GetValue(this._ce.DataContext)}GetName(){return null==this._bindingPath||this._bindingPath.Count()<1?i.StringUtils.Empty:this._bindingPath[0].Name}GetValue(e){if(null!=e)for(let t=0;t<this._bindingPath.Count();t++){const n=this._bindingPath.Get(t);n.Name&&e[n.Name]?(n.PropertyInfo=e[n.Name],e=n.PropertyInfo):n.PropertyInfoItem=null,null!=n.Parms&&n.Parms.Count()>0&&null==n.PropertyInfoItem&&e.Item&&(n.PropertyInfoItem=e.Item)}return e}}t.BindingExpression=l;t.BindingInfo=class{constructor(e,t){this.Name=e,this.Parms=t}},function(e){e[e.Instance=0]="Instance",e[e.Static=1]="Static",e[e.Public=2]="Public",e[e.NonPublic=3]="NonPublic",e[e.FlattenHierarchy=4]="FlattenHierarchy",e[e.IgnoreCase=5]="IgnoreCase",e[e.DeclaredOnly=6]="DeclaredOnly",e[e.CreateInstance=7]="CreateInstance"}(t.BindingFlags||(t.BindingFlags={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssignExpression=void 0;const r=n(93),i=n(119);class l extends r.Expression{constructor(e,t,n,r){super(e),this._lft=t,this._rgt=n,this._calc=r}Evaluate(){if(this._token.Type==i.TKTYPE.ASSIGN){this._lft._token.Value.toString();return this._rgt.Evaluate()}throw"Bad expression."}Optimize(){return this._lft=this._lft.Optimize(),this._rgt=this._rgt.Optimize(),this._lft._token.Type==i.TKTYPE.LITERAL&&this._rgt._token.Type==i.TKTYPE.LITERAL?new r.Expression(this.Evaluate()):this}}t.AssignExpression=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryExpression=void 0;const r=n(93),i=n(119);class l extends r.Expression{constructor(e,t,n){super(e),this._lft=t,this._rgt=n}Evaluate(){if(this._token.Type==i.TKTYPE.COMPARE){const e=this._lft.CompareTo(this._rgt);switch(this._token.ID){case i.TKID.GT:return e>0;case i.TKID.LT:return e<0;case i.TKID.GE:return e>=0;case i.TKID.LE:return e<=0;case i.TKID.EQ:return 0==e;case i.TKID.NE:return 0!=e}}const[e,t]=this.numberLR(this._lft,this._rgt);switch(this._token.ID){case i.TKID.ADD:return e+t;case i.TKID.SUB:return e-t;case i.TKID.MUL:return e*t;case i.TKID.DIV:return e/t;case i.TKID.DIVINT:return Math.floor(e/t);case i.TKID.MOD:return Math.floor(e%t);case i.TKID.POWER:const n=e,r=t;return 0==r?1:.5==r?Math.sqrt(n):1==r?n:2==r?n*n:3==r?n*n*n:4==r?n*n*n*n:Math.pow(e,t)}throw"Bad expression."}Optimize(){return this._lft=this._lft.Optimize(),this._rgt=this._rgt.Optimize(),this._lft._token.Type==i.TKTYPE.LITERAL&&this._rgt._token.Type==i.TKTYPE.LITERAL?new r.Expression(this.Evaluate()):this}numberLR(e,t){let n=(e instanceof r.Expression?e:null).Evaluate(),i=(t instanceof r.Expression?t:null).Evaluate();return[Number(n),Number(i)]}}t.BinaryExpression=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnaryExpression=void 0;const r=n(93),i=n(119);class l extends r.Expression{constructor(e,t){super(e),this._expr=t}Evaluate(){let e=Number(this._expr);switch(this._token.ID){case i.TKID.ADD:return++e;case i.TKID.SUB:return--e}throw"Bad expression."}Optimize(){return this._expr=this._expr.Optimize(),this._expr._token.Type==i.TKTYPE.LITERAL?new r.Expression(this.Evaluate()):this}}t.UnaryExpression=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XapFunc=void 0;const r=n(8),i=n(36);t.XapFunc=class{static CompareAge(e,t){return class{static CompareAge(e,t){if(i.StringUtils.IsNullOrEmpty(e)||i.StringUtils.IsNullOrEmpty(t))return null;if("不详"==e||"不详"==t)return null;const n=e.indexOf("岁"),l=t.indexOf("岁");if(-1!=n&&-1==l)return 1;if(-1==n&&-1!=l)return-1;if(-1!=n&&-1!=l){return r.CNumUtil.TryParseInt(e.substring(0,n),-1)-r.CNumUtil.TryParseInt(t.substring(0,l),-1)}if(-1==n&&-1==l){const n=e.indexOf("月"),i=t.indexOf("月");if(-1!=n&&-1==i)return 1;if(-1==n&&-1!=i)return-1;const l=e.indexOf("天"),s=t.indexOf("天");if(-1!=n&&-1!=i){const o=r.CNumUtil.TryParseInt(e.substring(0,n),-1),a=r.CNumUtil.TryParseInt(t.substring(0,i),-1);if(o>a)return 1;if(o<a)return-1;if(o==a){if(-1!=l&&-1==s)return 1;if(-1==l&&-1!=s)return-1;if(-1!=l&&-1!=s){return r.CNumUtil.TryParseInt(e.substring(n+1,l),-1)-r.CNumUtil.TryParseInt(t.substring(i+1,s),-1)}return 0}}if(-1==n&&-1==i){if(-1!=l&&-1==s)return 1;if(-1==l&&-1!=s)return-1;if(-1!=l&&-1!=s){return r.CNumUtil.TryParseInt(e.substring(0,l),-1)-r.CNumUtil.TryParseInt(t.substring(0,s),-1)}return null}}return null}}.CompareAge(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogItem=void 0;t.LogItem=class{constructor(){this.log_level=5,this.id_thread=-1,this.prefix_msg=null,this.arr_log_msges=null,this.str_stacktrace=null,this.log_func_name=null,this.log_line=-1,this.next=null}clear(){this.log_level=0,this.id_thread=-1,this.prefix_msg=null,this.arr_log_msges=null,this.str_stacktrace=null,this.next=null}setNext(e){this.next=e}getNext(){return this.next}getLogLevel(){return this.log_level}static getLogLevelInfo(e){let t;switch(e){case 0:return t=" [Final]: ",t;case 1:return t=" [Error]: ",t;case 2:return t=" [Warn]: ",t;case 5:return t=" [Info]:",t;case 7:return t=" [Debug]: ",t}return t=" ",t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleExpCheckResultInfo=void 0;t.EleExpCheckResultInfo=class{constructor(e,t,n,r,i){this.IsSuccess=i,this.SendGrpId=e,this.RecevGrpId=t,this.TipMsg=r,this.ExpInEle=n}get IsSuccess(){return this._IsSuccess}set IsSuccess(e){this._IsSuccess=e}get SendGrpId(){return this._SendGrpId}set SendGrpId(e){this._SendGrpId=e}get RecevGrpId(){return this._RecevGrpId}set RecevGrpId(e){this._RecevGrpId=e}get ExpInEle(){return this._ExpInEle}set ExpInEle(e){this._ExpInEle=e}get TipMsg(){return this._TipMsg}set TipMsg(e){this._TipMsg=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableColumn=void 0;const r=n(9),i=n(0),l=n(8);class s extends i.XBaseElement{constructor(e){super(),this.id=null,this.index=null,this.boundsDisp=r.RectangleF.Empty,super.Parent=e}get EleTypeName(){return"XTextTableColumn"}get ID(){return this.id}set ID(e){this.id=e}get Index(){return this.index}set Index(e){this.index=e}get BoundsDISP(){return this.boundsDisp}set BoundsDISP(e){this.boundsDisp=e}get WidthDisp(){return this.BoundsDISP.Width}get Width(){return super.Width}set Width(e){this.propList.ModifyProperty("Width",e,0),this.SetSizeDPI(e,-1e3,300)}CopyFrom(e,t=!1,n=!1,r=!0){this.OwnerDocPanel=e.OwnerDocPanel,this.Width=e.Width,this.SetSizeDPI(e.Width,e.Height,300),this.SetSizeDISP(e.BoundsDISP.Width,e.BoundsDISP.Height)}SetPositionDISP(e,t){-1e3!=e&&(this.boundsDisp.X=e),-1e3!=t&&(this.boundsDisp.Y=t)}SetSizeDISP(e,t){-1e3!=e&&(this.boundsDisp.Width=e),-1e3!=t&&(this.boundsDisp.Height=t)}SetSizeDPI(e,t,n){super.SetSizeDPI(e,t,n)}get IsAuto(){let e=this.propList.GetPropValue("IsAuto");return l.CNumUtil.TryParseBool(e,!1)}set IsAuto(e){this.propList.ModifyProperty("IsAuto",e,!1)}}t.XTextTableColumn=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleMsgBus=void 0;const r=n(3),i=n(714),l=n(36);t.EleMsgBus=class{constructor(){this.msgBus=null,this.msgBus=new r.Dictionary}get M_msgBus(){return this.msgBus}AddMsgItem(e,t,n,s,o,a){if(!l.StringUtils.IsNullOrEmpty(e)&&!l.StringUtils.IsNullOrEmpty(t)&&!l.StringUtils.IsNullOrEmpty(s)){let l;this.msgBus.ContainsKey(e)?l=this.msgBus.Get(e):(l=new r.List,this.msgBus.Add(e,l));let u=new i.EleMsgItem(t,n);u.DataContext=a,u.AddRecvXID(s),null!=o&&u.AddRecvEle(o),l.Add(u)}}SendMessage(e,t,n,r,i){if(!l.StringUtils.IsNullOrEmpty(t)&&!l.StringUtils.IsNullOrEmpty(n)){let s=null;if(s=this.msgBus.TryGetValue(t)[1],null==s||0==s.Count())r.ResLevel=1,r.StrMsg=l.StringUtils.Format("未找到消息发送者，或者接收者分组列表为空。{0}",t);else{if(null==s.Find(e=>e.MsgName==n))r.ResLevel=1,r.StrMsg=l.StringUtils.Format("消息接受者列表为空。sender={0}, msg_name={1}",t,n);else for(let t=0;t<s.Count();t++){const n=s.Get(t);e.DataContext=n.DataContext,e.CalcExpress(n.ExpressionStr,i)}}}}ExpIsValid(e,t,n){let r;for(let n=0;n<t.Count();n++){const i=t.Get(n);if(e==i)return r=!1,r;if(this.msgBus.ContainsKey(i))for(let t=0;t<this.msgBus[i].Count();t++){const n=this.msgBus[i].Get(t).GetRecvXIDIter();for(;n.MoveNext();)if(n.Current.Equals(e))return r=!1,r}}return r=!0,r}Clear(){this.msgBus.Clear()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleMsgItem=void 0;const r=n(3),i=n(36);t.EleMsgItem=class{constructor(e,t){this.msgName=null,this.recvXIDList=null,this.recvEleList=null,this.msgName=e,this._expressionStr=t,this.recvXIDList=new r.List,this.recvEleList=new r.List}get MsgName(){return this.msgName}get ExpressionStr(){return this._expressionStr}GetReceiverCnt(){return Math.floor(this.recvXIDList.Count())}GetRecvXIDIter(){const e=this.recvXIDList.GetEnumerator();return e.Reset(),e}AddRecvXID(e){i.StringUtils.IsNullOrEmpty(e)||this.recvXIDList.Add(e)}SetRecvXIDList(e){if(this.recvXIDList.Clear(),!i.StringUtils.IsNullOrEmpty(e)){const t=e.split(",");null!=t&&0!=t.length&&this.recvXIDList.AddRange(t)}}ClearRecvXIDList(){this.recvXIDList.Clear()}GetRecvEleIter(){const e=this.recvEleList.GetEnumerator();return e.Reset(),e}AddRecvEle(e){this.recvEleList.Add(e)}ClearRecvEleList(){this.recvEleList.Clear()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextDocParams=void 0;const r=n(2),i=n(4),l=n(14),s=n(8);t.XTextDocParams=class{constructor(){this.docID=null,this.AutoWordWrap=!0,this.ShowParagraphFlag=!0,this.IsLocked=!1,this.SecretType=r.ENumSecretType.Partial,this.IsSecret=!1,this.docFmtVer="V1.0-20170901",this.docName=null,this._isAssociatPageIndex=!1}get DocFmtVer(){return this.docFmtVer}set DocFmtVer(e){this.docFmtVer=e}get DocName(){return this.docName}set DocName(e){this.docName=e}get DocID(){return this.docID}set DocID(e){this.docID=e}get FirstDocStartPageNum(){return this._firstDocStartPageNum}set FirstDocStartPageNum(e){this._firstDocStartPageNum=e}get IsAssociatPageIndex(){return this._isAssociatPageIndex}set IsAssociatPageIndex(e){this._isAssociatPageIndex=e}get patientInfo(){return this._patientInfo}set patientInfo(e){this._patientInfo=e}get ShowIcon(){return this._showIcon}set ShowIcon(e){this._showIcon=e}Clear(){this.docName=null,this.docID=null,this.AutoWordWrap=!0,this.ShowParagraphFlag=!0,this.IsLocked=!1,this.IsSecret=!1,this.SecretType=r.ENumSecretType.Partial,this._patientInfo=null}CanModify(){return!this.IsLocked}ReverseSecret(){this.IsSecret=!this.IsSecret}CopyFrom(e){this.DocName=e.DocName,this.DocID=e.DocID,this.AutoWordWrap=e.AutoWordWrap,this.ShowParagraphFlag=e.ShowParagraphFlag,this.IsLocked=e.IsLocked,this.IsSecret=e.IsSecret,this.SecretType=e.SecretType}ToXML(e){let t=e.createElement("Parameters");if(!i.default.IsNullOrEmpty(this.docName)){let n=e.createElement("DocName");n.textContent=this.docName,t.appendChild(n)}if(!i.default.IsNullOrEmpty(this.docID)){let n=e.createElement("DocID");n.textContent=this.docID,t.appendChild(n)}if(this.IsAssociatPageIndex){let n=e.createElement("IsAssociatPageIndex");n.textContent=this.IsAssociatPageIndex.toString(),t.appendChild(n)}if(this.FirstDocStartPageNum){let n=e.createElement("FirstDocStartPageNum");n.textContent=this.FirstDocStartPageNum.toString(),t.appendChild(n)}return t}FromXML(e){let t=l.XmlDomUtil.GetSingleNode(e,"DocName");null!=t&&(this.docName=t.textContent);let n=l.XmlDomUtil.GetSingleNode(e,"DocID");null!=n&&(this.docID=n.textContent);let r=l.XmlDomUtil.GetSingleNode(e,"IsAssociatPageIndex");null!=r&&(this.IsAssociatPageIndex=s.CNumUtil.TryParseBool(r.textContent,!1));let i=l.XmlDomUtil.GetSingleNode(e,"FirstDocStartPageNum");null!=i&&(this.FirstDocStartPageNum=s.CNumUtil.TryParseInt(i.textContent,null))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocWaterMark=void 0;const r=n(51),i=n(8),l=n(7),s=n(83),o=n(14),a=n(10),u=n(43),h=n(130),d=n(210),c=n(2),p=n(4);class f extends h.XBasePropList{constructor(e){super(),this.imgObj=null,this.imgEroded=!1,this.fontStyle=null,this.fnt=null,this.xdoc=null,this.markType=c.ENumWarterMarkTp.None,this.xdoc=e,super.XmlEleName="WaterMark"}get IsPrint(){let e=this.propList.GetPropValue("IsPrint");return i.CNumUtil.TryParseBool(e,!0)}set IsPrint(e){this.propList.ModifyProperty("IsPrint",e,!0)}get EditorPrintFlag(){let e=this.propList.GetPropValue("EditorPrintFlag");return i.CNumUtil.TryParseBool(e,!0)}set EditorPrintFlag(e){this.propList.ModifyProperty("EditorPrintFlag",e,!0)}get IsTile(){let e=this.propList.GetPropValue("IsTile");return i.CNumUtil.TryParseBool(e,!1)}set IsTile(e){this.propList.ModifyProperty("IsTile",e,!1)}get MarkType(){return this.markType}set MarkType(e){this.markType=e,this._ClearPrevMarkType(e)}get ImgObj(){return this.imgObj}set ImgObj(e){this.imgObj=e}get Width(){return this.propList.GetPropValue("Width")}set Width(e){this.propList.ModifyProperty("Width",e,null)}get Height(){return this.propList.GetPropValue("Height")}set Height(e){this.propList.ModifyProperty("Height",e,null)}get ImgEroded(){return this.imgEroded}set ImgEroded(e){this.imgEroded=e}get ImgZmRatio(){let e=this.propList.GetPropValue("ImgZoom");return i.CNumUtil.TryParseFloat(e,0)}set ImgZmRatio(e){this.propList.ModifyProperty("ImgZoom",e,0)}get ImgBase64Str(){let e=this.propList.GetPropValue("ImageDataBase64String");return e&&(e=decodeURIComponent(e)),e}set ImgBase64Str(e){e&&(e=decodeURIComponent(e)),this.propList.ModifyProperty("ImageDataBase64String",e,null)}get Text(){return this.propList.GetPropValue("Text")}set Text(e){this.propList.ModifyProperty("Text",e,null)}get WatermarkSpacing(){let e,t=this.propList.GetPropValue("WatermarkSpacing");return e=null==t?"100":t,e}set WatermarkSpacing(e){this.propList.ModifyProperty("WatermarkSpacing",e,"100")}get Opacity(){return this._Opacity}set Opacity(e){this._Opacity=e}get FntStyle(){return null==this.fontStyle&&(this.fontStyle=new d.XFontStyle,this.fontStyle.SetPropList(this.propList),null!=this.xdoc&&(this.fontStyle.DefaultStyle=this.xdoc.GetDefaultStyle())),this.fontStyle}get Font(){return this.fnt}get ForeColor(){return this.propList.GetColorValue("Color",l.Color.LightGray)}set ForeColor(e){this.propList.SetColorValue("Color",e,new l.Color("#D3D3D3"))}get TextAngle(){let e=this.propList.GetPropValue("TextAngle");return i.CNumUtil.TryParseInt(e,315)}set TextAngle(e){for(;e<0;)e+=360;e%=360,this.propList.ModifyProperty("TextAngle",e,315)}Clear(){super.Clear(),this.markType=c.ENumWarterMarkTp.None,this.imgObj=null,this.fontStyle=null,this.fnt=null}AutoFntSz(){null!=this.fontStyle&&this.IsAutoFntSz()&&(this.fontStyle.FontSize=1,this.fnt=this._AutoCalcFontSz(-1,-1))}IsAutoFntSz(){let e;if(null==this.fontStyle)e=!1;else{e=this.fontStyle.FontSize<=5}return e}NotifyFontChanged(){this.markType==c.ENumWarterMarkTp.Text&&(this.IsAutoFntSz()?this.fnt=this._AutoCalcFontSz(-1,-1):this.fnt=this.FntStyle.BuildFont())}CopyFrom(e){null!=e&&(this.markType=e.markType,this.propList.CopyFrom(e.propList),this.imgObj=e.imgObj,this.imgEroded=e.imgEroded,null!=this.fontStyle&&this.fontStyle.CopyFrom(e.fontStyle),this.fnt=e.fnt)}ToXML(e){this.markType==c.ENumWarterMarkTp.Image&&(this.ImgBase64Str=s.XImageUtil.ImageToBase64(this.imgObj));let t,n=super.ToXML(e);if(null==n)t=null;else{let e=n,r="type",i=this.markType;e.setAttribute(r,i.toString()),t=n}return t}FromXML(e){if(super.FromXML(e),null!=e){let t=o.XmlDomUtil.GetSingleAttrValue(e,"type"),n=i.CNumUtil.TryParseInt(t,0);if(this.markType=n,this.markType==c.ENumWarterMarkTp.Image){let e=this.ImgBase64Str;this.ImgObj=s.XImageUtil.Base64ToImage(e)}else this.markType==c.ENumWarterMarkTp.Text&&this.NotifyFontChanged()}}_ClearPrevMarkType(e){switch(e){case c.ENumWarterMarkTp.None:this._ClearImgMark(),this._ClearTextMark();break;case c.ENumWarterMarkTp.Text:this._ClearImgMark();break;case c.ENumWarterMarkTp.Image:this._ClearTextMark()}}_AutoCalcFontSz(e,t){let n,i=this.fnt;if(null==i&&(i=this.FntStyle.BuildFont()),e<=0&&null!=this.xdoc&&(t=100,e=this.xdoc.GetPageFmt().GetValidWidthDPI(t)),e<=0||!this.IsAutoFntSz())return n=i,n;let l=this.Text;if(p.default.IsNullOrEmpty(l))return n=i,n;let s=(e=a.DPITransUtil.TransFloatVal(e,t,96))/l.length;s=a.DPITransUtil.TransFloatVal(s,96,72),s>10&&(s-=10),i=new r.Font(i.Name,s,i.Style);let o=i;for(;u.GrapUtil.MeasureStrSize(null,i,1e4,l).Width<e;){let e=i.SizeInPoints%10;e<1&&(e=1),o=i,i=new r.Font(i.Name,i.Size+e,i.Style)}return n=o,n}_ClearTextMark(){this.Text=null,null!=this.fontStyle&&this.fontStyle.Clear(!0),this.ForeColor=l.Color.Empty,this.TextAngle=0}_ClearImgMark(){this.imgObj=null,this.ImgZmRatio=0,this.ImgBase64Str=null}}t.XDocWaterMark=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XEleCommStyleList=void 0;const r=n(58),i=n(3),l=n(14);t.XEleCommStyleList=class{constructor(){this.defaultStyle=null,this.commStyleList=null,this.defaultStyle=new r.XBaseEleStyle(!0),this.commStyleList=new i.List}ClearCommStyleList(e){if(e)for(let e of this.commStyleList)e.Clear();this.commStyleList.Clear()}Clear(e,t){t&&this.defaultStyle.Clear(),this.ClearCommStyleList(e)}GetDefaultStyle(){return this.defaultStyle}TryAddEleStyle(e){let t;if(null==e||e.IsEmpty())t=-1;else{let n=-1;for(let t of this.commStyleList)if(e.IsEqual(t)){n=t.Index;break}n>=0?t=n:(e.Index=this.commStyleList.Count(),this.commStyleList.Add(e),t=e.Index)}return t}CopyEleStyle(e,t,n){if(null!=t&&e>=0){let n=this.commStyleList.Find(t=>t.Index==e);null!=n&&t.CopyFrom(n,!0)}}CopyFrom(e){this.defaultStyle.CopyFrom(e.defaultStyle,!1)}ToXML(e){let t=e.createElement("ContentStyles");const n=this.defaultStyle.ToXML(e);null!=n&&t.appendChild(n);let r=e.createElement("Styles");t.appendChild(r);for(let t of this.commStyleList)if(null!=t&&!t.IsEmpty()){const n=t.ToXML(e);null!=n&&r.appendChild(n)}return t}FromXML(e){if(this.ClearCommStyleList(!0),null==e)return;let t=l.XmlDomUtil.GetSingleNode(e,"Default");null==t&&(t=l.XmlDomUtil.GetSingleNode(e,"Style")),this.defaultStyle.FromXML(t);let n=l.XmlDomUtil.GetSingleNode(e,"Styles").getElementsByTagName("Style");if(null!=n&&0!=n.length)for(let e=0;e<n.length;e++){let t=new r.XBaseEleStyle(!1);t.FromXML(n[e]),this.commStyleList.Add(t)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XOutlineList=void 0;const r=n(719),i=n(3),l=n(233),s=n(117),o=n(720),a=n(224);t.XOutlineList=class{constructor(){this.vroot=null,this.outlineList=null,this.sernoPath=new l.SernoPath,this.vroot=new r.XOutline(!0),this.outlineList=new o.LinkedList,this.outlineList.Add(this.vroot)}get Count(){let e=this.outlineList.Count;return e>=1&&e--,e}Clear(){let e=this.outlineList.First;for(e=null==e?null:e.Next;null!=e;e=e.Next){let t=e.Value;null!=t&&t.Clear()}this.sernoPath.Clear(),this.outlineList.Clear(),this.outlineList.Add(this.vroot)}Append(e,t){if(null!=e){this.outlineList.Add(e);let n=this.outlineList.Last,r=this._RefreshParentOnAdd(n);if(t){let e=null==r?0:r.length;for(let t=0;t<e;t++)this._RefreshChildrenSerno(r[t])}}}Add(e){if(null==e)return!1;return this._AddOutline(e)}Remove(e,t){let n;if(null==e)return n=!1,n;let r=e.RelOutline,i=this.outlineList.Find(r);if(null==i)n=!1;else{n=this._RemoveOutline(i,-1,t)}return n}ChangeOutlineLv(e,t){if(null==e)return!1;let n=e.RelOutline;if(null==n||null==n.ParentOutline){return this._AddOutline(e)}let r=this.outlineList.Find(n),i=e.OutLineLevel;if(i<0){return this._RemoveOutline(r,t,!0)}return t!=i&&this._ChangeOutlineLv(r,t)}_ChangeOutlineLv(e,t){if(null==e)return!1;let n=e.Value.OutLineLevel,r=this._RefreshParentOnChangeLv(e),i=this._FindParent(t,e),l=this._FindParent(n,e);this._RefreshChildrenSerno(i),l!=i&&this._RefreshChildrenSerno(l);let s=null==r?0:r.length;for(let e=0;e<s;e++)this._RefreshChildrenSerno(r[e]);return!0}_RefreshParentOnChangeLv(e){if(null==e)return null;let t=new i.List;for(let n=e;null!=n&&null!=n.Value;n=n.Next){let e=n.Value,r=e.OutLineLevel,i=this._FindParent(r,n);e.ParentOutline=i.Value,t.Add(i)}return t.ToArray()}ChangeListStyle(e){if(null!=e){let t=e.OutLineLevel,n=e.ListStyle;if(s.ParagraphListStyleVals.IsNoneListStyle(n))e.NotifyLayoutChanged(!0,!1);else if(null!=e.RelOutline){let r=e.RelOutline.ParentOutline;if(null!=r){let e=this.outlineList.Find(r);this._UnifyListStyle(e,t,n)}}}}_UnifyListStyle(e,t,n){if(null!=e){let r=e.Value.OutLineLevel;for(let i=e.Next;null!=i;i=i.Next){let e=i.Value;if(null==e)break;let l=e.OutLineLevel;if(l<=r)break;if(l==t){let t=e.RelParaghEle.ListStyle;s.ParagraphListStyleVals.IsNoneListStyle(t)||(e.RelParaghEle.ListStyle=n,e.RelParaghEle.NotifyLayoutChanged(!0,!1))}else l>t&&e.RelParaghEle.NotifyLayoutChanged(!0,!1)}}}RefreshAllParent(){if(this.Count>0){let e=new a.Stack;e.Push(this.vroot),this.sernoPath.Clear();for(let t=this.outlineList.First.Next;null!=t&&null!=t.Value;t=t.Next){let n=t.Value,r=n.OutLineLevel,i=e.Peek(),l=i.OutLineLevel;for(;r<=l;)i=e.Pop(),l=i.OutLineLevel,r<l&&this.sernoPath.SetSerno(l,0,i.ListStyle),i=e.Peek(),l=i.OutLineLevel;n.ParentOutline=i,n.Serno=this.sernoPath.GetSerno(r),n.RelParaghEle.NotifyLayoutChanged(!0,!1),this.sernoPath.AddSerno(r,l+1),e.Push(n)}e.Clear()}}_AddOutline(e){if(null==e)return!1;if(e.OutLineLevel<0)return!1;let t=e.RelOutline;null==t&&(t=new r.XOutline(!1,e));let n,i=e.FindPrevParagh(5e3);if(null==i)n=this.outlineList.First;else{let e=i.RelOutline;n=this.outlineList.Find(e)}this.outlineList.Add(t,n);let l=n.Next,s=this._RefreshParentOnAdd(l),o=null==s?0:s.length;for(let e=0;e<o;e++)this._RefreshChildrenSerno(s[e]);return!0}_RefreshParentOnAdd(e){if(null==e)return null;let t=e.Value,n=t.OutLineLevel,r=this._FindParent(n,e);if(null==r)return null;let i=r.Value;t.ParentOutline=i;for(let t=e.Next;null!=t;t=t.Next){let e=t.Value;if(null==e)continue;let r=e.OutLineLevel;if(r<=n)break;if(r>n){let i=e.ParentOutline;if(null==i||i.OutLineLevel<=n){let n=this._FindParent(r,t);e.ParentOutline=n.Value}}}return[e,r]}_RemoveOutline(e,t,n){if(null==e)return!1;let r=e.Value;t<0&&(t=r.OutLineLevel);let i=e.Next,l=this._FindParent(t,e);this.outlineList.Remove(e.Value),r.ParentOutline=null;let s=this._RefreshParentOnDel(i);if(n){this._RefreshChildrenSerno(l);let e=null==s?0:s.length;for(let t=0;t<e;t++)this._RefreshChildrenSerno(s[t])}return r.RelParaghEle.NotifyLayoutChanged(!0,!1),!0}_RefreshParentOnDel(e){if(null==e)return null;let t=new i.List;for(;null!=e&&null!=e.Value;){let n=e.Value,r=n.OutLineLevel;if(n.ParentOutline.IsDeleted()){let i=this._FindParent(r,e);n.ParentOutline=i.Value,t.Add(i)}e=e.Next}return t.ToArray()}_RefreshChildrenSerno(e){if(null!=e){let t=e.Value,n=t.OutLineLevel;this.sernoPath.Clear();let r=-1,i=e.Next;for(;null!=i;){let e=i.Value;if(null==e)break;let l=e.OutLineLevel;if(l<=n)break;if(e.ParentOutline==t){let t;e.Serno=this.sernoPath.GetSerno(l),t=r<0?n+1:l>=r?r+1:l+1,this.sernoPath.AddSerno(l,t)}e.RelParaghEle.NotifyLayoutChanged(!0,!1),i=i.Next,r=l}}}_FindParent(e,t){if(e<0||null==t)return null;let n;for(n=t.Prev;null!=n;n=n.Prev){if(n.Value.OutLineLevel<e)break}return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XOutline=void 0;const r=n(346),i=n(332),l=n(233),s=n(3);class o{constructor(e=!1,t){this.parent=null,this.relParaEle=null,this.relOutlineFoldEle=null,this.isVRoot=!1,this.isVRoot=e,e||(this.relOutlineFoldEle=new i.XOutlineFoldIcon),this.relParaEle=t,null!=t&&(t.RelOutline=this)}get ParentOutline(){return this.parent}set ParentOutline(e){this.parent=e}get RelParaghEle(){return this.relParaEle}set RelParaghEle(e){this.relParaEle=e}get OutLineLevel(){return null==this.relParaEle?-1:this.relParaEle.OutLineLevel}get ListStyle(){return null==this.relParaEle?"None":this.relParaEle.ListStyle}get Serno(){return null==this.relParaEle?-1:this.relParaEle.Serno}set Serno(e){null!=this.relParaEle&&(this.relParaEle.Serno=e)}get IsRelParaghEleValid(){return null!=this.relParaEle&&this.relParaEle.IsOutlineParagraph}get RelOutlineFoldEle(){return this.relOutlineFoldEle}get IsFolded(){return null!=this.relOutlineFoldEle&&this.relOutlineFoldEle.IsFolded}Clear(){this.parent=null,this.relOutlineFoldEle=null,null!=this.relParaEle&&(this.relParaEle.RelOutline=null,this.relParaEle=null)}IsValid(){return this.OutLineLevel>=0}IsDeleted(){return!(this.isVRoot||this.IsValid()&&null!=this.ParentOutline)}IsInParentOf(e,t){let n;if(null==e)return n=!1,n;let r=!1;for(let n=t?e:e.ParentOutline;null!=n;n=n.ParentOutline)if(this.Equals(n)){r=!0;break}return n=r,n}BuildFullSerno(){let e=this.OutLineLevel;o._Serno_Path_.Clear();let t=this,n=e;for(;null!=t&&n>=0;)o._Serno_Path_.SetSerno(n,t.Serno,t.ListStyle),t=t.ParentOutline,n=null==t?-2:t.OutLineLevel;return o._Serno_Path_.BuildSernoFullPath(e)}FoldOutlineContent(e){if(null!=this.relParaEle&&this.relParaEle.IsOutlineParagraph){let t=this.RelOutlineFoldEle;if(null!=t&&t.IsFolded!=e){t.IsFolded=e;let n=this.FindAllParasInOutline();if(null!=n&&n.length>0)for(let t=1;t<n.length;t++){let r=n[t].EleStyle;r.IsFolded!=e&&(r.IsFolded=e,n[t].NotifyLayoutChanged(!0,!1))}}}}FindAllParasInOutline(){let e,t=this.OutLineLevel;if(t<0)return e=null,e;let n=new s.List,i=this.relParaEle.Parent,l=!1;for(let s of i.ChildEleList){let i=s instanceof r.XParagraphFlag?s:null;if(null!=i){let e=i==this.relParaEle;if(l||(l=e),l){let r=i.OutLineLevel;if(!e&&r>=0&&r<=t)break;n.Add(i)}}let o=n.ToArray();return n.Clear(),e=o,e}}Equals(e){let t;if(this==e&&(t=!0),null==e)return t=!1,t;if(null!=this.relParaEle){if(!this.relParaEle.Equals(e.relParaEle))return t=!1,t}else if(null!=e.relParaEle)return t=!1,t;return t=!0,t}}t.XOutline=o,o.TextLevel=-1,o.AnyOutline=5e3,o._Serno_Path_=new l.SernoPath},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedList=t.LinkedNode=void 0;class r{constructor(e){this.Value=e,this._prev=null,this._next=null}set Prev(e){this._prev=e}get Prev(){return this._prev}set Next(e){this._next=e}get Next(){return this._next}}t.LinkedNode=r;t.LinkedList=class{constructor(){this.length=0,this.head=new r(null),this.tail=new r(null),this.head.Next=this.tail,this.tail.Prev=this.head}Add(e,t){let n;new r(e);n=t instanceof r?t:this.tail.Prev,this.length++}Remove(e){let t=this.head.Next;for(;null!=t;){if(t.Value==e){let e=t.Prev,n=t.Next;e.Next=n,n.Prev=e,this.length--;break}t=t.Next}}Find(e){if(e instanceof Number){if(0==this.length)return null;if(e<0||e>=this.length)return null;if(0==e)return this.head;let t=this.head,n=e;for(;n>0&&(t=t.Next,null!=t);)n--;return t}if(0==this.length)return null;if(null==e)return null;let t=!1,n=null,r=this.head;for(;;){if(n=r.Value,null!=n&&e==n){t=!0;break}if(r=r.Next,null==r)break}return t?r:null}get Last(){return this.tail.Prev}get First(){return this.head.Next}toString(){let e=[],t=this.head.Next;for(;null!=t;)e.push(t.toString()),t=t.Next;return e.join("->")}get Count(){return this.length}Clear(){this.head=new r(null),this.tail=new r(null),this.length=0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDebugOptions=void 0;const r=n(141),i=n(722),l=n(14),s=n(8);t.XDebugOptions=class{constructor(){this.ruleVisible=!1,this.ownerInfo=null,this.docOpts=null,this.ownerInfo=new r.XUserInfo,this.docOpts=new i.XDocOptions}set OwnerInfo(e){this.ownerInfo=e}get OwnerInfo(){return this.ownerInfo}get RuleVisible(){return this.ruleVisible}set RuleVisible(e){this.ruleVisible=e}Clear(){this.ruleVisible=!1,this.ownerInfo.Clear(),this.docOpts.Clear()}GetDocOpts(){return this.docOpts}ToXML(e){let t=e.createElement("ControlOptionsFor"),n=e.createElement("RuleVisible");return t.appendChild(n),n=this.docOpts.ToXML(e),t.appendChild(n),t}FromXML(e){if(null!=e){let t=l.XmlDomUtil.GetSingleNode(e,"RuleVisible");null!=t&&(this.ruleVisible=s.CNumUtil.TryParseBool(t.textContent,!1));let n=l.XmlDomUtil.GetSingleNode(e,"DocumentOptions");this.docOpts.FromXML(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocOptions=void 0;const r=n(723),i=n(724),l=n(725),s=n(14);t.XDocOptions=class{constructor(){this.securityOpt=null,this.specEleStyleOpt=null,this.behaviorOpt=null,this.securityOpt=new r.SecurityOptions,this.specEleStyleOpt=new l.SpecialEleStyleOptions,this.behaviorOpt=new i.BehaviorOptions}Clear(){this.securityOpt.Clear(),this.specEleStyleOpt.Clear(),this.behaviorOpt.Clear()}GetSecurityOpt(){return this.securityOpt}GetSpecEleStyleOpt(){return this.specEleStyleOpt}GetBehaviorOpt(){return this.behaviorOpt}ToXML(e){let t=e.createElement("DocumentOptions"),n=this.securityOpt.ToXML(e);null!=n&&t.appendChild(n);let r=this.specEleStyleOpt.ToXML(e);null!=r&&t.appendChild(r);let i=this.behaviorOpt.ToXML(e);return null!=i&&t.appendChild(i),t}FromXML(e){if(null!=e){let t=s.XmlDomUtil.GetSingleNode(e,"SecurityOptions");this.securityOpt.FromXML(t),t=s.XmlDomUtil.GetSingleNode(e,"ViewOptions"),this.specEleStyleOpt.FromXML(t),t=s.XmlDomUtil.GetSingleNode(e,"BehaviorOptions"),this.behaviorOpt.FromXML(t)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecurityOptions=void 0;const r=n(3),i=n(342),l=n(7),s=n(14),o=n(8),a=n(26);t.SecurityOptions=class{constructor(){this.autoEnablePermWhenLogin=!1,this.traceStyleList=null,this.hasUserHistory=!1,this.traceStyleList=new r.List,this._InitDefaultTraceStyle()}set HasUserHistory(e){this.hasUserHistory=e}get AutoEnablePermWhenLogin(){return this.autoEnablePermWhenLogin}set AutoEnablePermWhenLogin(e){this.autoEnablePermWhenLogin=e}GetTrackStyle(e){return this.traceStyleList.Find(t=>t.PermLevel==e)}ToXML(e){if(!this.hasUserHistory)return null;let t=e.createElement("SecurityOptions"),n=e.createElement("AutoEnablePermissionWhenUserLogin");n.textContent=this.autoEnablePermWhenLogin.toString(),t.appendChild(n);for(let n of this.traceStyleList){let r=n.ToXML(e);t.appendChild(r)}return t}FromXML(e){if(this.traceStyleList.Clear(),null!=e){let t=s.XmlDomUtil.GetSingleNode(e,"AutoEnablePermissionWhenUserLogin");null!=t&&(this.autoEnablePermWhenLogin=o.CNumUtil.TryParseBool(t.textContent,!1));let n=e.getElementsByTagName("TraceStyle");if(n.length>0)for(let e=0;e<n.length;e++){let t=new i.TraceStyle;t.FromXML(n[e]),this.traceStyleList.Add(t)}else this.FromXML_TryYYF(e)}this._InitDefaultTraceStyle()}FromXML_TryYYF(e){for(let t=0;t<20;t++){let n=e.getElementsByTagName("TrackVisibleLevel"+t)[0];if(null==n)break;let r=new i.TraceStyle;r.FromXML(n),r.PermLevel=t,this.traceStyleList.Add(r)}}_InitDefaultTraceStyle(){if(this.traceStyleList.Count()<=0){let e=new i.TraceStyle;e.PermLevel=1,e.UnderLineColor=l.Color.Blue,e.DeleteLineColor=l.Color.Red,this.traceStyleList.Add(e)}}Clear(){this.traceStyleList.Clear(),this.hasUserHistory=!1,this._InitDefaultTraceStyle()}addTrackStyle(e){this.traceStyleList.Add(e)}saveTrackStyle(e,t){const n=a.TextDocInitInfo.GetInstance().InputFiled_IsDoctorEditorMode,r=a.TextDocInitInfo.GetInstance().TraceAddLineColor,l=a.TextDocInitInfo.GetInstance().TraceDeleteLineColor,s=r&&!r.IsEmpty(),o=l&&!l.IsEmpty();let u;return n?1!=e&&(t==e?(u=this.GetTrackStyle(e),null==u?(u=new i.TraceStyle,u.PermLevel=e,s&&(u.UnderLineColor=r),o&&(u.DeleteLineColor=l),this.addTrackStyle(u)):(s&&(u.UnderLineColor=r),o&&(u.DeleteLineColor=l))):u=this.GetTrackStyle(e)):(u=new i.TraceStyle,s&&(u.UnderLineColor=r),o&&(u.DeleteLineColor=l)),null==u&&(u=new i.TraceStyle),u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BehaviorOptions=void 0;const r=n(130),i=n(8);class l extends r.XBasePropList{constructor(){super(),super.XmlEleName="BehaviorOptions"}get ParagraphFlagFollowTableOrSection(){let e=this.propList.GetPropValue("ParagraphFlagFollowTableOrSection");return i.CNumUtil.TryParseBool(e,!0)}set ParagraphFlagFollowTableOrSection(e){this.propList.ModifyProperty("ParagraphFlagFollowTableOrSection",e,!0)}get ValidateUserIDWhenEditDeleteComment(){let e=this.propList.GetPropValue("ValidateUserIDWhenEditDeleteComment");return i.CNumUtil.TryParseBool(e,!0)}set ValidateUserIDWhenEditDeleteComment(e){this.propList.ModifyProperty("ValidateUserIDWhenEditDeleteComment",e,!0)}get InsertDocumentWithCheckMRID(){let e=this.propList.GetPropValue("InsertDocumentWithCheckMRID");return i.CNumUtil.TryParseBool(e,!0)}set InsertDocumentWithCheckMRID(e){this.propList.ModifyProperty("InsertDocumentWithCheckMRID",e,!0)}}t.BehaviorOptions=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialEleStyleOptions=void 0;const r=n(130),i=n(7);class l extends r.XBasePropList{get NewInputContentUnderlineColor(){return this.propList.GetColorValue("NewInputContentUnderlineColor",i.Color.Empty)}set NewInputContentUnderlineColor(e){this.propList.SetColorValue("NewInputContentUnderlineColor",e,null)}get NewInputContentUnderlineColorValue(){return this.propList.GetColorValue("NewInputContentUnderlineColorValue",i.Color.Empty)}set NewInputContentUnderlineColorValue(e){this.propList.SetColorValue("NewInputContentUnderlineColorValue",e,null)}get AdornTextBackColorValue(){return this.propList.GetColorValue("AdornTextBackColorValue",i.Color.Empty)}set AdornTextBackColorValue(e){this.propList.SetColorValue("AdornTextBackColorValue",e,null)}get FieldBackColorValue(){return this.propList.GetColorValue("FieldBackColorValue",i.Color.Empty)}set FieldBackColorValue(e){this.propList.SetColorValue("FieldBackColorValue",e,null)}get FieldHoverBackColorValue(){return this.propList.GetColorValue("FieldHoverBackColorValue",i.Color.Empty)}set FieldHoverBackColorValue(e){this.propList.SetColorValue("FieldHoverBackColorValue",e,null)}get TagColorForNormalFieldValue(){return this.propList.GetColorValue("TagColorForNormalFieldValue",i.Color.Empty)}set TagColorForNormalFieldValue(e){this.propList.SetColorValue("TagColorForNormalFieldValue",e,null)}constructor(){super(),super.XmlEleName="ViewOptions"}}t.SpecialEleStyleOptions=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XSignatureList=void 0;const r=n(3),i=n(727),l=n(35),s=n(21),o=n(4);t.XSignatureList=class{constructor(){this.Enable=!0,this.signList=new r.List}get Count(){return this.signList.Count()}get LastSignature(){let e,t=this.signList.Count();return e=t<=0?null:this.signList.Get(t-1),e}Clear(){this.signList.Clear()}IndexAvailable(e){return e>=0&&e<this.signList.Count()}CanSign(e){let t,n=this.LastSignature;if(null==n)t=!0;else{let r=n.Superior;t=o.default.IsNullOrEmpty(r)||o.default.Equals(e,r)}return t}AddSignature(e,t){let n;if(this.CanSign(e)){let r=new i.XSignature;r.UserName=e,r.Superior=t,r.SignTime=l.CommDefines.GetLocaTime(),this.signList.Add(r),n=r}else n=null;return n}ToStringArray(){let e=[],t=0;for(let n of this.signList)e[t++]=n.DisplayText();return e}get GetDisplayText(){let e=new s.default;for(let t of this.signList)e.length()>0&&e.append("\r\n"),e.append(t.UserName),e.append(" 签名于 "),e.append(t.SignTime.ToString("yyyy年MM月dd日 HH:mm:ss"));return this.signList.Count()>0&&(o.default.IsNullOrEmpty(this.LastSignature.Superior)||e.append("\r\n 本区域指定由[ "+this.LastSignature.Superior+" ]签名")),e.toString()}ToXML(e){let t=e.createElement("Signatures");for(let n of this.signList){let r=n.ToXML(e);t.appendChild(r)}return t}FromXML(e){if(this.Clear(),null!=e){let t=e.getElementsByTagName("Signature");if(null!=t&&t.length>0)for(let e=0;e<t.length;e++){let n=new i.XSignature;n.FromXML(t[e]),this.signList.Add(n)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XSignature=void 0;const r=n(39),i=n(14),l=n(35),s=n(4);t.XSignature=class{DisplayText(){return s.default.Format("{0} 签名于 {1}",this.UserName,this.SignTime.ToString("yyyy年MM月dd日 HH:mm"))}ToXML(e){let t=e.createElement("Signature");return t.setAttribute("UserName",this.UserName),t.setAttribute("SignTime",this.SignTime.ToString("yyyy-MM-dd HH:mm:ss")),t.setAttribute("Superior",this.Superior),t}FromXML(e){if(null!=e){this.UserName=i.XmlDomUtil.GetSingleAttrValue(e,"UserName");let t=i.XmlDomUtil.GetSingleAttrValue(e,"SignTime");r.DateTime.TryParse(t,"yyyyMMddHHmmss",this.SignTime)||(this.SignTime=l.CommDefines.GetLocaTime()),this.Superior=i.XmlDomUtil.GetSingleAttrValue(e,"Superior")}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XUserHistoryList=void 0;const r=n(3),i=n(349),l=n(729),s=n(35);t.XUserHistoryList=class{constructor(){this.historyList=null,this.nextSerno=0,this.userInfo=null,this.historyList=new r.List}get Count(){return this.historyList.Count()}get NextSerno(){return this.nextSerno++}get UserInfo(){return this.userInfo}Clear(){this.historyList.Clear(),this.nextSerno=0}RevertSerno(){this.nextSerno--}Add(e){let t;return null!=e&&e.IsValid()?(e.Serno<0&&(e.Serno=this.nextSerno++),this.historyList.Add(e),t=!0):t=!1,t}RemoveBySerno(e){let t;if(e<0)t=null;else{let n=this.historyList.Find(t=>t.Serno==e);null==n?t=null:(this.historyList.Remove(n),t=n)}return t}FindBySerno(e){let t;if(e<0)t=null;else{t=this.historyList.Find(t=>t.Serno==e)}return t}FindByPermLv(e){let t;if(e<0)t=null;else{let n=this.historyList.FindAll(t=>t.UserInfo.PermissionLv==e),r=n.ToArray();n.Clear(),t=r}return t}GetHistoriesFromDTime(e){let t,n=this.historyList.Count();if(n<=0)return t=null,t;let r=this.historyList.FindIndex(0,this.historyList.Length,t=>t.AddTime.Ticks()>=e.Ticks());if(r<0)t=null;else{t=this.historyList.GetRange(r,n-r).ToArray()}return t}GetHistoryIter(){let e=this.historyList.GetEnumerator();return e.Reset(),e}CopyFrom(e){this.Clear(),this.historyList.AddRange(e.historyList),this.nextSerno=e.nextSerno}NeedSerialized(){return!0}TryMergeArroundHistWrap(e,t,n){if(null==e||null==t)return!1;if(!e.HasValidHistory()||!t.HasValidHistory())return!1;let r=e.AddHist,i=e.DelHist,l=t.AddHist,s=t.DelHist;if(null==r&&null!=l||null!=r&&null==l)return!1;if(null==i&&null!=s||null!=i&&null==s)return!1;let o=!0;if(null!=r&&(o=r.CanMergeRelEles(l)),o&&null!=i&&(o=o&&i.CanMergeRelEles(s)),!o)return!1;let a=this._TryMerge_ArroundHistory(r,l,n);return a=a||this._TryMerge_ArroundHistory(i,s,n),a}_TryMerge_ArroundHistory(e,t,n){let r;if(null==e||null==t)r=!1;else if(e.MergeRelEles(t)){if(this.RemoveBySerno(t.Serno),null!=n){let r=new l.HistoryRelEleMergeUndo(e,t,this,!0);n.AddItem(r)}r=!0}else r=!1;return r}ToXML(e){let t;if(this.NeedSerialized()){let n=e.createElement("UserHistories");for(let t of this.historyList){let r=t.ToXML(e);null!=r&&n.appendChild(r)}t=n}else t=null;return t}FromXML(e){if(this.historyList.Clear(),null!=e){let t=0,n=e.getElementsByTagName("History");for(let e=0;e<n.length;e++){let r=new i.XUserHistory(s.CommDefines.GetLocaTime());r.FromXML(n[e]),r.Serno<0&&(r.Serno=t),this.historyList.Add(r),t++}this._RefreshNextSerno()}}_RefreshNextSerno(){if(this.historyList.Count()>0)for(let e of this.historyList)e.Serno+1>this.nextSerno&&(this.nextSerno=e.Serno+1)}TrySplitArroundHistWrap(e,t,n,r){let i;if(null==e||null==t)i=!1;else if(e.HasValidHistory()&&t.HasValidHistory()){let l=e.AddHist,s=e.DelHist,o=t.AddHist,a=t.DelHist;if(l!=o||s!=a)i=!1;else{let t=e.DelHistAimPos,o=this._TrySplit_ArroundHistory(s,t,n,r);t=e.AddHistAimPos,o=o||this._TrySplit_ArroundHistory(l,t,n,r),i=o}}else i=!1;return i}_TrySplit_ArroundHistory(e,t,n,r){let s;if(null==e)s=!1;else{let o=e.GetRelEleCnt();if(t<=0||t>=o-1)s=!1;else{let o=new i.XUserHistory(r);if(o.Serno=this.NextSerno,o.CopyFrom(e,t,!0),this.Add(o),null!=n){let t=new l.HistoryRelEleMergeUndo(e,o,this,!1);n.AddItem(t)}s=!0}}return s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryRelEleMergeUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t,n,r){super(),this.xdocHistories=null,this.mergeHist=null,this.subHist=null,this.splitAimPos=0,this.firstEle=null,this.isMerge=!0,this.xdocHistories=n,this.mergeHist=e,this.subHist=t,this.isMerge=r,this.splitAimPos=null==e?0:e.GetRelEleCnt(),r&&(this.splitAimPos-=null==t?0:t.GetRelEleCnt()),this.firstEle=null==e?null:e.GetFirstRelEle(),null==this.firstEle&&(this.firstEle=null==t?null:t.GetFirstRelEle())}IsValid(){return null!=this.xdocHistories&&null!=this.mergeHist&&null!=this.subHist}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){if(this.CanUndo()){if(this.isMerge){this.mergeHist.UnMergeRelEles(this.subHist,this.splitAimPos)&&this.xdocHistories.Add(this.subHist)}else{this.mergeHist.MergeRelEles(this.subHist)&&this.xdocHistories.RemoveBySerno(this.subHist.Serno)}this._Notify_XDocPanel_Changed()}}Redo(){if(this.CanRedo()){if(this.isMerge){this.mergeHist.MergeRelEles(this.subHist)&&this.xdocHistories.RemoveBySerno(this.subHist.Serno)}else{this.mergeHist.UnMergeRelEles(this.subHist,this.splitAimPos)&&this.xdocHistories.Add(this.subHist)}this._Notify_XDocPanel_Changed()}}Clear(){this.xdocHistories=null,this.mergeHist=this.subHist=null,this.firstEle=null}_Notify_XDocPanel_Changed(){null!=this.firstEle&&(this.firstEle.OwnerDocPanel.IsChanged=!0)}}t.HistoryRelEleMergeUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XapCommUtil=void 0;const r=n(232),i=n(4);t.XapCommUtil=class{static get IsFhd(){return r.RelativeUIParam.RELATIVERATIO>r.RelativeUIParam.TEMPLETECHANGEDRATIO}static FindOwnerControl(){return null}static ShowInfo(e,t,n=null){i.default.IsNullOrEmpty(t)||i.default.IsNullOrEmpty(n)&&(n="提示")}static ShowAlert(e,t,n=null){i.default.IsNullOrEmpty(t)||i.default.IsNullOrEmpty(n)&&(n="警告")}static IsContinue(e,t,n=null){return null}static IsContinueWithCancel(e,t,n=null){return null}static SetStatusMsg(e,t){return null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrTooltipInfo=void 0;const r=n(9),i=n(4);t.EmrTooltipInfo=class{constructor(){this.tipMsg=null,this.tipRect=r.RectangleF.Empty,this.isMsgChanged=!1}get TipMsg(){return this.tipMsg}get IsTipMsgChanged(){return this.isMsgChanged}get TipPos(){return this.tipRect.Location}set TipPos(e){this.tipRect.Location=e}get TipRect(){return this.tipRect}set TipRect(e){this.tipRect=e}Clear(){this.tipMsg=null,this.isMsgChanged=!1,this.tipRect=r.RectangleF.Empty}SetTipMsg(e){i.default.Equals(this.tipMsg,e)?this.isMsgChanged=!1:(this.tipMsg=e,this.isMsgChanged=!0)}IsTipSizeValid(){return this.tipRect.Width>0&&this.tipRect.Height>0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Toolbar=void 0;const r=n(733),i=n(27),l=n(356),s=n(357),o=n(751),a=n(752),u=n(358),h=n(753),d={id:"SetFontName",options:["宋体","黑体","微软雅黑","微软正黑体","楷体","新宋体","仿宋"],isObject:!1,singleSelect:!0,selectedValues:["宋体"],isShowHoverStyle:!0},c={id:"SetFontSize",options:[{displayValue:"初号",value:"42"},{displayValue:"小初",value:"36.01"},{displayValue:"一号",value:"26.01"},{displayValue:"小一",value:"24.01"},{displayValue:"二号",value:"22.01"},{displayValue:"小二",value:"18.01"},{displayValue:"三号",value:"16.01"},{displayValue:"小三",value:"15"},{displayValue:"四号",value:"14.01"},{displayValue:"小四",value:"12.01"},{displayValue:"五号",value:"10.5"},{displayValue:"小五",value:"9.01"},{displayValue:"六号",value:"7.5"},{displayValue:"小六",value:"6.5"},{displayValue:"七号",value:"5.5"},{displayValue:"八号",value:"5"},{displayValue:6,value:6},{displayValue:8,value:8},{displayValue:9,value:9},{displayValue:10,value:10},{displayValue:11,value:11},{displayValue:12,value:12},{displayValue:14,value:14},{displayValue:16,value:16},{displayValue:18,value:18},{displayValue:20,value:20},{displayValue:22,value:22},{displayValue:24,value:24},{displayValue:26,value:26},{displayValue:28,value:28},{displayValue:36,value:36},{displayValue:48,value:48},{displayValue:72,value:72}],isObject:!0,displayValue:"displayValue",singleSelect:!0,selectedValues:[{displayValue:12,value:12}],textWidth:24,isShowHoverStyle:!0},p={id:"setLineHeight",options:["单倍行距","1.5倍行距","2倍行距","最小值"],isObject:!1,singleSelect:!0,selectedValues:["单倍行距"],isShowHoverStyle:!0};class f extends i.BaseControl{constructor(e,t,n,i){super(e,n),this.toolbarIcons1=t,this._toobarhandler=i.M_ActionHandler,this.itemList=this.renderChildren(),this.Component=new r.ToolbarComp(e,this.itemList,this.InitProps)}renderChildren(){return this.toolbarIcons1.map((e,t)=>{let n=Object.keys(e)[0],r=e.title;if("fontName"===n)return this.fontFamilyDropdown=new s.Dropdown(null,Object.assign({},d),this._toobarhandler),this.fontFamilyDropdown;if("fontSize"===n)return this.fontSizeDropdown=new s.Dropdown(null,Object.assign({},c),this._toobarhandler),this.fontSizeDropdown;if("lineHeight"===n)return this.lineHeightDropdown=new s.Dropdown(null,Object.assign({},p),this._toobarhandler),this.lineHeightDropdown;if("|"===n)return new o.SeparatorLine(null);if("fontcolor"===n){let t={id:e[n],buttonIcon:n,title:r};return new u.ColorButton(null,t,this._toobarhandler)}if("textcolor"===n){let t={id:e[n],buttonIcon:n,title:r};return new u.ColorButton(null,t,this._toobarhandler)}if("insertform"===n){let t={id:e[n],buttonIcon:n,title:r};return new a.TableButton(null,t,this._toobarhandler)}if("spechars"===n){let t={id:e[n],buttonIcon:n,title:r};return new h.SpecialCharsButton(null,t,this._toobarhandler)}{let t={id:e[n],buttonIcon:n,title:r};return e.group&&(t.group=e.group),e.switch&&(t.switch=e.switch),e.isContinueSelected&&(t.isContinueSelected=e.isContinueSelected),e.paramsVal&&(t.paramsVal=e.paramsVal),new l.IconButton(null,t,this._toobarhandler)}})}destroy(){this.Component.React.destroy()}SetToolBarEditable(e){this.Component.React.SetToolBarEditable(e)}GetCurrentBtnElement(e){let t;for(var n=0;n<this.itemList.length;n++)if(this.itemList[n].id==e){t=this.itemList[n].Component;break}return t}GetCurrenBtnGroup(e){let t=[];for(var n=0;n<this.itemList.length;n++)this.itemList[n].initProps.group==e&&t.push(this.itemList[n].Component);return t}get SelectValue(){return this.fontFamilyDropdown.Component.React.getSelectedItems()}DefaultProps(){return{}}}t.Toolbar=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToolbarComp=void 0,n(734);const r=n(12),i=n(24),l=n(22),s=n(235),o=n(236),a=n(353),u=n(354),h=n(238),d=n(355);class c extends r.PureComponent{constructor(e,t){super(e),this.toolbarDiv=r.createRef(),this.toolbarWrap=r.createRef(),this.wrapperLeft=0,this.rollButtonClickOffset=32,this.state={editable:!0,itemList:[],isRender:!0}}destroy(){this.setState({isRender:!1})}componentDidMount(){this.props.parent.React=this,this.renderScrollbar()}renderScrollbar(){let e=this.toolbarWrap.current,t=this.toolbarDiv.current;e.offsetWidth>t.offsetWidth?t.classList.add("show-roll-btn"):t.classList.remove("show-roll-btn")}leftBtnClick(){0<this.wrapperLeft+24?(this.toolbarWrap.current.style.left="0px",this.wrapperLeft=0):(this.toolbarWrap.current.style.left=this.wrapperLeft+10+"px",this.wrapperLeft+=this.rollButtonClickOffset)}SetToolBarEditable(e){this.setState({editable:e})}rightBtnClick(){let e=this.toolbarWrap.current.offsetWidth-this.toolbarDiv.current.offsetWidth;e<Math.abs(this.wrapperLeft-24)?(this.toolbarWrap.current.style.left=-e+"px",this.wrapperLeft=-e):(this.toolbarWrap.current.style.left=this.wrapperLeft-10+"px",this.wrapperLeft-=this.rollButtonClickOffset)}render(){return this.state.isRender?r.createElement("div",{className:"editor-toolbar",ref:this.toolbarDiv},this.state.editable?null:r.createElement("div",{style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:99}}),r.createElement("div",{className:"toolbar-wrap",ref:this.toolbarWrap},this.props.parent.ItemList.map((e,t)=>e.Component instanceof s.IconButtonComp?r.createElement(s.IconButton,Object.assign({key:t},e.InitProps,{item:e.Component,toolbar:this.props.parent})):e.Component instanceof o.DropdownComp?r.createElement(o.default,Object.assign({key:t},e.InitProps,{item:e.Component})):e.Component instanceof a.SeparatorLineComp?r.createElement(a.default,{key:t,item:e.Component}):e.Component instanceof u.TableButtonComp?r.createElement(u.TableButton,Object.assign({key:t},e.InitProps,{item:e.Component})):e.Component instanceof d.SpecialCharsButtonComp?r.createElement(d.SpecialCharsButton,Object.assign({key:t},e.InitProps,{item:e.Component})):e.Component instanceof h.ColorButtonComp?r.createElement(h.ColorButton,Object.assign({key:t},e.InitProps,{item:e.Component})):void 0)),r.createElement("span",{onClick:()=>{this.leftBtnClick()},className:"roll-btn left-btn"}),r.createElement("span",{onClick:()=>{this.rightBtnClick()},className:"roll-btn right-btn"})):null}}class p extends l.BaseComponent{constructor(e,t,n){super(e,n,!0),this.itemList=t,this.Render()}get ItemList(){return this.itemList}Render(){i.render(r.createElement(c,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.ToolbarComp=p},function(e,t,n){var r=n(18),i=n(735);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,'.editor-toolbar {\r\n    position: relative;\r\n    background: #FFFFFF;\r\n    box-shadow: 0 2px 4px 0 transparent;\r\n    transition: box-shadow .3s ease-in-out;\r\n    width: 100%;\r\n    text-align: center;\r\n    cursor: default;\r\n    height: 32px;\r\n}\r\n.editor-toolbar .toolbar-wrap{\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    position: relative;\r\n    box-sizing: border-box;\r\n    height: 32px;\r\n}\r\n.editor-toolbar .roll-btn {\r\n    display: none;\r\n    align-items: center;\r\n    justify-content: center;\r\n    position: absolute;\r\n    top: 0;\r\n    bottom: 0;\r\n    z-index: 2;\r\n    width: 28px;\r\n    background: #FFFFFF;\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn {\r\n    display: flex;\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn:before {\r\n    content: "";\r\n    position: absolute;\r\n    top: 5px;\r\n    bottom: 5px;\r\n    width: 16px;\r\n}\r\n\r\n.editor-toolbar.show-roll-btn .roll-btn.left-btn {\r\n    left: 0;\r\n    box-shadow:3px 0 4px -3px #a3a3a3\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn.left-btn:before {\r\n    right: 0;\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn.left-btn:after {\r\n    content: "";\r\n    border-color: transparent #BCBCBC transparent transparent;\r\n    border-style: solid solid solid none;\r\n    border-width: 5px 5px 5px 0;\r\n}\r\n\r\n.editor-toolbar.show-roll-btn .roll-btn.right-btn {\r\n    right: 0;\r\n    box-shadow:-3px 0 4px -3px #a3a3a3\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn.right-btn:before {\r\n    left: 0;\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn.right-btn:after {\r\n    content: "";\r\n    border-color: transparent transparent transparent #BCBCBC;\r\n    border-style: solid none solid solid;\r\n    border-width: 5px 0 5px 5px;\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn.left-btn:active:after {\r\n    border-color: transparent #565656 transparent transparent;\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn.right-btn:active:after{\r\n    border-color: transparent transparent transparent #565656;\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn:before {\r\n    content: "";\r\n    position: absolute;\r\n    top: 5px;\r\n    bottom: 5px;\r\n    width: 16px;\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn.disabled {\r\n    opacity: 1;\r\n    pointer-events: none;\r\n}\r\n.editor-toolbar.show-roll-btn .roll-btn.disabled:after, .editor-toolbar.show-roll-btn .roll-btn.disabled:before {\r\n    opacity: .3;\r\n}\r\n\r\n.editor-toolbar.show-roll-btn .toolbar-wrap{\r\n    justify-content: left;\r\n    padding: 0 24px;\r\n}\r\n',""]),e.exports=t},function(e,t,n){var r=n(18),i=n(737);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".pango-editor-button {\r\n    position: relative;\r\n    display: inline-flex;\r\n    border-radius: 2px;\r\n    flex-shrink: 0;\r\n    margin: 0 2px;\r\n    height: 24px;\r\n    width: 24px;\r\n    justify-content: center;\r\n    border: none;\r\n    outline: none;\r\n    background-color: transparent;\r\n    align-items: center;\r\n    transition: background-color 150ms;\r\n}\r\n.pango-editor-button .icon {\r\n    color: #565656;\r\n    font-size: 14px;\r\n}\r\n.pango-editor-button:not(.disabled):hover,\r\n.pango-editor-button:not(.disabled).active,\r\n.pango-editor-button:not(.disabled).selected\r\n{\r\n    background-color: rgba(25,55,88,.1);\r\n    outline:none;\r\n    border: none;\r\n}\r\n.pango-editor-button.disabled {\r\n    outline:none;\r\n    opacity: .3;\r\n    pointer-events: inherit;\r\n}\r\n",""]),e.exports=t},function(e,t,n){var r=n(18),i=n(739);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,'.multiSelectContainer {\r\n    position: relative;\r\n    display: inline-block;\r\n    height: 24px;\r\n    line-height: 24px;\r\n    width: max-content;\r\n    z-index: 1;\r\n    box-sizing: border-box;\r\n    border-radius: 2px;\r\n    color: #000;\r\n    outline: none;\r\n    transition: border-color .2s cubic-bezier(.645, .045, .355, 1), box-shadow .2s cubic-bezier(.645, .045, .355, 1);\r\n}\r\n.multiSelectContainer.hover {\r\n    background-color: rgba(25,55,88,.1);\r\n}\r\n.multiSelectContainer i {\r\n    font-style: normal;\r\n}\r\n.multiSelectContainer .disable_ms {\r\n    pointer-events: none;\r\n    opacity: 0.5;\r\n}\r\n.multiSelectContainer .searchWrapper {\r\n    width: max-content;\r\n    border: 1px solid #cccccc;\r\n    border-radius: 4px;\r\n    padding: 5px;\r\n    min-height: 22px;\r\n    position: relative;\r\n}\r\n.multiSelectContainer input.inputValueBox {\r\n    width: 0;\r\n    padding: 0;\r\n    border: none;\r\n    background: transparent;\r\n}\r\n.multiSelectContainer input.inputValueBox:focus {\r\n    outline: none;\r\n}\r\n.multiSelectContainer .chip {\r\n    display: inline-block;\r\n    margin: 0 2px;\r\n    padding-left: 10px;\r\n    background: #EAEEFE;\r\n    font-size: 12px;\r\n    color: #2D5AFA;\r\n    overflow: hidden;\r\n    text-overflow:ellipsis;\r\n    white-space: nowrap;\r\n}\r\n.multiSelectContainer .singleChip {\r\n    background: none;\r\n    border-radius: 0;\r\n    color: inherit;\r\n    white-space: nowrap;\r\n    text-overflow:ellipsis;\r\n    overflow: hidden;\r\n    width: 48px;\r\n}\r\n.dropdown-fontsize .singleChip {\r\n    width: 10px;\r\n}\r\n.multiSelectContainer  i.icon_arrow {\r\n    pointer-events: none;\r\n    font-size: 12px;\r\n    transform: scale(.6);\r\n    transition: transform 0.2s linear;\r\n    color: #7e89a4;\r\n}\r\n.multiSelectContainer  i.icon_arrow.active {\r\n    transform: scale(.6) rotate(180deg);\r\n    border: none;\r\n}\r\n.closeIcon {\r\nfont-size: 12px;\r\nfloat: right;\r\nmargin-left: 2px;\r\ncursor: pointer;\r\n}\r\n.optionListContainer {\r\nposition: absolute;\r\nwidth: auto;\r\nbackground: #fff;\r\nborder-radius: 4px;\r\nmargin-top: 4px;\r\nz-index: 2;\r\n}\r\n.multiSelectContainer ul {\r\ndisplay: block;\r\npadding: 0;\r\nmargin: 0;\r\nborder-radius: 4px;\r\nmax-height: 250px;\r\noverflow-y: auto;\r\n}\r\n.multiSelectContainer ul::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n.multiSelectContainer ul::-webkit-scrollbar-thumb {\r\n    border-left: 1px solid #ffffff;\r\n    border-right: 2px solid #ffffff;\r\n    border-radius: 4px;\r\n    background: rgba(58,58,58,0.4);\r\n}\r\n.multiSelectContainer ul::-webkit-scrollbar-track-piece {\r\n background: transparent;\r\n}\r\n.multiSelectContainer ul::-webkit-scrollbar-track {\r\n    background: #FFFFFF;\r\n}\r\n.multiSelectContainer li {\r\npadding: 6px 10px;\r\n}\r\n.multiSelectContainer li:hover {\r\n    background:  #ECF0F4;\r\ncursor: pointer;\r\n}\r\n.checkbox {\r\nmargin-right: 10px;\r\n}\r\n.disableSelection {\r\npointer-events: none;\r\nopacity: 0.5;\r\n}\r\n.highlightOption {\r\nbackground: rgba(25,55,88,.1);\r\n}\r\n.displayBlock {\r\n    display: block;\r\n    position: absolute;\r\n    background: #ffffff;\r\n    min-width: 90px;\r\n    border-radius: 4px;\r\n    z-index: 2000;\r\n    color: #565656;\r\n    line-height: 1.4;\r\n    text-align: justify;\r\n    font-size: 13px;\r\n    box-shadow: 0 2px 4px 0 rgba(0,0,0,0.12);\r\n    word-break: break-all;\r\n    overflow: hidden;\r\n}\r\n.displayNone {\r\n    display: none;\r\n}\r\n.notFound {\r\npadding: 10px;\r\ndisplay: block;\r\n}\r\n.singleSelect {\r\n    display: flex;\r\n    align-items: center;\r\npadding-right: 4px;\r\n}\r\nli.groupHeading {\r\ncolor: #908e8e;\r\npointer-events: none;\r\npadding: 5px 15px;\r\n}\r\nli.groupChildEle {\r\npadding-left: 30px;\r\n}\r\n.icon_cancel_circled:before {\r\ncontent: "\\e800";\r\n}\r\n.icon_cancel:before {\r\n    content: "\\2716";\r\n}\r\n\r\n',""]),e.exports=t},function(e,t,n){var r=n(18),i=n(741);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,'.editor-separator {\r\n    display: inline-block;\r\n    position: relative;\r\n    margin: 0 4px;\r\n    box-sizing: border-box;\r\n    height: 20px;\r\n}\r\n.editor-separator:before {\r\n    content: "";\r\n    position: absolute;\r\n    width: 1px;\r\n    background-color: #C8D0D8;\r\n    height: 100%;\r\n}\r\n',""]),e.exports=t},function(e,t,n){var r=n(18),i=n(743);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".tablePick-title {\r\n    font-size: 12px;\r\n    height: 22px;\r\n    border-bottom: 1px solid #e2e6ed;\r\n    box-sizing: border-box;\r\n    margin: 10px 20px 0 20px;\r\n}\r\n.tablePick-table {\r\n    margin: 10px 20px 20px 20px;\r\n    cursor: default;\r\n}\r\n.tablePick-table .row {\r\n    display: flex;\r\n    margin-bottom: 6px;\r\n}\r\n.tablePick-table .row:last-child {\r\n    margin-bottom: 0;\r\n}\r\n.tablePick-table .row .col {\r\n    width: 16px;\r\n    height: 16px;\r\n    border: 1px solid #e2e6ed;\r\n    background: #FFFFFF;\r\n    box-sizing: border-box;\r\n    margin-right: 6px;\r\n}\r\n.tablePick-table .row .col:last-child {\r\n    margin-right: 0;\r\n}\r\n.tablePick-table .row .col.active {\r\n    border: 1px solid rgba(73,145,242,.2);\r\n    background-color: rgba(73,145,242,.15);\r\n}\r\n.toolbar-btn:hover {\r\n    background-color: rgba(25,55,88,.1);\r\n}\r\n.toolbar-btn .icon,.toolbar-btn .icon_arrow {\r\n    display: inline-block;\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 14px;\r\n    color: #333;\r\n    text-align: center;\r\n    line-height: 24px;\r\n}\r\n.toolbar-btn .icon_arrow {\r\n    color: #7e89a4;\r\n    width: 12px;\r\n    font-size: 12px;\r\n    transform: scale(.6);\r\n    transition: transform 0.2s linear;\r\n}\r\n.toolbar-btn .icon_arrow.active {\r\n    transform: scale(.6) rotate(180deg);\r\n    border: none;\r\n}",""]),e.exports=t},function(e,t,n){var r=n(18),i=n(745);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".toolbar-btn {\r\n    width: 36px;\r\n    height: 24px;\r\n    flex-shrink: 0;\r\n}\r\n.toolbar-btn:hover {\r\n    background-color: rgba(25,55,88,.1);\r\n}\r\n.toolbar-btn .icon,.toolbar-btn .icon_arrow {\r\n    display: inline-block;\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 14px;\r\n    color: #565656;\r\n    text-align: center;\r\n    line-height: 24px;\r\n    vertical-align: middle;\r\n}\r\n.toolbar-btn .icon_arrow {\r\n    color: #7e89a4;\r\n    width: 12px;\r\n    font-size: 12px;\r\n    transform: scale(.6);\r\n    transition: transform 0.2s linear;\r\n    vertical-align: middle;\r\n}\r\n.toolbar-btn .icon_arrow.active {\r\n    transform: scale(.6) rotate(180deg);\r\n    border: none;\r\n}",""]),e.exports=t},function(e,t,n){var r=n(18),i=n(747);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".component-color-panel-wrap {\r\n    font-size: 12px;\r\n    color: #3d4757;\r\n    max-width: 240px;\r\n    cursor: default;\r\n    background: #fff;\r\n}\r\n.component-menu {\r\n    display: flex;\r\n    padding: 4px;\r\n    overflow-x: hidden;\r\n    overflow-y: auto;\r\n    box-shadow: 0 2px 12px 0 rgba(56,56,56,.2);\r\n    border-radius: 2px;\r\n    cursor: default;\r\n}\r\n.component-menu .menu-content {\r\n    position: relative;\r\n    flex-grow: 1;\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n.component-color-panel .color-group-selected:hover {\r\n    background: rgba(25,55,88,.04);\r\n    border-radius: 2px;\r\n}\r\n.component-color-panel .color-group-selected {\r\n    padding: 8px;\r\n}\r\n.component-color-panel .color-item:first-child {\r\n    margin-left: 0;\r\n}\r\n.component-color-panel .color-item {\r\n    display: inline-block;\r\n    vertical-align: middle;\r\n    box-sizing: border-box;\r\n    width: 16px;\r\n    height: 16px;\r\n    margin-left: 6px;\r\n    border: 1px solid #e2e6ed;\r\n}\r\n.component-color-panel .color-item.selected, .component-color-panel .color-item:hover {\r\n    box-shadow: 0 0 0 1px #fff, 0 0 0 2px #e2e6ed;\r\n}\r\n.component-color-panel .color-group-selected .title {\r\n    padding-left: 8px;\r\n    vertical-align: middle;\r\n}\r\n\r\n.component-color-panel .color-group-theme {\r\n    padding: 0 8px 16px;\r\n}\r\n.component-color-panel .color-group-theme .item-group:first-child {\r\n    margin-top: 4px;\r\n    margin-bottom: 16px;\r\n}\r\n.component-color-panel .color-group-theme .item-group {\r\n    margin-top: 6px;\r\n    white-space: nowrap;\r\n    text-align: center;\r\n}\r\n.component-color-panel .color-item.white {\r\n    border: 1px solid #e2e6ed;\r\n}\r\n\r\n.component-color-panel .color-group-standard {\r\n    padding: 0 0 16px;\r\n    text-align: center;\r\n}\r\n.component-color-panel .color-group-standard .text {\r\n    color: #767c85;\r\n    line-height: 16px;\r\n    margin-bottom: 12px;\r\n    text-align: left;\r\n    padding-left: 6px;\r\n}\r\n.toolbar-btn.color-btn {\r\n    position: relative;\r\n}\r\n.toolbar-btn.color-btn .underline {\r\n    position: absolute;\r\n    display: inline-block;\r\n    bottom: 3px;\r\n    left: 4px;\r\n    width: 16px;\r\n    height: 4px;\r\n    background-color: #565656;\r\n    border: 1px solid #ccc;\r\n    box-sizing: border-box;\r\n}\r\n.toolbar-btn:hover {\r\n    background-color: rgba(25,55,88,.1);\r\n}\r\n.toolbar-btn .icon,.toolbar-btn .icon_arrow {\r\n    display: inline-block;\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 14px;\r\n    color: #565656;\r\n    text-align: center;\r\n    line-height: 24px;\r\n}\r\n.toolbar-btn .icon_arrow {\r\n    width: 12px;\r\n    font-size: 12px;\r\n    transform: scale(.6);\r\n    transition: transform 0.2s linear;\r\n}\r\n.toolbar-btn .icon_arrow.active {\r\n    transform: scale(.6) rotate(180deg);\r\n    border: none;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.standardColorList=t.themeColorList=t.autoColor=void 0,t.autoColor="rgb(0,0,0)",t.themeColorList=[["rgb(255, 255, 255)","rgb(0, 0, 0)","rgb(231, 230, 230)","rgb(68, 84, 106)","rgb(91, 155, 213)","rgb(237, 125, 49)","rgb(165, 165, 165)","rgb(255, 192, 0)","rgb(68, 114, 196)","rgb(112, 173, 71)"],["rgb(242, 242, 242)","rgb(128, 128, 128)","rgb(208, 206, 206)","rgb(214, 220, 229)","rgb(222, 235, 247)","rgb(251, 229, 214)","rgb(237, 237, 237)","rgb(255, 242, 204)","rgb(218, 227, 243)","rgb(226, 240, 217)"],["rgb(217, 217, 217)","rgb(89, 89, 89)","rgb(175, 171, 171)","rgb(173, 185, 202)","rgb(189, 215, 238)","rgb(248, 203, 173)","rgb(219, 219, 219)","rgb(255, 230, 153)","rgb(180, 199, 231)","rgb(197, 224, 180)"],["rgb(191, 191, 191)","rgb(64, 64, 64)","rgb(118, 113, 113)","rgb(132, 151, 176)","rgb(157, 195, 230)","rgb(244, 177, 131)","rgb(201, 201, 201)","rgb(255, 217, 102)","rgb(143, 170, 220)","rgb(169, 209, 142)"],["rgb(166, 166, 166)","rgb(38, 38, 38)","rgb(59, 56, 56)","rgb(51, 63, 80)","rgb(46, 117, 182)","rgb(197, 90, 17)","rgb(124, 124, 124)","rgb(191, 144, 0)","rgb(47, 85, 151)","rgb(84, 130, 53)"],["rgb(127, 127, 127)","rgb(13, 13, 13)","rgb(24, 23, 23)","rgb(34, 42, 53)","rgb(31, 78, 121)","rgb(132, 60, 11)","rgb(83, 83, 83)","rgb(127, 96, 0)","rgb(32, 56, 100)","rgb(56, 87, 35)"]],t.standardColorList=["rgb(192, 0, 0)","rgb(255, 0, 0)","rgb(255, 192, 0)","rgb(255, 255, 0)","rgb(146, 208, 80)","rgb(0, 176, 80)","rgb(0, 176, 240)","rgb(0, 112, 192)","rgb(0, 32, 96)","rgb(112, 48, 160)"]},function(e,t,n){var r=n(18),i=n(750);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".sc-picker {\r\n    width: 164px;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    box-sizing: border-box;\r\n    padding: 10px;\r\n    cursor: default;\r\n}\r\n.sc-picker span {\r\n    display: inline-block;\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 12px;\r\n    line-height: 24px;\r\n    text-align: center;\r\n}\r\n.sc-picker span:hover {\r\n    background:  #ECF0F4;\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SeparatorLine=void 0;const r=n(353),i=n(27);class l extends i.BaseControl{constructor(e,t){super(e,t),this.Component=new r.SeparatorLineComp(e,this.InitProps)}DefaultProps(){return{onClick:function(){}}}}t.SeparatorLine=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableButton=void 0;const r=n(27),i=n(354);class l extends r.BaseControl{constructor(e,t,n){super(e,t),this.id=t.id,this.InitProps.onSelect=(e,t)=>{n.L_ExecuteCommand(this.id,[{lineNumberString:t,columnNumberString:e}])},this.Component=new i.TableButtonComp(e,this.InitProps)}DefaultProps(){return{}}}t.TableButton=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialCharsButton=void 0;const r=n(27),i=n(355);class l extends r.BaseControl{constructor(e,t,n){super(e,t),this.id=t.id,this.InitProps.onSelect=e=>{n.L_ExecuteCommand(this.id,[e])},this.Component=new i.SpecialCharsButtonComp(e,this.InitProps)}DefaultProps(){return{}}}t.SpecialCharsButton=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocEditableCanvas=void 0;const r=n(755),i=n(26),l=n(2),s=n(403),o=n(70),a=n(246),u=n(59),h=n(62),d=n(0),c=n(10),p=n(1088),f=n(1090),g=n(1092),m=n(1094),E=n(9),C=n(1095),A=n(183),y=n(1096),I=n(1097),S=n(377),_=n(337),w=n(1104),b=n(415),x=n(1160),P=n(1163),v=n(1164),T=n(121),M=n(131),L=n(1168),D=n(1169),R=n(1170),F=n(95),N=n(46),B=n(17),k=n(248),O=n(6);class G extends I.QiPageCanvas{constructor(e=l.ENumWorkMode.Design,t=l.ENumViewMode.Init,n,s,o,u,h,d){super(n,s,o),this.xdocsUtil=null,this.xpageBuilder=null,this.eleEvtModel=null,this.msKbEvtMounter=null,this.edtMsKbEvtHandler=null,this.browMsKbEvtHandler=null,this.mntEleEvtHandler=null,this.edtEleEvtHandler=null,this.browEleEvtHandler=null,this.actMgr=null,this.undoMgr=null,this.edtCaret=null,this._unfocus=!1,this._AlwaysCenter=!1,this._HeaderEditable=!0,this._xmlOnLoadHandFlag=!1,this._moveCaretWithImportDoc=!0,this._validateDialog=null,this._validateList=null,this.printFlag=!1,this.AlwaysCenter=1==d,this.xdocsUtil=new y.EditorXDocsUtil(this.canvasKey),this.xpageBuilder=new a.XPageViewBuilder,this.actMgr=new r.XActionManager(this),this.undoMgr=new C.UndoableManager,this.eleEvtModel=new f.ElementEvtModel(this,e,t),this._actionHandler=new D.ActionHandler(this),this.statusBar=new v.StatusBar(this.ContainerDOM.querySelector("#pango-editor-statusBar"),{showWorkMode:u,showZoom:h,workMode:e,onZoomChange:this.OnZoomChange.bind(this)}),this.customEvtGrp=new p.EdtCanvasCustomEvtGrp(this),this.rightMenu=R.RightMenuFactory.GetInstance(this),this._emrDocView=new _.EmrDocView(this),this.defaultSetting=i.TextDocInitInfo.GetInstance(),this.defaultSetting.IsShowRule&&this._emrDocView.ShowRuler(),this.hideMsgBox=this.defaultSetting.HideMsgBox,this.msKbEvtMounter=new g.MouseKbEvtMounter(this),this.edtMsKbEvtHandler=new w.EditorMsKBEvtHandler,this.edtEleEvtHandler=new b.EditorEleEvtHandler(this),this.browMsKbEvtHandler=new x.BrowseMsKBEvtHandler,this.browEleEvtHandler=new P.BrowseEleEvtHandler(this),this.SwitchEvtHandler(),k.XCommentArea.Edtor=this,this.OnScrollEvent=this.ScrollEventHandler.bind(this),this.edtCaret=new m.XDocEditorCaret(this),this.graphics.EditableCanvas=this}changWorkMode(e){if(this.statusBar&&(this.statusBar.WorkMode=e),this.ToolBar){let t=!0;e!=l.ENumWorkMode.KeepTrace&&e!=l.ENumWorkMode.Browse&&e!=l.ENumWorkMode.PrintPreview||(t=!1),this.ToolBar.SetToolBarEditable(t)}}get ToolBar(){return this.toolbar}get M_rightMenu(){return this.rightMenu}get M_emrDocView(){return this._emrDocView}set M_PageCntPerRow(e){super.MPageCntPerRow=e}get M_IsWebView(){return super.MIsWebView}set M_IsWebView(e){super.MIsWebView=e}get PasteXtextLabelTotext(){return this._pasteXtextLabelTotext}set PasteXtextLabelTotext(e){this._pasteXtextLabelTotext=e}get ConsecutiveDocBottom(){return this._consecutiveDocBottom}set ConsecutiveDocBottom(e){this._consecutiveDocBottom=e}get VisibleRect(){return this.visibleRect}get M_XDocsUtil(){return this.xdocsUtil}get M_EleEvtModel(){return this.eleEvtModel}get M_EleEvtHandler(){return this.mntEleEvtHandler}get M_EdtCustomEvtGrp(){return this.customEvtGrp}get M_UndoMgr(){return this.undoMgr}get M_EdtLoginUserInfo(){return this.eleEvtModel.LoginUsrInfo}get M_EdtCaret(){return this.edtCaret}get unfocus(){return this._unfocus}set unfocus(e){this._unfocus=e}get AlwaysCenter(){return this._AlwaysCenter}set AlwaysCenter(e){this._AlwaysCenter=e}get HeaderEditable(){return this._HeaderEditable}set HeaderEditable(e){this._HeaderEditable=e}get XmlOnLoadHandFlag(){return this._xmlOnLoadHandFlag}set XmlOnLoadHandFlag(e){this._xmlOnLoadHandFlag=e}get MoveCaretWithImportDoc(){return this._moveCaretWithImportDoc}set MoveCaretWithImportDoc(e){this._moveCaretWithImportDoc=e}get ValidateDialog(){return this._validateDialog}set ValidateDialog(e){this._validateDialog=e}get ValidateList(){return this._validateList}set ValidateList(e){this._validateList=e}get M_CaretEleStyle(){return this.edtCaret.CaretEleStyle}get DefaultSetting(){return this.defaultSetting}set DefaultSetting(e){this.defaultSetting=e}get HideMsgBox(){return this.hideMsgBox}set HideMsgBox(e){this.hideMsgBox=e}get M_StatusBar(){return this.statusBar}_GenTmpCanvasKey(){return"pango-editor-content-"+this.ContainerDOM.id}get M_ActionHandler(){return this._actionHandler}get All_Document(){return this.M_XDocsUtil.MGet_Documents()}get M_DocumentFirst(){return this.M_XDocsUtil.MGet_Document(0)}get M_Xdoc(){return null==this.xpageBuilder.GetXDocWrap(0)?null:this.xpageBuilder.GetXDocWrap(0).FirstXDoc}get M_DocumentFocused(){let e=this.eleEvtModel.EleClicked,t=this.M_XDocsUtil.MGet_Document(null,e);return null==t&&(t=this.M_Xdoc),t}get ParagraphIndex(){let e=this.eleEvtModel.EleClicked;if(!e)return;this.getTopParent(e);let t=this.topElement,n=t.Parent,r=-1;for(let e of n.ChildEleList)if(r++,e.GrpID==t.GrpID)return r;return r}getTopParent(e){let t=e.Parent;t instanceof d.XDocPanel?this.topElement=e:this.getTopParent(t)}get M_PageFocused(){return this.eleEvtModel.EleClickedWrap.PageFocused}get M_EleFocused(){return this.eleEvtModel.EleClicked}get M_LineFocused(){return null==this.eleEvtModel.EleClicked?null:this.eleEvtModel.EleClicked.OwnerLine}SwitchEvtHandler(){let e=null,t=null;switch(this.customEvtGrp.OnCursorEleChanged=this.OnCursorEleChanged.bind(this),this.customEvtGrp.OnSelRangeChanged=this.OnSelRangeChanged.bind(this),this.customEvtGrp.OnEleStyleChanged=this.OnEleStyleChanged.bind(this),this.customEvtGrp.OnXDocLoaded=this.OnXDocLoaded.bind(this),this.M_EleEvtModel.WorkMode){case l.ENumWorkMode.Design:case l.ENumWorkMode.Form:case l.ENumWorkMode.App:e=this.edtMsKbEvtHandler,t=this.edtEleEvtHandler;break;case l.ENumWorkMode.KeepTrace:case l.ENumWorkMode.PrintPreview:case l.ENumWorkMode.Browse:e=this.browMsKbEvtHandler,t=this.browEleEvtHandler}this.msKbEvtMounter.MountEvtHandler(e),this.mntEleEvtHandler=t,this._ReInitResx(!0)}RegActionExt(e){return this.actMgr.RegActionExt(e)}M_GetActionByName(e){return this.actMgr.GetActionByName(e)}M_GetActionByHotKey(e,t){return this.actMgr.GetActionByHotKey(e,t)}MGetEleByPos(e,t,n){let r=this.xpageBuilder.GetFullPageList();if(null!=r&&r.Count()>0){let i=n.target.srcPage,l=e.ClickPosInCtrl,s=0,o=null;for(let e of r){let t=e.PageRect.Clone();if(t.Location=e.PageLocationUI,t.Contains(l.X,l.Y)){o=e;break}if(i==e){o=e;break}s++}null!=o&&(this.M_EleEvtModel.ActivePageIx=s,o.GetEleAtCtrlPos(e,t),e.PageFocused=o.PageView)}}M_GetHandlerLayerMgr(){let e=this.msKbEvtMounter.EvtHandler;return null==e?null:e.HandlerLayerMgr}get M_GetMsKbEvtMounter(){return null==this.msKbEvtMounter?null:this.msKbEvtMounter}After_HScrollEvt_Handled(e){this._emrDocView.OnScrollValChanged(e)}After_VScrollEvt_Handled(e){super.After_VScrollEvt_Handled(e)}MSetScrollToEleRect(e,t){if(this.SetVisibleRect(),null==e||null==e.OwnerLine)return!1;const n=this.visibleRect;if(n.Width<=0||n.Height<=0)return!1;const r=super.MGetZoomRatio();t.X==E.RectangleF.Empty.X&&t.Y==E.RectangleF.Empty.Y&&t.Width==E.RectangleF.Empty.Width&&t.Height==E.RectangleF.Empty.Height&&(t=u.ClickedElementWrapper.GetEleRectInCtrl(e,this.M_PageFocused,r));let i=c.DPITransUtil.TransFloatVal(e.OwnerLine.Height,300,96);i*=r;let l=-1,s=-1;const o=Math.ceil(t.Width);if(t.X-o<=n.X){const e=n.X-(t.X-o);l=Math.ceil(n.X-e)}else if(t.Right>n.Right){const e=t.Right-n.Right;l=Math.ceil(n.X+e)}const a=Math.ceil(i),h=i-t.Height,d=t.Y-h;if(d<n.Y){const e=n.Y-d;s=Math.ceil(n.Y-e)}else if(t.Bottom+8+a>n.Bottom){const e=t.Bottom+a-n.Bottom;s=Math.ceil(n.Y+e+8)}let p=l>=0||s>=0;return p&&(super.MSetScrollValue(l,s),t=u.ClickedElementWrapper.GetEleRectInCtrl(e,this.M_PageFocused,r)),p}RefreshCmmtShowStatus(){let e=this.M_XDocsUtil.MGet_Documents(),t=null==e?0:e.length;if(0==t)return;let n=!1;for(let r=0;r<t;r++){let t=e[r].GetPageFmt(),i=this.MGetPageFmt(r);null!=i&&t.ShowCmmtArea!=i.ShowCmmtArea&&(i.ShowCmmtArea=t.ShowCmmtArea,n=!0)}n?super.MReCalcLayout(!0):super.Invalidate()}RefreshPageSelRange(e,t){let n=this.eleEvtModel.EleClickedWrap.PageFocused;if(null==n)return;if(this.xpageBuilder.GetFullPageList().ToArray().forEach(t=>{t instanceof S.XPageViewPainter&&null!=t&&t.PageView.ClearSelRects(e)}),n.FirstPage.ClearSelRects(e),null==t||0==t.length)return void super.Invalidate();let r=this.eleEvtModel.EleClicked;if(null==r)return;let i=t[0].Line,l=r.IsInHeadFooterPanel,s=l?n:i.PageView;if(null==s)return;let o=this.eleEvtModel.EleClickedWrap.EleFocusedPgPanelTp;for(let n=0;n<t.length;n++){let r=t[n].Line;if(l||r.PageView==s){let r=[...t];r.splice(0,n);const i=s.FiltLineSelRects(o,r);s.SetSelRects(e,i),s=s.NextPage}if(null==s)break}super.Invalidate()}MGetPageViewList(){return this.xpageBuilder.GetFullPageList().ToArray()}MGetPageView(e){return this.xpageBuilder.GetPageView(e)}MGetPageFmt(e=0){return this.xpageBuilder.GetPageFmt(e)}MRefreshDocViewBetweenEle(e,t){let n=this.M_PageFocused,r=null==n?-1:n.DocArgs.DocIx,i=this.M_EleFocused,l=this.M_XDocsUtil.MGet_Document(null,i);null==l&&(null!=n&&(l=n.Document),null==l)||(l.hasExpessionToRefreshDocView?this.MRefreshDocView():r<0&&(r=this.xpageBuilder.GetXDocWrapIx(l),r<0)||(l.RefreshLinesBetweenEle(e,t,super.MShowAsPrint),this.RebuildPage(r)))}RebuildPage(e){for(let t=0;t<this.xpageBuilder.XDocWrapCnt;t++){let n=t,r=this.xpageBuilder.RebuildXDocPageView(n);e==n&&this.customEvtGrp.DocChanged&&this.IsEditableWorkMode&&this.customEvtGrp.DocChanged(r)}this.ClearCmmtArea();let t=this.xpageBuilder.GetFullPageList();super.MSetPageList(t,!1),this.eleEvtModel.RestEleWrapRefPage(),this.RefreshSelecRect(t),super.MReCalcLayout(!0)}MRefreshDocViewWithLineRange(e,t){let n=this.M_PageFocused,r=null==n?-1:n.DocArgs.DocIx,i=this.M_EleFocused,l=this.M_XDocsUtil.MGet_Document(null,i);if(null==l&&(null!=n&&(l=n.Document),null==l))return;if(r<0&&(r=this.xpageBuilder.GetXDocWrapIx(l),r<0))return;l.RefreshLinesWithBodyLineRange(e,t,super.MShowAsPrint);let s=this.xpageBuilder.RebuildXDocPageView(r);this.customEvtGrp.DocChanged&&this.IsEditableWorkMode&&this.customEvtGrp.DocChanged(s);let o=this.xpageBuilder.GetFullPageList();super.MSetPageList(o,!1),this.eleEvtModel.RestEleWrapRefPage(),this.RefreshSelecRect(o),super.MReCalcLayout(!0)}MRefreshDocView(e,t){let n,r,i,l;if(e instanceof h.XTextDocument?(n=e,r=!0):!1!==e&&(r=!0),null!=t&&(r=t),null==n){let e=this.M_PageFocused;i=null==e?-1:e.DocArgs.DocIx;let t=this.M_EleFocused;if(l=this.M_XDocsUtil.MGet_Document(null,t),null==l&&(null!=e&&(l=e.Document),null==l))return;if(i<0&&(i=this.xpageBuilder.GetXDocWrapIx(l),i<0))return}else l=n,i=this.xpageBuilder.GetXDocWrapIx(n);l.RefreshLines(super.MShowAsPrint);let s=this.xpageBuilder.RebuildXDocPageView(i);this.customEvtGrp.DocChanged&&r&&this.IsEditableWorkMode&&this.customEvtGrp.DocChanged(s),this.ClearCmmtArea();let o=this.xpageBuilder.GetFullPageList();super.MSetPageList(o,!1),this.eleEvtModel.RestEleWrapRefPage(),this.RefreshSelecRect(o),super.MReCalcLayout(!0)}MRefreshDocsView(){this.ClearCmmtArea();for(let e=0;e<this.xpageBuilder.XDocWrapCnt;e++){let t=e,n=this.xpageBuilder.GetXDocWrap(e).GetXDocs();for(let e=0;e<n.length;e++){let t=n[e];if(null==t)return;if(super.MShowAsPrint&&null!=t.GetPageFmt().PrtPaperWidth)if(t.GetPageFmt().IsZoomPaperPrt){this.printFlag=!0;let e=t.GetPageFmt().PrtPaperWidth/t.GetPageFmt().Width;this.MSetZoomRatio(e,!0)}else t.GetPageFmt().WorkModeWidth=t.GetPageFmt().Width,t.GetPageFmt().WorkModeHeight=t.GetPageFmt().Height,t.GetPageFmt().WorkModePaperKind=t.GetPageFmt().PaperKind,t.GetPageFmt().Width=t.GetPageFmt().PrtPaperWidth,t.GetPageFmt().Height=t.GetPageFmt().PrtPaperHeight,t.GetPageFmt().PaperKind=t.GetPageFmt().PrtPaperKind;else super.MShowAsPrint||null==t.GetPageFmt().WorkModeWidth||(this.MSetZoomRatio(this.printFlag?1:this.MGetZoomRatio(),!0),t.GetPageFmt().Width=t.GetPageFmt().WorkModeWidth,t.GetPageFmt().Height=t.GetPageFmt().WorkModeHeight,t.GetPageFmt().PaperKind=t.GetPageFmt().WorkModePaperKind,this.printFlag=!1);t.RefreshLines(super.MShowAsPrint)}let r=this.xpageBuilder.RebuildXDocPageView(t);this.customEvtGrp.DocChanged&&this.IsEditableWorkMode&&this.customEvtGrp.DocChanged(r)}let e=this.xpageBuilder.GetFullPageList();super.MSetPageList(e,!1),this.eleEvtModel.RestEleWrapRefPage(),this.RefreshSelecRect(e),super.MReCalcLayout(!0)}get IsEditableWorkMode(){let e=this.eleEvtModel.WorkMode;return e!=l.ENumWorkMode.KeepTrace&&e!=l.ENumWorkMode.PrintPreview&&e!=l.ENumWorkMode.Browse}MSetZoomRatio(e,t){super.MSetZoomRatio(e,t),this.statusBar.Zoom=e,this._emrDocView.tmpCanvas_NotifyZoomRChanged(e)}MCrtNewDocument(){let e=s.XDocIOInfoFactory.CrtNewXDoc(this.canvasKey);if(null==e)return null;this._ReInitResx(!0),e.IsEditable=!0,this.M_EleEvtModel.SyncWorkModelToXDoc(),this.M_EleEvtModel.SyncViewModelToXDoc(),this.M_EleEvtModel.SyncUndoMgrToXDoc();let t=new d.XTextDocumentsWrap(e);return this.xpageBuilder.AddXDocWrap(t,!0),this.M_RefreshPagesOnLoad(),this.M_EleEvtHandler.OnXDocLoaded(e,!0),e}RefreshSelecRect(e){if(null!=this.eleEvtModel.EleClicked){let t=this.eleEvtModel.EleClickedWrap.EleFocusedPgPanelTp,n=this.eleEvtModel.SelRange.InfoUtil.CalcLineRectRanges(!0),r=null,i=this.M_GetActionByName("FocusXInputEle");null!=i&&(r=i.GetLastFocusRects());let s=null==n?0:n.length,o=null==r?0:r.length;(s>0||o>0)&&e.ToArray().forEach(e=>{var i;let a=e instanceof S.XPageViewPainter?e:null;if(null!=a&&(null===(i=this.M_PageFocused)||void 0===i?void 0:i.Document)==a.PageView.Document){if(o>0){let e=a.PageView.FiltLineSelRects(t,r);a.PageView.SetSelRects(l.ENumBkgRectsType.FocusRects,e)}if(s>0){let e=a.PageView.FiltLineSelRects(t,n);a.PageView.SetSelRects(l.ENumBkgRectsType.SelRects,e)}}})}if(null!=this.eleEvtModel.EleMOver){let t=this.eleEvtModel.EleMOverWrap.EleFocusedPgPanelTp,n=null,r=this.M_GetActionByName("HoverXInputEle");null!=r&&(n=r.GetLastHoverRects());let i=null==n?0:n.length;i>0&&e.ToArray().forEach(e=>{let r=e instanceof S.XPageViewPainter?e:null;if(null!=r&&this.eleEvtModel.EleMOverWrap.EleFocused.Document==r.PageView.Document&&i>0){let e=r.PageView.FiltLineSelRects(t,n);r.PageView.SetSelRects(l.ENumBkgRectsType.HoverRects,e)}})}}DebugOpts_set_userInfo(e){if(null==e)return;const t=e.GetDebugOpts();this.M_EleEvtModel.LoginUsrInfo.CopyTo(t.OwnerInfo)}MLoadXmlDocument(e,t=!0,n){if(null==e||!e.IsValid())return null;null!=this.M_EleEvtModel.WorkMode&&(e.WorkMode=this.M_EleEvtModel.WorkMode);let r=s.XDocIOInfoFactory.LoadXDoc(this.canvasKey,e);if(null!=n&&(r.DocID=n),null==r)return null;this.DebugOpts_set_userInfo(r),this._ReInitResx(this.MoveCaretWithImportDoc),t?r.IsEditable=!0:(r.IsEditable=!1,r.Readonly=!0),this.M_EleEvtModel.SyncWorkModelToXDoc(),this.M_EleEvtModel.SyncViewModelToXDoc(),this.M_EleEvtModel.SyncUndoMgrToXDoc();let i=new d.XTextDocumentsWrap(r);this.xpageBuilder.AddXDocWrap(i,!0),this.M_RefreshPagesOnLoad(this.MoveCaretWithImportDoc);let l=r.GetPagePanel(O.ENumPagePanelTp.Header);null!=l&&(l.IsChanged=!1);let o=r.GetPagePanel(O.ENumPagePanelTp.Body);null!=o&&(o.IsChanged=!1);let a=r.GetPagePanel(O.ENumPagePanelTp.Footer);if(null!=a&&(a.IsChanged=!1),this.customEvtGrp.XmlOnLoad&&this.XmlOnLoadHandFlag&&this.customEvtGrp.XmlOnLoad(),super.MShowAsPrint&&null!=r.GetPageFmt().PrtPaperWidth)if(r.GetPageFmt().IsZoomPaperPrt){let e=r.GetPageFmt().PrtPaperWidth/r.GetPageFmt().Width;this.MSetZoomRatio(e,!0)}else{r.GetPageFmt().WorkModeWidth=r.GetPageFmt().Width,r.GetPageFmt().WorkModeHeight=r.GetPageFmt().Height,r.GetPageFmt().WorkModePaperKind=r.GetPageFmt().PaperKind,r.GetPageFmt().Width=r.GetPageFmt().PrtPaperWidth,r.GetPageFmt().Height=r.GetPageFmt().PrtPaperHeight,r.GetPageFmt().PaperKind=r.GetPageFmt().PrtPaperKind;let e=this.MGetPageFmt(0),t=r.GetDocCtxt().ViewMode.IsWebViewMode;r.GetPageFmt().TranstoQiPageFmt(e,t)}else if(!super.MShowAsPrint&&null!=r.GetPageFmt().WorkModeWidth){let e=this.MGetZoomRatio();this.MSetZoomRatio(e,!0),r.GetPageFmt().Width=r.GetPageFmt().WorkModeWidth,r.GetPageFmt().Height=r.GetPageFmt().WorkModeHeight,r.GetPageFmt().PaperKind=r.GetPageFmt().WorkModePaperKind;let t=this.MGetPageFmt(0),n=r.GetDocCtxt().ViewMode.IsWebViewMode;r.GetPageFmt().TranstoQiPageFmt(t,n)}return null!=this.M_EleEvtHandler&&this.M_EleEvtHandler.OnXDocLoaded(r,!1),r}CloseDocByDocId(e){s.XDocIOInfoFactory.CloseXDocByDocId(this.canvasKey,e),this._ReInitResx(),this.reLoadXTextDocument()}GetXDocWrapFirstDoc(){return this.xpageBuilder.GetXDocWrapFirstDoc()}MAppendXmlDocument(e,t=!1,n,r,i=null,l){if(null==e||!e.IsValid())return null;this.canvasKey;let o=s.XDocIOInfoFactory.AppendXDoc(this.canvasKey,e,r);return o.NewPage=t,null==o?null:(n?o.IsEditable=!0:(o.IsEditable=!1,o.Readonly=!0),null!=l&&(o.DocID=l),null!=i&&(o.TopMarginFlag=!0,o.TopMargin=i),this.reLoadXTextDocument(),this.customEvtGrp.XmlAppend&&this.XmlOnLoadHandFlag&&this.customEvtGrp.XmlAppend(),null!=this.M_EleEvtHandler&&this.M_EleEvtHandler.OnXDocLoaded(o,!1),o)}MAppendXmlDocuments(e){let t=[];for(let n=0;n<e.length;n++){let r=e[n],i=r.srcstr,a=r.newPage,u=r.index,h=null==r.isEditable||r.isEditable,d=null==r.topMargin?null:r.topMargin,c=r.docId,p=new o.XDocLoadParam(null,l.ENumXDocPath.LocalFile);p.SrcStr=i,null!=this.M_EleEvtModel.WorkMode&&(p.WorkMode=this.M_EleEvtModel.WorkMode);let f=s.XDocIOInfoFactory.AppendXDoc(this.canvasKey,p,u);f.NewPage=a,c&&(f.DocID=c),null!=f&&(h?f.IsEditable=!0:(f.IsEditable=!1,f.Readonly=!0),null!=d&&(f.TopMarginFlag=!0,f.TopMargin=d),t.push(f))}this.reLoadXTextDocument(),this.customEvtGrp.XmlAppends&&this.XmlOnLoadHandFlag&&this.customEvtGrp.XmlAppends();for(let e=0;e<t.length;e++){let n=t[e];null!=this.M_EleEvtHandler&&this.M_EleEvtHandler.OnXDocLoaded(n,!1)}return t}MReplaceXmlDocument(e,t){if(null==e||!e.IsValid())return null;null!=this.M_EleEvtModel.WorkMode&&(e.WorkMode=this.M_EleEvtModel.WorkMode);let n=s.XDocIOInfoFactory.ReplaceXDoc(this.canvasKey,e,t);return this.reLoadXTextDocument(),null!=this.M_EleEvtHandler&&this.M_EleEvtHandler.OnXDocLoaded(n,!1),n}reLoadXTextDocument(e,t=!0){let n=s.XDocIOInfoFactory.GetXDocsLoaded(this.canvasKey);this.xpageBuilder.Reset(),this.M_EleEvtModel.SyncWorkModelToXDoc(),this.M_EleEvtModel.SyncViewModelToXDoc(),this.M_EleEvtModel.SyncUndoMgrToXDoc();let r=[];for(let e=0;e<n.length;e++)n[e].ShowDoc&&r.push(n[e]);if(e&&e.length>0){let t=[];for(let n=0;n<r.length;n++){let i=r[n];e.indexOf(i.DocID)>-1&&t.push(i)}r=t}for(let e=0;e<r.length;e++){let t=r[e],n=t.GetPagePanel(O.ENumPagePanelTp.Body)._GetLastBaseEle();if(null!=n&&n instanceof d.XParagraphFlag&&(n.ParaghStyle.BottomMargin=this.ConsecutiveDocBottom),t.TopMarginFlag&&e>0){let n=r[e-1].GetPagePanel(O.ENumPagePanelTp.Body)._GetLastBaseEle();null!=n&&n instanceof d.XParagraphFlag&&(n.ParaghStyle.BottomMargin=t.TopMargin)}if(0==e){let e=new d.XTextDocumentsWrap(t);this.xpageBuilder.ClearShallowList(),this.xpageBuilder.AddXDocWrap(e,!1)}else if(t.NewPage){let e=new d.XTextDocumentsWrap(t);this.xpageBuilder.AddXDocWrap(e,!1)}else this.xpageBuilder.RebuildXDoc(t)}t?this.M_RefreshPagesOnLoad(!1,!0):this.xpageBuilder.RebuildFullPageViews()}MLoadXmlDocuments(e){let t=null==e?0:e.length;if(t<=0)return null;let n=s.XDocIOInfoFactory.LoadXDocs(this.canvasKey,e);if(null==n)return null;this.customEvtGrp.XmlOnLoad&&this.XmlOnLoadHandFlag&&this.customEvtGrp.XmlOnLoad(),this._ReInitResx(!0),this.M_EleEvtModel.SyncWorkModelToXDoc(),this.M_EleEvtModel.SyncViewModelToXDoc(),this.M_EleEvtModel.SyncUndoMgrToXDoc();let r=s.XDocIOInfoFactory.GetXDocsWrapLoaded(this.canvasKey);this.xpageBuilder.AddXDocWraps(r),this.M_RefreshPagesOnLoad();for(let e=0;e<t;e++)null!=n[e]&&(n[e].IsEditable=!0,this.M_EleEvtHandler.OnXDocLoaded(n[e],!1));return n}MSaveXmlDocuments(e){return s.XDocIOInfoFactory.SaveXDocs(this.canvasKey,l.ENumXDocPath.UnKnown,e)}MTryCloseDocument(){let e=s.XDocIOInfoFactory.CloseXDocs(this.canvasKey);return null==e.CodeStr&&null==e.Ex&&null==e.MsgLevel&&null==e.MsgStr&&null==e.ReturnParams?(this.MCrtNewDocument(),!0):(null==e||!e.IsWarnMsg())&&void 0}_ReInitResx(e=!0){this.undoMgr.Clear(),A.EmrFmtBrush.GetInstance().Clear(this.canvasKey),this.eleEvtModel.Clear(),e&&this._SetCursor_AtFirstEle()}_SetCursor_AtFirstEle(){let e=this.M_Xdoc;if(null==e)return;let t,n=this.eleEvtModel.WorkMode==l.ENumWorkMode.KeepTrace;if(this.eleEvtModel.WorkMode==l.ENumWorkMode.Form&&(t=this.getFirstXInputToEndBorEle()),null==t&&(t=e.GetFirstBaseChild(n)),null!=t.OwnPageView){const n=this.eleEvtModel.EleClickedWrap;n.LineEleIxFocused.SetEle(t),null==t&&(t=e.GetBodyLastChild()),n.LineEleIxFocused.SetEle(t),super.Focus(),this.eleEvtModel.MoveCaretByCursorEle(!0)}}getFirstXInputToEndBorEle(){let e;if(null==this.M_Xdoc)return null;const t=this.All_Document;for(let n=0;n<t.length;n++){const r=t[n].GetChildrenByType("XInputField",!0,!0);if(r.Count()>0){e=r.Get(0);break}}return null==e?null:e.EndEle}OnZoomChange(e){this._actionHandler.L_ExecuteCommand("ZoomPctStr",[100*e+"%"]);const t=this.customEvtGrp.ZoomChangeAfter;"function"==typeof t&&t(100*e+"%"),i.TextDocInitInfo.GetInstance().IsShowRule&&this._emrDocView.tmpCanvas_NotifyZoomRChanged(e)}OnCursorEleChanged(e,t){let n;null!=t&&null!=t.OwnPageView&&null!=t&&null!=t.OwnPageView.PageIx&&(this.statusBar.Current=t.OwnPageView.PageIx+1),this.statusBar.Total=this.MGetPageViewList().length,null==e?n=!1:null!=t&&null!=e&&null!=t.OwnerLine&&null!=e.OwnerLine&&t.OwnerLine.IndexInView==e.OwnerLine.IndexInView&&(null!=t.OwnPageView&&null!=e.OwnPageView?t.OwnPageView.PageIx==e.OwnPageView.PageIx&&(n=!0):null==t.OwnPageView&&null==e.OwnPageView&&t.OwnerDocPanel.EleTypeName==e.OwnerDocPanel.EleTypeName&&(n=!0)),n||this._emrDocView.RefreshRuler(),this.OnCursorChanged1(t)}UpdateToolbarStyle(e){if(null==e)return;let t,n=d.XDomUtil.GetNextEle(!1,e);t=null!=n?n.EleStyle:e.EleStyle;let r=this.BulidToolBarStyle(t,e.OwnerLine);return this.UpdateMemoryBtnStatus(r),r}OnCursorChanged1(e){if(null==e)return;let t=this.UpdateToolbarStyle(e);if(this.customEvtGrp.OnCursorChanged){let n,r,i,l,s,o=null;if(o=e instanceof d.XInputBorderEle&&e.IsStartBorder?d.XDomUtil.GetParentXInput(e,!0):d.XDomUtil.GetParentXInput(e),null!=o){i=null!=d.XDomUtil.GetParentCell(o),n=o.CptID,r=o.XID,l=o.GetInputTypeName(),s=o.UserEditable}let a=this.M_DocumentFocused,u={fontStyle:{bgColor:t.FontBgColor,fontColor:t.FontColor,HAlign:t.HAlign,SupSubValue:t.SupSubValue,fontName:t.FontStyle.FontName,fontSize:t.FontStyle.FontSize,IsBold:t.FontStyle.IsBold,isDrawDeleteLine:t.FontStyle.IsDrawDeleteLine,isDrawUnderLine:t.FontStyle.IsDrawUnderLine,isItatlic:t.FontStyle.IsItatlic},CurIsImage:e instanceof d.XImageEle,inputInfo:{cptId:n,xId:r,isInTable:i,inputType:l,UserEditable:s},docInfo:{docId:a.DocID,docName:a.DocName}};this.customEvtGrp.OnCursorChanged(u)}}OnSelRangeChanged(e){if(null==e||!e.IsValid())return;let t=this.BulidToolBarStyleBySelect(e);if(this.UpdateMemoryBtnStatus(t),this.customEvtGrp.OnSelectChanged){let e={fontStyle:{SupSubValue:t.SupSubValue,fontName:t.FontStyle.FontName,fontSize:t.FontStyle.FontSize,IsBold:t.FontStyle.IsBold,isDrawDeleteLine:t.FontStyle.IsDrawDeleteLine,isDrawUnderLine:t.FontStyle.IsDrawUnderLine,isItatlic:t.FontStyle.IsItatlic}};this.customEvtGrp.OnSelectChanged(e)}}BulidToolBarStyleBySelect(e){let t=e.InfoUtil.GetLineBaseElesInRange(!1,!1),n=t[0],r=new L.ToolBarStyle,i=n.EleStyle;r.FontStyle=this.BulidFontInfo(i.XFontStyle);let l,s,o=r.FontStyle.IsBold,a=r.FontStyle.IsItatlic,u=r.FontStyle.IsDrawDeleteLine,h=r.FontStyle.IsDrawUnderLine;i.Superscript||i.Subscript?i.Superscript?l="Sup":i.Subscript&&(l="Sub"):l="None";for(let e=0;e<t.length;e++){let n=t[e];if(o&&(o=n.EleStyle.XFontStyle.IsBold),a&&(a=n.EleStyle.XFontStyle.IsItalic),u&&(u=n.EleStyle.XFontStyle.IsStrikeout),h&&(h=n.EleStyle.XFontStyle.IsUnderline),n.EleStyle.Superscript||n.EleStyle.Subscript?n.EleStyle.Superscript?s="Sup":n.EleStyle.Subscript&&(s="Sub"):s="None",!(o||a||u||h||s==l)){l="None";break}}return r.FontStyle.IsBold=o,r.FontStyle.IsItatlic=a,r.FontStyle.IsDrawDeleteLine=u,r.FontStyle.IsDrawUnderLine=h,r.SupSubValue=l,r}OnEleStyleChanged(e,t){this.I_ReInitEle(),this.UpdateMemoryBtnStatus(this.BulidToolBarStyle(t,null))}OnXDocLoaded(e,t){F.EmrInnerUtil.ResetBodyXInputCache(e,this)}UpdateMemoryBtnStatus(e){if(null==e||null==this.toolbar)return;let t=this.toolbar.GetCurrentBtnElement("SetFontBold");null!=t&&(t.CommandValue=e.FontStyle.IsBold);let n=this.toolbar.GetCurrentBtnElement("SetFontItalic");null!=n&&(n.CommandValue=e.FontStyle.IsItatlic);let r=this.toolbar.GetCurrentBtnElement("SetTextUnderline");null!=r&&(r.CommandValue=e.FontStyle.IsDrawUnderLine);let i=this.toolbar.GetCurrentBtnElement("SetFontName");null!=i&&(i.CommandValue=e.FontStyle.FontName);let l=this.toolbar.GetCurrentBtnElement("SetFontSize");null!=l&&(l.CommandValue=e.FontStyle.FontSizeName);let s=this.toolbar.GetCurrentBtnElement("SetForeColor");null!=s&&(s.CommandValue=e.FontColor);let o=this.toolbar.GetCurrentBtnElement("SetBkgColor");null!=o&&(o.CommandValue=e.FontBgColor);let a=this.toolbar.GetCurrentBtnElement("SetFontStrikeout");null!=a&&(a.CommandValue=e.FontStyle.IsDrawDeleteLine);let u=this.toolbar.GetCurrenBtnGroup("SupSubGroup");if(u.length>0){let t=e.SupSubValue;if("Sub"==t)this.setGroupValue(u,"SetSubscript");else if("Sup"==t)this.setGroupValue(u,"SetSuperscript");else for(var h=0;h<u.length;h++)u[h].CommandValue=!1}let d=this.toolbar.GetCurrenBtnGroup("AlginStyleGroup");if(d.length>0&&d.length>0){let t=e.HAlign;if("Left"==t)this.setGroupValue(d,"SetAlignLeft");else if("Center"==t)this.setGroupValue(d,"SetAlignCenter");else if("Right"==t)this.setGroupValue(d,"SetAlignRight");else for(h=0;h<d.length;h++)d[h].CommandValue=!1}}setGroupValue(e,t){for(var n=0;n<e.length;n++)e[n].Props.id==t?e[n].CommandValue=!0:e[n].CommandValue=!1}BulidToolBarStyle(e,t){let n=new L.ToolBarStyle;return n.FontStyle=this.BulidFontInfo(e.XFontStyle),n.FontColor=e.ForeColor,n.FontBgColor=e.BackgroundColor,null!=t&&(n.HAlign=null==t.RelEleParagraphStyle?null:M.StyleHAlignVals.GetHAlignStrVal(t.RelEleParagraphStyle.HAlign_ENumVal)),e.Superscript||e.Subscript?e.Superscript?n.SupSubValue="Sup":e.Subscript&&(n.SupSubValue="Sub"):n.SupSubValue="None",n}BulidFontInfo(e){if(null==e)return new T.FontInfo;{let t=new T.FontInfo;return t.FontName=e.FontName,t.FontSize=e.FontSize,t.FontSizeName=e.FontSizeName,t.IsBold=e.IsBold,t.IsItatlic=e.IsItalic,t.IsDrawDeleteLine=e.IsStrikeout,t.IsDrawUnderLine=e.IsUnderline,t}}I_ReInitEle(){let e=this.M_EleEvtModel.EleClicked;if(null!=e)switch(e.EleTypeName){case"Shape":this.I_ReInitShapeEle(e)}}I_ReInitShapeEle(e){let t=e instanceof d.XShapeEle?e:null;null!=t&&(t.InitSizeByShowText(!1),this.RefreshDocView())}RefreshDocView(){null!=this.M_emrDocView&&this.MRefreshDocView()}ScrollEventHandler(e){let t,n=this.dom.scrollTop,r=this.ContainerDOM.querySelector(`#pango-editor-content-${this.ContainerDOM.id}>.pango-editor-pages canvas`).clientHeight,i=r/1125,l=this.dom.clientHeight;Object.prototype.hasOwnProperty.call(this,"EditorHeight")&&(l=this.EditorHeight);const s=r-l+17*i+40;if(n<s)t=1;else{const e=Math.abs(n-s)/(r+8.5*i);t=Math.floor(e)+2}const o=this.statusBar.Total;t>o&&(t=o),this.statusBar.Current=t,null!=this.M_EleEvtModel.PopCtrl&&e.preventDefault()}M_RefreshPagesOnLoad(e=!0,t=!1){if(this.xpageBuilder.RebuildFullPageViews(),t){this.ClearCmmtArea();let e=this.xpageBuilder.XDocWrapCnt;for(let t=0;t<e;t++)this.xpageBuilder.RebuildXDocPageView(t)}let n=this.xpageBuilder.GetFullPageList();super.MSetPageList(n,!0),super.MReCalcLayout(!0),e&&this._SetCursor_AtFirstEle()}updateState(){let e=this.xpageBuilder.GetFullPageList().Count();this.statusBar.Total=e}GetAlertFormStartRect(e,t,n,r="click"){t=Math.floor(t),n=Math.floor(n);let i=this.MGetZoomRatio(),l="click"==r?this.M_EleEvtModel.EleClicked:this.M_EleEvtModel.EleClickedWrap.EleFocused;const s=u.ClickedElementWrapper.GetEleRectInCtrl(l,this.M_PageFocused,i);let o=0,a=0;e==N.PositionEnum.LeftBottom?(o=s.Left+t,a=s.Bottom+n):e==N.PositionEnum.LeftTop?(o=s.Left+t,a=s.Top+n):e==N.PositionEnum.RightTop?(o=s.Right+t,a=s.Top+n):e==N.PositionEnum.RightBottom&&(o=s.Right+t,a=s.Bottom+n);let h=new B.PointF(Math.floor(o),Math.floor(a));return h=this.PointToScreen(h),new E.RectangleF(h.X,h.Y,Math.floor(s.Width),Math.floor(s.Height))}}t.XDocEditableCanvas=G},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XActionManager=void 0;const r=n(3),i=n(4),l=n(111),s=n(756),o=n(757),a=n(758),u=n(759),h=n(760),d=n(761),c=n(762),p=n(763),f=n(764),g=n(765),m=n(769),E=n(779),C=n(780),A=n(363),y=n(781),I=n(782),S=n(783),_=n(784),w=n(785),b=n(786),x=n(787),P=n(788),v=n(789),T=n(790),M=n(791),L=n(792),D=n(794),R=n(795),F=n(796),N=n(798),B=n(799),k=n(800),O=n(801),G=n(802),X=n(803),V=n(804),H=n(805),U=n(811),W=n(812),j=n(813),z=n(814),Y=n(239),Q=n(815),K=n(816),q=n(817),J=n(818),Z=n(819),$=n(820),ee=n(821),te=n(823),ne=n(824),re=n(826),ie=n(827),le=n(828),se=n(829),oe=n(830),ae=n(832),ue=n(833),he=n(368),de=n(836),ce=n(837),pe=n(838),fe=n(839),ge=n(840),me=n(841),Ee=n(842),Ce=n(843),Ae=n(845),ye=n(847),Ie=n(853),Se=n(854),_e=n(855),we=n(857),be=n(858),xe=n(859),Pe=n(862),ve=n(863),Te=n(864),Me=n(865),Le=n(866),De=n(372),Re=n(867),Fe=n(869),Ne=n(870),Be=n(871),ke=n(872),Oe=n(873),Ge=n(874),Xe=n(875),Ve=n(876),He=n(877),Ue=n(878),We=n(879),je=n(882),ze=n(883),Ye=n(884),Qe=n(885),Ke=n(886),qe=n(887),Je=n(888),Ze=n(889),$e=n(890),et=n(892),tt=n(893),nt=n(894),rt=n(895),it=n(896),lt=n(898),st=n(899),ot=n(900),at=n(901),ut=n(376),ht=n(902),dt=n(903),ct=n(949),pt=n(950),ft=n(951),gt=n(971),mt=n(972),Et=n(973),Ct=n(974),At=n(253),yt=n(975),It=n(977),St=n(978),_t=n(979),wt=n(980),bt=n(981),xt=n(982),Pt=n(983),vt=n(984),Tt=n(985),Mt=n(986),Lt=n(987),Dt=n(988),Rt=n(989),Ft=n(990),Nt=n(991),Bt=n(992),kt=n(993),Ot=n(994),Gt=n(995),Xt=n(996),Vt=n(997),Ht=n(998),Ut=n(999),Wt=n(1e3),jt=n(1001),zt=n(1002),Yt=n(1007),Qt=n(1008),Kt=n(1009),qt=n(1010),Jt=n(1011),Zt=n(1012),$t=n(1013),en=n(1014),tn=n(1015),nn=n(1016),rn=n(1017),ln=n(1018),sn=n(1019),on=n(1020),an=n(1021),un=n(1022),hn=n(1023),dn=n(1024),cn=n(1025),pn=n(1026),fn=n(1027),gn=n(1028),mn=n(1029),En=n(1030),Cn=n(1031),An=n(1032),yn=n(1033),In=n(1034),Sn=n(1035),_n=n(1036),wn=n(1037),bn=n(1038),xn=n(1039),Pn=n(1040),vn=n(1041),Tn=n(1042),Mn=n(1043),Ln=n(1044),Dn=n(1045),Rn=n(1046),Fn=n(1047),Nn=n(1048),Bn=n(1049),kn=n(1050),On=n(1051),Gn=n(1052),Xn=n(1053),Vn=n(1054),Hn=n(1055),Un=n(1056),Wn=n(1057),jn=n(1058),zn=n(1059),Yn=n(1060),Qn=n(1061),Kn=n(1062),qn=n(1063),Jn=n(1064),Zn=n(1065),$n=n(1066),er=n(1067),tr=n(1068),nr=n(1069),rr=n(1070),ir=n(1071),lr=n(1074),sr=n(1075),or=n(1076),ar=n(1077),ur=n(1078),hr=n(1079),dr=n(1080),cr=n(81),pr=n(1081),fr=n(1082),gr=n(1083),mr=n(1084),Er=n(1085),Cr=n(1086),Ar=n(1087);t.XActionManager=class{constructor(e){this.xdocEdtCtrl=null,this.actList=null,this.xdocEdtCtrl=e,this.actList=new r.List,this.InitActionList(),this._BindEdtCtrl(e);let t=new r.List,n=new r.List;this._BindElementList(t,n)}_BindEdtCtrl(e){for(let t=0;t<this.actList.Count();t++)this.actList.Get(t).SetEditCtrl(e)}_BindElementList(e,t){for(let n=0;n<this.actList.Count();n++)this.actList.Get(n).SetElementList(e,t)}GetActionByName(e){let t;if(i.default.IsNullOrEmpty(e))t=null;else{t=this.actList.Find(t=>e==t.ActName())}return t}GetActionByHotKey(e,t){return this.actList.Find(n=>n.TestHotKey(e,t))}InitActionList(){this.actList.Clear(),this.actList.Add(new _t.A_MoveCaret),this.actList.Add(new Gt.A_setValue),this.actList.Add(new qn.A_SetValueByTitle),this.actList.Add(new Kn.A_SyncDataByTitle),this.actList.Add(new Ut.A_getValue),this.actList.Add(new Sn.A_GetDocPosition),this.actList.Add(new Wt.A_getCheckedCptIdByGrpId),this.actList.Add(new Qt.A_GetTitleList),this.actList.Add(new yt.A_InsertChar),this.actList.Add(new St.A_InsertReturn),this.actList.Add(new f.A_CopyEles),this.actList.Add(new g.A_CutEles),this.actList.Add(new E.A_PasteEles),this.actList.Add(new A.A_SelectRange),this.actList.Add(new C.A_SelectAll),this.actList.Add(new Mt.A_Undo),this.actList.Add(new bt.A_Redo),this.actList.Add(new sr.A_LocateCursorWithRelateId),this.actList.Add(new It.A_InsertPageBreak),this.actList.Add(new m.A_FindReplace),this.actList.Add(new c.A_SetWorkMode_Design),this.actList.Add(new $t.A_SetWorkMode_Form),this.actList.Add(new p.A_SetWorkMode_KeepTrace),this.actList.Add(new h.A_SetWorkMode_App),this.actList.Add(new d.A_SetWorkMode_Browse),this.actList.Add(new Vt.A_InsertCharByTitle),this.actList.Add(new Ht.A_SaveTitleParagraphAsFile),this.actList.Add(new jt.A_insertElementByCpdID),this.actList.Add(new rn.A_GetAllElementValue),this.actList.Add(new Cn.A_GetElementListWithAttr),this.actList.Add(new zt.A_ValidateDoc),this.actList.Add(new hr.A_ResetEleValidate),this.actList.Add(new Kt.A_StructureTree),this.actList.Add(new Yn.A_GetSelectStructureTree),this.actList.Add(new Qn.A_SelectByEle),this.actList.Add(new qt.A_GetAllElement),this.actList.Add(new Zt.A_LocateCursor),this.actList.Add(new fn.A_LocateCursorWithDocId),this.actList.Add(new Jn.A_GetCursorInfo),this.actList.Add(new nn.A_LocateCursorToParagrEnd),this.actList.Add(new pn.A_LocateCursorWithInput),this.actList.Add(new s.A_SetViewMode_Clean),this.actList.Add(new o.A_SetViewMode_Complex),this.actList.Add(new u.A_SetViewMode_Web),this.actList.Add(new a.A_SetViewMode_Page),this.actList.Add(new Y.A_AddEdtHistory),this.actList.Add(new he.A_SetFont),this.actList.Add(new ue.A_SetDefaultFont),this.actList.Add(new pe.A_SetFontName),this.actList.Add(new fe.A_SetFontSize),this.actList.Add(new de.A_SetFontBold),this.actList.Add(new ce.A_SetFontItalic),this.actList.Add(new ge.A_SetFontStrikeout),this.actList.Add(new be.A_SetTextUnderline),this.actList.Add(new me.A_SetForeColor),this.actList.Add(new Ee.A_SetForeColorTest),this.actList.Add(new oe.A_SetBkgColor),this.actList.Add(new we.A_SetSuperscript),this.actList.Add(new _e.A_SetSubscript),this.actList.Add(new ye.A_SetParagraphStyle),this.actList.Add(new Se.A_SetParaSingleSerno),this.actList.Add(new Ie.A_SetParaMuliSerno),this.actList.Add(new te.A_ReStartSerno),this.actList.Add(new J.A_ContineSerno),this.actList.Add(new ae.A_SetBorderShading),this.actList.Add(new ee.A_FormatBrush),this.actList.Add(new q.A_ClearStyle),this.actList.Add(new z.A_AddComment),this.actList.Add(new Gn.A_ToggleCommentStatus),this.actList.Add(new Vn.A_GetCommentStatus),this.actList.Add(new ht.A_NewDoc),this.actList.Add(new wt.A_OpenDoc),this.actList.Add(new cn.A_CloseDocs),this.actList.Add(new an.A_OpenDocs),this.actList.Add(new Ct.A_AppendDoc),this.actList.Add(new Nn.A_AppendDocs),this.actList.Add(new fr.A_ReplaceDoc),this.actList.Add(new mn.A_UpdateValueList),this.actList.Add(new gn.A_SetEditableByDocId),this.actList.Add(new pr.A_SetUnEditableColor),this.actList.Add(new Wn.A_SetDocStatusImage),this.actList.Add(new jn.A_SetDocNewPage),this.actList.Add(new Hn.A_SetShowByDocId),this.actList.Add(new un.A_CloseDocByDocId),this.actList.Add(new hn.A_GetDocList),this.actList.Add(new dn.A_GetXmlByDocIndex),this.actList.Add(new En.A_GetXMLListWithTitle),this.actList.Add(new At.A_ImportDoc),this.actList.Add(new ut.A_InsertDoc),this.actList.Add(new gt.A_SaveDoc),this.actList.Add(new In.A_SaveDocAsText),this.actList.Add(new An.A_ResetXDocsChanged),this.actList.Add(new ft.A_SaveAsFile),this.actList.Add(new kt.A_SaveParagraphAsFile),this.actList.Add(new Jt.A_GetXmlByInputCptId),this.actList.Add(new Et.A_SaveAsText),this.actList.Add(new ln.A_FavoritesPhrases),this.actList.Add(new mt.A_SecretDoc),this.actList.Add(new ct.A_PrintDoc),this.actList.Add(new Xn.A_SetPrintPreview),this.actList.Add(new pt.A_PrintPreview),this.actList.Add(new dt.A_PrintCurPage),this.actList.Add(new Ce.A_SetPageFmt),this.actList.Add(new xe.A_SetWaterMark),this.actList.Add(new W.A_LookUpXml),this.actList.Add(new Lt.A_ZoomIn),this.actList.Add(new Dt.A_ZoomOut),this.actList.Add(new Rt.A_ZoomPctStr),this.actList.Add(new Z.A_FocusXInputEle),this.actList.Add(new $.A_HoverXInputEle),this.actList.Add(new N.A_InsertSingleChoiceDropEle),this.actList.Add(new T.A_InsertMoreChoiceDropEle),this.actList.Add(new P.A_InsertHavNoEle),this.actList.Add(new O.A_InsertTextEle),this.actList.Add(new ur.A_InsertSignEle),this.actList.Add(new M.A_InsertNumEle),this.actList.Add(new b.A_InsertDateEle),this.actList.Add(new R.A_InsertRadioGroup),this.actList.Add(new _.A_InsertCheckGroup),this.actList.Add(new w.A_InsertCommonEle),this.actList.Add(new Bt.A_InsertGroupEle),this.actList.Add(new k.A_InsertSqlElement),this.actList.Add(new y.A_CheckScriptExp),this.actList.Add(new v.A_InsertImage),this.actList.Add(new I.A_InsertBarCode),this.actList.Add(new D.A_InsertQrCode),this.actList.Add(new B.A_InsertSpliteLine),this.actList.Add(new L.A_InsertPageNum),this.actList.Add(new Bn.A_insertPageNumToFooter),this.actList.Add(new kn.A_DeletePageNumInFooter),this.actList.Add(new On.A_GetPageNum),this.actList.Add(new _n.A_GetPageNumEle),this.actList.Add(new V.A_InsertString),this.actList.Add(new U.A_InsertTextLabel),this.actList.Add(new sn.A_InsertDiagnosisEle),this.actList.Add(new yn.A_InsertDiagPosTable),this.actList.Add(new G.A_InsertFraction),this.actList.Add(new x.A_InsertEmptySpaceEle),this.actList.Add(new F.A_InsertShape),this.actList.Add(new S.A_InsertBtn),this.actList.Add(new H.A_InsertTeeth),this.actList.Add(new en.A_InsertSyncImage),this.actList.Add(new Ot.A_UpdateTeeth),this.actList.Add(new X.A_InsertMedExpression),this.actList.Add(new De.A_CreateTextTable),this.actList.Add(new nr.A_InsertTableWithContent),this.actList.Add(new Re.A_DeleteTextTable),this.actList.Add(new ze.A_TextTableDeleteRow),this.actList.Add(new je.A_TextTableDeleteColumn),this.actList.Add(new We.A_TextTableCombineCell),this.actList.Add(new it.A_TextTableUncombineCell),this.actList.Add(new lt.A_TextTableSplitCellByRow),this.actList.Add(new st.A_TextTableSplitCellByCol),this.actList.Add(new Pe.A_CopyInsertTableCol_Left),this.actList.Add(new ve.A_CopyInsertTableCol_Right),this.actList.Add(new Te.A_CopyInsertTableRow_Bottom),this.actList.Add(new Me.A_CopyInsertTableRow_Top),this.actList.Add(new qe.A_TextTableInsertRow_Top),this.actList.Add(new Fn.A_ClearInputValueWithTitle),this.actList.Add(new Ke.A_TextTableInsertRow_Bottom),this.actList.Add(new Dn.A_TextTableInsertRow_ByCID),this.actList.Add(new Ye.A_TextTableInsertColumn_Left),this.actList.Add(new Qe.A_TextTableInsertColumn_Right),this.actList.Add(new Ze.A_TextTableProperty),this.actList.Add(new nt.A_TextTableRowProperty),this.actList.Add(new Ue.A_TextTableCellProperty),this.actList.Add(new rt.A_TextTableShowCellCode),this.actList.Add(new $e.A_TextTableResizeColumn),this.actList.Add(new et.A_TextTableResizeColumns),this.actList.Add(new tt.A_TextTableResizeRow),this.actList.Add(new Je.A_TextTableKeyBoard),this.actList.Add(new Le.A_CopyTextTable),this.actList.Add(new Tt.A_RightProperty),this.actList.Add(new Ft.A_UpdateElement),this.actList.Add(new Ar.A_UpdateElementType),this.actList.Add(new Yt.A_UpdateImage),this.actList.Add(new Nt.A_UpdateGraph),this.actList.Add(new wn.A_UpdatePageNumByXid),this.actList.Add(new Xt.A_UpdateTextLable),this.actList.Add(new Zn.A_UpdateBase),this.actList.Add(new Q.A_HideRule),this.actList.Add(new K.A_ShowRule),this.actList.Add(new xt.A_RemoveChar),this.actList.Add(new Ae.A_SetParagraphIndent),this.actList.Add(new Pt.A_RemoveCurrentEmptyLine),this.actList.Add(new j.A_RemoveCharByRight),this.actList.Add(new vt.A_RemoveEmptyLines),this.actList.Add(new Pn.A_RemoveEleById),this.actList.Add(new ie.A_SetAlignLeft),this.actList.Add(new re.A_SetAlignCenter),this.actList.Add(new le.A_SetAlignRight),this.actList.Add(new ne.A_SetAlignBothEnds),this.actList.Add(new se.A_SetAlignScattered),this.actList.Add(new Ve.A_SetAlignTopLeft),this.actList.Add(new Xe.A_SetAlignTopCenter),this.actList.Add(new He.A_SetAlignTopRight),this.actList.Add(new Oe.A_SetAlignMiddleLeft),this.actList.Add(new ke.A_SetAlignMiddleCenter),this.actList.Add(new Ge.A_SetAlignMiddleRight),this.actList.Add(new Ne.A_SetAlignBottomLeft),this.actList.Add(new Fe.A_SetAlignBottomCenter),this.actList.Add(new Be.A_SetAlignBottomRight),this.actList.Add(new cr.A_SetTableAlign),this.actList.Add(new tn.A_DocHasChanged),this.actList.Add(new on.A_GetValidateList),this.actList.Add(new Cr.A_ValidateTitle),this.actList.Add(new at.A_ShowEleCode),this.actList.Add(new ot.A_HideEleCode),this.actList.Add(new bn.A_GetElementByCptId),this.actList.Add(new xn.A_GetCanvasAsImage),this.actList.Add(new ir.A_ExportPDF),this.actList.Add(new Tn.A_GetTitleWithImage),this.actList.Add(new Mn.A_SaveDocsAsXml),this.actList.Add(new vn.A_SetElementShowHIde),this.actList.Add(new Ln.A_GetValueListByCptId),this.actList.Add(new Rn.A_GetElementsWithBussId),this.actList.Add(new Un.A_OutPutAsPDf),this.actList.Add(new zn.A_InsertXTextHeader),this.actList.Add(new $n.A_ProhibitedDoc),this.actList.Add(new Er.A_MutualExclusion),this.actList.Add(new rr.A_SaveFileWithNotTrace),this.actList.Add(new lr.A_GetPageNumberInfo),this.actList.Add(new mr.A_SetFirstDocStartPageNum),this.actList.Add(new or.A_SetInputBorderHide),this.actList.Add(new er.A_UpdateInputReadOnly),this.actList.Add(new tr.A_UndoInsertDocWithRelateId),this.actList.Add(new ar.A_ClearTitleContent),this.actList.Add(new dr.A_GetTableRowAndHeight),this.actList.Add(new gr.A_GetElementByType)}RegActionExt(e){let t;if(null==e)t=null;else{let n=new l.ResMessage,r=e.ActName();i.default.IsNullOrEmpty(r)&&(n.MsgLevel=1,n.MsgStr="待注册的Action名称不能为空"),null!=this.GetActionByName(r)&&(n.MsgLevel=1,n.MsgStr="待注册的Action名称重复: "+r),e.SetEditCtrl(this.xdocEdtCtrl),this.actList.Add(e),n.MsgLevel=5,n.MsgStr="注册外部Action成功: "+r,t=n}return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetViewMode_Clean=void 0;const r=n(177);class i extends r.A_SetViewModeBase{ActName(){return"A_SetViewMode_Clean"}Execute(e){return super.Execute([!0])}}t.A_SetViewMode_Clean=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetViewMode_Complex=void 0;const r=n(177);class i extends r.A_SetViewModeBase{ActName(){return"A_SetViewMode_Complex"}Execute(e){return super.Execute([!1])}}t.A_SetViewMode_Complex=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetViewMode_Page=void 0;const r=n(177);class i extends r.A_SetViewModeBase{ActName(){return"A_SetViewMode_Page"}Execute(e){return super.Execute([!1])}}t.A_SetViewMode_Page=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetViewMode_Web=void 0;const r=n(177);class i extends r.A_SetViewModeBase{ActName(){return"A_SetViewMode_Web"}Execute(e){return super.Execute([!0])}}t.A_SetViewMode_Web=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetWorkMode_App=void 0;const r=n(142),i=n(2);class l extends r.A_SetWorkModeBase{ActName(){return"SetWorkMode_App"}Execute(e){return super.Execute([i.ENumWorkMode.App.toString()])}}t.A_SetWorkMode_App=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetWorkMode_Browse=void 0;const r=n(142),i=n(2);class l extends r.A_SetWorkModeBase{ActName(){return"SetWorkMode_Browse"}Execute(e){return super.Execute([i.ENumWorkMode.Browse.toString()])}}t.A_SetWorkMode_Browse=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetWorkMode_Design=void 0;const r=n(142),i=n(2),l=n(16);class s extends r.A_SetWorkModeBase{ActName(){return"SetWorkMode_Design"}Execute(e){const t=super.GetEdtCtrl().All_Document;for(let e=0;e<t.length;e++){const n=t[e].GetBodyChildren();if(null!=n)for(let e=0;e<n.Count();e++){const t=n.Get(e),r="IScriptMsg"==t.GetType()?t:null;null!=r&&(r.Attr_FgHide&&l.XDomUtil.setChildrenXBaseEleForeColorOpacity(r,.25,!0))}}return super.Execute([i.ENumWorkMode.Design.toString()])}}t.A_SetWorkMode_Design=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetWorkMode_KeepTrace=void 0;const r=n(142),i=n(2);class l extends r.A_SetWorkModeBase{ActName(){return"SetWorkMode_KeepTrace"}Execute(e){return super.Execute([i.ENumWorkMode.KeepTrace.toString()])}}t.A_SetWorkMode_KeepTrace=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CopyEles=void 0;const r=n(29),i=n(65),l=n(1),s=n(62),o=n(14),a=n(0);class u extends l.XBaseAction{constructor(){super(),super.SetHotKey(r.Keys.C,r.Keys.Control)}ActName(){return"Copy"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl().M_EleEvtModel.SelRange,n=t.FromLineEleIx.RefreshEleObj(!1),r=t.ToLineEleIx.RefreshEleObj(!1),l=i.EmrClipboard.GetInstance();this.initInfo(),this.getCopyeInfo(e),this.appendCopy&&this.setAppendCopy(l);if(l.CopyToClipboard(n,r,!1,null,this.appendCopy,this.onlyCopyText)){const e=l.M_ArrEleRange;if(null!=e){let t=i.EmrClipboard.Copy_SelEles(e,!0,!0);if(super.GetEdtCtrl().M_EdtCaret.Focus(),1==t.Count()){const e=t.Get(0);"XString"==e.EleTypeName&&(e.IsXInputBkgText=!1)}let n=new s.XTextDocument(!1);for(let e=0;e<t.Count();e++){const r=t.Get(e);e==t.Count()-1&&r instanceof a.XParagraphFlag&&t.Count()>1?t.Remove(r):(this.updateOwnerDocPanel(r,n.GetPagePanel(1)),this.resetDeleteFlag(r))}n.restoreChildrenList(t);let r=n.ToXML(),l=o.XmlDomUtil.Xml2String(r);localStorage.setItem(i.EmrClipboard.emrCopyToXMLKey,l);let u="-1";super.GetEdtCtrl().M_EdtLoginUserInfo&&(u=super.GetEdtCtrl().M_EdtLoginUserInfo.UsrId),localStorage.setItem(i.EmrClipboard.emrCopyToXMLUser,u);let h="";if(super.GetEdtCtrl().DefaultSetting){const e=super.GetEdtCtrl().DefaultSetting.PatientInfo;null!=e&&(h=e.Id)}localStorage.setItem(i.EmrClipboard.emrCopyToXMLPatient,h)}}return this.rn}get rn(){return this.resMsg.IsReturnMsg?this.resMsg:null}initInfo(){this.appendCopy=!1,this.onlyCopyText=!1}getCopyeInfo(e){if(null!=e){const t=e[0];"append"==t?this.appendCopy=!0:"onlyCopyText"==t?this.onlyCopyText=!0:"appendText"==t&&(this.appendCopy=!0,this.onlyCopyText=!0)}}setAppendCopy(e){if(e.IsEmpty()){const t=localStorage.getItem(i.EmrClipboard.emrCopyToXMLInner);if(t){const n=localStorage.getItem(i.EmrClipboard.emrCopyToXMLKey),r=super.getDocFromStroage(n);e.CopyToClipboard(r[0],r[1],!1,t)}}}}t.A_CopyEles=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CutEles=void 0;const r=n(2),i=n(29),l=n(13),s=n(65),o=n(1),a=n(55),u=n(62),h=n(14),d=n(6),c=n(0);class p extends o.XBaseAction{constructor(){super(),this.edt_elerange=null,super.OpType=r.ENumActOpType.CtntEdit,this.edt_elerange=new a.EmrEditEleRange,super.SetHotKey(i.Keys.X,i.Keys.Control)}ActName(){return"Cut"}Execute(e){let t;this.resMsg.Clear();let n=super.GetEdtCtrl(),r=n.M_EleEvtModel.SelRange,i=r.FromLineEleIx.RefreshEleObj(!1),o=r.ToLineEleIx.RefreshEleObj(!1),a=s.EmrClipboard.GetInstance();if(a.CopyToClipboard(i,o,!0)){const e=a.M_ArrEleRange;if(null!=e){let t=s.EmrClipboard.Copy_SelEles(e,!0,!0);if(1==t.Count()){const e=t.Get(0);"XString"==e.EleTypeName&&(e.IsXInputBkgText=!1)}let r=new u.XTextDocument(!1);for(let e=0;e<t.Count();e++){const n=t.Get(e);e==t.Count()-1&&n instanceof c.XParagraphFlag&&t.Count()>1?t.Remove(n):(this.updateOwnerDocPanel(n,r.GetPagePanel(d.ENumPagePanelTp.Body)),this.resetDeleteFlag(n))}r.restoreChildrenList(t);let i=r.ToXML(),l=h.XmlDomUtil.Xml2String(i);localStorage.setItem(s.EmrClipboard.emrCopyToXMLKey,l);const o=n.M_EdtLoginUserInfo?n.M_EdtLoginUserInfo.UsrId:"-1";localStorage.setItem(s.EmrClipboard.emrCopyToXMLUser,o)}let r=new l.UndoGroup;this.edt_elerange.SetEleEvtObjs(n.M_EleEvtModel,n.M_EleEvtHandler),this.edt_elerange.DelSelRange(127,r,this.resMsg),super._AddUndoItem(r),super._RefreshPageAndMoveCaret(!0,!0),t=this.resMsg}else this.resMsg.MsgStr="禁止剪切操作",super.MessageWarn(),t=this.resMsg;return t}}t.A_CutEles=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleHistoryUndo=void 0;const r=n(7),i=n(23);class l extends i.IXUndoable{constructor(e,t,n,i){super(),this.relEle=null,this.relEleStyle=null,this.oldCreatorInx=-1,this.oldDeleterInx=-1,this.newCreatorInx=-1,this.newDeleterInx=-1,this.oldForeColor=r.Color.Black,this.newForeColor=r.Color.Blue,this.oldIsRemoved=null,this.newIsRemoved=null,this.relEle=e,this.relEleStyle=e.EleStyle,this.oldCreatorInx=t,this.oldDeleterInx=n,this.oldForeColor=i,this.oldIsRemoved=e.IsRemoved,null!=this.relEleStyle&&(this.newCreatorInx=this.relEleStyle.CreatorIndex,this.newDeleterInx=this.relEleStyle.DeleterIndex,this.newForeColor=this.relEleStyle.ForeColor)}IsValid(){return null!=this.relEleStyle}CanUndo(){return null!=this.relEleStyle}CanRedo(){return null!=this.relEleStyle}Undo(){this.CanUndo()&&(this.relEleStyle.CreatorIndex=this.oldCreatorInx,this.relEleStyle.DeleterIndex=this.oldDeleterInx,this.relEleStyle.ForeColor=this.oldForeColor,this.relEle.Attr_FgHide=!1,this.relEle.IsRemoved&&!this.oldIsRemoved&&this.oldDeleterInx<0&&(this.newIsRemoved=this.relEle.IsRemoved,this.relEle.IsRemoved=this.oldIsRemoved))}Redo(){this.CanRedo()&&(this.relEleStyle.CreatorIndex=this.newCreatorInx,this.relEleStyle.DeleterIndex=this.newDeleterInx,this.relEleStyle.ForeColor=this.newForeColor,this.relEle.Attr_FgHide=!0,!this.relEle.IsRemoved&&this.newIsRemoved&&this.newDeleterInx>-1&&(this.relEle.IsRemoved=this.newIsRemoved))}Clear(){this.relEleStyle=null,this.oldCreatorInx=this.oldDeleterInx=-1,this.newCreatorInx=this.newDeleterInx=-1}}t.EleHistoryUndo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageRightPropertyInfo=void 0;t.ImageRightPropertyInfo=class{constructor(){this._VAlign=null}get Id(){return this._Id}set Id(e){this._Id=e}get Title(){return this._Title}set Title(e){this._Title=e}get Alt(){return this._Alt}set Alt(e){this._Alt=e}get ContentReadOnly(){return this._ContentReadOnly}set ContentReadOnly(e){this._ContentReadOnly=e}get KeepWidthHeightRate(){return this._KeepWidthHeightRate}set KeepWidthHeightRate(e){this._KeepWidthHeightRate=e}get DrawImage(){return this._DrawImage}set DrawImage(e){this._DrawImage=e}get OffsetX(){return this._OffsetX}set OffsetX(e){this._OffsetX=e}get OffsetY_1(){return this._OffsetY}set OffsetY_1(e){this._OffsetY=e}get OffsetY(){return this._OffsetY}set OffsetY(e){this._OffsetY=e}get ZOrderStyle(){return this._ZOrderStyle}set ZOrderStyle(e){this._ZOrderStyle=e}get VAlign(){return this._VAlign}set VAlign(e){this._VAlign=e}get Source(){return this._Source}set Source(e){this._Source=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParaghListStyleUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t,n){super(),this.outlineList=null,this.paraghFlag=null,this.oldListStyle=null,this.newListStyle=null,this.paraghFlag=e,this.outlineList=n,this.oldListStyle=t,null!=e&&(this.newListStyle=e.ParaghStyle.ParagraphListStyle)}IsValid(){return null!=this.paraghFlag&&null!=this.outlineList}CanUndo(){return this.IsValid()&&this.oldListStyle!=this.newListStyle}CanRedo(){return this.IsValid()&&this.oldListStyle!=this.newListStyle}Undo(){this.CanUndo()&&(this.paraghFlag.ParaghStyle.ParagraphListStyle=this.oldListStyle,this.outlineList.ChangeListStyle(this.paraghFlag))}Redo(){this.CanRedo()&&(this.paraghFlag.ParaghStyle.ParagraphListStyle=this.newListStyle,this.outlineList.ChangeListStyle(this.paraghFlag))}Clear(){this.paraghFlag=null,this.outlineList=null,this.oldListStyle=this.newListStyle=null}}t.ParaghListStyleUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_FindReplace=void 0;const r=n(2),i=n(6),l=n(16),s=n(162),o=n(79),a=n(144),u=n(770),h=n(3),d=n(143),c=n(9),p=n(4),f=n(13),g=n(1),m=n(108),E=n(55),C=n(241),A=n(29),y=n(772),I=n(92);class S extends g.XBaseAction{constructor(){super(),this._findTimes=0,this._docEditable=null,this._isUpdate=!1,this.edt_elerange=null,this._tempFindText="",this._findSerachValChanged=!1,this._replaceSerachValChanged=!1,this._currentLineSelPage=null,super.SetHotKey(A.Keys.F,A.Keys.Control),super.OpType=r.ENumActOpType.CtntEdit,this._suitResultList=new h.List,this.edt_elerange=new E.EmrEditEleRange}ActName(){return"FindReplace"}Execute(e){let t=this;return this.resMsg.Clear(),this._docEditable=super.GetEdtCtrl(),this.edt_elerange.SetEleEvtObjs(this._docEditable.M_EleEvtModel,this._docEditable.M_EleEvtHandler),this._isUpdate=!0,this.dialog||(this.dialog=new y.FindReplaceDialog({instance:this,btnClick:function(e,n){t.fdrp_form_ComboxValueChanged(n==a.BtnClickEvents.FindNextClickBtnEvent?u.ComBoxType.FindCombox:u.ComBoxType.ReplaceCombox,e.FindContentInFindTap),t.fdrp_form_BtnClick(e,n)},onClose:function(){t.fdrp_form_Closed(),t.dialog=null}})),this.resMsg}fdrp_form_ComboxValueChanged(e,t){e==u.ComBoxType.FindCombox?(this._tempFindText=t,this._findSerachValChanged=!0):e==u.ComBoxType.ReplaceCombox&&(this._tempFindText=t,this._replaceSerachValChanged=!0)}fdrp_form_Closed(){this.ClearSelectState(),this.Clear(),super._RefreshPageAndMoveCaret(!0,!0)}fdrp_form_BtnClick(e,t){if(this._isRegexMatch=e.IsRegexMatch,this._ignoreCase=e.IsIgnoreCase,this._ignoreBackText=e.IsIgnoreBackgroundText,this._ignoreLabelText=e.IsIgnoreSymbolText,t!=a.BtnClickEvents.ReplaceBtnClickEvent&&t!=a.BtnClickEvents.ReplaceAllBtnClickEvent||(this._ignoreBackText=!0,this._ignoreLabelText=!0),this._isUpdate=!0,this.UpdateSuitReusltExt(this._tempFindText,!1),t==a.BtnClickEvents.FindNextClickBtnEvent){let t=e.FindContentInFindTap;this._findSerachValChanged,this.FindBNextBtnClick(t)}else if(t==a.BtnClickEvents.ReplaceBtnClickEvent||t==a.BtnClickEvents.ReplaceAllBtnClickEvent){this._ignoreBackText=!0,this._ignoreLabelText=!0;let n=e.ReplaceContent;this._replaceSerachValChanged;let r=t==a.BtnClickEvents.ReplaceAllBtnClickEvent;this.ReplaceBtnClick(n,r)}this._findSerachValChanged&&(this._findSerachValChanged=!1),this._replaceSerachValChanged&&(this._replaceSerachValChanged=!1)}Clear(e=!0){this._suitResultList.Clear(),e&&(this._findTimes=0),this._isUpdate=!1}BulidFindReplaceResults(){let e,t=new h.List,n=super.GetXDocFocused(),r=["XString","XLable","XTextRadioBox","XTextCheckBox"],a=new h.List;n.GetPagePanel(i.ENumPagePanelTp.Header).GetChildrenByTypes(r,!0,a),n.GetPagePanel(i.ENumPagePanelTp.Body).GetChildrenByTypes(r,!0,a),n.GetPagePanel(i.ENumPagePanelTp.Footer).GetChildrenByTypes(r,!0,a);let u=new h.List;for(let e=0;e<a.Count();e++){const t=a.Get(e);l.XDomUtil.HasDelTrace(t)||u.Add(t)}if(a=u,a.Count()<=0)e=null;else{let n,r=0;for(;r<a.Count();){let e=a.Get(r);if(this._ignoreBackText){let t=e instanceof o.XStringEle?e:null;if(null!=t&&t.IsXInputBkgText){r++;continue}}if(this._ignoreLabelText){if(null!=(e instanceof s.XLabelEle?e:null)){r++;continue}}let i=new C.FindReplaceAssistInfo;if(i.AddChildEle(e),null!=n){let t=n.Parent.GetChildInx(n),r=n.Parent.GetChildInx(e);e.Parent.Equals(n.Parent)&&t+1==r&&(i.TogetherWithPre=!0)}t.Add(i),n=e,r++}e=t}return e}BulidSuitList_SelRange(e,t,n){if(null!=n){this._suitResultList.Clear();for(let r=0;r<n.Length;r++){let i=n.Get(r).HitTest(e,t,this._ignoreCase);for(let e=0;e<i.Length;e++){let t=i.Get(e),n=new d.XPageLineSelRange;n.SetFromIx(t.HitEles.Get(0));let r=l.XDomUtil.GetNextEle(!0,t.HitEles.Get(t.HitEles.Count()-1));n.SetToIx(r,!0),this._suitResultList.Add(n)}}}}UpdateSuitReusltExt(e,t=!0){if(this._isUpdate&&(this.Clear(t),!p.default.IsNullOrEmpty(e))){let t=this.BulidFindReplaceResults(),n=new h.List;for(let e=0;e<t.Length;e++){let r=t.Get(e);r.TogetherWithPre?n.Get(n.Length-1).MergeChildList(r):n.Add(r)}this.BulidSuitList_SelRange(e,this._isRegexMatch,n),this._isUpdate=!1}}ClearSelectState(){this._docEditable.M_EleEvtModel.SelRange.Clear(),this._currentLineSelPage=null,this._docEditable.MRefreshDocView()}GetNextEle_NowSelRange(e){let t=e.FromLineEleIx,n=e.ToLineEleIx;return n.LineIx<t.LineIx&&(n=t),n._GetNextEle(!0,!1,!1)}FindBNextBtnClick(e){p.default.IsNullOrEmpty(e)||(0==this._suitResultList.Count()?(this.ClearSelectState(),this.resMsg.MsgStr="未找到任何匹配项",super.MessageWarn()):this._findTimes>this._suitResultList.Count()-1?(this._findTimes=0,this.ClearSelectState(),this._currentLineSelPage=this._suitResultList.Get(this._findTimes),this.SetSuitBackColor(this._currentLineSelPage),this._findTimes++,this._docEditable.MRefreshDocView(),this.SetCursorEleVisible()):(this.ClearSelectState(),this._currentLineSelPage=this._suitResultList.Get(this._findTimes),this.SetSuitBackColor(this._currentLineSelPage),this._findTimes++,this._docEditable.MRefreshDocView(),this.SetCursorEleVisible()))}SetSuitBackColor(e){if(null!=e&&e.IsValid()){let t=this._docEditable.M_EleEvtModel.SelRange;t.SetFromIx(e.FromLineEle);let n=l.XDomUtil.GetNextEle(!0,e.ToLineEle);t.SetToIx(n);let r=this.GetNextEle_NowSelRange(e);this._docEditable.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.ReplaceEle(r)}}ReplaceBtnClick(e,t){t?(this.ClearSelectState(),this.ReplaceAlllEle(e)):this.ReplaceSingleText(e),this.SetCursorEleVisible()}ReplaceAlllEle(e){if(this._findTimes=0,this.FindNextValid()){let t=new f.UndoGroup;for(let n=0;n<this._suitResultList.Length;n++)this.DelElesInRanged(this._suitResultList.Get(n),t),this.InsertNewEle(e,t);super._AddUndoItem(t),this._docEditable.MRefreshDocView(),super.GetEdtCtrl().HideMsgBox||I.MessageBoxComp.Show({title:"提示",content:"共替换了"+this._suitResultList.Count()+"处",type:"success",dom:super.GetEdtCtrl().ContainerDOM}),this._suitResultList.Clear()}}ReplaceSingleText(e){null==this._currentLineSelPage&&(this._currentLineSelPage=this._suitResultList.Get(this._findTimes),this.SetSuitBackColor(this._currentLineSelPage),this._findTimes++,this._docEditable.MRefreshDocView(),this.SetCursorEleVisible());let t=new f.UndoGroup,n=!1;if(this._suitResultList.Length>0){this._currentLineSelPage.BuildEleRangeAsText()!=this._suitResultList.Get(0).BuildEleRangeAsText()&&(n=!0)}let r=this._currentLineSelPage;n&&(this._findTimes=0,r=this._suitResultList.Get(this._findTimes)),this.DelElesInRanged(r,t),this.InsertNewEle(e,t),super._AddUndoItem(t),this._docEditable.MRefreshDocView();let i=this.BulidFindReplaceResults();this.BulidSuitList_SelRange(this._tempFindText,this._isRegexMatch,i),this._findTimes>0&&this._findTimes--,this.FindBNextBtnClick(this._tempFindText)}InsertNewEle(e,t){let n=new h.List,r=new h.List,i=m.EditEleRange.BuildElesFromStr(e,null,r,super.GetEdtCtrl().M_EleEvtModel.EleClickedWrap);null!=i&&n.Add(i),n.AddRange(r),this.edt_elerange.InsertNewEles(-1,i,r.ToArray(),t,this.resMsg);let s=l.XDomUtil.GetParentXInput(i,!1);null!=s&&s.TextChanged()}DelElesInRanged(e,t){null!=e&&e.IsValid()&&this.edt_elerange.DelLineSelRange(e,t,this.resMsg)}FindNextValid(){let e;return 0==this._suitResultList.Count()&&(this._isUpdate=!0,this.UpdateSuitReusltExt(this._tempFindText)),0==this._suitResultList.Count()||this._findTimes>this._suitResultList.Count()-1?(this.resMsg.MsgStr="未找到更多搜索项",super.MessageWarn(),this._suitResultList.Clear(),e=!1):e=!0,e}SetCursorEleVisible(){let e=this._docEditable.M_EleEvtModel,t=c.RectangleF.Empty;this._docEditable.MSetScrollToEleRect(e.EleClicked,t)}}t.A_FindReplace=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComBoxType=void 0,function(e){e[e.FindCombox=0]="FindCombox",e[e.ReplaceCombox=1]="ReplaceCombox"}(t.ComBoxType||(t.ComBoxType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FindReplaceResultInfo=void 0;const r=n(3);t.FindReplaceResultInfo=class{constructor(){this._hitEles=new r.List}get HitEles(){return this._hitEles}get HitInx(){return this.hitInx}set HitInx(e){this.hitInx=e}get SourceStr(){return this.sourceStr}set SourceStr(e){this.sourceStr=e}get FindText(){return this.findText}set FindText(e){this.findText=e}AddHitEle(e){this._hitEles.Contains(e)||this._hitEles.Add(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FindReplaceDialog=void 0;const r=n(27),i=n(773);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.FindReplaceDialogComp(t,this.InitProps)}DefaultProps(){return{}}}t.FindReplaceDialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FindReplaceDialogComp=t.FindReplaceDialog=void 0;const r=n(12),i=n(52),l=n(76),s=n(22),o=n(24);n(776);const a=n(778),u=n(144),h=n(362),d=n(139);class c extends r.PureComponent{constructor(e){super(e),this.InputDefaultProps={width:"200",height:"32",labelWidth:"65"},this.state={actionType:"find",dialogHeight:300,FindContentInFindTap:"",IsIgnoreCase:!1,IsRegexMatch:!1,IsIgnoreBackgroundText:!1,IsIgnoreSymbolText:!1,ReplaceContent:"",UpwardSearch:!1,IsIgnoreAllHalfAngle:!1,valueList:[],resultValue:"",instance:e.instance},this.btnClick=this.btnClick.bind(this),this.replaceClick=this.replaceClick.bind(this),this.replaceAllClick=this.replaceAllClick.bind(this),this.findInput=r.createRef(),this.replaceInput=r.createRef()}componentDidMount(){if(this.props.parent.React=this,this.props.initValue){let e=this.props.initValue.split(",");this.setState({valueList:e})}setTimeout(()=>{this.findInput.current.inputRef.current.focus()},100)}handleOk(e){let t=this.state.valueList.join(",");this.setState({resultValue:t}),this.props.onOk(t)}handleValue(e,t){let n=this.state.valueList;n[t]=e,this.setState({valueList:n})}changeUpdate(){this.state.instance._isUpdate=!0,this.state.instance.ClearSelectState()}handleIsIgnoreCase(){this.setState({IsIgnoreCase:!this.state.IsIgnoreCase}),this.changeUpdate()}handleIsRegexMatch(){this.setState({IsRegexMatch:!this.state.IsRegexMatch}),this.changeUpdate()}handleIsIgnoreBackgroundText(){this.setState({IsIgnoreBackgroundText:!this.state.IsIgnoreBackgroundText}),this.changeUpdate()}handleIsIgnoreSymbolText(){this.setState({IsIgnoreSymbolText:!this.state.IsIgnoreSymbolText}),this.changeUpdate()}handleIsIgnoreAllHalfAngle(){this.setState({IsIgnoreAllHalfAngle:!this.state.IsIgnoreAllHalfAngle}),this.changeUpdate()}handleIsUpwardSearch(){this.setState({UpwardSearch:!this.state.UpwardSearch}),this.changeUpdate()}btnClick(e){let t=new a.FindReplaceInfo;t.ChoiceTabType=h.TapType.FindTap,t.FindContentInFindTap=this.findInput.current.state.value,t.IsIgnoreBackgroundText=this.state.IsIgnoreBackgroundText,t.IsIgnoreCase=this.state.IsIgnoreCase,t.IsIgnoreSymbolText=this.state.IsIgnoreSymbolText,t.IsRegexMatch=this.state.IsRegexMatch,t.ReplaceContent="",t.UpwardSearch=this.state.UpwardSearch;let n=u.BtnClickEvents.FindNextClickBtnEvent;this.props.btnClick(t,n)}replaceClick(){let e=new a.FindReplaceInfo;e.ChoiceTabType=h.TapType.FindTap,e.FindContentInFindTap=this.findInput.current.state.value,e.IsIgnoreBackgroundText=this.state.IsIgnoreBackgroundText,e.IsIgnoreCase=this.state.IsIgnoreCase,e.IsIgnoreSymbolText=this.state.IsIgnoreSymbolText,e.IsRegexMatch=this.state.IsRegexMatch,e.ReplaceContent=this.replaceInput.current.state.value,e.UpwardSearch=this.state.UpwardSearch;let t=u.BtnClickEvents.ReplaceBtnClickEvent;this.props.btnClick(e,t)}replaceAllClick(){let e=new a.FindReplaceInfo;e.ChoiceTabType=h.TapType.FindTap,e.FindContentInFindTap=this.findInput.current.state.value,e.IsIgnoreBackgroundText=this.state.IsIgnoreBackgroundText,e.IsIgnoreCase=this.state.IsIgnoreCase,e.IsIgnoreSymbolText=this.state.IsIgnoreSymbolText,e.IsRegexMatch=this.state.IsRegexMatch,e.ReplaceContent=this.replaceInput.current.state.value,e.UpwardSearch=this.state.UpwardSearch;let t=u.BtnClickEvents.ReplaceAllBtnClickEvent;this.props.btnClick(e,t)}onClose(){this.props.onClose()}toggleAction(e){let t=e.target.getAttribute("data-actiontype");"findbutton"==t?(this.setState({actionType:"find"}),setTimeout(()=>{this.findInput.current.inputRef.current.focus()},100)):"replacebutton"==t&&(this.setState({actionType:"replace"}),setTimeout(()=>{this.replaceInput.current.inputRef.current.focus()},100))}render(){const{dialogHeight:e}=this.state;return r.createElement(i.Dialog,{className:"findReplace",title:"查找和替换",isDestroy:!0,visible:!0,width:400,height:260,showFooter:!1,onCancel:this.onClose.bind(this),onOk:this.handleOk.bind(this)},r.createElement("div",{className:"buttonType"},r.createElement("div",{className:"find"==this.state.actionType?"active":"","data-actiontype":"findbutton",onClick:e=>{this.toggleAction(e)}},"查找"),r.createElement("div",{className:"find"==this.state.actionType?"":"active","data-actiontype":"replacebutton",onClick:e=>{this.toggleAction(e)}},"替换")),r.createElement(r.Fragment,null,r.createElement("div",{className:"inputWrap"},r.createElement(l.Input,Object.assign({onChange:this.changeUpdate.bind(this),ref:this.findInput,labelText:"查找内容"},this.InputDefaultProps)),"replace"==this.state.actionType?r.createElement("div",{className:"replaceinput"},r.createElement(l.Input,Object.assign({ref:this.replaceInput},this.InputDefaultProps,{labelText:"替换为"}))):null),r.createElement("div",{className:"checkboxWrap"},r.createElement("label",{htmlFor:"IsIgnoreCase"},r.createElement("input",{id:"IsIgnoreCase",type:"checkbox",checked:this.state.IsIgnoreCase,onChange:()=>this.handleIsIgnoreCase()})," ",r.createElement("span",null,"忽略大小写")),"find"==this.state.actionType?r.createElement(r.Fragment,null,r.createElement("label",{htmlFor:"IsIgnoreBackgroundText"},r.createElement("input",{id:"IsIgnoreBackgroundText",type:"checkbox",checked:this.state.IsIgnoreBackgroundText,onChange:()=>this.handleIsIgnoreBackgroundText()})," 忽略背景文本"),r.createElement("label",{htmlFor:"IsIgnoreSymbolText"},r.createElement("input",{id:"IsIgnoreSymbolText",type:"checkbox",checked:this.state.IsIgnoreSymbolText,onChange:()=>this.handleIsIgnoreSymbolText()})," 忽略标签文本")):null),r.createElement("div",{className:"footerButton"},r.createElement(d.Button,{text:"查找下一处",type:"primary",width:82,height:32,onClick:this.btnClick}),"replace"==this.state.actionType?r.createElement(r.Fragment,null,r.createElement(d.Button,{text:"替换",type:"primary",width:40,height:32,onClick:this.replaceClick}),r.createElement(d.Button,{text:"全部替换",type:"primary",width:70,height:32,onClick:this.replaceAllClick})):null)))}}t.FindReplaceDialog=c;class p extends s.BaseComponent{constructor(e,t){super(e,t,!0),this.Render()}onOk(e){this.React.handleOk(e)}Render(){o.render(r.createElement(c,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.FindReplaceDialogComp=p},function(e,t,n){var r=n(18),i=n(775);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".pango-editor-mask {\r\n    position: fixed;\r\n    display: flex;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: rgba(0,0,0,0.3);\r\n    transition: background .3s;\r\n    justify-content: center;\r\n    align-items: center;\r\n    perspective: 600px;\r\n}\r\n\r\n.pango-editor-dialog {\r\n    position: relative;\r\n    background: #FFFFFF;\r\n    box-sizing: border-box;\r\n    display: flex;\r\n    flex-shrink: 0;\r\n    flex-direction: column;\r\n    opacity: 1;\r\n    box-shadow: 10px 10px 10px 10px rgb(0 0 0 / 10%);\r\n    border-radius: 4px;\r\n    transition: opacity .3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\r\n}\r\n.pango-editor-dialog-header {\r\n    height: 40px;\r\n    box-sizing: border-box;\r\n    line-height: 40px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    user-select: none;\r\n    margin: 0 16px;\r\n}\r\n\r\n.pango-editor-dialog.isDrag .pango-editor-dialog-header{\r\n    cursor: move;\r\n}\r\n\r\n.pango-editor-dialog-title {\r\n    display: inline-block;\r\n    height: 40px;\r\n    line-height: 40px;\r\n    padding-left: 10px;\r\n    font-size: 16px;\r\n}\r\n\r\n.pango-editor-dialog-closeBtn {\r\n    display: inline-block;\r\n    height: 40px;\r\n    width: 40px;\r\n    font-size: 20px;\r\n    text-align: center;\r\n    line-height: 40px;\r\n    color: #555555;\r\n    cursor: pointer;\r\n}\r\n.pango-editor-dialog-closeBtn:hover {\r\n    color: #000000;\r\n}\r\n.pango-editor-dialog-content {\r\n    flex-grow: 1;\r\n    margin: 16px;\r\n}\r\n.pango-editor-dialog-footer {\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    align-items: center;\r\n    margin: 8px 16px;\r\n}\r\n.pango-editor-dialog-footer button {\r\n    margin-right: 10px;\r\n}\r\n.pango-editor-dialog-footer button:last-child {\r\n    margin-right: 0;\r\n}\r\n\r\n.fadeInOut {\r\n    background: rgba(0,0,0,0);\r\n}\r\n.fadeInOut>.pango-editor-dialog{\r\n    opacity: 0;\r\n    transition: opacity .3s cubic-bezier(0.6, -0.28, 0.735, 0.045);\r\n}\r\n",""]),e.exports=t},function(e,t,n){var r=n(18),i=n(777);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,'.findReplace {\r\n    width: 0;\r\n    height: 0;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n}\r\n\r\n.findReplace * {\r\n    box-sizing: border-box;\r\n}\r\n\r\n.findReplace .pango-editor-dialog-content {\r\n    position: relative;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n}\r\n\r\n.findReplace .buttonType {\r\n    height: 25px;\r\n    border-bottom: 2px solid #e4e7ed;\r\n}\r\n\r\n.findReplace .buttonType div.active {\r\n    height: 25px;\r\n    color: #409eff;\r\n    border-bottom: 2px solid #409eff;\r\n}\r\n\r\n.findReplace .buttonType div {\r\n    cursor: pointer;\r\n    line-height: 25px;\r\n    font-size: 14px;\r\n    width: 80px;\r\n    float: left;\r\n    height: 25px;\r\n    text-align: center;\r\n}\r\n\r\n.findReplace .inputWrap .replaceinput {\r\n    margin-top: 12px;\r\n}\r\n\r\n.findReplace .inputWrap {\r\n    position: relative;\r\n    padding: 10px 16px;\r\n}\r\n\r\n.findReplace .inputWrap:after {\r\n    content: "";\r\n    width: 296px;\r\n    height: 1px;\r\n    background-color: #e2e6ed;\r\n    position: absolute;\r\n    margin: 0 auto;\r\n    left: -4px;\r\n    right: -4px;\r\n    bottom: 0;\r\n    display: block;\r\n}\r\n\r\n.findReplace .inputWrap .pango-editor-input-label {\r\n    font-size: 12px;\r\n    width: 54px;\r\n    text-align: center;\r\n    margin-right: 12px;\r\n}\r\n\r\n.findReplace #find_btn {\r\n    width: 58px;\r\n    height: 24px;\r\n    font-size: 12px;\r\n    color: rgb(102, 102, 102);\r\n    border: 1px solid #e2e6ed;\r\n    margin-right: 8px;\r\n    display: inline-block;\r\n    margin-bottom: 16px;\r\n}\r\n\r\n\r\n.findReplace .checkboxWrap {\r\n    position: relative;\r\n    padding: 10px 16px;\r\n    /* display: flex; */\r\n    flex-wrap: wrap;\r\n    justify-content: space-between;\r\n}\r\n\r\n.findReplace .checkboxWrap label {\r\n    width: 30%;\r\n    color: #3d4757;\r\n    font-size: 12px;\r\n    display: inline-flex;\r\n    justify-content: flex-start;\r\n    align-items: center;\r\n}\r\n\r\n.findReplace .footerButton {\r\n    text-align: right;\r\n}\r\n\r\n.findReplace .footerButton>button {\r\n    margin-right: 10px\r\n}\r\n/* .findReplace .footerButton>button {\r\n    cursor: pointer;\r\n    display: inline-block;\r\n    border: 1px solid #e2e6ed;\r\n    border-radius: 2px;\r\n    background: #fff;\r\n    height: 24px;\r\n    line-height: 24px;\r\n    margin: 0 8px;\r\n    font-size: 12px;\r\n    margin-right: 10px;\r\n} */',""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FindReplaceInfo=void 0;const r=n(362);class i{get FindContentInFindTap(){return this.findContentInFindTap}set FindContentInFindTap(e){this.findContentInFindTap=e}get ReplaceContent(){return this.replaceContent}set ReplaceContent(e){this.replaceContent=e}get ChoiceTabType(){return this.choiceTabType}set ChoiceTabType(e){this.choiceTabType=e}get IsRegexMatch(){return this.isRegexMatch}set IsRegexMatch(e){this.isRegexMatch=e}get IsIgnoreCase(){return this.isIgnoreCase}set IsIgnoreCase(e){this.isIgnoreCase=e}get IsIgnoreBackgroundText(){return this.isIgnoreBackgroundText}set IsIgnoreBackgroundText(e){this.isIgnoreBackgroundText=e}get IsIgnoreSymbolText(){return this.isIgnoreSymbolText}set IsIgnoreSymbolText(e){this.isIgnoreSymbolText=e}get UpwardSearch(){return this.upwardSearch}set UpwardSearch(e){this.upwardSearch=e}staticGetTextInfo(){let e=new i;return e.FindContentInFindTap="你好",e.ReplaceContent="两年后",e.ChoiceTabType=r.TapType.FindTap,e}}t.FindReplaceInfo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_PasteEles=void 0;const r=n(2),i=n(150),l=n(3),s=n(29),o=n(4),a=n(13),u=n(65),h=n(1),d=n(55),c=n(89),p=n(0),f=n(32);class g extends h.XBaseAction{constructor(){super(),this.edt_elerange=null,this.mod_key=s.Keys.None,this.pasteDeleted=!1,super.OpType=r.ENumActOpType.CtntEdit,this.edt_elerange=new d.EmrEditEleRange,super.SetHotKey(s.Keys.V,s.Keys.Control)}ActName(){return"Paste"}TestHotKey(e,t){let n;return this.hotChKey!=e?n=!1:(this.mod_key=t,n=this.hotModKey==(this.hotModKey&t)),n}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),i=n.M_EleEvtModel.EleClickedWrap;if(null!=i&&i.IsValid()){this.pasteDeleted=!1,(e&&"PasteDeleted"==e[0]||n.M_EdtCustomEvtGrp.PasteDeleted)&&(this.pasteDeleted=!0);n.M_EdtCaret;if(!(e&&e[0]==s.Keys.V&&e[1]==s.Keys.Control||window.winning))return this.resMsg.MsgLevel=5,this.resMsg.MsgStr="当前浏览器不支持，请使用快捷键(Ctrl+v)粘贴",super.MessageWarn(),this.resMsg;let i=new a.UndoGroup;this.edt_elerange.SetEleEvtObjs(n.M_EleEvtModel,n.M_EleEvtHandler),this.edt_elerange.DelSelRange(127,i,this.resMsg);const l=n.M_EdtLoginUserInfo?n.M_EdtLoginUserInfo.UsrId:null,o=localStorage.getItem(u.EmrClipboard.emrCopyToXMLUser),h=null==o||"-1"==o||null==l||o!=l,d=Number(n.M_EdtCustomEvtGrp.CopyModel);if(d==r.ENumCopyMode.InDocByUser&&h)return this.resMsg.MsgLevel=5,this.resMsg.MsgStr="仅允许复制粘贴相同用户的病历信息",super.MessageWarn(),this.resMsg;let c=u.EmrClipboard.GetInstance();const p=c.IsEmpty();let f=null,g=null,m=null,E=!1;if(p){if(d==r.ENumCopyMode.InDoc)return this.resMsg.MsgLevel=5,this.resMsg.MsgStr="仅允许复制粘贴本病历内的信息",super.MessageWarn(),this.resMsg;const e=localStorage.getItem(u.EmrClipboard.emrCopyToXMLInner),t=u.EmrClipboard.IsOsClipboardEmrCtntChanged(e||"");if(e&&!t){const t=localStorage.getItem(u.EmrClipboard.emrCopyToXMLKey),n=super.getDocFromStroage(t);f=c.CopyToClipboard(n[0],n[1],!1,e)}}let C=p&&null!=f&&!f;if(C||(C=u.EmrClipboard.IsOsClipboardEmrCtntChanged()),C){if(d!=r.ENumCopyMode.InWinSys)return this.resMsg.MsgLevel=5,this.resMsg.MsgStr="禁止粘贴外部信息",super.MessageWarn(),this.resMsg;E=!0,g=this._PasteFromOsClipboard()}else{let t="0";if(super.GetEdtCtrl().DefaultSetting){const e=super.GetEdtCtrl().DefaultSetting.PatientInfo;if(null!=e){const n=localStorage.getItem(u.EmrClipboard.emrCopyToXMLPatient),r=e.Id;if(n&&r){if(t=e.CopyModel,"3"==t)return c.ClearRange(),this.resMsg.MsgLevel=7,this.resMsg.MsgStr="不可跨病历复制粘贴病历信息",super.MessageWarn(),this.resMsg;if("0"!=t){if("1"==t&&r!=n)return c.ClearRange(),this.resMsg.MsgLevel=7,this.resMsg.MsgStr="仅允许复制粘贴相同患者的病历信息",super.MessageWarn(),this.resMsg;if("2"==t&&r==n)return c.ClearRange(),this.resMsg.MsgLevel=7,this.resMsg.MsgStr="仅允许复制粘贴不同患者的病历信息",super.MessageWarn(),this.resMsg}}}}let n=s.Keys.Shift!=(s.Keys.Shift&this.mod_key);const r=(null==e?0:e.length)>=1?e[0]:null;null!=r&&(n=r),m=this._PasteFromEmrClipboard(c,n,i)}E&&(localStorage.removeItem(u.EmrClipboard.emrCopyToXMLKey),localStorage.removeItem(u.EmrClipboard.emrCopyToXMLInner),localStorage.removeItem(u.EmrClipboard.emrCopyToXMLUser),localStorage.removeItem(u.EmrClipboard.emrCopyToXMLPatient)),(f||g||m)&&(super._AddUndoItem(i),super._RefreshPageAndMoveCaret(!0,!0)),t=this.resMsg}else this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName+" 命令目标定位元素无效",super.MessageError(),t=this.resMsg;return t}_PasteFromOsClipboard(){let e=u.EmrClipboard.GetOsClipboardCtnt();if(!o.default.IsNullOrEmpty(e)){return super.GetEdtCtrl().M_GetActionByName("InsertChar").Execute([e]),!0}return!1}_PasteFromEmrClipboard(e,t,n){let s=e.CopyFromClipboard(t,null),o=super.GetEdtCtrl(),[a,u]=s;if(!0===o.PasteXtextLabelTotext&&null!=a)for(let e=0;e<a.length;e++){const t=a[e];let n=this.xtextLabelElementToString(t);null!=n&&(a[e]=n)}if(!0===o.PasteXtextLabelTotext&&null!=u){let e=this.xtextLabelElementToString(u);null!=e&&(u=e)}if(null!=u){if(super.GetEdtCtrl().M_EleEvtModel.WorkMode!=r.ENumWorkMode.Form){this.filterDletePro(u,a),this.edt_elerange.InsertNewEles(-1,u,a,n,this.resMsg);let e=new l.List;e.Add(u),e.AddRange(a);const t=c.MsgRegisterHandler.changeAllChildrenNewIdAndXId(e);return c.MsgRegisterHandler.updateAllExpressStr(t[0],t[1],e),c.MsgRegisterHandler.RegisterExpressionToMsgBus(super.GetEdtCtrl().M_DocumentFocused),!0}{let e=u.GetInnerText(!1);if(null!=a)for(let t=0;t<a.length;t++){let n=a[t]instanceof i.XBaseElement?a[t]:null;null!=n&&(n instanceof p.XBaseInputEle?e+=n.GetXInputText(!1,!1,!1):e+=n.GetInnerText(!1))}o.M_GetActionByName("InsertChar").Execute([e])}return!1}}filterDletePro(e,t){if(this.pasteDeleted){let n=null==t?[]:[...t];n.push(e);for(let e=0;e<n.length;e++){const t=n[e];null!=t&&(t instanceof f.XTextLabelElement&&(t.IsDeleteFlag=!0),t.Deletable=!0)}}}}t.A_PasteEles=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SelectAll=void 0;const r=n(6),i=n(29),l=n(363);class s extends l.A_SelectRange{ActName(){return"SelectAll"}constructor(){super(),super.SetHotKey(i.Keys.A,i.Keys.Control)}Execute(e){const t=super.GetEdtCtrl().M_DocumentFocused.GetPagePanel(r.ENumPagePanelTp.Body);return super.Execute([t])}}t.A_SelectAll=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CheckScriptExp=void 0;const r=n(89),i=n(1),l=n(92);class s extends i.XBaseAction{ActName(){return"CheckScriptExp"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl().M_DocumentFocused,i=r.MsgRegisterHandler.CheckExpValid(n);if(null==i||0==i.Count())super.GetEdtCtrl().HideMsgBox||l.MessageBoxComp.Show({title:"提示",content:"表达式校验成功！",type:"success",dom:super.GetEdtCtrl().ContainerDOM});else{let e;if(null==e)return t=this.resMsg,t;let n="";for(let e=0;e<i.Count();e++){n+=i[e].TipMsg,e!=i.Count()-1&&(n+="\r\n")}this.resMsg.MsgStr=n,super.MessageWarn(),e.DocWrapper.SelectElement(i[0].ExpInEle)}return t=super.Execute(e),t}}t.A_CheckScriptExp=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertBarCode=void 0;const r=n(0),i=n(228),l=n(144),s=n(48),o=n(133),a=n(7),u=n(107);class h extends s.A_InsertElement{ActName(){return"InsertBarCode"}Execute(e){this.resMsg.Clear();let t=e[0],n=u.InsertElementBack.getBarCodeInfo(t),r=u.InsertElementBack.getBarCodeType(n.CodeStyleStr),i=o.XCodeUtil.GetInstance().BuildBarcode(r,n.Content,n.BarcodeLineWidth,n.BarcodeLineHeight,a.Color.Black,a.Color.White);return n.GetEditBarcodeImage=i.Image,this.codeForm_BtnClick(n,l.BtnClickEvents.OkBtnClickEvent),this.resMsg}codeForm_BtnClick(e,t){if(t==l.BtnClickEvents.OkBtnClickEvent&&null!=e.GetEditBarcodeImage){let t=r.XElementFactory.CreatXElement("XBarcodeField",null),n=t instanceof i.XCodeEle?t:null;null!=n&&(n.InitCodeEle(e),this.resMsg=super.Execute([n]),super.GetEdtCtrl().MRefreshDocView())}}}t.A_InsertBarCode=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertBtn=void 0;const r=n(48),i=n(0),l=n(7);class s extends r.A_InsertElement{ActName(){return"InsertBtn"}Execute(e){let t,n=e[0],r=new i.XButtonEle;if(r.GrpID=n.attributeCode,r.EventType=n.eventType,r.Deletable=null==n.deleteFlag||n.deleteFlag,null!=n.buttonIcon&&null!=n.buttonIcon){let e=n.buttonIcon.split(","),t="";t=1==e.length?"data:image/gif;base64,"+e[0]:n.buttonIcon,r.Icon=t,r.IconWidth=n.iconWidth,r.IconHeight=n.iconHeight,r.ToolTip=n.tooltipText,r.InitEleSize(),this.resMsg=super.Execute([r])}else r.Text=n.displayText,r.ToolTip=n.tooltipText,r.BorderStyle=n.borderStyle,r.BorderColor=new l.Color(n.borderColor),r.BtnBackColor=new l.Color(n.backgroundColor),this.resMsg=super.Execute([r]),r.InitEleSize();return super.GetEdtCtrl().MRefreshDocView(),t=this.resMsg,t}}t.A_InsertBtn=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertCheckGroup=void 0;const r=n(40),i=n(221),l=n(54),s=n(48),o=n(42),a=n(3),u=n(87);class h extends s.A_InsertElement{ActName(){return"InsertCheckGroup"}Execute(e){let t;this.resMsg.Clear();let n=e[0],s=new l.ElementInfo;s.Code_mrdetp="8002",s.Id_mr_de=n.elementCode,s.Name=n.elementName,s.conceptDomainCode=n.conceptDomainCode,s.ExtendAttr1=n.extendAttr1,s.LackEllipsisvalue=n.defaultValue,s.DynamicData=n.dynamicData,s.Name_de=n.dataEmementName,s.ValueCode_de=n.dataEmementCode,s.Text_tip=n.tooltipText,s.OnlyPrintCheckedItem=!0===n.onlyPrintCheckedItem,s.Name_source=n.sourceName,s.Name_property=n.attributeName,s.BaseChoiceShowStyle=n.displayStyle,s.VAlign=n.verticalAlign,s.IsShowRightText=n.textShow,s.QuoteSource=1==n.quoteSource,s.QuoteTarget=1==n.quoteTarget,s.IsTextRightShow=n.textRightShow,s.IsStrongShow=n.groupStrongShow,s.Fg_delete=n.deleteFlag,s.Fg_hide=n.hideFlag,s.IsMustChoose=n.chooseFlag,s.IsPrint=n.printFlag,null!=n.expressionInput&&null!=n.expressionInput&&(s.Text_Expression=decodeURIComponent(n.expressionInput)),s.Gender=n.sexJudge,s.MaxAge=n.maxAge,s.MinAge=n.minAge;let h=new a.List,d=n.valueList;for(let e=0;e<d.length;e++){let t=new u.SelEleItemInfo,n=d[e].Value,r=d[e].Key,i=(d[e].Level,d[e].GrpId);t.Value=n,t.Key=r,t.Level=0,t.Index=-1,t.GrpId=i,h.Add(t)}s.Valuelist=h;let c=o.XInputFactory.GetInstance().GetCheck(s,null);try{let e=c instanceof i.XChoiceGroupEle?c:null;if(null==e)return t=this.resMsg,t;e.InputType=r.EleTypeEnum.MoreChoiceGroupEle;for(let t=0;t<e.Length;t++)this.resMsg=super.Execute([e.Get(t)]);super.GetEdtCtrl().MRefreshDocView()}catch(e){this.resMsg.Ex=e}return t=this.resMsg,t}}t.A_InsertCheckGroup=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertCommonEle=void 0;const r=n(54),i=n(68),l=n(42);class s extends i.A_BaseInsertInput{ActName(){return"InsertCommonEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new r.ElementInfo;i.Code_mrdetp="9004",i.Id_mr_de=n.elementCode,i.conceptDomainCode=n.conceptDomainCode,i.Name=n.elementName,i.Name_de=n.dataEmementName,i.ValueCode_de=n.dataEmementCode,i.Text_label=n.labelText,i.Text_background=n.backgroundText,i.Text_tip=n.tooltipText,i.Name_source=n.sourceName,i.Name_property=n.attributeName,i.DefaultValue=n.defaultText,i.QuoteSource=1==n.quoteSource,i.QuoteTarget=1==n.quoteTarget,i.Activation_Mode_Key=n.activateWay,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.IsAddCallBack=n.addFlag,i.IsAllowKeyInput=n.keyFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag,i.Suffix_label=n.suffixText,i.IsPrint=n.printFlag,i.IsDisSkip=n.skipFlag,i.Gender=n.sexJudge,i.MaxAge=n.maxAge,i.MinAge=n.minAge;let s=l.XInputFactory.GetInstance().GetCommonEle(i,null);return null==s?(t=this.resMsg,t):(s.ElementInfo=i,t=super.Execute([s]),t)}}t.A_InsertCommonEle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertDateEle=void 0;const r=n(54),i=n(68),l=n(42);class s extends i.A_BaseInsertInput{ActName(){return"InsertDateEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new r.ElementInfo;i.Code_mrdetp="6002",i.Id_mr_de=n.elementCode,i.conceptDomainCode=n.conceptDomainCode,i.ExtendAttr1=n.extendAttr1,i.LackEllipsisvalue=n.defaultValue,i.DynamicData=n.dynamicData,i.QuoteSource=1==n.quoteSource,i.QuoteTarget=1==n.quoteTarget,i.Name=n.elementName,i.Name_de=n.dataEmementName,i.ValueCode_de=n.dataEmementCode,i.Text_label=n.labelText,i.Text_background=n.backgroundText,i.Text_tip=n.tooltipText,i.Name_source=n.sourceName,i.Name_property=n.attributeName,i.DefaultValue=n.defaultText,i.DefaultCurrentTimeFlag=n.defaultCurrentTimeFlag,i.PrintCurrentTimeFlag=n.printCurrentTimeFlag,i.Activation_Mode_Key=n.activateWay,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Dt_format=n.dateFormat,i.IsRefreshSysTime=n.intoTime,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.IsAddCallBack=n.addFlag,i.IsAllowKeyInput=n.keyFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag,i.Suffix_label=n.suffixText,i.IsPrint=n.printFlag,i.IsDisSkip=n.skipFlag,i.Gender=n.sexJudge,i.MaxAge=n.maxAge,i.MinAge=n.minAge;let s=l.XInputFactory.GetInstance().GetDatetime(i,null);return null==s?(t=this.resMsg,t):(s.ElementInfo=i,t=super.Execute([s]),n.defaultText&&(s.UpdateInnerText(n.defaultText),super.GetEdtCtrl().MRefreshDocView()),t)}}t.A_InsertDateEle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertEmptySpaceEle=void 0;const r=n(0),i=n(48);class l extends i.A_InsertElement{ActName(){return"InsertEmptySpaceEle"}Execute(e){let t=new r.XEmptyLineSpaceEle;return super.Execute([t])}}t.A_InsertEmptySpaceEle=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertHavNoEle=void 0;const r=n(54),i=n(68),l=n(178),s=n(42),o=n(3),a=n(87);class u extends i.A_BaseInsertInput{ActName(){return"InsertHavNoEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new r.ElementInfo;i.Code_mrdetp="7001",i.Id_mr_de=n.elementCode,i.conceptDomainCode=n.conceptDomainCode,i.ExtendAttr1=n.extendAttr1,i.LackEllipsisvalue=n.defaultValue,i.DynamicData=n.dynamicData,i.Name=n.elementName,i.Name_de=n.dataEmementName,i.ValueCode_de=n.dataEmementCode,i.Text_label=n.labelText,i.Suffix_label=n.suffixText,i.Text_background=n.backgroundText,i.Text_tip=n.tooltipText,i.Name_source=n.sourceName,i.Name_property=n.attributeName,i.DefaultValue=n.defaultText,i.Activation_Mode_Key=n.activateWay,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Su_des=n.surePrefix,i.Ne_des=n.denyPrefix,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.IsAddCallBack=n.addFlag,i.IsAllowKeyInput=n.keyFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag,i.QuoteSource=1==n.quoteSource,i.QuoteTarget=1==n.quoteTarget,i.IsPrint=n.printFlag,i.IsDisSkip=n.skipFlag,i.Gender=n.sexJudge,i.MaxAge=n.maxAge,i.MinAge=n.minAge;let u=new o.List,h=n.valueList;for(let e=0;e<h.length;e++){let t=new a.SelEleItemInfo,n=h[e].Value,r=h[e].Key,i=h[e].Level;t.Value=n,t.Key=r,t.Level=i,t.Index=e+1,u.Add(t)}i.Valuelist=u;let d=s.XInputFactory.GetInstance().GetSelect(i,null);return null==d?(t=this.resMsg,t):(l.InputFieldUtil.OutInputFieldDetailMsg(d),d.ElementInfo=i,t=super.Execute([d]),n.defaultText&&(d.UpdateInnerText(n.defaultText),super.GetEdtCtrl().MRefreshDocView()),t)}}t.A_InsertHavNoEle=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertImage=void 0;const r=n(2),i=n(0),l=n(75),s=n(29),o=n(48);class a extends o.A_InsertElement{ActName(){return"InsertImage"}Execute(e){let t;if(this.insertImg=e[0]?e[0]:null,this.imgbase64=e[1]?e[1]:null,this.IsImgBase64=null==e[2]||e[2],this.resMsg=super.Execute([null]),null==this.newEle||null==this.newEle.Parent)t=this.resMsg;else{let e=super.GetEdtCtrl().M_GetHandlerLayerMgr();null!=e&&e.Handle(r.ENumEvtSrc.MOUSE_LPRESS,s.Keys.None,0,0,0,0),t=this.resMsg}return t}CrtNewEle(e,t){let n,r=e,s=this.insertImg;s.ImageEle=r;let o=i.XElementFactory.CreatXElement("XImage",null),a=o;if(null==a)!0,n=null;else if(a instanceof l.XImageEle){a.ImgInfo.IsImgBase64=this.IsImgBase64,this.IsImgBase64||(a.ImgInfo.ImgBase64=this.imgbase64),a.ImgObj=s.imgObj;let e=super.GetEdtCtrl().M_EleEvtModel;a.InitSizeByImgObj(e.EleClicked),a.setImgObj(this.imgbase64,this.IsImgBase64),!1,n=o}return n}}t.A_InsertImage=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertMoreChoiceDropEle=void 0;const r=n(54),i=n(68),l=n(178),s=n(42),o=n(3),a=n(87);class u extends i.A_BaseInsertInput{ActName(){return"InsertMoreChoiceDropEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new r.ElementInfo;i.Code_mrdetp="7003",i.Id_mr_de=n.elementCode,i.conceptDomainCode=n.conceptDomainCode,i.ExtendAttr1=n.extendAttr1,i.LackEllipsisvalue=n.defaultValue,i.DynamicData=n.dynamicData,i.Name=n.elementName,i.Name_de=n.dataEmementName,i.ValueCode_de=n.dataEmementCode,i.Text_label=n.labelText,i.Text_background=n.backgroundText,i.Text_tip=n.tooltipText,i.Name_source=n.sourceName,i.QuoteSource=1==n.quoteSource,i.QuoteTarget=1==n.quoteTarget,i.Name_property=n.attributeName,i.DefaultValue=n.defaultText,i.Activation_Mode_Key=n.activateWay,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.HasSearch=n.hasSearch,i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.IsAddCallBack=n.addFlag,i.IsAllowKeyInput=n.keyFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag,i.SelModel=n.choiceModel,i.Suffix_label=n.suffixText,i.IsPrint=n.printFlag,i.IsDisSkip=n.skipFlag,i.Gender=n.sexJudge,i.MaxAge=n.maxAge,i.MinAge=n.minAge;let u=new o.List,h=n.valueList;for(let e=0;e<h.length;e++){let t=new a.SelEleItemInfo,n=h[e].Value,r=h[e].Key,i=h[e].Level,l=h[e].GroupNum;t.Value=n,t.Key=r,t.Level=i,t.Index=e+1,t.GroupNum=l,u.Add(t)}i.Valuelist=u;let d=s.XInputFactory.GetInstance().GetSelect(i,null);return null==d?(t=this.resMsg,t):(l.InputFieldUtil.OutInputFieldDetailMsg(d),d.ElementInfo=i,t=super.Execute([d]),n.defaultText&&(d.UpdateInnerText(n.defaultText),super.GetEdtCtrl().MRefreshDocView()),t)}}t.A_InsertMoreChoiceDropEle=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertNumEle=void 0;const r=n(54),i=n(68),l=n(42),s=n(87),o=n(3);class a extends i.A_BaseInsertInput{ActName(){return"InsertNumEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0];""==n.maxValue&&(n.maxValue=void 0),""==n.minValue&&(n.minValue=void 0),""==n.decimalNum&&(n.decimalNum=void 0);let i=new r.ElementInfo;i.Id_mr_de=n.elementCode,i.Code_mrdetp="6001",i.Name=n.elementName,i.conceptDomainCode=n.conceptDomainCode,i.ExtendAttr1=n.extendAttr1,i.LackEllipsisvalue=n.defaultValue,i.DynamicData=n.dynamicData,i.Name_de=n.dataEmementName,i.QuoteSource=1==n.quoteSource,i.QuoteTarget=1==n.quoteTarget,i.ShowDialog=n.showDialog,i.EditorMode=n.editorMode,i.ValueCode_de=n.dataEmementCode,i.Text_label=n.labelText,i.Suffix_label=n.suffixText,i.Text_background=n.backgroundText,i.Text_tip=n.tooltipText,i.Name_source=n.sourceName,i.Name_property=n.attributeName,i.DefaultValue=n.defaultText,i.Activation_Mode_Key=n.activateWay,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.Text_unit=n.elementUnit,i.Nu_digit=n.decimalNum,i.Nu_max=n.maxValue,i.Nu_min=n.minValue,i.IsAddCallBack=n.addFlag,i.IsAllowKeyInput=n.keyFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag,i.Suffix_label=n.suffixText,i.IsPrint=n.printFlag,i.IsDisSkip=n.skipFlag,i.Gender=n.sexJudge,i.MaxAge=n.maxAge,i.MinAge=n.minAge,i.CheckMaxValue=""!=n.maxValue,i.CheckMinValue=""!=n.minValue;let a=new o.List,u=n.elementUnitList;if(u&&u.length>0){for(let e=0;e<u.length;e++){let t=new s.SelEleItemInfo,n=u[e].Value,r=u[e].Key;t.Value=n,t.Key=r,t.Index=e+1,a.Add(t)}i.Text_unitList=a}let h=l.XInputFactory.GetInstance().GetNumber(i,null);return null==h?(t=this.resMsg,t):(h.ElementInfo=i,t=super.Execute([h]),n.defaultText&&(h.UpdateInnerText(n.defaultText),super.GetEdtCtrl().MRefreshDocView()),t)}}t.A_InsertNumEle=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertPageNum=void 0;const r=n(0),i=n(48),l=n(179),s=n(2);class o extends i.A_InsertElement{constructor(){super(),this.pgnumFormWrap=null,this.pgnumFormWrap=new l.PageNumFormWrap}ActName(){return"InsertPageNum"}Execute(e){let t=e[0],n=r.XElementFactory.CreatXElement("XPageInfo",null);return this.pgnumFormWrap.ShowPageNumForm(n,this.GetEdtCtrl(),s.ENumWorkMode.Design,t),this.resMsg=super.Execute([n]),this.resMsg}CrtNewEle(e,t){let n,i=r.XElementFactory.CreatXElement("XPageInfo",null),l=i;return this.pgnumFormWrap.ShowPageNumForm(l,this.GetEdtCtrl(),s.ENumWorkMode.Design,e)?(!1,n=i):(!0,n=null),n}}t.A_InsertPageNum=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrCheckBoxType=void 0,function(e){e[e.Default=0]="Default",e[e.LoacalPageIndex=1]="LoacalPageIndex",e[e.LoacalTotalPageCnt=2]="LoacalTotalPageCnt",e[e.PageIndex=4]="PageIndex",e[e.TotalPageCnt=8]="TotalPageCnt"}(t.EmrCheckBoxType||(t.EmrCheckBoxType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertQrCode=void 0;const r=n(0),i=n(144),l=n(48),s=n(133),o=n(107);class a extends l.A_InsertElement{ActName(){return"InsertQrCode"}Execute(e){this.resMsg.Clear();var t=e[0];let n=o.InsertElementBack.getQRCodeInfo(t),r=(o.InsertElementBack.getQRCodeType(n.CodeStyleStr),s.XCodeUtil.GetInstance().BuildQRcode(n.Content));return n.GetEditBarcodeImage=r,this.codeForm_BtnClick(n,i.BtnClickEvents.OkBtnClickEvent,null),this.resMsg}codeForm_BtnClick(e,t,n){if(t==i.BtnClickEvents.OkBtnClickEvent&&null!=e.GetEditBarcodeImage){let t=r.XElementFactory.CreatXElement("XBarcodeField",null);null!=t&&(t.InitCodeEle(e),this.resMsg=super.Execute([t]),super.GetEdtCtrl().MRefreshDocView())}}}t.A_InsertQrCode=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertRadioGroup=void 0;const r=n(40),i=n(54),l=n(68),s=n(42),o=n(3),a=n(87);class u extends l.A_BaseInsertInput{ActName(){return"InsertRadioGroup"}Execute(e){let t;this.resMsg.Clear();let n=e[0],l=new i.ElementInfo;l.Code_mrdetp="8001",l.Id_mr_de=n.elementCode,l.conceptDomainCode=n.conceptDomainCode,l.ExtendAttr1=n.extendAttr1,l.LackEllipsisvalue=n.defaultValue,l.DynamicData=n.dynamicData,l.Name=n.elementName,l.Name_de=n.dataEmementName,l.ValueCode_de=n.dataEmementCode,l.Text_tip=n.tooltipText,l.OnlyPrintCheckedItem=!0===n.onlyPrintCheckedItem,l.Name_source=n.sourceName,l.Name_property=n.attributeName,l.BaseChoiceShowStyle=n.displayStyle,l.VAlign=n.verticalAlign,l.IsShowRightText=n.textShow,l.IsTextRightShow=n.textRightShow,l.IsStrongShow=n.groupStrongShow,l.Fg_delete=n.deleteFlag,l.Fg_hide=n.hideFlag,l.QuoteSource=1==n.quoteSource,l.QuoteTarget=1==n.quoteTarget,l.IsMustChoose=n.chooseFlag,l.IsPrint=n.printFlag,null!=n.expressionInput&&null!=n.expressionInput&&(l.Text_Expression=decodeURIComponent(n.expressionInput)),l.Gender=n.sexJudge,l.MaxAge=n.maxAge,l.MinAge=n.minAge;let u=new o.List,h=n.valueList;for(let e=0;e<h.length;e++){let t=new a.SelEleItemInfo,n=h[e].Value,r=h[e].Key;t.Value=n,t.Key=r,t.Level=0,t.Index=-1,t.GrpId="",u.Add(t)}l.Valuelist=u;try{let e=s.XInputFactory.GetInstance().GetRadio(l,null);if(null==e)return t=this.resMsg,t;e.InputType=r.EleTypeEnum.SingleChoiceGroupEle;for(let t=0;t<e.Length;t++)this.resMsg=super.Execute([e.Get(t)]);super.GetEdtCtrl().MRefreshDocView()}catch(e){this.resMsg.Ex=e}return t=this.resMsg,t}}t.A_InsertRadioGroup=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertShape=void 0;const r=n(168),i=n(230),l=n(365),s=n(48);class o extends s.A_InsertElement{ActName(){return"InsertShape"}Execute(e){let t=e[0],n=new r.ShapeInfo;n.Type=t.insertType,n.No=t.attributeCode,n.Name=t.attributeName,n.ShapeKey=t.shapeType,n.ShapeText=t.displayText,n.AlignKey=t.alignWay;let s=new i.XShapeEle;return s.Bounds.Height=100,s.Bounds.Width=200,"CirCle"==t.shapeType&&(n.RoundAngle=t.roundRadian,s.Bounds.Height=200,s.Bounds.Width=200),"CirRect"==t.shapeType&&(n.RoundAngle=t.roundRadian),"Ellipse"==t.shapeType&&(n.HorEllipseNum=t.levelThan,n.RoundAngle=t.roundRadian,n.VerEllipseNum=t.verticalThan),l.XExtendEleUtil.ReInitShapeEleByInfo(s,n),this.resMsg=super.Execute([s]),super.GetEdtCtrl().MRefreshDocView(),this.resMsg}}t.A_InsertShape=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeEditInfo=void 0;t.CodeEditInfo=class{constructor(){this._codeText=null,this._codeXml=null,this._className=null,this._language=null,this._MainMethod=null,this._ImportUsingStr=null}get CodeText(){return this._codeText}set CodeText(e){this._codeText=e}get CodeXml(){return this._codeXml}set CodeXml(e){this._codeXml=e}get ClassName(){return this._className}set ClassName(e){this._className=e}get Language(){return this._language}set Language(e){this._language=e}get MainMethod(){return this._MainMethod}set MainMethod(e){this._MainMethod=e}get ImportUsingStr(){return this._ImportUsingStr}set ImportUsingStr(e){this._ImportUsingStr=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertSingleChoiceDropEle=void 0;const r=n(54),i=n(48),l=n(178),s=n(42),o=n(87),a=n(3);class u extends i.A_InsertElement{ActName(){return"InsertSingleChoiceDropEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new r.ElementInfo;i.Id_mr_de=n.elementCode,i.Code_mrdetp="7002",i.conceptDomainCode=n.conceptDomainCode,i.ExtendAttr1=n.extendAttr1,i.LackEllipsisvalue=n.defaultValue,i.DynamicData=n.dynamicData,i.Name=n.elementName,i.Name_de=n.dataEmementName,i.ValueCode_de=n.dataEmementCode,i.Text_label=n.labelText,i.Suffix_label=n.suffixText,i.Text_background=n.backgroundText,i.Text_tip=n.tooltipText,i.Name_source=n.sourceName,i.Name_property=n.attributeName,i.DefaultValue=n.defaultText,i.Activation_Mode_Key=n.activateWay,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.HasSearch=n.hasSearch,i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.IsAddCallBack=n.addFlag,i.QuoteSource=1==n.quoteSource,i.QuoteTarget=1==n.quoteTarget,i.IsAllowKeyInput=n.keyFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag,i.IsPrint=n.printFlag,i.IsDisSkip=n.skipFlag,i.Gender=n.sexJudge,i.MaxAge=n.maxAge,i.MinAge=n.minAge;let u=new a.List,h=n.valueList;for(let e=0;e<h.length;e++){let t=new o.SelEleItemInfo,n=h[e].Value,r=h[e].Key,i=h[e].Level,l=h[e].ChildEleItems;if(null!=l)for(let e=0;e<l.length;e++){let n=new o.SelEleItemInfo,r=l[e].Value,i=l[e].Key,s=l[e].Level;n.Value=r,n.Key=i,n.Level=s,t.ChildEleItems.Add(n)}t.Value=n,t.Key=r,t.Level=i,t.Index=e+1,u.Add(t)}i.Valuelist=u;let d=s.XInputFactory.GetInstance().GetSelect(i,null);return null==d?(t=this.resMsg,t):(l.InputFieldUtil.OutInputFieldDetailMsg(d),d.ElementInfo=i,t=super.Execute([d]),n.defaultText&&(d.UpdateInnerText(n.defaultText),super.GetEdtCtrl().MRefreshDocView()),t)}}t.A_InsertSingleChoiceDropEle=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertSpliteLine=void 0;const r=n(0),i=n(144),l=n(48),s=n(107);class o extends l.A_InsertElement{ActName(){return"InsertSpliteLine"}Execute(e){this.resMsg.Clear();let t=e[0],n=s.InsertElementBack.getSpliteLineInfo(t);return this.BtnClick(n,i.BtnClickEvents.OkBtnClickEvent,null),this.resMsg}BtnClick(e,t,n){if(t==i.BtnClickEvents.OkBtnClickEvent){let t=new r.XSpliteLineEle;t.InitSpliteLineEle(e,super.GetEdtCtrl().M_EleEvtModel.EleClicked),this.resMsg=super.Execute([t]),super.GetEdtCtrl().MRefreshDocView()}}}t.A_InsertSpliteLine=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertSqlElement=void 0;const r=n(54),i=n(68),l=n(178),s=n(42);class o extends i.A_BaseInsertInput{ActName(){return"InsertSqlEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new r.ElementInfo;i.Code_mrdetp="7004",i.Id_mr_de=n.elementCode,i.Name=n.elementName,i.Name_de=n.dataEmementName,i.ValueCode_de=n.dataEmementCode,i.Text_label=n.labelText,i.Text_background=n.backgroundText,i.Text_tip=n.tooltipText,i.Name_source=n.sourceName,i.Name_property=n.attributeName,i.DefaultValue=n.defaultText,i.Activation_Mode_Key=n.activateWay,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Sql_WriteBack_PropName=n.echoField,i.SqlText=n.sqlSentence,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.IsAddCallBack=n.addFlag,i.IsAllowKeyInput=n.keyFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag;let o=s.XInputFactory.GetInstance().GetSqlInputEle(i,null);return null==o?(t=this.resMsg,t):(l.InputFieldUtil.OutInputFieldDetailMsg(o),o.ElementInfo=i,t=super.Execute([o]),t)}}t.A_InsertSqlElement=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertTextEle=void 0;const r=n(54),i=n(68),l=n(42);class s extends i.A_BaseInsertInput{ActName(){return"InsertTextEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new r.ElementInfo;i.Code_mrdetp="5002",i.conceptDomainCode=n.conceptDomainCode,i.Id_mr_de=n.elementCode,i.Name=n.elementName,i.Name_de=n.dataEmementName,i.ValueCode_de=n.dataEmementCode,i.Text_label=n.labelText,i.Suffix_label=n.suffixText,i.Text_background=n.backgroundText,i.Text_tip=n.tooltipText,i.Name_source=n.sourceName,i.Name_property=n.attributeName,i.DefaultValue=n.defaultText,i.Activation_Mode_Key=n.activateWay,i.EditorEventActiveMode=n.editorEventActiveMode,i.ExtendAttr1=n.extendAttr1,i.LackEllipsisvalue=n.defaultValue,i.DynamicData=n.dynamicData,i.CustomAttribute=n.customAttribute,i.InputEventName=n.triggerAction,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.QuoteSource=1==n.quoteSource,i.QuoteTarget=1==n.quoteTarget,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag,i.Lg_max=n.maxLength,i.Lg_min=n.minimumLength,i.IsPrint=n.printFlag,i.IsDisSkip=n.skipFlag,i.Gender=n.sexJudge,i.MaxAge=n.maxAge,i.MinAge=n.minAge;let s=l.XInputFactory.GetInstance().GetText(i,null);return null==s?(t=this.resMsg,t):(s.ElementInfo=i,t=super.Execute([s]),n.defaultText&&(s.UpdateInnerText(n.defaultText),super.GetEdtCtrl().MRefreshDocView()),t)}}t.A_InsertTextEle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertFraction=void 0;const r=n(0),i=n(60),l=n(48);class s extends l.A_InsertElement{ActName(){return"InsertFraction"}Execute(e){let t,n=r.XElementFactory.CreatXElement("Fraction",null);if(null==n)t=this.resMsg;else{let r=i.EmrApiUtil.ConvertStrToFractionType(e[0]);n.InitFractionEle("","",r),t=super.Execute([n])}return t}ChkActParamsCnt(e){let t;return null==e||e.length<1?(this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName+" 调用参数有误",t=!1):t=!0,t}}t.A_InsertFraction=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertMedExpression=void 0;const r=n(0),i=n(223),l=n(169),s=n(171),o=n(4),a=n(48);class u extends a.A_InsertElement{ActName(){return"InsertMedicalExpression"}Execute(e){let t;if(this.resMsg.Clear(),e.length<1)t=this.resMsg;else{let n=e[0],i=n.formulaType;if(!o.default.IsNullOrEmpty(i)){let e=this.BulidInsertMedicalInfo(i);if(e.conceptDomainCode=n.conceptDomainCode,e.ValueCode_de=n.dataEmementCode,e.Name_de=n.dataEmementName,e.No=n.attributeCode,e.Name=n.displayText,e.VAlign=n.alignWay,e.Type=n.insertType,e.Gender=n.sexJudge,e.MaxAge=n.maxAge,e.MinAge=n.minAge,null!=e){let t=new r.XMedicalExpressionField;t.InitMeicalExpression(e,super.GetEdtCtrl().M_EleEvtModel.EleClicked,!0),t.MedExpSettingInfo=this.BulidMedSettingInfo(t.ExpressionStyle),super.Execute([t])}}t=this.resMsg}return t}BulidInsertMedicalInfo(e){let t,n=null;switch(e){case"FourValues":n=new l.MedExpressionItemInfo,n.IconName="FourValues-1",n.Text="月经公式1",n.Type="FourValues",n.DefaultValue="初潮年龄,经期,周期,绝经年龄,false,false";break;case"FourValues1":n=new l.MedExpressionItemInfo,n.IconName="FourValues1-1",n.Text="月经公式2",n.Type="FourValues1",n.DefaultValue="初潮年龄,经期,绝经年龄,周期";break;case"FourValues2":n=new l.MedExpressionItemInfo,n.IconName="FourValues2-1",n.Text="月经公式3",n.Type="FourValues2",n.DefaultValue="初潮年龄,经期,绝经年龄,周期";break;case"ThreeValues":n=new l.MedExpressionItemInfo,n.IconName="ThreeValues-1",n.Text="月经公式4",n.Type="ThreeValues",n.DefaultValue="初潮年龄,经期,周期";break;case"Pupil":n=new l.MedExpressionItemInfo,n.IconName="Pupil-1",n.Text="瞳孔图",n.Type="Pupil",n.DefaultValue=",,,,,,";break;case"LightPositioning":n=new l.MedExpressionItemInfo,n.IconName="LightPositioning-1",n.Text="光定位图",n.Type="LightPositioning",n.DefaultValue=",,,,,,,,";break;case"FetalHeart":n=new l.MedExpressionItemInfo,n.IconName="FetalHeart-1",n.Text="胎心图",n.Type="FetalHeart",n.DefaultValue=",,,,,";break;case"PainIndex":n=new l.MedExpressionItemInfo,n.IconName="ruler",n.Text="标尺图",n.Type="PainIndex"}return null!=n?(t=new i.InsertMedExpressionItemInfo,t.ItemInfo=n,t.Name=n.Name,t.VAlign="Center"):t=null,t}BulidMedSettingInfo(e){let t;return t="PainIndex"==e?new s.RulerInfo("Default"):null,t}}t.A_InsertMedExpression=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertString=void 0;const r=n(2),i=n(16),l=n(58),s=n(3),o=n(4),a=n(13),u=n(1),h=n(108),d=n(55),c=n(0);class p extends u.XBaseAction{constructor(){super(),this.edt_elerange=null,super.OpType=r.ENumActOpType.CtntEdit,this.edt_elerange=new d.EmrEditEleRange}ActName(){return"InsertString"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl().M_EleEvtModel.EleClicked,r=super.GetEdtCtrl().M_EleEvtModel.WorkMode;if(this.CheckAddRule(r,n))if(null==e||0==e.length)this.resMsg.CodeStr="InsertFail",t=this.resMsg;else{let n,r=e.length,l=e[0],u=!1,d=e.length>=2?e[1]:null;if("boolean"==typeof d?u=!0===d:"string"==typeof d&&(n=d),r>0&&"object"==typeof e[0]){let t=e[0];l=t.text,n=t.undoRelateId,u=!0===t.changeFlag}if(o.default.IsNullOrEmpty(l)){let e=new a.UndoGroup;const n=super.GetEdtCtrl(),r=n.M_EleEvtModel;let i=r.SelRange;null!=i&&i.IsValid()&&(this.edt_elerange.SetEleEvtObjs(r,n.M_EleEvtHandler),this.edt_elerange.DelSelRange(127,e,this.resMsg),super._AddUndoItem(e),super._RefreshPageAndMoveCaret(!0,!0)),t=this.resMsg}else{let e=super.GetEdtCtrl(),r=new a.UndoGroup,o=this.IsChangeText(l);this.edt_elerange.SetEleEvtObjs(e.M_EleEvtModel,e.M_EleEvtHandler),this.edt_elerange.DelSelRange(127,r,this.resMsg);let d=e.M_EleEvtModel.EleClicked,p=this.CorrectStyle(d),f=new s.List,g=h.EditEleRange.BuildElesFromStr(l,p,f,e.M_EleEvtModel.EleClickedWrap),m=f.ToArray();g instanceof c.XBaseContainer&&(g.GetFirstChildBaseEle(!1).UndoRelateId=n,g._GetLastBaseEle(!1).UndoRelateId=n);let E=this.edt_elerange.InsertNewEles(-1,g,m,r,this.resMsg);f.Clear();let C=i.XDomUtil.GetParentXInput(g,!1);if(null!=C&&C.TextChanged(),u&&this.SetTimeChangeColor([g,...m]),E&&o){const t=e.M_EleFocused;t&&t.OwnerDocPanel&&(t.OwnerDocPanel.IsChanged=!0),super._AddUndoItem(r)}else this.resMsg.CodeStr="InsertFail";super._RefreshPageAndMoveCaret(!0,!0),t=this.resMsg}}else this.resMsg.CodeStr="InsertFail",t=this.resMsg;return t}IsChangeText(e){const t=super.GetEdtCtrl().M_EleEvtModel.SelRange;let n=t.InfoUtil.GetLineElesInRange(!0,!0);const r=t.BuildEleRangeAsText(n);let i=!0;if(n&&n.length>0)for(let e of n)e instanceof c.XCharacterEle||e instanceof c.XStringEle||(i=!1);return!(r==e&&i)}CorrectStyle(e){let t=new l.XBaseEleStyle(!1);t.CopyFrom(e.EleStyle,!1);const n=super.GetEdtCtrl().DefaultSetting;return n.InputFiled_IsDoctorEditorMode&&(t.EditForeColor=n.InputFieldEditForeColor),t}}t.A_InsertString=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertTeeth=void 0;const r=n(0),i=n(75),l=n(48),s=n(366),o=n(2),a=n(29),u=n(180);class h extends l.A_InsertElement{constructor(){super(...arguments),this.TeechImgEnum=u.default.TeechImg}ActName(){return"InsertTeeth"}Execute(e){this.resMsg.Clear();try{let t=!0===e[0].useEditorTeeth,n=this;if(1==this.TeechImgEnum&&t)new s.ToothPositionDialog({width:800,height:500,onOk:function(e,t){n.OnOK_TeechEdtForm(e,t,"","","",!0)}});else{let t=e[0],r=t.imgObj;this.dataString=t.teethmap;let i=t.width,l=t.height;this.UndoRelateId=t.undoRelateId,this.useEditorTeeth=!0===t.useEditorTeeth;const s=null==t.IsImgBase64||t.IsImgBase64;this.IsImgBase64=s,n.InsertTeethByParams(r,i,l)}this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}OnOK_TeechEdtForm(e,t,n,r,l,s){let u=new i.XImageEle;u.setImgObj(e);let h=new Image;h.src=e,this.dataString=t,this.imgWidth=n,this.imgHeight=r,this.useEditorTeeth=s,this.UndoRelateId=l,h.onload=()=>{let t;if(this.insertImg=u,this.imgbase64=e,this.resMsg=super.Execute([null]),null==this.newEle||null==this.newEle.Parent)t=this.resMsg;else{let e=super.GetEdtCtrl().M_GetHandlerLayerMgr();null!=e&&e.Handle(o.ENumEvtSrc.MOUSE_LPRESS,a.Keys.None,0,0,0,0),t=this.resMsg}return t}}CrtNewEle(e,t){let n,l=e,s=this.insertImg;s.ImageEle=l;let o=r.XElementFactory.CreatXElement("XImage",null),a=o;if(null==a)!0,n=null;else if(a instanceof i.XImageEle){a.ImgObj=s.imgObj,a.ImageType=i.ImageType.TeechBitmap,a.UseEditorTeeth=this.useEditorTeeth,a.DataString=this.dataString;let e=super.GetEdtCtrl().M_EleEvtModel;this.imgWidth&&(a.ImgObj.Width=this.imgWidth),this.imgHeight&&(a.ImgObj.Height=this.imgHeight),a.UndoRelateId=this.UndoRelateId,a.InitSizeByImgObj(e.EleClicked),a.setImgObj(this.imgbase64),!1,n=o}return n}InsertTeethByParams(e,t,n){let r=e,i="";if(this.IsImgBase64){let e=r.split(",");i=1==e.length?"data:image/gif;base64,"+e[0]:r}else i=r;let l=this,s=new Image;if(s.src=i,t&&n)return l.insertTeethSync(r,t,n,s,i);s.onload=()=>l.insertTeethSync(r,t,n,s,i)}insertTeethSync(e,t,n,r,l){let s,u=new i.XImageEle;if(u.setImgObj(e,this.IsImgBase64),u.ImgObj.Width=t||r.width,u.ImgObj.Height=n||r.height,this.insertImg=u,this.imgbase64=e,this.resMsg=super.Execute([null]),null==this.newEle||null==this.newEle.Parent)s=this.resMsg;else{let e=super.GetEdtCtrl().M_GetHandlerLayerMgr();null!=e&&e.Handle(o.ENumEvtSrc.MOUSE_LPRESS,a.Keys.None,0,0,0,0),s=this.resMsg}return s}}t.A_InsertTeeth=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToothPositionComp=t.ToothPosition=void 0;const r=n(12),i=n(24);n(807);const l=n(52),s=n(22),o=n(809);class a extends r.Component{constructor(e){super(e),this.popover=r.createRef(),this.canvasToImg=new o.CanvasToToothImg,this.state={toothType:"4",tooPositionType:"1",imageSrc:"",toothSurFace:!1,showSurFace:!1,surFaceInfo:{Quadrant:1,type:"",index:0},surFaceData:[],surFacePosition:{top:0,left:0},Extrateeth:!1,toothchioce:[{permanent:[{name:"8",checked:!1,surFace:[],Extrateeth:!1},{name:"7",checked:!1,surFace:[],Extrateeth:!1},{name:"6",checked:!1,surFace:[],Extrateeth:!1},{name:"5",checked:!1,surFace:[],Extrateeth:!1},{name:"4",checked:!1,surFace:[],Extrateeth:!1},{name:"3",checked:!1,surFace:[],Extrateeth:!1},{name:"2",checked:!1,surFace:[],Extrateeth:!1},{name:"1",checked:!1,surFace:[],Extrateeth:!1}],deciduous:[{name:"Ⅴ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅳ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅲ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅱ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅰ",checked:!1,surFace:[],Extrateeth:!1}]},{permanent:[{name:"1",checked:!1,surFace:[],Extrateeth:!1},{name:"2",checked:!1,surFace:[],Extrateeth:!1},{name:"3",checked:!1,surFace:[],Extrateeth:!1},{name:"4",checked:!1,surFace:[],Extrateeth:!1},{name:"5",checked:!1,surFace:[],Extrateeth:!1},{name:"6",checked:!1,surFace:[],Extrateeth:!1},{name:"7",checked:!1,surFace:[],Extrateeth:!1},{name:"8",checked:!1,surFace:[]}],deciduous:[{name:"Ⅰ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅱ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅲ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅳ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅴ",checked:!1,surFace:[]}]},{permanent:[{name:"8",checked:!1,surFace:[],Extrateeth:!1},{name:"7",checked:!1,surFace:[],Extrateeth:!1},{name:"6",checked:!1,surFace:[],Extrateeth:!1},{name:"5",checked:!1,surFace:[],Extrateeth:!1},{name:"4",checked:!1,surFace:[],Extrateeth:!1},{name:"3",checked:!1,surFace:[],Extrateeth:!1},{name:"2",checked:!1,surFace:[],Extrateeth:!1},{name:"1",checked:!1,surFace:[],Extrateeth:!1}],deciduous:[{name:"Ⅴ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅳ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅲ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅱ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅰ",checked:!1,surFace:[],Extrateeth:!1}]},{permanent:[{name:"1",checked:!1,surFace:[],Extrateeth:!1},{name:"2",checked:!1,surFace:[],Extrateeth:!1},{name:"3",checked:!1,surFace:[],Extrateeth:!1},{name:"4",checked:!1,surFace:[],Extrateeth:!1},{name:"5",checked:!1,surFace:[],Extrateeth:!1},{name:"6",checked:!1,surFace:[],Extrateeth:!1},{name:"7",checked:!1,surFace:[],Extrateeth:!1},{name:"8",checked:!1,surFace:[]}],deciduous:[{name:"Ⅰ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅱ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅲ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅳ",checked:!1,surFace:[],Extrateeth:!1},{name:"Ⅴ",checked:!1,surFace:[]}]}]}}getRadioValue(){let e,t=document.getElementsByName("lesions");for(let n=0;n<t.length;n++)1==t[n].checked&&(e=t[n].value);return e}setRadioValue(e){let t=document.getElementsByName("lesions");for(let n=0;n<t.length;n++)t[n].value==e&&(t[n].checked=!0)}componentDidMount(){if(this.props.parent.React=this,!this.props.DataString)return;let e=this.props.DataString,t=JSON.parse(e),{toothSurFace:n,Extrateeth:r,toothchioce:i}=t;n&&this.setState({toothSurFace:n}),r&&this.setState({Extrateeth:r}),i&&this.setState({toothchioce:i})}toothTypeClick(e){let t=e.target.getAttribute("data-toothtype"),n=e.target.getAttribute("data-toopositiontype");this.setState({toothType:t,tooPositionType:n}),this.setState({imageSrc:""}),this.canvasToImg.clear()}lesionsChange(e){this.setState({imageSrc:""}),this.canvasToImg.clear();e.target.value}okHandler(){let{toothSurFace:e,Extrateeth:t,toothchioce:n}=this.state,r={toothSurFace:e,Extrateeth:t,toothchioce:n},i=JSON.stringify(r);this.props.onOk(this.state.imageSrc,i)}renderLeftType(){let e=[{name:"混合牙位图",img:"",toothType:4,tooPositionType:1}].map((e,t)=>r.createElement("li",{onClick:e=>{this.toothTypeClick(e)},className:this.state.tooPositionType==e.tooPositionType?"active":"","data-toothtype":e.toothType,"data-toopositiontype":e.tooPositionType,key:t},e.name));return r.createElement("ul",null,e)}getImageInfo(){setTimeout(()=>{let e=this.state.toothchioce,t=this.state.toothSurFace,n=this.state.Extrateeth,r=this.canvasToImg.getImage1(t,n,e);this.setState({imageSrc:r})})}renderRightContent(e){let t;switch(e){case"1":t=this.renderdetail1("混合牙位图");break;case"2":t=this.renderdetail4();break;case"3":t=this.renderdetail5();break;case"5":t=this.renderdetail6();break;case"6":t=this.renderdetail1("电活力测")}return r.createElement("div",null,r.createElement("div",{style:{position:"relative"}},this.renderToothSurFace(),t,r.createElement("div",{className:"privewtooth"},r.createElement("img",{src:this.state.imageSrc,alt:""}))))}toothNumber(e){let t=Number(e.target.getAttribute("data-quadrant")),n=e.target.getAttribute("data-type"),r=Number(e.target.getAttribute("data-index")),i=this.state.toothchioce,l=!i[t-1][n][r].checked;i[t-1][n][r].checked=l,l||(i[t-1][n][r].Extrateeth=!1,0!=r||2!=t&&4!=t?0!=r&&(i[t-1][n][r-1].Extrateeth=!1):i[t-2][n][i[t-2][n].length-1].Extrateeth=!1),this.setState({toothchioce:i}),this.getImageInfo()}checkStatus(e){let t=e.target.getAttribute("data-status");"toothSurFace"==t?this.setState({toothSurFace:!this.state.toothSurFace,showSurFace:!1}):"Extrateeth"==t&&this.setState({Extrateeth:!this.state.Extrateeth}),this.getImageInfo()}changeCheckBox(e){let t=e.target.checked,n=e.target.getAttribute("data-quadrant"),r=e.target.getAttribute("data-type"),i=this.state.toothchioce;"all"==n?i.map((e,n)=>{e[r].forEach((e,n)=>{e.checked=t})}):i[n-1][r].forEach((e,n)=>{e.checked=t}),this.setState({toothchioce:i}),this.getImageInfo()}mouseEnterNumber(e,t,n,r){let i=1==n?"deciduous":"permanent",{surFaceInfo:l,toothchioce:s}=this.state;if(!this.state.toothSurFace||!s[t-1][i][r].checked)return;l.Quadrant=t,l.type=n,l.index=r;let o={left:e.target.offsetParent.offsetLeft,top:e.target.offsetParent.offsetTop+e.target.offsetParent.offsetHeight-2};this.setState({showSurFace:!0,surFaceInfo:l,surFacePosition:o,surFaceData:s[t-1][i][r].surFace})}mouseLeaveNumber(e){}checkSurFace(e){let{toothchioce:t,surFaceInfo:n}=this.state,{Quadrant:r,type:i,index:l}=n,s=1==i?"deciduous":"permanent";t[r-1][s][l].surFace=e,this.setState({toothchioce:t}),this.getImageInfo()}checkExtrateeth(e,t,n,r){if(t=Number(t),r=Number(r),!this.state.Extrateeth)return;let i=this.state.toothchioce,l=1==n?"deciduous":"permanent",s=!i[t-1][l][r].Extrateeth;i[t-1][l][r].Extrateeth=s,s&&(i[t-1][l][r].checked=!0,i[t-1][l].length-1==r?i[t][l][0].checked=!0:i[t-1][l][r+1].checked=!0),this.setState({toothchioce:i}),this.getImageInfo()}renderToothPostion(e,t){let n=1==t?"deciduous":"permanent",i=this.state.toothchioce[e-1][n];return i.map((l,s)=>r.createElement("span",{key:`${n}${e}${s}`},r.createElement("i",{onMouseEnter:n=>{this.mouseEnterNumber(n,e,t,s)},onMouseLeave:e=>{this.mouseLeaveNumber(e)},onClick:e=>{this.toothNumber(e)},"data-quadrant":e,"data-type":n,"data-item":l.name,"data-index":s,className:"number "+(l.checked?"active":"")},l.name),r.createElement("i",{onClick:n=>{this.checkExtrateeth(n,e,t,s)},className:`arrow ${this.state.Extrateeth&&(s!=i.length-1||2!=e&&4!=e)?"":"hide"} ${l.Extrateeth?"active":""}`})))}renderToothSurFace(){return r.createElement(u,{ref:this.popover,display:this.state.showSurFace?"block":"none",data:this.state.surFaceData,positioninfo:this.state.surFacePosition,checkSurFace:this.checkSurFace.bind(this)})}isChecked(e,t){let n=this.state.toothchioce,r=!0;return"all"==e?n.forEach((e,n)=>{e[t].forEach((e,t)=>{0==e.checked&&(r=!1)})}):n[e-1][t].forEach((e,t)=>{0==e.checked&&(r=!1)}),r}renderdetail1(e){return r.createElement(r.Fragment,null,r.createElement("div",{className:"subtitle"},e),r.createElement("div",{className:"Permanent"},r.createElement("div",{className:"checktoothposition"},r.createElement("div",null,r.createElement("span",null,"乳牙："),r.createElement("input",{id:"alldeciduous","data-quadrant":"all","data-type":"deciduous",onChange:e=>{this.changeCheckBox(e)},type:"checkbox",checked:this.isChecked("all","deciduous")}),"全口"),r.createElement("div",null,r.createElement("input",{"data-quadrant":"2","data-type":"deciduous",id:"deciduousRT",onChange:e=>{this.changeCheckBox(e)},type:"checkbox",checked:this.isChecked(2,"deciduous")}),"右上",r.createElement("input",{"data-quadrant":"4","data-type":"deciduous",id:"deciduousRB",onChange:e=>{this.changeCheckBox(e)},type:"checkbox",checked:this.isChecked(4,"deciduous")}),"右下"),r.createElement("div",null,r.createElement("input",{"data-quadrant":"1","data-type":"deciduous",id:"deciduousLT",onChange:e=>{this.changeCheckBox(e)},type:"checkbox",checked:this.isChecked(1,"deciduous")}),"左上",r.createElement("input",{"data-quadrant":"3","data-type":"deciduous",id:"deciduousLB",onChange:e=>{this.changeCheckBox(e)},type:"checkbox",checked:this.isChecked(3,"deciduous")}),"左下"),r.createElement("div",null,r.createElement("span",{style:{width:"75px",display:"inline-block"}},"牙 面："),r.createElement("span",{"data-status":"toothSurFace",onClick:e=>{this.checkStatus(e)},className:"typeswitch "+(this.state.toothSurFace?"on":"off")},this.state.toothSurFace?"on":"off"))),r.createElement("div",{className:"checktoothposition"},r.createElement("div",null,r.createElement("span",null,"恒牙："),r.createElement("input",{checked:this.isChecked("all","permanent"),id:"allpermanent","data-quadrant":"all","data-type":"permanent",onChange:e=>{this.changeCheckBox(e)},type:"checkbox"}),"全口"),r.createElement("div",null,r.createElement("input",{"data-quadrant":"2","data-type":"permanent",id:"permanentRT",onChange:e=>{this.changeCheckBox(e)},type:"checkbox",checked:this.isChecked(2,"permanent")}),"右上",r.createElement("input",{"data-quadrant":"4","data-type":"permanent",id:"permanentRB",onChange:e=>{this.changeCheckBox(e)},type:"checkbox",checked:this.isChecked(4,"permanent")}),"右下"),r.createElement("div",null,r.createElement("input",{"data-quadrant":"1","data-type":"permanent",id:"permanentLT",onChange:e=>{this.changeCheckBox(e)},type:"checkbox",checked:this.isChecked(1,"permanent")}),"左上",r.createElement("input",{"data-quadrant":"3","data-type":"permanent",id:"permanentLB",onChange:e=>{this.changeCheckBox(e)},type:"checkbox",checked:this.isChecked(3,"permanent")}),"左下"),r.createElement("div",null,r.createElement("span",{style:{width:"75px",display:"inline-block"}},"多生牙："),r.createElement("span",{"data-status":"Extrateeth",onClick:e=>{this.checkStatus(e)},className:"typeswitch "+(this.state.Extrateeth?"on":"off")},this.state.Extrateeth?"on":"off"))),r.createElement("div",{className:"toothnumber numbertype1"},this.renderToothPostion(1,1),this.renderToothPostion(2,1)),r.createElement("div",{className:"toothnumber numbertype2"},this.renderToothPostion(1,0),this.renderToothPostion(2,0)),r.createElement("div",{className:"toothnumber numbertype2"},this.renderToothPostion(3,0),this.renderToothPostion(4,0)),r.createElement("div",{className:"toothnumber numbertype1"},this.renderToothPostion(3,1),this.renderToothPostion(4,1))))}renderdetail4(){return r.createElement(r.Fragment,null,r.createElement("div",{className:"subtitle"},"PD图"),r.createElement("div",{className:"Permanent pdimage"},r.createElement("div",null),r.createElement("div",null)))}renderdetail5(){return r.createElement(r.Fragment,null,r.createElement("div",{className:"subtitle"},"病变牙位图"),r.createElement("div",{className:"Lesions"},r.createElement("div",{className:"three"},r.createElement("div",{className:"Lesionsline1 Lesionsline"}),r.createElement("div",{className:"Lesionsline2 Lesionsline"}),r.createElement("div",{className:"Lesionsline3 Lesionsline"}),r.createElement("div",{className:"radio"},r.createElement("input",{name:"lesions",onChange:e=>{this.lesionsChange(e)},type:"radio",defaultChecked:!0,value:"3"}))),r.createElement("div",{className:"two"},r.createElement("div",null,r.createElement("input",{name:"lesions",onChange:e=>{this.lesionsChange(e)},type:"radio",value:"2"})))))}renderdetail6(){return r.createElement(r.Fragment,null,r.createElement("div",{className:"subtitle"},"GR牙位图"),r.createElement("div",{className:"Permanent grimage"},r.createElement("div",null),r.createElement("div",null)))}render(){return r.createElement(l.Dialog,{onOk:this.okHandler.bind(this),width:this.props.width,height:this.props.height,visible:!0,isDestroy:!0,title:"牙位图的录入与编辑"},r.createElement("div",{className:"toothposition"},r.createElement("div",{className:"toothtypelist"},r.createElement("div",{className:"title"},"牙位图列表"),this.renderLeftType()),r.createElement("div",{className:"toothcontent"},r.createElement("div",{className:"title"},"快捷录入"),this.renderRightContent(this.state.tooPositionType))))}}t.ToothPosition=a;class u extends r.Component{constructor(e){super(e),this.state={chooseData:e.data,top:e.positioninfo.top?e.positioninfo.top:0,left:e.positioninfo.left?e.positioninfo.left:0,display:e.display?e.display:"none"}}componentDidUpdate(e,t){e.display==this.props.display&&e.positioninfo.top==this.props.positioninfo.top&&e.positioninfo.left==this.props.positioninfo.left&&e.data==this.props.data||setTimeout(()=>{this.setState({chooseData:this.props.data,top:this.props.positioninfo.top?this.props.positioninfo.top:0,left:this.props.positioninfo.left?this.props.positioninfo.left:0,display:this.props.display?this.props.display:"none"})})}checkSurFace(e,t){let{chooseData:n}=this.state,r=n.indexOf(t);r<0?n.push(t):n.splice(r,1),this.setState({chooseData:n}),setTimeout(()=>{this.props.checkSurFace(this.state.chooseData)})}clearCurrentData(e){this.setState({chooseData:[]}),setTimeout(()=>{this.props.checkSurFace(this.state.chooseData)})}renderList(){let e=this.state.chooseData;return["M","D","B","L","P","O","La","I","F"].map((t,n)=>{let i=e.indexOf(t)>-1;return r.createElement("li",{onClick:e=>{this.checkSurFace(e,t)},key:n,className:i?"active":""},t)})}render(){let{top:e,left:t,display:n}=this.state;return r.createElement("div",{onMouseEnter:e=>{},className:"surfacepopover",id:"surfacepopover",style:{display:n,top:e+"px",left:t+"px"}},r.createElement("ul",{style:{display:"flex"},className:"toothpositionpopover"},this.renderList()),r.createElement("div",{className:"cleardiv"},r.createElement("span",{onClick:e=>{this.clearCurrentData(e)},className:"clearbutton"},"清除")))}}class h extends s.BaseComponent{constructor(e,t){super(e,t)}Render(){i.render(r.createElement(a,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.ToothPositionComp=h},function(e,t,n){var r=n(18),i=n(808);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".toothposition {\r\n    display: flex;\r\n}\r\n\r\n.toothposition .subtitle {\r\n    height: 40px;\r\n    line-height: 40px;\r\n    text-align: center;\r\n    font-size: 18px;\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.toothposition .title {\r\n    height: 40px;\r\n    line-height: 40px;\r\n    background-color: rgb(102, 95, 95);\r\n    color: #fff;\r\n    font-size: 18px;\r\n    padding-left: 12px;\r\n}\r\n\r\n.toothtypelist li.active {\r\n    background-color: #0fbbf1;\r\n    color: #fff;\r\n}\r\n\r\n.toothposition ul,\r\n.toothposition li {\r\n    padding: 0;\r\n    margin: 0;\r\n    list-style: none;\r\n    padding: 12px 5px;\r\n}\r\n\r\n.toothposition .toothtypelist {\r\n    flex: 1;\r\n    padding: 0 12px;\r\n    border-right: 1px solid #333;\r\n}\r\n\r\n.toothposition .toothcontent .privewtooth {\r\n    height: 100px;\r\n    border: 1px solid #333;\r\n    margin: 12px 0;\r\n    text-align: center;\r\n}\r\n\r\n.toothposition .toothcontent .privewtooth img {\r\n    height: 100%;\r\n}\r\n\r\n\r\n.toothposition .toothcontent {\r\n    flex: 3;\r\n    padding: 0 12px;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .checktoothposition .typeswitch {\r\n    display: inline-block;\r\n    width: 50px;\r\n    height: 20px;\r\n    line-height: 20px;\r\n    border-radius: 10px;\r\n    vertical-align: middle;\r\n    cursor: pointer;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .checktoothposition .typeswitch.on {\r\n    background-color: #0fbbf1;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .checktoothposition .typeswitch.off {\r\n    background-color: rgb(122, 117, 117);\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .checktoothposition>div {\r\n    flex: 1;\r\n    text-align: center;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .numbertype1 {\r\n    width: 63%;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .numbertype2 {\r\n    width: 100%;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .toothnumber {\r\n    display: flex;\r\n    align-self: center;\r\n    align-content: center;\r\n    justify-content: center;\r\n    align-items: center;\r\n    height: 30px;\r\n    font-style: normal;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .toothnumber>span {\r\n    flex: 1;\r\n    text-align: center;\r\n    margin: 1px 2px;\r\n    position: relative;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .toothnumber>span .number {\r\n    padding: 1px 4px;\r\n    cursor: pointer;\r\n    font-style: normal;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .toothnumber>span .arrow {\r\n    display: inline-block;\r\n    position: absolute;\r\n    top: -5px;\r\n    cursor: pointer;\r\n    right: -8px;\r\n    width: 0;\r\n    height: 0;\r\n    border-left: 5px solid transparent;\r\n    border-right: 5px solid transparent;\r\n    border-bottom: 10px solid black;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .toothnumber>span .arrow.hide {\r\n    display: none;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .toothnumber>span .arrow.active {\r\n    border-bottom: 10px solid #0fbbf1;\r\n\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .toothnumber>span .number.active {\r\n    background-color: #0fbbf1;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent .checktoothposition {\r\n    display: flex;\r\n    margin: 4px 0;\r\n}\r\n\r\n.toothposition .toothcontent .Permanent {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-content: center;\r\n    justify-content: center;\r\n}\r\n\r\n.toothposition .toothcontent .Lesions {\r\n    height: 120px;\r\n    display: flex;\r\n}\r\n\r\n.toothposition .toothcontent .Lesions .three .radio {\r\n    position: absolute;\r\n    bottom: -10px;\r\n    left: 0;\r\n    width: 108%;\r\n    text-align: center;\r\n}\r\n\r\n.toothposition .toothcontent .Lesions .three {\r\n    flex: 1;\r\n    position: relative;\r\n}\r\n\r\n.toothposition .toothcontent .Lesions .three .Lesionsline {\r\n    width: 100px;\r\n    height: 1px;\r\n    background-color: #333;\r\n}\r\n\r\n.toothposition .toothcontent .Lesions .three .Lesionsline1 {\r\n    transform: translate(60px, 24px) rotate(35deg);\r\n}\r\n\r\n.toothposition .toothcontent .Lesions .three .Lesionsline2 {\r\n    transform: translate(141px, 23px) rotate(-35deg);\r\n}\r\n\r\n.toothposition .toothcontent .Lesions .three .Lesionsline3 {\r\n    transform: translate(125px, 75px) rotate(90deg);\r\n    width: 50px;\r\n}\r\n\r\n.toothposition .toothcontent .Lesions .two {\r\n    flex: 1;\r\n    text-align: center;\r\n}\r\n\r\n.toothposition .toothcontent .Lesions .two .Lesionsline {\r\n    height: 1px;\r\n    background-color: #333;\r\n    margin: 12px 0;\r\n}\r\n\r\n.toothposition .surfacepopover ul,\r\n.toothposition .surfacepopover li {\r\n    font-size: 12px;\r\n    margin: 0 2px;\r\n    padding: 2px;\r\n}\r\n\r\n.toothposition .surfacepopover li {\r\n    border-right: 1px solid #0fbbf1;\r\n    cursor: pointer;\r\n}\r\n\r\n.toothposition .toothpositionpopover li.active {\r\n    background-color: #0fbbf1;\r\n}\r\n\r\n.surfacepopover .cleardiv {\r\n    text-align: right;\r\n}\r\n\r\n.surfacepopover {\r\n    background-color: #fff;\r\n    z-index: 999;\r\n    position: absolute;\r\n    box-shadow: 0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05);\r\n    border: 1px solid #0fbbf1;\r\n}\r\n\r\n.clearbutton {\r\n    color: #0fbbf1;\r\n    cursor: pointer;\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasToToothImg=void 0;const r=n(810);t.CanvasToToothImg=class{constructor(){this.CreateCanvas()}CreateCanvas(){this.CanvasContainer=document.createElement("canvas"),this.CanvasContainer1=document.createElement("canvas"),this.CanvasContext=this.CanvasContainer.getContext("2d"),this.CanvasContext1=this.CanvasContainer1.getContext("2d"),this.CanvasContainer.width=1e4}getImage1(e,t,n){this.finalWidth1=0,this.finalWidth2=0,this.finalWidth3=0,this.finalWidth4=0,this.imgArr=[],this.toothSurFaceflag=e,this.Extrateethflag=t,n.forEach((e,t)=>{let n=e.permanent,r=e.deciduous,i=this.drawQua(r,n),l=i.imgData;switch(this.imgArr.push(l),t){case 0:this.finalWidth1=i.finalWidth;break;case 1:this.finalWidth2=i.finalWidth;break;case 2:this.finalWidth3=i.finalWidth;break;case 3:this.finalWidth4=i.finalWidth}});let r=this.finalWidth1<this.finalWidth3?this.finalWidth3:this.finalWidth1,i=this.finalWidth2<this.finalWidth4?this.finalWidth4:this.finalWidth2;return this.CanvasContainer1.width=r+i+20,this.CanvasContainer1.height=100,this.imgArr.forEach((e,t)=>{let n=0,l=0;switch(t){case 0:n=(r-this.finalWidth1)/2+5,l=0,this.CanvasContext1.putImageData(e,n,l);break;case 1:n=r+15+(i-this.finalWidth2)/2,l=0,this.CanvasContext1.putImageData(e,n,l);break;case 2:n=(r-this.finalWidth3)/2+5,l=50,this.CanvasContext1.putImageData(e,n,l);break;case 3:n=r+15+(i-this.finalWidth4)/2,l=50,this.CanvasContext1.putImageData(e,n,l)}}),this.CanvasContext1.moveTo(5,45),this.CanvasContext1.lineTo(r+i+15,45),this.CanvasContext1.moveTo(r+5,5),this.CanvasContext1.lineTo(r+5,95),this.CanvasContext1.stroke(),this.CanvasContainer1.toDataURL("image/png")}drawQua(e,t){this.CanvasContainer.width=this.CanvasContainer.width;let n=0;e.forEach((e,t)=>{if(e.checked&&(this.CanvasContext.fillStyle="#000",this.CanvasContext.font="12px Arial",this.CanvasContext.fillText(e.name,n,20),n+=this.CanvasContext.measureText(e.name).width,this.toothSurFaceflag))for(let t=0;t<e.surFace.length;t++)this.CanvasContext.fillStyle="#000",this.CanvasContext.font="8px Arial",this.CanvasContext.fillText(e.surFace[t],n,10),n+=this.CanvasContext.measureText(e.surFace[t]).width});let r=n;n=0,t.forEach((e,t)=>{if(e.checked&&(this.CanvasContext.fillStyle="#000",this.CanvasContext.font="12px Arial",this.CanvasContext.fillText(e.name,n,40),n+=this.CanvasContext.measureText(e.name).width,this.toothSurFaceflag))for(let t=0;t<e.surFace.length;t++)this.CanvasContext.fillStyle="#000",this.CanvasContext.font="8px Arial",this.CanvasContext.fillText(e.surFace[t],n,30),n+=this.CanvasContext.measureText(e.surFace[t]).width});let i,l=n>r?n:r;return i=0!=l?this.CanvasContext.getImageData(0,0,l,40):this.CanvasContext.getImageData(0,0,1,40),{finalWidth:l,imgData:i}}getImage(e,t){this.DrawCanvase(e,t);let n=this.CanvasToImg();return this.CanvasContainer.width=300,this.CanvasContainer.height=150,n}DrawCanvase(e,t){switch(e){case r.ToothType.GR:this.DrawGR(t);break;case r.ToothType.Lesions:this.DrawLesions(t);break;case r.ToothType.Permanent:this.DrawPermanent(t);break;case r.ToothType.PD:this.DrawPD(t)}}CanvasToImg(){return this.CanvasContainer.toDataURL("image/png")}DrawGR(e){this.clear(),this.CanvasContext.moveTo(50,75),this.CanvasContext.lineTo(250,75),this.CanvasContext.stroke();let t=this.CanvasContext.measureText(e[0]).width,n=this.CanvasContext.measureText(e[1]).width;this.CanvasContext.fillText(e[0],150-t/2,65),this.CanvasContext.fillText(e[1],150-n/2,95);let r=t>n?t:n,i=this.CanvasContext.getImageData(150-r/2,50,r,100);this.CanvasContainer.width=r,this.CanvasContainer.height=50,this.CanvasContext.putImageData(i,0,0)}DrawLesions(e){this.clear(),this.CanvasContext.moveTo(150,75),this.CanvasContext.lineTo(150,100),this.CanvasContext.moveTo(150,75),this.CanvasContext.lineTo(90,50),this.CanvasContext.moveTo(150,75),this.CanvasContext.lineTo(210,50),this.CanvasContext.stroke(),this.CanvasContext.fillText(e[0],150-this.CanvasContext.measureText(e[0]).width/2,55),this.CanvasContext.fillText(e[1],140-this.CanvasContext.measureText(e[1]).width,85),this.CanvasContext.fillText(e[2],160,85);let t=this.CanvasContext.getImageData(90,40,120,50);this.CanvasContainer.width=120,this.CanvasContainer.height=50,this.CanvasContext.putImageData(t,0,0)}DrawPermanent(e){this.clear();let t=this.CanvasContext.measureText(e[0]).width,n=this.CanvasContext.measureText(e[2]).width,r=this.CanvasContext.measureText(e[1]).width,i=this.CanvasContext.measureText(e[3]).width,l=t>n?t:n,s=r>i?r:i,o=!(!e[0]&&!e[1]),a=!(!e[2]&&!e[3]);this.DrawPermanentLine(l+10,s+10,o,a),this.DrawPermanentString(e);let u=this.CanvasContext.getImageData(150-l,50,l+s,100);this.CanvasContainer.width=l+s,this.CanvasContainer.height=50,this.CanvasContext.putImageData(u,0,0)}DrawPermanentString(e){this.CanvasContext.beginPath(),this.CanvasContext.fillText(e[0],150-this.CanvasContext.measureText(e[0]).width,65),this.CanvasContext.fillText(e[1],150,65),this.CanvasContext.fillText(e[2],150-this.CanvasContext.measureText(e[2]).width,95),this.CanvasContext.fillText(e[3],150,95)}DrawPermanentLine(e,t,n,r){this.CanvasContext.moveTo(150,75),this.CanvasContext.lineTo(150-e,75),this.CanvasContext.moveTo(150,75),this.CanvasContext.lineTo(150+t,75),n&&(this.CanvasContext.moveTo(150,75),this.CanvasContext.lineTo(150,50)),r&&(this.CanvasContext.moveTo(150,75),this.CanvasContext.lineTo(150,100)),this.CanvasContext.stroke()}DrawPD(e){this.clear(),this.CanvasContext.moveTo(50,75),this.CanvasContext.lineTo(250,75),this.CanvasContext.moveTo(115,50),this.CanvasContext.lineTo(115,100),this.CanvasContext.moveTo(182,50),this.CanvasContext.lineTo(182,100),this.CanvasContext.stroke(),this.CanvasContext.fillText(e[0],80,65),this.CanvasContext.fillText(e[1],145,65),this.CanvasContext.fillText(e[2],220,65),this.CanvasContext.fillText(e[3],80,95),this.CanvasContext.fillText(e[4],145,95),this.CanvasContext.fillText(e[5],220,95);let t=this.CanvasContext.getImageData(50,50,200,100);this.CanvasContainer.width=200,this.CanvasContainer.height=50,this.CanvasContext.putImageData(t,0,0)}clear(){this.CanvasContainer.width=this.CanvasContainer.width}destroy(){this.CanvasContainer=null,this.CanvasContext=null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToothType=void 0,function(e){e[e.GR=2]="GR",e[e.Lesions=3]="Lesions",e[e.Permanent=4]="Permanent",e[e.PD=6]="PD"}(t.ToothType||(t.ToothType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertTextLabel=void 0;const r=n(32),i=n(68);class l extends i.A_BaseInsertInput{ActName(){return"InsertTextLabel"}Execute(e){let t=e[0],n=new r.XTextLabelElement;return n.Text=t.inpMrtDeSectionDispName,n.EleText=t.inpMrtDeSectionName,n.TitleLevel=t.inpMrtDeSectionLevel,n.IsDeleteFlag=t.isDel,n.TitleID=t.inpMrtDeSectionNo,n.CptID=t.conceptID,n.ExtendAttr1=t.extendAttr1,n.Description=t.inpMrtDeSectionDesc,n.IsSaveFlag=t.saveFlag,n.FixPosition=t.positionFlag,n.Attr_FgHide=t.hideFlag,n.SetHideFlag=t.hideFlag,n.IsRequire=t.requireFlag,n.IsPrintFlag=t.printFlag,n.IsEditble=!1!==t.editbleFlag,n.LevelTerm=t.levelTerm,n.MaxLength=t.maxLength,n.MinLength=t.minimumLength,n.Gender=t.sexJudge,n.MaxAge=t.maxAge,n.MinAge=t.minAge,n.initStyle(),super.Execute([n])}}t.A_InsertTextLabel=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_LookUpXml=void 0;const r=n(1),i=n(14);class l extends r.XBaseAction{ActName(){return"LookUpXmlCode"}Execute(e){let t;if(this.resMsg.Clear(),null==super.GetXDocFocused())this.resMsg.MsgLevel=1,this.resMsg.MsgStr="当前焦点文档不存在！";else{let e=super.GetEdtCtrl();this.ClearStyle();let t=e.M_DocumentFocused.ToXML(),n=i.XmlDomUtil.Xml2String(t),r='<?xml version="1.0" encoding="utf-8"?>';this.resMsg.ReturnParams=r+n}return t=this.resMsg,t}formateXml(e){let t=this,n=e;n=n.replace(/\n/g,"\r").replace(/<!--(.+?)-->/g,(function(e,t){return"\x3c!--"+escape(t)+"--\x3e"})).replace(/\r/g,"\n");var r=[],i=n.replace(/\n(<(([^\?]).+?)(?:\s|\s*?>|\s*?(\/)>)(?:.*?(?:(?:(\/)>)|(?:<(\/)\2>)))?)/gm,(function(e,n,i,l,s,o,a,u){var h="/"==s||"/"==o||"/"==a||"/"==u,d="";return"!"==l?d=t.setPrefix(r.length):"/"!=l?(d=t.setPrefix(r.length),h||r.push(i)):(r.pop(),d=t.setPrefix(r.length)),"\n"+d+n})).substring(1);return i=(i=i.replace(/\n/g,"\r").replace(/(\s*)<!--(.+?)-->/g,(function(e,t,n){return"\r"==t.charAt(0)&&(t=t.substring(1)),"\n"+t+"\x3c!--"+(n=unescape(n).replace(/\r/g,"\n")).replace(/^\s*/gm,t)+"--\x3e"}))).replace(/\s+$/g,"").replace(/\r/g,"\r\n")}setPrefix(e){for(var t=[],n=0;n<e;++n)t.push("    ");return t.join("")}}t.A_LookUpXml=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_RemoveCharByRight=void 0;const r=n(45),i=n(20),l=n(60),s=n(1);class o extends s.XBaseAction{ActName(){return"RemoveCharByRight"}Execute(e){let t,n=super.GetEdtCtrl(),s=n.M_EleEvtModel.EleClicked;if(null==s)t=this.resMsg;else{let e=i.XTextTableUtil.GetCursorCell(s);if(null!=e){let t=i.XTextTableUtil.GetCursorTextTable(s);if(t instanceof r.XTextTable||(t=e.Parent.Parent instanceof r.XTextTable?e.Parent.Parent:null),null!=t){n.M_GetActionByName("DeleteTextTable").Execute([0])}}else{if(l.EmrApiUtil.HasSelection(n)){n.M_GetActionByName("RemoveChar").Execute(["8"])}}t=this.resMsg}return t}}t.A_RemoveCharByRight=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_AddComment=void 0;const r=n(2),i=n(0),l=n(79),s=n(348),o=n(116),a=n(1),u=n(39);class h extends a.XBaseAction{ActName(){return"AddComment"}constructor(){super(),super.OpType=r.ENumActOpType.CtntEdit}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),r=n.M_EleEvtModel.SelRange;if(r.IsValid()){let e=super.GetEdtLoginUserInfo().UsrName,a=o.XLineEleRange.SortFromToLineEleIx(r.FromLineEleIx,r.ToLineEleIx),h=a[0].RefreshEleObj(!1),d=a[1].RefreshEleObj(!1);if(!this.IsValid(h)||!this.IsValid(d)||!this.IsSameDoc(h,d))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr="起始或者结束元素不符合要求",super.MessageWarn(),this.resMsg;d instanceof i.XTextTableCell&&(h=d.GetFirstChildBaseEle(),d=d._GetLastBaseEle());let c=new l.XStringEle;c.Text="批注范围 ("+h.GetInnerText(!1)+" --- "+d.GetInnerText(!1)+")";let p=new l.XStringEle;p.Text="";let f=new s.XCommentEle;f.UserName=e,f.AddTime=u.DateTime.getCurrentDateToFormat(),f.AddChildEle(0,c),f.AddChildEle(1,new i.XParagraphFlag),f.AddChildEle(2,p),f.RelLineEleFrom=h,f.RelLineEleTo=d,d.OwnPageView.AddComment(f,!0),d.OwnerDocPanel.IsChanged=!0,n.M_EleEvtModel.EleClickedWrap.PageFocused.RelDocPage.IsInvalidate=!0;let g=n.All_Document;for(let e=0;e<g.length;e++){g[e].GetPageFmt().ShowCmmtArea=!0}n.RefreshCmmtShowStatus(),super._RefreshPageAndMoveCaret(!0),t=this.resMsg}else this.resMsg.MsgLevel=2,this.resMsg.MsgStr="新增批注时，需要有选中内容",super.MessageWarn(),t=this.resMsg;return t}IsValid(e){if(e.NeedSerialized())return!0;{let t=e instanceof i.XCharacterEle?e:null;return!(null==t||t.Parent instanceof l.XStringEle&&t.Parent.IsXInputBkgText)}}IsSameDoc(e,t){return e.OwnerLine.Container==t.OwnerLine.Container&&e.Document==t.Document}}t.A_AddComment=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_HideRule=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"HideRule"}Execute(e){const t=super.GetEdtCtrl();let n=t.M_emrDocView;return null!=n&&(n.HideRuler(),t.DefaultSetting.IsShowRule=!1),super.Execute(e)}}t.A_HideRule=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ShowRule=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"ShowRule"}Execute(e){let t=super.GetEdtCtrl().M_emrDocView;return null!=t&&(t.ShowRuler(),t.RefreshRuler()),super.Execute(e)}}t.A_ShowRule=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ClearStyle=void 0;const r=n(2),i=n(0),l=n(16),s=n(181),o=n(13),a=n(1);class u extends a.XBaseAction{ActName(){return"ClearStyle"}constructor(){super(),super.OpType=r.ENumActOpType.StyleEdit}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl().M_EleEvtModel.SelRange;if(null!=n&&n.IsValid()){let e=new o.UndoGroup,r=null,a=n.InfoUtil.GetLineBaseElesInRange(!1,!1);for(let t=0;t<a.length;t++){let n=a[t];if(null!=n){let t=l.XDomUtil.IsInnerChildOfXInput(n);if(null!=t){if(t==r)continue;n=t,r=t}let o=new s.EleStyleUndo(n,s.ENumSubset.All);n.EleStyle.Clear();let a=n instanceof i.XBaseInputEle?n:null;null==a?n.NotifyLayoutChanged(!0,!1):a.ResetInnerChildrenStyles(!0),o.ReadNewStyle(),e.AddItem(o)}}super._AddUndoItem(e),super._RefreshPageAndMoveCaret(!0),t=this.resMsg}else t=this.resMsg;return t}}t.A_ClearStyle=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ContineSerno=void 0;const r=n(182);class i extends r.A_SetParaSerno{ActName(){return"ContineSerno"}Execute(e){return super.Execute([null,!0,1])}}t.A_ContineSerno=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_FocusXInputEle=void 0;const r=n(2),i=n(0),l=n(143),s=n(1),o=n(4);class a extends s.XBaseAction{constructor(){super(...arguments),this.focus_range=new l.XPageLineSelRange}ActName(){return"FocusXInputEle"}GetLastFocusRects(){if(null!=this.focus_range&&this.focus_range.IsValid()){let e=this.focus_range.FromLineEle,t=this.focus_range.ToLineEle;return e.IsRemoved||t.IsRemoved?(this.focus_range.Clear(),null):this.focus_range.InfoUtil.CalcLineRectRanges(!0)}return null}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),l=n.M_EleEvtModel.SelRange;if(null!=l&&l.IsValid()){t=this.resMsg;let e=n.M_EleEvtModel.EleClickedWrap.EleFocused,r=i.XDomUtil.GetParentXInput(e,!1);if(null!=r){if(e instanceof i.XInputBorderEle&&e.IsStartBorder)return t=this.resMsg,t;this.focus_range.SetFromIx(r.GetChildEle(0)),this.focus_range.SetToIx(r.GetLastChildEle(),!1)}}else{let e=this.focus_range.FromLineEle&&this.focus_range.FromLineEle.Parent;this.focus_range.Clear(),n.RefreshPageSelRange(r.ENumBkgRectsType.FocusRects,null);let l=n.M_EleEvtModel.EleClickedWrap.EleFocused,s=i.XDomUtil.GetParentXInput(l,!1);if(null!=e&&!o.default.IsNullOrEmpty(e.LackEllipsisvalue)&&e instanceof i.XInputEle&&e!=s){if(e.QuoteSource&&!o.default.IsNullOrEmpty(e.CptID)){let t=e.GetInnerText(!1),r=e.Document.AssistFunc.XDocXInputCache.BodyParTakeQuoteXInputCache,i=!1;for(let n of r)n.Equals(e)||e.LackEllipsisvalue!=n.LackEllipsisvalue||e.CptID!=n.CptID||e.InputType!=n.InputType||(i=!0,n.UpdateInnerText(t,null,!0));i&&n.MRefreshDocView(e.Document,!0)}if(n.M_EdtCustomEvtGrp.InputOnBlur){let t={cptId:e.CptID,customAttribute:e.CustomAttribute};n.M_EdtCustomEvtGrp.InputOnBlur(t)}}if(null==s)t=this.resMsg;else{if(l instanceof i.XInputBorderEle&&l.IsStartBorder)return t=this.resMsg,t;this.focus_range.SetFromIx(s.GetChildEle(0)),this.focus_range.SetToIx(s.GetLastChildEle(),!1);let e=this.focus_range.InfoUtil.CalcLineRectRanges(!0);n.RefreshPageSelRange(r.ENumBkgRectsType.FocusRects,e),t=this.resMsg}}return t}}t.A_FocusXInputEle=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_HoverXInputEle=void 0;const r=n(2),i=n(0),l=n(143),s=n(1);class o extends s.XBaseAction{constructor(){super(...arguments),this.hover_range=new l.XPageLineSelRange}ActName(){return"HoverXInputEle"}GetLastHoverRects(){if(null==this.hover_range||!this.hover_range.IsValid())return null;let e=this.hover_range.FromLineEle,t=this.hover_range.ToLineEle;return e.IsRemoved||t.IsRemoved?(this.hover_range.Clear(),null):this.hover_range.InfoUtil.CalcLineRectRanges(!0)}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl();if(null!=e&&null!=e[0]&&e[0]instanceof i.XBaseElement){const l=e[0],s=i.XDomUtil.GetParentXInput(l,!0);if(null!=s){let e=n.M_EleEvtModel.EleClickedWrap.EleFocused;const l=i.XDomUtil.GetParentXInput(e,!0);if(!l||l.XID!=s.XID){this.hover_range.SetFromIx(s.GetChildEle(0)),this.hover_range.SetToIx(s.GetLastChildEle(),!1);const e=this.hover_range.InfoUtil.CalcLineRectRanges(!0);n.RefreshPageSelRange(r.ENumBkgRectsType.HoverRects,e),t=this.resMsg}}}return null==t?(this.hover_range.Clear(),n.RefreshPageSelRange(r.ENumBkgRectsType.HoverRects,null),this.resMsg):t}}t.A_HoverXInputEle=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_FormatBrush=void 0;const r=n(2),i=n(822),l=n(13),s=n(183),o=n(1);class a extends o.XBaseAction{ActName(){return"FormatBrush"}A_FormatBrush(){super.OpType=r.ENumActOpType.StyleEdit}Execute(e){this.resMsg.Clear();let t=new i.ToolBarBtnResultInfo;e[0]?(t.IsMouseDown=!0,t.IsMouseDoubleClick=!1):t=null;let n=super.GetEdtCtrl();return null!=t?this._SetFmtBrushSrc(t.IsMouseDown,t.IsMouseDoubleClick,n):this._UseFmtBrush(n),this.resMsg}_SetFmtBrushSrc(e,t,n){let r=s.EmrFmtBrush.GetInstance();if(e){let e=n.M_EleEvtModel.EleClickedPrevSameLine,i=n.M_XDocsUtil.EditorID;r.SetSrcEleStyle(e,i),r.IsLongMode=t}else r.Clear(null)}_UseFmtBrush(e){let t=e.M_EleEvtModel.SelRange;if(null!=t&&t.IsValid()){let n=new l.UndoGroup,r=t.InfoUtil.GetLineBaseElesInRange(!1,!1);s.EmrFmtBrush.GetInstance().UseFmtBrush(r,n),super._AddUndoItem(n),e.MRefreshDocView(),e.M_EleEvtHandler.OnEleStyleChanged(this.ActName(),r[0].EleStyle)}}}t.A_FormatBrush=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToolBarBtnResultInfo=void 0;t.ToolBarBtnResultInfo=class{get IsMouseDown(){return this.isMouseDown}set IsMouseDown(e){this.isMouseDown=e}get IsMouseDoubleClick(){return this.isMouseDoubleClick}set IsMouseDoubleClick(e){this.isMouseDoubleClick=e}get Parm1(){return this.parm1}set Parm1(e){this.parm1=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ReStartSerno=void 0;const r=n(182);class i extends r.A_SetParaSerno{ActName(){return"ReStartSerno"}Execute(e){return super.Execute([null,!0,1])}}t.A_ReStartSerno=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignBothEnds=void 0;const r=n(11),i=n(120);class l extends i.A_SetHAlignBase{ActName(){return"SetAlignBothEnds"}Execute(e){return super.Execute([r.ENumHAlignStyle.BothEnds])}}t.A_SetAlignBothEnds=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HAlignUndo=void 0;const r=n(11),i=n(23);class l extends i.IXUndoable{constructor(e,t){super(),this.paraghStyle=null,this.oldHAlign=r.ENumHAlignStyle.LEFT,this.newHAlign=r.ENumHAlignStyle.LEFT,this.paraghStyle=e,this.oldHAlign=t,null!=e&&(this.newHAlign=e.HAlign_ENumVal)}IsValid(){return null!=this.paraghStyle}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){this.CanUndo()&&(this.paraghStyle.HAlign_ENumVal=this.oldHAlign)}Redo(){this.CanRedo()&&(this.paraghStyle.HAlign_ENumVal=this.newHAlign)}Clear(){this.paraghStyle=null,this.oldHAlign=r.ENumHAlignStyle.NONE,this.newHAlign=r.ENumHAlignStyle.NONE}}t.HAlignUndo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignCenter=void 0;const r=n(11),i=n(120);class l extends i.A_SetHAlignBase{ActName(){return"SetAlignCenter"}Execute(e){return super.Execute([e[0]?r.ENumHAlignStyle.CENTER:r.ENumHAlignStyle.NONE])}}t.A_SetAlignCenter=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignLeft=void 0;const r=n(11),i=n(120);class l extends i.A_SetHAlignBase{ActName(){return"SetAlignLeft"}Execute(e){return super.Execute([e[0]?r.ENumHAlignStyle.LEFT:r.ENumHAlignStyle.NONE])}}t.A_SetAlignLeft=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignRight=void 0;const r=n(11),i=n(120);class l extends i.A_SetHAlignBase{ActName(){return"SetAlignRight"}Execute(e){return super.Execute([e[0]?r.ENumHAlignStyle.RIGHT:r.ENumHAlignStyle.NONE])}}t.A_SetAlignRight=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignScattered=void 0;const r=n(11),i=n(120);class l extends i.A_SetHAlignBase{ActName(){return"SetAlignScattered"}Execute(e){return super.Execute([r.ENumHAlignStyle.Scattered])}}t.A_SetAlignScattered=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetBkgColor=void 0;const r=n(367);class i extends r.BaseA_SetColor{ActName(){return"SetBkgColor"}Execute(e){return super.Execute(e)}}t.A_SetBkgColor=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleColorUndo=void 0;const r=n(7),i=n(0),l=n(23);class s extends l.IXUndoable{constructor(e,t){if(super(),this.relEle=null,this.oldColor=r.Color.Empty,this.newColor=r.Color.Empty,this.isForeColor=!0,this.relEle=e,this.isForeColor=t,null!=e){let n=e.EleStyle;this.oldColor=t?n.ForeColor:n.BackgroundColor}}ReadNewColor(){if(null!=this.relEle){let e=this.relEle.EleStyle;this.newColor=this.isForeColor?e.ForeColor:e.BackgroundColor}}IsValid(){return null!=this.relEle}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()&&this.newColor!=r.Color.Empty}Undo(){if(this.CanUndo()){let e=this.relEle.EleStyle;this.isForeColor?e.ForeColor=this.oldColor:e.BackgroundColor=this.oldColor;let t=this.relEle instanceof i.XBaseInputEle?this.relEle:null;null!=t&&t instanceof i.XBaseInputEle&&t.ResetInnerChildrenStyles(!1)}}Redo(){if(this.CanRedo()){let e=this.relEle.EleStyle;this.isForeColor?e.ForeColor=this.newColor:e.BackgroundColor=this.newColor;let t=this.relEle instanceof i.XBaseInputEle?this.relEle:null;null!=t&&t.ResetInnerChildrenStyles(!1)}}Clear(){this.relEle=null,this.newColor=r.Color.Empty}}t.EleColorUndo=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetBorderShading=void 0;const r=n(26),i=n(2),l=n(0),s=n(16),o=n(45),a=n(20),u=n(304),h=n(3),d=n(60),c=n(1),p=n(7);class f extends c.XBaseAction{ActName(){return"SetBorderShading"}A_SetBorderShading(){super.OpType=i.ENumActOpType.StyleEdit}Execute(e){if(this.resMsg.Clear(),e.length>=2&&e[1]instanceof o.XTextTable){let t=e[0],n=e[1];this.SetTable_BorderSetting(t,n)}else{let t=e[0],n=this.InitBorderShadingInfo(t),r=e[1];this.SetTable_BorderSetting(n,r)}return super.Execute(e)}InitBorderShadingInfo(e){let t=new u.BorderShadingInfo;const n=e.borderWidth;return t.BorderLineWidth=n,n>0||(e.isShowTopBorder=!1,e.isShowBottomBorder=!1,e.isShowLeftBorder=!1,e.isShowRightBorder=!1),t.IsShowTopBorder=null!=e.isShowTopBorder&&e.isShowTopBorder,t.IsShowBottomBorder=null!=e.isShowBottomBorder&&e.isShowBottomBorder,t.IsShowLeftBorder=null!=e.isShowLeftBorder&&e.isShowLeftBorder,t.IsShowRightBorder=null!=e.isShowRightBorder&&e.isShowRightBorder,t.TopBorderLineColor=new p.Color(e.topBorderColor),t.BottomBorderLineColor=new p.Color(e.bottomBorderColor),t.LeftBorderLineColor=new p.Color(e.leftBorderColor),t.RightBorderLineColor=new p.Color(e.rightBorderColor),t.IsShowHorizontalCenterBorder=null!=e.isShowHorizontalCenterBorder&&e.isShowHorizontalCenterBorder,t.IsShowVerticalCenterBorder=null!=e.isShowVerticalCenterBorder&&e.isShowVerticalCenterBorder,t.DashStyle=e.borderLineStyle,t.ShadingBackColor=e.backgroundColor,t.ApplytoText=e.applyTo,t}SetTable_BorderSetting(e,t){if(null!=e){let n,r=new h.List,i=new h.List,a=new h.List,c=d.EmrApiUtil.HasSelection(super.GetEdtCtrl()),p=e.ApplytoText;if(c){let e=super.GetEdtCtrl().M_EleEvtModel.SelRange.InfoUtil.GetLineElesInRange(!0,!0);if(null!=e&&e.length>0){let t=e;for(let e=0;e<t.length;e++){let n=t[e];if(null!=n){i.Add(n);let e=n.Parent;null==e||a.Contains(e)||a.Add(e);let t=s.XDomUtil.GetXTableOfCell(n);null==t||r.Contains(t)||r.Add(t)}}}}else{n=t;let e=this.GetFocusCell();if(null==n&&null!=e&&(n=e.Parent.Parent),"allTableSelect"==n){let e=super.GetEdtCtrl().M_DocumentFocused;if(null==e&&(e=super.GetEdtCtrl().All_Document[0]),null!=e){let t=e.GetChildrenByType("XTextTable",!1);r.AddRange(t),p="表格"}}else null!=n&&n instanceof o.XTextTable&&r.Add(n);if(r.Count()<=0)return;if(null!=e){i.Add(e);let t=e.Parent;null!=t&&a.Add(t)}}if((0!=r.Count()||0!=i.Count())&&null!=p)if("表格"!=p)if("单元格"!=p){if("表格行"==p)for(let t=0;t<a.Length;t++)this.Apply_TabRow_BorderSetting(a.Get(t),e)}else{let t=i.Get(0).ColIndex,n=i.Get(0).Parent.Index,r=i.Get(i.Length-1).ColIndex,s=i.Get(i.Length-1).Parent.Index;for(let o=0;o<i.Length;o++){const a=i.Get(o),u=this.getBaseViewEleList(a);if(null!=u)for(let i=0;i<u.Count();i++){const o=u.Get(i);o instanceof l.XTextTableCell&&(this.Apply_Cell_BorderSetting(o,e),this.Apply_Cell_BorderHIde(o,e,t,n,r,s))}}}else for(let t=0;t<r.Length;t++){const i=r.Get(t),l=this.getBaseViewEleList(i);if(null!=l)for(let t=0;t<l.Count();t++){const r=l.Get(t);r instanceof o.XTextTable&&("allTableSelect"!=n?(this.resetTableBorderSetting(r,null),this.Apply_Table_BorderSetting(r,e)):"单元格"!=e.ApplytoText?(this.resetTableBorderSetting(r,new u.BorderShadingInfo),this.Apply_Table_BorderSetting(r,e)):this.resetTableBorderSetting(r,e))}}}}resetTableBorderSetting(e,t){if(null!=e){let n=e.GetLinesIter();for(;n.MoveNext();){let e=n.Current;if(null!=e){let n=e.GetElesIter();for(;n.MoveNext();){let e=n.Current;null==t?(e.EleStyle.DashStyle=0,e.EleStyle.EleBdrWidth=1,e.EleStyle.BackgroundColor=new p.Color("#ffffff"),e.EleStyle.BorderRight=!0,e.EleStyle.BorderTop=!0,e.EleStyle.TopBorderLineColor=new p.Color("#000000"),e.EleStyle.RightBorderLineColor=new p.Color("#000000"),e.EleStyle.ApplytoText="表格"):(void 0!==t.DashStyle&&(e.EleStyle.DashStyle=t.DashStyle),void 0!==t.BorderLineWidth&&(e.EleStyle.EleBdrWidth=t.DashStyle),void 0!==t.ShadingBackColor&&(e.EleStyle.BackgroundColor=t.ShadingBackColor),void 0!==t.IsShowVerticalCenterBorder&&(e.EleStyle.BorderRight=t.IsShowVerticalCenterBorder),void 0!==t.IsShowHorizontalCenterBorder&&(e.EleStyle.BorderTop=t.IsShowHorizontalCenterBorder),void 0!==t.TopBorderLineColor&&(e.EleStyle.TopBorderLineColor=t.TopBorderLineColor),void 0!==t.LeftBorderLineColor&&(e.EleStyle.RightBorderLineColor=t.LeftBorderLineColor),e.EleStyle.ApplytoText="表格")}}}}}Apply_Table_BorderSetting(e,t){null!=e&&(void 0!==t.DashStyle&&(e.EleStyle.DashStyle=t.DashStyle),void 0!==t.BorderLineWidth&&(e.EleStyle.EleBdrWidth=t.BorderLineWidth),void 0!==t.ApplytoText&&(e.EleStyle.ApplytoText=t.ApplytoText),void 0!==t.ShadingBackColor&&(e.EleStyle.BackgroundColor=t.ShadingBackColor),e.UsingCellBorderSetting=r.TextDocInitInfo.GetInstance().UsingCellBorderSetting,e.UsingCellBorderSetting?this.SetTableStyle(e,t):this.SetStyle(e.EleStyle,t),e.NotifyLayoutChanged(!0,!1))}Apply_Cell_BorderHIde(e,t,n,r,i,l){if(null==e)return;let o=e.Parent,a=s.XDomUtil.GetXTableOfCell(e);if(e.ColIndex==n){let n=a.GetLeftCell(e);null!=n&&(n.EleStyle.BorderRight=t.IsShowLeftBorder,n.EleStyle.RightApplytoText=t.ApplytoText)}if(e.ColIndex==i&&(e.EleStyle.BorderRight=t.IsShowRightBorder),o.Index==r&&(e.EleStyle.BorderTop=t.IsShowTopBorder),o.Index==l){let n=a.GetDownCell(e);null!=n&&(n.EleStyle.BorderTop=t.IsShowBottomBorder,n.EleStyle.TopApplytoText=t.ApplytoText)}e.ColIndex!=i&&(e.EleStyle.BorderRight=t.IsShowVerticalCenterBorder),o.Index!=r&&(e.EleStyle.BorderTop=t.IsShowHorizontalCenterBorder)}Apply_Cell_BorderSetting(e,t){if(null!=e&&null!=e.Parent){let n=s.XDomUtil.GetXTableOfCell(e),r=n.GetDownCell(e),i=n.GetLeftCell(e);null!=r&&(r.EleStyle.TopBorderLineColor=t.BottomBorderLineColor,r.EleStyle.TopDashStyle=t.DashStyle,r.EleStyle.EleTopBdrWidth=t.BorderLineWidth),null!=i&&(i.EleStyle.RightBorderLineColor=t.LeftBorderLineColor,i.EleStyle.RightDashStyle=t.DashStyle,i.EleStyle.EleRightBdrWidth=t.BorderLineWidth),this.SetStyle(e.EleStyle,t),e.NotifyLayoutChanged(!0,!1)}}Apply_TabRow_BorderSetting(e,t){if(null!=e)for(let n=0;n<e.Cells.Length;n++){let r=e.Cells.Get(n);const i=this.getBaseViewEleList(r);if(null!=i)for(let e=0;e<i.Count();e++){const n=i.Get(e);this.SetStyle(r.EleStyle,t),n.NotifyLayoutChanged(!0,!1)}}}GetFocusCell(){let e=super.GetEdtCtrl().M_EleEvtModel.EleClicked;return a.XTextTableUtil.GetCursorCell(e)}SetStyle(e,t){void 0!==t.IsShowTopBorder&&(e.BorderTop=t.IsShowTopBorder),void 0!==t.IsShowBottomBorder&&(e.BorderBottom=t.IsShowBottomBorder),void 0!==t.IsShowLeftBorder&&(e.BorderLeft=t.IsShowLeftBorder),void 0!==t.IsShowRightBorder&&(e.BorderRight=t.IsShowRightBorder),void 0!==t.IsShowHorizontalCenterBorder&&(e.BorderHorizontalCenter=t.IsShowHorizontalCenterBorder),void 0!==t.IsShowVerticalCenterBorder&&(e.BorderVerticalCenter=t.IsShowVerticalCenterBorder),void 0!==t.TopBorderLineColor&&(e.TopBorderLineColor=t.TopBorderLineColor),void 0!==t.BottomBorderLineColor&&(e.BottomBorderLineColor=t.BottomBorderLineColor),void 0!==t.LeftBorderLineColor&&(e.LeftBorderLineColor=t.LeftBorderLineColor),void 0!==t.RightBorderLineColor&&(e.RightBorderLineColor=t.RightBorderLineColor),void 0!==t.BorderLineWidth&&(e.EleBdrWidth=t.BorderLineWidth),void 0!==t.DashStyle&&(e.DashStyle=t.DashStyle),void 0!==t.ShadingBackColor&&(e.BackgroundColor=t.ShadingBackColor),void 0!==t.ApplytoText&&(e.ApplytoText=t.ApplytoText)}SetTableStyle(e,t){if(null!=e){let n=e.GetLinesIter();for(;n.MoveNext();){let r=n.Current;if(null!=r){let n=r.GetElesIter();for(;n.MoveNext();){let i=n.Current;0==r.Index?void 0!==t.IsShowTopBorder&&(i.EleStyle.BorderTop=t.IsShowTopBorder):void 0!==t.IsShowHorizontalCenterBorder&&(i.EleStyle.BorderTop=t.IsShowHorizontalCenterBorder),r.Index==e.LinesCnt-1?void 0!==t.IsShowBottomBorder&&(i.EleStyle.BorderBottom=t.IsShowBottomBorder):void 0!==t.IsShowHorizontalCenterBorder&&(i.EleStyle.BorderBottom=t.IsShowHorizontalCenterBorder),0==i.ColIndex?void 0!==t.IsShowLeftBorder&&(i.EleStyle.BorderLeft=t.IsShowLeftBorder):void 0!==t.IsShowVerticalCenterBorder&&(i.EleStyle.BorderLeft=t.IsShowVerticalCenterBorder),i.ColIndex==e.Columns.Count()-1?void 0!==t.IsShowRightBorder&&(i.EleStyle.BorderRight=t.IsShowRightBorder):void 0!==t.IsShowVerticalCenterBorder&&(i.EleStyle.BorderRight=t.IsShowVerticalCenterBorder),i.setPaddLRByBorderLR()}}}}}getBaseViewEleList(e){if(null==e)return null;let t=new h.List;if(e instanceof l.XTextTableCell){let n=e;for(;null!=n;)t.Add(n),n=n.BaseCell}else{if(!(e instanceof o.XTextTable))return null;{let n=e;for(;null!=n;)t.Add(n),n=n.BaseTable}}return t}}t.A_SetBorderShading=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetDefaultFont=void 0;const r=n(368),i=n(121);class l extends r.A_SetFont{ActName(){return"SetDefaultFont"}Execute(e){this.resMsg.Clear();let t=super.GetXDocFocused(),n=t.GetDefaultStyle().XFontStyle;if(null!=e[0]){let r=e[0];if(null!=r&&null!=r){let e=new i.FontInfo;e.FontName=r.fontName,e.FontSize=r.fontSize,e.FontSizeName=r.fontSize,e.IsDrawDeleteLine=r.drawDeleteLine,e.IsDrawUnderLine=r.drawUnderLine,e.IsBold="true"===r.bold,e.IsItatlic=r.itatlic,n.IsBold=e.IsBold,n.IsItalic=e.IsItatlic,n.IsUnderline=e.IsDrawUnderLine,n.IsStrikeout=e.IsDrawDeleteLine,n.SetDefaultFntNameSz(e.FontName,e.FontSize,e.FontSizeName),t.IsDocFmtChanged=!0,t.InvalidLayout(),this._RefreshPageAndMoveCaret(!0)}}else{let e=["documentDefaultFont",this._BuildFontInfo(n)];this.resMsg.ReturnParams=e}return this.resMsg}}t.A_SetDefaultFont=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrToolBarCommon=void 0;const r=n(4);class i{static GetSuitFontName(e,t){if(r.default.IsNullOrEmpty(e))return"宋体";if(i.IsChineseStr(t)){let t=e[0];if(t>="a"&&t<="z"||t>="A"&&t<="Z")return i.ChineseFontENNames.Contains(e)?e:"宋体"}return e}static IsChineseStr(e){new RegExp("^[一-龥]$");for(let t=0;t<e.length;t++);return!0}}t.EmrToolBarCommon=i,i.ChineseFontENNames=["SimHei","SimSun","NSimSun","FangSong","FangSong_GB2312","KaiTi_GB2312","KaiTi","Microsoft JhengHei","Microsoft YaHei","MingLiU","DFKai-SB","PMingLiU","STSong","STZhongsong","STFangsong","STCaiyun","STHupo","STLiti","STXingkai","STXinwei","STXihei","STKaiti","FZShuTi","FZYaoti","YouYuan","LiSu"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleFontUndo=void 0;const r=n(0),i=n(210),l=n(23);class s extends l.IXUndoable{constructor(e){if(super(),this.relEle=null,this.oldFntInfo=null,this.newFntInfo=null,this.relEle=e,null!=e){let t=e.EleStyle;this.oldFntInfo=new i.XFontStyle(t.XFontStyle)}}ReadNewFontStyle(){if(null!=this.newFntInfo&&this.newFntInfo.Clear(!1),null!=this.relEle){let e=this.relEle.EleStyle;this.newFntInfo=new i.XFontStyle(e.XFontStyle)}}IsValid(){return null!=this.relEle&&null!=this.oldFntInfo&&null!=this.newFntInfo}CanUndo(){return null!=this.relEle&&null!=this.oldFntInfo}CanRedo(){return null!=this.relEle&&null!=this.newFntInfo}Undo(){if(this.CanUndo()){this.relEle.EleStyle.XFontStyle.CopyFrom(this.oldFntInfo);let e=this.relEle instanceof r.XBaseInputEle?this.relEle:null;null==e?this.relEle.NotifyLayoutChanged(!0,!1):e.ResetInnerChildrenStyles(!0)}}Redo(){if(this.CanRedo()){this.relEle.EleStyle.XFontStyle.CopyFrom(this.newFntInfo);let e=this.relEle instanceof r.XBaseInputEle?this.relEle:null;null==e?this.relEle.NotifyLayoutChanged(!0,!1):e.ResetInnerChildrenStyles(!0)}}Clear(){this.relEle=null,null!=this.oldFntInfo&&this.oldFntInfo.Clear(!1),null!=this.newFntInfo&&this.newFntInfo.Clear(!1)}}t.EleFontUndo=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetFontBold=void 0;const r=n(112);class i extends r.BaseA_SetFontDetail{ActName(){return"SetFontBold"}Execute(e){let t;return this.resMsg.Clear(),super.ChkActParamsCnt(e)?(super.Execute([e[0]]),t=this.resMsg):t=this.resMsg,t}}t.A_SetFontBold=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetFontItalic=void 0;const r=n(112);class i extends r.BaseA_SetFontDetail{ActName(){return"SetFontItalic"}Execute(e){let t;return this.resMsg.Clear(),super.ChkActParamsCnt(e)?(super.Execute([e[0]]),t=this.resMsg):t=this.resMsg,t}}t.A_SetFontItalic=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetFontName=void 0;const r=n(4),i=n(112);class l extends i.BaseA_SetFontDetail{ActName(){return"SetFontName"}Execute(e){let t;if(this.resMsg.Clear(),super.ChkActParamsCnt(e)){let n=e[0];r.default.IsNullOrEmpty(n.toString())||super.Execute([n]),t=this.resMsg}else t=this.resMsg;return t}}t.A_SetFontName=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetFontSize=void 0;const r=n(4),i=n(8),l=n(112);class s extends l.BaseA_SetFontDetail{ActName(){return"SetFontSize"}Execute(e){let t;if(this.resMsg.Clear(),super.ChkActParamsCnt(e)){let n=e[0];if(r.default.IsNullOrEmpty(n.toString()))t=this.resMsg;else{let r=i.CNumUtil.TryParseFloat(n.toString(),12);e.length>=2?super.Execute([r,e[1]]):super.Execute([r]),t=this.resMsg}}else t=this.resMsg;return t}}t.A_SetFontSize=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetFontStrikeout=void 0;const r=n(112);class i extends r.BaseA_SetFontDetail{ActName(){return"SetFontStrikeout"}Execute(e){let t;return this.resMsg.Clear(),super.ChkActParamsCnt(e)?(super.Execute([e[0]]),t=this.resMsg):t=this.resMsg,t}}t.A_SetFontStrikeout=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetForeColor=void 0;const r=n(367);class i extends r.BaseA_SetColor{ActName(){return"SetForeColor"}Execute(e){return super.Execute(e)}}t.A_SetForeColor=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetForeColorTest=void 0;const r=n(7),i=n(1);class l extends i.XBaseAction{constructor(){super(...arguments),this._foreColor=new r.Color("rgb(0,32,96)")}ActName(){return"SetForeColorTest"}Execute(e){this.resMsg.Clear();let t=super.GetXDocFocused();const n=t.GetChildrenByType("XTextCheckBox",!0);if(n.Count()>0){for(let e=0;e<n.ToArray().length;e++){const t=n.ToArray()[e].EleStyle;null!=t&&(t.ForeColor=this._foreColor)}super.GetEdtCtrl().MRefreshDocView(t,!1)}return this.resMsg}}t.A_SetForeColorTest=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetPageFmt=void 0;const r=n(844),i=n(1),l=n(36);class s extends i.XBaseAction{ActName(){return"SetPageFmt"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl(),n=t.M_DocumentFocused;if(null==n)this.resMsg.MsgLevel=1,this.resMsg.MsgStr=this.ActName+" 命令必须已打开文档";else if(null!=e[0]){let n=t.All_Document;for(let r=0;r<n.length;r++){let i=n[r],s=i.GetPageFmt(),o=i.GetPageCols(),a=e[0],u=this._BuildPageFmtInfo(s,o);if(null!=a.pageSize&&(u.PageSizeStd=a.pageSize),null!=a.pageWidth&&(u.PageWidth=a.pageWidth),null!=a.pageHeight&&(u.PageHeight=a.pageHeight),null!=a.pageToward&&(u.PageLayoutStyle=a.pageToward),null!=a.top&&(u.PageTopPadding=a.top),null!=a.bottom&&(u.PageBottomPadding=a.bottom),null!=a.left&&(u.PageLeftPadding=a.left),null!=a.right&&(u.PageRightPadding=a.right),null!=a.headerTop&&(u.PageHeaderPadding=a.headerTop),null!=a.footerBottom&&(u.PageFooterPadding=a.footerBottom),null!=a.headerLine&&(u.IsShowPageHeaderLine=a.headerLine),null!=a.footerLine&&(u.IsShowFooterSptLine=a.footerLine),null!=a.hurdleNum&&(u.SubfieldNum=a.hurdleNum),null!=a.interval&&(u.SubfieldGap=a.interval),null!=a.subLight&&(u.SubLight=a.subLight),null!=a.isZoomPaperPrt&&(u.IsZoomPaperPrt=a.isZoomPaperPrt),null!=a.prtPaperKind&&(u.PrtPaperKind=a.prtPaperKind),l.StringUtils.IsNullOrEmpty(a.prtPaperWidth)?u.PrtPaperWidth=null:u.PrtPaperWidth=a.prtPaperWidth,l.StringUtils.IsNullOrEmpty(a.prtPaperHeight)?u.PrtPaperHeight=null:u.PrtPaperHeight=a.prtPaperHeight,null!=a.isDotLine&&(u.IsDotLine=a.isDotLine),null!=a.gutter&&(u.Gutter=a.gutter),null!=a.gutterPosition&&(u.GutterPosition=a.gutterPosition),null!=a.formfeed&&(u.PaperDirIsHori=a.formfeed),null==u);else{s.IsAdaptive=!!a.isAdaptive&&a.isAdaptive,this._BuildXPageFmt(u,s,o);let e=t.MGetPageFmt(r),n=i.GetDocCtxt().ViewMode.IsWebViewMode;s.TranstoQiPageFmt(e,n),i.IsDocFmtChanged=!0,i.InvalidLayout(),super._RefreshPageAndMoveCaret(!0,!1,!0)}}}else{let e=n.GetPageFmt(),t=n.GetPageCols(),r=["pageSetting",this._BuildPageFmtInfo(e,t)];this.resMsg.ReturnParams=r}return this.resMsg}_BuildPageFmtInfo(e,t){let n=new r.PageContentInstallInfo,i=.254;n.PageSizeStd=e.PaperKind,n.PrtPaperKind=e.PrtPaperKind,n.PrtPaperWidth=null==e.PrtPaperWidth?null:i*e.PrtPaperWidth+.5,n.PrtPaperHeight=null==e.PrtPaperWidth?null:i*e.PrtPaperHeight+.5,n.IsZoomPaperPrt=e.IsZoomPaperPrt,n.PageLayoutStyle=e.Landscape?"横向":"纵向",n.PageWidth=i*e.Width+.5,n.PageHeight=i*e.Height+.5;let l=e.PagePadd;n.PageLeftPadding=i*l.Left,n.PageTopPadding=i*l.Top,n.PageRightPadding=i*l.Right,n.PageBottomPadding=i*l.Bottom,n.Gutter=i*e.GutterMargin;let s=e.GutterSide;return n.GutterPosition=null!=s&&"Top"==s?"上":"左",n.PageHeaderPadding=i*e.HeadTopMargin,n.PageFooterPadding=i*e.FootBtmMargin,n.IsShowPageHeaderLine=e.IsShowHeadSptLine,n.IsShowFooterSptLine=e.IsShowFooterSptLine,n.SubfieldNum=t.ColsCnt,n.SubLight=t.ShowSptLine,n.IsDotLine=t.ColLineIsDashed,n.SubfieldGap=t.ColGap,n.PaperDirIsHori=e.PaperFeedHoriz,n}_BuildXPageFmt(e,t,n){if(null!=e){let r=3.937008;null!=e.PageSizeStd&&(t.PaperKind=e.PageSizeStd,t.WorkModePaperKind=e.PageSizeStd),t.Landscape="横向"==e.PageLayoutStyle,e.PageWidth&&(t.Width=Math.floor(r*e.PageWidth+.5),t.WorkModeWidth=Math.floor(r*e.PageWidth+.5)),e.PageHeight&&(t.Height=Math.floor(r*e.PageHeight+.5),t.WorkModeHeight=Math.floor(r*e.PageHeight+.5)),null!=e.PrtPaperKind&&(t.PrtPaperKind=e.PrtPaperKind),e.PrtPaperWidth?t.PrtPaperWidth=Math.floor(r*e.PrtPaperWidth+.5):t.PrtPaperWidth=null,e.PrtPaperHeight?t.PrtPaperHeight=Math.floor(r*e.PrtPaperHeight+.5):t.PrtPaperHeight=null,null!=e.IsZoomPaperPrt&&(t.IsZoomPaperPrt=e.IsZoomPaperPrt),t.SetPagePadd(e.PageLeftPadding,e.PageTopPadding,e.PageRightPadding,e.PageBottomPadding,25.4),null!=e.Gutter&&(t.GutterMargin=r*e.Gutter);let i=e.GutterPosition;e.GutterPosition&&(i=e.GutterPosition),null!=i&&(t.GutterSide="上"==i?"Top":"Left"),t.SetHeadFootPadd(e.PageHeaderPadding,e.PageFooterPadding,25.4),null!=e.IsShowPageHeaderLine&&(t.IsShowHeadSptLine=e.IsShowPageHeaderLine),null!=e.IsShowFooterSptLine&&(t.IsShowFooterSptLine=e.IsShowFooterSptLine),null!=e.SubfieldNum&&(n.ColsCnt=e.SubfieldNum),n.CalcColsAvgWidth(),null!=e.SubLight&&(n.ShowSptLine=e.SubLight),null!=e.IsDotLine&&(n.ColLineIsDashed=e.IsDotLine),null!=e.SubfieldGap&&(n.ColGap=e.SubfieldGap),t.PaperFeedHoriz=e.PaperDirIsHori}}}t.A_SetPageFmt=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageContentInstallInfo=void 0;t.PageContentInstallInfo=class{get PageSizeStd(){return this._PageSizeStd}set PageSizeStd(e){this._PageSizeStd=e}get PageWidth(){return this._PageWidth}set PageWidth(e){this._PageWidth=e}get PageHeight(){return this._PageHeight}set PageHeight(e){this._PageHeight=e}get PrtPaperKind(){return this._PrtPaperKind}set PrtPaperKind(e){this._PrtPaperKind=e}get PrtPaperWidth(){return this._PrtPaperWidth}set PrtPaperWidth(e){this._PrtPaperWidth=e}get PrtPaperHeight(){return this._PrtPaperHeight}set PrtPaperHeight(e){this._PrtPaperHeight=e}get IsZoomPaperPrt(){return this._isZoomPaperPrt}set IsZoomPaperPrt(e){this._isZoomPaperPrt=e}get PageTopPadding(){return this._PageTopPadding}set PageTopPadding(e){this._PageTopPadding=e}get PageBottomPadding(){return this._PageBottomPadding}set PageBottomPadding(e){this._PageBottomPadding=e}get PageLeftPadding(){return this._PageLeftPadding}set PageLeftPadding(e){this._PageLeftPadding=e}get PageRightPadding(){return this._PageRightPadding}set PageRightPadding(e){this._PageRightPadding=e}get PageHeaderPadding(){return this._PageHeaderPadding}set PageHeaderPadding(e){this._PageHeaderPadding=e}get PageFooterPadding(){return this._PageFooterPadding}set PageFooterPadding(e){this._PageFooterPadding=e}get IsShowPageHeaderLine(){return this._IsShowPageHeaderLine}set IsShowPageHeaderLine(e){this._IsShowPageHeaderLine=e}get IsShowFooterSptLine(){return this._IsShowFooterSptLine}set IsShowFooterSptLine(e){this._IsShowFooterSptLine=e}get PageLayoutStyle(){return this._PageLayoutStyle}set PageLayoutStyle(e){this._PageLayoutStyle=e}get Subfield(){return this._Subfield}set Subfield(e){this._Subfield=e}get SubfieldNum(){return this._SubfieldNum}set SubfieldNum(e){this._SubfieldNum=e}get SubfieldGap(){return this._SubfieldGap}set SubfieldGap(e){this._SubfieldGap=e}get SubLight(){return this._SubLight}set SubLight(e){this._SubLight=e}get IsDotLine(){return this._IsDotLine}set IsDotLine(e){this._IsDotLine=e}get Gutter(){return this._Gutter}set Gutter(e){this._Gutter=e}get GutterPosition(){return this._GutterPosition}set GutterPosition(e){this._GutterPosition=e}get PaperDirIsHori(){return this._PaperDirIsHori}set PaperDirIsHori(e){this._PaperDirIsHori=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetParagraphIndent=void 0;const r=n(2),i=n(846),l=n(1);class s extends l.XBaseAction{ActName(){return"SetParagraphIndent"}constructor(){super(),super.OpType=r.ENumActOpType.StyleEdit}Execute(e){let t;if(this.resMsg.Clear(),null==e||e.length<2)this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName+" 调用参数有误",t=this.resMsg;else{let n=e[0],r=e[1];if(null==n&&null==r)t=this.resMsg;else{let e=super.GetEdtCtrl(),i=this._GetParaghOfEleFocused(e);if(null==i||null==i.ParaghStyle)this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName+" 命令没有选择有效段落。",t=this.resMsg;else{let e=this._ChangeParaghIndent(i,n,r);super._AddUndoItem(e),super._RefreshPageAndMoveCaret(!0,!0),t=this.resMsg}}}return t}_GetParaghOfEleFocused(e){let t=e.M_EleFocused,n=null==t?null:t.OwnerLine;return null==n?null:n.RelEleParagraph}_ChangeParaghIndent(e,t,n){let r=new i.ParagraphIndentUndo(e),l=e.ParaghStyle;return null!=t&&(l.FirstLineIndent=t),null!=n&&(l.LeftIndent=n),e.NotifyLayoutChanged(!0,!1),r.ReadNewIndent(),r}}t.A_SetParagraphIndent=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParagraphIndentUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e){super(),this.paragh=null,this.paraghStyle=null,this.oldLeftIndent=null,this.newLeftIndent=null,this.oldFirstLineIndent=null,this.newFirstLineIndent=null,this.paragh=e,this.paraghStyle=null==e?null:e.ParaghStyle,this.oldLeftIndent=new Number(this.paraghStyle.LeftIndent),this.oldFirstLineIndent=new Number(this.paraghStyle.FirstLineIndent)}ReadNewIndent(){null!=this.paraghStyle&&(this.newLeftIndent=new Number(this.paraghStyle.LeftIndent),this.newFirstLineIndent=new Number(this.paraghStyle.FirstLineIndent))}IsValid(){return null!=this.paraghStyle}CanUndo(){return null!=this.paraghStyle&&(null!=this.oldLeftIndent||null!=this.oldFirstLineIndent)}CanRedo(){return null!=this.paraghStyle&&(null!=this.newLeftIndent||null!=this.newFirstLineIndent)}Undo(){this.CanUndo()&&(null!=this.oldLeftIndent&&(this.paraghStyle.LeftIndent=this.oldLeftIndent),null!=this.oldFirstLineIndent&&(this.paraghStyle.FirstLineIndent=this.oldFirstLineIndent),this.paragh.NotifyLayoutChanged(!0,!1))}Redo(){this.CanRedo()&&(null!=this.newLeftIndent&&(this.paraghStyle.LeftIndent=this.newLeftIndent),null!=this.newFirstLineIndent&&(this.paraghStyle.FirstLineIndent=this.newFirstLineIndent),this.paragh.NotifyLayoutChanged(!0,!1))}Clear(){this.paragh=null,this.paraghStyle=null;let e=null;this.newLeftIndent=e,this.oldLeftIndent=this.newLeftIndent=e,e=null,this.newFirstLineIndent=e,this.oldFirstLineIndent=this.newFirstLineIndent=e}}t.ParagraphIndentUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetParagraphStyle=void 0;const r=n(2),i=n(105),l=n(10),s=n(848),o=n(243),a=n(181),u=n(13),h=n(8),d=n(1);class c extends d.XBaseAction{constructor(){super(),super.OpType=r.ENumActOpType.StyleEdit}ActName(){return"SetParagraphStyle"}Execute(e){this.resMsg.Clear();const t=this._GetArrParaghOfSelLines(super.GetEdtCtrl());if(null==t||0==t.length)return this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName+" 命令没有点击或选择有效的段落。",this.resMsg;const n=e[0];if(null==n)return this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName+" 命令没有需要设置的段落样式。",this.resMsg;const r=super.GetXDocFocused();let l=new i.XParagraphFlagStyle;l.SetDocument(r),l.BuildCommStyle(t);const s=this.ShowParagraphForm(l,n);if(null==s)return this.resMsg.Clear(),this.resMsg;let o=!1,a=new u.UndoGroup;for(let e=0;e<t.length;e++){let n=t[e];o=this._ChangeOneParaghStyle(n,s,a)||o}return o&&(super._AddUndoItem(a),super._RefreshPageAndMoveCaret(!0,!0,!0)),this.resMsg}_GetArrParaghOfSelLines(e){let t=e.M_EleEvtModel,n=null,r=e.M_EleEvtModel.SelRange;if(null!=r&&r.IsValid())n=r.InfoUtil.GetLineParaghFlagsInRange();else{let e=t.EleClickedWrap.LineEleIxFocused.Line;null!=e&&(n=[e.RelEleParagraph])}return n}ShowParagraphForm(e,t){if(!0===t){let t=this._BuildParagraphInfo(e);return this.InitParagraphForm(t),null}let n=new o.ParagraphFormInfo;const r={ParagraphBeforeShrink:{type:"number",val:t._paragraphBefore},ParagraphAfterShrink:{type:"number",val:t._paragraphAfter},RowSpaceValueText:{type:"string",val:t._rowPadding},RowSpace:{type:"number",val:t._setValue},IsFirstRowShrink:{type:"boolean",val:t._firstRowShrinkageCheckBox},IsHangInShrink:{type:"boolean",val:t._shrinkageCheckBox},LeftShrink:{type:"number",val:t._leftShrinkage},FirstRowShrink:{type:"number",val:t._firstRowShrinkage},Shrink:{type:"number",val:t._shrinkage}};let i=!0;for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)){const t=r[e];let l=t.val;void 0!==l&&("boolean"==t.type?l=!!l:"number"==t.type&&(l=Number(l)||0),n[e]=l,i=!1)}return i?null:n}InitParagraphForm(e){const t=e.FirstRowShrink;let n={};if(n._rowPadding=e.RowSpaceValueText,n._setValue=e.RowSpace,n._leftShrinkage=e.LeftShrink,n._firstRowShrinkage=t,n._paragraphBefore=e.ParagraphBeforeShrink,n._paragraphAfter=e.ParagraphAfterShrink,n._firstRowShrinkageCheckBox=e.IsFirstRowShrink,n._shrinkageCheckBox=e.IsHangInShrink,t&&t<0){const r=Number(e.LeftShrink)||0,i=Math.abs(Number(t))||0;n._shrinkage=i,r>i?n._leftShrinkage=r-i:r&&(n._leftShrinkage=0),n._firstRowShrinkage=0,n._shrinkageCheckBox=!0,n._firstRowShrinkageCheckBox=!1}null!=this.paragraphComp&&this.paragraphComp.Child?this.paragraphComp.updateProps({ValueText:n}):this.paragraphComp=new s.ParagraphComp({ValueText:n,onOk:this.Execute.bind(this)})}DPItoCM(e){return e=l.DPITransUtil.TransFloatVal(e,96,300),e=l.DPITransUtil.TransFloatVal(e,300,25.4),e=h.CNumUtil.Round(e/10,2,!0)}_ChangeOneParaghStyle(e,t,n){let r=e.ParaghStyle;const i=this._CheckParaInfo(t,e);let l=new a.EleStyleUndo(e,a.ENumSubset.Paragraph);return r.BuildXParagraphStyle(i),e.NotifyLayoutChanged(!0,!1),l.ReadNewStyle(),n.AddItem(l),!0}_CheckParaInfo(e,t){const n=t.Parent;if(null==n)return e;let r=o.ParagraphFormInfo.CopyInfo(e);if(null!=e.LeftShrink||null!=e.FirstRowShrink||null!=e.Shrink){let i=n.GetValidWidth(96);i-=this.getMaxWidthOnParagraph(t),i=Math.floor(i),i=this.DPItoCM(i);const s=t.ParaghStyle;let o=s.LeftIndent||0,a=0,u=s.FirstLineIndent||0;if(u<0&&(o+=Number(u),a=-1*u,u=0),0!=o){const e=l.DPITransUtil.TransFloatVal(o,300,25.4);o=h.CNumUtil.Round(e/10,2,!0)}if(0!=a){const e=l.DPITransUtil.TransFloatVal(a,300,25.4);a=h.CNumUtil.Round(e/10,2,!0)}if(0!=u){const e=l.DPITransUtil.TransFloatVal(u,300,25.4);u=h.CNumUtil.Round(e/10,2,!0)}let d=0;d=null!=e.LeftShrink?Number(e.LeftShrink)||0:o,d<0&&(d=0);let c=Number(e.Shrink)||0,p=Number(e.FirstRowShrink)||0;null!=e.Shrink&&c>0?p=0:null!=e.FirstRowShrink&&p>0?c=0:null==e.FirstRowShrink&&null==e.Shrink&&(c=a,p=u),c<0&&(c=0),p<0&&(p=0);let f=1;c>0?(f=i/(c+d),f<1&&(c=h.CNumUtil.Round(c*f,2,!1),d=h.CNumUtil.Round(d*f,2,!1),f=1),d+=c,p=-1*c):p>0?(f=i/(p+d),f<1&&(p=h.CNumUtil.Round(p*f,2,!1))):f=i/d,f<1&&(d=h.CNumUtil.Round(d*f,2,!1)),r.Shrink=c||0,r.FirstRowShrink=p||0,r.LeftShrink=d||0}if(null!=e.ParagraphBeforeShrink){let t=Number(e.ParagraphBeforeShrink);t>10?t=10:t>0||(t=0),r.ParagraphBeforeShrink=t}if(null!=e.ParagraphAfterShrink){let t=Number(e.ParagraphAfterShrink);t>10?t=10:t>0||(t=0),r.ParagraphAfterShrink=t}const i=e.RowSpaceValueText;if(null!=i){let t=e.RowSpace;t>1?"SpaceMultiple"==i&&t>20?t=20:"SpaceSpecify"==i&&t>200&&(t=200):t=1,r.RowSpace=t}return r}getMaxWidthOnParagraph(e){if(null==e)return 0;let t=e.OwnerLine,n=0;for(;null!=t;){const r=t.RelEleParagraph;if(null!=r&&r.XID==e.XID&&t.ElementCnt>0){const e=t.ChildEleList.ToArray();for(let t=0;t<e.length;t++){const r=e[t].GetBoundsDPI(96).Width;r>n&&(n=r)}}t=t.PrevLine}return n}_BuildParagraphInfo(e){let t=0,n=new o.ParagraphFormInfo,r=e.HasProp("LeftIndent");return r?(t=l.DPITransUtil.TransFloatVal(e.LeftIndent,300,25.4),n.LeftShrink=h.CNumUtil.Round(t/10,2,!0)):n.LeftShrink=null,r=e.HasProp("FirstLineIndent"),r?(t=l.DPITransUtil.TransFloatVal(e.FirstLineIndent,300,25.4),n.FirstRowShrink=h.CNumUtil.Round(t/10,2,!0)):n.FirstRowShrink=null,t>0?(n.IsFirstRowShrink=!0,n.IsHangInShrink=!1):t<0?(n.IsFirstRowShrink=!1,n.IsHangInShrink=!0):(n.IsFirstRowShrink=!1,n.IsHangInShrink=!1),r=e.HasProp("SpacingBeforeParagraph"),n.ParagraphBeforeShrink=r?h.CNumUtil.Round(e.GetLineCntOfSpacing(!0),2,!0):null,r=e.HasProp("SpacingAfterParagraph"),n.ParagraphAfterShrink=r?h.CNumUtil.Round(e.GetLineCntOfSpacing(!1),2,!0):null,r=e.HasProp("LineSpacingStyle"),n.RowSpaceValueText=r?e.LineSpacingStyle:null,n.RowSpace=e.LineSpacing,r=e.HasProp("ParagraphMultiLevel"),n.IsMoreParaList=r?e.ParagraphMultiLevel:null,n}}t.A_SetParagraphStyle=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParagraphComp=void 0;const r=n(12),i=n(24),l=n(52);n(849);const s=n(22),o=n(242);class a extends r.Component{constructor(e){super(e),this.arr_outLine=[["-1","正文文本"],["0","1级"],["1","2级"],["2","3级"],["3","4级"],["4","5级"],["5","6级"],["6","7级"],["7","8级"],["8","9级"]],this.arr_rowPadding=[["1","单倍行距","SpaceSingle"],["2","1.5倍行距","Space1pt5"],["3","2倍行距","SpaceDouble"],["4","最小值","SpaceExactly"],["5","固定值","SpaceSpecify"],["6","多倍行距","SpaceMultiple"]],this.arr_listTableStyle=[["None","无"],["ListNumberStyle","1. 2. 3. "],["ListNumberStyleArabic1","1, 2, 3, "],["ListNumberStyleArabic2","1) 2) 3) "],["ListNumberStyleNumberInCircle","① ② ③ "],["ListNumberStyleLowercaseLetter","a) b) c) "],["ListNumberStyleLowercaseRoman","i) ii) iii) "],["ListNumberStyleSimpChinNum1","一、 二、 三、 "],["ListNumberStyleSimpChinNum2","一） 二） 三） "],["ListNumberStyleTradChinNum1","壹、 贰、 叁、 "],["ListNumberStyleTradChinNum2","壹） 贰） 叁） "],["ListNumberStyleZodiac1","甲， 乙， 丙， "],["ListNumberStyleZodiac2","子， 丑， 寅， "],["BulletedList","● ● ● "],["BulletedListBlock","■ ■ ■ "],["BulletedListDiamond","◆ ◆ ◆ "],["BulletedListCheck","✔ ✔ ✔ "],["BulletedListHollowStar","✧ ✧ ✧ "]],this.arrSelectsData=[{name:"_outLine",label:"大纲级别",type:"select",default:this.arr_outLine[0][1]},{name:"_listTableStyle",label:"列表方式",type:"select",default:this.arr_listTableStyle[0][1]}],this.arrRowPadding=[{name:"_rowPadding",label:"行距",type:"select",default:this.arr_rowPadding[0][1]},{name:"_setValue",label:"",type:"number",hide:!0,min:1}],this.arrInputsData=[{name:"_paragraphBefore",label:"段落前间距(行)",type:"number"},{name:"_paragraphAfter",label:"段落后间距(行)",type:"number"},{name:"_firstRowShrinkage",label:"首行缩进量(cm)",type:"number"},{name:"_shrinkage",label:"悬挂缩进量(cm)",type:"number"},{name:"_leftShrinkage",label:"左侧缩进量(cm)",type:"number"}],this.ValueTextPre={},this.ValueTextOk={},this.inputRef_setValue=r.createRef(),this.inputRef_firstRowShrinkage=r.createRef(),this.inputRef_shrinkage=r.createRef(),this.inputRef_leftShrinkage=r.createRef(),this.inputRef_paragraphBefore=r.createRef(),this.inputRef_paragraphAfter=r.createRef(),this.getSelectArr=e=>{let t;switch(e){case"_outLine":t=this.arr_outLine;break;case"_rowPadding":t=this.arr_rowPadding;break;case"_listTableStyle":t=this.arr_listTableStyle;break;default:t=[]}return t},this.getSelectOptions=(e,t)=>{let n=this.getSelectArr(e);return n.length>0?n.map(n=>{let r={};return r[t]=n[1],r.type=e,"_rowPadding"==e?(r._setValue=n[0],r.val=n[2]):r.val=n[0],r}):[]},this.getSelectedOption=(e,t)=>{let n;return t&&this.getSelectArr(e).map(r=>{if(("_rowPadding"==e?r[2]:r[0])==t)return n=r[1],!1}),n},this.getStep=e=>{let t=1;const n=(e=e?e.toString():"").indexOf(".");return t=-1==n?1:e.length-n>2?.01:.1,t},this.isShow_setValue=e=>"SpaceSpecify"==e?[9,"磅"]:"SpaceMultiple"==e?[3,"倍"]:[null,""],this.ShrinkageHandler=(e,t)=>{const n=e.target.value;n>0&&("_firstRowShrinkage"==t?(this.ValueTextOk._shrinkage=void 0,this.inputRef_shrinkage.current.value="0"):"_shrinkage"==t&&(this.ValueTextOk._firstRowShrinkage=void 0,this.inputRef_firstRowShrinkage.current.value="0")),this.ValueTextOk[t]=n},this.selectHandler=e=>{switch(e.type){case"_rowPadding":const t=this.isShow_setValue(e.val);if(null!=t[0]){const e=this.inputRef_setValue;e.current&&(e.current.value=t[0].toString())}const n=t[0]||e._setValue;this.ValueTextOk._setValue=n,this.setState({_setValueMin:t[0],_setValueUnit:t[1]});default:this.ValueTextOk[e.type]=e.val}},this.updateEvent=e=>{const t=this.isShow_setValue(e.ValueText._rowPadding);this.arrSelectsData.map((t,n)=>{if(null!=t.ref){const n=t.name,r=e.ValueText[n]||t.default,i=(this.ValueTextPre[n]||t.default,this.getSelectedOption(n,r)||t.default||"");t.ref.updateEvent({selectedValues:[{model:i}]}),this.ValueTextPre[n]=r}}),this.arrRowPadding.map((t,n)=>{if("select"==t.type){if(null!=t.ref){const n=t.name,r=e.ValueText[n]||t.default,i=(this.ValueTextPre[n]||t.default,this.getSelectedOption(n,r)||t.default||"");t.ref.updateEvent({selectedValues:[{model:i}]}),this.ValueTextPre[n]=r}}else if("number"==t.type){const n=t.name,r=e.ValueText[n]||0,i=this.ValueTextPre[n]||0,l=this.inputRef_setValue;r!=i&&(l.current&&(l.current.value=r+""||"1"),this.ValueTextPre[n]=r)}}),this.arrInputsData.map((t,n)=>{const r=t.name,i=this["inputRef"+r],l=e.ValueText[r]||0;l!=i.current.value&&(i.current.value=l+""||"0",this.ValueTextPre[r]=l)}),this.ValueTextOk={},this.setState({isShow:!0,_setValueMin:t[0],_setValueUnit:t[1]})},this.closeEvent=()=>{"function"==typeof this.props.onClose&&this.props.onClose(),this.setState({isShow:!1})},e.onRef&&e.onRef(this),this.okHandler=this.okHandler.bind(this),this.closeEvent=this.closeEvent.bind(this),this.ShrinkageHandler=this.ShrinkageHandler.bind(this),this.ValueTextPre=Object.assign({},e.ValueText);const t=this.isShow_setValue(e.ValueText._rowPadding);this.state={isShow:!0,_setValueMin:t[0],_setValueUnit:t[1]}}render(){return r.createElement(l.Dialog,{title:"段落设置",width:550,visible:this.state.isShow,onOk:this.okHandler,onCancel:this.closeEvent},this.renderCheckbox(),this.renderSelects(),this.renderRowPadding(),this.renderInputs())}renderSelects(){let e=this.arrSelectsData.map((e,t)=>{let n=this.ValueTextPre[e.name]||e.default;const i=this.getSelectedOption(e.name,n)||e.default||"";return r.createElement("li",{key:"paragraph_"+e.name},r.createElement("label",{title:e.label},e.label),r.createElement(o.default,Object.assign({},{id:e.name,singleSelect:!0,options:this.getSelectOptions(e.name,"model"),width:"100%",avoidHighlightFirstOption:!0,selectedValues:[{model:i}]},{onSelectedItem:this.selectHandler,onRef:t=>e.ref=t})))});return r.createElement("div",{className:"paragraph-ul"},e)}renderRowPadding(){const{_setValueMin:e,_setValueUnit:t}=this.state;let n=this.arrRowPadding[0];const i=this.getSelectedOption(n.name,this.ValueTextPre[n.name]||n.default)||n.default||"";let l=this.arrRowPadding[1];const s=this.inputRef_setValue,a=this.getStep(this.ValueTextPre[l.name]),u=!t;u?l.label="":(l.label="设置值("+t+")",l.min=Number(e)||1);let h=this.ValueTextPre[l.name]||n.min;return r.createElement("div",{className:"paragraph-ul"},r.createElement("li",{key:"paragraph_"+n.name},r.createElement("label",{title:n.label},n.label),r.createElement(o.default,Object.assign({},{id:n.name,singleSelect:!0,options:this.getSelectOptions(n.name,"model"),width:"100%",avoidHighlightFirstOption:!0,selectedValues:[{model:i}]},{onSelectedItem:this.selectHandler,onRef:e=>n.ref=e}))),r.createElement("li",{key:"paragraph_"+l.name},r.createElement("label",{title:l.label},l.label),u?null:r.createElement("input",{onKeyPress:e=>{/[\d|\.]/g.test(String.fromCharCode(e.charCode))||e.preventDefault()},onClick:e=>e.currentTarget.select(),onChange:e=>this.ShrinkageHandler(e,l.name),className:"paragraph-input pango-editor-input-inner",type:"number",step:a,defaultValue:h,ref:s,min:l.min})))}renderInputs(){let e=this.arrInputsData.map((e,t)=>{const n=this.ValueTextPre[e.name]||"0",i=this.getStep(n),l=this["inputRef"+e.name];return r.createElement("li",{key:"paragraph_"+e.name},r.createElement("label",{title:e.label},e.label),r.createElement("input",{onKeyPress:e=>{/[\d|\.]/g.test(String.fromCharCode(e.charCode))||e.preventDefault()},onClick:e=>e.currentTarget.select(),onChange:t=>this.ShrinkageHandler(t,e.name),className:"paragraph-input pango-editor-input-inner",type:"number",step:i,defaultValue:n,ref:l}))});return r.createElement("div",{className:"paragraph-ul"},e)}renderCheckbox(){let e=[{name:"_moreParagraphListTableCheckBox",text:"多层段落列表"}].map((e,t)=>{const n=!!this.state[e.name];return this.ValueTextPre[e.name]=n,r.createElement("label",{key:"paragraph_"+e.name},r.createElement("input",{type:"checkbox",name:"paragraphCheckbox",defaultChecked:n,onChange:t=>this.ValueTextOk[e.name]=t.target.checked}),e.text)});return r.createElement("div",{className:"paragraph-checbox"},e)}okHandler(){let e={};for(const t in this.ValueTextOk){const n=this.ValueTextOk[t];n!=this.ValueTextPre[t]+""&&(e[t]=n)}this.ValueTextPre=e,"function"==typeof this.props.onOk&&this.props.onOk([e]),this.closeEvent()}}class u extends s.BaseComponent{constructor(e,t=null){super(t,e),this.updateProps=e=>{this.Child&&this.Child.updateEvent(e)},this.updateProps=this.updateProps.bind(this)}Render(){const e=r.createElement(a,Object.assign({},this.Props,{parent:this,onRef:e=>this.Child=e}));i.render(e,document.createDocumentFragment())}}t.ParagraphComp=u},function(e,t,n){var r=n(18),i=n(850);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".paragraph-ul {\r\n    width: 98%;\r\n    margin: auto;\r\n    margin-left: -1%;\r\n    zoom: 1;\r\n}\r\n.paragraph-ul:after {\r\n    content: '';\r\n    display: block;\r\n    clear: both;\r\n}\r\n.paragraph-ul>li {\r\n    list-style: none;\r\n    float: left;\r\n    width: 50%;\r\n    margin-bottom: 0.5em;\r\n    zoom: 1;\r\n}\r\n.paragraph-ul>li:after {\r\n    content: '';\r\n    display: block;\r\n    clear: both;\r\n}\r\n.paragraph-ul>li label {\r\n    font-size: 14px;\r\n    line-height: 32px;\r\n    float: left;\r\n    width: 40%;\r\n    padding-right: 4%;\r\n    padding-left: 6%;\r\n    text-align: right;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n.paragraph-ul .selectContainer {\r\n    float: left;\r\n    width: 50%;\r\n    cursor: pointer;\r\n}\r\n\r\n.paragraph-ul .paragraph-input {\r\n    float: left;\r\n    width: 50%;\r\n    min-width: 120px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.paragraph-checbox {\r\n    font-size: 14px;\r\n    padding-left: 23.5%;\r\n}\r\n.paragraph-checbox input,\r\n.paragraph-checbox label {\r\n    margin-top: 0;\r\n    vertical-align: middle;\r\n}\r\n.paragraph-checbox label {\r\n    margin-right: 2%;\r\n}\r\n\r\ndiv.paragraph-ul .pango-editor-input--wrap,\r\ndiv.paragraph-ul .pango-editor-input,\r\ndiv.paragraph-ul .pango-editor-input-inner {\r\n    max-width: 100%;\r\n    cursor: pointer;\r\n}\r\n.paragraph-ul .selectContainer .singleSelect {\r\n    padding-right: 0;\r\n}\r\n.paragraph-ul .selectContainer .pango-editor-input--wrap {\r\n    width: 100%;\r\n    padding-left: 0;\r\n    margin-right: 0;\r\n}\r\n",""]),e.exports=t},function(e,t,n){var r=n(18),i=n(852);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,'.selectContainer {\r\n    position: relative;\r\n    display: inline-block;\r\n    width: max-content;\r\n    box-sizing: border-box;\r\n    border-radius: 2px;\r\n    color: #000;\r\n    outline: none;\r\n    transition: border-color .2s cubic-bezier(.645, .045, .355, 1), box-shadow .2s cubic-bezier(.645, .045, .355, 1);\r\n}\r\n.selectContainer i {\r\n    font-style: normal;\r\n}\r\n.selectContainer .disable_ms {\r\n    pointer-events: none;\r\n    opacity: 0.5;\r\n}\r\n.selectContainer .searchWrapper {\r\n    width: max-content;\r\n    border: 1px solid #cccccc;\r\n    border-radius: 4px;\r\n    padding: 5px;\r\n    min-height: 22px;\r\n    position: relative;\r\n}\r\n.selectContainer input.inputValueBox {\r\n    width: 0;\r\n    padding: 0;\r\n    border: none;\r\n    background: transparent;\r\n}\r\n.selectContainer input.inputValueBox:focus {\r\n    outline: none;\r\n}\r\n.selectContainer .chip {\r\n    display: inline-block;\r\n    margin: 0 2px;\r\n    padding-left: 10px;\r\n    background: #EAEEFE;\r\n    font-size: 12px;\r\n    color: #2D5AFA;\r\n    overflow: hidden;\r\n    text-overflow:ellipsis;\r\n    white-space: nowrap;\r\n}\r\n.selectContainer .singleChip {\r\n    background: none;\r\n    border-radius: 0;\r\n    color: inherit;\r\n    white-space: nowrap;\r\n    text-overflow:ellipsis;\r\n    overflow: hidden;\r\n}\r\n.selectContainer i.suffixIcon {\r\n    pointer-events: none;\r\n    font-size: 12px;\r\n    transform: translateZ(0);\r\n    transform: scale(.6) rotate(0);\r\n    transition: transform 0.2s linear;\r\n    color: #7e89a4;\r\n}\r\n.selectContainer .closeIcon {\r\n    font-size: 12px;\r\n    float: right;\r\n    margin-left: 2px;\r\n    cursor: pointer;\r\n}\r\n\r\n\r\n\r\n\r\n.selectContainer .optionListContainer {\r\n    position: absolute;\r\n    width: auto;\r\n    background: #fff;\r\n    border-radius: 2px;\r\n    margin-top: 4px;\r\n    z-index: 2;\r\n\r\n    border: 1px solid #c9c9c9;\r\n    box-shadow: 0 2px 4px rgba(0,0,0,.12);\r\n    overflow: auto;\r\n}\r\n.selectContainer ul {\r\n    display: block;\r\n    padding: 0;\r\n    margin: 0;\r\n    border-radius: 4px;\r\n    max-height: 250px;\r\n    overflow-y: auto;\r\n}\r\n.selectContainer ul::-webkit-scrollbar {\r\n    width: 3px;\r\n}\r\n.selectContainer ul::-webkit-scrollbar-thumb {\r\n    background: #d8d8d8;\r\n    border-radius: 10px;\r\n}\r\n.selectContainer ul::-webkit-scrollbar-track-piece {\r\n    background: transparent;\r\n}\r\n.selectContainer li {\r\n    display: flex;\r\n    align-items: center;\r\n    font-size: 13px;\r\n    padding: 0 8px;\r\n    position: relative;\r\n    white-space: nowrap;\r\n    color: #000;\r\n    height: 30px;\r\n    line-height: 30px;\r\n    box-sizing: border-box;\r\n    cursor: pointer;\r\n}\r\n.selectContainer li:hover {\r\n    background: #eaeefe;\r\n    cursor: pointer;\r\n}\r\n.selectContainer .checkbox {\r\n    margin-right: 10px;\r\n}\r\n.selectContainer .disableSelection {\r\n    pointer-events: none;\r\n    opacity: 0.5;\r\n}\r\n.selectContainer .optionContainer {\r\n    padding: 0;\r\n    margin: 0;\r\n    box-sizing: border-box;\r\n}\r\n.selectContainer .highlightOption {\r\n    color: #2d5afa;\r\n    background: #eaeefe;\r\n}\r\n.selectContainer .displayBlock {\r\n    display: block;\r\n    position: absolute;\r\n    box-sizing: border-box;\r\n    background: #fff;\r\n    border-radius: 4px;\r\n    min-width: 50px;\r\n    z-index: 2000;\r\n    color: #606266;\r\n    line-height: 1.4;\r\n    text-align: justify;\r\n    font-size: 13px;\r\n    box-shadow: 0 2px 12px 0 rgba(0,0,0,.1);\r\n    word-break: break-all;\r\n    overflow: hidden;\r\n}\r\n.selectContainer .displayNone {\r\n    display: none;\r\n}\r\n.selectContainer .notFound {\r\n    padding: 10px;\r\n    display: block;\r\n}\r\n.selectContainer .singleSelect {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 4px;\r\n}\r\n.selectContainer li.groupHeading {\r\n    color: #908e8e;\r\n    pointer-events: none;\r\n    padding: 5px 15px;\r\n}\r\n.selectContainer li.groupChildEle {\r\n    padding-left: 30px;\r\n}\r\n.selectContainer .icon_cancel_circled:before {\r\n    content: "\\e800";\r\n}\r\n.selectContainer .icon_cancel:before {\r\n    content: "\\2716";\r\n}\r\n',""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetParaMuliSerno=void 0;const r=n(182);class i extends r.A_SetParaSerno{ActName(){return"SetParaMuliSerno"}Execute(e){let t;return t=super.Execute([e[0],!0,1]),t}}t.A_SetParaMuliSerno=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetParaSingleSerno=void 0;const r=n(182);class i extends r.A_SetParaSerno{ActName(){return"SetParaSingleSerno"}Execute(e){let t;return t=super.Execute([e[0],!1,1]),t}}t.A_SetParaSingleSerno=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetSubscript=void 0;const r=n(369);class i extends r.BaseA_SetSuperSubScript{ActName(){return"SetSubscript"}Execute(e){let t=new Array;return t[1]=e[0],super.Execute(t)}}t.A_SetSubscript=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCharSupbScriptUndo=void 0;const r=n(0),i=n(23);class l extends i.IXUndoable{constructor(e){super(),this.relEle=null,this.oldSuper=!1,this.newSuper=!1,this.oldSub=!1,this.newSub=!1,this.relEle=e,null!=e&&(this.oldSuper=e.EleStyle.Superscript,this.oldSub=e.EleStyle.Subscript)}ReadNewSupbScript(){null!=this.relEle&&(this.newSuper=this.relEle.EleStyle.Superscript,this.newSub=this.relEle.EleStyle.Subscript)}IsValid(){return null!=this.relEle}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){if(this.CanUndo()){this.relEle.EleStyle.Superscript=this.oldSuper,this.relEle.EleStyle.Subscript=this.oldSub;let e=this.relEle instanceof r.XBaseInputEle?this.relEle:null;null==e?this.relEle.NotifyLayoutChanged(!0,!1):e.ResetInnerChildrenStyles(!0)}}Redo(){if(this.CanRedo()){this.relEle.EleStyle.Superscript=this.newSuper,this.relEle.EleStyle.Subscript=this.newSub;let e=this.relEle;null==e?this.relEle.NotifyLayoutChanged(!0,!1):e.ResetInnerChildrenStyles(!0)}}Clear(){this.relEle=null,this.oldSuper=this.newSuper=!1,this.oldSub=this.newSub=!1}}t.XCharSupbScriptUndo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetSuperscript=void 0;const r=n(369);class i extends r.BaseA_SetSuperSubScript{ActName(){return"SetSuperscript"}Execute(e){let t=new Array;return t[0]=e[0],super.Execute(t)}}t.A_SetSuperscript=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetTextUnderline=void 0;const r=n(112);class i extends r.BaseA_SetFontDetail{ActName(){return"SetTextUnderline"}Execute(e){let t;return this.resMsg.Clear(),super.ChkActParamsCnt(e)?(super.Execute([e[0]]),t=this.resMsg):t=this.resMsg,t}}t.A_SetTextUnderline=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetWaterMark=void 0;const r=n(2),i=n(860),l=n(861),s=n(8),o=n(1),a=n(7),u=n(83);class h extends o.XBaseAction{constructor(){super(...arguments),this.imgExistPath="(现有水印)"}ActName(){return"SetWaterMark"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),s=n.All_Document;if(null==e[0]){let e=n.M_DocumentFocused.GetWaterMark(),t=this._BuildWaterMarkInfo(e);return this.resMsg.ReturnParams=["waterInfo",t],this.resMsg}for(let o=0;o<s.length;o++){let u=s[o];if(null==u)this.resMsg.MsgLevel=1,this.resMsg.MsgStr=this.ActName+" 命令必须已打开文档",t=this.resMsg;else{let s,o=this._BuildWaterMarkInfo(u.GetWaterMark()),h=u.GetWaterMark(),d=!1;if(e.length>0&&e[0]instanceof i.WaterMarkInfo)s=e[0],d=!0;else{let t=e[0];switch(s=new i.WaterMarkInfo,t.watermarkType){case"None":s.MarkType=r.ENumWarterMarkTp.None;break;case"Text":s.MarkType=r.ENumWarterMarkTp.Text;break;case"Image":s.MarkType=r.ENumWarterMarkTp.Image}if(s.PhotoPath=t.watermarkPic,s.PhotoZoomScaleStr=t.picScale,s.IsPhotoErosionChecked="true"===t.picWashout,s.StrText=t.watermarkContent,s.FontName=t.watermarkFont,s.FontSize=t.watermarkSize,s.Width=t.width,s.Height=t.height,null!=t.watermarkColor){let e=new a.Color(t.watermarkColor),n=null==t.watermarkOpacity?1:t.watermarkOpacity;e.setOpacity(n),s.TextColor=e,s.Opacity=n}else s.TextColor=a.Color.LightGray;s.IsPrint=null==t.printflag||t.printflag,s.EditorPrintFlag=null==t.editorPrintFlag||t.editorPrintFlag,s.IsTile=null!=t.Tileflag&&t.Tileflag,s.WatermarkSpacing=null==t.watermarkSpacing?"100":t.watermarkSpacing,s.TextAngle=t.watermarkFormat}if(null==s)t=this.resMsg;else{if(this._BuildXWaterMark(s,h),u.IsDocFmtChanged=!0,!d){let e=new l.XDocWaterMarkUndo(n,o,s);super._AddUndoItem(e)}t=this.resMsg}}}return t}_BuildWaterMarkInfo(e){let t=new i.WaterMarkInfo;switch(t.MarkType=e.MarkType,e.MarkType){case r.ENumWarterMarkTp.Text:{t.StrText=e.Text;let n=e.Font;t.FontName=n.Name,t.FontSize=e.IsAutoFntSz()?0:n.SizeInPoints,t.TextColor=e.ForeColor,t.TextAngle=e.TextAngle,t.IsPrint=e.IsPrint,t.EditorPrintFlag=e.EditorPrintFlag,t.WatermarkSpacing=e.WatermarkSpacing,t.Width=e.Width,t.Height=e.Height,t.Opacity=e.Opacity,t.IsTile=e.IsTile;break}case r.ENumWarterMarkTp.Image:{let n=e.ImgZmRatio;t.PhotoZoomScaleStr=n<=0?"自动":100*n+"%",t.IsPhotoErosionChecked=e.ImgEroded,t.PhotoPath=null==e.ImgObj?null:this.imgExistPath;break}}return t}_BuildXWaterMark(e,t){if(null!=e)switch(t.MarkType=e.MarkType,t.IsPrint=e.IsPrint,t.EditorPrintFlag=e.EditorPrintFlag,e.MarkType){case r.ENumWarterMarkTp.Text:{let n=e.FontSize,r=t.FntStyle;t.Text=e.StrText,r.FontName=e.FontName,r.FontSize=n<=0?2:n,t.TextAngle=e.TextAngle,t.ForeColor=e.TextColor,t.IsTile=e.IsTile,t.Width=Number(e.Width),t.Height=Number(e.Height),t.WatermarkSpacing=e.WatermarkSpacing,t.Opacity=e.Opacity,t.NotifyFontChanged();break}case r.ENumWarterMarkTp.Image:{let n=u.XImageUtil.Base64ToImage(decodeURIComponent(e.PhotoPath));t.ImgObj=n,t.ImgZmRatio=s.CNumUtil.TryParsePct(e.PhotoZoomScaleStr,0),t.ImgEroded=e.IsPhotoErosionChecked;break}}}}t.A_SetWaterMark=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WaterMarkInfo=void 0;t.WaterMarkInfo=class{get MarkType(){return this._MarkType}set MarkType(e){this._MarkType=e}get PhotoPath(){return this._PhotoPath}set PhotoPath(e){this._PhotoPath=e}get PhotoZoomScaleStr(){return this._PhotoZoomScaleStr}set PhotoZoomScaleStr(e){this._PhotoZoomScaleStr=e}get IsPhotoErosionChecked(){return this._IsPhotoErosionChecked}set IsPhotoErosionChecked(e){this._IsPhotoErosionChecked=e}get IsPrint(){return this._isPrint}set IsPrint(e){this._isPrint=e}get EditorPrintFlag(){return this._editorPrintFlag}set EditorPrintFlag(e){this._editorPrintFlag=e}get IsTile(){return this._isTile}set IsTile(e){this._isTile=e}get StrText(){return this._StrText}set StrText(e){this._StrText=e}get WatermarkSpacing(){return this._WatermarkSpacing}set WatermarkSpacing(e){this._WatermarkSpacing=e}get FontName(){return this._FontName}set FontName(e){this._FontName=e}get Width(){return this._width}set Width(e){this._width=e}get Height(){return this._height}set Height(e){this._height=e}get FontSize(){return this._FontSize}set FontSize(e){this._FontSize=e}get TextColor(){return this._TextColor}set TextColor(e){this._TextColor=e}get Opacity(){return this._Opacity}set Opacity(e){this._Opacity=e}get IsColorTranslucentChecked(){return this._IsColorTranslucentChecked}set IsColorTranslucentChecked(e){this._IsColorTranslucentChecked=e}get TextAngle(){return this._TextAngle}set TextAngle(e){this._TextAngle=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocWaterMarkUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t,n){super(),this._oldWaterMarkInfo=null,this._newWaterMarkInfo=null,this._docEditable=null,this._oldWaterMarkInfo=t,this._docEditable=e,this._newWaterMarkInfo=n}IsValid(){return null!=this._docEditable}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){this._docEditable.M_GetActionByName("SetWaterMark").Execute([this._oldWaterMarkInfo])}Redo(){this._docEditable.M_GetActionByName("SetWaterMark").Execute([this._newWaterMarkInfo])}Clear(){this._docEditable=null}}t.XDocWaterMarkUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CopyInsertTableCol_Left=void 0;const r=n(370);class i extends r.A_CopyInsertTableCol{ActName(){return"CopyInsertTableCol_Left"}get RelExcuteActName(){return"TextTableInsertColumn_Left"}}t.A_CopyInsertTableCol_Left=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CopyInsertTableCol_Right=void 0;const r=n(370);class i extends r.A_CopyInsertTableCol{get RelExcuteActName(){return"TextTableInsertColumn_Right"}ActName(){return"CopyInsertTableCol_Right"}get InsertColInxPre(){return 1}}t.A_CopyInsertTableCol_Right=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CopyInsertTableRow_Bottom=void 0;const r=n(371);class i extends r.A_CopyInsertTableRow{ActName(){return"CopyInsertTableRow_Bottom"}get RelExcuteActName(){return"TextTableInsertRow_Bottom"}get InsertRowInxPre(){return 1}}t.A_CopyInsertTableRow_Bottom=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CopyInsertTableRow_Top=void 0;const r=n(371);class i extends r.A_CopyInsertTableRow{ActName(){return"CopyInsertTableRow_Top"}get RelExcuteActName(){return"TextTableInsertRow_Top"}}t.A_CopyInsertTableRow_Top=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CopyTextTable=void 0;n(65);const r=n(1);class i extends r.XBaseAction{ActName(){return"CopyTextTable"}Execute(e){this.resMsg.Clear();let t;return t=this.resMsg,t}}t.A_CopyTextTable=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_DeleteTextTable=void 0;const r=n(16),i=n(45),l=n(20),s=n(868),o=n(13),a=n(1);class u extends a.XBaseAction{ActName(){return"DeleteTextTable"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),a=n.M_EleEvtModel.EleClicked,u=l.XTextTableUtil.GetCursorCell(a);if(null==u)this.resMsg.MsgStr="光标所在对象不是单元格，无法删除表格",this.MessageError(),t=this.resMsg;else if(this.resMsg.MsgLevel<5)t=this.resMsg;else{try{let e=u.Parent.Parent instanceof i.XTextTable?u.Parent.Parent:null;if(!e.IsDeleteTable)return this.resMsg.MsgStr="当前表格不允许删除，无法删除表格",void this.MessageError();let l=r.XDomUtil.GetNextEle(!0,e),a=new o.UndoGroup,h=new s.TextTableDeleteRedoUndo(e,e.Parent.GetChildInx(e),e.Parent);if(a.AddItem(h),super._AddUndoItem(a),n.M_EleEvtModel.ClearSelRange(),e.Parent.RemoveChild(e),null!=l&&n.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.ReplaceEle(l),n.MRefreshDocView(),null==e)return t=this.resMsg,t}catch(e){this.resMsg.Ex=e}t=super.Execute(e)}return t}}t.A_DeleteTextTable=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTableDeleteRedoUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t,n){super(),this.Index=-1,this.Element=e,this.Index=t,this.Parent=n}IsValid(){return!0}CanUndo(){return!0}CanRedo(){return!0}Undo(){null!=this.Parent&&null!=this.Element&&this.Index>=0&&(this.Parent.AddChildEle(this.Index,this.Element),this.Element.NotifyLayoutChanged(!0,!1))}Redo(){null!=this.Parent&&null!=this.Element&&this.Index>=0&&this.Parent.RemoveChild(this.Element)}Clear(){}}t.TextTableDeleteRedoUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignBottomCenter=void 0;const r=n(64),i=n(11),l=n(81);class s extends l.A_SetTableAlign{ActName(){return"SetAlignBottomCenter"}Execute(e){return super.M_SetTableCellsAlign(i.ENumHAlignStyle.CENTER,r.XTextTableCellAlign.BOTTOM),this.resMsg}}t.A_SetAlignBottomCenter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignBottomLeft=void 0;const r=n(64),i=n(11),l=n(81);class s extends l.A_SetTableAlign{ActName(){return"SetAlignBottomLeft"}Execute(e){return super.M_SetTableCellsAlign(i.ENumHAlignStyle.LEFT,r.XTextTableCellAlign.BOTTOM),this.resMsg}}t.A_SetAlignBottomLeft=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignBottomRight=void 0;const r=n(64),i=n(11),l=n(81);class s extends l.A_SetTableAlign{ActName(){return"SetAlignBottomRight"}Execute(e){return super.M_SetTableCellsAlign(i.ENumHAlignStyle.RIGHT,r.XTextTableCellAlign.BOTTOM),this.resMsg}}t.A_SetAlignBottomRight=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignMiddleCenter=void 0;const r=n(64),i=n(11),l=n(81);class s extends l.A_SetTableAlign{ActName(){return"SetAlignMiddleCenter"}Execute(e){return super.M_SetTableCellsAlign(i.ENumHAlignStyle.CENTER,r.XTextTableCellAlign.MIDDLE),this.resMsg}}t.A_SetAlignMiddleCenter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignMiddleLeft=void 0;const r=n(64),i=n(11),l=n(81);class s extends l.A_SetTableAlign{ActName(){return"SetAlignMiddleLeft"}Execute(e){return super.M_SetTableCellsAlign(i.ENumHAlignStyle.LEFT,r.XTextTableCellAlign.MIDDLE),this.resMsg}}t.A_SetAlignMiddleLeft=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignMiddleRight=void 0;const r=n(64),i=n(11),l=n(81);class s extends l.A_SetTableAlign{ActName(){return"SetAlignMiddleRight"}Execute(e){return super.M_SetTableCellsAlign(i.ENumHAlignStyle.RIGHT,r.XTextTableCellAlign.MIDDLE),this.resMsg}}t.A_SetAlignMiddleRight=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignTopCenter=void 0;const r=n(64),i=n(11),l=n(81);class s extends l.A_SetTableAlign{ActName(){return"SetAlignTopCenter"}Execute(e){return super.M_SetTableCellsAlign(i.ENumHAlignStyle.CENTER,r.XTextTableCellAlign.TOP),this.resMsg}}t.A_SetAlignTopCenter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignTopLeft=void 0;const r=n(64),i=n(11),l=n(81);class s extends l.A_SetTableAlign{ActName(){return"SetAlignTopLeft"}Execute(e){return super.M_SetTableCellsAlign(i.ENumHAlignStyle.LEFT,r.XTextTableCellAlign.TOP),this.resMsg}}t.A_SetAlignTopLeft=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetAlignTopRight=void 0;const r=n(64),i=n(11),l=n(81);class s extends l.A_SetTableAlign{ActName(){return"SetAlignTopRight"}Execute(e){return super.M_SetTableCellsAlign(i.ENumHAlignStyle.RIGHT,r.XTextTableCellAlign.TOP),this.resMsg}}t.A_SetAlignTopRight=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableCellProperty=void 0;const r=n(2),i=n(0),l=n(20),s=n(107),o=n(1);class a extends o.XBaseAction{ActName(){return"TextTableCellProperty"}Execute(e){if(this.resMsg.Clear(),e.length<1)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",this.rn;let t=e[0];if(null==t||"{}"==JSON.stringify(t))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令参数0中的map为空",this.rn;let n=!0;if(e&&null!=e[1])this.xTextTableCell=e[1],n=!1;else{const e=super.GetEdtCtrl().M_EleEvtModel.EleClicked;this.xTextTableCell=l.XTextTableUtil.GetCursorCell(e)}if(null==this.xTextTableCell)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 未选中元素",this.rn;if(!(this.xTextTableCell instanceof i.XTextTableCell))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令选中的元素不是单元格",this.rn;const o=this.refresh_Combine(t);this.refreshStatus=r.ENumRefreshStatus.None,t.refreshStatus=this.refreshStatus;const a=l.XTextTableUtil.buildPropertiesInfo(this.xTextTableCell),u=s.InsertElementBack.getTableCellInfo(t,a);return this.refreshStatus=t.refreshStatus,this.refreshStatus==r.ENumRefreshStatus.None?(this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中无属性需更新",this.rn):(this.UpdateEle(a,u),null!=o&&o.CombineCells(),n&&this.refreshStatus>1&&super._RefreshPageAndMoveCaret(!0),this.rn)}get rn(){return o.XBaseAction.SetCurEle(null),this.resMsg.MsgStr&&this.resMsg.MsgLevel>=2&&super.MessageWarn(),this.resMsg.IsReturnMsg?this.resMsg:null}UpdateEle(e,t){for(const n in t){let t=e[n];const r=this.xTextTableCell[n];"No"!=n&&void 0!==t&&t!=r&&(this.xTextTableCell[n]=t)}}refresh_Combine(e){let t,n=e.colSpan,r=e.rowSpan;if(null!=n||null!=r){const i=this.xTextTableCell.Parent.Parent;if(null==i)return null;let l=!1;if(n=parseInt(n+""),n>0){const e=i.NumOfColumns;this.xTextTableCell.ColIndex+n<=e&&(l=!0,t=i)}let s=!1;if(r=parseInt(r+""),r>0){const e=i.NumOfRows;this.xTextTableCell.RowIndex+r<=e&&(s=!0,t=i)}l||(e.colSpan=void 0),s||(e.rowSpan=void 0)}return t}}t.A_TextTableCellProperty=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableCombineCell=void 0;const r=n(0),i=n(880),l=n(881),s=n(13),o=n(1);class a extends o.XBaseAction{ActName(){return"TextTableCombineCell"}Execute(e){this.resMsg.Clear();try{const e=super.GetEdtCtrl();if(null==e)return this.resMsg.MsgLevel=1,this.resMsg.MsgStr=this.ActName()+" 命令里,XDocEditableCanvas=null",this.resMsg;const t=e.M_EleEvtModel,n=t.SelRange,o=n.FromLineEle;if(null==o||!(o instanceof r.XTextTableCell))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr="光标所在对象不是单元格，无法合并",this.MessageError(),this.resMsg;if(!n.InfoUtil.IsInTableSelRange())return this.resMsg.MsgLevel=2,this.resMsg.MsgStr="没有跨单元格选中表格，无法合并",this.MessageError(),this.resMsg;let a,u=o,h=u.Parent.Parent,d=n.InfoUtil.GetTableCellsInRange(h),c=new s.UndoGroup,p=new i.CombineRedoUndoObj,f=new l.TextTableCombineRedoUndo(h,p);c.AddItem(f),h.Action_CombineCell_New2(d,c,p),super._AddUndoItem(c),a=d.Count()>0?d.Get(0).GetLastChildEle():u.GetLastChildEle(),t.EleClickedWrap.LineEleIxFocused.SetEle(a),t.ClearSelRange(),super._RefreshPageAndMoveCaret(!0)}catch(e){this.resMsg.Ex=e}return this.resMsg}}t.A_TextTableCombineCell=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombineRedoUndoObj=void 0;t.CombineRedoUndoObj=class{get MainCell(){return this._MainCell}set MainCell(e){this._MainCell=e}get Width(){return this._Width}set Width(e){this._Width=e}get Height(){return this._Height}set Height(e){this._Height=e}get WidthDisp(){return this._WidthDisp}set WidthDisp(e){this._WidthDisp=e}get HeightDisp(){return this._HeightDisp}set HeightDisp(e){this._HeightDisp=e}get RelateCells(){return this._RelateCells}set RelateCells(e){this._RelateCells=e}get BeforeRowSpan(){return this._BeforeRowSpan}set BeforeRowSpan(e){this._BeforeRowSpan=e}get BeforeColSpan(){return this._BeforeColSpan}set BeforeColSpan(e){this._BeforeColSpan=e}get AfterRowSpan(){return this._AfterRowSpan}set AfterRowSpan(e){this._AfterRowSpan=e}get AfterColSpan(){return this._AfterColSpan}set AfterColSpan(e){this._AfterColSpan=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTableCombineRedoUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t){super(),this.table=e,this.redoUndo=t}IsValid(){return!0}CanUndo(){return!0}CanRedo(){return!0}Undo(){if(null!=this.redoUndo&&null!=this.table){this.redoUndo.MainCell.RowSpan=this.redoUndo.BeforeRowSpan<2?0:this.redoUndo.BeforeRowSpan,this.redoUndo.MainCell.ColSpan=this.redoUndo.BeforeColSpan<2?0:this.redoUndo.BeforeColSpan,this.redoUndo.MainCell.NotifyLayoutChanged(!0,!1);for(let e=0;e<this.redoUndo.MainCell.RelatedMergeCell_Down.Length;e++){let t=this.redoUndo.MainCell.RelatedMergeCell_Down.Get(e);t.Visible=!0;for(let e=0;e<t.RelatedMergeCell_Right.Length;e++){t.RelatedMergeCell_Right.Get(e).Visible=!0,t.MainMergeCell=null,t.NotifyLayoutChanged(!0,!1)}t.RelatedMergeCell_Right.Clear()}this.redoUndo.MainCell.RelatedMergeCell_Down.Clear();for(let e=0;e<this.redoUndo.MainCell.RelatedMergeCell_Right.Length;e++){let t=this.redoUndo.MainCell.RelatedMergeCell_Right.Get(e);t.Visible=!0,t.MainMergeCell=null,t.NotifyLayoutChanged(!0,!1)}this.redoUndo.MainCell.RelatedMergeCell_Right.Clear(),this.redoUndo.MainCell.WidhtDisp=this.redoUndo.MainCell.Column.BoundsDISP.Width,this.redoUndo.MainCell.SetSizeDPI(this.redoUndo.MainCell.Column.Width,this.redoUndo.Height,300)}}Redo(){null!=this.redoUndo&&null!=this.table&&(this.redoUndo.MainCell.RowSpan=this.redoUndo.AfterRowSpan,this.redoUndo.MainCell.ColSpan=this.redoUndo.AfterColSpan,this.redoUndo.MainCell.NotifyLayoutChanged(!0,!1),this.table.CombineCells())}Clear(){}}t.TextTableCombineRedoUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableDeleteColumn=void 0;const r=n(0),i=n(45),l=n(20),s=n(310),o=n(13),a=n(1);class u extends a.XBaseAction{ActName(){return"TextTableDeleteColumn"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),a=n.M_EleEvtModel.EleClicked,u=l.XTextTableUtil.GetCursorCell(a);if(null==u)this.resMsg.MsgStr="光标所在对象不是单元格，无法删除行",this.MessageError(),t=this.resMsg;else if(this.resMsg.MsgLevel<5)t=this.resMsg;else{try{let e,l=u.Parent.Parent instanceof i.XTextTable?u.Parent.Parent:null,a=u instanceof r.XTextTableCell?u:null;if(null==l||null==a)return t=this.resMsg,t;if(n.M_EleEvtModel.ClearSelRange(),1==l.Columns.Count()){return t=n.M_GetActionByName("DeleteTextTable").Execute(null),t}e=0==a.ColIndex?l.GetNextCell(a,!0):l.GetPreCell(a,!0);let h=new o.UndoGroup,d=new s.TextTableDeleteColumnUndoRedo(l,a.ColIndex);if(l.Action_DeleteColumn(u),h.AddItem(d),super._AddUndoItem(h),null!=e&&n.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(e.GetLastChildEle()),super._RefreshPageAndMoveCaret(!0),n.M_EleEvtModel.ClearSelRange(),null==l)return t=this.resMsg,t}catch(e){this.resMsg.Ex=e}t=this.resMsg}return t}}t.A_TextTableDeleteColumn=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableDeleteRow=void 0;const r=n(0),i=n(45),l=n(20),s=n(163),o=n(13),a=n(1),u=n(6);class h extends a.XBaseAction{ActName(){return"TextTableDeleteRow"}Execute(e){this.resMsg.Clear();const t=super.GetEdtCtrl();let n,a;if(null!=e&&e[0]instanceof Object){const i=e[0],s=i.conceptId,o=i.rowIx;if(null!=t){const e=t.M_DocumentFocused;if(null!=e){const i=e.GetPagePanel(u.ENumPagePanelTp.Body);if(null!=i&&s&&o>-1){const e=l.XTextTableUtil.GetTextTableByCptID(s,i);if(null!=e&&"XTextTable"==e.EleTypeName){const i=r.XDomUtil.GetCellsByRowInx(e,o);if(null!=i&&null!=i[0]){const e=i[0],r=t.M_EleEvtModel,l=e._GetLastBaseEle();r.EleClickedWrap.LineEleIxFocused.ReplaceEle(l),r.SelRange.Clear(),n=e}}}}}}if(null==n){const e=t.M_EleEvtModel.EleClicked;n=l.XTextTableUtil.GetCursorCell(e)}if(null==n)this.resMsg.MsgStr="光标所在对象不是单元格，无法删除行",this.MessageError(),a=this.resMsg;else if(this.resMsg.MsgLevel<5)a=this.resMsg;else{try{t.M_EleEvtModel.ClearSelRange();let e,l=n.Parent.Parent instanceof i.XTextTable?n.Parent.Parent:null;if(!l.IsDeleteRow)return this.resMsg.MsgStr="光标所在表格不允许删除表格行，无法删除",void this.MessageError();if(e=n instanceof r.XTextTableCell&&n.RowIndex==l.Rows.Count()-1?l.GetUpCell(n,!0):l.GetDownCell(n instanceof r.XTextTableCell?n:null,!0),1==l.Rows.Count()){return a=t.M_GetActionByName("DeleteTextTable").Execute(null),a}let u=new s.TextTableDeleteRowRedoUndo(l,n.Parent);l.Action_DeleteRow(n);let h=new o.UndoGroup;if(h.AddItem(u),super._AddUndoItem(h),null!=e&&t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(e.GetLastChildEle()),super._RefreshPageAndMoveCaret(!0),null==l)return a=this.resMsg,a}catch(e){this.resMsg.Ex=e}a=this.resMsg}return a}}t.A_TextTableDeleteRow=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableInsertColumn_Left=void 0;const r=n(0),i=n(45),l=n(20),s=n(244),o=n(13),a=n(1);class u extends a.XBaseAction{ActName(){return"TextTableInsertColumn_Left"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),a=n.M_EleEvtModel.EleClicked,u=l.XTextTableUtil.GetCursorCell(a);if(null==u)this.resMsg.MsgStr="光标所在对象不是单元格，无法插入列",this.MessageError(),t=this.resMsg;else if(this.resMsg.MsgLevel<5)t=this.resMsg;else{try{let l=u.Parent.Parent instanceof i.XTextTable?u.Parent.Parent:null,a=new o.UndoGroup,h=u instanceof r.XTextTableCell?u:null;if(null==h)return this.resMsg.MsgStr="没有取得对象列",t=this.resMsg,t;let d=h.ColIndex,c=new s.TextTableInsertColumnRedoUndo(l),p=l.Action_InsertColumn_New(d,null);if(c.SaveInsertColumn(p,d),a.AddItem(c),super._AddUndoItem(a),e&&"CopyInsertTableCol_Left"==e[0]||n.MRefreshDocView(),null==l)return t=this.resMsg,t}catch(e){this.resMsg.Ex=e}t=this.resMsg}return t}}t.A_TextTableInsertColumn_Left=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableInsertColumn_Right=void 0;const r=n(20),i=n(244),l=n(13),s=n(1);class o extends s.XBaseAction{ActName(){return"TextTableInsertColumn_Right"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),s=n.M_EleEvtModel.EleClicked,o=r.XTextTableUtil.GetCursorCell(s);if(null==o)this.resMsg.MsgStr="光标所在对象不是单元格，无法插入列",this.MessageError(),t=this.resMsg;else if(this.resMsg.MsgLevel<5)t=this.resMsg;else{try{let t=o.Parent.Parent,r=new l.UndoGroup,s=o;if(null==s)return this.resMsg.MsgStr="没有取得对象列",this.MessageError(),this.resMsg;let a=s.ColIndex;a++;let u=new i.TextTableInsertColumnRedoUndo(t),h=t.Action_InsertColumn_New(a,null);if(u.SaveInsertColumn(h,a),r.AddItem(u),super._AddUndoItem(r),e&&"CopyInsertTableCol_Right"==e[0]||n.MRefreshDocView(),null==t)return this.resMsg}catch(e){this.resMsg.Ex=e}t=this.resMsg}return t}}t.A_TextTableInsertColumn_Right=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableInsertRow_Bottom=void 0;const r=n(0),i=n(63),l=n(45),s=n(20),o=n(184),a=n(13),u=n(1);class h extends u.XBaseAction{ActName(){return"TextTableInsertRow_Bottom"}Execute(e){this.resMsg.Clear();let t,n,u=super.GetEdtCtrl();if(e.length>0?(t=e[0]instanceof r.XTextTableCell?e[0]:null,null==t&&(t=s.XTextTableUtil.GetCursorCell(u.M_EleEvtModel.EleClicked))):t=s.XTextTableUtil.GetCursorCell(u.M_EleEvtModel.EleClicked),null==t)this.resMsg.MsgStr="光标所在对象不是单元格，无法插入行",this.MessageError(),n=this.resMsg;else if(this.resMsg.MsgLevel<5)n=this.resMsg;else{try{let r=t.Parent.Parent instanceof l.XTextTable?t.Parent.Parent:null;if(!r.IsInsertRow)return this.resMsg.MsgStr="当前表格不允许插入行",void this.MessageError();let s=r.Action_InsertRow(t,i.ORIENTATION.BOTTOM),h=new a.UndoGroup,d=new o.TextTableInsertRowRedoUndo(r,s);if(h.AddItem(d),super._AddUndoItem(h),e&&"CopyInsertTableRow_Bottom"==e[0]||u.MRefreshDocView(),null==r)return n=this.resMsg,n}catch(e){this.resMsg.Ex=e}n=this.resMsg}return n}}t.A_TextTableInsertRow_Bottom=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableInsertRow_Top=void 0;const r=n(63),i=n(20),l=n(184),s=n(13),o=n(1);class a extends o.XBaseAction{ActName(){return"TextTableInsertRow_Top"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),o=i.XTextTableUtil.GetCursorCell(n.M_EleEvtModel.EleClicked);if(null==o)this.resMsg.MsgStr="光标所在对象不是单元格，无法插入行",this.MessageError(),t=this.resMsg;else if(this.resMsg.MsgLevel<5)t=this.resMsg;else{try{let i=o.Parent.Parent;if(!i.IsInsertRow)return this.resMsg.MsgStr="当前表格不允许插入行",void this.MessageError();let a=i.Action_InsertRow(o,r.ORIENTATION.TOP),u=new s.UndoGroup,h=new l.TextTableInsertRowRedoUndo(i,a);if(u.AddItem(h),super._AddUndoItem(u),e&&"CopyInsertTableRow_Top"==e[0]||n.MRefreshDocView(),null==i)return t=this.resMsg,t}catch(e){this.resMsg.Ex=e}t=this.resMsg}return t}}t.A_TextTableInsertRow_Top=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableKeyBoard=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"TextTableKeyBoard"}constructor(){super(null)}Execute(e){let t;return t=2!=e.length?this.resMsg:super.Execute(e),t}}t.A_TextTableKeyBoard=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableProperty=void 0;const r=n(2),i=n(45),l=n(20),s=n(89),o=n(107),a=n(1);class u extends a.XBaseAction{ActName(){return"TextTableProperty"}Execute(e){if(this.resMsg.Clear(),e.length<1)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",this.rn;let t=e[0];if(null==t||"{}"==JSON.stringify(t))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令参数0中的map为空",this.rn;let n,a=!0;if(e&&null!=e[1])n=e[1],a=!1;else{const e=super.GetEdtCtrl().M_EleEvtModel.EleClicked;n=l.XTextTableUtil.GetCursorTextTable(e)}if(null==n)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 未选中元素",this.rn;if(!(n instanceof i.XTextTable))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令选中的元素不是表格",this.rn;this.refreshStatus=r.ENumRefreshStatus.None,t.refreshStatus=this.refreshStatus;const u=l.XTextTableUtil.buildPropertiesInfo(n),h=o.InsertElementBack.getTableInfo(t,u);return this.refreshStatus=t.refreshStatus,this.refreshStatus==r.ENumRefreshStatus.None?(this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中无属性需更新",this.rn):(this.UpdateEle(n,u,h),this.refreshStatus==r.ENumRefreshStatus.RegisterExp&&(s.MsgRegisterHandler.RegisterExpressionToMsgBus(n.Document),t.refreshStatus=r.ENumRefreshStatus.Descript),a&&this.refreshStatus>1&&super._RefreshPageAndMoveCaret(!0),this.rn)}get rn(){return a.XBaseAction.SetCurEle(null),this.resMsg.MsgStr&&this.resMsg.MsgLevel>=2&&super.MessageWarn(),this.resMsg.IsReturnMsg?this.resMsg:null}UpdateEle(e,t,n){for(const r in n){let n=t[r];const i=e[r];"No"!=r&&void 0!==n&&n!=i&&(e[r]=n)}}}t.A_TextTableProperty=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableResizeColumn=void 0;const r=n(20),i=n(10),l=n(891),s=n(13),o=n(1);class a extends o.XBaseAction{ActName(){return"TextTableResizeColumn"}Execute(e){let t;if(null==e||7!=e.length)t=this.resMsg;else{const n=e[0],o=e[1];let a=Number(e[2]),u=Number(e[3]);const h=Number(e[4]),d=Number(e[5]),c=!!e[6],p=new s.UndoGroup,f=new l.TextTableResizeColumnRedoUndo(n,o);if(this.SetUndo(f,n,o),null!=n&&n.Index==n.Parent.NumOfColumns-1){if(n.Width+a<h)return this.resMsg.MsgStr="列宽不允许小于0",t=this.resMsg,t;let e=r.XTextTableUtil.GetTableMaxWidth(n.Parent.Document.GetPageFmt(),300);n.Parent.Width+a>e&&(a=e-n.Parent.Width,u=i.DPITransUtil.TransIntVal(a,300,96)),n.Parent.SetSizeDPI(n.Parent.Width+a,-1e3,300)}c?this.FuncA(n,o,a,u,h,d):this.FuncB(n,o,a,u,h,d),this.SetRedo(f,n,o),p.AddItem(f),super._AddUndoItem(p),t=super.Execute(e)}return t}FuncA(e,t,n,r,i,l){n<0?t.Width-i<Math.abs(n)?(e.Width+=t.Width-i,e.SetSizeDISP(e.BoundsDISP.Width+(t.BoundsDISP.Width-l),-1e3),t.Width=i,t.SetSizeDISP(l,-1e3)):(e.Width+=Math.abs(n),e.SetSizeDISP(e.BoundsDISP.Width+Math.abs(r),-1e3),t.Width+=n,t.SetSizeDISP(t.BoundsDISP.Width+r,-1e3)):n>0&&(e.Width-i<n?(t.Width+=e.Width-i,t.SetSizeDISP(t.BoundsDISP.Width+(e.BoundsDISP.Width-l),-1e3),e.Width=i,e.SetSizeDISP(l,-1e3)):(e.Width-=n,e.SetSizeDISP(e.BoundsDISP.Width-r,-1e3),t.Width+=n,t.SetSizeDISP(t.BoundsDISP.Width+r,-1e3)))}FuncB(e,t,n,r,i,l){n<0?null!=e&&e.Width-i<Math.abs(n)?(null!=t&&(t.Width+=e.Width-i,t.SetSizeDISP(t.BoundsDISP.Width+(e.BoundsDISP.Width-l),-1e3)),e.Width=i,e.SetSizeDISP(l,-1e3)):(null!=e&&(e.Width-=Math.abs(n),e.SetSizeDISP(e.BoundsDISP.Width-Math.abs(r),-1e3)),null!=t&&(t.Width+=Math.abs(n),t.SetSizeDISP(t.BoundsDISP.Width+Math.abs(r),-1e3))):null!=t&&t.Width-i<n?(null!=e&&(e.Width+=t.Width-i,e.SetSizeDISP(e.BoundsDISP.Width+(t.BoundsDISP.Width-l),-1e3)),t.Width=i,t.SetSizeDISP(l,-1e3)):(null!=e&&(e.Width+=n,e.SetSizeDISP(e.BoundsDISP.Width+r,-1e3)),null!=t&&(t.Width-=n,t.SetSizeDISP(t.BoundsDISP.Width-r,-1e3)))}SetUndo(e,t,n){null!=t&&(e.SrcWidthDpi=t.Width,e.SrcWidthDisp=t.BoundsDISP.Width),null!=n&&(e.RelateWidthDpi=n.Width,e.RelateWidthDisp=n.BoundsDISP.Width)}SetRedo(e,t,n){null!=t&&(e.SrcNewWidthDpi=t.Width,e.SrcNewWidthDisp=t.BoundsDISP.Width),null!=n&&(e.RelateNewWidthDpi=n.Width,e.RelateNewWidthDisp=n.BoundsDISP.Width)}}t.A_TextTableResizeColumn=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTableResizeColumnRedoUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t){super(),this.srcColumn=e,this.relateColumn=t}get SrcWidthDpi(){return this._SrcWidthDpi}set SrcWidthDpi(e){this._SrcWidthDpi=e}get SrcWidthDisp(){return this._SrcWidthDisp}set SrcWidthDisp(e){this._SrcWidthDisp=e}get SrcNewWidthDpi(){return this._SrcNewWidthDpi}set SrcNewWidthDpi(e){this._SrcNewWidthDpi=e}get SrcNewWidthDisp(){return this._SrcNewWidthDisp}set SrcNewWidthDisp(e){this._SrcNewWidthDisp=e}get RelateWidthDpi(){return this._RelateWidthDpi}set RelateWidthDpi(e){this._RelateWidthDpi=e}get RelateWidthDisp(){return this._RelateWidthDisp}set RelateWidthDisp(e){this._RelateWidthDisp=e}get RelateNewWidthDpi(){return this._RelateNewWidthDpi}set RelateNewWidthDpi(e){this._RelateNewWidthDpi=e}get RelateNewWidthDisp(){return this._RelateNewWidthDisp}set RelateNewWidthDisp(e){this._RelateNewWidthDisp=e}IsValid(){return!0}CanUndo(){return!0}CanRedo(){return!0}Undo(){null!=this.srcColumn&&null!=this.relateColumn&&(this.srcColumn.Width=this.SrcWidthDpi,this.srcColumn.SetSizeDISP(this.SrcWidthDisp,-1e3),this.relateColumn.Width=this.RelateWidthDpi,this.relateColumn.SetSizeDISP(this.RelateWidthDisp,-1e3),this.RefreshTable(this.srcColumn.Parent))}Redo(){null!=this.srcColumn&&null!=this.relateColumn&&(this.srcColumn.Width=this.SrcNewWidthDpi,this.srcColumn.SetSizeDISP(this.SrcNewWidthDisp,-1e3),this.relateColumn.Width=this.RelateNewWidthDpi,this.relateColumn.SetSizeDISP(this.RelateNewWidthDisp,-1e3),this.RefreshTable(this.srcColumn.Parent))}Clear(){}RefreshTable(e){let t=e;if(null!=t){for(let e=0;e<t.Rows.Length;e++){let n=t.Rows.Get(e);for(let e=0;e<n.Cells.Length;e++)n.Cells.Get(e).Column=t.Columns.Get(e),n.Cells.Get(e).AutoSize=!1,n.Cells.Get(e).WidhtDisp=t.Columns.Get(n.Cells.Get(e).ColIndex).BoundsDISP.Width,n.Cells.Get(e).SetSizeDPI(n.Cells.Get(e).Column.Width,-1e3,300),n.Cells.Get(e).NotifyLayoutChanged(!0,!1)}t.CombineCells()}}}t.TextTableResizeColumnRedoUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColInfo=t.A_TextTableResizeColumns=void 0;const r=n(20),i=n(43),l=n(145),s=n(1);class o extends s.XBaseAction{ActName(){return"TextTableResizeColumns"}Execute(e){if(this.resMsg.Clear(),this.resMsg.ReturnParams=null,this.resMsg.IsReturnMsg=!0,null==e||!(e instanceof Array&&e.length>0))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令参数有误",this.resMsg;let t=!1,n=[];this.resMsg.MsgStr="";const i=super.GetEdtCtrl().All_Document;for(let s=0;s<e.length;s++){const o=e[s];this.formatParamVals(o);let a=!1,u=!1,h=[];for(var l=0;l<i.length;l++){const e=i[l],s=e.DocID;if(-1==n.indexOf(s)&&n.push(s),this.docId&&s!=this.docId)continue;if(a=!0,!this.eleId)continue;const o=e.GetPagePanel(1);if(null==o)continue;const d=this.getEleByeleId(this.eleId,o);if(d.Count()>0){u=!0;const e=d.ToArray();for(let n=0;n<e.length;n++){const i=e[n],l=r.XTextTableUtil.GetCursorTextTable(i);if(null==l)continue;const s=l.XID;if(!s||-1!=h.indexOf(s))continue;h.push(s);const o=l.Columns;if(null==o||o.Count()<1)continue;let a=100*l.Width;if(!(a>0))continue;const u=o.ToArray();let d=this.getColInfoByEleID(l,o.Count());const c=this.calcColWidth(l,d),p=c[0];if(!c[1])continue;let f=!1;for(let e=0;e<u.length;e++){const n=u[e],r=p[e];let i=Math.round(100*r.ColWidth);if(e+1>=u.length?i=a:a-=i,i/=100,n.Width!=i){const r=3.125;n.Width=i,n.SetSizeDISP(i/r,-1e3),t=!0,f=!0;const s=l.GetCellsByColInx(e);for(let e=0;e<s.length;e++){const t=s[e];t.WidhtDisp=n.BoundsDISP.Width,t.SetSizeDPI(n.Width,-1e3,300),t.AutoSize=!1,t.NotifyLayoutChanged(!0,!1)}}}f&&l.CombineCells()}}}a||(this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+s+"]中的docId="+this.docId+" 不存在病历文档Id["+n.join(",")+"]中。<br />"),u||(this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+s+"]中的innerEleID="+this.eleId+" 不存在。<br />"),h.length<1&&(this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+s+"]中的innerEleID="+this.eleId+" 不在表格里。<br />")}return t&&super.GetEdtCtrl().MRefreshDocView(),this.resMsg}formatParamVals(e){e[0];let t=e.docId;l.LangUtils.IsString(t)||(t=null),this.docId=t;let n=e.innerEleID;l.LangUtils.IsString(n)||(n=null),this.eleId=n;let r=e.columnArr;r instanceof Array||(r=[]),this.columnWidthArr=r}getColInfoByEleID(e,t){if(null==e)return null;let n=[];for(let i=0;i<this.columnWidthArr.length;i++){const l=this.columnWidthArr[i];if(null==l)continue;let s=0,o=!1,u=!1,h=0;if(l.fixWidth){const t=l.fixWidth+"";if(-1!=t.indexOf("%")){s=parseFloat(t)/100*e.Bounds.Width}else if(-1!=t.indexOf("font")){s=parseInt(t),o=!0}else s=parseFloat(t)}else{const e=l.surplusWidth+"";if(-1!=e.indexOf("%")){const t=parseFloat(e);if(t>100)continue;if(h+=t,h>100)continue;s=t,u=!0}}if(!(s>0))continue;let d=!1;const c=l.colEleID,p=this.getEleByeleId(c,e).ToArray();for(let e=0;e<p.length;e++){const i=p[e],l=r.XTextTableUtil.GetCursorCell(i);if(null==l)continue;const h=l.ColIndex;if(h>=0&&h<t){d=!0;let e=new a;e.ColIx=h,e.HasColEleID=d,e.ColWidth=s,e.IsFont=o,e.IsSurplus=u,n[h]=e}}if(!d&&!n[i]){let e=new a;e.ColIx=i,e.HasColEleID=d,e.ColWidth=s,e.IsFont=o,e.IsSurplus=u,n[i]=e}}return n}getMaxWidthByColIx(e,t,n){var r,l,s;if(null==e)return n;const o=e.GetCellsByColInx(t);let a=0,u=0,h=0,d=[];for(let e=0;e<o.length;e++){const t=o[e];if(null==t)continue;if(!t.Visible)continue;if(t.ColSpan>1)continue;const c=t.EleStyle.ElePadd.Top+t.EleStyle.ElePadd.Bottom,p=t.GetLinesArray();for(let e=0;e<p.length;e++){const t=p[e].ChildEleList;if(null==t)continue;const o=t.ToArray();for(let e=0;e<o.length;e++){const t=o[e];if(null==t)continue;const p=t.Bounds.Width;if(h<n)if("XCharacter"==t.EleTypeName){let e=i.GrapUtil.MeasureStrSize(null,null===(r=t.EleStyle)||void 0===r?void 0:r.Font,500,"国").Width;e*=3.125,a+=Math.max(p,e),h++}else if("XTextLabelElement"==t.EleTypeName){let e=i.GrapUtil.MeasureStrSize(null,null===(l=t.EleStyle)||void 0===l?void 0:l.Font,500,"国").Width;e*=3.125;const r=t.Text;if(!r)continue;const s=Math.min(r.length,n-h);a+=e*s,h+=s}else if("XParagraphFlag"==t.EleTypeName){const r=d[d.length-1];if(0==h&&0!=e&&r)d[d.length-1]=r+p;else{let e=i.GrapUtil.MeasureStrSize(null,null===(s=t.EleStyle)||void 0===s?void 0:s.Font,500,"国").Width;e*=3.125,a+=e*(n-h),a+=p,h=n}}else p>u&&(u=p);h>=n&&(a+=c,d.push(a),a=0,h=0)}}}return a=Math.max(u,...d),a}calcColWidth(e,t){let n=e.Width;if(!(n>0))return[null,!1];const r=e.Columns.ToArray();let i=[],l=[],s=[],o=0,u=[],h=0;for(let d=0;d<r.length;d++){let r=t[d];if(!r||r.IsSurplus){const i=this.getMaxWidthByColIx(e,d,1);null==r?(r=new a,t[d]=r,u.push(d)):(l.push(d),s.push(r.ColWidth/100),o+=i),r.ColWidth=i,n-=i}else if(r.IsFont){const t=this.getMaxWidthByColIx(e,d,r.ColWidth);r.ColWidth=t,i.push(d),h+=t}else{let t=r.ColWidth;const n=this.getMaxWidthByColIx(e,d,1);t<n&&(t=n),r.ColWidth=t,i.push(d),h+=t}}if(!(n>0))return[null,!1];if(h>n){const e=n/h;for(let r=0;r<i.length;r++){let l=t[i[r]];const s=l.ColWidth;if(r+1>=i.length){l.ColWidth=n;continue}const o=s*e;l.ColWidth=o,n-=o}}else{const r=n+o-h;let i=0;for(let e=0;e<l.length;e++){const n=l[e],o=s[e];let a=t[n];const u=a.ColWidth,h=r*o;h>=u?(a.ColWidth=h,i+=h):i+=u}if(u.length>0){let n=e.Width-i-h;const r=n/u.length;for(let e=0;e<u.length;e++){let i=t[u[e]];const l=i.ColWidth;e+1>=u.length?i.ColWidth=n:r>=l?(i.ColWidth=r,n-=r):n-=l}}}return[t,!0]}}t.A_TextTableResizeColumns=o;class a{constructor(){this._colIx=-1,this._colWidth=-1}get ColIx(){return this._colIx}set ColIx(e){this._colIx=e}get ColWidth(){return this._colWidth}set ColWidth(e){this._colWidth=e}get HasColEleID(){return this._hasColEleID}set HasColEleID(e){this._hasColEleID=e}get IsFont(){return this._isFont}set IsFont(e){this._isFont=e}get IsSurplus(){return this._isSurplus}set IsSurplus(e){this._isSurplus=e}}t.ColInfo=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableResizeRow=void 0;const r=n(45),i=n(20),l=n(374),s=n(13),o=n(1);class a extends o.XBaseAction{ActName(){return"TextTableResizeRow"}Execute(e){const t=e[0]instanceof r.XTextTable?e[0]:null;if(null==t)return super.Execute(e);const n=Number(e[2])||0;let i=Number(e[1]);if(i>=0){const e=t.Rows.Get(i);let r=new s.UndoGroup,o=new l.TextTableResizeRowReduUndo;o.SrcRow=e;for(let t=0;t<e.Cells.Length;t++){let r=e.Cells.Get(t);r.PreFixHeight_Disp=r.FixHeight_Disp,r.PreFixHeight=r.FixHeight,r.PreAutoSize=r.AutoSize;let i=r.HeightDisp+n;if(i<0){r.FixHeight_Disp=-1,r.FixHeight=-1e3;const e=r.GetRealHeight(!1);r.SetSizeDPI(-1e3,e,300)}else r.FixHeight_Disp=i,r.SetSizeDPI(-1e3,r.FixHeight_Disp,96),r.FixHeight=r.Height;r.AutoSize=!1,r.NotifyLayoutChanged(!0,!1),r.NewFixHeight_Disp=r.FixHeight_Disp,r.NewFixHeight=r.FixHeight,r.NewAutoSize=r.AutoSize,e.FixHeight=r.FixHeight}r.AddItem(o),super._AddUndoItem(r)}return super.Execute(e)}Execute2(e){this.resMsg.Clear();const t=super.GetEdtCtrl().M_EleEvtModel,n=t.SelRange;let r;if(null!=n&&n.IsValid())r=n.InfoUtil.GetLineElesInRange(!1,!1);else{const e=t.EleClicked;null!=e&&(r=[e])}if(null==r||r.length<1)return this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中没有选中任何元素",this.resMsg;const i=Number(e[0]);if(!(i>0))return this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中行高的值非大于0",this.resMsg;const o=this.getRowsArr(r);if(o.length<1)return this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中选中范围/元素里没有表格行",this.resMsg;let a=new s.UndoGroup;for(let e=0;e<o.length;e++){const t=o[e];let n=new l.TextTableResizeRowReduUndo;n.SrcRow=t;for(let e=0;e<t.Cells.Length;e++){let n=t.Cells.Get(e);n.PreFixHeight_Disp=n.FixHeight_Disp,n.PreFixHeight=n.FixHeight,n.PreAutoSize=n.AutoSize;let r=i;if(r<0){n.FixHeight_Disp=-1,n.FixHeight=-1e3;const e=n.GetRealHeight(!1);n.SetSizeDPI(-1e3,e,300)}else n.FixHeight_Disp=r,n.SetSizeDPI(-1e3,n.FixHeight_Disp,96),n.FixHeight=n.Height;n.AutoSize=!1,n.NotifyLayoutChanged(!0,!1),n.NewFixHeight_Disp=n.FixHeight_Disp,n.NewFixHeight=n.FixHeight,n.NewAutoSize=n.AutoSize,t.FixHeight=n.FixHeight}a.AddItem(n)}return super._AddUndoItem(a),super.GetEdtCtrl().MRefreshDocView(),this.resMsg}getRowsArr(e){let t=[],n=[];for(let r=0;r<e.length;r++){const l=e[r];if(null==l)continue;const s=i.XTextTableUtil.GetCursorCell(l);if(null==s)continue;const o=s.Parent;if(null==o)continue;const a=o.XID;-1==n.indexOf(a)&&(n.push(a),t.push(o))}return t}}t.A_TextTableResizeRow=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableRowProperty=void 0;const r=n(1),i=n(60),l=n(0),s=n(3),o=n(13),a=n(374),u=n(20);class h extends r.XBaseAction{ActName(){return"TextTableRowProperty"}Execute(e){this.resMsg.Clear();let t=e[0].height,n=super.GetEdtCtrl(),r=i.EmrApiUtil.HasSelection(n),l=new s.List;if(r){let e=super.GetEdtCtrl().M_EleEvtModel.SelRange.InfoUtil.GetLineElesInRange(!0,!0);if(null!=e&&e.length>0){let t=e;for(let e=0;e<t.length;e++){let n=t[e];if(null!=n){let e=n.Parent;null==e||l.Contains(e)||l.Add(e)}}}}for(let e of l){let n=e;this.resizeTableRow(n,t)}if(0==l.Length){let e=this.GetFocusCell();if(null==e)this.resMsg.MsgStr="没有选中单元格或者当前光标位置不是表格",super.MessageWarn();else{let n=e.Parent;this.resizeTableRow(n,t)}}return n.MRefreshDocView(),n.M_EleEvtModel.MoveCaretByCursorEle(!1),this.resMsg}resizeTableRow(e,t){let n=new o.UndoGroup,r=new a.TextTableResizeRowReduUndo;r.SrcRow=e;for(let n=0;n<e.Cells.Length;n++){let r=e.Cells.Get(n);r.PreFixHeight_Disp=r.FixHeight_Disp,r.PreFixHeight=r.FixHeight,r.PreAutoSize=r.AutoSize,r.FixHeight_Disp=t,r.SetSizeDPI(-1e3,r.FixHeight_Disp,96),r.FixHeight=r.Height,r.AutoSize=!1,r.NotifyLayoutChanged(!0,!1),r.NewFixHeight_Disp=r.FixHeight_Disp,r.NewFixHeight=r.FixHeight,r.NewAutoSize=r.AutoSize,e.FixHeight=r.FixHeight}n.AddItem(r),super._AddUndoItem(n)}GetFocusCell(){let e=super.GetEdtCtrl().M_EleEvtModel.EleClicked,t=u.XTextTableUtil.GetCursorCell(e);return t instanceof l.XTextTableCell?t:null}}t.A_TextTableRowProperty=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableShowCellCode=void 0;const r=n(6),i=n(3),l=n(1);class s extends l.XBaseAction{ActName(){return"TextTableShowCellCode"}Execute(e){let t=super.GetEdtCtrl().M_DocumentFocused,n=new i.List;t.GetPagePanel(r.ENumPagePanelTp.Body).GetChildrenByType("XTextTable",!0,n);let l=n.GetEnumerator();for(;l.MoveNext();){let e=l.Current;null!=e&&(e.IsShowCellCode=!e.IsShowCellCode)}return super.Execute(e)}}t.A_TextTableShowCellCode=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableUncombineCell=void 0;const r=n(20),i=n(897),l=n(13),s=n(1);class o extends s.XBaseAction{ActName(){return"TextTableUncombineCell"}Execute(e){let t,n=super.GetEdtCtrl().M_EleEvtModel.EleClicked,s=r.XTextTableUtil.GetCursorCell(n),o=null==s;if(o=o||0==s.RelatedMergeCell_Down.Count()&&0==s.RelatedMergeCell_Right.Count(),o)this.resMsg.MsgStr="光标所在对象不是合并单元格，无法解除合并",this.MessageError(),t=this.resMsg;else{for(let e=0;e<s.RelatedMergeCell_Down.Length;e++){let t=s.RelatedMergeCell_Down.Get(e);t.Visible=!0,t.MainMergeCell=null,t.NotifyLayoutChanged(!0,!1)}s.RelatedMergeCell_Down.Clear();for(let e=0;e<s.RelatedMergeCell_Right.Length;e++){let t=s.RelatedMergeCell_Right.Get(e);t.Visible=!0,t.MainMergeCell=null,t.NotifyLayoutChanged(!0,!1)}s.RelatedMergeCell_Right.Clear(),s.WidhtDisp=s.Column.BoundsDISP.Width,s.SetSizeDPI(s.Column.Width,-1e3,300),s.NotifyLayoutChanged(!0,!1);let e=new l.UndoGroup,n=new i.TextTableUnCombineRedoUndo(s,s.RowSpan,s.ColSpan);s.RowSpan=1,s.ColSpan=1,e.AddItem(n),super._AddUndoItem(e),t=super.Execute(),super._RefreshPageAndMoveCaret(!0)}return t}}t.A_TextTableUncombineCell=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTableUnCombineRedoUndo=void 0;const r=n(20),i=n(23);class l extends i.IXUndoable{constructor(e,t,n){super(),this.rowspan=1,this.colspan=1,this.srcCell=e,this.rowspan=t,this.colspan=n}IsValid(){return!0}CanUndo(){return!0}CanRedo(){return!0}Undo(){null!=this.srcCell&&(this.srcCell.RowSpan=this.rowspan,this.srcCell.ColSpan=this.colspan);let e=r.XTextTableUtil.GetTextTableByCell(this.srcCell);null!=e&&e.CombineCells()}Redo(){if(null!=this.srcCell){for(let e=0;e<this.srcCell.RelatedMergeCell_Down.Length;e++){let t=this.srcCell.RelatedMergeCell_Down.Get(e);t.Visible=!0,t.MainMergeCell=null,t.NotifyLayoutChanged(!0,!1)}this.srcCell.RelatedMergeCell_Down.Clear();for(let e=0;e<this.srcCell.RelatedMergeCell_Right.Length;e++){let t=this.srcCell.RelatedMergeCell_Right.Get(e);t.Visible=!0,t.MainMergeCell=null,t.NotifyLayoutChanged(!0,!1)}this.srcCell.RelatedMergeCell_Right.Clear(),this.srcCell.WidhtDisp=this.srcCell.Column.BoundsDISP.Width,this.srcCell.SetSizeDPI(this.srcCell.Column.Width,-1e3,300),this.srcCell.NotifyLayoutChanged(!0,!1),this.srcCell.RowSpan=1,this.srcCell.ColSpan=1}}Clear(){this.srcCell=null,this.rowspan=1,this.colspan=1}}t.TextTableUnCombineRedoUndo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableSplitCellByRow=void 0;const r=n(20),i=n(1),l=n(63),s=n(13),o=n(184);class a extends i.XBaseAction{ActName(){return"TextTableSplitCellByRow"}Execute(e){const t=super.GetEdtCtrl().M_EleEvtModel.EleClicked,n=r.XTextTableUtil.GetCursorCell(t);let i;if(null==n)this.resMsg.MsgStr="光标所在对象不是单元格，无法拆分",this.MessageError(),i=this.resMsg;else if(n.RelatedMergeCell_Down.Count()>0||n.RelatedMergeCell_Right.Count()>0)this.resMsg.MsgStr="光标所在对象是合并单元格，请先解除合并",this.MessageError(),i=this.resMsg;else{const e=n.Parent.Parent,t=e.Rows,i=n.RowIndex,a=t.Count();if(a>0&&i<a){let t=e.Action_InsertRow(n,l.ORIENTATION.BOTTOM);r.XTextTableUtil.newRowIntoPreRow(t,n);let i=new s.UndoGroup,a=new o.TextTableInsertRowRedoUndo(e,t,n);i.AddItem(a),super._AddUndoItem(i),super.GetEdtCtrl().MRefreshDocView()}}return i}}t.A_TextTableSplitCellByRow=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableSplitCellByCol=void 0;const r=n(20),i=n(1),l=n(13),s=n(244);class o extends i.XBaseAction{ActName(){return"TextTableSplitCellByCol"}Execute(e){const t=super.GetEdtCtrl().M_EleEvtModel.EleClicked,n=r.XTextTableUtil.GetCursorCell(t);let i;if(null==n)this.resMsg.MsgStr="光标所在对象不是单元格，无法拆分",this.MessageError(),i=this.resMsg;else if(n.RelatedMergeCell_Down.Count()>0||n.RelatedMergeCell_Right.Count()>0)this.resMsg.MsgStr="光标所在对象是合并单元格，请先解除合并",this.MessageError(),i=this.resMsg;else{const e=n.Parent.Parent,t=n.ColIndex;if(null!=e&&t>=0){const i=t+1;let o=new s.TextTableInsertColumnRedoUndo(e,n),a=e.Action_InsertColumn_New(i,null,!1);r.XTextTableUtil.newColIntoPreCol(n),o.SaveInsertColumn(a,i);let u=new l.UndoGroup;u.AddItem(o),super._AddUndoItem(u),super.GetEdtCtrl().MRefreshDocView()}}return i}}t.A_TextTableSplitCellByCol=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_HideEleCode=void 0;const r=n(375);class i extends r.A_BaseShowHideEleCode{ActName(){return"HideEleCode"}Execute(e){return super.Execute([!1])}}t.A_HideEleCode=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ShowEleCode=void 0;const r=n(375);class i extends r.A_BaseShowHideEleCode{ActName(){return"ShowEleCode"}Execute(e){return super.Execute([!0])}}t.A_ShowEleCode=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_NewDoc=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"FileNew"}Execute(e){this.resMsg.Clear();try{super.GetEdtCtrl().MCrtNewDocument()}catch(e){this.resMsg.Ex=e}return this.resMsg}}t.A_NewDoc=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_PrintCurPage=void 0;const r=n(245);class i extends r.BaseA_PrintDoc{ActName(){return"PrintCurPage"}Execute(e){let t,n=super.GetEdtCtrl().M_DocumentFocused;if(null==n)this.resMsg.MsgLevel=1,this.resMsg.MsgStr="没有焦点元素，不能定位当前文档页面！",t=this.resMsg;else{let e=n.GetDocCtxt().ViewMode;t=super.Execute([!1,e.IsCleanViewMode])}return t}}t.A_PrintCurPage=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocBodyWrap=void 0;const r=n(0),i=n(6);class l extends r.XDocPanel{constructor(){super(i.ENumPagePanelTp.Body)}FillFromXDocsWrap(e){if(this.lineList.Clear(),super.EleStyle.Clear(),this.SetSizeDPI(0,0,-1),null!=e){let t=e.GetXDocBodiesArr(),n=null==t?0:t.length;if(n>0){this.Document=e.FirstXDoc,super.EleStyle.CopyFrom(t[0].EleStyle,!1),super.CopyBoundsFrom(t[0]);for(let e=0;e<n;e++)t[e].AddToLinesList(this.lineList);let r=0;for(let e of this.lineList)e.Index=r++}}}UpdateBounds(e){this.Document=e.Document,super.CopyBoundsFrom(e)}}t.XDocBodyWrap=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageBorder=void 0;class r{GetDefault(){return null==r.Default_Border&&(r.Default_Border=new r),r.Default_Border}}t.PageBorder=r,r.Default_Border=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLinePos=void 0;const r=n(247);t.CLinePos=class{constructor(){this.pos01=null,this.pos02=null,this.pos01=new r.CLocation(0,0),this.pos02=new r.CLocation(0,0)}get Pos01(){return this.pos01}get Pos02(){return this.pos02}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseContainerPainter=void 0;const r=n(0),i=n(30),l=n(9),s=n(185),o=n(47),a=n(196);class u extends o.XBasePainter{PaintElement(e,t,n,r,i){}PaintChildLines(e,t,n,l,s){let o;if(e instanceof r.XBaseContainer&&(o=e),null!=o){if(o.LinesCnt>0){let e=i.DefineDPI.GetOutDPI(s),r=o.GetBoundsDPI(e);t.TranslateTransform(r.X,r.Y);let a=o.GetColumnsParam(),u=o.GetLinesIter();this._Paint_ChildLines_(r,a,u,t,n,l,s),t.TranslateTransform(-r.X,-r.Y)}}}_Paint_ChildLines_(e,t,n,r,o,u,h){if(null!=n){let d=i.DefineDPI.GetOutDPI(h),c=r.Clip,p=-1;for(;n.MoveNext();){let i=n.Current,c=i.GetBoundsDPI(d);c.X+=i.GetAlignLeft(d);let f=i.FirstElement;if(i.IsDocFirstLine&&f&&f.Document&&f.Document.DocStatusImage&&r.ShowStatusImg){let e=r.OriginX-5>50?50:r.OriginX-5;r.TranslateTransform(-e,c.Y);let t=new a.XImage,n=new Image;n.src=f.Document.DocStatusImage,t.ImageEle=n,r.DrawImage(t,new l.RectangleF(0,0,46,44)),r.TranslateTransform(e,-c.Y)}if(r.TranslateTransform(c.X,c.Y),i.ColInx>p){p=i.ColInx;let n=l.RectangleF.Empty;n.X-=2+i.GetAlignLeft(d),n.Width=4+t.GetColWidth(i.ColInx,d),n.Height=e.Height,r.ResetClip(),r.IntersectClip(n)}this.PaintOutlineFoldIcon(i,r,o,u,h);let g=i.GetElesIter();for(;g.MoveNext();){let e=g.Current;if(null!=e){let t=s.PainterFactory.CrtPainter(e.EleTypeName,null);null!=t&&t.Paint(e,r,o,u,h)}}r.TranslateTransform(-c.X,-c.Y)}r.Clip=c}}PaintOutlineFoldIcon(e,t,n,r,i){let l=null==e?null:e.LineAssist.RelOutLineFoldEle;if(null!=l&&l.IsVisible){let e=s.PainterFactory.CrtPainter(l.EleTypeName,null);null!=e&&e.Paint(l,t,n,r,i)}}}t.XBaseContainerPainter=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCharacterPainter=void 0;const r=n(37),i=n(26),l=n(2),s=n(0),o=n(10),a=n(11),u=n(43),h=n(30),d=n(51),c=n(47);class p extends c.XBasePainter{PaintElement(e,t,n,r,i){let l=s.XDomUtil.GetParentXInput(e);if(null!=l&&i==a.ENumOutTp.CsPrint&&!1===l.IsPrint)return;let o=h.DefineDPI.GetOutDPI(i),u=e.GetBoundsDPI(o);super._PaintBkgColor_(t,n,e,u,o),this._PaintChar_(t,n,e,u,o),this._PaintUnderline_(t,r,e,u,o),this._PaintStrikeout_(t,r,e,u,o)}_PaintChar_(e,t,n,a,h){let c=n.EleStyle,p=c.XFontStyle,f=c.Superscript,g=c.Subscript,m=p.BuildFont();if(null!=m){let p;if(f||g){if(m=new d.Font(m.Name,.62*m.SizeInPoints,m.Style),p=0,g){p=o.DPITransUtil.TransFloatVal(m.SizeInPoints,72,h)-a.Height}}else s.XCharacterEle.Fnt_Mtc.SetFont(m),p=s.XCharacterEle.Fnt_Mtc.GetInternalLeading();let E=n.GetInnerText(!0);t.Color=c.MutualExclusionColor?c.MutualExclusionColor:c.ForeColor;const C=n.Document,A=null!=C?C.GetDocCtxt().EmrWorkMode:null;null!=A&&A==l.ENumWorkMode.Browse&&(null!=n.Parent&&n.Parent.IsXInputBkgText?t.Color=r.TextDocApiConst.DefaultBackTextForeColor:c.isDefaultForeColor&&(t.Color=i.TextDocInitInfo.GetInstance().BrowerForeColor)),e.DrawString(E,m,t,a.X,a.Y-p,u.GrapUtil.GetDefaultStrFormat())}}}t.XCharacterPainter=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPageNumPainter=void 0;const r=n(173),i=n(43),l=n(11),s=n(30),o=n(73),a=n(4);class u extends r.XLabelPainter{PaintElement(e,t,n,r,i){super.PaintElement(e,t,n,r,i);let a=e,u=s.DefineDPI.GetOutDPI(i);i==l.ENumOutTp.UI_Show&&o.ResizeAnchorUtil.PaintEleAnchors(a,t,n,r,u)}CalcXOffsetAlign(e,t,n,r){let l;if(a.default.IsNullOrEmpty(n))l=0;else{let s=(r-i.GrapUtil.MeasureStrSize(e,t,1e3,n).Width)/2;s<0&&(s=0),l=s}return l}}t.XPageNumPainter=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XParagraphPainter=void 0;const r=n(11),i=n(30),l=n(51),s=n(47),o=n(911),a=n(4),u=n(7);class h extends s.XBasePainter{PaintElement(e,t,n,l,s){if(t.ShowXParagraphFlag&&s==r.ENumOutTp.UI_Show){let n=i.DefineDPI.GetOutDPI(s),r=e.GetBoundsDPI(n),o=r.X,a=r.Y+r.Height,h=[0,-3,2,-1,0,-3,2,-5,2,-1,2,-4,0,-3,5,-3,5,-3,6,-4,6,-4,6,-7],d=n/96;for(let e=0;e<h.length;e++)h[e]=h[e]*d;e.IsElement?l.Color=u.Color.ControlBlue:l.Color=u.Color.ControlDark;for(let e=0;e<h.length;e+=4)t.DrawLine(l,o+h[e],a+h[e+1],o+h[e+2],a+h[e+3],"XParagraphFlag");super._PaintTraceFlag_(e,t,l,r)}}_PaintDebugInfo(e,t,n){if(null!=e)if(null==e.RelOutline||e.RelOutline.IsDeleted())t.DrawString(a.default.Format("{0}, {1}",e.GrpID,e.EleStyle.XFontStyle.IsDefaultStyleValid()),new l.Font("Arial",10.5),o.Brushes.Red,n.X+10,n.Y);else{let r=e.RelOutline.ParentOutline,i=null==r?null:r.RelParaghEle,s=null==i?null:i.OwnerLine.LineAssist.GetFirstLineOfParagraph(),u=null==s?"[null]":s.InnerText.trim();t.DrawString(a.default.Format("大纲级别 = {0}, 父级 = {1}. {2}",e.OutLineLevel+1,u,e.GrpID),new l.Font("Arial",10.5),o.Brushes.Red,n.X+10,n.Y)}}}t.XParagraphPainter=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Brushes=void 0;t.Brushes=class{static get Red(){return null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XOutlineFoldPainter=void 0;n(0),n(11),n(30),n(56);const r=n(47);n(333);class i extends r.XBasePainter{PaintElement(e,t,n,r,i){}}t.XOutlineFoldPainter=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTablePainter=void 0;const r=n(26),i=n(0),l=n(63),s=n(10),o=n(11),a=n(30),u=n(7),h=n(67),d=n(17),c=n(9),p=n(185),f=n(47);class g extends f.XBasePainter{PaintElement(e,t,n,l,s){let d=e instanceof i.XBaseContainer?e:null,p=a.DefineDPI.GetOutDPI(s),f=d.GetBoundsDPI(p);if(null!=d&&d.LinesCnt>0&&f.Width>0&&f.Height>0){let e=d.GetLinesIter();for(;e.MoveNext();){let a=e.Current;if(null!=a){let e=a.GetBoundsDPI(p),h=a.GetElesIter();for(;h.MoveNext();){let i="XTextTableCell"==h.Current.EleTypeName?h.Current:null;if(null!=i&&i.Visible)if(i.Select&&s==o.ENumOutTp.UI_Show?n.Color=r.TextDocInitInfo.GetInstance().TextSelectBgColor:i.EleStyle.BackgroundColor?n.Color=i.EleStyle.BackgroundColor:!i.EleStyle.BackgroundColor&&d.EleStyle.BackgroundColor?n.Color=d.EleStyle.BackgroundColor:n.Color=u.Color.Transparent,s==o.ENumOutTp.CsPrint||s==o.ENumOutTp.UI_Print){let e=i.GetBoundsDPI(p),r=i.OwnerLine.GetBoundsDPI(p);t.FillRectangle(n,new c.RectangleF(e.X,r.Y+e.Y,e.Width,e.Height))}else{let r=i.GetBoundsDPI(p);if(i.RowSpan>1){e.Y+r.Height>f.Bottom?(e.Y,r.Height,f.Bottom):r.Height;t.FillRectangle(n,new c.RectangleF(i.BoundsDISP.X,e.Y,i.WidhtDisp,f.Bottom))}else t.FillRectangle(n,new c.RectangleF(i.BoundsDISP.X,e.Y,i.WidhtDisp,i.HeightDisp))}}let g=a.FirstElement&&a.FirstElement.Parent instanceof i.XTextTableRow?a.FirstElement.Parent:null;super._PaintTraceFlag_(g,t,l,e)}}let a=f.X,g=f.X+f.Width,m=f.Y,E=f.Y+f.Height;if(s==o.ENumOutTp.CsPrint||s==o.ENumOutTp.UI_Print){if(this.DrawBorder(t,d,l,s),!(d instanceof i.XTextTable&&r.TextDocInitInfo.GetInstance().UsingCellBorderSetting)){let e=new h.Pen(l.Color);e.DashStyle=d.EleStyle.DashStyle,e.Width=d.EleStyle.EleBdrWidth,d.EleStyle.BorderTop&&(e.Color=d.EleStyle.TopBorderLineColor?d.EleStyle.TopBorderLineColor:new u.Color("#000000"),t.DrawLine(e,a,m,g,m)),d.EleStyle.BorderBottom&&(e.Color=d.EleStyle.BottomBorderLineColor?d.EleStyle.BottomBorderLineColor:new u.Color("#000000"),t.DrawLine(e,a,E,g,E)),d.EleStyle.BorderLeft&&(e.Color=d.EleStyle.LeftBorderLineColor?d.EleStyle.LeftBorderLineColor:new u.Color("#000000"),t.DrawLine(e,a,m,a,E)),d.EleStyle.BorderRight&&(e.Color=d.EleStyle.RightBorderLineColor?d.EleStyle.RightBorderLineColor:new u.Color("#000000"),t.DrawLine(e,g,m,g,E))}}else{if("XTextTable"==d.EleTypeName&&(a=d.BoundsDISP.X,g=d.BoundsDISP.X+d.BoundsDISP.Width,m=d.BoundsDISP.Y,E=d.BoundsDISP.Y+d.BoundsDISP.Height),"XTextTable"==d.EleTypeName&&d.IsShowBorderHideLine){let e=new h.Pen(u.Color.FromRgba(211,211,211));e.DashStyle=d.EleStyle.DashStyle,e.Color=u.Color.FromRgba(211,211,211),t.DrawLine(e,a,m,g,m),t.DrawLine(e,a,E,g,E),t.DrawLine(e,a,m,a,E),t.DrawLine(e,g,m,g,E)}if(this.DrawBorder(t,d,l,s),"XTextTable"!=d.EleTypeName||!r.TextDocInitInfo.GetInstance().UsingCellBorderSetting){let e=new h.Pen(l.Color);e.DashStyle=d.EleStyle.DashStyle,e.Width=d.EleStyle.EleBdrWidth,d.EleStyle.BorderTop&&(e.Color=d.EleStyle.TopBorderLineColor?d.EleStyle.TopBorderLineColor:new u.Color("#000000"),t.DrawLine(e,a,m,g,m)),d.EleStyle.BorderBottom&&(e.Color=d.EleStyle.BottomBorderLineColor?d.EleStyle.BottomBorderLineColor:new u.Color("#000000"),t.DrawLine(e,a,E,g,E)),d.EleStyle.BorderLeft&&(e.Color=d.EleStyle.LeftBorderLineColor?d.EleStyle.LeftBorderLineColor:new u.Color("#000000"),t.DrawLine(e,a,m,a,E)),d.EleStyle.BorderRight&&(e.Color=d.EleStyle.RightBorderLineColor?d.EleStyle.RightBorderLineColor:new u.Color("#000000"),t.DrawLine(e,g,m,g,E))}}}}PaintChildLines(e,t,n,r,l){let o=e instanceof i.XBaseContainer?e:null;if(null!=o){if(o.LinesCnt>0){let e=o.Bounds.Clone();s.DPITransUtil.TransRectF(e,300,e,a.DefineDPI.GetOutDPI(l));let i=o.GetLinesIter();this.PaintChildLines2(e,i,t,n,r,l)}}}PaintChildLines2(e,t,n,r,i,l){if(null!=t){let e=a.DefineDPI.GetOutDPI(l);for(;t.MoveNext();){let o=t.Current,a=o.Bounds.Clone();s.DPITransUtil.TransRectF(a,300,a,e),n.TranslateTransform(a.X,a.Y);let u=o.GetElesIter();for(;u.MoveNext();){let e=u.Current;if(null!=e){let t=p.PainterFactory.CrtPainter(e.EleTypeName,null);null!=t&&t.Paint(e,n,r,i,l)}}n.TranslateTransform(-a.X,-a.Y)}}}DrawHideBorder(e,t,n){if(n!=o.ENumOutTp.CsPrint&&n!=o.ENumOutTp.UI_Print){let r=a.DefineDPI.GetOutDPI(n),i=t.GetBoundsDPI(r);const l=i.Right,s=i.Bottom;let o=t.GetLinesIter();for(;o.MoveNext();){let n=o.Current;if(null==n)continue;let i=n.GetBoundsDPI(r);for(let o=0;o<n.ChildEleList.Count();o++){const a=n.ChildEleList.Get(o);if(null!=a&&a.Visible){let c=a.GetBoundsDPI(r);if("XTextTable"==t.EleTypeName&&t.IsShowBorderHideLine){let t=new h.Pen(u.Color.FromRgba(211,211,211)),r=this.math_round_2_ceil(c.X);r>l&&(r=l);let p=this.math_round_2_ceil(i.Y+c.Y),f=this.math_round_2_ceil(c.X+c.Width);f>l&&(f=l),e.DrawLine(t,new d.PointF(r,p),new d.PointF(f,p));let g=this.math_round_2_ceil(c.X+c.Width),m=this.math_round_2_ceil(i.Y);m>s&&(m=s);let E=this.math_round_2_ceil(i.Y+c.Height);E>s&&(E=s),o+a.ColSpan<n.ChildEleList.Count()&&e.DrawLine(t,new d.PointF(g,m),new d.PointF(g,E))}}}}}}DrawBorder(e,t,n,s){if(null==t)return;this.DrawHideBorder(e,t,s);let o=a.DefineDPI.GetOutDPI(s),c=t.GetBoundsDPI(o);const p=c.Right,f=c.Bottom;let g=t.GetLinesIter(),m=-1;for(;g.MoveNext();){m++;const s=g.Current;if(null==s)continue;let a=s.GetBoundsDPI(o);for(let c=0;c<s.ChildEleList.Count();c++){const g=s.ChildEleList.Get(c),E="XTextTableCell"==g.EleTypeName?g:null;if(null!=E&&E.Visible){let g=E.GetBoundsDPI(o),C=new h.Pen(n.Color);if(t instanceof i.XTextTable&&r.TextDocInitInfo.GetInstance().UsingCellBorderSetting){let n=new d.PointF(g.X,a.Y),r=new d.PointF(g.X+g.Width,a.Y),i=new d.PointF(g.X,a.Y+g.Height),s=new d.PointF(g.X+g.Width,a.Y+g.Height);this.AllowDrawSplitLine(t,E,l.ORIENTATION.TOP)&&(C.Color=E.EleStyle.TopBorderLineColor?E.EleStyle.TopBorderLineColor:new u.Color("#000000"),e.DrawLine(C,n,r)),this.AllowDrawSplitLine(t,E,l.ORIENTATION.LEFT)&&(C.Color=E.EleStyle.BottomBorderLineColor?E.EleStyle.LeftBorderLineColor:new u.Color("#000000"),e.DrawLine(C,n,i)),this.AllowDrawSplitLine(t,E,l.ORIENTATION.BOTTOM)&&(C.Color=E.EleStyle.LeftBorderLineColor?E.EleStyle.BottomBorderLineColor:new u.Color("#000000"),e.DrawLine(C,i,s)),this.AllowDrawSplitLine(t,E,l.ORIENTATION.RIGHT)&&(C.Color=E.EleStyle.RightBorderLineColor?E.EleStyle.RightBorderLineColor:new u.Color("#000000"),e.DrawLine(C,r,s))}else{let n=this.math_round_2_ceil(g.X);n>p&&(n=p);let r=this.math_round_2_ceil(g.X+g.Width);r>p&&(r=p);const i=Math.round(100*a.Y)/100;let l=this.math_round_2_ceil(i);l>f&&(l=f);let o=this.math_round_2_ceil(i+g.Height);o>f&&(o=f);const h=E.EleStyle.EleTopBdrWidth,A=E.EleStyle.EleRightBdrWidth,y=E.EleStyle.TopDashStyle,I=E.EleStyle.RightDashStyle,S=E.EleStyle.TopApplytoText,_=E.EleStyle.RightApplytoText,w=S&&"表格"!=S?null:t.EleStyle.BorderHorizontalCenter,b=_&&"表格"!=_?null:t.EleStyle.BorderVerticalCenter,x=c+E.ColSpan<s.ChildEleList.Count(),P=0!=m;let v=null!=w?w:E.EleStyle.BorderTop;v=v&&(P||!t.EleStyle.BorderTop),v&&(C.Width=h||t.EleStyle.EleBdrWidth,C.DashStyle=y||t.EleStyle.DashStyle,C.Color=E.EleStyle.TopBorderLineColor?E.EleStyle.TopBorderLineColor:t.EleStyle.TopBorderLineColor?t.EleStyle.TopBorderLineColor:new u.Color("#000000"),e.DrawLine(C,new d.PointF(n,l),new d.PointF(r,l)));let T=null!=b?b:E.EleStyle.BorderRight;if(T=T&&(x||!t.EleStyle.BorderRight),T&&(C.Width=A||t.EleStyle.EleBdrWidth,C.DashStyle=I||t.EleStyle.DashStyle,C.Color=E.EleStyle.RightBorderLineColor?E.EleStyle.RightBorderLineColor:t.EleStyle.RightBorderLineColor?t.EleStyle.RightBorderLineColor:new u.Color("#000000"),e.DrawLine(C,new d.PointF(r,l),new d.PointF(r,o))),m+E.RowSpan==t.LinesCnt){(null!=w?w:E.EleStyle.BorderBottom)&&!t.EleStyle.BorderBottom&&(C.Width=h||t.EleStyle.EleBdrWidth,C.DashStyle=y||t.EleStyle.DashStyle,C.Color=E.EleStyle.BottomBorderLineColor?E.EleStyle.BottomBorderLineColor:t.EleStyle.BottomBorderLineColor?t.EleStyle.BottomBorderLineColor:new u.Color("#000000"),e.DrawLine(C,new d.PointF(n,o),new d.PointF(r,o)))}if(0==c){(null!=b?b:E.EleStyle.BorderLeft)&&!t.EleStyle.BorderLeft&&(C.Width=A||t.EleStyle.EleBdrWidth,C.DashStyle=I||t.EleStyle.DashStyle,C.Color=E.EleStyle.LeftBorderLineColor?E.EleStyle.LeftBorderLineColor:t.EleStyle.LeftBorderLineColor?t.EleStyle.LeftBorderLineColor:new u.Color("#000000"),e.DrawLine(C,new d.PointF(n,l),new d.PointF(n,o)))}E.Slashing&&(C.Width=h||A,C.DashStyle=y||I,C.Color=E.EleStyle.TopBorderLineColor?E.EleStyle.TopBorderLineColor:E.EleStyle.LeftBorderLineColor?E.EleStyle.LeftBorderLineColor:new u.Color("#000000"),e.DrawLine(C,new d.PointF(n,l),new d.PointF(r,o)))}}}}}math_round_2_ceil(e){return e=Math.round(100*e)/100,e=Math.ceil(e)}AllowDrawSplitLine(e,t,n){return this.AllowDrawSplitLine2(e,t,n)}AllowDrawSplitLine2(e,t,n){let r;switch(n){case l.ORIENTATION.TOP:r=t.EleStyle.BorderTop;break;case l.ORIENTATION.BOTTOM:if(t.EleStyle.BorderBottom){let n=e.GetDownCell(t,!1);if(null==n)r=t.EleStyle.BorderBottom;else{if(t.RowSpan>1&&t.RelatedMergeCell_Down.Count()>0)for(;!n.Visible;){if(n.MainMergeCell!=t){n=n.MainMergeCell;break}if(n=e.GetDownCell(n,!1),null==n)return r=t.EleStyle.BorderBottom,r}n.Visible||(n=n.MainMergeCell),r=null!=n?!n.EleStyle.BorderTop:t.EleStyle.BorderBottom}}else r=!1;break;case l.ORIENTATION.LEFT:r=t.EleStyle.BorderLeft;break;case l.ORIENTATION.RIGHT:if(t.EleStyle.BorderRight){let n=e.GetNextCell(t,!1);if(null==n)r=t.EleStyle.BorderRight;else{if(t.ColSpan>1&&t.RelatedMergeCell_Right.Count()>0)for(;!n.Visible;){if(n.MainMergeCell!=t){n=n.MainMergeCell;break}if(n=e.GetNextCell(n,!1),null==n)return r=t.EleStyle.BorderRight,r}n.Visible||(n=n.MainMergeCell),r=null!=n?!n.EleStyle.BorderLeft:t.EleStyle.BorderRight}}else r=!1;break;default:r=!0}return r}}t.XTextTablePainter=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableRowPainter=void 0;const r=n(0),i=n(10),l=n(30),s=n(185),o=n(47);class a extends o.XBasePainter{PaintElement(e,t,n,r,i){throw new Error("Method not implemented.")}PaintChildLines(e,t,n,s,o){let a=e instanceof r.XBaseContainer?e:null;if(null!=a){if(a.LinesCnt>0){let e=l.DefineDPI.GetOutDPI(o),r=a.Bounds;i.DPITransUtil.TransRectF(r,300,r,e);let u=a.GetLinesIter();this.PaintChildLines2(r,u,t,n,s,o)}}}PaintChildLines2(e,t,n,i,o,a){if(null!=t){l.DefineDPI.GetOutDPI(a);for(;t.MoveNext();){let e=t.Current.GetElesIter();for(;e.MoveNext();){let t=e.Current;if(t instanceof r.XTextTableCell&&t.Visible&&null!=t){let e=s.PainterFactory.CrtPainter(t.EleTypeName,null);null!=e&&e.Paint(t,n,i,o,a)}}}}}}t.XTextTableRowPainter=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableCellPainter=void 0;const r=n(37),i=n(30),l=n(51),s=n(17),o=n(53),a=n(47),u=n(185),h=n(321),d=n(4);class c extends a.XBasePainter{PaintElement(e,t,n,r,i){}PaintChildLines(e,t,n,a,u){let c=e;if(null!=c&&c.Visible){if(c.LinesCnt>0){let e=i.DefineDPI.GetOutDPI(u),p=c.GetBoundsDPI(e);t.IntersectClip(p);let f=c.GetLinesIter();if(t.TranslateTransform(p.X,0),null!=c.Parent&&c.Parent.Parent.IsShowCellCode){let e=new o.SolidBrush(r.TextDocApiConst.InputFieldBackTextForeColor),n=h.TextDocInnerUtil.ConvertFloatToCm(c.Width,300,2),i=h.TextDocInnerUtil.ConvertFloatToCm(c.Height,300,2),a=d.default.Join("",[c.Code,"(",n,",",i,")"]),u=(c.WidhtDisp-t.MeasureString(a,new l.Font("宋体",10)).Width)/2,p=(c.HeightDisp-t.MeasureString(a,new l.Font("宋体",10)).Height)/2+1;t.DrawString(c.Code+a,new l.Font("宋体",10),e,new s.PointF(u,p))}this.PaintChildLines2(p,f,t,n,a,u),t.TranslateTransform(-p.X,0),t.IntersectClip(null)}}}PaintChildLines2(e,t,n,r,l,s){if(null!=t){let e=i.DefineDPI.GetOutDPI(s);for(;t.MoveNext();){let i=t.Current,o=i.GetBoundsDPI(e);o.X+=i.GetAlignLeft(e),n.TranslateTransform(o.X,o.Y);let a=i.GetElesIter();for(;a.MoveNext();){let e=a.Current;if(null!=e){let t=u.PainterFactory.CrtPainter(e.EleTypeName,null);null!=t&&t.Paint(e,n,r,l,s)}}n.TranslateTransform(-o.X,-o.Y)}}}}t.XTextTableCellPainter=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XSpliteLinePainter=void 0;const r=n(11),i=n(30),l=n(7),s=n(125),o=n(67),a=n(17),u=n(53),h=n(73),d=n(47);class c extends d.XBasePainter{PaintElement(e,t,n,d,c){let p=e;if(null!=p){let e=i.DefineDPI.GetOutDPI(c),f=p.GetBoundsDPI(e),g=new u.SolidBrush(l.Color.White);t.FillRectangle(g,f);let m=p.EleStyle,E=new a.PointF(f.Left+f.Width/2,f.Top+f.Height/2),C=f.Width,A=new a.PointF(E.X-C/2,E.Y),y=new a.PointF(E.X+C/2,E.Y),I=new o.Pen(m.ForeColor,p.LineSize);if("DottedLine"==p.ShowLineStyle){let e=[p.DottedLineWidth,p.DottedLinePadding];I.DashStyle=s.DashStyle.DashDotDot,I.DashPattern=e}t.DrawLine(I,A,y),c==r.ENumOutTp.UI_Show&&p.GetForbidAnchors().length<8&&h.ResizeAnchorUtil.PaintEleAnchors(p,t,n,d,e)}}}t.XSpliteLinePainter=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XShapePainter=void 0;const r=n(11),i=n(30),l=n(7),s=n(51),o=n(103),a=n(9),u=n(118),h=n(53),d=n(90),c=n(56),p=n(73),f=n(47);class g extends f.XBasePainter{PaintElement(e,t,n,s,o){let a=e;if(null!=a){let u=e.EleStyle;if(null!=u){let d=i.DefineDPI.GetOutDPI(o),c=a.GetBoundsDPI(d),f=new h.SolidBrush(l.Color.White);t.FillRectangle(f,c),s.Color=u.ForeColor;let g=a.ShapeName;null!=g&&("CirCle"!=g&&"Ellipse"!=g||this.DrawCirCle(t,s,c),"CirRect"==g&&this.DrawCirRect(t,s,c,a.RectRoundAngle),"SqcRect"==g&&this.DrawSqcRect(t,s,c)),this.DrawText(t,a.ShowText,e,n,c),o==r.ENumOutTp.UI_Show&&p.ResizeAnchorUtil.PaintEleAnchors(a,t,n,s,d)}}}DrawText(e,t,n,r,i){let l=c.StringFormat.GenericTypographic;l.Alignment=d.StringAlignment.Center,l.LineAlignment=d.StringAlignment.Center;let a=n.EleStyle;r.Color=a.ForeColor;let u=a.Font.Style;a.XFontStyle.IsUnderline&&(u|=o.FontStyle.Underline),a.XFontStyle.IsStrikeout&&(u|=o.FontStyle.Strikeout);let h=new s.Font(a.Font.Name,a.Font.Size,u);e.DrawString(t,h,r,i,l)}DrawCirCle(e,t,n){e.SmoothingMode=u.SmoothingMode.HighQuality,e.DrawEllipse(t,n),e.SmoothingMode=u.SmoothingMode.Default}DrawCirRect(e,t,n,r){let i=new a.RectangleF(n.X,n.Y,n.Width,n.Height);e.DrawArcRect(t,i,r)}DrawSqcRect(e,t,n){e.SmoothingMode=u.SmoothingMode.HighQuality,e.DrawRectangle(t,n.X,n.Y,n.Width,n.Height),e.SmoothingMode=u.SmoothingMode.Default}}t.XShapePainter=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCheckBoxPainter=void 0;const r=n(11),i=n(30),l=n(7),s=n(53),o=n(0),a=n(47),u=n(378);class h extends a.XBasePainter{PaintElement(e,t,n,a,h){let d,c=t.Save();if(e instanceof o.XCheckBoxEle&&(d=e),(h!=r.ENumOutTp.CsPrint||!1!==d.IsPrint)&&null!=d){let e=i.DefineDPI.GetOutDPI(h);if(d.Grp_StrongShow){let n=d.GetBoundsDPI(e),r=new s.SolidBrush(l.Color.SpringGreen);t.FillRectangle(r,n)}u.XRadioBoxPainter.DrawBaseChoiceMark(d,t,e,n),t.Restore(c)}}}t.XCheckBoxPainter=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XFractionPainter=void 0;const r=n(37),i=n(30),l=n(17),s=n(9),o=n(47),a=n(56),u=n(10),h=n(125),d=n(118),c=n(0),p=n(172),f=n(4);class g extends o.XBasePainter{PaintElement(e,t,n,r,s){let o=t.Save(),h=e;if(null!=h&&h instanceof c.XFractionEle){let e=h.EleStyle,c=e.Font,p=h.FractionType,g=h.GetBoundsDPI(96),m=i.DefineDPI.GetOutDPI(s),E=this.GetNumeratorDrawRect(h,g,c),C=this.GetDenominatorDrawRect(h,E,c,g),A=l.PointF.Empty,y=l.PointF.Empty,I=this.BulidSpliteLine(p,g,A,y,E,C);A=I[0],y=I[1],u.DPITransUtil.TransRectF(E,96,E,m),u.DPITransUtil.TransRectF(C,96,C,m),u.DPITransUtil.TransPointF(A,96,l.PointF.Empty,m),u.DPITransUtil.TransPointF(y,96,l.PointF.Empty,m),r.Color=e.ForeColor,e.XFontStyle.IsBold&&(r.Width=2),t.SmoothingMode=d.SmoothingMode.HighQuality,t.DrawLine(r,A,y),f.default.IsNullOrEmpty(h.Numerator)?this.DrawDashBorder(t,r,E):(n.Color=e.ForeColor,t.DrawString(h.Numerator,c,n,E.X,E.Y,a.StringFormat.GenericTypographic)),f.default.IsNullOrEmpty(h.Denominator)?this.DrawDashBorder(t,r,C):(n.Color=e.ForeColor,t.DrawString(h.Denominator,c,n,C.X,C.Y,a.StringFormat.GenericTypographic)),t.Restore(o)}}DrawDashBorder(e,t,n){t.DashStyle=h.DashStyle.DashDotDot,t.DashPattern=[1,4],e.DrawRectangle(t,n.X,n.Y,n.Width,n.Height),t.DashStyle=h.DashStyle.Solid}GetNumeratorDrawRect(e,t,n){let i,l=e.FractionType;if(l==p.FractionType.Vert)i=new s.RectangleF(t.X+r.TextDocApiConst.FractionLeftRightEmptyWidth,t.Y+r.TextDocApiConst.FractionEleEmptyHeight/2,t.Width-2*r.TextDocApiConst.FractionLeftRightEmptyWidth,(t.Height-1)/2-r.TextDocApiConst.FractionEleEmptyHeight);else if(l==p.FractionType.Oblique){let l=(t.Width-2*r.TextDocApiConst.FractionLeftRightEmptyWidth-r.TextDocApiConst.FractionHert_LineWidth)/2;f.default.IsNullOrEmpty(e.Numerator)||(l=e.GetNumeratorWidth(n)),i=new s.RectangleF(t.X+r.TextDocApiConst.FractionLeftRightEmptyWidth,t.Y+r.TextDocApiConst.FractionEleEmptyHeight/2,l,(t.Height-2*r.TextDocApiConst.FractionEleEmptyHeight)/2)}else if(l==p.FractionType.Hert){let l=(t.Width-2*r.TextDocApiConst.FractionLeftRightEmptyWidth-r.TextDocApiConst.FractionHert_LineWidth)/2;f.default.IsNullOrEmpty(e.Numerator)||(l=e.GetNumeratorWidth(n)),i=new s.RectangleF(t.X+r.TextDocApiConst.FractionLeftRightEmptyWidth,t.Y+r.TextDocApiConst.FractionEleEmptyHeight/2,l,t.Height-r.TextDocApiConst.FractionEleEmptyHeight)}else i=s.RectangleF.Empty;return i}GetDenominatorDrawRect(e,t,n,i){let l,o=e.FractionType;if(o==p.FractionType.Vert)l=new s.RectangleF(t.X,t.Bottom+1+r.TextDocApiConst.FractionEleEmptyHeight,t.Width,t.Height);else if(o==p.FractionType.Oblique){let o=(i.Width-2*r.TextDocApiConst.FractionLeftRightEmptyWidth-r.TextDocApiConst.FractionHert_LineWidth)/2;f.default.IsNullOrEmpty(e.Numerator)||(o=e.GetDnominatorWidth(n)),l=new s.RectangleF(t.Right+r.TextDocApiConst.FractionHert_LineWidth,t.Bottom,o,t.Height)}else if(o==p.FractionType.Hert){let o=(i.Width-2*r.TextDocApiConst.FractionLeftRightEmptyWidth-r.TextDocApiConst.FractionHert_LineWidth)/2;f.default.IsNullOrEmpty(e.Numerator)||(o=e.GetDnominatorWidth(n)),l=new s.RectangleF(t.Right+r.TextDocApiConst.FractionHert_LineWidth,t.Top,o,t.Height)}else l=s.RectangleF.Empty;return l}BulidSpliteLine(e,t,n,i,s,o){return e==p.FractionType.Vert?(n=new l.PointF(t.X+r.TextDocApiConst.FractionLeftRightEmptyWidth,t.Y+(t.Height-1)/2),i=new l.PointF(t.Right-r.TextDocApiConst.FractionLeftRightEmptyWidth,n.Y)):e==p.FractionType.Oblique?(n=new l.PointF(s.Right+1,o.Bottom),i=new l.PointF(o.Left-1,s.Top)):e==p.FractionType.Hert&&(n=new l.PointF(s.Right+1,s.Bottom),i=new l.PointF(o.Left-1,o.Top)),[n,i]}}t.XFractionPainter=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XImagePainter=void 0;const r=n(0),i=n(11),l=n(47),s=n(30),o=n(7),a=n(36),u=n(56),h=n(90),d=n(73);class c extends l.XBasePainter{PaintElement(e,t,n,l,c){let p=e;if(null!=e&&p instanceof r.XImageEle){let r=n.Color,f=s.DefineDPI.GetOutDPI(c),g=p.GetBoundsDPI(f);if(this._PaintBkgColor_(t,n,e,g,f),null!=p.ImgObj)t.DrawImage(p.ImgObj,g,p);else{n.Color=o.Color.Red;let e="无图片";a.StringUtils.IsNullOrEmpty(p.AltText)||(e=p.AltText);let r=new u.StringFormat(null);r.LineAlignment=h.StringAlignment.Center,r.Alignment=h.StringAlignment.Center,t.DrawString(e,p.EleStyle.Font,n,g.X,g.Y,r)}c==i.ENumOutTp.UI_Show&&d.ResizeAnchorUtil.PaintEleAnchors(p,t,n,l,f),n.Color=r,this._PaintUnderline_(t,l,e,g,f)}}}t.XImagePainter=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XButtonPainter=void 0;const r=n(0),i=n(43),l=n(30),s=n(51),o=n(103),a=n(9),u=n(47),h=n(922);class d extends u.XBasePainter{PaintElement(e,t,n,r,i){let s=e;if(null!=s)if(null==s.Icon){if(null!=e.EleStyle){let r=l.DefineDPI.GetOutDPI(i),o=s.GetBoundsDPI(r),u=new a.RectangleF(o.X+1,o.Y+1,o.Width-2,o.Height-2);h.XEmrPainterUtil.DrawBorder(s.BorderStyle,t,s.BorderColor,s.BtnBackColor,u,4),this.DrawText(t,s,e,n,o)}}else{let e=l.DefineDPI.GetOutDPI(i),n=s.GetBoundsDPI(e);t.DrawImage(s.Icon,n)}}DrawText(e,t,n,l,a){const u=n.EleStyle;let h=t.Text;l.Color=u.ForeColor;let d=u.Font.Style;u.XFontStyle.IsUnderline&&(d|=o.FontStyle.Underline),u.XFontStyle.IsStrikeout&&(d|=o.FontStyle.Strikeout);let c=new s.Font(u.Font.Name,u.Font.Size,d),p=r.XButtonEle.Fnt_Mtc.GetInternalLeading(),f=t.BtnTextPadding.Left,g=t.BtnTextPadding.Top;e.DrawString(h,c,l,a.X+f,a.Y-p+g,i.GrapUtil.GetDefaultStrFormat())}}t.XButtonPainter=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XEmrPainterUtil=void 0;const r=n(51),i=n(103),l=n(67),s=n(53),o=n(90),a=n(56);class u{static DrawBorder(e,t,n,r,i,o=4){let a=new l.Pen(n),h=new s.SolidBrush(r);null!=e?("CirCle"!=e&&"Ellipse"!=e||u.DrawCirCle(t,a,h,i),"CirRect"==e&&u.DrawCirRect(t,a,h,i,o),"SqcRect"==e&&u.DrawSqcRect(t,a,h,i)):u.DrawCirCle(t,a,h,i)}static DrawText(e,t,n,l,s){let u=a.StringFormat.GenericTypographic;u.Alignment=o.StringAlignment.Center,u.LineAlignment=o.StringAlignment.Center,l.Color=n.ForeColor;let h=n.Font.Style;n.XFontStyle.IsUnderline&&(h|=i.FontStyle.Underline),n.XFontStyle.IsStrikeout&&(h|=i.FontStyle.Strikeout);new r.Font(n.Font.FontFamily.GetName(),n.Font.Size,h)}static DrawCirCle(e,t,n,r){e.DrawEllipse(t,r),e.FillEllipse(n,r)}static DrawCirRect(e,t,n,r,i){e.DrawArcRect(t,r,i),e.FillArcRect(n,r,i)}static DrawSqcRect(e,t,n,r){e.DrawRectangle(t,r),e.FillRectangle(n,r)}}t.XEmrPainterUtil=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XMedicalExpressionPainter=void 0;const r=n(25),i=n(0),l=n(53),s=n(67),o=n(11),a=n(30),u=n(131),h=n(104),d=n(51),c=n(9),p=n(37),f=n(229),g=n(17),m=n(35),E=n(118),C=n(8),A=n(171),y=n(47),I=n(73),S=n(379),_=n(56),w=n(90);class b extends y.XBasePainter{PaintElement(e,t,n,r,l){if(this._medicalExpression=e,null!=this._medicalExpression&&this._medicalExpression instanceof i.XMedicalExpressionField){this._areaHAlignStyle=u.StyleHAlignVals.GetEnumHAlign(this._medicalExpression.Area_HAlign),this._areaVAlignStyle=h.StyleVAlignVals.GetEnumVAlign(this._medicalExpression.Area_VAlign),this._outDpi=a.DefineDPI.GetOutDPI(l);let i=this._medicalExpression.GetBoundsDPI(this._outDpi);super._PaintBkgColor_(t,n,e,i,this._outDpi);let s=e.EleStyle.ForeColor,c=e.EleStyle.Font,p=this._medicalExpression.ExpressionInfo.MedicalValue;e.EleStyle.XFontStyle.IsUnderline&&(c=new d.Font(c.FontFamily.GetName(),c.Size,c.Style)),this.RenderExpression(t,this._medicalExpression.ExpressionStyle,i,p,c,s),l==o.ENumOutTp.UI_Show&&I.ResizeAnchorUtil.PaintEleAnchors(this._medicalExpression,t,n,r,this._outDpi);let f=super._GetPageView(e);if(null!=f){if(this._medicalExpression.IsDrawDashedRect){let e=this._medicalExpression.DashedBorderRect;f.DragDashRectF=e}super._PaintTraceFlag_(this._medicalExpression,t,r,i)}}}RenderExpression(e,t,n,r,i,l){if(this._areaVAlignStyle==o.ENumVAlignStyle.MIDDLE){let e=n.Height-p.TextDocApiConst.MarkPointHeight;n=new c.RectangleF(n.X,n.Y+p.TextDocApiConst.MarkPointHeight/2,n.Width,e)}if(this._areaHAlignStyle==o.ENumHAlignStyle.CENTER){let e=n.Width-p.TextDocApiConst.MarkPointWidth;n=new c.RectangleF(n.X+p.TextDocApiConst.MarkPointWidth/2,n.Y,e,n.Height)}switch(t){case"FourValues1":return void this.RenderMenses2(e,n,r,i,l);case"FourValues2":return void this.RenderMenses3(e,n,r,i,l);case"ThreeValues":return void this.RenderMenses4(e,n,r,i,l);case"Pupil":return void this.RenderPupil(e,n,r,i,l,n.Width,n.Height);case"FetalHeart":return void this.RenderFetalHeart(e,n,r,i,l,n.Width,n.Height);case"LightPositioning":return void this.RenderLightLocation(e,n,r,i,l,n.Width,n.Height);case"PainIndex":return void this.RenderRule(e,n,r,i,l,n.Width,n.Height);case"PermanentTeethBitmap":case"DeciduousTeech":return}this.RenderMenses1(e,n,r,i,l)}RenderMenses1(e,t,n,r,i){let o=e.Save(),a=f.MedExpressionFactory.GetInstance().GetMensesExpression(n);if(null!=a){const n=new s.Pen(i);if(a.IsEmpty()){const r=new g.PointF(t.Left+t.Width/2,t.Top+t.Height/2);e.DrawLine(n,new g.PointF(r.X-4,r.Y),new g.PointF(r.X+4,r.Y))}else{const s=r.Size;let u=m.CommDefines.MeasureText(a.FirstMenstruationAge,r,this._outDpi),h=m.CommDefines.MeasureText(a.MenstruationCycle,r,this._outDpi),d=m.CommDefines.MeasureText(a.Cycle,r,this._outDpi),p=m.CommDefines.MeasureText(a.EndMenstruationAge,r,this._outDpi);const f=a.Cycle.length<a.MenstruationCycle.length;let E=u.Width+(f?h.Width:d.Width)+p.Width;E+=s;const C=Math.max(h.Height+d.Height,u.Height)+.8*s,A=this.ScaleTransformX(E,t.Width),y=this.ScaleTransformX(C,t.Height),I=Math.floor(s*Math.min(A,y));this.CompareFloat(I,s,2)||(r.Size=I,u=m.CommDefines.MeasureText(a.FirstMenstruationAge,r,this._outDpi),h=m.CommDefines.MeasureText(a.MenstruationCycle,r,this._outDpi),d=m.CommDefines.MeasureText(a.Cycle,r,this._outDpi),p=m.CommDefines.MeasureText(a.EndMenstruationAge,r,this._outDpi),E=u.Width+(f?h.Width:d.Width)+p.Width,E+=I);const S=(t.Width-E)/2,_=t.Y+t.Height/2;let w=new l.SolidBrush(i);const b=this.GetCenterFormat(),x=this.GetTopCenterFormat(),P=this.GetBottomCenterFormat();let v=Math.max(h.Width,d.Width),T=new c.RectangleF(t.X+S,_-u.Height/2,u.Width,u.Height);e.DrawString(a.FirstMenstruationAge,r,w,T,b),T=new c.RectangleF(T.X+T.Width,_-h.Height-.4*I,h.Width,h.Height),e.DrawString(a.MenstruationCycle,r,w,T,P);const M=T.X,L=T.X+v;e.DrawLine(n,new g.PointF(M,_),new g.PointF(L,_)),T=new c.RectangleF(T.X,_+.4*I,d.Width,d.Height),e.DrawString(a.Cycle,r,w,T,x),T=new c.RectangleF(L,_-p.Height/2,p.Width,p.Height),e.DrawString(a.EndMenstruationAge,r,w,T,b),e.Restore(o),r.Size=s}}}RenderMenses2(e,t,n,r,i){let o=e.Save(),a=f.MedExpressionFactory.GetInstance().GetMensesExpression2(n);if(null!=a){const n=new s.Pen(i),u=new g.PointF(t.Left+t.Width/2,t.Top+t.Height/2);if(e.DrawLine(n,new g.PointF(t.Left+8,u.Y),new g.PointF(t.Right-8,u.Y)),e.DrawLine(n,new g.PointF(u.X,t.Top+8),new g.PointF(u.X,t.Bottom-8)),!a.IsEmpty()){const n=r.Size;let s=m.CommDefines.MeasureText(a.FirstMenstruationAge,r,this._outDpi),h=m.CommDefines.MeasureText(a.MenstruationCycle,r,this._outDpi),d=m.CommDefines.MeasureText(a.Cycle,r,this._outDpi),c=m.CommDefines.MeasureText(a.EndMenstruationAge,r,this._outDpi),p=Math.max(s.Width,h.Width,c.Width,d.Width),f=Math.max(s.Height,h.Height,c.Height,d.Height);const E=this.ScaleTransformX(2*p+n,t.Width),C=this.ScaleTransformX(2*f+n,t.Height),A=Math.floor(n*Math.min(E,C));this.CompareFloat(A,n,2)||(r.Size=A,s=m.CommDefines.MeasureText(a.FirstMenstruationAge,r,this._outDpi),h=m.CommDefines.MeasureText(a.MenstruationCycle,r,this._outDpi),d=m.CommDefines.MeasureText(a.Cycle,r,this._outDpi),c=m.CommDefines.MeasureText(a.EndMenstruationAge,r,this._outDpi),p=Math.max(s.Width,h.Width,c.Width,d.Width),f=Math.max(s.Height,h.Height,c.Height,d.Height));const y=new l.SolidBrush(i);let I=new g.PointF(u.X-A/2-p/2-s.Width/2,u.Y-A-f/2);e.DrawString(a.FirstMenstruationAge,r,y,I),I=new g.PointF(u.X-A/2-p/2-c.Width/2,u.Y+A/2),e.DrawString(a.EndMenstruationAge,r,y,I),I=new g.PointF(u.X+A/2+p/2-h.Width/2,u.Y-A-f/2),e.DrawString(a.MenstruationCycle,r,y,I),I=new g.PointF(u.X+A/2+p/2-d.Width/2,u.Y+A/2),e.DrawString(a.Cycle,r,y,I),e.Restore(o),r.Size=n}}}RenderMenses3(e,t,n,i,o){let a=e.Save(),u=f.MedExpressionFactory.GetInstance().GetMensesExpression3(n);if(null!=u){const n=new s.Pen(o),h=new g.PointF(t.Left+t.Width/2,t.Top+t.Height/2),d=8;if(e.SmoothingMode=E.SmoothingMode.HighQuality,e.DrawLine(n,new g.PointF(t.Left+d,t.Top+d),new g.PointF(t.Right-d,t.Bottom-d)),e.DrawLine(n,new g.PointF(t.Right-d,t.Top+d),new g.PointF(t.Left+d,t.Bottom-d)),!u.IsEmpty()){const n=i.Size;let s=m.CommDefines.MeasureText(u.FirstMenstruationAge,i,this._outDpi),c=m.CommDefines.MeasureText(u.MenstruationCycle,i,this._outDpi),p=m.CommDefines.MeasureText(u.EndMenstruationAge,i,this._outDpi),f=m.CommDefines.MeasureText(u.Cycle,i,this._outDpi);const E=u.FirstMenstruationAge.length<u.Cycle.length?f:s,C=u.MenstruationCycle.length<u.EndMenstruationAge.length?c:p,A=new r.SizeF(t.Width/2,t.Height/2),y=E.Width/E.Height;let I=A.Width/(A.Width/A.Height*.6+y+.1);const S=Math.min(C.Width/C.Height,t.Width-2*d-.2*C.Height);let _=A.Width/(A.Width/A.Height*1.1+S/2+.1);const w=n/E.Height*I,b=n/C.Height*_;let x=Math.min(w,b);x=Math.floor(Math.max(1,x)),this.CompareFloat(x,n,2)||(i.Size=x,s=m.CommDefines.MeasureText(u.FirstMenstruationAge,i,this._outDpi),c=m.CommDefines.MeasureText(u.MenstruationCycle,i,this._outDpi),p=m.CommDefines.MeasureText(u.EndMenstruationAge,i,this._outDpi),f=m.CommDefines.MeasureText(u.Cycle,i,this._outDpi));const P=new l.SolidBrush(o),v=4==Math.max(u.FirstMenstruationAge.length,u.EndMenstruationAge.length)?1.25:8;let T=t.Width/v<t.Height?h.X-d-A.Width/2-s.Width/2:t.X,M=new g.PointF(T,h.Y-s.Height/2);e.DrawString(u.FirstMenstruationAge,i,P,M),T=t.Width/v<t.Height?h.X+d+A.Width/2-f.Width/2:t.Right-f.Width,M=new g.PointF(T,h.Y-f.Height/2),e.DrawString(u.Cycle,i,P,M),M=new g.PointF(h.X-c.Width/2,h.Y-t.Height/4-c.Height/2),e.DrawString(u.MenstruationCycle,i,P,M),M=new g.PointF(h.X-p.Width/2,h.Y+d/2+t.Height/4-p.Height/2),e.DrawString(u.EndMenstruationAge,i,P,M),P.Dispose(),e.Restore(a),i.Size=n}}}RenderMenses4(e,t,n,r,i){let o=e.Save(),a=f.MedExpressionFactory.GetInstance().GetMensesExpression4(n);if(null!=a){const n=new s.Pen(i),u=new l.SolidBrush(i),h=new g.PointF(t.Left+t.Width/2,t.Top+t.Height/2);let d=m.CommDefines.MeasureText("/",r,this._outDpi);if(a.IsEmpty()){let t=new c.RectangleF(h.X-d.Width,h.Y-d.Height/2,d.Width,d.Height);e.DrawString("/",r,u,t),e.DrawLine(n,new g.PointF(h.X,h.Y),new g.PointF(h.X+8,h.Y))}else{const i=r.Size;let l=m.CommDefines.MeasureText(a.FirstMenstruationAge,r,this._outDpi),s=m.CommDefines.MeasureText(a.MenstruationCycle,r,this._outDpi),c=m.CommDefines.MeasureText(a.Cycle,r,this._outDpi),p=Math.max(s.Width,c.Width),f=l.Width+p+d.Width,E=Math.max(l.Height,s.Height,c.Height,d.Height);const C=this.ScaleTransformX(f+i,t.Width),A=this.ScaleTransformX(2*E+i,t.Height),y=Math.floor(i*Math.min(C,A));this.CompareFloat(y,i,2)||(r.Size=y,l=m.CommDefines.MeasureText(a.FirstMenstruationAge,r,this._outDpi),s=m.CommDefines.MeasureText(a.MenstruationCycle,r,this._outDpi),c=m.CommDefines.MeasureText(a.Cycle,r,this._outDpi),d=m.CommDefines.MeasureText("/",r,this._outDpi),p=Math.max(s.Width,c.Width),f=l.Width+p+d.Width,E=Math.max(l.Height,s.Height,c.Height,d.Height));const I=(t.Width-f-y)/2;let S=new g.PointF(t.X+I,h.Y-E/2);e.DrawString(a.FirstMenstruationAge,r,u,S),S=new g.PointF(S.X+l.Width+y/2,S.Y),e.DrawString("/",r,u,S),S=new g.PointF(S.X+d.Width+y/2,h.Y),e.DrawLine(n,S,new g.PointF(S.X+p,S.Y)),e.DrawString(a.MenstruationCycle,r,u,new g.PointF(S.X+p/2-s.Width/2,S.Y-s.Height-y/2)),e.DrawString(a.Cycle,r,u,new g.PointF(S.X+p/2-c.Width/2,S.Y+y/2)),e.Restore(o),r.Size=i}}}RenderPupil(e,t,n,i,s,o,a){let u=e.Save(),h=f.MedExpressionFactory.GetInstance().GetPupilPhotoInfo(n);if(null!=h&&!h.IsEmpty()){let n=m.CommDefines.MeasureText(h.PupilPhtotValueFirst,i,this._outDpi),d=m.CommDefines.MeasureText(h.PupilPhtotValueThird,i,this._outDpi),p=m.CommDefines.MeasureText(h.PupilPhtotValueSixth,i,this._outDpi),f=S.XMedicalExpressionUtil.GetMaxWidth([n,d,p]),E=m.CommDefines.MeasureText(h.PupilPhtotValueFourth,i,this._outDpi),C=m.CommDefines.MeasureText(h.PupilPhtotValueSecond,i,this._outDpi),A=m.CommDefines.MeasureText(h.PupilPhtotValueFifth,i,this._outDpi),y=m.CommDefines.MeasureText(h.PupilPhtotValueSeventh,i,this._outDpi),I=S.XMedicalExpressionUtil.GetMaxWidth([C,A,y]),_=f+E.Width+I,w=this.ScaleTransformX(_,o),b=this.GetMaxHeight([n,d,p,E,C,A,y]),x=this.ScaleTransformY(b,a/3),P=new l.SolidBrush(s),v=this.GetCenterFormat(),T=(o-_*w)/2;T<0&&(T=0);let M=(a-3*b*x)/2;M<0&&(M=0);let L=new g.PointF(t.Left,t.Top);L=new g.PointF(L.X/w+T,L.Y/x+M);let D=new r.SizeF(f,b),R=new c.RectangleF(L.X,L.Y,D.Width,D.Height);e.DrawString(h.PupilPhtotValueFirst,i,P,R,v),R.Offset(0,b),e.DrawString(h.PupilPhtotValueThird,i,P,R,v),R.Offset(0,b),e.DrawString(h.PupilPhtotValueSixth,i,P,R,v);let F=new r.SizeF(E.Width,b);R=new c.RectangleF(L.X+f,L.Y,F.Width,F.Height),R.Offset(0,b),e.DrawString(h.PupilPhtotValueFourth,i,P,R,v);let N=new r.SizeF(I,b);R=new c.RectangleF(L.X+f+E.Width,L.Y,N.Width,N.Height),e.DrawString(h.PupilPhtotValueSecond,i,P,R,v),R.Offset(0,b),e.DrawString(h.PupilPhtotValueFifth,i,P,R,v),R.Offset(0,b),e.DrawString(h.PupilPhtotValueSeventh,i,P,R,v),P.Dispose(),e.Restore(u)}}RenderFetalHeart(e,t,n,i,s,o,a){let u=e.Save(),h=f.MedExpressionFactory.GetInstance().GetFetalHeartInfo(n);if(null!=h&&!h.IsEmpty()){let n=m.CommDefines.MeasureText(h.PupilPhtotValueFirst,i,this._outDpi),d=m.CommDefines.MeasureText(h.PupilPhtotValueThird,i,this._outDpi),p=m.CommDefines.MeasureText(h.PupilPhtotValueFifth,i,this._outDpi),f=S.XMedicalExpressionUtil.GetMaxWidth([n,d,p]),E=m.CommDefines.MeasureText(h.PupilPhtotValueSecond,i,this._outDpi),C=m.CommDefines.MeasureText(h.PupilPhtotValueFourth,i,this._outDpi),A=m.CommDefines.MeasureText(h.PupilPhtotValueSixth,i,this._outDpi),y=S.XMedicalExpressionUtil.GetMaxWidth([E,C,A]),I=f+y,_=this.ScaleTransformX(I,o),w=this.GetMaxHeight([n,d,p,E,C,A]),b=this.ScaleTransformY(w,a/3),x=new l.SolidBrush(s),P=this.GetCenterFormat(),v=(o-I*_)/2;v<0&&(v=0);let T=(a-3*w*b)/2;T<0&&(T=0);let M=new g.PointF(t.Left,t.Top);M=new g.PointF(M.X/_+v,M.Y/b+T);let L=new r.SizeF(f,w),D=new c.RectangleF(M.X,M.Y,L.Width,L.Height);e.DrawString(h.PupilPhtotValueFirst,i,x,D,P),D.Offset(0,w),e.DrawString(h.PupilPhtotValueThird,i,x,D,P),D.Offset(0,w),e.DrawString(h.PupilPhtotValueFifth,i,x,D,P);let R=new r.SizeF(y,w);D=new c.RectangleF(M.X+f,M.Y,R.Width,R.Height),e.DrawString(h.PupilPhtotValueSecond,i,x,D,P),D.Offset(0,w),e.DrawString(h.PupilPhtotValueFourth,i,x,D,P),D.Offset(0,w),e.DrawString(h.PupilPhtotValueSixth,i,x,D,P),e.Restore(u)}}RenderLightLocation(e,t,n,i,s,o,a){let u=e.Save(),h=f.MedExpressionFactory.GetInstance().GetLightLocationInfo(n);if(null!=h&&!h.IsEmpty()){let n=m.CommDefines.MeasureText(h.PupilPhtotValueFirst,i,this._outDpi),d=m.CommDefines.MeasureText(h.PupilPhtotValueFourth,i,this._outDpi),p=m.CommDefines.MeasureText(h.PupilPhtotValueSeventh,i,this._outDpi),f=S.XMedicalExpressionUtil.GetMaxWidth([n,d,p]),E=m.CommDefines.MeasureText(h.PupilPhtotValueSecond,i,this._outDpi),C=m.CommDefines.MeasureText(h.PupilPhtotValueFifth,i,this._outDpi),A=m.CommDefines.MeasureText(h.PupilPhtotValueEighth,i,this._outDpi),y=S.XMedicalExpressionUtil.GetMaxWidth([E,C,A]),I=m.CommDefines.MeasureText(h.PupilPhtotValueThird,i,this._outDpi),_=m.CommDefines.MeasureText(h.PupilPhtotValueSixth,i,this._outDpi),w=m.CommDefines.MeasureText(h.PupilPhtotValueNinth,i,this._outDpi),b=S.XMedicalExpressionUtil.GetMaxWidth([I,_,w]),x=f+y+b,P=this.ScaleTransformX(x,o),v=this.GetMaxHeight([n,d,p,E,C,A,I,_,w]),T=this.ScaleTransformY(v,a/3),M=new l.SolidBrush(s),L=this.GetCenterFormat(),D=(o-x*P)/2;D<0&&(D=0);let R=(a-3*v*T)/2;R<0&&(R=0);let F=new g.PointF(t.Left,t.Top);F=new g.PointF(F.X/P+D,F.Y/T+R);let N=new r.SizeF(f,v),B=new c.RectangleF(F.X,F.Y,N.Width,N.Height);e.DrawString(h.PupilPhtotValueFirst,i,M,B,L),B.Offset(0,v),e.DrawString(h.PupilPhtotValueFourth,i,M,B,L),B.Offset(0,v),e.DrawString(h.PupilPhtotValueSeventh,i,M,B,L);let k=new r.SizeF(y,v);B=new c.RectangleF(F.X+f,F.Y,k.Width,k.Height),e.DrawString(h.PupilPhtotValueSecond,i,M,B,L),B.Offset(0,v),e.DrawString(h.PupilPhtotValueFifth,i,M,B,L),B.Offset(0,v),e.DrawString(h.PupilPhtotValueEighth,i,M,B,L);let O=new r.SizeF(b,v);B=new c.RectangleF(F.X+f+y,F.Y,O.Width,O.Height),e.DrawString(h.PupilPhtotValueThird,i,M,B,L),B.Offset(0,v),e.DrawString(h.PupilPhtotValueSixth,i,M,B,L),B.Offset(0,v),e.DrawString(h.PupilPhtotValueNinth,i,M,B,L),e.Restore(u)}}RenderRule(e,t,n,r,i,a,u){let h=this._medicalExpression.MedExpSettingInfo;null==h&&(h=new A.RulerInfo("Default"));let d=Math.ceil((h.MaxScale-h.MinScale)/h.ScaleSpace),c=e.Save(),p=48*d,f=p+0,y=this.ScaleTransformX(f,a),I=this.GetRuleDrawHeight(h,r),S=this.ScaleTransformY(I,u),_=new l.SolidBrush(i),w=(a-f*y)/2;w<0&&(w=0),this._areaHAlignStyle==o.ENumHAlignStyle.LEFT?w=0:this._areaHAlignStyle==o.ENumHAlignStyle.RIGHT&&(w*=2);let b=(u-I*S)/2;b<0&&(b=0),this._areaVAlignStyle==o.ENumVAlignStyle.TOP?b=0:this._areaVAlignStyle==o.ENumVAlignStyle.BOTTOM&&(b*=2);let x=new g.PointF(t.Left,t.Top);x=new g.PointF(x.X/y+w+0*y,x.Y/S+b);let P=new s.Pen(i),v=new g.PointF(x.X,x.Y+this.GetRuleRealHeight(h)*S),T=new g.PointF(x.X+p,v.Y);if(e.DrawLine(P,v,T),"Default"===h.ShowStyle)v=new g.PointF(x.X,x.Y+this.GetRuleRealHeight(h)*S),T=new g.PointF(x.X+p,v.Y),e.DrawLine(P,v,T);else{v=new g.PointF(x.X,x.Y),T=new g.PointF(x.X+p,v.Y),e.DrawLine(P,v,T);let t=new g.PointF(x.X,x.Y+this.GetRuleRealHeight(h)*S),n=new g.PointF(x.X+p,t.Y);e.DrawLine(P,t,n)}let M=p/(10*d),L=v.X,D=v.Y,R=-1;n||(R=C.CNumUtil.TryParseFloat(n,R));let F=h.MinScale;for(let t=0;t<10*d+1;t++){let n,i=new g.PointF(L,D);if(n=t%10==0?new g.PointF(i.X,D-12*S):t%5==0?new g.PointF(i.X,D-8*S):new g.PointF(i.X,D-6*S),"Default"===h.ShowStyle&&e.DrawLine(P,i,n),t%10==0)if(n=new g.PointF(i.X,i.Y+this.GetRuleRealHeight(h)*S),e.DrawLine(P,i,n),t%(10*h.ScaleShowSpace)!=0)F+=h.ScaleSpace,L+=M;else{let i="";t/10==d&&(i+=h.MaxScalePreText),i+=h.GetScaleFormatStr()+F,0==t&&h.IsShowFirstRowUnit,i+=h.ScaleUnit;let l=m.CommDefines.MeasureText(i,r,this._outDpi),s=n.X-l.Width/2*y,o=n.Y;e.DrawString(i,r,_,s,o),F+=h.ScaleSpace,L+=M}else L+=M}if(R>=h.MinScale&&R<=h.MaxScale){let t=(R- -h.MinScale)/(h.MaxScale-h.MinScale)*p+v.X,n=new g.PointF(t,v.Y),r=new g.PointF(n.X-8*y,n.Y+12),i=[r,n,new g.PointF(n.X+8*y,r.Y)];e.SmoothingMode=E.SmoothingMode.HighQuality,e.FillPolygon(_,i),e.SmoothingMode=E.SmoothingMode.Default}_.Dispose(),P.Dispose(),e.Restore(c)}GetRuleDrawHeight(e,t){return 24+m.CommDefines.MeasureText("0",t,this._outDpi).Height}GetRuleRealHeight(e){let t=0,n=e.ShowStyle;return null!=n&&("Default"!=n?"Rectangle"==n&&(t=20):t=12),t}GetMaxHeight(e){let t=0;for(let n=0;n<e.length;n++){let r=e[n];t<r.Height&&(t=r.Height)}return t}ScaleTransformX(e,t){let n;if(e!=t){let r=t/e;n=this.CompareFloat(r,0,2)?1:r}else n=1;return n}ScaleTransformY(e,t){let n;if(e!=t){n=t/e}else n=1;return n}GetCenterFormat(){let e=new _.StringFormat(null);return e.Alignment=w.StringAlignment.Center,e.LineAlignment=w.StringAlignment.Center,new _.StringFormat(e)}GetBottomCenterFormat(){let e=new _.StringFormat(null);return e.Alignment=w.StringAlignment.Center,e.LineAlignment=w.StringAlignment.Far,new _.StringFormat(e)}GetBottomRightFormat(){let e=new _.StringFormat(null);return e.Alignment=w.StringAlignment.Far,e.LineAlignment=w.StringAlignment.Far,new _.StringFormat(e)}GetTopRightFormat(){let e=new _.StringFormat(null);return e.Alignment=w.StringAlignment.Far,e.LineAlignment=w.StringAlignment.Near,new _.StringFormat(e)}GetBottomLeftFormat(){let e=new _.StringFormat(null);return e.Alignment=w.StringAlignment.Near,e.LineAlignment=w.StringAlignment.Far,new _.StringFormat(e)}GetTopLeftFormat(){let e=new _.StringFormat(null);return e.Alignment=w.StringAlignment.Near,e.LineAlignment=w.StringAlignment.Near,new _.StringFormat(e)}GetTopCenterFormat(){let e=new _.StringFormat(null);return e.Alignment=w.StringAlignment.Center,e.LineAlignment=w.StringAlignment.Near,new _.StringFormat(e)}CompareFloat(e,t,n){let r=Math.pow(10,n);return e*r==t*r}}t.XMedicalExpressionPainter=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextLabelPainter=void 0;const r=n(173),i=n(11);class l extends r.XLabelPainter{PaintElement(e,t,n,r,l){let s=e;l==i.ENumOutTp.CsPrint&&!1===s.IsPrintFlag||null!=s&&super.PaintElement(e,t,n,r,l)}}t.XTextLabelPainter=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPageViewPainterAssist=void 0;const r=n(17),i=n(43),l=n(83),s=n(9),o=n(56),a=n(2),u=n(4),h=n(25);class d{static PaintWaterMark(e,t,n,r,i,l,s){if(null!=e){switch(i.X+=l.Left,i.Width-=l.Left+l.Right,e.MarkType){case a.ENumWarterMarkTp.Text:d._Paint_TextWaterMark(e,t,n,i,s);break;case a.ENumWarterMarkTp.Image:d._Paint_ImgWaterMark(e,t,i,s)}i.X-=l.Left,i.Width+=l.Left+l.Right}}static _Paint_ImgWaterMark(e,t,n,r){if(e.MarkType==a.ENumWarterMarkTp.Image){let i=e.ImgObj;if(null!=i){let o=s.RectangleF.Empty;o.Width=i.Width*(i.HorizontalResolution<=0?1:r/i.HorizontalResolution),o.Height=i.Height*(i.VerticalResolution<=0?1:r/i.VerticalResolution);let a=e.ImgZmRatio;a<=0&&(a=l.XImageUtil.CalcImgZmRatio(o.Width,o.Height,n.Width,n.Height)),o.Width=a*i.Width,o.Height=a*i.Height,o.X=n.X+(n.Width-o.Width)/2,o.Y=n.Y+(n.Height-o.Height)/2;e.ImgEroded;let u=new s.RectangleF(0,0,i.Width,i.Height);t.DrawImage(e.ImgObj,u)}}}static _Paint_TextWaterMark(e,t,n,l,s){if(e.MarkType==a.ENumWarterMarkTp.Text){let s=e.TextAngle,a=e.Font,d=e.Text;if(null!=a&&!u.default.IsNullOrEmpty(d)){let u;i.GrapUtil.RoateGraphics(t,s,l,!1);let c=[],p="",f=0;if(e.Width){u=new h.SizeF(Number(e.Width),Number(e.Height));let n=0;for(let r=0;r<d.length;r++){let l=d[r],s=i.GrapUtil.MeasureStrSize(t,a,5e3,l);if(n+=s.Width,s.Width>u.Width){u=i.GrapUtil.MeasureStrSize(t,a,5e3,d),c=[],p="";break}0==r&&(f+=s.Height),n>Number(e.Width)?(n=0,r--,f+=s.Height,c.push(p),p=""):p+=l}p&&c.push(p)}else u=i.GrapUtil.MeasureStrSize(t,a,5e3,d);if(u.Height=!isNaN(Number(u.Height))&&u.Height>f+Number(e.WatermarkSpacing)?u.Height:f+Number(e.WatermarkSpacing),n.Color=e.ForeColor,e.IsTile){let s=l.Width,h=l.Height,p=Math.max(s,h),g=Math.min(s,h),m=(p+g)/u.Width,E=(p+g)/u.Height,C=new r.PointF(l.X-u.Width-(p-g)/2,l.Y-u.Height-(p-g)/2);for(let r=0;r<m;r++){C.Y=l.Y-u.Height;for(let e=0;e<E;e++){if(c.length>0)for(let e=0;e<c.length;e++){let r=c[e],l=i.GrapUtil.MeasureStrSize(t,a,5e3,d).Height;C.Y+=l,t.DrawString(r,a,n,C,o.StringFormat.GenericTypographic)}else t.DrawString(d,a,n,C,o.StringFormat.GenericTypographic);C.Y+=u.Height-f}C.X+=u.Width+Number(e.WatermarkSpacing)}}else{let e=new r.PointF(l.X,l.Y);if(l.Width>u.Width&&(e.X+=(l.Width-u.Width)/2),l.Height>u.Height&&(e.Y+=(l.Height-u.Height)/2),c.length>0)for(let r=0;r<c.length;r++){let l=c[r],s=i.GrapUtil.MeasureStrSize(t,a,5e3,d).Height;e.Y+=s,t.DrawString(l,a,n,e,o.StringFormat.GenericTypographic)}else t.DrawString(d,a,n,e,o.StringFormat.GenericTypographic)}i.GrapUtil.RoateGraphics(t,s,l,!0)}}}}t.XPageViewPainterAssist=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommentOpration=t.XCommentAreaComp=void 0,n(927);const r=n(22),i=n(12),l=n(24),s=n(0),o=n(248),a=n(39),u=n(237);class h extends i.PureComponent{constructor(e,t){super(e),this.handleClickOutside=e=>{if(!(this&&this.toggleContainer&&this.toggleContainer.current))return;this.toggleContainer.current.contains(e.target)||this.state.cmmtList.length>0&&this.state.cmmtList.forEach((e,t)=>{e.Active=!1})},this.state={top:e.top,left:e.left,height:e.height,width:e.width,cmmtList:e.cmmtList,PageIndex:e.PageIndex},this.toggleContainer=i.createRef()}GetValidateHeight(){}upDateCommentList(e){this.setState({cmmtList:e})}componentDidMount(){this.props.parent.React=this,setTimeout(()=>{document.addEventListener("mousedown",this.handleClickOutside),this.toggleContainer.current.addEventListener("keydown",e=>{e.stopPropagation()})})}componentDidUpdate(){let e=this.toggleContainer.current.children;for(let t=0;t<this.state.cmmtList.length;t++){this.state.cmmtList[t].DomHeight=e[t].clientHeight}}inputChage(e,t){t.ChildEleList.Get(2).Text=e.target.value,t.OwnerDocPanel.IsChanged=!0}closeOpration(e){if(this.operationIsShow){let e=document.querySelectorAll(".pangoeditor-commt-operation-item");for(let t=0;t<e.length;t++)e[t].classList.remove("active")}}cmmtLiClick(e,t){e.stopPropagation();let n=t.RelLineEleFrom,r=t.RelLineEleTo;o.XCommentArea.Edtor.M_GetActionByName("SelectRange").Execute([n,s.XDomUtil.GetNextEle(!0,r)]);let i=e.currentTarget;setTimeout(()=>{i.querySelector("textarea").focus()})}operationClick(e){this.operationIsShow=!0;let t=e.currentTarget.nextElementSibling;t.classList.contains("active")?t.classList.remove("active"):t.classList.add("active")}deleteCmmtClick(e,t){e.currentTarget.parentElement.classList.remove("active"),this.props.deleteCmmt(t),o.XCommentArea.Edtor.MRefreshDocsView()}deletesubCmmtClick(e,t){this.props.deletesubCmmt(t,e),o.XCommentArea.Edtor.MRefreshDocsView()}replyCmmtClick(e){let t=o.XCommentArea.Edtor.M_EdtLoginUserInfo.UsrName,n=e.RelLineEleFrom,r=e.RelLineEleTo,i=new s.XStringEle;i.Text="批注范围 ("+n.GetInnerText(!1)+" --- "+r.GetInnerText(!1)+")";let l=new s.XStringEle;l.Text="";let u=new s.XCommentEle;u.UserName=t,u.AddTime=a.DateTime.getCurrentDateToFormat(),u.AddChildEle(0,i),u.AddChildEle(1,new s.XParagraphFlag),u.AddChildEle(2,l),u.RelLineEleFrom=n,u.RelLineEleTo=r,u.OwnerDocPanel=e.OwnerDocPanel,e.ItemList.Add(u),o.XCommentArea.Edtor.MRefreshDocsView()}resolvedCmmtClick(e,t){e.currentTarget.parentElement.classList.remove("active"),t.RelLineEleFrom.OwnerDocPanel.IsChanged=!0,t.Status=!t.Status,o.XCommentArea.Edtor.MRefreshDocsView()}OprationSelect(e,t,n,r){t.RelLineEleFrom.OwnerDocPanel.IsChanged=!0,"回复"==e?this.replyCmmtClick(t):"已解决"==e||"取消解决"==e?(t.Status=!t.Status,o.XCommentArea.Edtor.MRefreshDocsView()):"删除"==e&&(n?this.deletesubCmmtClick(t,r):(this.props.deleteCmmt(t),o.XCommentArea.Edtor.MRefreshDocsView()))}renderCmmt(){return this.state.cmmtList.map((e,t)=>{let n;return n=e.ChildEleList.Length>=3?e.ChildEleList.Get(2).Text:"",i.createElement("li",{className:"pangoeditor-commt-item",key:t,style:{top:e.PreCmmtBottom}},i.createElement("div",{onClick:t=>{this.cmmtLiClick(t,e)}},i.createElement("div",null,i.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"}},i.createElement("span",{className:"pangoeditor-commt-userName"},e.UserName),i.createElement("span",{className:"pangoeditor-commt-addtime"},e.AddTime)),i.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"}},i.createElement("span",{className:"pangoeditor-commt-resolvedstatus"},e.Status?"已解决":""),i.createElement("span",{className:"pangoeditor-commt-operation"},i.createElement(p,{title:"操作",item:e,onSelect:this.OprationSelect.bind(this)})))),i.createElement("div",null,i.createElement("textarea",{style:{resize:"none"},onChange:t=>this.inputChage(t,e),defaultValue:n,className:"pangoeditor-commt-CommentEle-input"}))),i.createElement("div",null,i.createElement("ul",{style:{marginLeft:"15px",listStyle:"none",padding:0}},this.renderSubList(e.ItemList,e))))})}renderSubList(e,t){return e.ToArray().map((e,n)=>{let r,l=e;return r=l.ChildEleList.Length>=3?l.ChildEleList.Get(2).Text:"",i.createElement("li",{key:n,style:{top:l.PreCmmtBottom}},i.createElement("div",{onClick:e=>{this.cmmtLiClick(e,l)}},i.createElement("div",null,i.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"}},i.createElement("span",null,l.UserName),i.createElement("span",null,l.AddTime)),i.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"}},i.createElement("span",null,l.Status?"已解决":"   "),i.createElement("span",{className:"pangoeditor-commt-operation"},i.createElement(p,{title:"操作",isSub:!0,parentCmmt:t,item:l,onSelect:this.OprationSelect.bind(this)})))),i.createElement("div",null,i.createElement("textarea",{style:{resize:"none"},onChange:e=>this.inputChage(e,l),defaultValue:r}))))})}cmmtContainerMouseDown(e){e.stopPropagation()}render(){let{top:e,left:t,width:n,height:r}=this.state;return i.createElement("div",{onMouseUp:e=>{this.cmmtContainerMouseDown(e)},onMouseDown:e=>{this.cmmtContainerMouseDown(e)},style:{position:"absolute",left:t+"px",width:n+"px",height:r+"px",top:e+"px",backgroundColor:"#fff",border:"1px solid #000",fontSize:"14px",overflow:"auto"}},i.createElement("ul",{ref:this.toggleContainer,className:"pangoeditor-commt-container"},this.renderCmmt()))}}class d extends r.BaseComponent{constructor(e,t){super(e,t,!0),this.Render()}updateProps(e){}Render(){l.render(i.createElement(h,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.XCommentAreaComp=d;class c extends i.Component{constructor(e){super(e),this.clickHandler=e=>{this.props.onSelect(e.target.innerText,this.props.item)}}render(){let e=[""+(this.props.isSub?"":"回复"),""+(this.props.item.Status?"取消解决":"已解决"),"删除"];return i.createElement("div",{className:"pangoeditor-commt-operation-item"},e.map((e,t)=>e?i.createElement("div",{key:t,onClick:this.clickHandler},e):null))}}class p extends i.Component{constructor(e){super(e),this.selectHandler=e=>{this.props.onSelect&&this.props.onSelect(e,this.props.item,this.props.isSub,this.props.parentCmmt)}}render(){return i.createElement(u.DropButton,{buttonIcon:"paragraph",onSelect:this.selectHandler},i.createElement(c,{isSub:this.props.isSub,item:this.props.item}))}}t.CommentOpration=p},function(e,t,n){var r=n(18),i=n(928);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".pangoEditor-Commentpage .pangoeditor-commt-container {\r\n    list-style: none;\r\n    padding: 0;\r\n    margin: 0;\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n.pangoEditor-Commentpage .pangoeditor-commt-container textarea{\r\n    border: 1px solid #ddd;\r\n}\r\n.pangoEditor-Commentpage .pangoeditor-commt-container textarea:focus-visible{\r\n    background-color: #EDEDED;\r\n    border: none;\r\n    outline:1px solid #fff;\r\n}\r\n\r\n.pangoEditor-Commentpage .pangoeditor-commt-container .pangoeditor-commt-operation{\r\n    position: relative;\r\n}\r\n.pangoeditor-commt-operation-item div{\r\n    height: 20px;\r\n    border-bottom: 1px solid #ccc;\r\n}\r\n.pangoeditor-commt-operation-item div:hover{\r\n    background-color: #000aaa;\r\n    cursor: pointer;\r\n    color: #fff;\r\n}\r\n.pangoeditor-commt-operation-item{\r\n    background-color: #fff;\r\n    width: 60px;\r\n    padding: 5px;\r\n    box-shadow: 0 0 16px 0 rgb(0 0 0 / 20%), inset -1px 0 0 0 #a3a3a3, inset 1px 1px 0 0 #a3a3a3;\r\n}\r\n\r\n.pangoEditor-Commentpage .pangoeditor-commt-container .pangoeditor-commt-item.active {\r\n    border: 1px solid #000aaa;\r\n}\r\n\r\n.pangoEditor-Commentpage .pangoeditor-commt-container .pangoeditor-commt-item .pangoeditor-commt-CommentEle-input {\r\n    width: calc(100% - 10px);\r\n}\r\n\r\n.pangoEditor-Commentpage .pangoeditor-commt-container .pangoeditor-commt-item {\r\n    list-style: none;\r\n    box-sizing: border-box;\r\n    padding: 3px;\r\n    width: 100%;\r\n    position: absolute;\r\n    border-left: 2px solid #000;\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseViewBuilder=void 0;const r=n(35),i=n(0),l=n(10),s=n(214),o=n(212),a=n(8),u=n(380),h=n(930);t.XBaseViewBuilder=class{constructor(){this.srcEle=null,this.xdoc=null,this.fromLineIx=-1,this.lastLineSplitter=null,this.splitLastHideExtHeigth=-1,this.lastLineSplitter=new h.XLineSplitter}get SrcEle(){return this.srcEle}set SrcEle(e){null==e?this.Reset():(this.srcEle=e,this.xdoc=e.Document,this.fromLineIx=0)}get FromLineXDomIx(){return this.fromLineIx}set FromLineXDomIx(e){this.fromLineIx=e}set Document(e){this.xdoc=e}Reset(){this.srcEle=null,this.xdoc=null,this.fromLineIx=-1,this.lastLineSplitter.Reset()}IsDone(e){let t=null==this.srcEle||this.fromLineIx<0||this.fromLineIx>=this.srcEle.LinesCnt;return t||null==this.srcEle||this.srcEle instanceof i.XTextTableCell&&this.srcEle.RowSpan>1&&e instanceof i.XTextTableCell&&!e.Visible&&e.MainMergeCell&&e.MainMergeCell.RowSpan>1&&e.RowIndex>e.MainMergeCell.RowIndex&&e.RowIndex<e.MainMergeCell.RowIndex+e.MainMergeCell.RowSpan-1&&(t=!0),t}BeforeBuildView(e){return null!=(null==this.srcEle?null:this.srcEle.GetFirstLine())&&(this._Prepare_RemainRectF(e),!0)}AfterBuildView(e,t){e instanceof i.XContainerColView||this._ReCalc_ViewRect_(e,t)}BuildView(e){try{if(null==this.srcEle)return null;if(!this.BeforeBuildView(e))return this.srcEle;let t=null,n=null,l=this.srcEle.GetLinesIter(),o=this.srcEle.GetEndLine(),a=this.CrtNewEleView(o.ColInx>=0,this.fromLineIx),u=0,h=new s.BooleanWrapper(!1),d=0,c=0;for(;l.MoveNext();)if(t=l.Current,t.Index<this.fromLineIx){if(t==o){this.fromLineIx=1073741823;break}}else if(null!=t.RelEleParagraphStyle&&t.RelEleParagraphStyle.IsFolded)this.fromLineIx++;else{let l=!0;c=this._Calc_LineFullHeight(t,e.Height,h);let s=null;if(t==this.lastLineSplitter.LineToSplit)s=this.lastLineSplitter.SplitLine(e,!0),null!=s&&(c=s.LineAssist.GetLineFullHeight(300,!0));else if(r.CommDefines.CmprNumVal(c,e.Height,.25)>0){if(a.LinesCnt>1){if(this.isDisSplitCell(t))break}if(h.Value)this.lastLineSplitter.setLineToSplit(null);else{let e=!0;this.lastLineSplitter.IsAllDone()||(e=!1),this.lastLineSplitter.setLineToSplit(t,e)}if(s=this.lastLineSplitter.SplitLine(e),null==s||s.Height<.01){l=!1;break}c=s.LineAssist.GetLineFullHeight(300,!0),null!=s&&(t.RealLeft=e.X,t.RealTop=e.Y)}n=null==s?t:s;let o=n.ChildEleList.Count()>0?n.ChildEleList.Get(n.ChildEleList.Count()-1):null,p=null!=(null!=o&&o instanceof i.XParagraphFlag?n.RelEleParagraphStyle:null)?n.RelEleParagraphStyle.BottomMargin:0;p<0&&(p=0),c+=p,n.IndexInView=u++,n.RealLeft=e.X,n.RealTop=e.Y;let f=i.XDomUtil.GetElementFromLine(n,"XTextTable");const g=null!=f&&f.Count()>0;g&&(f.ToArray().forEach(e=>{if(e.RefreshInnerLines(),e instanceof i.XTextTable){const t=e;t.LinesCnt>0&&t.LinesList.ToArray().forEach(e=>{if(null!=e.Container&&e.Container instanceof i.XTextTableView&&e.Container.FromRowIx>0){const t=e.PrevLine;null!=t&&e.SetPositionDPI(-1,t.Bounds.Bottom,300)}})}}),l=!1);let m=0;const E=a instanceof i.XTextTableView,C=0==a.LinesCnt&&this.fromLineIx>0;E&&C&&(m=this.appendXCellViewLinesByTHeadIx(a,this.fromLineIx)),c+=m,n.SetPositionDPI(-1,d+m,300),a.AddLine(n),d+=c,l&&(l=r.CommDefines.CmprNumVal(c,e.Height,85)<0);let A=this.lastLineSplitter.IsAllDone();if(!A&&!l){const e=i.XDomUtil.GetElementFromLine(n,"XTextTableCell");null!=e&&e.Count()>0&&(A=this.isSurplusMapCell(e.ToArray()))}if(e.Y+=c,e.Height-=c,(A||l)&&(this.fromLineIx++,g&&this.srcEle instanceof i.XDocPanel&&1==this.srcEle.PagePanelTp)){if(this.fullViewByLastRow(n,e.Height))break}if(!A&&!l)break;if(t.HasPageBreakEle())break}return this.AfterBuildView(a,d),a}catch(e){}}fullViewByLastRow(e,t){if(!(t>0))return!1;if(null==e)return!1;if(e.ElementCnt<1)return!1;let n,r;const s=e.ChildEleList.ToArray();for(let e=0;e<s.length;e++){const t=s[e];if("XTextTable"==t.EleTypeName){if(r=t,t instanceof i.XTextTableView){let e=t;for(;null!=e.BaseTable;)e=e.BaseTable;e instanceof i.XTextTable&&(n=e)}null==n&&(n=t)}}if(n.FullPageByLastRow){if(!(r.LinesCnt>0))return!1;let e;const n=r.LinesList.ToArray();for(let t=n.length-1;t>=0;t--){const r=n[t];if(null!=r&&(r.ElementCnt>0&&r.Height>0)){e=r;break}}const s=e.Height;if(null==e||s>t)return!0;const u=a.CNumUtil.Round(t/s,0,!1),h=e.ChildEleList.ToArray();for(let t=0;t<u;t++){let n=new o.XEleCtntLine;for(let e=0;e<h.length;e++){const t=h[e];let r=new i.XTextTableCell;r.Clear(),r.CopyFrom(t),r.SetSizeDPI(t.Width,s,300),r.SetPositionDPI(t.Bounds.X,-1,300),n.AddEle(r)}n.SetPositionDPI(e.Bounds.X,e.Bounds.Y+s*(t+1),300),r.AddLine(n)}const d=r.GetBoundsDPI(300).Height+u*s;r.SetSizeDPI(-1,d,300);const c=l.DPITransUtil.TransIntVal(d,300,96);return r.SetSizeDISP(-1e3,c),!0}return!1}appendXCellViewLinesByTHeadIx(e,t){if(null==e)return 0;const n=e.BaseTable;if(null==n)return 0;if(!(n instanceof i.XTextTable))return 0;const r=n.GetLinesArray();if(r.length<1)return 0;const l=n.THeadIx;if(!(l>=0))return 0;if(t<=l)return 0;let s=0;for(let t=0;t<=l;t++){const n=r[t];if(null==n)break;s+=n.Height,e.AddLine(n)}return s}isDisSplitCell(e){if(null==e)return!1;if(e.ElementCnt<1)return!1;let t=!1;const n=e.ChildEleList.ToArray();for(let e=0;e<n.length;e++){const r=n[e];if(!(r instanceof i.XTextTableCell))continue;r.Parent.DisSplit&&(t=!0);break}return t}isSurplusMapCell(e){let t=!0;for(let n=0;n<e.length;n++){let r=e[n];if(r instanceof i.XTextTableCellView){let e=null;null!=r.MainMergeCell&&(e=r.MainMergeCell);const n=e?e.XID:r.BaseCell.XID,i=this.lastLineSplitter.GetVBuilderByXId(n);if(i){if(!e){t=!1;break}t=i.IsDone(r)}}}return t}CrtNewEleView(e,t){if(null==this.srcEle)return null;let n=null;return n=e?new i.XContainerColView:u.XViewFactory.CrtXView(this.srcEle.EleTypeName),n.Document=this.xdoc,this._Init_ViewProps(this.srcEle,n,t),n}_Prepare_RemainRectF(e){let t=this.srcEle.EleStyle.ElePadd;0!=t.Top&&(e.Y+=t.Top,e.Height-=t.Top+t.Bottom)}_Init_ViewProps(e,t,n){t.Parent=e.Parent,t.OwnerDocPanel=e.OwnerDocPanel;let r=e.EleStyle;if(t.EleStyle.CopyFrom(r,!1),t instanceof i.XPagePanelView){let n=e.Bounds.Clone();t.SetSizeDPI(n.Width,n.Height,300),t.SetPositionDPI(n.X,n.Y,300)}}_ReCalc_ViewRect_(e,t){if(null!=e){let n=300;if(e.SetPositionDPI(this.srcEle.X,this.srcEle.Y,n),e.LinesCnt>0){if(e.CalcSizeByLines(),!(e instanceof i.XDocPanel||e instanceof i.XTextTableCell)){let r=this.srcEle.EleStyle.GetElePaddDPI(n),i=t+r.Top+r.Bottom;e.SetSizeDPI(this.srcEle.Width,i,n)}this.srcEle.NotifyLayoutChanged(!0,!1)}}}_Calc_LineFullHeight(e,t,n){let i,l=e.LineAssist.GetTableLineAttrs(300),s=null!=l&&l.IsHidden,o=null==l?-1:l.MinFixHeight,a=null==l?-1:l.MaxCellHeight;return n.Value=!1,s?(n.Value=!0,i=0):r.CommDefines.CmprNumVal(o,t,.25)>0?(n.Value=!0,i=o):r.CommDefines.CmprNumVal(a,t,.25)>0?(n.Value=!1,i=a):(n.Value=!1,i=e.LineAssist.GetLineFullHeight(300,!0)),i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XLineSplitter=void 0;const r=n(0),i=n(212),l=n(122);t.XLineSplitter=class{constructor(){this.isAllDone=!0,this.vBuilderHMap=null,this.lineToSplit=null,this.vBuilderHMap=new Map}get LineToSplit(){return this.lineToSplit}setLineToSplit(e,t=!0){this.lineToSplit!=e&&(t&&this.Reset(),this.lineToSplit=e)}Reset(){this.lineToSplit=null,this.isAllDone=!0,this.vBuilderHMap.forEach((e,t)=>{e.FromLineXDomIx>=e.SrcEle.LinesCnt-1&&(e.Reset(),this.vBuilderHMap.delete(t))})}IsAllDone(){return this.isAllDone}SplitLine(e,t=!1){if(this.isAllDone=!0,!this._Can_SplitLine())return this.Reset(),null;let n=e.Clone(),l=new i.XEleCtntLine;l.Index=this.lineToSplit.Index,l.ColInx=this.lineToSplit.ColInx,l.RelEleParagraph=this.lineToSplit.RelEleParagraph,l.IsFirstLineOfParagraph=this.lineToSplit.IsFirstLineOfParagraph,this.lineToSplit.IsSplit||(l.IsDocFirstLine=this.lineToSplit.IsDocFirstLine),this.lineToSplit.IsSplit=!0;let s=this.lineToSplit.GetElesIter(),o=[];for(;s.MoveNext();){let i=s.Current,a=n,u=!1,h=null;const d=i instanceof r.XTextTableCell&&!i.Visible&&i.MainMergeCell&&i.MainMergeCell.RowSpan>1&&i.RowIndex>i.MainMergeCell.RowIndex&&i.RowIndex==i.MainMergeCell.RowIndex+i.MainMergeCell.RowSpan-1,c=i instanceof r.XTextTableCell&&!i.Visible&&i.MainMergeCell&&i.MainMergeCell.RowSpan>1&&i.RowIndex>i.MainMergeCell.RowIndex&&i.FromNextHideHeight>0;if(d||c){const e=i;if(null!=this.lineToSplit&&this.lineToSplit.ElementCnt>0&&this.lineToSplit.IndexOfElement(e)>-1){const t=e.MainMergeCell,n=this.GetVBuilderByXId(t.XID);if(null!=n){let r=n.splitLastHideExtHeigth;r<0&&(r=e.Height,n.splitLastHideExtHeigth=e.Height),this.lineToSplit.Height-r>.25&&(h=e,i=e.MainMergeCell,u=!0),-1==o.indexOf(t.XID)&&o.push(t.XID)}}}if(!(i instanceof r.XBaseContainer)){i.SetPositionDPI(-1e3,0,-1),l.AddEle(i),this._Update_CpyRemainRect(i,n,e);continue}if(i.Height<e.Height&&!this.GetVBuilderByXId(i.XID)){l.AddEle(i);continue}let p=this._Get_VBuilder_(i),f=p.BuildView(a);if(u)f.Parent=h.Parent,f.RowSpan=h.RowSpan,f.FixHeight=h.FixHeight;else if(t&&d&&null!=f.OwnerLine){const e=f;let t=new r.XTextTableCellView;this._Init_ViewProps(e,t),t.Height=e.Height-e.OwnerLine.Height,e.MainMergeCell.ColIndex!=e.ColIndex?(t.Visible=e.Visible,t.SetSizeDPI(0,-1,300)):t.SetSizeDPI(e.MainMergeCell.Width,-1,300),f=t}let g=p.IsDone(h);if(this.isAllDone=this.isAllDone&&g,null!=f&&(f instanceof r.XTextTableCellView||f.LinesCnt>0))f.SetPositionDPI(-1e3,0,-1),l.AddEle(f);else if(i.IsWholeLineEle())return this.lineToSplit.IsSplit=!1,null;this._Update_CpyRemainRect(f,n,e)}if(!this.CheckLineSplitted(l))return null;if(l.ReCalcLineSize(),l.Height-n.Height>.25&&(l.Bounds.Height=n.Height,this.isAllDone=!1),o.length>0)for(let e=0;e<o.length;e++){const t=o[e],r=this.GetVBuilderByXId(t);if(null!=r){let e=r.splitLastHideExtHeigth;e>0&&(n.Height-e>.25&&(l.Bounds.Height=Math.max(l.Height,e)),e-=l.Height),e<0&&(e=0),r.splitLastHideExtHeigth=e}}return this._SameTableRow_CellHeight(l),l.ReCalcElesLocation(!0),this.isAllDone&&this.Reset(),l}_Init_ViewProps(e,t){if(null!=e&&null!=t){t.CopyFrom(e,!0,!1,!0),t.BaseCell=e,t.Parent=e.Parent,t.OwnerDocPanel=e.OwnerDocPanel;let n=e.EleStyle;t.EleStyle.CopyFrom(n,!1)}}CheckLineSplitted(e){if((null==e?0:e.ElementCnt)<=0)return!1;let t=e.FirstElement;if(t&&t instanceof r.XTextTable){if(t.LinesCnt<=0)return!1}return!0}_Can_SplitLine(){return null!=this.lineToSplit&&this.lineToSplit.HasCtEle}_Update_CpyRemainRect(e,t,n){null!=e&&(t.X+=e.Width,t.Width-=e.Width),t.Y=n.Y,t.Height=n.Height}_Get_VBuilder_(e){if(null==e)return null;let t=null,n=e.XID;return t=this.vBuilderHMap.get(n),null==t&&(t=l.XBuilderFactory.CrtXViewBuilder(e.EleTypeName),t.SrcEle=e,this.vBuilderHMap.set(n,t)),t}GetVBuilderByXId(e){if(null==e)return null;return this.vBuilderHMap.get(e)}_SameTableRow_CellHeight(e){try{let t=e.FirstElement instanceof r.XTextTableCell?e.FirstElement:null;if(null!=t){let n=e.Height,i=e.GetElesIter();for(;i.MoveNext()&&(t=i.Current instanceof r.XTextTableCell?i.Current:null,null!=t);){let i=!1;if(t instanceof r.XTextTableCellView){if(t.LinesCnt<=0)i=!0;else{t.GetLinesHeight(!0,!0,300)<n&&(i=!0)}if(i&&null!=t){let r=t;for(;null!=r.BaseCell;)r=r.BaseCell;if(null!=r&&r.RowSpan>1){const t=r.RelatedMergeCell_Down.Last();if(t.RowBaseHeight>0&&t.OwnerLineInx>e.Index){let r=t.OwnerLine;for(let i=t.OwnerLineInx;i>e.Index&&null!=r;i--)n+=r.Height,r=r.PrevLine}}}}(t.RowSpan<=1||i)&&t.SetSizeDPI(-1,n,300,!1)}}}catch(e){}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowMergeCellSptInfo=void 0;t.RowMergeCellSptInfo=class{constructor(){this.sumRowHeightMergedCells=0,this.replaceCell=null,this.mainCell=null,this.fromMainLineIx=-1,this.isColScanEnd=!1}get SumRowHeightMergedCells(){return this.sumRowHeightMergedCells}set SumRowHeightMergedCells(e){this.sumRowHeightMergedCells=0}get ReplaceCell(){return this.replaceCell}set ReplaceCell(e){this.replaceCell=e}get LineOfReplaceCell(){return null==this.replaceCell?null:this.replaceCell.OwnerLine}get MainCell(){return this.mainCell}set MainCell(e){this.mainCell=e}get LineOfMainCell(){return null==this.mainCell?null:this.mainCell.OwnerLine}get FromMainLineIx(){return this.fromMainLineIx}set FromMainLineIx(e){this.fromMainLineIx=e}get IsColScanEnd(){return this.isColScanEnd}set IsColScanEnd(e){this.isColScanEnd=e}ResetCellViewInfo(){this.sumRowHeightMergedCells=0,this.replaceCell=null}AddSumRowHeightMergedCells(e){e>0&&(this.sumRowHeightMergedCells+=e)}HasMoreCtnt(){return null!=this.mainCell&&this.fromMainLineIx>=0&&this.fromMainLineIx<this.mainCell.LinesCnt}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableHiddenCellMerger=void 0;const r=n(0);t.TableHiddenCellMerger=class{constructor(){this.tlCellHidden=null}get TlCellHidden(){return this.tlCellHidden}set TlCellHidden(e){this.tlCellHidden=e}MergeCellView(){let e=null==this.tlCellHidden?null:this.tlCellHidden.MainMergeCell;if(null==e)return null;let t=new r.XTextTableCellView;this._Init_ViewProps(e,t);let n=0,i=0,l=!1;return e.RelatedMergeCell_Down.ToArray().forEach(e=>{(n>0||e==this.tlCellHidden)&&(e==this.tlCellHidden?(n=1,l=!0,i=null!=e.OwnerLine?e.OwnerLine.Height:this.tlCellHidden.Height):(n++,l&&(null!=e.OwnerLine?i+=e.OwnerLine.Height:i+=this.tlCellHidden.Height)))}),this._After_ViewProps(t,n,i),t}_Init_ViewProps(e,t){if(null!=e&&null!=t){t.CopyFrom(e,!0,!1,!0),t.BaseCell=e,t.Parent=e.Parent,t.OwnerDocPanel=e.OwnerDocPanel;let n=e.EleStyle;t.EleStyle.CopyFrom(n,!1)}}_After_ViewProps(e,t,n){e.RowSpan=t,e.SetSizeDPI(-1,n,300);let r=this.tlCellHidden.Bounds;e.SetPositionDPI(r.X,r.Y,300);let i=e.BoundsDISP;i.Height=n,e.BoundsDISP=i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableCellViewBuilder=void 0;const r=n(122);class i extends r.XBaseViewBuilder{constructor(e){super(),this.isRowMergedCellBuilder=!1,this.isRowMergedCellBuilder=e}BeforeBuildView(e){if(!this.isRowMergedCellBuilder){let e=super.SrcEle;if(!e.Visible)return this.fromLineIx=e.LinesCnt,!1}return super.BeforeBuildView(e)}_Init_ViewProps(e,t,n){let r=e,i=t;null!=r&&null!=i&&(i.CopyFrom(r,!0,!1,!0),i.BaseCell=r,i.Parent=r.Parent,i.Visible=r.Visible,super._Init_ViewProps(e,t,n))}}t.TableCellViewBuilder=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBuilderFactory=void 0;const r=n(122),i=n(4),l=n(381),s=n(382);t.XBuilderFactory=class{static CrtXViewBuilder(e){if(i.default.IsNullOrEmpty(e))return null;let t=null;return"XTextHeader"==e||"XTextFooter"==e||"XTextBody"==e?t=new s.XPagePanelViewBuilder:"XTextTableCell"==e?t=new r.TableCellViewBuilder(!1):"XTextTable"==e&&(t=new l.TableViewBuilder),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageFmtPortrait=void 0;const r=n(82);t.PageFmtPortrait=class{constructor(e){this.pgFmt=null,this.SetXPageFmt(e)}SetXPageFmt(e){this.pgFmt=e}GetWidth(e=0,t=0){let n;return null==this.pgFmt?n=0:(e<=0&&(e=this.pgFmt.Width),t<=0&&(t=this.pgFmt.Height),n=this.pgFmt.UseVisionVal&&this.pgFmt.Landscape?t:e),n}GetHeight(e=0,t=0){let n;return null==this.pgFmt?n=0:(e<=0&&(e=this.pgFmt.Width),t<=0&&(t=this.pgFmt.Height),n=this.pgFmt.UseVisionVal&&this.pgFmt.Landscape?e:t),n}GetPagePadd(){let e;if(null==this.pgFmt)e=r.Padding.Empty;else{let t=this.pgFmt.GetPadding();if(this.pgFmt.UseVisionVal&&this.pgFmt.Landscape){let e=t.Top;t.Top=t.Right,t.Right=t.Bottom,t.Bottom=t.Left,t.Left=e}e=t}return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrinterInfo=void 0;const r=n(4);t.PrinterInfo=class{constructor(e){this.prter_name=null,this.valid=!1,this.err_msg=null,this.prter_name=e}get PrinterName(){return this.prter_name}set PrinterName(e){r.default.Equals(this.prter_name,e)||(this.prter_name=e,this.valid=!1,this.err_msg=null)}get IsValid(){return this.valid}set IsValid(e){this.valid=e}get ErrMsg(){return this.err_msg}set ErrMsg(e){this.err_msg=e}Clear(){this.prter_name=null,this.valid=!1,this.err_msg=null}MergeFrom(e){null!=e&&(r.default.IsNullOrEmpty(e.PrinterName)||(this.prter_name=e.prter_name,this.valid=e.valid,this.err_msg=null))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrintModeArgs=void 0;const r=n(3),i=n(21),l=n(249),s=n(386),o=n(938),a=n(30);t.PrintModeArgs=class{constructor(){this.allowedPrtMode=a.ENumPrtMode.None,this.prtMode=a.ENumPrtMode.Normal,this.pageSelectList=null,this.pageInnRange=null,this.extPageInnRangeList=null,this.prtEndPos=null,this.pageSelectList=new o.PageSelectList,this.pageInnRange=new s.PageInnRange,this.extPageInnRangeList=new r.List,this.prtEndPos=new l.PageInnPoint}get AllowedPrintMode(){return this.allowedPrtMode}set AllowedPrintMode(e){e!=a.ENumPrtMode.Normal&&(e|=a.ENumPrtMode.Normal),this.allowedPrtMode=e}get PrintMode(){return this.prtMode}set PrintMode(e){this.prtMode!=e&&(this.allowedPrtMode&e)==e&&(this.prtMode=e,this.pageSelectList.Clear(),this.pageInnRange.Reset(),this.extPageInnRangeList.Clear(),this.prtEndPos.Reset())}GetPageSelectList(){return this.pageSelectList}GetPageInnRange(){return this.pageInnRange}GetExtInnRangeList(){return this.extPageInnRangeList}GetExtInnRangeArr(){return this.extPageInnRangeList.ToArray()}GetPrtEndPos(){return this.prtEndPos}ResetAll(){this.allowedPrtMode=a.ENumPrtMode.Normal,this.prtMode=a.ENumPrtMode.Normal,this.ResetPageSelRanges(),this.prtEndPos.Reset()}ResetPageSelRanges(){this.pageSelectList.Clear(),this.pageInnRange.Reset(),this.extPageInnRangeList.Clear()}HasPageSelRanges(){let e=!1;switch(this.prtMode){case a.ENumPrtMode.Normal:e=this.pageSelectList.Count()>0;break;case a.ENumPrtMode.Continue:e=this.pageInnRange.IsValid();break;case a.ENumPrtMode.Patch:e=this.pageInnRange.IsValid(),!e&&this.extPageInnRangeList.Count()>0&&this.extPageInnRangeList.ToArray().forEach(t=>{e=e||null!=t&&t.IsValid()})}return e}copyFrom(e){null!=e&&a.ENumPrtMode.None!=e.allowedPrtMode&&(this.allowedPrtMode=e.allowedPrtMode,this.prtMode=e.prtMode,this.pageSelectList.CopyFrom(e.pageSelectList),this.pageInnRange.copyFrom(e.pageInnRange),this.extPageInnRangeList.Clear(),e.extPageInnRangeList.ToArray().forEach(e=>{let t=new s.PageInnRange;t.copyFrom(e),this.extPageInnRangeList.Add(t)}),this.prtEndPos.copyFrom(e.prtEndPos,-1))}ToString(){let e=new i.default;return e.append("PrtMode: "),e.append(this.prtMode.toString()),e.append("; SelPgsCnt: "),e.append(this.pageSelectList.Count()+""),e.append("; From: "),e.append(this.pageInnRange.FromPos.ToString()),e.append("; To: "),e.append(this.pageInnRange.ToPos.ToString()),e.append("; ExtRangeCnt: "),e.append(this.extPageInnRangeList.Count()+""),e.append("; PrtEndPos: "),e.append(this.prtEndPos.ToString()),e.toString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageSelectList=void 0;const r=n(188),i=n(3);t.PageSelectList=class{constructor(){this.selPageList=null,this.selPageList=new i.List}Count(){return this.selPageList.Count()}GetPagesArray(){return this.selPageList.ToArray()}GetPagesIter(){let e=this.selPageList.GetEnumerator();return e.Reset(),e}IsPageSelected(e){return this.selPageList.Exists(t=>r.DocInfoArgs.IsSamePage(t,e))}SortPages(){this.selPageList.Count()}AddOrRemoveOnePage(e){if(null!=e){let t=this.selPageList.FindIndex(0,this.selPageList.Count(),t=>r.DocInfoArgs.IsSamePage(t,e));t>=0?this.selPageList.RemoveAt(t):this.selPageList.Add(e)}}CopyFrom(e){null!=e&&(this.selPageList.Clear(),this.selPageList.AddRange(e.selPageList))}Clear(){this.selPageList.Clear()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageRange=t.PrintPageRanges=void 0;const r=n(3),i=n(21);t.PrintPageRanges=class{constructor(){this.page_range_list=null,this.str_buf=null}PrintPageRanges(){this.page_range_list=new r.List,this.str_buf=new i.default}clear(){this.page_range_list.Clear(),this.str_buf.setLengthToZero()}copyFrom(e){null!=e&&e.rangeCount()>0&&(this.page_range_list.Clear(),this.page_range_list.AddRange(e.page_range_list))}rangeCount(){return this.page_range_list.Count()}pageCount(){let e=0;return this.page_range_list.ToArray().forEach(t=>{e+=t.getPageCount()}),e}getRangesArr(){return this.page_range_list.ToArray()}addRange(e,t){if(t<e)return;if(e<0&&t<0)return;e<0&&(e=0),t<0&&(t=e);let n=new l(e,t),r=this.findRangePos(n.getPageFrom(),null);r<0?this.page_range_list.Add(n):this.mergeFromRangeIx(r,n)}findRangePos(e,t){return null,-1}mergeFromRangeIx(e,t){this.page_range_list.Count;this.page_range_list.Insert(e,t)}IsPageIxInRange(e){if(e<0)return!1;if((null==this.page_range_list?0:this.page_range_list.Count)<=0)return!1;for(let e in this.page_range_list);return!1}filtArrPosOutRange(e){let t=null==e?0:e.length;if(t<=0)return null;if((null==this.page_range_list?0:this.page_range_list.Count)<=0)return null;let n=new r.List,i=!1;for(let r=0;r<t;r++)e[r]<0||(i=!1,i||n.Add(r));let l=0==n.Count()?null:n.ToArray();return n.Clear(),l}joinAsString(){this.str_buf.setLengthToZero();for(let e in this.page_range_list);let e=this.str_buf.toString();return this.str_buf.setLengthToZero(),e}};class l{constructor(e,t){this.page_from=0,this.page_to=0,this.setPageFromTo(e,t)}isValid(){return this.page_from<=this.page_to}setPageFromTo(e,t){e<=t?(this.page_from=e,this.page_to=t):(this.page_from=t,this.page_to=e)}getPageFrom(){return this.page_from}getPageTo(){return this.page_to}getPageCount(){return this.page_to-this.page_from+1}joinAsString(e){this.page_from==this.page_to?e.append(this.page_from+1+""):(e.append(this.page_from+1+""),e.append("-"),e.append(this.page_to+1+""))}containPageIx(e){return!!this.isValid()&&(this.page_from<=e&&e<=this.page_to)}containRange(e){return!(!this.isValid()||null==e||!e.isValid())&&(this.page_from<=e.page_from&&e.page_to<=this.page_to)}tryMergeFrom(e){if(null==e||!e.isValid())return!1;let t=!1;return this.page_to<e.page_from||this.page_from>e.page_to||e.containRange(this)||(t=!0,this.page_from>e.page_from&&(this.page_from=e.page_from),this.page_to<e.page_to&&(this.page_to=e.page_to)),t}}t.PageRange=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrPrintWrapper=void 0;class r{static Correct_Docs_PrtDirect(e,t){if(null!=e&&0!=e.length)for(let n=0;n<e.length;n++){let i=e[n].FirstXDoc;null!=i&&r.Correct_PrtDirect(i,t)}}static Correct_PrtDirect(e,t){let n=e.GetPageFmt();if(n.Landscape!=t){n.Landscape=t;let r=n.PagePadd,i=n.Width;n.Width=n.Height,n.Height=i,t?n.SetPagePadd(r.Bottom,r.Left,r.Top,r.Right,100):n.SetPagePadd(r.Top,r.Right,r.Bottom,r.Left,100),e.RefreshLines(!0),e.IsDocFmtChanged=!0}}}t.EmrPrintWrapper=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmrPrtPreviewEvtHandler=void 0;const r=n(6);t.EmrPrtPreviewEvtHandler=class{constructor(){this.pgvList=null}SetPageViewList(e){this.pgvList=e}_SecondaryPosition(e,t){if(e.IsValid()&&null!=this.pgvList){let n=300,i=e.PageIx;if(i>=0&&i<this.pgvList.Count()){let l=this.pgvList[i];if(null!=l){let i=e.PosInPage.getYAsPX(n),s=l.PageView,o=s.GetPagePanelView(r.ENumPagePanelTp.Body),a=s.GetPageBodyRect(n);if(i<a.Top)e.PosInPage.setYAsPX(a.Top,n);else if(i>a.Bottom)e.PosInPage.setYAsPX(a.Bottom,n);else{let r=o.GetLineAtPosY(e.PosInPage.getXAsPX(n),i,n);if(null!=r){let i=r.GetBoundsDPI(n),l=t?i.Top:i.Bottom;e.PosInPage.setYAsPX(a.Top+l,n)}}}}}}_PaintMarkAsContinueMode(e,t,n){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewPrint1=void 0;const r=n(27),i=n(943);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.PreviewPrintComp(t,this.InitProps)}DefaultProps(){return{top:0,left:0}}}t.PreviewPrint1=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewPrintComp=t.PreviewPrint=void 0;const r=n(12),i=n(24);n(944);const l=n(74),s=n(22),o=n(242),a=n(76);class u extends r.Component{constructor(e){super(e),this.state={isRender:!0,printeQuip:"",pageselect:"",showPageRange:"none",maskHeight:0},this.pageList=e.list,this.FromPageIndex=0,this.FromPosX=0,this.FromPosY=0,this.ToPageIndex=0,this.ToPosX=0,this.ToPosY=0,this.printeQuip=r.createRef(),this.pageSelect=r.createRef(),this.direction=r.createRef(),this.printMode=r.createRef(),this.enterPageDir=r.createRef(),this.printRange=r.createRef(),this.colorOut=r.createRef(),this.printNum=r.createRef(),this.printPageRange=r.createRef()}UNSAFE_componentWillMount(){this.props.parent.React=this;let e=document.querySelector("#print-pages").querySelectorAll("canvas"),t=[];for(let n=0;n<e.length;n++){let r=e[n];t.push(r.toDataURL("image/png"))}this.canvasList=t}componentDidMount(){let e,t=this,n=document.querySelector("#printscale"),r=document.querySelector("#printContainer");n.addEventListener("change",(function(){var e=this.selectedIndex,t=this.options[e].value;let n=parseFloat(t),r=document.querySelectorAll("#imageList>li");for(let e=0;e<r.length;e++){r[e].querySelector("img").setAttribute("width",String(550*n))}})),r.addEventListener("click",(function(e){if("continue"==t.getRadioVal("printtype")){let n=e.clientY-e.target.offsetParent.offsetTop-e.target.offsetParent.offsetParent.offsetTop+l.scrollTop,r=Math.floor(n/this.querySelector("img").clientHeight);t.FromPageIndex=r,t.setState({maskHeight:n}),t.FromPosY=(n-this.querySelector("img").clientHeight*r)/this.querySelector("img").clientHeight*297-5}}));let i=document.querySelector("#selectarea"),l=document.querySelector("#printContainer");r.addEventListener("mousedown",(function(n){if("patch"!=t.getRadioVal("printtype"))return;i.style.width="0px",i.style.height="0px";let r=n.clientX-n.target.offsetParent.offsetLeft-n.target.offsetParent.offsetParent.offsetLeft+l.scrollLeft,s=n.clientY-n.target.offsetParent.offsetTop-n.target.offsetParent.offsetParent.offsetTop+l.scrollTop;e={x:r,y:s}})),r.addEventListener("mousemove",(function(n){if(n.preventDefault(),"patch"==t.getRadioVal("printtype")&&1==n.buttons){let r;r={x:n.clientX-n.target.offsetParent.offsetLeft-n.target.offsetParent.offsetParent.offsetLeft+l.scrollLeft,y:n.clientY-n.target.offsetParent.offsetTop-n.target.offsetParent.offsetParent.offsetTop+l.scrollTop};let s=r.x>e.x?e.x:r.x,o=r.y>e.y?e.y:r.y,a=Math.abs(r.x-e.x),u=Math.abs(r.y-e.y);t.FromPageIndex=Math.floor((o+l.scrollLeft)/this.querySelector("img").clientHeight),t.ToPageIndex=Math.floor((o+u+l.scrollLeft)/this.querySelector("img").clientHeight),t.FromPosX=s/this.querySelector("img").clientHeight*297-4,t.FromPosY=(o-t.FromPageIndex*this.querySelector("img").clientHeight)/this.querySelector("img").clientHeight*297-4,t.ToPosX=(s+a)/this.querySelector("img").clientHeight*297-4,t.ToPosY=(o+u-t.ToPageIndex*this.querySelector("img").clientHeight)/this.querySelector("img").clientHeight*297-4,i.style.left=s+"px",i.style.top=o+"px",i.style.width=a+"px",i.style.height=u+"px"}}))}printtypeChange(e){let t=e.target.value;if("continue"!=t&&this.setState({maskHeight:0}),"patch"!=t){let e=document.querySelector("#selectarea");e.style.width="0px",e.style.height="0px"}}okHandler(){let e={Printer:"",printRange:1,printPageRange:[],PrintMode:"",FromPageIndex:0,FromPosX:0,FromPosY:0,ToPageIndex:0,ToPosX:0,ToPosY:0},t=this.getRadioVal("printtype"),n=[],r=this.printPageRange.current.state.value.split(",");for(let e=0;e<r.length;e++){let t=r[e].split("-");2==t.length?n.push([Number(t[0])-1,Number(t[1])-1]):1==t.length&&n.push([Number(t[0])-1,Number(t[0])-1])}e.Printer=this.printeQuip.current.state.selectedValues[0],e.printPageRange=n,e.printRange=this.printRange.current.state.selectedValues[0].val,e.PrintMode=t,e.FromPageIndex=this.FromPageIndex,e.FromPosY=this.FromPosY,e.FromPosX=this.FromPosX,e.ToPageIndex=this.ToPageIndex,e.ToPosX=this.ToPosX,e.ToPosY=this.ToPosY,setTimeout(()=>{this.props.onOk(e)},0)}CancelHandler(){this.props.onCancel()}closeHandler(){this.setState({isRender:!1})}printRangeSelect(e){1==e.val?this.setState({showPageRange:"none"}):0==e.val&&this.setState({showPageRange:"inline-block"})}getRadioVal(e){for(var t=document.getElementsByName(e),n="",r=0,i=t.length;r<i;r++){let e=t[r];e.checked&&(n=e.value)}return n}render(){let{target:e,top:t,left:n}=this.props,{isRender:i}=this.state;const s=this.canvasList.map((e,t)=>r.createElement("img",{key:t,width:"550px",src:e,alt:""})),u=this.props.printList,h={id:"select1",options:u,isObject:!1,disablePreSelectedValues:!0,singleSelect:!0,displayValue:"text",suffixIcon:"emr-icon-arrow-north",width:150,height:24,selectedValues:[u.length>0?u[0]:""]};return i?r.createElement(l.default,{top:t,left:n,showOkBtn:!0,showCancelBtn:!0,target:e,isShow:!0,onOk:this.okHandler.bind(this),onClose:this.closeHandler.bind(this),onCancel:this.CancelHandler.bind(this)},r.createElement("div",{className:"printtype"},r.createElement("div",null,r.createElement("span",null,"预览缩放"),r.createElement("select",{name:"",id:"printscale",defaultValue:"1"},r.createElement("option",{value:"0.5"},"50%"),r.createElement("option",{value:"0.75"},"75%"),r.createElement("option",{value:"1"},"100%"),r.createElement("option",{value:"1.25"},"125%"),r.createElement("option",{value:"1.5"},"150%"),r.createElement("option",{value:"1.75"},"175%"),r.createElement("option",{value:"2"},"200%"),r.createElement("option",{value:"3"},"300%"))),r.createElement("div",null,r.createElement("input",{name:"printtype",onChange:e=>{this.printtypeChange(e)},value:"normal",type:"radio",defaultChecked:!0}),r.createElement("span",null,"常规")),r.createElement("div",null,r.createElement("input",{name:"printtype",onChange:e=>{this.printtypeChange(e)},value:"continue",type:"radio"}),r.createElement("span",null,"续打模式")),r.createElement("div",null,r.createElement("input",{name:"printtype",onChange:e=>{this.printtypeChange(e)},value:"patch",type:"radio"}),r.createElement("span",null,"补打模式"))),r.createElement("div",{className:"preview-print"},r.createElement("div",{className:"container",id:"printContainer"},r.createElement("div",{className:"mask",style:{height:this.state.maskHeight}}),r.createElement("div",{id:"selectarea"}),r.createElement("div",{id:"imageList"},s)),r.createElement("div",{className:"config"},r.createElement("div",null,r.createElement("h3",null,"打印参数"),r.createElement("div",null,r.createElement(o.default,Object.assign({ref:this.printeQuip,key:"Select1"},h,{top:0,left:0,width:120,label:{text:"打印机"}})))),r.createElement("div",null,r.createElement("h3",null,"打印设置"),r.createElement("div",null,r.createElement(o.default,Object.assign({onSelectedItem:this.printRangeSelect.bind(this),ref:this.printRange,key:"Select6"},{id:"select4",options:[{text:"全部",val:1},{text:"自定义范围",val:0}],isObject:!0,disablePreSelectedValues:!0,singleSelect:!0,displayValue:"text",suffixIcon:"emr-icon-arrow-north",width:150,height:24,selectedValues:[{text:"全部",val:1}]},{top:0,left:0,width:120,label:{text:"打印范围"}}))),r.createElement("div",{style:{display:this.state.showPageRange}},r.createElement(a.Input,{ref:this.printPageRange,top:0,left:0,width:"120",labelText:"页码设定"}),r.createElement("div",{className:"tooltip"},"输入页面号码和/或页面范围,以英文逗号分隔,如: 1,5-12")))))):null}}t.PreviewPrint=u;class h extends s.BaseComponent{constructor(e,t){super(e,t)}Render(){i.render(r.createElement(u,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.PreviewPrintComp=h},function(e,t,n){var r=n(18),i=n(945);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".preview-print .mask {\r\n    width: 100%;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    border: 1px solid #0fbbf1;\r\n    background-color: rgba(0, 0, 255, .1);\r\n}\r\n\r\n.preview-print #selectarea {\r\n    border: 1px solid #0fbbf1;\r\n    background-color: rgba(0, 0, 255, .1);\r\n    position: absolute;\r\n}\r\n\r\n.preview-print {\r\n    width: 800px;\r\n    height: 420px;\r\n    display: flex;\r\n    padding: 10px;\r\n}\r\n\r\n.preview-print .tooltip {\r\n    font-size: 12px;\r\n}\r\n\r\n.preview-print .container {\r\n    flex: 1;\r\n    position: relative;\r\n    overflow-y: auto;\r\n}\r\n\r\n.preview-print .container ul {\r\n    border: 1px solid #333;\r\n    padding: 0;\r\n    margin: 0;\r\n    display: inline-block;\r\n}\r\n\r\n.preview-print .container ul li {\r\n    margin: 0;\r\n    padding: 0;\r\n    text-align: center;\r\n    display: inline-block;\r\n    border-bottom: 1px solid #333;\r\n}\r\n\r\n.preview-print .config {\r\n    width: 200px;\r\n    padding-left: 15px;\r\n}\r\n\r\n.preview-print .config>div>div {\r\n    padding-left: 10px;\r\n    margin-top: 10px;\r\n}\r\n\r\n\r\n\r\n.printtype {\r\n    display: flex;\r\n    padding: 10px;\r\n}\r\n\r\n.printtype>div {\r\n    flex: 1;\r\n}",""]),e.exports=t},function(e,t,n){var r=n(18),i=n(947);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){var r=n(19),i=n(388),l=n(948);t=r(!1);var s=i(l);t.push([e.i,".loading-mask {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    left:0;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background-color: rgba(255,255,255,.4);\r\n}\r\n\r\n.loading-icon {\r\n    display: block;\r\n    width: 180px;\r\n    height: 140px;\r\n    background: url("+s+");\r\n}\r\n\r\n@keyframes rotating {\r\n    0% {\r\n        transform-origin: center center;\r\n        transform: rotate(0deg)\r\n    }\r\n\r\n    to {\r\n        transform-origin: center center;\r\n        transform: rotate(1turn)\r\n    }\r\n}",""]),e.exports=t},function(e,t,n){"use strict";n.r(t),t.default=n.p+"e1940564564e929dc20faf5fb7bd7400.gif"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_PrintDoc=void 0;const r=n(245);class i extends r.BaseA_PrintDoc{ActName(){return"PrintDoc"}Execute(e){let t=(null==e?0:e.length)<=0?new Boolean(!0):e[0];return super.Execute([!1,t])}}t.A_PrintDoc=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_PrintPreview=void 0;const r=n(245);class i extends r.BaseA_PrintDoc{ActName(){return"PrintPreview"}constructor(){super()}Execute(e){let t=null==e?0:e.length,n=t<=0?new Boolean(!0):e[0],r=t<=1?null:e[1];return super.Execute([!0,n,r])}}t.A_PrintPreview=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SaveAsFile=void 0;const r=n(2),i=n(1),l=n(14),s=n(389),o=n(398),a=n(146);class u extends i.XBaseAction{ActName(){return"FileSaveAs"}constructor(e){super(e),super.OpType=r.ENumActOpType.Save}pdfBase64ToBlob(e){for(var t=atob(e),n=t.length,r=new Uint8Array(n);n--;)r[n]=t.charCodeAt(n);return new Blob([r],{type:"pdf"})}downloadFile(e,t){o({printable:e,type:"pdf",base64:!0})}downloadFileByBase64(e,t){if(e){const n=this.pdfBase64ToBlob(e);URL.createObjectURL(n);this.downloadFile(e,t)}else alert("文件不存在")}Execute(e){this.resMsg.Clear();let t,n,r,i=super.GetEdtCtrl(),o=this,u=null==e?0:e.length,h="test.xml";if(0==u)t=!0;else if(1==u){let n=e[0];"string"==typeof n&&(t=!0,h=n)}else 2==u&&(t=e[0],h=e[1],n=e[1]);try{this.ClearStyle();let e=i.M_DocumentFocused.ToXML(),r=l.XmlDomUtil.Xml2String(e);if(t){var d=document.createElement("a");d.download=h,d.style.display="none";var c=new Blob(['<?xml version="1.0" encoding="utf-8"?>'+r]);d.href=URL.createObjectURL(c),document.body.appendChild(d),d.click(),document.body.removeChild(d)}else"Microsoft Print to PDF"==n.Printer&&setTimeout(()=>{a.LoadingComp.show(),s.default.post("/api/print/PrintService/DoPrintPdf",{PageRangeType:n.printRange,PageRange:n.printPageRange,Printer:n.Printer,PrintMode:n.PrintMode,FromPageIndex:n.FromPageIndex,FromPosX:n.FromPosX,FromPosY:n.FromPosY,ToPageIndex:n.ToPageIndex,ToPosX:n.ToPosX,ToPosY:n.ToPosY,Xml:encodeURIComponent('<?xml version="1.0" encoding="utf-8"?>'+r)}).then(e=>{a.LoadingComp.hide();let t=document.querySelector("#print-pages");t&&t.remove();const n=e.data;o.downloadFileByBase64(n,"test")}).catch(e=>{})},100)}catch(e){this.resMsg.Ex=e}return i.Focus(),r=this.resMsg,r}}t.A_SaveAsFile=u},function(e,t,n){"use strict";var r=n(61),i=n(390),l=n(953),s=n(396);function o(e){var t=new l(e),n=i(l.prototype.request,t);return r.extend(n,l.prototype,t),r.extend(n,t),n}var a=o(n(250));a.Axios=l,a.create=function(e){return o(s(a.defaults,e))},a.Cancel=n(397),a.CancelToken=n(968),a.isCancel=n(395),a.all=function(e){return Promise.all(e)},a.spread=n(969),a.isAxiosError=n(970),e.exports=a,e.exports.default=a},function(e,t,n){"use strict";var r=n(61),i=n(391),l=n(954),s=n(955),o=n(396),a=n(966),u=a.validators;function h(e){this.defaults=e,this.interceptors={request:new l,response:new l}}h.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=o(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&a.assertOptions(t,{silentJSONParsing:u.transitional(u.boolean,"1.0.0"),forcedJSONParsing:u.transitional(u.boolean,"1.0.0"),clarifyTimeoutError:u.transitional(u.boolean,"1.0.0")},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var i,l=[];if(this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)})),!r){var h=[s,void 0];for(Array.prototype.unshift.apply(h,n),h=h.concat(l),i=Promise.resolve(e);h.length;)i=i.then(h.shift(),h.shift());return i}for(var d=e;n.length;){var c=n.shift(),p=n.shift();try{d=c(d)}catch(e){p(e);break}}try{i=s(d)}catch(e){return Promise.reject(e)}for(;l.length;)i=i.then(l.shift(),l.shift());return i},h.prototype.getUri=function(e){return e=o(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){h.prototype[e]=function(t,n){return this.request(o(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){h.prototype[e]=function(t,n,r){return this.request(o(r||{},{method:e,url:t,data:n}))}})),e.exports=h},function(e,t,n){"use strict";var r=n(61);function i(){this.handlers=[]}i.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,n){"use strict";var r=n(61),i=n(956),l=n(395),s=n(250);function o(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return o(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return o(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return l(t)||(o(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(61),i=n(250);e.exports=function(e,t,n){var l=this||i;return r.forEach(n,(function(n){e=n.call(l,e,t)})),e}},function(e,t){var n,r,i=e.exports={};function l(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===l||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:l}catch(e){n=l}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var a,u=[],h=!1,d=-1;function c(){h&&a&&(h=!1,a.length?u=a.concat(u):d=-1,u.length&&p())}function p(){if(!h){var e=o(c);h=!0;for(var t=u.length;t;){for(a=u,u=[];++d<t;)a&&a[d].run();d=-1,t=u.length}a=null,h=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||h||o(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(61);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(394);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var r=n(61);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,l,s){var o=[];o.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),r.isString(i)&&o.push("path="+i),r.isString(l)&&o.push("domain="+l),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(962),i=n(963);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(61),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,l,s={};return e?(r.forEach(e.split("\n"),(function(e){if(l=e.indexOf(":"),t=r.trim(e.substr(0,l)).toLowerCase(),n=r.trim(e.substr(l+1)),t){if(s[t]&&i.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},function(e,t,n){"use strict";var r=n(61);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(967),i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var l={},s=r.version.split(".");function o(e,t){for(var n=t?t.split("."):s,r=e.split("."),i=0;i<3;i++){if(n[i]>r[i])return!0;if(n[i]<r[i])return!1}return!1}i.transitional=function(e,t,n){var i=t&&o(t);return function(s,o,a){if(!1===e)throw new Error(function(e,t){return"[Axios v"+r.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}(o," has been removed in "+t));return i&&!l[o]&&(l[o]=!0),!e||e(s,o,a)}},e.exports={isOlderVersion:o,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),i=r.length;i-- >0;){var l=r[i],s=t[l];if(s){var o=e[l],a=void 0===o||s(o,l,e);if(!0!==a)throw new TypeError("option "+l+" must be "+a)}else if(!0!==n)throw Error("Unknown option "+l)}},validators:i}},function(e){e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},function(e,t,n){"use strict";var r=n(397);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SaveDoc=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"FileSave"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl();t.unfocus=!0;let n,r,i=t.M_XDocsUtil;try{this.ClearStyle(),r=t.MSaveXmlDocuments(e),i.ResetXDocsChangedFlag()}catch(e){this.resMsg.Ex=e}return this.resMsg.ReturnParams=r,n=this.resMsg,n}}t.A_SaveDoc=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SecretDoc=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"SecretDoc"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl().M_XDocsUtil.MGet_Documents();if(null==n)t=this.resMsg;else{let r=(null==e?0:e.length)<=0?null:e[0],i=n;for(let e=0;e<i.length;e++){let t=i[e];null==r?t.AssistFunc.ReverseSecretStatus():t.AssistFunc.ChangeSecretStatus(r)}super._RefreshPageAndMoveCaret(!0,!0),t=this.resMsg}return t}}t.A_SecretDoc=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SaveAsText=void 0;const r=n(2),i=n(1);class l extends i.XBaseAction{constructor(){super(),this.edt_elerange=null,super.OpType=r.ENumActOpType.Save}ActName(){return"SaveAsText"}Execute(e){this.resMsg.Clear();const t=super.GetEdtCtrl();let n;try{let n=e.length,r=!0;n>0&&(r=e[0].withBorder);const i=t.M_EleEvtModel.SelRange;let l="";l=r?i.BuildEleRangeAsText():i.BuildEleRangeAsTextWithNotBorder(),t.M_EdtCustomEvtGrp.SaveAsText(l),this.resMsg.ReturnParams=l}catch(e){this.resMsg.Ex=e}return t.Focus(),n=this.resMsg,n}}t.A_SaveAsText=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_AppendDoc=void 0;const r=n(2),i=n(70),l=n(4),s=n(1),o=n(46);class a extends s.XBaseAction{constructor(){super(),this.xdocLoadParam=null,super.OpType=r.ENumActOpType.CtntEdit,this.xdocLoadParam=new i.XDocLoadParam(null,r.ENumXDocPath.LocalFile)}ActName(){return"FileAppend"}Execute(e){this.resMsg.Clear();let t=(null==e?0:e.length)<=0?null:e[0],n=t.srcstr,r=t.newPage,i=t.index,s=null==t.isEditable||t.isEditable,a=t.docId,u=t.topMargin,h=t.fixed,d=super.GetEdtCtrl();h&&(d.unfocus=!0);let c,p=d.M_EleEvtModel.EleClickedWrap,f=p.EleFocused,g=d.GetAlertFormStartRect(o.PositionEnum.LeftBottom,0,0,"focused").Location;if(l.default.IsNullOrEmpty(n))return this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName+" 命令未指定有效的文件路径。",c=this.resMsg,c;try{this.xdocLoadParam.SrcStr=n,null!=d.M_EleEvtModel.WorkMode&&(this.xdocLoadParam.WorkMode=d.M_EleEvtModel.WorkMode);let e=null==u?null:u;if(d.MAppendXmlDocument(this.xdocLoadParam,r,s,i,e,a),h){d.unfocus=!1,p.LineEleIxFocused.SetEle(f),d.Focus(),d.M_EleEvtModel.MoveCaretByCursorEle(!0);let e=d.GetAlertFormStartRect(o.PositionEnum.LeftBottom,0,0,"focused").Location.Y-g.Y,t=d.ContainerDOM.querySelector("#pango-editor-content-"+d.ContainerDOM.id);t.scrollTop=t.scrollTop+e}this.resMsg.ReturnParams=!0}catch(e){d.M_EdtCustomEvtGrp.OpenError&&d.M_EdtCustomEvtGrp.OpenError(),this.resMsg.ReturnParams=!1,this.resMsg.Ex=e}return c=this.resMsg,c}}t.A_AppendDoc=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertChar=void 0;const r=n(2),i=n(0),l=n(16),s=n(79),o=n(94),a=n(4),u=n(106),h=n(13),d=n(976),c=n(55),p=n(1),f=n(6),g=n(7);class m extends p.XBaseAction{constructor(){super(),this.edt_elerange=null,this.isPresetIng=!1,this.preUGpCountArr=[],this.presetValue="",super.OpType=r.ENumActOpType.CtntEdit,this.edt_elerange=new c.EmrEditEleRange}ActName(){return"InsertChar"}set PreUGpCountArr(e){this.PreUGpCountArr=e}set PresetUndoGroup(e){this.presetUndoGroup=e}set PresetValue(e){this.presetValue=e}Execute(e){this.resMsg.Clear();const t=super.GetEdtCtrl();if(null==e||e.length<1)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",super.MessageWarn(),this.resMsg;const n=t.M_EleEvtModel,r=t.M_EleEvtModel.EleClickedWrap;if(null==r||!r.IsValid())return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 请确定插入光标位置",super.MessageWarn(),this.resMsg;let s=e[0]||"";if(!s)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 插入接口内容为空",this.resMsg;let u=new h.UndoGroup;const d=r.EleFocused;this.edt_elerange.SetEleEvtObjs(n,t.M_EleEvtHandler);let c=this.edt_elerange.IsSelRangeValid(),[p,g]=c?super.GetSelRangeOuterEles(n.SelRange):super.GetFocusedOuterEles(r);this.edt_elerange.DelSelRange(127,u,this.resMsg);let m=!1,E=!1,C=!0;if(this.isPresetIng=!!e[1],this.isPresetIng){let e=s;if(null!=this.presetUndoGroup){C=!1,E=!0,u=this.presetUndoGroup,null==this.presetValue&&(this.presetValue="");const t=/(^\s+)|(\s+$)|\s+|'|’/g,n=this.presetValue.replace(t,""),r=s.replace(t,"");if(n.length<=r.length){const t=this.presetValue.length>s.length?this.presetValue.length:s.length;let n="";for(let e=0;e<t;e++){const t=this.presetValue[e];if(t!=s[e])break;n+=t}for(let e=this.presetValue.length-n.length-1;e>=0;e--){let e=u.RemoveEnd();null!=e&&e.Undo()}this.presetValue=n,e=s.substr(this.presetValue.length)}else{m=!0;const t=this.preUGpCountArr.pop();for(let e=0;e<t;e++){let e=u.RemoveEnd();null!=e&&e.Undo()}e=""}}else this.preUGpCountArr=[u.GetChildUodoList().Count()];this.presetValue=s,s=e}else if(null!=this.presetUndoGroup&&this.presetValue){u=this.presetUndoGroup;const e=u.GetChildUodoList().Count();for(let t=0;t<e-this.preUGpCountArr[0];t++){let e=u.RemoveEnd();null!=e&&e.Undo()}this.presetUndoGroup=null,this.presetValue="",C=!1}if(E=E||o.EditorWorkModeUtil.ChkAddRuleForWorkMode(d,n.WorkMode),!E){let e=d.GetInnerText(!1);return a.default.IsNullOrEmpty(e)&&(e=d.GrpID),this.resMsg.MsgLevel=2,this.resMsg.MsgStr="当前工作模式下, 不能在元素 "+e+" 处编辑插入",super.MessageWarn(),this.resMsg}let A=l.XDomUtil.GetParentXInput(d,!0);if(!this.isPresetIng&&!m&&null!=A&&!(d instanceof i.XInputBorderEle&&d.IsStartBorder)&&A.ValidateStyle.MaxLength>0){if(A.ValidateStyle.MaxLength<=A.InnerValue.length)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr="输入入内容超出元素允许最大长度",super.MessageWarn(),this.resMsg;if(A.ValidateStyle.MaxLength<=A.InnerValue.length+s.length){const e=A.ValidateStyle.MaxLength-A.InnerValue.length;s=s.substr(0,e),this.resMsg.MsgLevel=5,this.resMsg.MsgStr="输入入内容超出元素允许最大长度",super.MessageWarn()}}const y=u.GetChildUodoList().Count();if(m=m||this._InsertSimpleCharEle(s,r,u),this.isPresetIng){if(m&&s){const e=u.GetChildUodoList().Count();this.preUGpCountArr.push(e-y)}this.presetUndoGroup=u}return C&&(u.CursorUndoEle=d),u.CursorRedoEle=r.EleFocused,C&&super._AddUndoItem(u),(c||m)&&(d.OwnerDocPanel.PagePanelTp==f.ENumPagePanelTp.Body?(p=this.getPrevEle(p),super._RefreshPageAndMoveCaretBetweenEle(p,g,!0)):super._RefreshPageAndMoveCaretBetweenEle(null,null,!0)),m&&(this.resMsg.MsgStr=""),this.resMsg.ReturnParams=!0,this.resMsg}getPrevEle(e){let t=!1;if(null==e)t=!0;else{const n=e.Parent;if(null==n)t=!0;else{n.GetChildInx(e)<0&&(t=!0)}}return t&&(e=super.GetEdtCtrl().M_EleEvtModel.EleClickedWrap.EleFocused.OwnerDocPanel.ChildEleList.Get(0)),e}_InsertSimpleCharEle(e,t,n){if(!e)return!1;let r=t.LineEleIxFocused,s=t.EleFocused,o=[-1];const a=l.XDomUtil.PrepareParentXStr(o,r,n),u=a[0];o[0]=a[1];let h,d=super.GetEdtCtrl().M_EdtCaret.IsInsertMode;if(s instanceof i.XCharacterEle||(d=!0),null!=u&&u.IsXInputBkgText&&(d=!0),h=d?this._DoInsert_SimpleChar(r,u,o[0],e,n):this._DoReplace_SimpleChar(u,o[0],e,t,n),!h){n.RemoveEnd().Undo()}return h}_DoInsert_SimpleChar(e,t,n,o,a){let h=super.GetEdtCtrl(),d=h.M_EleEvtModel,c=new i.XCharacterEle(o),p=h.M_EleEvtHandler;const f=null!=t&&null!=t.Parent&&t.Parent instanceof i.XBaseInputEle?t.Parent:null;let g=d.AddEdtHistAct,m=[];if(l.XDomUtil.IsBkgTextOfXInput(t)){let r=!0;super._UseCaretEleStyle(c);let i=l.XDomUtil.TrySwitchXInputToNotEmpty(r,t,c,e,a);this.compareForeColorHasOpacity(c,f),p.OnTextChanged(t),n=0,i instanceof s.XStringEle&&(m=(t=i).ChildEleList.ToArray())}else{let e=o.length,r=!1;if(o.indexOf("𬌗")>-1&&(e-=1,r=!0),e>1){let e,l=[];if(r){let t=o.indexOf("𬌗");for(let n=0;n<o.length;n++){let r=o[n];t!=n?e.push(r):(e.push("𬌗"),n++)}}else e=o.split("");e.forEach(e=>{let n=new i.XCharacterEle(e);super._UseCaretEleStyle(n),this.compareForeColorHasOpacity(c,f),n.Parent=t,l.push(n)}),t.AddChildrenEle(n,l),m=l,p.OnTextChanged(t);for(let e=0;e<l.length;e++){const r=l[e];n=t.GetChildInx(r);let i=new u.EleAddDelUndo(r,n,!0);a.AddItem(i)}}else{t.AddChildEle(n,c),m.push(c),super._UseCaretEleStyle(c),this.compareForeColorHasOpacity(c,f),p.OnTextChanged(t),n=t.GetChildInx(c);let e=new u.EleAddDelUndo(c,n,!0);a.AddItem(e)}}return null!=g&&g.Execute3(r.ENumEdtType.Add,a,m),!0}compareForeColorHasOpacity(e,t){if(null==e)return;const n=e.EleStyle.ForeColor,r=n.getOpacity();let i=1;if(null!=t&&t.Attr_FgHide&&t.ChildCount>0){const e=t.ChildEleList.Get(0).EleStyle.ForeColor;i=e.getOpacity()}if(i!=r){let t=n.ToRgbaString();if(!a.default.IsNullOrEmpty(t)){const n=/(^\s+)|(\s+$)|\s+/g;t=t.replace(n,()=>""),t=t.replace(/[,][.0-9]+[/)]/,()=>","+i+")"),e.EleStyle.ForeColor=new g.Color(t)}}}_DoReplace_SimpleChar(e,t,n,r,l){let s=super.GetEdtCtrl().M_EleEvtHandler;new i.XCharacterEle(n).Clear();let o=e.GetChildEle(t);if(null==o||!(o instanceof i.XCharacterEle))return!1;let h=a.default.IsAsciiChar(n),c=o.UpdateChVal(n),p=!h&&" "==c;if(p){let n=null==e?null:e.GetChildEle(t+1),r=null==n?"x":n.ChVal;if(p=p&&" "==r,p){let n=e.RemoveChild(t+1),r=new u.EleAddDelUndo(n,t+1,!1);l.AddItem(r)}}let f=new d.XCharReplaceUndo(o,c);return l.AddItem(f),r.MovetoNextEle(!0),p&&r.MovetoNextEle(!0),s.OnTextChanged(e),!0}}t.A_InsertChar=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XCharReplaceUndo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t){super(),this.relEle=null,this.oldCH="\0",this.newCH="\0",this.relEle=e,this.oldCH=t,null!=e&&(this.newCH=e.ChVal)}IsValid(){return null!=this.relEle}CanUndo(){return this.IsValid()&&"\0"!=this.oldCH}CanRedo(){return this.IsValid()&&"\0"!=this.newCH}Undo(){this.CanUndo()&&this.relEle.UpdateChVal(this.oldCH)}Redo(){this.CanRedo()&&this.relEle.UpdateChVal(this.newCH)}Clear(){this.relEle=null,this.oldCH=this.newCH="\0"}}t.XCharReplaceUndo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertPageBreak=void 0;const r=n(2),i=n(0),l=n(94),s=n(4),o=n(13),a=n(55),u=n(1),h=n(6);class d extends u.XBaseAction{constructor(){super(),this.edt_elerange=null,super.OpType=r.ENumActOpType.CtntEdit,this.edt_elerange=new a.EmrEditEleRange}ActName(){return"InsertPageBreak"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),r=n.M_EleEvtModel,i=n.M_EleEvtModel.EleClickedWrap;if(null!=i&&i.IsValid()){let e=i.EleFocused;if(l.EditorWorkModeUtil.ChkAddRuleForWorkMode(e,r.WorkMode)){let l=new o.UndoGroup;this.edt_elerange.SetEleEvtObjs(r,n.M_EleEvtHandler);let[s,a]=this.edt_elerange.IsSelRangeValid()?super.GetSelRangeOuterEles(r.SelRange):super.GetFocusedOuterEles(r.EleClickedWrap);this.edt_elerange.DelSelRange(127,l,this.resMsg);let u=this._InsertPageBreak(i,l);l.CursorUndoEle=e,l.CursorRedoEle=i.EleFocused,super._AddUndoItem(l),u&&(e.OwnerDocPanel.PagePanelTp==h.ENumPagePanelTp.Body?(null==s&&(s=e.OwnerDocPanel.ChildEleList.Get(0)),super._RefreshPageAndMoveCaretBetweenEle(s,a,!0)):super._RefreshPageAndMoveCaretBetweenEle(null,null,!0)),t=this.resMsg}else{let n=e.GetInnerText(!1);s.default.IsNullOrEmpty(n)&&(n=e.GrpID),this.resMsg.MsgLevel=5,this.resMsg.MsgStr="当前工作模式下, 不能在元素 "+n+" 处编辑插入",super.MessageWarn(),t=this.resMsg}}else this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 请确定插入光标位置",super.MessageWarn(),t=this.resMsg;return t}_InsertPageBreak(e,t){let n,r=e.LineEleIxFocused.Line.RelEleParagraph;return null!=r.RelOutline&&r.RelOutline.IsFolded?(r.RelOutline.FoldOutlineContent(!1),n=!0):n=this._DoInsert_PageBreak(e,t),n}_DoInsert_PageBreak(e,t){let n=e.LineEleIxFocused.Line,r=new i.XPageBreakLabel,l=new i.XParagraphFlag,s=new i.XParagraphFlag;l.EleStyle.CopyFrom(n.RelEleParagraphStyle,!1),s.EleStyle.CopyFrom(n.RelEleParagraphStyle,!1);let o=[r,s];return this.edt_elerange.InsertNewEles(-1,l,o,t,this.resMsg),!0}}t.A_InsertPageBreak=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertReturn=void 0;const r=n(2),i=n(0),l=n(117),s=n(94),o=n(4),a=n(399),u=n(13),h=n(55),d=n(1),c=n(6),p=n(9);class f extends d.XBaseAction{constructor(){super(),this.edt_elerange=null,super.OpType=r.ENumActOpType.CtntEdit,this.edt_elerange=new h.EmrEditEleRange}ActName(){return"InsertReturn"}Execute(e){if(this.isElement=!1,e.length>0){let t=e[0];this.isElement=t.isElement}let t;this.resMsg.Clear();try{let e=super.GetEdtCtrl(),n=e.M_EleEvtModel,r=e.M_EleEvtModel.EleClickedWrap,[l,a]=[null,null];if(null!=r&&r.IsValid()){let h=r.EleFocused;if(s.EditorWorkModeUtil.ChkAddRuleForWorkMode(h,n.WorkMode)){let t=new u.UndoGroup;this.edt_elerange.SetEleEvtObjs(n,e.M_EleEvtHandler),this.edt_elerange.IsSelRangeValid()?[l,a]=super.GetSelRangeOuterEles(n.SelRange):[l,a]=super.GetFocusedOuterEles(r),this.edt_elerange.DelSelRange(127,t,this.resMsg);let s=this._InsertParagh(r,t);if(s&&h instanceof i.XParagraphFlag&&(a=h.Parent.GetChildEle(h.Parent.ChildEleList.IndexOf(h)+1)),t.CursorUndoEle=h,t.CursorRedoEle=r.EleFocused,super._AddUndoItem(t),s)if(h.OwnerDocPanel.PagePanelTp==c.ENumPagePanelTp.Body){if(null==l&&(l=h.OwnerDocPanel.ChildEleList.Get(0)),null!=a){const e=a.Parent;if(null!=e&&null!=a.OwnerDocPanel&&e.XID==a.OwnerDocPanel.XID){const t=e.GetChildInx(a);if(!(a instanceof i.XParagraphFlag&&t>=e.ChildCount-1)){let n,r=e.ChildCount;for(let l=t;l<r&&(n=e.GetChildEle(l+1),n instanceof i.XBaseContainer&&n.ChildEleList.Length<=0||null==n);l++);a=n instanceof i.XBaseContainer?n.GetLastChildEle():n}}}super._RefreshPageAndMoveCaretBetweenEle(l,a,!0)}else super._RefreshPageAndMoveCaretBetweenEle(null,null,!0);let o=p.RectangleF.Empty;e.MSetScrollToEleRect(n.EleClicked,o)}else{let e=h.GetInnerText(!n.ViewMode.IsCleanViewMode);o.default.IsNullOrEmpty(e)&&(e=h.GrpID),this.resMsg.MsgLevel=5,this.resMsg.MsgStr="当前工作模式下, 不能在元素 "+e+" 处编辑插入",super.MessageWarn(),t=this.resMsg}}else this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 请确定插入光标位置",super.MessageWarn(),t=this.resMsg;this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return t=this.resMsg,t}_InsertParagh(e,t){let n,r=e.EleFocused,l=e.LineEleIxFocused.Line.RelEleParagraph;if(null!=l.RelOutline&&l.RelOutline.IsFolded)l.RelOutline.FoldOutlineContent(!1),n=!0;else if(r instanceof i.XParagraphFlag){let e=l.ParaghStyle.BottomMargin>0?l.ParaghStyle.BottomMargin:0;l.ParaghStyle.BottomMargin=0,n=this._InsertReturnAfterCR(r,t,e)}else n=this._InsertReturnMidText(e,t);return n}_InsertReturnAfterCR(e,t,n){let r;if(null==e)r=!1;else{let l=e.Parent,s=l.GetChildInx(e),o=new i.XParagraphFlag;o.IsElement=this.isElement,o.EleStyle.CopyFrom(e.EleStyle,!1),o.ParaghStyle.BottomMargin=n,this.edt_elerange.InsertNewEle(o,l,s+1,!0,t,this.resMsg),r=!0}return r}_InsertReturnMidText(e,t){let n=e.LineEleIxFocused.Line,r=new i.XParagraphFlag;r.IsElement=this.isElement,r.EleStyle.CopyFrom(n.RelEleParagraphStyle,!1);let l=this._BuildAfterLabelSerno(r);if(this.edt_elerange.InsertNewEles(-1,r,l,t,this.resMsg),null!=r.Document){let e=r.Document.GetOutlineList();if(e.Add(r)){let n=new a.OutlineAddDelUndo(r,e,!0);t.AddItem(n)}}return!0}_BuildAfterLabelSerno(e){if(l.ParagraphListStyleVals.IsNoneListStyle(e.ListStyle))return null;return[new i.XLabelSerno]}}t.A_InsertReturn=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_MoveCaret=void 0;const r=n(29),i=n(1);class l extends i.XBaseAction{constructor(){super(...arguments),this.act_selrange=null}ActName(){return"MoveCaret"}Execute(e){let t;this.resMsg.Clear();let n=super.GetEdtCtrl();if(null==e||e.length<1)this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",super.MessageWarn(),t=this.resMsg;else{let i=n.M_EleEvtModel,l=i.EleClickedWrap;if(null!=l&&l.IsValid()){let s=e.length,o=e[0],a=s>=2?e[1]:null;null==o?(this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令需要传入按键值",super.MessageWarn(),t=this.resMsg):(this._MoveCaret(o,l),null==a||r.Keys.Shift!=(a&r.Keys.Shift)?i.ReInitSelRange():this._ChangeSelRange(o,n),i.UpdateLastEleClicked(null,!1),t=this.resMsg)}else this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 请确定插入光标位置",super.MessageWarn(),t=this.resMsg}return t}_MoveCaret(e,t){let n,i=t.EleFocused,l=!1;switch(e){case r.Keys.ArrowLeft:n=!1,l=t.MovetoNextEle(n),l&&t.UpdateOrigElePosInLine(),t.GetNextRealEle(t.EleFocused,n);break;case r.Keys.ArrowRight:n=!0,t.GetNextRealEle(t.EleFocused,n),l=t.MovetoNextEle(n),l&&t.UpdateOrigElePosInLine();break;case r.Keys.ArrowUp:n=!1,l=t.MovetoNextLine(n);break;case r.Keys.ArrowDown:n=!0,l=t.MovetoNextLine(n);break;case r.Keys.Home:n=!1,l=t.MovetoLineEnd(n);break;case r.Keys.End:n=!0,l=t.MovetoLineEnd(n)}let s=t.EleFocused;return super.GetEdtCtrl().M_EleEvtModel.CheckFormModeFocusedEle(i,s),l}_ChangeSelRange(e,t){let n=t.M_EleEvtModel,r=n.EleClickedWrap.EleFocused;r==n.SelRange.InitSelEle?n.ReInitSelRange():(null==this.act_selrange&&(this.act_selrange=t.M_GetActionByName("SelectRange")),this.act_selrange.Execute([null,r]))}}t.A_MoveCaret=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_OpenDoc=void 0;const r=n(2),i=n(70),l=n(4),s=n(1);class o extends s.XBaseAction{constructor(){super(),this.xdocLoadParam=null,super.OpType=r.ENumActOpType.CtntEdit,this.xdocLoadParam=new i.XDocLoadParam(null,r.ENumXDocPath.LocalFile)}ActName(){return"FileOpen"}Execute(e){this.resMsg.Clear();let t,n=(null==e?0:e.length)<=0?null:e[0],r=n.srcstr,i=null==n.isEditable||n.isEditable,s=null!=n.newPage&&n.newPage,o=n.docId,a=super.GetEdtCtrl();if(l.default.IsNullOrEmpty(r))return a.Focus(),this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName+"命令未指定有效的文件路径。",t=this.resMsg,t;try{this.xdocLoadParam.SrcStr=r,a.MLoadXmlDocument(this.xdocLoadParam,i,o).NewPage=s,this.resMsg.ReturnParams=!0}catch(e){a.M_EdtCustomEvtGrp.OpenError&&a.M_EdtCustomEvtGrp.OpenError(),this.resMsg.ReturnParams=!1,this.resMsg.Ex=e}return t=this.resMsg,t}}t.A_OpenDoc=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_Redo=void 0;const r=n(2),i=n(29),l=n(1);class s extends l.XBaseAction{ActName(){return"Redo"}constructor(){super(),super.OpType=r.ENumActOpType.AnyEdit,super.SetHotKey(i.Keys.Y,i.Keys.Control)}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),r=n.M_UndoMgr;if(r.CanRedo()){r.BulidInfEleHandler(n.M_EleEvtHandler),r.Redo();let e=r.GetLastCursorOper();if(null!=e){n.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.ReplaceEle(e.CursorRedoEle)}super._RefreshPageAndMoveCaret(!0,!0);let i=n.M_EleEvtModel.SelRange;null!=i&&i.IsValid()&&n.M_EdtCaret.HideXCaret(),t=this.resMsg}else t=this.resMsg;return t}}t.A_Redo=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_RemoveChar=void 0;const r=n(2),i=n(59),l=n(0),s=n(16),o=n(79),a=n(175),u=n(105),h=n(94),d=n(4),c=n(106),p=n(181),f=n(399),g=n(360),m=n(13),E=n(95),C=n(55),A=n(239),y=n(1),I=n(6);class S extends y.XBaseAction{constructor(){super(),this.edt_elerange=null,super.OpType=r.ENumActOpType.CtntEdit,this.edt_elerange=new C.EmrEditEleRange}ActName(){return"RemoveChar"}Execute(e){let t;this.resMsg.Clear();const n=super.GetEdtCtrl();if(null==e||e.length<1)this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",super.MessageWarn(),t=this.resMsg;else{const o=n.M_EleEvtModel;let a=Number(e[0]),u=o.SelRange,c=o.EleClickedWrap,f=c.EleFocused;a||(a=127);let g=super.GetEdtLoginUserInfo(),E=new m.UndoGroup,C=a,[A,y]=[null,null];if(null!=u&&u.IsValid())this.edt_elerange.SetEleEvtObjs(o,n.M_EleEvtHandler),[A,y]=super.GetSelRangeOuterEles(o.SelRange),this.edt_elerange.DelSelRange(C,E,this.resMsg);else{let e=this._GetEleToRemove(C,c);if(null==e)return this.resMsg.MsgLevel=5,n.M_EleEvtModel.WorkMode==r.ENumWorkMode.Form&&n.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(f),this.resMsg.MsgStr=this.ActName()+" 命令待删除元素为空",super.MessageWarn(),this.resMsg;if(e instanceof l.XBaseContainer)return this.resMsg.MsgLevel=2,n.M_EleEvtModel.WorkMode==r.ENumWorkMode.Form&&n.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(f),this.resMsg.MsgStr="当前元素中包含元素，不可直接删除",super.MessageWarn(),this.resMsg;if(e instanceof l.XInputBorderEle){let[t,n]=[e.IsStartBorder?e:e.BrotherBorderEle,e.IsStartBorder?e.BrotherBorderEle:e];[A,y]=[s.XDomUtil.GetNextEle(!1,t),s.XDomUtil.GetNextEle(!0,n)]}else if(null==u||!u.IsValid()){let e=new i.ClickedElementWrapper(!0);e.CopyFrom(c),[A,y]=super.GetFocusedOuterEles(c);let t=e.MovetoNextEle(127==C);127==C?t&&(y=e.EleFocused):e.MovetoNextEle(!1)&&(A=e.EleFocused)}if(!h.EditorWorkModeUtil.ChkDelRuleForWorkMode(e,o.WorkMode,g)){let t=e.GetInnerText(!1);return d.default.IsNullOrEmpty(t)&&(t=e.GrpID),c.MovetoNextEle(127==C),n.M_EleEvtModel.WorkMode==r.ENumWorkMode.Form&&n.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(f),n.M_EleEvtModel.MoveCaretByCursorEle(!0),this.resMsg.MsgLevel=5,this.resMsg.MsgStr="无法删除，当前元素不可删除",super.MessageWarn(),this.resMsg}if(e instanceof l.XParagraphFlag){let t=c.LineEleIxFocused.Line.RelEleParagraph;const n=t.EleStyle;if(8==C&&0!=n.LeftIndent||0!=n.FirstLineIndent){let e=new p.EleStyleUndo(t,p.ENumSubset.Paragraph);n.LeftIndent=0,n.FirstLineIndent=0,e.ReadNewStyle(),E.AddItem(e),t.NotifyLayoutChanged(!0,!1)}else this._RemoveCrEleHandler(C,e,c,E)}else this._RemoveCharHandler(C,e,o,E)}null==E.CursorUndoEle&&(E.CursorUndoEle=f),E.CursorRedoEle=c.EleFocused,super._AddUndoItem(E),null!=A&&null!=y||super._RefreshPageAndMoveCaret(!0,!0);let S=!1;null!=e&&1==e[1]&&(S=!0),S||(f.OwnerDocPanel.PagePanelTp==I.ENumPagePanelTp.Body?(null==A&&(A=f.OwnerDocPanel.ChildEleList.Get(0)),super._RefreshPageAndMoveCaretBetweenEle(A,y,!0)):super._RefreshPageAndMoveCaretBetweenEle(null,null,!0)),t=this.resMsg}return t}_GetEleToRemove(e,t){let n=t.EleFocused;8==e&&(n=t.GetNextEle(!1));const r=8!=e;return n=t.GetNextRealEle(n,r),n}_RemoveCrEleHandler(e,t,n,r){let i,l=t.OwnerLine,s=t.Parent,o=n.LineEleIxFocused,a=o.Line.RelEleParagraph;if(t==s.GetLastChildEle())i=!1;else{let n=l.ElementCnt,h=s.GetChildInx(t);this._DoRemove_DstEle(e,t,r);let d=t.Document.GetOutlineList();if(null!=t){if(d.Remove(t,!0)){let e=new f.OutlineAddDelUndo(t,d,!1);r.AddItem(e)}}if(this._TryRemoveLabelSernoAfterCrEle(h,s,r),n>=2){let n=o.RefreshEleObj(!1),i=0;null!=n.OwnerLine&&(i=n.OwnerLine.ElementCnt);let l,s=a.OutLineLevel;if(i>=2)if(127==e){let e=a.OwnerLine.NextLine&&a.OwnerLine.NextLine.RelEleParagraph;l=new p.EleStyleUndo(e,p.ENumSubset.Paragraph);let t=e.EleStyle;e&&t instanceof u.XParagraphFlagStyle&&t.CopyOnlyParaStyleFrom(a.EleStyle)}else{let e;l=new p.EleStyleUndo(a,p.ENumSubset.Paragraph),a.EleStyle instanceof u.XParagraphFlagStyle&&(e=a.EleStyle),e.CopyOnlyParaStyleFrom(t.EleStyle)}else l=new p.EleStyleUndo(a,p.ENumSubset.All),a.EleStyle.CopyFrom(t.EleStyle,!1);l.ReadNewStyle(),r.AddItem(l),d.ChangeOutlineLv(a,s);let h=new g.OutlineLvUndo(a,s,d);r.AddItem(h),a.NotifyLayoutChanged(!0,!1)}i=!0}return i}_RemoveCharHandler(e,t,n,r){if(n.EleClickedWrap.LineEleIxFocused.RefreshEleObj(!1),null!=t){if(null!=t.Parent){this._DoRemove_TryXInput(e,t,n,r)||this._DoRemove_DstEle(e,t,r)}}}_DoRemove_DstEle(e,t,n){const i=super.GetEdtCtrl();let l=i.M_EleEvtModel,a=i.M_EleEvtHandler,u=l.EleClickedWrap;if(s.XDomUtil.IsInnerLabelOfXInput(t,!1)||s.XDomUtil.IsBkgTextOfXInput(t))u.MovetoNextEle(127==e);else{let h,d=t.Parent;d instanceof o.XStringEle&&(h=d);let c,p=s.XDomUtil.GetParentXInput(t,!0);const f=l.WorkMode==r.ENumWorkMode.App||l.WorkMode==r.ENumWorkMode.Form,g="XParagraphFlag"==t.EleTypeName||"XTextLabelElement"==t.EleTypeName,m=i.M_EdtCustomEvtGrp.AppKeepTrace;if(c=f&&!g&&m?this._Remove_OneEle_AsTrace_(e,t,l,n):this._Remove_OneEle_(e,t,u,n),c){let t=!0;if(null!=p&&null!=p.StartEle&&null!=p.StartEle.EleStyle&&p.StartEle.EleStyle.DeleterIndex>-1){p=null;const e=u.EleFocused;p=s.XDomUtil.GetParentXInput(e,!0)}s.XDomUtil.TrySwitchXInputToEmpty(e,t,p,u,n),a.OnTextChanged(h)}}}_TryRemoveLabelSernoAfterCrEle(e,t,n){let r,i=t.GetChildEle(e);if(i instanceof l.XLabelSerno||(i=null),null==i)r=!1;else{t.RemoveChild(e);let l=new c.EleAddDelUndo(i,e,!1);n.AddItem(l),r=!0}return r}_DoRemove_TryXInput(e,t,n,i){if(null==t||!(t instanceof l.XInputBorderEle))return!1;if(null==t.Parent||!(t.Parent instanceof l.XBaseInputEle))return!1;let o=n.EleClickedWrap,a=t.Parent,u=t,h=u.IsStartBorder&&8==e||!u.IsStartBorder&&127==e;if(h||(h=s.XDomUtil.HasContent(a,!1),h=h&&a.UserEditable),h){let t=o.EleFocused;o.MovetoNextEle(127==e);let n=o.EleFocused;return super.GetEdtCtrl().M_EleEvtModel.CheckFormModeFocusedEle(t,n),!0}t=a;let d,c=a.Parent;if(d=n.WorkMode!=r.ENumWorkMode.Design?this._Remove_OneEle_AsTrace_(e,t,n,i):this._Remove_OneEle_(e,t,o,i),!d)return!1;return s.XDomUtil.TrySwitchXInputToEmpty(e,!0,c,o,i),E.EmrInnerUtil.UpdateXDocXinputCache(t),!0}_Remove_OneEle_AsTrace_(e,t,n,i){let o=n.EleClickedWrap,a=s.XDomUtil.GetUserHistoryWrap(t),u=null==a?null:a.AddHist,h=null==u?null:u.UserInfo;null!=a&&a.Clear();let d,c=super.GetEdtLoginUserInfo();if(A.A_AddEdtHistory.CanDelWithHist(c))if(null==h||u.IsPersisted||h.UsrId!=c.UsrId){let a=n.AddEdtHistAct.Execute3(r.ENumEdtType.Delete,i,[t]),u=null==a||!a.IsWarnMsg(),h=!0;if(t instanceof l.XBaseContainer){let n=t.Parent,r=n.GetChildInx(t),i=null;127==e?i=s.XDomUtil.GetNewCursorEle(n,r,!0):h||(i=t.GetFirstChildBaseEle(!0)),o.LineEleIxFocused.ReplaceEle(i)}else 127==e?(o.MovetoNextEle(!0),t.IsLayoutValid=!1):t.IsLayoutValid=!1;d=u}else{d=this._Remove_OneEle_(e,t,o,i)}else d=!1;return d}_Remove_OneEle_(e,t,n,r){let i;if(e<=0||null==t)i=!1;else{let e=super.GetXDocFocused().GetUserHistoryList();const l=t.Parent;let o=null;null!=e&&(o=a.XHistoryUtil.GetPNEles_OnEleRange(t,t));let u=l.RemoveChild(t);if(u<0)i=!1;else{if(null!=n){let e=s.XDomUtil.GetNewCursorEle(l,u,!0);n.LineEleIxFocused.ReplaceEle(e)}if(a.XHistoryUtil.RemoveHistory_OnEle(t,r),null!=e){let t=null,n=null;null!=o&&(t=s.XDomUtil.GetUserHistoryWrap(o[0]),n=s.XDomUtil.GetUserHistoryWrap(o[1])),e.TryMergeArroundHistWrap(t,n,r)}let h=new c.EleAddDelUndo(t,u,!1);r.AddItem(h),i=!0}}return i}}t.A_RemoveChar=S,S.ASCII_Backspace=8,S.ASCII_Delete=127},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_RemoveCurrentEmptyLine=void 0;const r=n(6),i=n(16),l=n(400),s=n(1);class o extends s.XBaseAction{ActName(){return"RemoveCurrentEmptyLine"}Execute(e){let t,n=super.GetEdtCtrl(),l=n.M_DocumentFocused,s=n.M_EleEvtModel.EleClickedWrap,o=s.EleFocused;if(null==o)t=this.resMsg;else{let e=o.OwnerLine;if(null==e)t=this.resMsg;else{let n=l.GetPagePanel(r.ENumPagePanelTp.Body),a=o.Equals(n.GetLastChildEle());if(this._RemoveEmptyLine(n,e)){if(a){let e=i.XDomUtil.GetNextEle(!1,o);s.LineEleIxFocused.ReplaceEle(e),super._RefreshPageAndMoveCaret(!0,!0)}else{let t=this._FindNewFocusEle(e,l);s.LineEleIxFocused.ReplaceEle(t),super._RefreshPageAndMoveCaret(!0,!0)}t=this.resMsg}else t=this.resMsg}}return t}_RemoveEmptyLine(e,t){return l.RemoveEmptyLineUtil.TryClearCurrLine(t,e)}_FindNewFocusEle(e,t){let n;if(null==e)n=t.GetFirstBaseChild(!0);else{let t;for(t=e;null!=t;t=t.NextLine){let e=t.FirstElement;if(e&&!e.IsRemoved)break}if(null==t){t=e.Container.GetEndLine()}n=t.FirstElement}return n}}t.A_RemoveCurrentEmptyLine=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_RemoveEmptyLines=void 0;const r=n(2),i=n(6),l=n(0),s=n(400),o=n(1),a=n(336),u=n(38);class h extends o.XBaseAction{ActName(){return"RemoveEmptyLines"}constructor(){super(),super.OpType=r.ENumActOpType.CtntEdit}Execute(e){this.resMsg.Clear();try{const t=super.GetEdtCtrl();let n=t.M_EleEvtModel,r=null,s=n.EleClickedWrap,o=s.EleFocused;null!=o&&(r=o.OwnerLine);let a=t.M_DocumentFocused,h=a.GetPagePanel(i.ENumPagePanelTp.Body);const d=e[0],c=d.docId,p=d.cId,f=d.xId;let g=!1;if(c&&"string"==typeof c){const e=t.All_Document;for(let t=0;t<e.length;t++){const n=e[t];n.DocID==c&&(a=n)}}if(p&&"string"==typeof p){h=a.GetPagePanel(i.ENumPagePanelTp.Body);let e=new u.List;h.GetChildrenByCptId(p,!0,e);const t=e.ToArray();let n=0;for(;n<t.length;){const e=t[n];if(e instanceof l.XBaseContainer){const t=this._RemoveEmptyLine(e);t&&(g=t,r=e.OwnerLine)}n++}h=null}else if(f&&"string"==typeof f){h=a.GetPagePanel(i.ENumPagePanelTp.Body);let e=new u.List;h.GetChildrenByXID(f,!0,e);const t=e.ToArray();let n=0;for(;n<t.length;){const e=t[n];if(e instanceof l.XBaseContainer){const t=this._RemoveEmptyLine(e);t&&(g=t,r=e.OwnerLine)}n++}h=null}if(this._RemoveEmptyLine(h)||g){let e=this._FindNewFocusEle(r,a);s.LineEleIxFocused.ReplaceEle(e),super._RefreshPageAndMoveCaret(!0,!0)}this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}_RemoveEmptyLine(e){let t;if(null==e)t=!1;else{let n=e instanceof a.XTextTableRow,r=!1;if(!n){let t=e.GetLinesIter();for(;t.MoveNext();){let n=t.Current,i=s.RemoveEmptyLineUtil.TryClearCurrLine(n,e);r=r||i}}let i=e.GetChildIter();for(;i.MoveNext();){let e=i.Current instanceof l.XBaseContainer?i.Current:null;this._IsEleInLine(e)&&(r=this._RemoveEmptyLine(e)||n)}t=r}return t}_IsEleInLine(e){let t;if(null==e)t=!1;else{let n=null;for(let t=e;null!=t&&(n=t.OwnerLine,null==n);t=t.Parent);t=null!=n}return t}_FindNewFocusEle(e,t){let n;if(null==e)n=t.GetFirstBaseChild(!0);else{let t;for(t=e;null!=t&&t.ElementCnt>0;t=t.NextLine){let e=t.FirstElement;if(e&&!e.IsRemoved)break}if(null==t||!(t.ElementCnt>0)){t=e.Container.GetEndLine()}n=t.FirstElement}return n}}t.A_RemoveEmptyLines=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_RightProperty=void 0;const r=n(401),i=n(40),l=n(0),s=n(150),o=n(347),a=n(16),u=n(174),h=n(230),d=n(75),c=n(45),p=n(20),f=n(167),g=n(228),m=n(1),E=n(80),C=n(364),A=n(32);class y extends m.XBaseAction{ActName(){return"RightProperty"}Execute(e){if(this.resMsg.Clear(),e.length<1)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",super.MessageWarn(),null;let t=e[0]instanceof s.XBaseElement?e[0]:null;if(null==t&&(t=m.XBaseAction.GetCurEle()),null==t)return this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+"右键时当前位置没有元素",super.MessageWarn(),this.resMsg;m.XBaseAction.SetCurEle(t);let n="";n=e&&e[1]?e[1]:t.EleTypeName;let r=!0;switch(n){case"XImage":this.ImageEleRightProperty(t);break;case"XBarcodeField":this.BarCodeRightProperty(t);break;case"XMedicalExpressionField":this.MedicalExpressionEleRightProperty(t);break;case"XPageInfo":this.PageNumInfoRightProperty(t);break;case"HorizontalLine":this.SpliteEleRightProperty(t);break;case"Shape":this.ShapeProperty(t);break;case"XButtonEle":this.BtnProperty(t);break;case"XTextLabelElement":this.TextLabelElementProperty(t);break;case"XTextRadioBox":case"XTextCheckBox":case"XLableInputBorder":this.InputFieldEleRightProperty(t);break;case"XTextTableCell":this.TextTableCellProperty(t);break;case"XInputField":r=!1,t=a.XDomUtil.GetParentXInput(t,!1);break;case"XTextTable":case"XTextTableRow":r=!1,t=p.XTextTableUtil.GetCursorTextTable(t);break;default:r=!1;let e=a.XDomUtil.GetParentXInput(t,!1);null==e&&(e=p.XTextTableUtil.GetCursorTextTable(t)),null!=e&&(t=e,n=t.EleTypeName)}if(r)return this.resMsg;switch(n){case"XInputField":this.InputFieldEleRightProperty(t);break;case"XTextTable":case"XTextTableRow":this.TextTableProperty(t);break;default:this.resMsg.MsgLevel=5,this.resMsg.MsgStr="右键属性时找不到对应元素的方法",super.MessageWarn()}return this.resMsg}TextLabelElementProperty(e){if(null!=e&&e instanceof A.XTextLabelElement){let t=["title",{inpMrtDeSectionNo:e.TitleID,inpMrtDeSectionName:e.EleText,inpMrtDeSectionDispName:e.Text,inpMrtDeSectionLevel:e.TitleLevel,isDel:e.IsDeleteFlag,inpMrtDeSectionDesc:e.Description,saveFlag:e.IsSaveFlag,positionFlag:e.FixPosition,hideFlag:e.Attr_FgHide,requireFlag:e.IsRequire,printFlag:e.IsPrintFlag,conceptID:e.CptID,sexJudge:e.Gender,maxAge:e.MaxAge,minAge:e.MinAge,extendAttr1:e.ExtendAttr1,levelTerm:e.LevelTerm,editbleFlag:e.IsEditble,maxLength:e.MaxLength,minimumLength:e.MinLength}];this.resMsg.ReturnParams=t;let n=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof n&&n(t)}}TextTableProperty(e){let t=p.XTextTableUtil.GetCursorTextTable(e);if(null!=t&&t instanceof c.XTextTable){let e=["tableProperty",p.XTextTableUtil.buildPropertiesInfo(t)];this.resMsg.ReturnParams=e;let n=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof n&&n(e)}}TextTableCellProperty(e){let t=p.XTextTableUtil.GetCursorCell(e);if(null!=t&&t instanceof l.XTextTableCell){let e=["tableCellProperty",p.XTextTableUtil.buildPropertiesInfo(t)];this.resMsg.ReturnParams=e;let n=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof n&&n(e)}}BtnProperty(e){if(null!=e&&e instanceof o.XButtonEle){let t=["insertButton",e.BtnInfo];this.resMsg.ReturnParams=t;let n=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof n&&n(t)}}ShapeProperty(e){if(null!=e&&e instanceof h.XShapeEle){let t=["insertShapePic",e.ShapeInfo];this.resMsg.ReturnParams=t;let n=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof n&&n(t)}}BarCodeRightProperty(e){if(null!=e&&e instanceof g.XCodeEle){const t=e.BarcodeInfo;let n="";t.CodeChoiceStyle==f.CodeType.Barcode?n="insertShapeCode":t.CodeChoiceStyle==f.CodeType.QRcode&&(n="insertQRCode");let r=[n,t];this.resMsg.ReturnParams=r;let i=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof i&&i(r)}}MedicalExpressionEleRightProperty(e){if(null!=e&&e instanceof l.XMedicalExpressionField){let t=["insertMedicalExpression",e.ExpressionFormInfo];this.resMsg.ReturnParams=t;let n=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof n&&n(t)}}SpliteEleRightProperty(e){if(null!=e&&e instanceof l.XSpliteLineEle){let t=["insertTransverseLine",e.GetSpliteLineInfo()];this.resMsg.ReturnParams=t;let n=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof n&&n(t)}}ImageEleRightProperty(e){if(null!=e&&e instanceof d.XImageEle){let t=["insertImage",e.GetImageEleInfo()];this.resMsg.ReturnParams=t;let n=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof n&&n(t)}}PageNumInfoRightProperty(e){if(null!=e&&e instanceof u.XPageNumEle){let t=["insertPagination",C.InsertPageNumbersInfo.BuildPageNumInfo(e)];this.resMsg.ReturnParams=t;let n=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof n&&n(t)}}InputFieldEleRightProperty(e){let t;if(e instanceof l.XBaseChoiceEle){if(null==this.AlertForm_ChoiceGroup(e))return t=!1,t}else{let n=a.XDomUtil.GetParentXInput(e,!0);if(null==n)return t=!1,t;this.AlertForm(n)}return t=!0,t}AlertForm(e){let t=null,n=E.XInputUtil.GetInstance().BulidEleInfo_InputField(e);switch(e.InputType){case i.EleTypeEnum.SingleChoiceDropEle:t=["radio",n];break;case i.EleTypeEnum.MoreChoiceDropEle:t=["checkbox",n];break;case i.EleTypeEnum.HaveNoEle:t=["haveornot",n];break;case i.EleTypeEnum.TextEle:t=["text",n];break;case i.EleTypeEnum.NumEle:t=["number",n];break;case i.EleTypeEnum.DateEle:t=["date",n];break;case i.EleTypeEnum.SqlEle:t=["link",n];break;case i.EleTypeEnum.NormalEle:t=["element",n];break;case i.EleTypeEnum.PhaseEle:t=["datagroup",n];break;case i.EleTypeEnum.DiagnosisEle:t=["diagnose",n];break;case i.EleTypeEnum.SignEle:t=["signature",n]}this.resMsg.ReturnParams=t;let r=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;return"function"==typeof r&&r(t),n}BulidGroupInfo(e){let t=new r.XEleGroupInfo;return t.XID=e.XID,t.GrpID=e.GrpID,t.Name=e.Name,t.TipText=e.EleToolTip,t.SourceName=e.SourceName,t.PropName=e.PropertyName,t.CanDel=e.Deletable,t.EleShowText=e.Caption,t.EleValue=e.CheckedValue,t.IsShowText=e.IsShowRightText,t.OnlyPrintCheckedItem=e.OnlyPrintCheckedItem,t.IsTextRightShow=e.TextShowRight,t.IsHide=e.Attr_FgHide,t.IsPrint=e.IsPrint,t.Grp_IsStrongShow=e.Grp_StrongShow,t.BaseChoiceShowStyle=e.BaseChoiceShowStyle,t.IsMustChoose=e.IsMustCheck,t.VAlign=e.VAlign_Mark,t.ValueCode_de=e.GetAttribute("DeValueCode"),t.Name_de=e.GetAttribute("DecodeName"),t.conceptDomainCode=e.CptID,t.ExtendAttr1=e.ExtendAttr1,t.LackEllipsisvalue=e.LackEllipsisvalue,t.DynamicData=e.DynamicData,t.QuoteSource=e.QuoteSource,t.QuoteTarget=e.QuoteTarget,null!=e.Text_Expression&&null!=e.Text_Expression&&(t.Text_Expression=encodeURIComponent(e.Text_Expression)),t}AlertForm_ChoiceGroup(e){let t=null,n=this.BulidGroupInfo(e);t=e instanceof l.XRadioBoxEle?["radiogroup",n]:["checkboxgroup",n],this.resMsg.ReturnParams=t;let r=super.GetEdtCtrl().M_EdtCustomEvtGrp.RightProperty;"function"==typeof r&&r(t)}}t.A_RightProperty=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_Undo=void 0;const r=n(2),i=n(29),l=n(1);class s extends l.XBaseAction{ActName(){return"Undo"}constructor(){super(),super.OpType=r.ENumActOpType.AnyEdit,super.SetHotKey(i.Keys.Z,i.Keys.Control)}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl(),n=t.M_UndoMgr;if(!n.CanUndo())return this.resMsg;n.BulidInfEleHandler(t.M_EleEvtHandler),n.Undo();let r=n.GetLastCursorOper();if(null!=r){const e=r.CursorUndoEle;if(null!=e.Parent){if(e.Parent.GetChildInx(e)<0)return this.resMsg}t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.ReplaceEle(e)}super._RefreshPageAndMoveCaret(!0,!0);let i=t.M_EleEvtModel.SelRange;return null!=i&&i.IsValid()&&t.M_EdtCaret.HideXCaret(),this.resMsg}}t.A_Undo=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ZoomIn=void 0;const r=n(251);class i extends r.A_ZoomBase{ActName(){return"ZoomIn"}Execute(e){return super.Execute([!0])}}t.A_ZoomIn=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ZoomOut=void 0;const r=n(251);class i extends r.A_ZoomBase{ActName(){return"ZoomOut"}Execute(e){return super.Execute([!1])}}t.A_ZoomOut=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ZoomPctStr=void 0;const r=n(4),i=n(251);class l extends i.A_ZoomBase{ActName(){return"ZoomPctStr"}Execute(e){let t=(null==e?0:e.length)<=0?null:e[0];return r.default.IsNullOrEmpty(t)&&(t="100%"),super.Execute([t])}}t.A_ZoomPctStr=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdateElement=void 0;const r=n(0),i=n(16),l=n(13),s=n(60),o=n(1),a=n(3),u=n(87),h=n(42),d=n(401),c=n(80),p=n(89),f=n(40),g=n(36);class m extends o.XBaseAction{ActName(){return"UpdateElement"}Execute(e){let t;e.length<1&&(this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",super.MessageWarn(),t=null);let n=o.XBaseAction.GetCurEle();if(null==n)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 未选中元素",super.MessageWarn(),this.resMsg;let m=e[0];const E=null==m||"{}"==JSON.stringify(m),C=e[1];let A=!1;if(null!=m.displayStyle&&null!=m.displayStyle&&("RadioBox"==m.displayStyle||"CheckBox"==m.displayStyle)||n instanceof r.XBaseChoiceEle){let e=n instanceof r.XBaseChoiceEle?n:null;if(null!=e){let t=new d.XEleGroupInfo;t.GrpID=m.elementCode,t.Name=m.elementName,t.Name_de=m.dataEmementName,t.ValueCode_de=m.dataEmementCode,t.TipText=m.tooltipText,t.QuoteSource=1==m.quoteSource,t.QuoteTarget=1==m.quoteTarget,t.SourceName=m.sourceName,t.PropName=m.attributeName,t.BaseChoiceShowStyle=m.displayStyle,t.VAlign=m.verticalAlign,t.CanDel=m.deleteFlag,t.IsHide=m.hideFlag,t.IsPrint=m.printFlag,t.conceptDomainCode=m.conceptDomainCode,t.IsMustChoose=m.chooseFlag,t.EleValue=m.valueMean,t.ExtendAttr1=m.extendAttr1,t.LackEllipsisvalue=m.defaultValue,t.DynamicData=m.dynamicData,t.EleShowText=m.valueText,t.IsShowText=m.textShow,t.OnlyPrintCheckedItem=!0===m.onlyPrintCheckedItem,t.IsTextRightShow=m.textRightShow,t.Grp_IsStrongShow=m.groupStrongShow,null!=m.expressionInput&&null!=m.expressionInput&&(t.Text_Expression=decodeURIComponent(m.expressionInput),A=!0),h.XInputFactory.GetInstance().UpdateChoiceEle(t,e)}}else if(!E){let e=i.XDomUtil.GetParentXInput(n,!0),r=c.XInputUtil.GetInstance().BulidEleInfo_InputField(e);void 0!==m.elementCode&&(r.Id_mr_de=m.elementCode),void 0!==m.elementName&&(r.Name=m.elementName),void 0!==m.dataEmementName&&(r.Name_de=m.dataEmementName),void 0!==m.conceptDomainCode&&(r.conceptDomainCode=m.conceptDomainCode),void 0!==m.conceptDomainCode&&(r.CptID=m.conceptDomainCode),void 0!==m.dataEmementCode&&(r.ValueCode_de=m.dataEmementCode),void 0!==m.labelText&&(r.Text_label=m.labelText),void 0!==m.suffixText&&(r.Suffix_label=m.suffixText),void 0!==m.showDialog&&(r.ShowDialog=m.showDialog),void 0!==m.backgroundText&&(r.Text_background=m.backgroundText),void 0!==m.tooltipText&&(r.Text_tip=m.tooltipText),r.QuoteSource=1==m.quoteSource,r.QuoteTarget=1==m.quoteTarget,void 0!==m.sourceName&&(r.Name_source=m.sourceName),void 0!==m.attributeName&&(r.Name_property=m.attributeName),void 0!==m.defaultText&&(r.DefaultValue=m.defaultText),void 0!==m.triggerAction&&(r.InputEventName=m.triggerAction),void 0!==m.activateWay&&(r.Activation_Mode_Key=m.activateWay),void 0!==m.editorEventActiveMode&&(r.EditorEventActiveMode=m.editorEventActiveMode),null!=m.expressionInput&&null!=m.expressionInput&&(r.Text_Expression=decodeURIComponent(m.expressionInput),A=!0),void 0!==m.encryptFlag&&(r.Fg_encrypt=m.encryptFlag),void 0!==m.deleteFlag&&(r.Fg_delete=m.deleteFlag),void 0!==m.borderFlag&&(r.Fg_border=m.borderFlag),void 0!==m.quoteFlag&&(r.Fg_quote=m.quoteFlag),void 0!==m.sourceFlag&&(r.Fg_qs=m.sourceFlag),void 0!==m.emptyFlag&&(r.CanEmpty=m.emptyFlag),void 0!==m.sensitiveFlag&&(r.IsSensitiveInfo=m.sensitiveFlag),void 0!==m.hideFlag&&(r.Fg_hide=m.hideFlag),void 0!==m.placeNum&&(r.Occupying_Num=m.placeNum),void 0!==m.underlineFlag&&(r.IsStartUp_UnderLine=m.underlineFlag),void 0!==m.elementUnit&&(r.Text_unit=m.elementUnit),void 0!==m.elementUnit&&(r.EditorMode=m.editorMode),void 0!==m.decimalNum&&(r.Nu_digit=m.decimalNum),void 0!==m.maxValue&&(r.Nu_max=m.maxValue),void 0!==m.minValue&&(r.Nu_min=m.minValue),void 0!==m.maxValue?r.CheckMaxValue=""!=m.maxValue:r.CheckMaxValue=!1,void 0!==m.minValue?r.CheckMinValue=""!=m.minValue:r.CheckMinValue=!1,void 0!==m.surePrefix&&(r.Su_des=m.surePrefix),void 0!==m.denyPrefix&&(r.Ne_des=m.denyPrefix),void 0!==m.addFlag&&(r.IsAddCallBack=m.addFlag),void 0!==m.defaultCurrentTimeFlag&&(r.DefaultCurrentTimeFlag=m.defaultCurrentTimeFlag),void 0!==m.printCurrentTimeFlag&&(r.PrintCurrentTimeFlag=m.printCurrentTimeFlag),void 0!==m.startBorderFlag&&(r.CanBeInLine_StartBorder=m.startBorderFlag),void 0!==m.endBorderFlag&&(r.CanBeInLine_EndBorder=m.endBorderFlag),void 0!==m.maxLength&&(r.Lg_max=m.maxLength),void 0!==m.minimumLength&&(r.Lg_min=m.minimumLength),void 0!==m.dateFormat&&(r.Dt_format=m.dateFormat),void 0!==m.intoTime&&(r.IsRefreshSysTime=m.intoTime),void 0!==m.echoField&&(r.Sql_WriteBack_PropName=m.echoField),void 0!==m.sqlSentence&&(r.SqlText=m.sqlSentence),void 0!==m.printFlag&&(r.IsPrint=m.printFlag),void 0!==m.skipFlag&&(r.IsDisSkip=m.skipFlag),void 0!==m.extendAttr1&&(r.ExtendAttr1=m.extendAttr1),void 0!==m.defaultValue&&(r.LackEllipsisvalue=m.defaultValue),void 0!==m.dynamicData&&(r.DynamicData=m.dynamicData),void 0!==m.customAttribute&&(r.CustomAttribute=m.customAttribute),void 0!==m.sexJudge&&(r.Gender=m.sexJudge),void 0!==m.maxAge&&(r.MaxAge=m.maxAge),void 0!==m.minAge&&(r.MinAge=m.minAge);let o="boolean"==typeof m.readFlag?!m.readFlag:"false"==m.readFlag;void 0!==m.readFlag&&(r.Fg_edit=o);let d=!1;switch(e.InputType){case f.EleTypeEnum.DiagnosisEle:void 0!==m.readFlag&&(r.IsAllowKeyInput=!o),void 0!==m.diagnoseType&&(r.DiagnoseType=m.diagnoseType),void 0!==m.arrangement&&(r.Arrangement=m.arrangement),void 0!==m.showWay&&(r.ShowWay=m.showWay),void 0!==m.splitChar&&(r.SplitChar=m.splitChar),null!=e.ElementInfo&&(e.ElementInfo=r),d=!0;break;default:null!=m.elementType&&(r.Code_mrdetp=m.elementType),void 0!==m.keyFlag&&(r.IsAllowKeyInput=m.keyFlag),void 0!==m.hasSearch&&(r.HasSearch=m.hasSearch)}let p=new a.List,E=m.valueList;if(null!=E&&null!=E){for(let e=0;e<E.length;e++){let t=new u.SelEleItemInfo,n=E[e].Value,r=E[e].Key,i=E[e].Level,l=E[e].GroupNum,s=E[e].ChildEleItems;if(null!=s&&null!=s)for(let e=0;e<s.length;e++){let n=new u.SelEleItemInfo,r=s[e].Value,i=s[e].Key,l=s[e].Level;n.Value=r,n.Key=i,n.Level=l,t.ChildEleItems.Add(n)}t.Value=n,t.Key=r,t.Level=i,t.Index=e+1,t.GroupNum=l,p.Add(t)}r.Valuelist=p}let I=m.elementUnitList;if(I&&I.length>0){for(let e=0;e<I.length;e++){let t=new u.SelEleItemInfo,n=I[e].Value,r=I[e].Key;t.Value=n,t.Key=r,t.Index=e+1,p.Add(t)}r.Text_unitList=p}if(null==r)return t=!0,t;let S=super.GetEdtCtrl().M_EleEvtHandler,_=new l.UndoGroup;e.SetUnDoGroup(_),e.UpdateEleInfo(r),C&&!e.InnerValue&&e.UpdateInnerText(null==m.defaultText?"":m.defaultText);e.BulidQrCode(s.EmrApiUtil.GetEmrEditWrapperCtrl(super.GetEdtCtrl()).DocWrapper,null,e.BulidCodeRightNow);super._AddUndoItem(_),_=null,e.SetUnDoGroup(_);let w=e.MinSpaceNumber;if(g.StringUtils.IsNullOrEmpty(e.InnerValue.trim())){if(w>0){let t="";m.defaultText&&(t=m.defaultText);for(var y=t.length;y<w;y++)t+=" ";e.UpdateInnerText(t)}else m.defaultText?e.UpdateInnerText(m.defaultText):e.UpdateInnerText("");let t=e.GetInnerTextXStrEle();S.OnTextChanged(t)}else{if(w>0){let t="";m.defaultText&&(t=m.defaultText);for(y=t.length;y<w;y++)t+=" ";e.UpdateInnerText(t)}else m.defaultText&&e.UpdateInnerText(m.defaultText);let t=e.GetInnerTextXStrEle();S.OnTextChanged(t)}C||this.UpdateMoveCaretEle(e),d||h.XInputFactory.GetInstance().GetCommonEle(r,e)}return A&&p.MsgRegisterHandler.RegisterExpressionToMsgBus(super.GetEdtCtrl().M_DocumentFocused),super._RefreshPageAndMoveCaret(!0),t}UpdateMoveCaretEle(e){let t=super.GetEdtCtrl();if(e instanceof r.XBaseInputEle){let n=e.GetLastChildEle(),r=i.XDomUtil.GetNextEle(!0,n);t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(r),t.M_EleEvtModel.MoveCaretByCursorEle(!0)}}}t.A_UpdateElement=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdateGraph=void 0;const r=n(0),i=n(1),l=n(107),s=n(133),o=n(7),a=n(179),u=n(2),h=n(365);class d extends i.XBaseAction{ActName(){return"UpdateGraph"}Execute(e){let t;if(this.resMsg.Clear(),e.length<1)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",this.rn;let n=e[0];if(null==n||"{}"==JSON.stringify(n))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令参数0中的map为空",this.rn;const r=i.XBaseAction.GetCurEle();if(null==r)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 未选中元素",this.rn;switch(n.refreshStatus=0,t=n.insertType,null==t&&(t=n[2]),t){case"BarCode":const e=r,i=l.InsertElementBack.getBarCodeInfo(n,e.BarcodeInfo);if(0==n.refreshStatus)break;const s=l.InsertElementBack.getBarCodeType(i.CodeStyleStr);this.UpdateBarCodeEle(s,e,i);break;case"QRCode":const o=r,a=l.InsertElementBack.getQRCodeInfo(n,e.BarcodeInfo);if(0==n.refreshStatus)break;this.UpdateQRCodeEle(o,a);break;case"spliteLine":let u=l.InsertElementBack.getSpliteLineInfo(n);this.UpdateSpliteLineEle(r,u);break;case"XPageInfo":this.UpdatePageNumInfoEle(r,n);break;case"Shape":let h=l.InsertElementBack.getShapeInfo(n);this.UpdateShapInfoEle(r,h);break;case"XButtonEle":let d=l.InsertElementBack.getBtnInfo(n);this.UpdateButtonEle(r,d);break;case"XMedicalExpressionField":let c=l.InsertElementBack.getMedExpressionInfo(n);this.UpdateMedicalExpressionEle(r,c,n);break;default:this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令无insertType='"+t+"'的方法"}return 0==n.refreshStatus&&(this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中insertType='"+t+"'无属性需更新"),this.resMsg.MsgStr||n.refreshStatus>1&&this.GetEdtCtrl().MRefreshDocView(),this.rn}get rn(){return i.XBaseAction.SetCurEle(null),this.resMsg.MsgStr&&this.resMsg.MsgLevel>=2&&super.MessageWarn(),this.resMsg.IsReturnMsg?this.resMsg:null}UpdateMedicalExpressionEle(e,t,n){let i=e instanceof r.XMedicalExpressionField?e:null;if(null!=i){if("PainIndex"==n.formulaType)return i.MedExpSettingInfo=t,void i.NotifyLayoutChanged(!0,!1);i.InitMeicalExpression(t,null,!0)}}UpdateButtonEle(e,t){let n=e instanceof r.XButtonEle?e:null;null!=n&&(n.InitByBtnInfo(t),n.InitEleSize(),n.NotifyLayoutChanged(!0,!1),this.GetEdtCtrl().MRefreshDocView())}UpdateShapInfoEle(e,t){let n=e instanceof r.XShapeEle?e:null;null!=n&&(h.XExtendEleUtil.ReInitShapeEleByInfo(n,t),n.NotifyLayoutChanged(!0,!1))}UpdatePageNumInfoEle(e,t){let n=e instanceof r.XPageNumEle?e:null;if(null!=n){(new a.PageNumFormWrap).ShowPageNumForm(n,this.GetEdtCtrl(),u.ENumWorkMode.Design,t)&&this._RefreshPageAndMoveCaret(!0)}}UpdateSpliteLineEle(e,t){let n=e instanceof r.XSpliteLineEle?e:null;null!=n&&(n.InitSpliteLineEle(t,n),n.NotifyLayoutChanged(!0,!1))}UpdateBarCodeEle(e,t,n){let r=s.XCodeUtil.GetInstance().BuildBarcode(e,n.Content,n.BarcodeLineWidth,n.BarcodeLineHeight,o.Color.Black,o.Color.White);null!=r?(n.GetEditBarcodeImage=r.Image,t.InitCodeEle(n),t.NotifyLayoutChanged(!0,!1)):(this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中条形码的文本内容为空")}UpdateQRCodeEle(e,t){let n=s.XCodeUtil.GetInstance().BuildQRcode(t.Content);t.GetEditBarcodeImage=n,e.InitCodeEle(t),e.NotifyLayoutChanged(!0,!1)}}t.A_UpdateGraph=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertGroupEle=void 0;const r=n(54),i=n(68),l=n(42);class s extends i.A_BaseInsertInput{ActName(){return"InsertGroupEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new r.ElementInfo;i.Code_mrdetp="1101",i.Id_mr_de=n.elementCode,i.Name=n.elementName,i.Lg_max=n.maxLength,i.Lg_min=n.minimumLength,i.DefaultValue=n.defaultText,i.Text_background=n.backgroundText,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag;let s=l.XInputFactory.GetInstance().GetCommonEle(i,null);return null==s?(t=this.resMsg,t):(s.ElementInfo=i,t=super.Execute([s]),t)}}t.A_InsertGroupEle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SaveParagraphAsFile=void 0;const r=n(2),i=n(1),l=n(14),s=n(3),o=n(0),a=n(402),u=n(62),h=n(6),d=n(65);class c extends i.XBaseAction{ActName(){return"ParagraphSaveAsFile"}constructor(e){super(e),super.OpType=r.ENumActOpType.Save}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl();try{let e=new s.List,t=n.M_DocumentFocused,r=n.ParagraphIndex;t.resetChildrenList(r,e);let i=new u.XTextDocument(!1),c=new s.List;for(let t of e)t instanceof o.XBaseContainer?t.GetAllBaseChildren(c):c.Add(t);let p=new s.List;for(let e=0;e<c.Count();e++){const t=c.Get(e);o.XDomUtil.HasDelTrace(t)||p.Add(t)}c=p;let f=d.EmrClipboard.Copy_SelEles(c.ToArray(),!0,!0);for(let e=0;e<f.Count();e++){const t=f.Get(e);this.updateOwnerDocPanel(t,i.GetPagePanel(h.ENumPagePanelTp.Body))}i.restoreChildrenList(f);let g=new o.XParagraphFlag;g.OwnerDocPanel=i.GetPagePanel(h.ENumPagePanelTp.Header),i.GetPagePanel(h.ENumPagePanelTp.Header).ChildEleList.Add(g),(new o.XParagraphFlag).OwnerDocPanel=i.GetPagePanel(h.ENumPagePanelTp.Footer);let m=i.ToXML(),E=l.XmlDomUtil.Xml2String(m),C=["paragraphTemplate",'<?xml version="1.0" encoding="utf-8"?>'+E];a.RequestDesignerUtil.PostMessage(C),this.resMsg.ReturnParams='<?xml version="1.0" encoding="utf-8"?>'+E}catch(e){this.resMsg.Ex=e}return n.Focus(),t=this.resMsg,t}}t.A_SaveParagraphAsFile=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdateTeeth=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"UpdateTeeth"}Execute(e){this.resMsg.Clear();let t=e[0],n=e[1],r=e[2],i=e[3];return this.instance.OnOK_TeechEdtForm(t,n,r,i),this.resMsg}setInstance(e){this.instance=e}}t.A_UpdateTeeth=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_setValue=void 0;const r=n(1),i=n(3),l=n(33),s=n(0),o=n(40),a=n(32),u=n(2),h=n(13),d=n(26),c=n(75);class p extends r.XBaseAction{constructor(e){super(e)}ActName(){return"SetValue"}Execute(e){this.resMsg.Clear();try{let n=super.GetEdtCtrl();this.RefreshDocList=[];let r=n.unfocus;this.xdoc=n.All_Document,n.unfocus=e.length>0&&null!=e[0].unfocus?e[0].unfocus:r;for(var t=0;t<e.length;t++){let n=e[t].conceptId,r=e[t].value,i=e[t].type,l=e[t].docId,s=e[t].callback,o=e[t].imgWidth,a=e[t].imgHeight,u=e[t].valueType?e[t].valueType:"text",h=null==e[t].buttonIconFlag||e[t].buttonIconFlag,d=null==e[t].valueTarget?"all":e[t].valueTarget,c=null!=e[t].paragraphFlag&&e[t].paragraphFlag,p=null!=e[t].useOldSize&&e[t].useOldSize,f=null==e[t].resetDateTime||e[t].resetDateTime,g=null==e[t].returnFlag||e[t].returnFlag,m=null==e[t].idType?"CptId":e[t].idType,E=null==e[t].imgHaveValue||e[t].imgHaveValue,C=null==e[t].DataString?null:e[t].DataString,A=null==e[t].InputExtendAttr?null:e[t].InputExtendAttr,y=null==e[t].InputStorageData?null:e[t].InputStorageData,I=null==e[t].CoverOldValue||e[t].CoverOldValue,S=null==e[t].isBase64||e[t].isBase64,_=null==e[t].SelectText?null:e[t].SelectText,w=null!=e[t].onlyHeader&&e[t].onlyHeader,b=null!=e[t].employeeId?e[t].employeeId:void 0,x=!0===e[t].changeFlag,P=!0===e[t].targetToHidden,v=1==e[t].operaReadOnly,T=1==e[t].filterTable;if(this._KeepTrace=!!e[t].KeepTrace,this._SignValueType=null==e[t].SignValueType?"image":e[t].SignValueType,this.changeFlag=x,this._ListSernoStyle=null,e[t].ListSernoStyle&&(this._ListSernoStyle=e[t].ListSernoStyle),!n)return;this.setValue(n,r,i,u,h,c,f,g,l,s,m,o,a,E,C,p,d,A,y,_,w,I,S,b,P,v,T)}this.MRefreshDocsView();for(t=0;t<this.xdoc.length;t++)this.xdoc[t].hasExpessionToRefreshDocView=!1;this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}setValue(e,t,n,r,p,f,g,m,E,C,A,y,I,S,_,w,b,x,P,v,T,M,L,D,R,F,N){let B=super.GetEdtCtrl();const k=B.M_EleFocused;for(var O=0;O<this.xdoc.length;O++){if(E&&this.xdoc[O].DocID!=E)continue;let V=new l.EmrCalcEngine(this.xdoc[O]),H=new i.List;if("XID"==A?T?V.GetXDocHeader().GetChildrenByXID(e,!0,H,R):(V.GetXDocHeader().GetChildrenByXID(e,!0,H,R),V.GetXDocBody().GetChildrenByXID(e,!0,H,R),V.GetXDocFooter().GetChildrenByXID(e,!0,H,R)):T?V.GetXDocHeader().GetChildrenByCptId(e,!0,H,R):(V.GetXDocHeader().GetChildrenByCptId(e,!0,H,R),V.GetXDocBody().GetChildrenByCptId(e,!0,H,R),V.GetXDocFooter().GetChildrenByCptId(e,!0,H,R)),H.Length>0){let i=H.ToArray(),l=!1,E=!1;for(let e=0;e<i.length;e++){let t=i[e];t instanceof a.XTextLabelElement&&(l=!0),(t instanceof s.XInputEle||t instanceof s.XImageEle)&&(E=!0)}for(let A=0;A<i.length;A++){let T=i[A],R="";if(T instanceof a.XTextLabelElement){if(!("majorDataElement"==b&&E||"onlyDataElement"==b))if(this.resetRefreshDocList(this.xdoc[O]),"xml"==r&&F){B.M_GetActionByName("SetValueByTitle").Execute([{conceptId:e,value:t,type:n,valueType:r,KeepTrace:this._KeepTrace,buttonIconFlag:p,paragraphFlag:f,filterTable:N,returnFlag:m,CoverOldValue:M}])}else{B.M_GetActionByName("InsertCharByTitle").Execute([e,t,n,r,p,f,m,M])}continue}if("majorTitle"==b&&l||"onlyTitle"==b)continue;const V=B.M_EleEvtModel,H=V.WorkMode,U=H==u.ENumWorkMode.App||H==u.ENumWorkMode.Form;if(this._KeepTrace&&U)if(T instanceof s.XBaseContainer)T instanceof s.XInputEle&&T.BindDocEditor(B);else{const e=V.AddEdtHistAct,t=B.M_EdtCustomEvtGrp.AppKeepTrace;let n=new h.UndoGroup;const r="XImage"==T.EleTypeName&&T.HaveValue;let i=T;const l=i.Parent,o=l.GetChildInx(i);if(null!=T.Parent&&r&&t){T=null;let t=s.XElementFactory.CreatXElement(i.EleTypeName);t.CopyFrom(i,!1,!0,!0),t instanceof s.XImageEle&&t.setImgObj(i.ImgInfo.ImgBase64,i.ImgInfo.IsImgBase64),l.AddChildEle(o,t),i.CptID=null,i.XID=i._BuildNewXID(),i.GrpID=i._BuildGrpID(null),V.EleClickedWrap.LineEleIxFocused.ReplaceEle(i),null!=e&&e.Execute3(u.ENumEdtType.Delete,n,[i]),T=t}null!=e&&S&&t&&e.Execute3(u.ENumEdtType.Add,n,[T])}else T.EleStyle&&T.EleStyle.CreatorIndex>-1&&(T.EleStyle.CreatorIndex=-1);if(this.resetRefreshDocList(this.xdoc[O]),T instanceof s.XImageEle){let e=!1;T.EmployeeId=D;let n=T.ImgObj.ImageEle.src,r=t.split(","),i="",l=n.split(",");if(L)1==r.length?(i="data:image/gif;base64,"+r[0],r[0]!=l[1]&&(e=!0)):(i=t,r[1]!=l[1]&&(e=!0));else{T.ImgInfo.ImgBase64!=t&&(e=!0),i=t}let s=new Image;if(s.src=L?i:d.TextDocInitInfo.GetInstance().ImageUrl+i,y&&I||w){let e=this.ImgSetValue(T,L,i,w,y,I,S,_);C&&(s.onload=()=>{C(e)})}else s.onload=()=>{let e;e=this.ImgSetValue(T,L,i,w,y,I,S,_),B.MRefreshDocView(this.xdoc[O],!1),C&&C(e)};s.onerror=()=>{B.M_EdtCustomEvtGrp.ImageLoadError&&B.M_EdtCustomEvtGrp.ImageLoadError({cptId:T.CptID,xId:T.XID,url:s.src})},k&&k.OwnerDocPanel&&e&&(k.OwnerDocPanel.IsChanged=!0);continue}if(T instanceof s.XInputEle){let e=T,n=e.DataSrc.DataList;x&&(e.InputExtendAttr=x),P&&(e.InputStorageData=P);let r=[];if(e.InputType==o.EleTypeEnum.SingleChoiceDropEle||e.InputType==o.EleTypeEnum.MoreChoiceDropEle)if(e.DynamicData)if("object"==typeof t&&t.constructor==Array){e.DynamicDataValue=JSON.stringify(t);let n=[];for(let e=0;e<t.length;e++){let r=t[e];n.push(r.value)}R=n.join("、")}else"string"==typeof t&&t.constructor==String&&(e.DynamicDataValue=JSON.stringify(t),R=t);else{for(let e of n)if("object"==typeof t&&t.constructor==Array)for(var G=0;G<t.length;G++)e.Key==t[G]&&r.push(e.Value);else"string"==typeof t&&t.constructor==String&&e.Key==t&&r.push(e.Value);r.length>0?R=r.join("、"):null!=v&&(R=v)}else if(T.InputType==o.EleTypeEnum.DateEle)if(g){let e=t.split(" ")[0],n=t.split(" ")[1];if(e&&n){let t=e.split("-")[0],r=e.split("-")[1],i=e.split("-")[2],l=n.split(":")[0],s=n.split(":")[1],o=n.split(":")[2],a=T.DisplayFormat.Format;"yyyy年"==a?R=t+"年":"yyyy年MM月"==a?R=`${t}年${r}月`:"yyyy年MM月dd日"==a?R=`${t}年${r}月${i}日`:"yyyy-MM-dd"==a?R=`${t}-${r}-${i}`:"yyyy年MM月dd日HH时"==a?R=`${t}年${r}月${i}日${l}时`:"yyyy年MM月dd日HH时mm分"==a?R=`${t}年${r}月${i}日${l}时${s}分`:"yyyy-MM-dd HH:mm"==a?R=`${t}-${r}-${i} ${l}:${s}`:"yyyy年MM月dd日HH:mm"==a?R=`${t}年${r}月${i}日${l}:${s}`:"yyyy年MM月dd日HH时mm分ss秒"==a?R=`${t}年${r}月${i}日${l}时${s}分${o}秒`:"yyyy-MM-dd HH:mm:ss"==a?R=`${t}-${r}-${i} ${l}:${s}:${o}`:"HH时mm分"==a?R=`${l}时${s}分`:"HH:mm"==a?R=`${l}:${s}`:"HH:mm:ss"==a&&(R=`${l}:${s}:${o}`)}else R=t}else R=t;else if(T.InputType==o.EleTypeEnum.NumEle){let e=T.ValidateStyle.MaxDecimalDigits,n=(t=String(t)).split(".");if(n[1]){let t=n[1].substr(0,e);R=t?n[0]+"."+t:n[0]}else R=t}else if(e.InputType==o.EleTypeEnum.DiagnosisEle){let n=t;t instanceof Array||(n=[{content:t}]),e.DiagnoseValueArr=n;let r=!1;if(n.length>0)for(let e=0;e<n.length;e++){const t=n[e];t&&t.content&&t.content.length>0&&(r=!0)}R=r?e.GetInnerText(!1)+" ":""}else if(e.InputType==o.EleTypeEnum.SignEle)if(T.EmployeeId=D,e.SignEleHaveValue=S,"image"==this._SignValueType)if(1==S){let e=new s.XImageEle;e.ImageType=c.ImageType.SyncImage,e.ImgInfo.IsImgBase64=L,L||(e.ImgInfo.ImgBase64=t),e.setImgObj(t,L),e.ImgObj.Width=y,e.ImgObj.Height=I,e.HaveValue=S,e.InitSizeByImgObj(V.EleClicked),R=e}else R="";else R=t;else R=t;T.PreSetvalueText=R}else R=t;T instanceof s.XCodeEle&&T.IsQrCode&&this._ListSernoStyle&&(T.PageNumStyle=this._ListSernoStyle),n="append"==n?n:"normal";let W=T.GetInnerText(!1);if("append"==n)R=W+R,W!=R&&k&&k.OwnerDocPanel&&(k.OwnerDocPanel.IsChanged=!0);else{let e=W.replace(/\s/g,"");var X=new RegExp("/r/n","g");""!=e.replace(X,"")&&(M||(R=W)),W!=R&&k&&k.OwnerDocPanel&&(k.OwnerDocPanel.IsChanged=!0)}this.changeFlag&&this.SetTimeChangeColor([T]);let j=null;T.UpdateInnerText(R,j,this._KeepTrace)}}}}ImgSetValue(e,t,n,r,i,l,s,o){let a,u=super.GetEdtCtrl();try{let h=e;if(h.ImgInfo.IsImgBase64=t,t||(h.ImgInfo.ImgBase64=n),r)h.SetSizeDPI(h.Bounds.Width,h.Bounds.Height,300);else{i&&(h.ImgObj.Width=i),l&&(h.ImgObj.Height=l);let e=u.M_EleEvtModel;h.InitSizeByImgObj(e.EleClicked)}h.setImgObj(n,t),h.HaveValue=s,h.IsPrint=s,h.DataString=o,a=!0}catch(e){a=!1}return a}}t.A_setValue=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdateTextLable=void 0;const r=n(1),i=n(32);class l extends r.XBaseAction{ActName(){return"UpdateTextLable"}Execute(e){let t;e.length<1&&(this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",super.MessageWarn(),t=null);let n=r.XBaseAction.GetCurEle(),l=e[0];return n instanceof i.XTextLabelElement&&(n.Text=l.inpMrtDeSectionDispName,n.EleText=l.inpMrtDeSectionName,n.TitleLevel=l.inpMrtDeSectionLevel,n.IsDeleteFlag=l.isDel,n.TitleID=l.inpMrtDeSectionNo,n.CptID=l.conceptID,n.Description=l.inpMrtDeSectionDesc,n.IsSaveFlag=l.saveFlag,n.FixPosition=l.positionFlag,n.Attr_FgHide=l.hideFlag,n.SetHideFlag=l.hideFlag,n.IsRequire=l.requireFlag,n.IsPrintFlag=l.printFlag,n.IsEditble=!1!==l.editbleFlag,n.LevelTerm=l.levelTerm,n.ExtendAttr1=l.extendAttr1,n.Gender=l.sexJudge,n.MaxAge=l.maxAge,n.MinAge=l.minAge,n.MaxLength=l.maxLength,n.MinLength=l.minimumLength),super._RefreshPageAndMoveCaret(!0),t}}t.A_UpdateTextLable=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertCharByTitle=void 0;const r=n(2),i=n(0),l=n(16),s=n(1),o=n(33),a=n(38),u=n(32);class h extends s.XBaseAction{constructor(){super(),super.OpType=r.ENumActOpType.CtntEdit}ActName(){return"InsertCharByTitle"}Execute(e){let t=super.GetEdtCtrl();this.xdoc=t.All_Document;let n,r,s=e[0],h=e[1],d=e[2],c=e[3],p=e[4],f=e[5],g=e[6],m=e[7];for(var E=0;E<this.xdoc.length;E++){let e=new o.EmrCalcEngine(this.xdoc[E]),C=new a.List,A=e.GetXDocBody().GetChildrenByTitleId(s,!1,C,p);for(let e of A){e.Length>1&&(n=e.Get(0),r=e.Get(1)),!g&&r instanceof u.XTextLabelElement&&(r=l.XDomUtil.GetNextEle(!1,r)),t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(r),t.M_EleEvtModel.MoveCaretByCursorEle(!0),n instanceof i.XBaseContainer&&(n=n.GetFirstChildBaseEle()),"normal"==d&&(t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(n),t.M_EleEvtModel.MoveCaretByCursorEle(!0),t.M_EleEvtModel.ReInitSelRange(),t.M_ActionHandler.L_ExecuteCommand("SelectRange",[null,r]));let s=t.M_EleEvtModel.SelRange;if(null!=s&&s.IsValid()){let e=s.BuildEleRangeAsText();if(""!=(null==e?void 0:e.replace("\r\n",""))&&!m)continue}if("text"==c){let e=h.replace("\r\n","");t.M_ActionHandler.L_ExecuteCommand("InsertString",[e])}else"xml"==c&&(f&&t.M_ActionHandler.L_ExecuteCommand("InsertReturn",[]),t.M_ActionHandler.L_ExecuteCommand("InsertDoc",[h]),g||t.M_ActionHandler.L_ExecuteCommand("RemoveChar",["8"]));t.MRefreshDocView()}}return this.resMsg}}t.A_InsertCharByTitle=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SaveTitleParagraphAsFile=void 0;const r=n(2),i=n(1),l=n(3),s=n(6);class o extends i.XBaseAction{ActName(){return"GetParagraphByCptId"}constructor(e){super(e),super.OpType=r.ENumActOpType.Save}Execute(e){this.resMsg.Clear();null==e||e.length;let t,n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],h=e[6],d=super.GetEdtCtrl();try{let e,t=new l.List;d.M_DocumentFocused.GetPagePanel(s.ENumPagePanelTp.Body).GetChildrenByType("XTextLabelElement",!0,t);for(let r of t)if(r.CptID==n){let t=r.Parent;e=this.getXmlByCptIdInParent(r,t,a,h,!0,i,o,u);break}this.resMsg.ReturnParams={conceptId:n,value:r?e.xml:e.paragraphtext}}catch(e){this.resMsg.Ex=e}return d.Focus(),t=this.resMsg,t}}t.A_SaveTitleParagraphAsFile=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_getValue=void 0;const r=n(1),i=n(3),l=n(33),s=n(0),o=n(40),a=n(402),u=n(32),h=n(37);class d extends r.XBaseAction{constructor(e){super(e),this.withDelTrace=!1}ActName(){return"GetValue"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl();t.unfocus=!0,this.xdoc=t.All_Document,this.valueList=[],this.CptIDList=[];let n=e.conceptId,r=!0===e.getHideEle,i=e.callbackId;this.withDelTrace=!!e.withDelTrace;let l=e.docId,s="text"!=(e.valueType?e.valueType:"text"),o=1==e.filterTable,u=null==e.buttonIconFlag||e.buttonIconFlag,h=null==e.paragraphFlag||e.paragraphFlag,d=null==e.valueTarget?"all":e.valueTarget,c=!0===e.withLabel,p=!0===e.getTableWithTitle;this.getValue(n,i,l,r);let f=!1,g=!1,m=this.CptIDList.length>0,E=this.valueList.length>0;if("majorTitle"==d?m?(f=!0,g=!1):(f=!0,g=!0):"majorDataElement"==d?E?(f=!1,g=!0):(f=!0,g=!0):"onlyTitle"==d?(f=!0,g=!1):"onlyDataElement"==d?(f=!1,g=!0):"all"==d&&(f=!0,g=!0),this.resMsg.ReturnParams=[],this.CptIDList.length>0&&f){let e=[];for(let n=0;n<this.CptIDList.length;n++){let r=t.M_ActionHandler.L_ExecuteCommand("GetParagraphByCptId",[this.CptIDList[n],s,u,h,c,o,p]);e.push(r.ReturnParams)}let n=e;this.resMsg.ReturnParams.push(...n)}if(this.valueList.length>0&&g){let e=this.valueList;a.RequestDesignerUtil.PostMessage(e),this.resMsg.ReturnParams.push(...e)}return this.resMsg}getValue(e,t,n,r){let a={};for(var d=0;d<this.xdoc.length;d++){if(n&&this.xdoc[d].DocID!=n)continue;let t=this.xdoc[d].DocID,p=new l.EmrCalcEngine(this.xdoc[d]),f=new i.List;if(p.GetXDocBody().GetChildrenByCptId(e,!0,f,r),f.Length<=0&&p.GetXDocBody().GetChildrenByXID(e,!0,f,r),f.Length>0&&(f.ToArray().forEach(n=>{if(n instanceof s.XInputEle){let i=n,l=i.DataSrc.DataList,s=[];if(i.InputType==o.EleTypeEnum.SingleChoiceDropEle||i.InputType==o.EleTypeEnum.MoreChoiceDropEle)if(null!=i.DynamicData){let r=n.GetInnerText(this.withDelTrace);this.valueList.push({docId:t,xid:n.XID,conceptId:e,value:r,DynamicDataValue:n.DynamicDataValue?JSON.parse(n.DynamicDataValue):null})}else{let i=n.GetInnerText(this.withDelTrace),o=i.split(h.TextDocApiConst.InputMoreSelectionEleSpliteStr);for(let e of l)if("object"==typeof o&&o.constructor==Array)for(var r=0;r<o.length;r++)e.Value==o[r]&&s.push(e.Key);this.valueList.push({docId:t,xid:n.XID,conceptId:e,value:s,valueArr:i,unitText:n.UnitText,labelText:n.LabelText,suffixText:n.SuffixText})}else{let r=n.GetInnerText(this.withDelTrace);this.valueList.push({docId:t,xid:n.XID,DateTimeValue:n.DateTimeValue,employeeId:n.EmployeeId,conceptId:e,value:r,unitText:n.UnitText,labelText:n.LabelText,suffixText:n.SuffixText})}}else if(n instanceof s.XBaseChoiceEle){let e=n.GrpID;-1==Object.keys(a).indexOf(e)?(a[e]=[],n.Checked&&a[e].push(n.CheckedValue)):n.Checked&&a[e].push(n.CheckedValue)}else if(n instanceof s.XImageEle){let r=n.ImgObj.ImageEle.src;n.EleStyle.DeleterIndex>-1?this.withDelTrace&&this.valueList.push({docId:t,xid:n.XID,conceptId:e,value:r,haveValue:n.HaveValue,employeeId:n.EmployeeId}):this.valueList.push({docId:t,xid:n.XID,conceptId:e,value:r,haveValue:n.HaveValue,employeeId:n.EmployeeId})}else if(n instanceof u.XTextLabelElement)this.CptIDList.push(e);else if(n instanceof s.XTextTable){let r=[];if(n.ChildEleList.Count()>0){const e=n.ChildEleList.ToArray();for(let t=0;t<e.length;t++){const n=e[t];let i=[];if(n.ChildEleList.Count()>0){const e=n.ChildEleList.ToArray();for(let t=0;t<e.length;t++){let n=e[t].GetInnerText(this.withDelTrace)||"";n=n.replace(/\r\n/g,""),i.push({colIx:t,inner:n})}}r.push({rowIx:t,cells:i})}}this.valueList.push({docId:t,conceptId:e,value:r})}}),Object.keys(a).length>0))for(var c in a)this.valueList.push({docId:t,conceptId:e,value:a[c]})}}}t.A_getValue=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_getCheckedCptIdByGrpId=void 0;const r=n(3),i=n(33),l=n(0),s=n(1);class o extends s.XBaseAction{constructor(e){super(e)}ActName(){return"getCheckedCptIdByGrpId"}Execute(e){let t=e[0];this.resMsg.Clear();let n=super.GetEdtCtrl();return this.xdoc=n.All_Document,this.getCheckedByGrpID(t),this.resMsg}getCheckedByGrpID(e){let t=[];for(var n=0;n<this.xdoc.length;n++){let s=new i.EmrCalcEngine(this.xdoc[n]),o=new r.List;s.GetXDocBody().GetChildrenByGrpID(e,!0,o),o.Length>0&&o.ToArray().forEach(e=>{e instanceof l.XBaseChoiceEle&&e.Checked&&t.push(e.CheckedValue)})}this.resMsg.ReturnParams=t}}t.A_getCheckedCptIdByGrpId=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_insertElementByCpdID=void 0;const r=n(2),i=n(0),l=n(1),s=n(33),o=n(38);class a extends l.XBaseAction{constructor(){super(),super.OpType=r.ENumActOpType.CtntEdit}ActName(){return"InsertEleByCptID"}Execute(e){let t=super.GetEdtCtrl();this.xdoc=t.All_Document;let n,r,l=e[0],a=e[1],u=e[2];for(var h=0;h<this.xdoc.length;h++){let e=new s.EmrCalcEngine(this.xdoc[h]),d=new o.List,c=e.GetXDocBody().GetChildrenByTitleId(l,!1,d);for(let e of c)if(e.Length>1&&(n=e.Get(0),r=e.Get(1)),t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(r),t.M_EleEvtModel.MoveCaretByCursorEle(!0),"InsertImageStream"==a){let e=u.base64,n=u.width,r=u.height,l=e.split(","),s="";s=1==l.length?"data:image/gif;base64,"+l[0]:e;let o=new Image;o.src=s,o.onload=function(){let l=new i.XImageEle;l.setImgObj(e),n&&(l.ImgObj.Width=n),r&&(l.ImgObj.Height=r);let s=[l,e];t.M_ActionHandler.L_ExecuteCommand("InsertImage",s)}}else t.M_ActionHandler.L_ExecuteCommand(a,u)}return this.resMsg}}t.A_insertElementByCpdID=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ValidateDoc=void 0;const r=n(1),i=n(3),l=n(33),s=n(1003);class o extends r.XBaseAction{ActName(){return"ValidateDoc"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),r=n.All_Document,o=new i.List;if(e.length>0)for(let t=0;t<e.length;t++){let n=e[t].docId;for(var a=0;a<r.length;a++){if(n&&r[a].DocID!=n)continue;new l.EmrCalcEngine(r[a]).GetXDocBody().GetChildrenNotValidate(o)}}else for(var u=0;u<r.length;u++){new l.EmrCalcEngine(r[u]).GetXDocBody().GetChildrenNotValidate(o)}return n.ValidateList=o,o.Length>0?(n.ValidateDialog?n.ValidateDialog.updateList(o.ToArray()):n.ValidateDialog=new s.ValidateResult({list:o.ToArray(),closeDialog:function(){n.ValidateDialog=null},JumpToEle:function(e){let t=n.ValidateList.Get(e);n.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(t.EndEle),n.M_EleEvtModel.MoveCaretByCursorEle(!0)}}),t=!1):(n.ValidateDialog&&n.ValidateDialog.hide(),n.ValidateDialog=null,t=!0),this.resMsg.ReturnParams=t,this.resMsg}}t.A_ValidateDoc=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValidateResult=void 0;const r=n(27),i=n(1004);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.ValidateResultComp(t,this.InitProps)}show(){this.Component.React.show()}updateList(e){this.Component.React.updateList(e)}hide(){this.Component.React.hide()}DefaultProps(){return{text:"",top:0,left:0}}}t.ValidateResult=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValidateResultComp=void 0;const r=n(12);n(1005);const i=n(24),l=n(22),s=n(52);class o extends r.Component{constructor(e){super(e),this.state={isShow:!1},this.state={isRender:!0,list:e.list}}componentDidMount(){this.props.parent.React=this}show(){this.setState({isRender:!0})}hide(){this.setState({isRender:!1})}isShow(){return this.state.isRender}JumpToEle(e){this.props.JumpToEle(e)}closeDialog(){this.props.closeDialog()}updateList(e){this.setState({list:e})}renderList(){return this.state.list.map((e,t)=>r.createElement("li",{style:{margin:"8px 0"},onClick:()=>{this.JumpToEle(t)},key:t},e.Name,": ",r.createElement("span",{className:"pango-validate-erroeInfo"}," ",e.ToolTip)))}render(){let{top:e,left:t,text:n}=this.props,{isRender:i}=this.state;return r.createElement(s.Dialog,{className:"pango-validateresult",title:"验证结果",isDestroy:i,visible:i,showFooter:!1,onCancel:()=>{this.closeDialog()}},r.createElement("ul",{style:{maxHeight:"300px",margin:"0px"}},this.renderList()))}}class a extends l.BaseComponent{constructor(e,t){super(e,t)}show(){this.React.show()}hide(){this.React.hide()}Render(){i.render(r.createElement(o,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.ValidateResultComp=a,t.default=o},function(e,t,n){var r=n(18),i=n(1006);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,"div.pango-validateresult {\r\n    width: 0;\r\n    height: 0;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n}\r\n\r\n.pango-validateresult * {\r\n    box-sizing: border-box;\r\n}\r\n\r\n.pango-validateresult .pango-editor-dialog-content .pango-validate-erroeInfo{\r\n    color: #f00;\r\n}\r\n.pango-validateresult .pango-editor-dialog-content {\r\n    overflow: auto;\r\n    position: relative;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdateImage=void 0;const r=n(0),i=n(1);class l extends i.XBaseAction{ActName(){return"UpdateImage"}Execute(e){if(this.resMsg.Clear(),e.length<1)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",this.rn;const t=e[0];if(null==t||"{}"==JSON.stringify(t))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令参数0中的map为空",this.rn;const n=i.XBaseAction.GetCurEle();if(null==n)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 未选中元素",this.rn;if(!(n instanceof r.XImageEle))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令选中的元素不是图片",this.rn;const l=n,s=this.updateMap(l,t);if(s>0){if(s>1){const e=super.GetEdtCtrl().M_EleEvtModel.EleClicked;l.InitSizeByImgObj(e)}super._RefreshPageAndMoveCaret(!0)}else this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令的图片元素无属性需更新";return this.rn}get rn(){return i.XBaseAction.SetCurEle(null),this.resMsg.MsgStr&&this.resMsg.MsgLevel>=2&&super.MessageWarn(),this.resMsg.IsReturnMsg?this.resMsg:null}updateMap(e,t){let n=0;return void 0!==t.conceptDomainCode&&(e.CptID=t.conceptDomainCode),void 0!==t.dataEmementName&&e.SetAttribute("decodeName",t.dataEmementName),void 0!==t.elementName&&(e.Title=t.elementName),void 0!==t.sexJudge&&(n=1,e.Gender=t.sexJudge),void 0!==t.minAge&&(n=1,e.MinAge=t.minAge),void 0!==t.maxAge&&(n=1,e.MaxAge=t.maxAge),void 0!==t.hideFlag&&(n=1,e.Attr_FgHide=t.hideFlag,e.SetHideFlag=t.hideFlag),void 0!==t.deleteFlag&&(n=1,e.Deletable=t.deleteFlag),t.width&&(n=2,e.ImgObj.Width=t.width),t.height&&(n=2,e.ImgObj.Height=t.height),n}}t.A_UpdateImage=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetTitleList=void 0;const r=n(3),i=n(33),l=n(1);class s extends l.XBaseAction{constructor(e){super(e),this.xdocLoadParam=null,this.xdoc=[]}ActName(){return"getTitleList"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl();if(e.length>0&&null!=e[0]){this.xdoc=[];for(let n=0;n<t.All_Document.length;n++){let r=t.All_Document[n];for(let t=0;t<e.length;t++){let n=e[t].docId;r.DocID==n&&this.xdoc.push(r)}}}else this.xdoc=t.All_Document;return this.getTitleList(),this.resMsg}getTitleList(){let e=[];for(var t=0;t<this.xdoc.length;t++){let n=new r.List;new i.EmrCalcEngine(this.xdoc[t]).GetXDocBody().GetChildrenByType("XTextLabelElement",!0,n);for(let r of n){let n=r;e.push({name:n.Text,cptId:n.CptID,docId:this.xdoc[t].DocID})}}this.resMsg.ReturnParams=e}}t.A_GetTitleList=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_StructureTree=void 0;const r=n(1),i=n(38),l=n(33),s=n(88),o=n(32),a=n(0);class u extends r.XBaseAction{ActName(){return"GetStructureTree"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl();this.xdoc=t.All_Document;let n=this.getElementList();return this.resMsg.ReturnParams=n,this.resMsg}getElementList(){let e=new i.List;for(var t=0;t<this.xdoc.length;t++){new l.EmrCalcEngine(this.xdoc[t]).GetXDocBody().GetChildrenByTypes(["XTextLabelElement","XInputField","XTextCheckBox","XTextRadioBox"],!1,e)}let n=e.ToArray(),r=this.getcurrentEle(n),s=[];for(let e of r){let t={};t.title=e.title,t.level=e.level,t.xId=e.xId,t.elements=e.elements;let n=e.items,r=this.itemsListToArray(n);t.items=r,s.push(t)}return s}itemsListToArray(e){let t=[];for(let n of e){let e={};e.title=n.title,e.level=n.level,e.xId=n.xId,e.elements=n.elements;let r=n.items,i=this.itemsListToArray(r);e.items=i,t.push(e)}return t}getcurrentEle(e){let t=new i.List,n=0,r=1,l="",u=null,h=new i.List,d=new i.List,c=new i.List;for(var p=0;p<e.length;p++){let f=e[p];if(f instanceof o.XTextLabelElement){u={},d.Clear();let e=new i.List;c.Clear();let s=f.Text,o=f.TitleLevel,a=f.XID;if(u.title=s,u.level=o,u.items=e,u.xId=a,0==n&&(r=o),r<o)for(let e=0;e<t.Length;e++){String(t.Get(e).xId)==l&&this.insertChildItem(t.Get(e).items,o,u)}else l=a,t.Add(u),r=o;n++}else if(f instanceof a.XRadioBoxEle||f instanceof a.XCheckBoxEle){let e=f.Id,t=f.Name;if(null==t)continue;let n=f.CheckedValue,r=f.Caption,i=f.XID;if(h.Contains(e)){let e={};e.value=n,e.name=r,e.XID=i,c.Add(e)}else{c.Clear(),h.Clear();let l=new Map;h.Add(e);let s={},o=[];if(c)for(let e of c)o.push(e);s.value=n,s.name=r,s.XID=i,c.Add(s),l.set("elementName",t),l.set("elementId",e),l.set("type","checkbox"),l.set("itemListEle",o),d.Add(l)}}else if(f instanceof s.XInputEle){c.Clear();let e=new Map,t=(f.GrpID,f.Name),n=f.XID;f.ValueBinding.DataSource;let r=f.DataSrc.DataList;if(r.Length>0){for(let e of r){let t=e.Key,r=e.Value,i={};i.value=t,i.name=r,i.XID=n,c.Add(i)}let i=[];if(c)for(let e of c)i.push(e);e.set("elementName",t),e.set("elementId",n),e.set("itemListEle",i),e.set("type","select"),d.Add(e)}else e.set("type","textinput"),e.set("elementId",n),e.set("elementName",t),d.Add(e)}if(null!=u){let e=[];for(let t of d){let n=t.get("itemListEle");e.push({elementId:t.get("elementId"),elementName:t.get("elementName"),elementType:t.get("type"),itemListEle:n})}u.elements=e}}return t}insertChildItem(e,t,n){if(e.Length<=0)e.Add(n);else{let r=e.GetEnumerator(),i=e.Length,l=0;for(;r.MoveNext();){l++;let s=r.Current;if(s.TitleLevel==t){e.Add(n);break}l==i&&this.insertChildItem(s.items,t,n)}}}}t.A_StructureTree=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetAllElement=void 0;const r=n(1),i=n(38),l=n(33),s=n(88),o=n(0);class a extends r.XBaseAction{constructor(){super(...arguments),this.getHEADcontent=!1,this.MedExPressFlag=!1}ActName(){return"GetAllElement"}Execute(e){e&&e.getHEADcontent&&(this.getHEADcontent=e.getHEADcontent),e&&e.docId&&(this.docId=e.docId),e&&e.medExPressFlag&&(this.MedExPressFlag=e.medExPressFlag),this.resMsg.Clear();let t=super.GetEdtCtrl();this.xdoc=t.All_Document;let n=this.getElementList();return this.resMsg.ReturnParams=n,this.resMsg}getElementList(){let e=new i.List;for(var t=0;t<this.xdoc.length;t++){if(this.docId&&this.docId!=this.xdoc[t].DocID)continue;let n=new l.EmrCalcEngine(this.xdoc[t]);if(n.GetXDocBody().GetAllChildren(e),this.getHEADcontent){let t=new i.List;n.GetXDocHeader().GetAllChildren(t),t.Count()>0&&(t.AddRange(e),e.Clear(),e.AddRange(t))}}return this.getResultArrFromChild(e)}getResultArrFromChild(e){let t=e.ToArray(),n=new i.List;this.getcurrentEle(t,n);let r=[];for(let e of n){let t=e,n={};n.type=t.get("type"),n.elementId=t.get("elementId"),n.cId=t.get("cId"),n.elementName=t.get("elementName"),n.bgcText=t.get("bgcText"),n.Tooltip=t.get("Tooltip"),null!=t.get("innerText")&&(n.innerText=t.get("innerText"));let i=t.get("items");n.items=i?this.itemsListToArray(i):[];let l=t.get("itemListEle");n.itemListEle=this.itemListEleToArray(l),r.push(n)}return r}itemsListToArray(e){let t=[];for(let n of e){let e=n,r={};r.type=e.get("type"),r.elementId=e.get("elementId"),r.cId=e.get("cId"),r.elementName=e.get("elementName"),r.bgcText=e.get("bgcText"),r.Tooltip=e.get("Tooltip"),null!=e.get("innerText")&&(r.innerText=e.get("innerText"));let i=e.get("items");r.items=i?this.itemsListToArray(i):[];let l=e.get("itemListEle");r.itemListEle=this.itemListEleToArray(l),t.push(r)}return t}itemListEleToArray(e){let t=[];if(e)for(let n of e)t.push(n);return t}getcurrentEle(e,t){let n,r=new i.List;for(var l=0;l<e.length;l++){let a=e[l];const u=a.CptID,h=a.XID;if(a instanceof o.XRadioBoxEle||a instanceof o.XCheckBoxEle){let e=a.Id,l=a.Name;if(null==e)continue;let s=a.CheckedValue,o=a.Caption,d=a.Checked;if(r.Contains(e)){let e={};e.value=s,e.name=o,e.XID=h,e.cId=u,e.isChecked=d,n.Add(e)}else{n=new i.List,r.Clear();let c=new Map;r.Add(e);let p={};p.value=s,p.name=o,p.XID=h,p.cId=u,p.isChecked=d,n.Add(p),c.set("elementName",l),c.set("elementId",e),c.set("cId",u),c.set("bgcText",void 0),c.set("Tooltip",a.ToolTip),c.set("type","checkbox"),c.set("itemListEle",n),t.Add(c)}}else if(a instanceof s.XInputEle){let e=new i.List,n=new Map,r=a.GetInnerText(!1),l=a.Name;a.ValueBinding.DataSource;let s=a.DataSrc.DataList;if(s.Length>0){for(let t of s){let n=t.Key,r=t.Value,i={};i.value=n,i.name=r,i.XID=h,e.Add(i)}n.set("elementName",l),n.set("elementId",h),n.set("cId",u),n.set("itemListEle",e),n.set("type","select")}else n.set("type","textinput"),n.set("elementId",h),n.set("cId",u),n.set("elementName",l);if(n.set("innerText",r),n.set("bgcText",a.BackgroundText),n.set("Tooltip",a.ToolTip),a.ChildCount>0){let e=new i.List,t=a.ChildEleList.ToArray();this.getcurrentEle(t,e),n.set("items",e)}t.Add(n)}else if(a instanceof o.XTextTable){let e=a;for(let n of e.Rows)for(let e of n.Cells){let n=new i.List;e.GetAllChildren(n);let r=n.ToArray(),l=new i.List;this.getcurrentEle(r,l);for(let e of l)t.Add(e)}}else if(a instanceof o.XMedicalExpressionField&&this.MedExPressFlag){let e=new Map,n=a.Name;e.set("type","XMedicalExpress"),e.set("elementId",h),e.set("cId",u),e.set("elementName",n),t.Add(e)}}}}t.A_GetAllElement=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetXmlByInputCptId=void 0;const r=n(1),i=n(33),l=n(3),s=n(0),o=n(14),a=n(62),u=n(6),h=n(65);class d extends r.XBaseAction{constructor(e){super(e)}ActName(){return"GetValueByInputCptId"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl();this.xdoc=t.All_Document;let n=[];for(let t=0;t<e.length;t++)for(var r=0;r<this.xdoc.length;r++){let d=e[t],c=d.cptId,p=d.type?d.type:"xml",f=new i.EmrCalcEngine(this.xdoc[r]),g=new l.List;f.GetXDocBody().GetChildrenByCptId(c,!0,g);for(let e of g)if(e instanceof s.XInputEle){let t;if("xml"==p){let n=new l.List;e.GetInnerChildren(n);let r=new l.List;for(let e of n)e instanceof s.XBaseContainer?e.GetAllBaseChildren(r):r.Add(e);let i=new l.List;for(let e=0;e<r.Count();e++){const t=r.Get(e);s.XDomUtil.HasDelTrace(t)||i.Add(t)}r=i;let d=h.EmrClipboard.Copy_SelEles(r.ToArray(),!0,!0);if((null==d?void 0:d.Length)>0){let e=new a.XTextDocument(!1);for(let t=0;t<d.Count();t++){const n=d.Get(t);this.updateOwnerDocPanel(n,e.GetPagePanel(u.ENumPagePanelTp.Body))}let n=new s.XParagraphFlag;n.OwnerDocPanel=e.GetPagePanel(u.ENumPagePanelTp.Header),e.GetPagePanel(u.ENumPagePanelTp.Header).ChildEleList.Add(n),(new s.XParagraphFlag).OwnerDocPanel=e.GetPagePanel(u.ENumPagePanelTp.Footer),e.restoreChildrenList(d);let r=e.ToXML();t='<?xml version="1.0" encoding="utf-8"?>'+o.XmlDomUtil.Xml2String(r)}else t=""}else t=e.InnerValue;n.push({cptId:c,value:t})}}return this.resMsg.ReturnParams=n,this.resMsg}}t.A_GetXmlByInputCptId=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_LocateCursor=void 0;const r=n(1),i=n(3),l=n(33),s=n(0);class o extends r.XBaseAction{ActName(){return"LocateCursor"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl(),n=e[0],r=e[1],o=e[2],a=e[3];try{this.xdoc=t.All_Document;let e=t.M_EleEvtModel.EleClickedWrap.EleFocused;for(var u=0;u<this.xdoc.length;u++){if(o&&this.xdoc[u].DocID!=o)continue;let h=new l.EmrCalcEngine(this.xdoc[u]),d=new i.List;if("XID"==a?h.GetXDocBody().GetChildrenByXID(n,!0,d):h.GetXDocBody().GetChildrenByCptId(n,!0,d),0==d.Length)return;let c,p=d.Get(0);if(p instanceof s.XInputEle){let e=r?p.EndEle:p.StartEle;c=r?s.XDomUtil.GetNextEle(r,e):p.StartEle}else c=s.XDomUtil.GetNextEle(r,p);t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(c);let f=t.M_EleEvtModel.EleClickedWrap.EleFocused;t.M_EleEvtHandler.OnCursorChange(e,f),t.M_EleEvtModel.MoveCaretByCursorEle(!0)}this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}}t.A_LocateCursor=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetWorkMode_Form=void 0;const r=n(142),i=n(2);class l extends r.A_SetWorkModeBase{ActName(){return"SetWorkMode_Form"}Execute(e){return super.Execute([i.ENumWorkMode.Form.toString()])}}t.A_SetWorkMode_Form=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertSyncImage=void 0;const r=n(0),i=n(75),l=n(48),s=n(2),o=n(29),a=n(180),u=n(145);class h extends l.A_InsertElement{constructor(){super(...arguments),this.TeechImgEnum=a.default.TeechImg,this.elePos=-1,this.paEle=null}ActName(){return"InsertSyncImg"}Execute(e){this.resMsg.Clear(),this.getSyncImageInfo(e[0]);let t=super.Execute([null,null,this.elePos,this.paEle]);if(null==this.newEle||null==this.newEle.Parent)t=this.resMsg;else{let e=super.GetEdtCtrl().M_GetHandlerLayerMgr();null!=e&&e.Handle(s.ENumEvtSrc.MOUSE_LPRESS,o.Keys.None,0,0,0,0),t=this.resMsg}return t}getSyncImageInfo(e){const t=e.imgObj;u.LangUtils.IsString(t)&&(this.newBitmap=t);const n=e.conceptDomainCode;u.LangUtils.IsString(n)&&(this.cptId=n);const r=e.dataEmementName;u.LangUtils.IsString(r)&&(this.dataEmementName=r);const i=e.extendAttr1;u.LangUtils.IsString(i)&&(this.extendAttr1=i);const l=!!e.hideFlag;this.hideFlag=l;const s=null!=e.deleteFlag&&e.deleteFlag;this.deletable=s;const o=null==e.IsImgBase64||e.IsImgBase64;this.IsImgBase64=o;const a=Number(e.width);isNaN(a)||(this.imgWidth=a);const h=Number(e.height);isNaN(h)||(this.imgHeight=h);const d=e.elementName;u.LangUtils.IsString(d)&&(this.elementName=d);const c=!!e.imgHaveValue;let p;this.imgHaveValue=c;const f=e.posId;if(u.LangUtils.IsString(f)&&f){const e=super.GetXDocFocused();if(null!=e){p=e.GetFirstChildByIds(f)}}const g=e.posDirect;if("inner"==g&&null!=p&&"XInputField"==p.EleTypeName){p=p.GetLastChildEle()}this.setPaEleAndElePos(p),("after"==g||!g)&&null!=this.paEle&&this.elePos<this.paEle.ChildCount&&this.elePos++}setPaEleAndElePos(e){if(null!=e){const t=["XInputField","XTextTableCell","XTextBody","XTextHeader","XTextFooter","XString"];let n=!0,r=e;for(;n;)this.paEle=r.Parent,null==this.paEle?n=!1:-1==t.indexOf(this.paEle.EleTypeName)?r=this.paEle:n=!1;null!=r&&(this.elePos=this.paEle.GetChildInx(r))}else this.paEle=null,this.elePos=-1}CrtNewEle(e,t){let n,l=r.XElementFactory.CreatXElement("XImage",null),s=l instanceof i.XImageEle?l:null;if(s.CptID=this.cptId,s.Attr_FgHide=this.hideFlag,s.SetHideFlag=this.hideFlag,s.HaveValue=this.imgHaveValue,s.Deletable=this.deletable,s.SetAttribute("decodeName",this.dataEmementName),s.Title=this.elementName,s.ExtendAttr1=this.extendAttr1,null==s)!0,n=null;else{const e=super.GetEdtCtrl().M_EleEvtModel.EleClicked;let t,r;if(s.ImageType="SyncImage",s.ImgInfo.IsImgBase64=this.IsImgBase64,this.IsImgBase64||(s.ImgInfo.ImgBase64=this.newBitmap),s.DataString=this.cptId,s.setImgObj(this.newBitmap,this.IsImgBase64),this.imgWidth>0&&this.imgHeight>0)t=this.imgWidth,r=this.imgHeight;else if(null!=e&&null!=e.OwnerLine){const n=e.OwnerLine.Height;t=n,r=n,this.imgOnloadRefresh(s,e)}else t=14,r=14,this.imgOnloadRefresh(s,e);s.ImgObj.Width=t,s.ImgObj.Height=r,s.InitSizeByImgObj(e),!1,n=l}return n}imgOnloadRefresh(e,t){let n=new Image;n.src=this.newBitmap,n.onload=()=>{let r=n.naturalHeight>0?n.naturalWidth:n.width,i=n.naturalHeight>0?n.naturalHeight:n.height;e.ImgObj.Width=r,e.ImgObj.Height=i,e.InitSizeByImgObj(t),e.IsLayoutValid=!1,super._RefreshPageAndMoveCaretBetweenEle(e,t,!1)}}}t.A_InsertSyncImage=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_DocHasChanged=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"DocHasChanged"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl();n.unfocus=!0;let r,i=[],l=n.All_Document;for(let e=0;e<l.length;e++)r=l[e],r.IsChanged&&i.push({docId:r.DocID});return this.resMsg.ReturnParams=i,t=this.resMsg,t}}t.A_DocHasChanged=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_LocateCursorToParagrEnd=void 0;const r=n(1),i=n(3),l=n(0),s=n(6);class o extends r.XBaseAction{ActName(){return"LocateCursorToParagrEnd"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl(),n=e[0],r=null;try{let e=t.All_Document;for(var o=0;o<e.length;o++){let a=e[o].GetPagePanel(s.ENumPagePanelTp.Body),u=new i.List;a.GetChildrenByType("XTextLabelElement",!0,u);let h=null;for(let e of u)e.CptID==n&&(h=e);if(null==h)break;let d=null,c=l.XDomUtil.GetParentCell(h);if(d=null==c?a.GetLastChildByTitleId(n):c.GetLastChildByTitleId(n),null==d)break;let p=l.XDomUtil.GetNextEle(!1,d),f=l.XDomUtil.GetNextEle(!1,p);r={firstElement:p.EleTypeName,secondELement:f.EleTypeName},t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(d),t.M_EleEvtModel.MoveCaretByCursorEle(!0)}this.resMsg.ReturnParams=r}catch(e){this.resMsg.ReturnParams=r}return this.resMsg}}t.A_LocateCursorToParagrEnd=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetAllElementValue=void 0;const r=n(1),i=n(3),l=n(33),s=n(0);class o extends r.XBaseAction{constructor(e){super(e),this.getDataSrcId=!1}ActName(){return"GetAllElementValue"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl().All_Document,n=new i.List,r=e.docId;for(var o=0;o<t.length;o++){if(r&&t[o].DocID!=r)continue;let e=new l.EmrCalcEngine(t[o]);e.GetXDocHeader().GetChildrenByTypes(["XInputField","XTextCheckBox","XTextRadioBox"],!0,n),e.GetXDocBody().GetChildrenByTypes(["XInputField","XTextCheckBox","XTextRadioBox"],!0,n)}e&&e.getDatasCode&&(this.getDataSrcId=e.getDatasCode);let a={};for(let e of n){if(e.CptID||(e.CptID=e.XID),null==a[e.CptID]&&(a[e.CptID]=""),e instanceof s.XInputEle&&(a[e.CptID]=e.InnerValue,this.getDataSrcId)){const t=e.getDatasCode();null!=t&&(a[e.CptID]=t)}e instanceof s.XRadioBoxEle&&e.Checked&&(a[e.CptID]=e.CheckedValue),e instanceof s.XCheckBoxEle&&e.Checked&&(a[e.CptID]?a[e.CptID]=a[e.CptID]+","+e.CheckedValue:a[e.CptID]=e.CheckedValue)}return this.resMsg.ReturnParams=a,this.resMsg}}t.A_GetAllElementValue=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_FavoritesPhrases=void 0;const r=n(2),i=n(1),l=n(14),s=n(0),o=n(65),a=n(62),u=n(6),h=n(145),d=n(38),c=n(89);class p extends i.XBaseAction{constructor(){super(),this.reFormat="xml",this.widthHideEngine="OnLastEle",super.OpType=r.ENumActOpType.Save}ActName(){return"FavoritesPhrases"}Execute(e){this.resMsg.Clear();let t={};Array.isArray(e)&&e.length?t=e[0]:null!=e&&(t=e),this.formatParamVals(t);try{const e=super.GetEdtCtrl().M_EleEvtModel.SelRange;let t,n=new d.List,r=[];if(this.isAddEngine){r=e.InfoUtil.GetLineElesInRange(!1,!1,!0),null!=r&&r.length>0&&(t=r[r.length-1]),r=this.addHideEngine(r),r=e.InfoUtil.ClearTraceEle(r),n=o.EmrClipboard.Copy_SelEles(r,!0,!0);const i=c.MsgRegisterHandler.changeAllChildrenNewIdAndXId(n,!0);c.MsgRegisterHandler.updateAllExpressStr(i[0],i[1],n)}else r=e.InfoUtil.GetLineElesInRange(!0,!1),null!=r&&r.length>0&&(t=r[r.length-1]),n=o.EmrClipboard.Copy_SelEles(r,!1,!0);let i="";if(n.Length>0)if("text"==this.reFormat)for(let e=0;e<r.length;e++)i+=r[e].GetInnerText(!0);else{let e=this.getOldXPagraph(t);null!=e&&(e.OwnerDocPanel=n.Get(0).OwnerDocPanel,e.Document=n.Get(0).Document,n.Add(e));let r=new a.XTextDocument(!1);for(let e=0;e<n.Count();e++){const t=n.Get(e);this.updateOwnerDocPanel(t,r.GetPagePanel(u.ENumPagePanelTp.Body))}let o=new s.XParagraphFlag;o.OwnerDocPanel=r.GetPagePanel(u.ENumPagePanelTp.Header),r.GetPagePanel(u.ENumPagePanelTp.Header).ChildEleList.Add(o),(new s.XParagraphFlag).OwnerDocPanel=r.GetPagePanel(u.ENumPagePanelTp.Footer),r.restoreChildrenList(n);let h=r.ToXML();i='<?xml version="1.0" encoding="utf-8"?>'+l.XmlDomUtil.Xml2String(h)}this.resMsg.ReturnParams=i}catch(e){this.resMsg.Ex=e}return super.GetEdtCtrl().Focus(),this.resMsg}formatParamVals(e){const t=e.type;h.LangUtils.IsString(t)&&(this.reFormat=t);const n=e.widthHideEngine;h.LangUtils.IsString(n)?this.widthHideEngine=n:this.widthHideEngine="OnLastEle",this.isAddEngine="xml"==t&&("OnLastEle"==n||"OnPagraph"==n||"OnTitLabel"==n||"OnDoc"==n),this.widthPagraph=!!e.widthPagraph}addHideEngine(e){if(null==e)return e;const t=e[0];if(null==t)return e;const n=e[e.length-1];if(null==n)return e;const r=t.Document;if(null==r)return e;c.MsgRegisterHandler.RegisterExpressionToMsgBus(r,!0);const i=r.GetBodyChildren();if(null==i||i.Count()<1)return e;let l=s.XDomUtil.GetAllBaseEles(i.ToArray(),new d.List);const o=l.IndexOf(t);if(o<0)return e;const a=l.IndexOf(n);if(a<0)return e;const u=l.ToArray();let h=u.slice(o,a+1),[p,f]=[0,i.Count()-1];"OnLastEle"==this.widthHideEngine?[p,f]=this.getIxByEleType(o,a,"Attr_FgHide",u):"OnPagraph"==this.widthHideEngine?[p,f]=this.getIxByEleType(o,a,"XParagraphFlag",u):"OnTitLabel"==this.widthHideEngine?[p,f]=this.getIxByEleType(o,a,"XTextLabelElement",u):this.widthHideEngine;const g=r.AssistFunc.MsgBus.M_msgBus;let m=[],E=[],C=[],A=[];for(let e=0;e<h.length;e++){let t=h[e];if(null!=t)for(;null!=t.Parent;){const e=t.XID;if(-1!=m.indexOf(e))break;m.push(e);const n=g.TryGetValue(e)[1];if(null==n||n.Count()<1)t=t.Parent;else for(let e=0;e<n.Count();e++){const t=n.Get(e).DataContext;if(null==t)continue;const r=t.XID;if(-1!=E.indexOf(r))continue;E.push(r);let i=-1,u=-1,h=new d.List;if(t instanceof s.XBaseContainer?h=s.XDomUtil.GetAllBaseEles(t.ChildEleList.ToArray(),h):h.Add(t),null==h||h.Count()<1)continue;const c=1==h.Count();let g=h.Get(0),m=c?g:h.Get(h.Count()-1);null!=g&&null!=m&&(i=l.IndexOf(g),u=c?i:l.IndexOf(m),i<0||u<0||i>=o&&i<=a||u>=o&&u<=a||(i<p||i>f)&&(u<p||u>f)||(C[i]=h))}}}for(let e=0;e<C.length;e++){const t=C[e];null!=t&&(A=[...A,...t.ToArray()])}return[...h,...A]}getIxByEleType(e,t,n,r){let i=0,l=r.length-1;if(null==r||null==e||null==t||null==n||l<2)return[i,l];const s="Attr_FgHide"==n;for(let t=e;t>=0;t--){const e=r[t];if((!s||!e.IsHidden())&&e.EleTypeName==n){i=t;break}}for(let e=t;e<=l;e++){const t=r[e];if((!s||!t.IsHidden())&&t.EleTypeName==n){l=e;break}}return[i,l]}getOldXPagraph(e){let t=new s.XParagraphFlag;if(null==e)return t;if(e instanceof s.XParagraphFlag)return null;if(!this.widthPagraph)return t;const n=e.OwnerLine;if(null==n)return t;const r=n.RelEleParagraph;return null==r?t:r}}t.A_FavoritesPhrases=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertDiagnosisEle=void 0;const r=n(0),i=n(20),l=n(54),s=n(68),o=n(42);class a extends s.A_BaseInsertInput{ActName(){return"InsertDiagnosisEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new l.ElementInfo;i.Code_mrdetp="4001",i.DiagnoseType=n.diagnoseType,i.CanEmpty=n.emptyFlag,i.Fg_edit=!1,i.IsAllowKeyInput=null,i.Fg_delete=n.deleteFlag,i.IsPrint=n.printFlag,i.IsDisSkip=n.skipFlag,i.Fg_border=n.borderFlag,i.Arrangement=n.arrangement,i.SplitChar=n.splitChar||"",i.ShowWay=n.showWay,i.InTable=n.inTable,i.InTableColIx=n.colIx,i.EditorEventActiveMode=n.editorEventActiveMode,i.InputEventName=n.triggerAction,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag,i.CustomAttribute=n.CustomAttribute,i.Name=n.elementName,i.Name_de=n.dataEmementName,i.ValueCode_de=n.dataEmementCode,i.conceptDomainCode=n.conceptDomainCode,i.ExtendAttr1=n.extendAttr1,i.Id_mr_de=n.elementCode;let s=o.XInputFactory.GetInstance().GetDiagnosisEle(i),a=s instanceof r.XInputEle?s:null;if(null==a)return t=this.resMsg,t;if(a.ElementInfo=i,this.InsertValid())if(a.InTable){let e=0,t=Number(n.colIx);t>=0||(t=0);let r=[];r[e]=[],r[e][t]=a;super.GetEdtCtrl().M_GetActionByName("InsertDiagPosTable").Execute([{columnNumberString:2,lineNumberString:1,innerArr:r}])}else t=super.Execute([a]);else a.InTable=!0,a.ElementInfo.InTable=!0,t=super.Execute([a]);return t}InsertValid(){let e=super.GetEdtCtrl().M_EleEvtModel.EleClicked;return null==i.XTextTableUtil.GetCursorCell(e)}}t.A_InsertDiagnosisEle=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetValidateList=void 0;const r=n(1),i=n(3),l=n(0),s=n(6);class o extends r.XBaseAction{constructor(e){super(e)}ActName(){return"GetValidateList"}Execute(e){this.resMsg.Clear(),this._choiceGrpId={};let t=new i.List;if(super.GetEdtCtrl().unfocus=!0,e.length>0)for(let n=0;n<e.length;n++){let r=e[n].docId;this.getValidate(t,r)}else this.getValidate(t);let n=new i.List;for(let e=0;e<t.Count();e++){const r=t.Get(e);l.XDomUtil.HasDelTrace(r)||n.Add(r)}t=n;let r=[];if(t.Length>0)for(let e of t)e instanceof l.XInputEle&&r.push({docId:e.Document.DocID,cptId:e.CptID,xid:e.XID,msg:e.ToolTip,title:e.Name,bgcText:e.BackgroundText});for(let e in this._choiceGrpId){let t={};t={grpId:e,msg:"当前组件为必选"},r.push(t)}return this.resMsg.ReturnParams=r,this.resMsg}getValidate(e,t){let n=super.GetEdtCtrl().All_Document;for(var r=0;r<n.length;r++){const o=n[r];if(null!=o){if(t&&o.DocID!=t)continue;let n=new i.List;o.GetPagePanel(s.ENumPagePanelTp.Body).GetChildrenByTypes(["XInputField","XTextCheckBox","XTextRadioBox"],!0,n);for(let t of n)if(t instanceof l.XInputEle){t.StartValueValidate(!0,null,!0)||e.Add(t)}else if(t instanceof l.XBaseChoiceEle){t.StartValueValidate(!0,null)||(this._choiceGrpId[t.GrpID]||(this._choiceGrpId[t.GrpID]=[]),this._choiceGrpId[t.GrpID].push({docId:t.Document.DocID,cptId:t.CptID,msg:t.ToolTip,title:t.Name}))}}}}}t.A_GetValidateList=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_OpenDocs=void 0;const r=n(2),i=n(70),l=n(1);class s extends l.XBaseAction{ActName(){return"FilesOpen"}constructor(){super(),super.OpType=r.ENumActOpType.CtntEdit}Execute(e){this.resMsg.Clear();let t,n=(null==e?0:e.length)<=0?null:e[0],l=super.GetEdtCtrl();try{let e=[];for(let t=0;t<n.length;t++){let s=new i.XDocLoadParam(null,r.ENumXDocPath.LocalFile);s.SrcStr=n[t].xml,null!=l.M_EleEvtModel.WorkMode&&(s.WorkMode=l.M_EleEvtModel.WorkMode),e.push({xdocLoadParam:s,docId:n[t].docId})}l.MLoadXmlDocuments(e),this.resMsg.ReturnParams=!0}catch(e){this.resMsg.Ex=e,this.resMsg.ReturnParams=!1}return t=this.resMsg,t}}t.A_OpenDocs=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CloseDocByDocId=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"CloseDocByDocId"}constructor(){super()}Execute(e){this.resMsg.Clear();let t,n=(null==e?0:e.length)<=0?null:e;try{super.GetEdtCtrl().CloseDocByDocId(n)}catch(e){this.resMsg.Ex=e}return t=this.resMsg,t}}t.A_CloseDocByDocId=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetDocList=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"GetDocList"}constructor(){super()}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl();n.unfocus=!0;let r=[];try{let e=n.All_Document;for(let t=0;t<e.length;t++){let n=e[t];r.push({docId:n.DocID})}}catch(e){this.resMsg.Ex=e}return this.resMsg.ReturnParams=r,t=this.resMsg,t}}t.A_GetDocList=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetXmlByDocIndex=void 0;const r=n(1),i=n(14);class l extends r.XBaseAction{ActName(){return"GetXmlByDocIndex"}constructor(){super()}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),r=(e.length,[]);try{let t=n.All_Document;for(let n=0;n<t.length;n++){let l=t[n];if(e.indexOf(n)>-1){let e=l.ToXML(),t='<?xml version="1.0" encoding="utf-8"?>'+i.XmlDomUtil.Xml2String(e);r.push(t)}}}catch(e){this.resMsg.Ex=e}return this.resMsg.ReturnParams=r,t=this.resMsg,t}}t.A_GetXmlByDocIndex=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_CloseDocs=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"CloseDocs"}constructor(){super()}Execute(e){let t;this.resMsg.Clear();try{super.GetEdtCtrl().MTryCloseDocument()}catch(e){this.resMsg.Ex=e}return t=this.resMsg,t}}t.A_CloseDocs=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_LocateCursorWithInput=void 0;const r=n(1),i=n(3),l=n(33),s=n(0),o=n(32);class a extends r.XBaseAction{ActName(){return"LocateCursorWithInput"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl(),n=(null==e?0:e.length)<=0?null:e[0],r=!1;try{if(null==n)return this.resMsg.ReturnParams=!1,this.resMsg;let e=n.cptId,u=n.position,h=n.docId,d=n.idType,c=n.titleCptId,p=0!=n.cursorChange;this.xdoc=t.All_Document;let f=t.M_EleEvtModel.EleClickedWrap.EleFocused;for(var a=0;a<this.xdoc.length;a++){if(h&&this.xdoc[a].DocID!=h)continue;let n,g,m=new l.EmrCalcEngine(this.xdoc[a]),E=new i.List;if(c)if(e){let t=new i.List;this.xdoc[a].GetChildrenListByCptId(c,t);for(let n of t)n instanceof s.XInputEle&&("XID"==d?e==n.XID&&E.Add(n):e==n.CptID&&E.Add(n))}else m.GetXDocBody().GetChildrenByCptId(c,!0,E);else"XID"==d?m.GetXDocBody().GetChildrenByXID(e,!0,E):m.GetXDocBody().GetChildrenByCptId(e,!0,E);if(0==E.Length)return;if(c&&!e){for(let e of E)if(e instanceof o.XTextLabelElement){n=e;break}"after"==u||"innerafter"==u?g=s.XDomUtil.GetNextEle(!0,n):"before"!=u&&"innerbefore"!=u||(g=s.XDomUtil.GetNextEle(!1,n))}else{for(let e of E)if(e instanceof s.XInputEle){n=e;break}if(n instanceof s.XInputEle){let e,t;r=!0,"after"==u?(e=!0,t=n.EndEle,g=s.XDomUtil.GetNextEle(e,t)):"before"==u?(e=!1,g=n.StartEle):"innerbefore"==u?(e=!0,t=n.LabelTextEle?n.LabelTextEle:n.StartEle,g=s.XDomUtil.GetNextEle(e,t)):"innerafter"==u&&(e=!1,g=n.SuffixTextEle?n.SuffixTextEle:n.UnitLabelTextEle?n.UnitLabelTextEle:n.EndEle)}}if(t.M_EleEvtModel.ReInitSelRange(),t.M_EleEvtModel.LastEleClicked instanceof s.XImageEle&&(t.M_EleEvtModel.LastEleClicked.IsFocused=!1),t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(g),p){let e=t.M_EleEvtModel.EleClickedWrap.EleFocused;t.M_EleEvtHandler.OnCursorChange(f,e),t.M_EleEvtModel.MoveCaretByCursorEle(!0)}}this.resMsg.ReturnParams=r}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}}t.A_LocateCursorWithInput=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_LocateCursorWithDocId=void 0;const r=n(1),i=n(6),l=n(46),s=n(109);class o extends r.XBaseAction{ActName(){return"LocateCursorWithDocId"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl(),n=e.length>0?e[0]:null,r=n.docId,i=!1!==n.isFirst,l=!1!==n.resetScroll;if(this.xdoc=t.All_Document,r){for(var s=0;s<this.xdoc.length;s++)if(this.xdoc[s].DocID==r){let e=this.xdoc[s];this.moveCorsorEle(e,i,l)}}else this.moveCorsorEle(this.xdoc[0],i,l);return this.resMsg}moveCorsorEle(e,t=!0,n=!0){let r;if(t)r=e.GetPagePanel(i.ENumPagePanelTp.Body).LinesList.Get(0).FirstElement;else{let t=e.GetPagePanel(i.ENumPagePanelTp.Body).LinesList;r=t.Get(t.Count()-1).LastElement}let o=super.GetEdtCtrl(),a=o.M_EleEvtModel;if(a.EleClickedWrap.LineEleIxFocused.SetEle(r),a.MoveCaretByCursorEle(!0),n){o.M_EdtCaret.M_caretInput.focus();let e=o.ContainerDOM.querySelector("#pango-editor-content-"+o.ContainerDOM.id),t=s.DomUtils.GetOffset(e),n=o.GetAlertFormStartRect(l.PositionEnum.LeftTop,0,0,"focused").Location,r=t.top-n.Y;e.scrollTop=e.scrollTop-r}}}t.A_LocateCursorWithDocId=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetEditableByDocId=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"SetEditableByDocId"}constructor(){super()}Execute(e){let t;this.resMsg.Clear();let n=null==e?0:e.length;if(0!=n){try{let t=n<=0?null:e,r=super.GetEdtCtrl();r.unfocus=!0;for(let e=0;e<t.length;e++){let n=t[e],i=n.docId,l=n.isEditable,s=r.All_Document;for(let e=0;e<s.length;e++){let t=s[e];t.DocID==i&&(l?t.IsEditable=!0:(t.IsEditable=!1,t.Readonly=!0))}}this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1,this.resMsg.Ex=e}return t=this.resMsg,t}}}t.A_SetEditableByDocId=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdateValueList=void 0;const r=n(1),i=n(87),l=n(3),s=n(0),o=n(33),a=n(40);class u extends r.XBaseAction{ActName(){return"UpdateValueList"}Execute(e){let t;if(0==(null==e?0:e.length))return;let n=super.GetEdtCtrl();try{for(let t=0;t<e.length;t++){let r=e[t],i=r.cptId,u=null==r.idType?"CptId":r.idType,h=r.valueList,d=r.docId,c=n.All_Document;for(let e=0;e<c.length;e++){let t=c[e];if(d&&t.DocID!=d)continue;let n=new o.EmrCalcEngine(t),r=new l.List;if("CptId"==u?(n.GetXDocHeader().GetChildrenByCptId(i,!0,r),n.GetXDocBody().GetChildrenByCptId(i,!0,r)):(n.GetXDocHeader().GetChildrenByXID(i,!0,r),n.GetXDocBody().GetChildrenByXID(i,!0,r)),r.Length>0){let e=r.ToArray();for(let t=0;t<e.length;t++){let n=e[t];if(n instanceof s.XInputEle){let e=n;e.InputType!=a.EleTypeEnum.SingleChoiceDropEle&&e.InputType!=a.EleTypeEnum.MoreChoiceDropEle||this.setValueList(h,e)}}}}}}catch(e){}return t=this.resMsg,t}setValueList(e,t){let n=new l.List;if(null!=e&&null!=e)for(let t=0;t<e.length;t++){let r=new i.SelEleItemInfo,l=e[t].Value,s=e[t].Key,o=e[t].Level,a=e[t].GroupNum,u=e[t].ChildEleItems;if(null!=u&&null!=u)for(let e=0;e<u.length;e++){let t=new i.SelEleItemInfo,n=u[e].Value,l=u[e].Key,s=u[e].Level;t.Value=n,t.Key=l,t.Level=s,r.ChildEleItems.Add(t)}r.Value=l,r.Key=s,r.Level=o,r.Index=t+1,r.GroupNum=a,n.Add(r)}if(t.DataSrc.Clear(),null!=n&&n.Count()>0&&null!=n)for(let e=0;e<n.Length;e++)t.DataSrc.AddData1(n.Get(e))}}t.A_UpdateValueList=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetXMLListWithTitle=void 0;const r=n(2),i=n(1),l=n(3),s=n(33),o=n(0);class a extends i.XBaseAction{ActName(){return"GetXMLListWithTitle"}constructor(e){super(e),super.OpType=r.ENumActOpType.Save}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl();n.unfocus=!0;let r=n.M_DocumentFocused,i=new s.EmrCalcEngine(r),a=new l.List,u=[],h=!1,d=!1,c=!0;e.length>0&&(h=e[0].getInputLabel,c=e[0].getHide,d=!0===e[0].onlyChecked),i.GetXDocBody().GetChildrenByType("XTextLabelElement",!0,a);for(let e of a){if(e.IsHidden())continue;if(e.Parent instanceof o.XTextTableCell&&!e.Parent.Visible)continue;let t=e.Parent;if(null!=t){let n=this.getXmlByCptIdInParent1(e,t,h,c,d);u.push(Object.assign({cptId:e.CptID,elementName:e.EleText,showName:e.Text,extendAttr:e.ExtendAttr1,titleLevel:e.TitleLevel,levelTerm:e.LevelTerm},n))}}return this.resMsg.ReturnParams=u,t=this.resMsg,t}}t.A_GetXMLListWithTitle=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetElementListWithAttr=void 0;const r=n(1),i=n(3),l=n(33),s=n(0),o=n(40),a=n(32);class u extends r.XBaseAction{ActName(){return"GetElementListWithAttr"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t=[];if(super.GetEdtCtrl().unfocus=!0,e.length>0)for(let n=0;n<e.length;n++){let r=e[n].docId,i=e[n].conceptId,l=this.GetAllElementValue(r,i);t.push(...l)}else t=this.GetAllElementValue(null,null);return this.resMsg.ReturnParams=t,this.resMsg}GetAllElementValue(e,t){var n,r,a,u,h,d,c,p,f,g;let m=super.GetEdtCtrl().All_Document,E=[];for(var C=0;C<m.length;C++){if(e&&m[C].DocID!=e)continue;let I=new l.EmrCalcEngine(m[C]),S={docId:m[C].DocID,valueList:[]},_=[],w=new i.List;I.GetXDocHeader().GetChildrenByTypes(["XInputField","XTextCheckBox","XTextRadioBox","XMedicalExpressionField"],!0,w),I.GetXDocBody().GetChildrenByTypes(["XInputField","XTextCheckBox","XTextRadioBox","XImage","XMedicalExpressionField"],!0,w),I.GetXDocFooter().GetChildrenByTypes(["XInputField","XTextCheckBox","XTextRadioBox","XImage","XMedicalExpressionField"],!0,w);let b={},x={};for(let e of w)if(!t||e.CptID==t)if(e instanceof s.XInputEle){let t,r,i,l=e.Parent,a=1;for(;l instanceof s.XInputEle;)l=l.Parent,a++;let u,h,d=null,c=e.GetInnerText(!1);if(e.InputType==o.EleTypeEnum.SingleChoiceDropEle||e.InputType==o.EleTypeEnum.MoreChoiceDropEle){if(e.DynamicData){let n,r=[];if(e.DynamicDataValue&&(n=JSON.parse(e.DynamicDataValue),"object"==typeof n&&n.constructor==Array))for(let e=0;e<n.length;e++)r.push(n[e].key);t=r,u=n}else{let n=[],r=e.DataSrc.DataList,i=c.split("、"),l=[];for(let e of r)if("object"==typeof i&&i.constructor==Array)for(var A=0;A<i.length;A++)e.Value==i[A]&&(l.push({key:e.Key,value:e.Value}),n.push(e.Key));u=l,t=n}r=c}else i=e.UnitText,r=c,t=e.InnerValue,d=e.DateTimeValue;e.hasChildWithImag(!1)&&(h=e.GetInnerTextWithBase64(!1)),_.push({cptId:e.CptID,eleType:e.GetInputTypeNum(),GrpID:e.GrpID,elementName:e.Name,valueCode_de:e.GetAttribute("deValueCode"),name:e.GetAttribute("decodeName"),extendAttr1:e.ExtendAttr1,value:t,InnerValue:r,DateTimeValue:d,titleCptId:null===(n=this.getXtextLabelElement(e))||void 0===n?void 0:n.CptID,innerTextWithBase64:h,unitText:i,LabelText:e.LabelText,SuffixText:e.SuffixText,xid:e.XID,bgcText:e.BackgroundText,tooTip:e.ToolTip,DynamicDataValue:u,levelNum:a,parentXid:a>1?e.Parent.XID:null,container:e.OwnerDocPanel.EleTypeName,LackEllipsisvalue:e.LackEllipsisvalue,DynamicData:e.DynamicData?JSON.parse(decodeURIComponent(e.DynamicData)):null}),b[e.CptID]=e.InnerValue}else if(e instanceof s.XImageEle&&null!=e.CptID)_.push({cptId:e.CptID,eleType:e.ImgInfo.IsImgBase64?14:15,GrpID:e.GrpID,elementName:e.Title,valueCode_de:e.GetAttribute("deValueCode"),name:e.GetAttribute("decodeName"),extendAttr1:e.ExtendAttr1,titleCptId:null===(r=this.getXtextLabelElement(e))||void 0===r?void 0:r.CptID,value:e.ImgInfo.ImgBase64,bgcText:void 0,tooTip:e.ToolTip,container:e.OwnerDocPanel.EleTypeName,LackEllipsisvalue:e.LackEllipsisvalue,DynamicData:e.DynamicData?JSON.parse(decodeURIComponent(e.DynamicData)):null});else if(e instanceof s.XBaseChoiceEle){let t=e.GrpID;-1==Object.keys(x).indexOf(t)?(x[t]={cptId:e.CptID,eleType:e instanceof s.XRadioBoxEle?7:6,GrpID:e.GrpID,elementName:e.Name,valueCode_de:e.GetAttribute("deValueCode"),name:e.GetAttribute("DecodeName"),extendAttr1:e.ExtendAttr1,titleCptId:null===(a=this.getXtextLabelElement(e))||void 0===a?void 0:a.CptID,value:[],bgcText:void 0,tooTip:e.ToolTip,container:e.OwnerDocPanel.EleTypeName,LackEllipsisvalue:e.LackEllipsisvalue,DynamicData:e.DynamicData?JSON.parse(decodeURIComponent(e.DynamicData)):null},e.Checked&&x[t].value.push(e.CheckedValue)):e.Checked&&x[t].value.push(e.CheckedValue)}else if(e instanceof s.XMedicalExpressionField){if(e.IsRemoved)continue;let t=e.ExpressionStyle,n=e.ExpressionInfo.MedicalValue;switch(t){case"FourValues":_.push({type:t,GrpID:e.GrpID,elementName:e.Name,valueCode_de:e.GetAttribute("deValueCode"),cptId:e.CptID,name:e.GetAttribute("decodeName"),titleCptId:null===(u=this.getXtextLabelElement(e))||void 0===u?void 0:u.CptID,container:e.OwnerDocPanel.EleTypeName,value1:n.split(",")[0],value2:n.split(",")[1],value3:n.split(",")[2],value4:n.split(",")[3],value5:n.split(",")[4],value6:n.split(",")[5]});break;case"FourValues1":_.push({type:t,cptId:e.CptID,name:e.GetAttribute("decodeName"),titleCptId:null===(h=this.getXtextLabelElement(e))||void 0===h?void 0:h.CptID,container:e.OwnerDocPanel.EleTypeName,value1:n.split(",")[0],value2:n.split(",")[1],value3:n.split(",")[2],value4:n.split(",")[3]});break;case"FourValues2":_.push({type:t,cptId:e.CptID,name:e.GetAttribute("decodeName"),titleCptId:null===(d=this.getXtextLabelElement(e))||void 0===d?void 0:d.CptID,container:e.OwnerDocPanel.EleTypeName,value1:n.split(",")[0],value2:n.split(",")[1],value3:n.split(",")[2],value4:n.split(",")[3]});break;case"ThreeValues":_.push({type:t,cptId:e.CptID,name:e.GetAttribute("decodeName"),titleCptId:null===(c=this.getXtextLabelElement(e))||void 0===c?void 0:c.CptID,container:e.OwnerDocPanel.EleTypeName,value1:n.split(",")[0],value2:n.split(",")[1],value3:n.split(",")[2]});break;case"Pupil":_.push({type:t,cptId:e.CptID,name:e.GetAttribute("decodeName"),titleCptId:null===(p=this.getXtextLabelElement(e))||void 0===p?void 0:p.CptID,container:e.OwnerDocPanel.EleTypeName,value1:n.split(",")[0],value2:n.split(",")[1],value3:n.split(",")[2],value4:n.split(",")[3],value5:n.split(",")[4],value6:n.split(",")[5],value7:n.split(",")[6]});break;case"LightPositioning":_.push({type:t,cptId:e.CptID,name:e.GetAttribute("decodeName"),titleCptId:null===(f=this.getXtextLabelElement(e))||void 0===f?void 0:f.CptID,container:e.OwnerDocPanel.EleTypeName,value1:n.split(",")[0],value2:n.split(",")[1],value3:n.split(",")[2],value4:n.split(",")[3],value5:n.split(",")[4],value6:n.split(",")[5],value7:n.split(",")[6],value8:n.split(",")[7],value9:n.split(",")[8]});break;case"FetalHeart":_.push({type:t,cptId:e.CptID,name:e.GetAttribute("decodeName"),titleCptId:null===(g=this.getXtextLabelElement(e))||void 0===g?void 0:g.CptID,container:e.OwnerDocPanel.EleTypeName,value1:n.split(",")[0],value2:n.split(",")[1],value3:n.split(",")[2],value4:n.split(",")[3],value5:n.split(",")[4],value6:n.split(",")[5]})}}if(Object.keys(x).length>0)for(var y in x)_.push({cptId:x[y].cptId,name:x[y].name,bgcText:x[y].bgcText,tooTip:x[y].tooTip,eleType:x[y].eleType,extendAttr1:x[y].extendAttr1,value:x[y].value,titleCptId:x[y].titleCptId,LackEllipsisvalue:x[y].LackEllipsisvalue,DynamicData:x[y].DynamicData,container:x[y].container});S.valueList=_,E.push(S)}return E}getXtextLabelElement(e){var t;if(e instanceof a.XTextLabelElement)return e;{let n=null===(t=e.Parent)||void 0===t?void 0:t.ChildEleList;if(!n)return null;{let t=null;for(let r of n)if(r instanceof a.XTextLabelElement&&!r.IsHidden())t=r;else if(r.XID==e.XID)return null!=t?t:this.getXtextLabelElement(e.Parent)}}}}t.A_GetElementListWithAttr=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ResetXDocsChanged=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"ResetXDocsChanged"}Execute(e){this.resMsg.Clear();let t,n,r=super.GetEdtCtrl();r.unfocus=!0;try{let t=e.length,i=[];if(t>0)for(let t=0;t<e.length;t++){let n=e[t];i.push(n.docId)}let l=r.All_Document;for(let e=0;e<l.length;e++){let t=l[e];i.length>0&&-1==i.indexOf(t.DocID)||t.ResetChangedFlag()}n=!0}catch(e){this.resMsg.Ex=e,n=!1}return this.resMsg.ReturnParams=n,t=this.resMsg,t}}t.A_ResetXDocsChanged=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertDiagPosTable=void 0;const r=n(372);class i extends r.A_CreateTextTable{ActName(){return"InsertDiagPosTable"}Execute(e){let t=e[0];if(this.resMsg.Clear(),!(t instanceof Object))return this.resMsg.MsgStr="插入诊断表格时传参异常",this.MessageError(),this.resMsg;const n=t.diagTableId;n&&(t.CptID=n);const r=t.posCID;r&&(t.posCID=r),Number(t.columnNumberString)>0||(t.columnNumberString=2),Number(t.lineNumberString)>0||(t.lineNumberString=1);let i=t.innerArr;return i instanceof Array&&i.length>0&&(t.lineNumberString=Math.max(t.lineNumberString,i.length)),t.eleStyle instanceof Object||(t.eleStyle={}),1!=t.BorderTop&&(t.eleStyle.BorderTop=!1),1!=t.BorderBottom&&(t.eleStyle.BorderBottom=!1),1!=t.BorderLeft&&(t.eleStyle.BorderLeft=!1),1!=t.BorderRight&&(t.eleStyle.BorderRight=!1),1!=t.BorderVerticalCenter&&(t.eleStyle.BorderVerticalCenter=!1),1!=t.BorderHorizontalCenter&&(t.eleStyle.BorderHorizontalCenter=!1),super.Execute([t])}}t.A_InsertDiagPosTable=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SaveDocAsText=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"FileSaveAsText"}Execute(e){let t;this.resMsg.Clear();let n=[];super.GetEdtCtrl().unfocus=!0;try{if(e.length>0)for(let t=0;t<e.length;t++){let r=e[t].docId,i=!0===e[0].onlyChecked,l=!1!==e[0].getHide,s=this.GetText(r,l,i);n.push(...s)}else{n=this.GetText()}}catch(e){this.resMsg.Ex=e}return this.resMsg.ReturnParams=n,t=this.resMsg,t}GetText(e,t=!0,n=!1){let r=[],i=super.GetEdtCtrl().All_Document;for(let l=0;l<i.length;l++){let s=i[l];if(e&&s.DocID!=e)continue;let o=s.GetInnerText(t,n);r.push({docId:s.DocID,text:o})}return r}}t.A_SaveDocAsText=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetDocPosition=void 0;const r=n(1),i=n(6),l=n(9),s=n(3);class o extends r.XBaseAction{ActName(){return"GetDocPosition"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl(),n=t.MGetPageViewList(),r=[],o=[];for(let e=0;e<n.length;e++){let a=n[e].PageView.GetPagePanelView(i.ENumPagePanelTp.Body),u=a.GetBoundsDPI(96),h=a.LinesList,d=l.RectangleF.Empty,c=new s.List,p=null,f=t.MGetZoomRatio();for(let e of h){let t=e.FirstElement?e.FirstElement.Document:null;t!=p?(null!=p&&(d.X+=u.X,d.Y+=u.Y,c.Add({item:d,docId:p.DocID})),d=e.GetBoundsDPI(96),d.Width=u.Width,p=t):d.Height+=e.LineAssist.GetLineFullHeight(96,!0)}null!=p&&(d.X+=u.X,d.Y+=u.Y,c.Add({item:d,docId:p.DocID}));let g=[];for(let t of c)o.indexOf(t.docId)>-1||(g.push({left:t.item.X*f,top:t.item.Y*f+(n[e].PageRect.Height*f+2)*e,docId:t.docId}),o.push(t.docId));r.push(g)}let a=[];for(let e=0;e<r.length;e++)for(let t=0;t<r[e].length;t++)a.push(r[e][t]);return this.resMsg.ReturnParams=a,this.resMsg}}t.A_GetDocPosition=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetPageNumEle=void 0;const r=n(33),i=n(3),l=n(1);class s extends l.XBaseAction{ActName(){return"GetPageNumEle"}constructor(){super()}Execute(e){let t=super.GetEdtCtrl().All_Document,n=new i.List;for(let e=0;e<t.length;e++){let i=new r.EmrCalcEngine(t[e]);0==e&&(i.GetXDocHeader().GetChildrenByTypes(["XPageInfo"],!0,n),i.GetXDocFooter().GetChildrenByTypes(["XPageInfo"],!0,n)),i.GetXDocBody().GetChildrenByTypes(["XPageInfo"],!0,n)}let l=[];for(let e of n)l.push({xid:e.XID,FormatString:e.FormatString,PageNumStyle:e.PageNumStyle});return this.resMsg.ReturnParams=l,this.resMsg}}t.A_GetPageNumEle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdatePageNumByXid=void 0;const r=n(0),i=n(179),l=n(2),s=n(3),o=n(33),a=n(1);class u extends a.XBaseAction{ActName(){return"UpdatePageNumByXid"}Execute(e){let t,n=super.GetEdtCtrl().All_Document,r=new s.List;for(let e=0;e<n.length;e++){let t=new o.EmrCalcEngine(n[e]);0==e&&(t.GetXDocHeader().GetChildrenByTypes(["XPageInfo"],!0,r),t.GetXDocFooter().GetChildrenByTypes(["XPageInfo"],!0,r)),t.GetXDocBody().GetChildrenByTypes(["XPageInfo"],!0,r)}let i=e[0];for(let e of r)e.XID==i.xid&&(t=e);let l={0:i.PageNumStyle,1:i.FormatString};this.UpdatePageNumInfoEle(t,l)}UpdatePageNumInfoEle(e,t){let n=e instanceof r.XPageNumEle?e:null;if(null!=n){n.IsLayoutValid=!1,(new i.PageNumFormWrap).ShowPageNumForm(n,super.GetEdtCtrl(),l.ENumWorkMode.Design,t)&&super._RefreshPageAndMoveCaret(!0)}}}t.A_UpdatePageNumByXid=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetElementByCptId=void 0;const r=n(1),i=n(6),l=n(3);class s extends r.XBaseAction{ActName(){return"GetElementByCptId"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t=e;if(null==t||null==t.cptId)this.resMsg.ReturnParams="参数有误";else{let e=super.GetEdtCtrl();e.unfocus=!0;let n=t.cptId,r=t.docId,s=!0===t.getHide,o=e.All_Document,a=[];for(let e=0;e<o.length;e++){let t=new l.List,u=o[e];r&&u.DocID!=r||(u.GetPagePanel(i.ENumPagePanelTp.Body).GetChildrenByCptId(n,!0,t,s),u.GetPagePanel(i.ENumPagePanelTp.Header).GetChildrenByCptId(n,!0,t,s),u.GetPagePanel(i.ENumPagePanelTp.Footer).GetChildrenByCptId(n,!0,t,s),a.push({docId:u.DocID,list:t}))}let u=[];for(let e=0;e<a.length;e++){let t=a[e],n=t.list,r=t.docId,i=[];for(let e of n)i.push({eleType:e.EleTypeName,xId:e.XID});u.push({docId:r,eleArr:i})}this.resMsg.ReturnParams=u}return this.resMsg}}t.A_GetElementByCptId=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetCanvasAsImage=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"GetCanvasAsImage"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl();t.MGetPageViewList();let n=t.ContainerDOM.querySelector("#pagescontainer").querySelectorAll("canvas"),r=[];for(let e=0;e<n.length;e++){let t=n[e];r.push(t.toDataURL("image/png"))}return this.resMsg.ReturnParams=r,this.resMsg}}t.A_GetCanvasAsImage=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_RemoveEleById=void 0;const r=n(0),i=n(1),l=n(6),s=n(3);class o extends i.XBaseAction{ActName(){return"RemoveEleById"}Execute(e){if(this.resMsg.Clear(),null==e||!(e instanceof Array)||e.length<1)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",this.resMsg;const t=super.GetEdtCtrl(),n=t.All_Document;let i;for(let t=0;t<e.length;t++){const o=e[t],a=o.conceptId;if(a){const e=o.docId;let t;for(let r=0;r<n.length;r++)(null==t||e&&t.DocID==e)&&(t=n[r]);const u=t.GetPagePanel(l.ENumPagePanelTp.Body);let h=new s.List;u.GetChildrenByCptId(a,!0,h);for(let e=0;e<h.Count();e++){const t=h.Get(e),n=u.RemoveChildByEle(t);if(n>-1){const e=u.ChildEleList.Get(n);i=e instanceof r.XBaseContainer?e.GetFirstChildBaseEle(!1):e}}}}if(null==i)return this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令待删除元素为空",this.resMsg;t.MRefreshDocView();t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.ReplaceEle(i);return this.resMsg}}t.A_RemoveEleById=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetElementShowHIde=void 0;const r=n(1),i=n(38),l=n(33);class s extends r.XBaseAction{constructor(e){super(e)}ActName(){return"SetElementShowHIde"}Execute(e){this.resMsg.Clear();try{let n=super.GetEdtCtrl();n.unfocus=!0,this.xdoc=n.All_Document,this.RefreshDocList=[];for(var t=0;t<e.length;t++){let n=e[t].conceptId,r=e[t].docId,i=null==e[t].idType?"CptId":e[t].idType,l=e[t].status;if(!n||null==l)return;this.setValue(n,r,i,l)}this.MRefreshDocsView(),this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}setValue(e,t,n,r){for(var s=0;s<this.xdoc.length;s++){if(t&&this.xdoc[s].DocID!=t)continue;let o=new l.EmrCalcEngine(this.xdoc[s]),a=new i.List;if("XID"==n?(o.GetXDocHeader().GetChildrenByXID(e,!0,a,!0),o.GetXDocBody().GetChildrenByXID(e,!0,a,!0),o.GetXDocFooter().GetChildrenByXID(e,!0,a,!0)):(o.GetXDocHeader().GetChildrenByCptId(e,!0,a,!0),o.GetXDocBody().GetChildrenByCptId(e,!0,a,!0)),a.Length>0){this.resetRefreshDocList(this.xdoc[s]);let e=a.ToArray();for(let t=0;t<e.length;t++){let n=e[t];-1==n.EleStyle.DeleterIndex&&(n.Attr_FgHide=r)}}}}}t.A_SetElementShowHIde=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetTitleWithImage=void 0;const r=n(1),i=n(6),l=n(3),s=n(0),o=n(32),a=n(40);class u extends r.XBaseAction{ActName(){return"GetTitleWithImage"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl();t.unfocus=!0;let n=[],r=t.All_Document,u=new l.List;if(e.length>0)for(let t=0;t<e.length;t++){let i=e[t].docId;for(let e=0;e<r.length;e++)if(i==r[e].DocID){n.push(r[e]);break}}else n=r;for(let e=0;e<n.length;e++){let t=n[e];t.GetPagePanel(i.ENumPagePanelTp.Body).GetChildrenByTypes(["XTextLabelElement","XInputField","XImage"],!0,u,!0),t.GetPagePanel(i.ENumPagePanelTp.Header).GetChildrenByTypes(["XTextLabelElement","XInputField","XImage"],!0,u,!0),t.GetPagePanel(i.ENumPagePanelTp.Footer).GetChildrenByTypes(["XTextLabelElement","XInputField","XImage"],!0,u,!0)}let h=[];for(let e of u)e instanceof o.XTextLabelElement&&e.SetHideFlag&&h.push({docId:e.Document.DocID,cptId:e.CptID,XID:e.XID,eleType:"title",hideFlag:e.IsHidden(),children:[]}),e instanceof s.XImageEle&&e.SetHideFlag&&e.CptID&&-1==e.EleStyle.DeleterIndex&&h.push({docId:e.Document.DocID,hideFlag:e.IsHidden(),XID:e.XID,eleType:"image",cptId:e.CptID,haveValue:e.HaveValue}),e instanceof s.XInputEle&&e.InputType==a.EleTypeEnum.SignEle&&h.push({docId:e.Document.DocID,hideFlag:e.IsHidden(),XID:e.XID,eleType:"signinput",cptId:e.CptID,value:e.GetInnerText(!1),haveValue:e.SignEleHaveValue});return this.resMsg.ReturnParams=h,this.resMsg}}t.A_GetTitleWithImage=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SaveDocsAsXml=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"SaveDocsAsXml"}Execute(e){this.resMsg.Clear();let t,n,r=super.GetEdtCtrl(),i=r.M_XDocsUtil,l="";try{this.ClearStyle(),n=r.MSaveXmlDocuments(e),i.ResetXDocsChangedFlag();for(let e=0;e<n.length;e++)l+=n[e].xml}catch(e){this.resMsg.Ex=e}return this.resMsg.ReturnParams=l,t=this.resMsg,t}}t.A_SaveDocsAsXml=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetValueListByCptId=void 0;const r=n(1),i=n(3),l=n(33),s=n(0),o=n(40);class a extends r.XBaseAction{constructor(e){super(e)}ActName(){return"GetValueListByCptId"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl();this.xdoc=t.All_Document,this.valueList=[];let n=e.conceptId,r=e.docId;return this.getValue(n,r),this.resMsg.ReturnParams=this.valueList,this.resMsg}getValue(e,t){for(var n=0;n<this.xdoc.length;n++){if(t&&this.xdoc[n].DocID!=t)continue;let r=new l.EmrCalcEngine(this.xdoc[n]),a=new i.List;r.GetXDocBody().GetChildrenByCptId(e,!0,a),a.Length>0&&a.ToArray().forEach(n=>{if(n instanceof s.XInputEle){let r=n;if(r.InputType==o.EleTypeEnum.SingleChoiceDropEle||r.InputType==o.EleTypeEnum.MoreChoiceDropEle){let n=r.DataSrc.DataList,i=[];for(let e of n)i.push({value:e.Value,key:e.Key});this.valueList.push({CptId:e,docId:t,valueList:i})}}})}}}t.A_GetValueListByCptId=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_TextTableInsertRow_ByCID=void 0;const r=n(0),i=n(63),l=n(20),s=n(184),o=n(13),a=n(1),u=n(38),h=n(6),d=n(163),c=n(108),p=n(59),f=n(145),g=n(58),m=n(7),E=n(8);class C extends a.XBaseAction{constructor(){super(...arguments),this.cidOnlyRowIx=-1,this.fixedHeight=-1}ActName(){return"TextTableInsertRow_ByCID"}Execute(e){var t;this.resMsg.Clear();const n=super.GetEdtCtrl();if(null==e||null==e[0])return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令参数有误",this.resMsg;if(this.formatParamVals(e[0]),null==this.cid||"string"!=typeof this.cid)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令参数-概念ID有误",this.resMsg;if(!(this.rowArr instanceof Array&&this.rowArr.length>0))return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 命令参数-数组有误",this.resMsg;let r=!1,i=!1,l=!1;const s=n.All_Document;for(var a=0;a<s.length;a++){const e=s[a];if(this.docId&&e.DocID!=this.docId)continue;let t=new u.List;e.GetPagePanel(h.ENumPagePanelTp.Body).GetChildrenByCptId(this.cid,!0,t);let n=this.checkCidList(t);if(null!=n){if(r=!0,null!=this.xTextTable){this.fullPageByLastRow&&(this.xTextTable.FullPageByLastRow=!0),this.undoGroup=new o.UndoGroup;const e=this.insertNewDiagRow(n);l=e[0]||l,i=e[1],this.isDeleteSurplus&&l&&this.deleteSurplusRowByReplace(),this.isClearEmptyRow&&(l=this.deleteEmptyRow()||l)}e.GetPagePanel(h.ENumPagePanelTp.Body).IsChanged=!0}}return r?i||0===this.rowCount?(l&&(super._AddUndoItem(this.undoGroup),n.MRefreshDocView(null===(t=this.xTextTable)||void 0===t?void 0:t.Document)),this.resMsg.IsReturnMsg=!0,this.resMsg):(this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中插入行没有显示的单元格",this.resMsg):(this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中找不到正确的概念ID元素或所在表格",this.resMsg)}formatParamVals(e){e[0];const t=e.docId;f.LangUtils.IsString(t)&&(this.docId=t);const n=e.conceptDomainCode;f.LangUtils.IsString(n)&&(this.cid=n);const r=e.insertType;f.LangUtils.IsString(r)&&(this.insertType=r);const i=e.isDeleteSurplus;this.isDeleteSurplus=!!i;const l=e.replaceAllFixHeight;this.replaceAllFixHeight=!!l,this.replaceAllFixHeight&&(this.fixedHeight=-1);const s=e.isFixedCellHeight;this.isFixedCellHeight=!!s;const o=e.splitConByFixed;this.splitConByFixed=!!o,this.disSplitCell=!!e.disSplitCell,this.inheritPreRowStyleWidthAddRow=!!e.inheritPreRowStyleWidthAddRow,this.isBreakCombineCell=!!e.isBreakCombineCell,this.isClearEmptyRow=!!e.isClearEmptyRow,this.cidOnlyTitle=!!e.cidOnlyTitle,this.fullPageByLastRow=!!e.fullPageByLastRow,this.rowCount=Number(e.rowCount),this.rowCount>0||(this.rowCount=0),this.cidOnlyRowIx=Number(e.cidOnlyRowIx),this.cidOnlyRowIx>=0||(this.cidOnlyRowIx=-1),this.rowArr=e.rows}deleteSurplusRowByReplace(){if(null==this.endFocus)return;const e="replaceAll"==this.insertType;if("replace"==this.insertType||e){const e=l.XTextTableUtil.GetCursorCell(this.endFocus);if(null==e)return;let t=e.RowIndex+e.RowSpan;for(;t<this.xTextTable.NumOfRows;){let e=this.xTextTable.Rows.Get(t);if(null==e||e.ChildCount<1)break;let n=e.ChildEleList.Get(0);if(null==n)break;this.xTextTable.Action_DeleteRow(n)}}}insertNewDiagRow(e){let t=!1,n=!1;if(this.rowArr instanceof Array&&this.rowArr.length>0&&(this.rowCount=Math.max(this.rowArr.length,this.rowCount)),this.rowCount>0)for(let r=0;r<this.rowCount;r++){const i=this.rowArr[r];let l,o;null!=i&&(l=i.cells,o=i.IsUncombineCell),l instanceof Array||(l=[]);const a=0==r;let h=this.getRow(e,o,a);if(null==h)break;if(null!=h.Cells&&h.Cells.Count()>0){n=!0;const t=h.Cells.ToArray(),r=[],i=Math.max(t.length,l.length);for(let n=0;n<i;n++){const i=l[n];if(null==i)continue;let s=t[n],a=[],h=[];if("string"==typeof i){if(null==s)break;a[0]=i}else{const e=i,l=e.val;if(null==l)continue;if(l instanceof Array&&l.length<1)continue;const o=e.column_cid;let u=n;if(o){const e=this.getCellByCid(o);if(null==e)continue;u=e.ColIndex}if(s=t[u],null==s)continue;if(-1!=r.indexOf(s.XID))continue;r.push(s.XID);const d=e.fixedCellVAlign;d&&(s.fixedCellVAlign=d),l instanceof Array&&l.length>0?a=[...l]:l instanceof Array||!l||(a[0]=l+"");let c=s._GetLastBaseEle(!1,!0);"XParagraphFlag"!=c.EleTypeName&&(c=null),h=this.getStyle(a,e,c)}if(s.Visible||o){this.disSplitCell&&(s.DisSplit=!0),this.splitConByFixed&&(s.SplitConByFixed=!0),e=s.GetFirstChildBaseEle(!1);let t=new u.List,n=new u.List,r=new p.ClickedElementWrapper(!1);r.LineEleIxFocused.SetEle(e);for(let e=0;e<a.length;e++){const i=a[e],l=c.EditEleRange.BuildElesFromStr(i,h[e],n,r);null!=l&&t.Add(l),t.AddRange(n)}s.ChildCount>1&&s.RemoveChildren(0,s.ChildCount-1),s.AddChildrenEle(0,t.ToArray())}}if(this.splitConByFixed);else if(i>0&&this.isFixedCellHeight){let t=new u.List;const n=this.insertNewRowWidthCalcLine(h,t);if(e=this.xTextTable.Rows.Get(n).GetFirstChildBaseEle(!1),null!=t&&t.Count()>1)for(let e=0;e<this.xTextTable.NumOfColumns;e++){let n,r=new u.List;for(let i=0;i<t.Count();i++){const l=t.Get(i);if(null==l)continue;if(null==l.Cells)continue;const s=l.Cells.Get(e);if(null!=s){if(!n&&(n=s.fixedCellVAlign,!n))break;r.Add(s)}}n&&this.RearrangeCellLineByVAlign(r,n)}}}let d=new s.TextTableInsertRowRedoUndo(this.xTextTable,h);this.undoGroup.AddItem(d),t=!0}return this.endFocus=e,[t,n]}getRow(e,t,n){const r="replaceAll"==this.insertType,s="replace"==this.insertType,o="append"==this.insertType;let a,u=!0;if(s||r){const i=l.XTextTableUtil.GetCursorCell(e);let o=i.RowIndex+i.RowSpan;if(o<this.xTextTable.NumOfRows){if(a=this.xTextTable.Rows.Get(o),this.isBreakCombineCell){let e,r=1;for(let t=0;t<a.Cells.Count();t++){let n=a.Cells.Get(t);n.Visible||(n=n.MainMergeCell),null==e&&n.ColSpan>1&&(e=n.GetFirstChildBaseEle(!1)),n.RowSpan>r&&(e=n.GetFirstChildBaseEle(!1),r=n.RowSpan)}null!=e&&(a=this.getRow(e,t,n))}u=!1,r&&this.fixedHeight<0&&this.replaceAllFixHeight&&null!=a&&(this.fixedHeight=a.FixHeight)}else s&&(u=!1)}else o&&(e=this.xTextTable._GetLastBaseEle(!1,!0),u=!0);if(u){a=this.xTextTable.Action_InsertRow(e,i.ORIENTATION.BOTTOM,!t);const r=a.Index;if(r>0&&(!n||this.inheritPreRowStyleWidthAddRow)){const e=this.xTextTable.Rows.Get(r-1);this.getSameLastPagraFlag(e,a),a.FixHeight=e.FixHeight}this.fixedHeight>0&&(a.FixHeight=this.fixedHeight)}return a}getCellByCid(e){let t;const n=new u.List;if(this.xTextTable.GetChildrenByCptId(e,!0,n),n.Length<1)return null;let i=n.Get(0);for(;null!=i;){if(i instanceof r.XTextTableCell){t=i,i=null;break}i=i.Parent}return t}getStyle(e,t,n){const r=t;let i=[],l=!0,s=!0,o=!0,a=!0,u=!0,h=!0,d=!0;for(let t=0;t<e.length;t++){let c,p,f,E,C,A,y;if(l){const e=this.util(r.Bold,t);null==e?l=!1:c=!!e}if(s){const e=this.util(r.Italic,t);null==e?s=!1:p=!!e}if(o){const e=this.util(r.Underline,t);null==e?o=!1:f=!!e}if(a){const e=this.util(r.Strikeout,t);null==e?a=!1:E=!!e}if(u){const e=this.util(r.FontSize,t);null==e?u=!1:C=Number(e)}if(h){const e=this.util(r.FontName,t);null==e?h=!1:A=e+""}if(d){const e=this.util(r.ForeColor,t);null==e?d=!1:y=new m.Color(e)}if(c||p||f||E||C||A||y){const r=new g.XBaseEleStyle(!1);null==r.XFontStyle.DefaultStyle&&(r.XFontStyle.DefaultStyle=this.xTextTable.Document.GetDefaultStyle()),c&&(r.XFontStyle.IsBold=c),p&&(r.XFontStyle.IsItalic=p),f&&(r.XFontStyle.IsUnderline=f),E&&(r.XFontStyle.IsStrikeout=E),C&&(r.XFontStyle.FontSize=C,null!=n&&t==e.length-1&&(n.EleStyle.XFontStyle.FontSize=C)),A&&(r.XFontStyle.FontName=A),y&&(r.ForeColor=y,r.isDefaultForeColor=!1),i[t]=r}}return i}util(e,t){return null==e?null:e instanceof Array?e[t]:e}deleteEmptyRow(){let e=!1;if(null==this.xTextTable.Rows)return!1;const t=this.xTextTable.Rows.ToArray();for(let n=0;n<t.length;n++){const r=t[n],i=r.Cells;if(null==i)continue;let l=!0;for(let e=0;e<i.Count();e++){const t=i.Get(e),n=t.Visible&&t.ChildCount>1,r=!t.Visible;if(n||r){l=!1;break}}if(l){let t=new d.TextTableDeleteRowRedoUndo(this.xTextTable,r);this.xTextTable.Action_DeleteRow(i.Get(0)),this.undoGroup.AddItem(t),e=!0}}return e}insertNewRowWidthCalcLine(e,t){e.ReCalcBaseSize(),e.RefreshLines(!1);const n=e.Cells.ToArray(),l=this.fixedHeight>0?this.fixedHeight:e.FixHeight;let s;for(let t=0;t<n.length;t++){const o=n[t];if(this.disSplitCell&&(o.DisSplit=!0),o.LinesCnt<2)continue;const a=o.LinesList.ToArray();let h=o.EleStyle.ElePadd.Top+o.EleStyle.ElePadd.Bottom;for(let t=0;t<a.length;t++){const n=a[t],d=n.FirstElement;if(null==d)continue;const c=n.LineAssist.GetLineFullHeight(300,!0);if(c>0&&(h+=c),0!=t&&h>l){const t=d.Parent;if(null==t||null==t.Parent||t.Parent.XID!=o.XID)continue;null==s&&(s=this.xTextTable.Action_InsertRow(d,i.ORIENTATION.BOTTOM,!0),s.FixHeight=l,this.getSameLastPagraFlag(e,s));const n=s.Cells.Get(o.ColIndex);if(null==n)continue;o.fixedCellVAlign&&(n.fixedCellVAlign=o.fixedCellVAlign);const a=t.GetChildInx(d),h=o.GetChildInx(t);let c=new u.List;if(0==a)c.Add(t);else{const e=new r.XStringEle;e.CopyFrom(t,!1,!1,!0);const n=t.ChildCount-a,i=t.ChildEleList.GetRange(a,n);e.AddChildrenEle(0,i.ToArray()),t.ChildEleList.RemoveRange(a,n),c.Add(e)}const p=o.ChildCount-1-(h+1),f=o.ChildEleList.GetRange(h+1,p);if(c.AddRange(f),n.AddChildrenEle(0,c.ToArray()),0==a){o.ChildEleList.RemoveRange(h,p+1);const e=o.ChildEleList.ToArray();if(e.length>1){let t=0,n=-1;for(let r=e.length-2;r>=0;r--){if("XParagraphFlag"!=e[r].EleTypeName)break;t++,n=r}t>0&&o.ChildEleList.RemoveRange(n,t)}}else o.ChildEleList.RemoveRange(h+1,p);o.IsLayoutValid=!1;break}}}let o=e.Index;return null!=t&&t.Add(e),null!=s&&(o=this.insertNewRowWidthCalcLine(s,t)),o}getSameLastPagraFlag(e,t){if(null==e)return;if(null==t)return;const n=e.Cells,r=t.Cells;if(null==n)return;if(null==r)return;const i=n.ToArray(),l=r.ToArray();if(!(i.length!=l.length||l.length<1))for(let e=0;e<l.length;e++){const t=i[e],n=l[e];if(null==t)continue;if(null==n)continue;const r=t._GetLastBaseEle(!1,!0),s=n._GetLastBaseEle(!1,!0);n.EleStyle.CopyFrom(t.EleStyle,!1),null!=r&&(null!=s&&(s.EleStyle.CopyFrom(r.EleStyle,!1),n.CellAlign=t.CellAlign))}}checkCidList(e){if(null==e)return null;if(!(e.Count()>0))return null;let t,n=!1,r=e.ToArray();for(let e=0;e<r.length;e++)if(t=r[e],null!=t&&(this.xTextTable=l.XTextTableUtil.GetCursorTextTable(t),null!=this.xTextTable)){if(this.cidOnlyRowIx>-1){if(l.XTextTableUtil.GetCursorCell(t).RowIndex!=this.cidOnlyRowIx)continue}if(this.cidOnlyTitle){if("XTextLabelElement"!=t.EleTypeName)continue;let e=new u.List;if(this.xTextTable.GetChildrenByCptId(this.cid,!0,e),null==e)continue;if(1!=e.Count())continue}n=!0;break}if(!n)return null;if(null==t)return null;if(null==this.xTextTable)return null;if(t.XID==this.xTextTable.XID){const e=this.xTextTable.GetFirstCell();null!=e&&(t=e.GetFirstChildBaseEle(!1))}return t}RearrangeCellLineByVAlign(e,t){let n,r;if("middle"==t)r=!0;else{if("bottom"!=t)return;n=!0}if(null==e)return;let i=e.Count();if(i<2)return;let l=0,s=0;for(let t=i-1;t>=0;t--){const n=e.Get(t);if(null==n||!n.Visible||n.ChildCount<1)s++;else{if(n.ChildCount>1)break;l++}}if(!(l>0))return;if(r&&l<2)return;if(i-=s,r){const e=E.CNumUtil.Round(l/2,0,!0);i=e,l-=e}if(!(i>l))return;let o=i-1-l;if(o>=0)for(let t=i-1;t>=0;t--){const n=e.Get(t);if(n.ChildCount>1)break;let r;for(r=e.Get(o);(null==r||!r.Visible||r.ChildCount<2)&&(o--,o>=0);)r=e.Get(o);if(!(o>=0)||null==r)break;const i=r.ChildEleList.GetRange(0,r.ChildCount-1);let l=new u.List;if(l.AddRange(i),n.AddChildrenEle(0,l.ToArray()),r.ChildEleList.RemoveRange(0,r.ChildCount-1),n.IsLayoutValid=!1,r.IsLayoutValid=!1,o--,!(o>=0))break}}}t.A_TextTableInsertRow_ByCID=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetElementsWithBussId=void 0;const r=n(1),i=n(3),l=n(33);class s extends r.XBaseAction{ActName(){return"GetElementsWithBussId"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl().All_Document,r=new i.List;e.length>0&&(t=!0===e[0].isGetHiddenEles);for(var s=0;s<n.length;s++){let e=new l.EmrCalcEngine(n[s]);e.GetXDocHeader().GetChildrenWithBussId(!0,r,t),e.GetXDocBody().GetChildrenWithBussId(!0,r,t)}let o=[];for(let e of r)o.push({eleType:e.EleTypeName,cptId:e.CptID,XID:e.XID,bussId:e.bussId});return this.resMsg.ReturnParams=o,this.resMsg}}t.A_GetElementsWithBussId=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ClearInputValueWithTitle=void 0;const r=n(1),i=n(6),l=n(3),s=n(0),o=n(32);class a extends r.XBaseAction{ActName(){return"ClearInputValueWithTitle"}Execute(e){this.resMsg.Clear();let t=e;if(t.length>0)for(let e=0;e<t.length;e++){let n=t[e];if(n.resetValue){let e=n.conceptId;this._getInputElementByCptId(e)}}else{let e=super.GetEdtCtrl().All_Document,t=new l.List;for(let n=0;n<e.length;n++){e[n].GetPagePanel(i.ENumPagePanelTp.Body).GetChildrenByType("XTextLabelElement",!0,t)}for(let e of t)this._getInputElementByCptId(e.CptID)}return super.GetEdtCtrl().MRefreshDocsView(),this.resMsg}_getInputElementByCptId(e){let t=super.GetEdtCtrl().All_Document;for(let n=0;n<t.length;n++){let r,l=t[n].GetPagePanel(i.ENumPagePanelTp.Body).ChildEleList,a=!1,u=!1;for(let t=0;t<l.Length;t++){let n=l.Get(t);if(n instanceof o.XTextLabelElement&&a&&r==n.TitleLevel)break;u&&n instanceof s.XInputEle&&n.UpdateInnerText("",null),n instanceof o.XTextLabelElement&&n.CptID==e&&(u=!0,a=!0,r=n.TitleLevel)}}}}t.A_ClearInputValueWithTitle=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_AppendDocs=void 0;const r=n(2),i=n(70),l=n(4),s=n(1);class o extends s.XBaseAction{constructor(){super(),this.xdocLoadParam=null,super.OpType=r.ENumActOpType.CtntEdit,this.xdocLoadParam=new i.XDocLoadParam(null,r.ENumXDocPath.LocalFile)}ActName(){return"FileAppends"}Execute(e){this.resMsg.Clear();let t,n=((null==e?0:e.length)<=0?null:e[0]).srcstr,r=super.GetEdtCtrl();if(l.default.IsNullOrEmpty(n))return r.Focus(),this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName+" 命令未指定有效的文件路径。",t=this.resMsg,t;try{this.xdocLoadParam.SrcStr=n,r.MAppendXmlDocuments(e),this.resMsg.ReturnParams=!0}catch(e){r.M_EdtCustomEvtGrp.OpenError&&r.M_EdtCustomEvtGrp.OpenError(),this.resMsg.ReturnParams=!1,this.resMsg.Ex=e}return t=this.resMsg,t}}t.A_AppendDocs=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_insertPageNumToFooter=void 0;const r=n(0),i=n(174),l=n(179),s=n(2),o=n(6),a=n(1),u=n(11),h=n(105),d=n(243),c=n(8),p=n(10);class f extends a.XBaseAction{constructor(){super(),this.pgnumFormWrap=null,super.OpType=s.ENumActOpType.CtntEdit,this.pgnumFormWrap=new l.PageNumFormWrap}ActName(){return"InsertPageNumToFooter"}Execute(e){let t=e[0].pageInfo,n=e[0].align,l=e[0].lineHeight,a=e[0].docIdArr,u=this.getLineHeight(l),d=this.getAlign(n),c=super.GetEdtCtrl();c.unfocus=!0;let p=c.All_Document,f=new h.XParagraphFlagStyle,g=this.ShowParagraphForm(f,u);for(let e=0;e<p.length;e++){let n=p[e];if(n.IsAssociatPageIndex=!1,a&&a.length>0){if(a.indexOf(n.DocID)<=-1)continue;t[1].indexOf("[%AssociatPageIndex%]")>=0&&(n.IsAssociatPageIndex=!0)}let l=n.GetPagePanel(o.ENumPagePanelTp.Footer),u=l.ChildEleList,h=!1,c=r.XElementFactory.CreatXElement("XPageInfo",null);this.pgnumFormWrap.ShowPageNumForm(c,this.GetEdtCtrl(),s.ENumWorkMode.Design,t);for(let e of u){if(e instanceof i.XPageNumEle){let n={0:t[0],1:t[1]};h=!0,this.UpdatePageNumInfoEle(e,n)}e instanceof r.XParagraphFlag&&(e.ParaghStyle.HAlign_ENumVal=d,this._ChangeOneParaghStyle(e,g))}h||(c.IsLayoutValid=!1,l.AddChildEle(0,c))}return super._RefreshPageAndMoveCaret(!0),this.resMsg}_ChangeOneParaghStyle(e,t){return e.ParaghStyle.BuildXParagraphStyle(t),!0}UpdatePageNumInfoEle(e,t){let n=e instanceof i.XPageNumEle?e:null;if(null!=n){n.IsLayoutValid=!1,(new l.PageNumFormWrap).ShowPageNumForm(n,super.GetEdtCtrl(),s.ENumWorkMode.Design,t)}}ShowParagraphForm(e,t){let n=this._BuildParagraphInfo(e);return void 0!==t._rowPadding&&(n.RowSpaceValueText=t._rowPadding),void 0!==t._leftShrinkage&&(n.LeftShrink=t._leftShrinkage),void 0!==t._firstRowShrinkage&&(n.FirstRowShrink=t._firstRowShrinkage),void 0!==t._paragraphBefore&&(n.ParagraphBeforeShrink=t._paragraphBefore),void 0!==t._paragraphAfter&&(n.ParagraphAfterShrink=t._paragraphAfter),void 0!==t._setValue&&(n.RowSpace=t._setValue),void 0!==t._firstRowShrinkageCheckBox&&(n.IsFirstRowShrink=1==t._firstRowShrinkageCheckBox),void 0!==t._shrinkageCheckBox&&(n.IsHangInShrink=1==t._shrinkageCheckBox),n}_BuildParagraphInfo(e){let t=0,n=new d.ParagraphFormInfo,r=e.HasProp("LeftIndent");return r?(t=p.DPITransUtil.TransFloatVal(e.LeftIndent,300,25.4),n.LeftShrink=c.CNumUtil.Round(t/10,2,!0)):n.LeftShrink=null,r=e.HasProp("FirstLineIndent"),r?(t=p.DPITransUtil.TransFloatVal(e.FirstLineIndent,300,25.4),n.FirstRowShrink=c.CNumUtil.Round(t/10,2,!0)):n.FirstRowShrink=null,t>0?(n.IsFirstRowShrink=!0,n.IsHangInShrink=!1):t<0?(n.IsFirstRowShrink=!1,n.IsHangInShrink=!0):(n.IsFirstRowShrink=!1,n.IsHangInShrink=!1),r=e.HasProp("SpacingBeforeParagraph"),n.ParagraphBeforeShrink=r?c.CNumUtil.Round(e.GetLineCntOfSpacing(!0),2,!0):null,r=e.HasProp("SpacingAfterParagraph"),n.ParagraphAfterShrink=r?c.CNumUtil.Round(e.GetLineCntOfSpacing(!1),2,!0):null,r=e.HasProp("LineSpacingStyle"),n.RowSpaceValueText=r?e.LineSpacingStyle:null,n.RowSpace=e.LineSpacing,r=e.HasProp("ParagraphMultiLevel"),n.IsMoreParaList=r?e.ParagraphMultiLevel:null,n}getLineHeight(e){let t;return t="1.5"==e?{_rowPadding:"Space1pt5",_setheight:"2"}:"2"==e?{_rowPadding:"SpaceDouble",_setheight:"3"}:{_rowPadding:"SpaceSingle",_setheight:"1"},t}getAlign(e){let t;return t="left"==e?u.ENumHAlignStyle.LEFT:"right"==e?u.ENumHAlignStyle.RIGHT:u.ENumHAlignStyle.CENTER,t}}t.A_insertPageNumToFooter=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_DeletePageNumInFooter=void 0;const r=n(0),i=n(174),l=n(2),s=n(6),o=n(1),a=n(11),u=n(105),h=n(243),d=n(8),c=n(10);class p extends o.XBaseAction{ActName(){return"DeletePageNumInFooter"}constructor(){super(),super.OpType=l.ENumActOpType.CtntEdit}Execute(e){let t,n,l,o;e.length>0&&(t=e[0].align,n=e[0].lineHeight,l=this.getLineHeight(n),o=this.getAlign(t));let a,h=super.GetEdtCtrl().All_Document,d=new u.XParagraphFlagStyle;l&&(a=this.ShowParagraphForm(d,l));for(let e=0;e<h.length;e++){let t=h[e].GetPagePanel(s.ENumPagePanelTp.Footer),n=t.ChildEleList;for(let e of n)e instanceof i.XPageNumEle&&t.RemoveChildByEle(e),e instanceof r.XParagraphFlag&&(e.ParaghStyle.HAlign_ENumVal=o,a&&this._ChangeOneParaghStyle(e,a))}return super._RefreshPageAndMoveCaret(!0),this.resMsg}_ChangeOneParaghStyle(e,t){return e.ParaghStyle.BuildXParagraphStyle(t),!0}ShowParagraphForm(e,t){let n=this._BuildParagraphInfo(e);return void 0!==t._rowPadding&&(n.RowSpaceValueText=t._rowPadding),void 0!==t._leftShrinkage&&(n.LeftShrink=t._leftShrinkage),void 0!==t._firstRowShrinkage&&(n.FirstRowShrink=t._firstRowShrinkage),void 0!==t._paragraphBefore&&(n.ParagraphBeforeShrink=t._paragraphBefore),void 0!==t._paragraphAfter&&(n.ParagraphAfterShrink=t._paragraphAfter),void 0!==t._setValue&&(n.RowSpace=t._setValue),void 0!==t._firstRowShrinkageCheckBox&&(n.IsFirstRowShrink=1==t._firstRowShrinkageCheckBox),void 0!==t._shrinkageCheckBox&&(n.IsHangInShrink=1==t._shrinkageCheckBox),n}_BuildParagraphInfo(e){let t=0,n=new h.ParagraphFormInfo,r=e.HasProp("LeftIndent");return r?(t=c.DPITransUtil.TransFloatVal(e.LeftIndent,300,25.4),n.LeftShrink=d.CNumUtil.Round(t/10,2,!0)):n.LeftShrink=null,r=e.HasProp("FirstLineIndent"),r?(t=c.DPITransUtil.TransFloatVal(e.FirstLineIndent,300,25.4),n.FirstRowShrink=d.CNumUtil.Round(t/10,2,!0)):n.FirstRowShrink=null,t>0?(n.IsFirstRowShrink=!0,n.IsHangInShrink=!1):t<0?(n.IsFirstRowShrink=!1,n.IsHangInShrink=!0):(n.IsFirstRowShrink=!1,n.IsHangInShrink=!1),r=e.HasProp("SpacingBeforeParagraph"),n.ParagraphBeforeShrink=r?d.CNumUtil.Round(e.GetLineCntOfSpacing(!0),2,!0):null,r=e.HasProp("SpacingAfterParagraph"),n.ParagraphAfterShrink=r?d.CNumUtil.Round(e.GetLineCntOfSpacing(!1),2,!0):null,r=e.HasProp("LineSpacingStyle"),n.RowSpaceValueText=r?e.LineSpacingStyle:null,n.RowSpace=e.LineSpacing,r=e.HasProp("ParagraphMultiLevel"),n.IsMoreParaList=r?e.ParagraphMultiLevel:null,n}getLineHeight(e){let t;return t="1.5"==e?{_rowPadding:"Space1pt5",_setheight:"2"}:"2"==e?{_rowPadding:"SpaceDouble",_setheight:"3"}:{_rowPadding:"SpaceSingle",_setheight:"1"},t}getAlign(e){let t;return t="center"==e?a.ENumHAlignStyle.CENTER:"right"==e?a.ENumHAlignStyle.RIGHT:a.ENumHAlignStyle.LEFT,t}}t.A_DeletePageNumInFooter=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetPageNum=void 0;const r=n(1),i=n(6),l=n(3);class s extends r.XBaseAction{ActName(){return"GetPageNum"}constructor(){super()}Execute(e){let t=super.GetEdtCtrl();t.unfocus=!0;let n,r=t.All_Document,s=r[r.length-1].GetDocCtxt(),o=s.GetValue("[%LocalNumOfPages%]"),a=s.GetValue("[%NumOfPages%]"),u=r[0],h=new l.List;u.GetPagePanel(i.ENumPagePanelTp.Footer).GetChildrenByType("XPageInfo",!0,h),h.Length>0&&(n=h.Get(0).FormatString);let d=t.MGetPageView(0),c=d.PageIx,p=d.LocalPageIx;return this.resMsg.ReturnParams={NumOfPages:a,LocalNumOfPages:o,type:n,starNum:c+1,starLocalNum:p+1},this.resMsg}}t.A_GetPageNum=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ToggleCommentStatus=void 0;const r=n(2),i=n(1);class l extends i.XBaseAction{ActName(){return"ToggleCommentStatus"}constructor(){super(),super.OpType=r.ENumActOpType.CtntEdit}Execute(e){this.resMsg.Clear();let t,n=!0===(e.length>0&&e[0].status),r=super.GetEdtCtrl();r.unfocus=!0;let i=r.All_Document;for(let e=0;e<i.length;e++){i[e].GetPageFmt().ShowCmmtArea=n}return r.RefreshCmmtShowStatus(),super._RefreshPageAndMoveCaret(!0),t=this.resMsg,t}}t.A_ToggleCommentStatus=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetPrintPreview=void 0;const r=n(2),i=n(3),l=n(383),s=n(140),o=n(30),a=n(1);class u extends a.XBaseAction{constructor(){super(),this.prtpreview_form=null,this.res_prt=o.ENumEndType.Error,super.OpType=r.ENumActOpType.Save;super.GetEdtCtrl();this.prtpreview_form}ActName(){return"SetPrintPreview"}IsPrinted(){return this.res_prt==o.ENumEndType.DoPrint||this.res_prt==o.ENumEndType.DoExport}Execute(e){this.resMsg.Clear(),this.res_prt=o.ENumEndType.Error;let t=null==e?0:e.length,n=t<=0?null:e[0],a=t<=1?null:e[1],u=t<=2?null:e[2],h=super.GetEdtCtrl();h.unfocus=!0;let d=h.M_XDocsUtil;if(h.M_GetActionByName("SetWorkMode_Browse").Execute([]),h.M_StatusBar.WorkMode=r.ENumWorkMode.PrintPreview,null==n&&(n=new Boolean(!0)),null==a&&(a=new Boolean(!0)),null==u){u=new l.EmrPrintArgs;let e=d.MGet_Document(0);u.PrtIsHori=null!=e&&e.GetPageFmt().Landscape}let c=null,p=null;if("PrintCurPage"==this.ActName()){let e=h.M_DocumentFocused,t=h.M_PageFocused;c=new s.PageFormat(!0),e.GetPageFmt().TranstoQiPageFmt(c,!1),null!=t&&(p=new i.List,p.Add(t.RelDocPage))}else h.unfocus=!0,h.M_EleEvtModel.WorkMode=r.ENumWorkMode.PrintPreview,h.MShowAsPrint=!0,h.MRefreshDocsView()}}t.A_SetPrintPreview=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetCommentStatus=void 0;const r=n(2),i=n(1);class l extends i.XBaseAction{ActName(){return"GetCommentStatus"}constructor(){super(),super.OpType=r.ENumActOpType.CtntEdit}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl().All_Document[0].GetPageFmt().ShowCmmtArea;return this.resMsg.ReturnParams=t,this.resMsg}}t.A_GetCommentStatus=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetShowByDocId=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"SetShowByDocId"}constructor(){super()}Execute(e){let t;this.resMsg.Clear();let n=null==e?0:e.length;if(0!=n){try{let t=n<=0?null:e,r=super.GetEdtCtrl();for(let e=0;e<t.length;e++){let n=t[e],i=n.docId,l=n.show,s=r.All_Document;for(let e=0;e<s.length;e++){let t=s[e];t.DocID==i&&(t.ShowDoc=!!l)}}r.reLoadXTextDocument(),this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1,this.resMsg.Ex=e}return t=this.resMsg,t}}}t.A_SetShowByDocId=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_OutPutAsPDf=void 0;const r=n(2),i=n(1),l=n(14),s=n(389),o=n(398),a=n(146);class u extends i.XBaseAction{ActName(){return"OutPutAsPDf"}constructor(e){super(e),super.OpType=r.ENumActOpType.Save}pdfBase64ToBlob(e){for(var t=atob(e),n=t.length,r=new Uint8Array(n);n--;)r[n]=t.charCodeAt(n);return new Blob([r],{type:"pdf"})}downloadFile(e,t){o({printable:e,type:"pdf",base64:!0})}downloadFileByBase64(e,t){if(e){const n=this.pdfBase64ToBlob(e);URL.createObjectURL(n);this.downloadFile(e,t)}else alert("文件不存在")}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),r=this,i=e.length,o=!1,u="test",h="";i>0&&(o=null!=e[0].printFlag&&e[0].printFlag,u=null==e[0].outputName?"test":e[0].outputName,h=null==e[0].ip?"":e[0].ip);try{this.ClearStyle();let e=n.M_DocumentFocused.ToXML(),t=l.XmlDomUtil.Xml2String(e);a.LoadingComp.show();let i="development"=="production"?"/api/print/PrintService/GetEmrDocPdf":"/print/PrintService/GetEmrDocPdf";btoa(encodeURI('<?xml version="1.0" encoding="utf-8"?>'+t));s.default.post(`${h}${i}`,{strName:u,strXMLBase:'<?xml version="1.0" encoding="utf-8"?>'+t}).then(e=>{if(a.LoadingComp.hide(),o){const t=JSON.parse(e.data).msg;r.downloadFileByBase64(t,u)}else this.DownLoadPdf(e,u)}).catch(e=>{})}catch(e){this.resMsg.Ex=e}return n.Focus(),t=this.resMsg,t}DownLoadPdf(e,t){var n=document.createElement("a");n.download=t,n.style.display="none";const r=Uint8Array.from(atob(JSON.parse(e.data).msg),e=>e.charCodeAt(0));let i=new window.Blob([r],{type:"application/pdf"});i=window.URL.createObjectURL(i),n.href=i,document.body.appendChild(n),n.click(),document.body.removeChild(n)}}t.A_OutPutAsPDf=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetDocStatusImage=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"SetDocStatusImage"}constructor(){super()}Execute(e){let t;this.resMsg.Clear();let n=null==e?0:e.length;if(0!=n){try{let t=n<=0?null:e,r=super.GetEdtCtrl();r.unfocus=!0;for(let e=0;e<t.length;e++){let n=t[e],i=n.docId,l=n.statusImage,s=r.All_Document;for(let e=0;e<s.length;e++){let t=s[e];t.DocID==i&&l&&(t.DocStatusImage=l)}}r.Invalidate(),this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1,this.resMsg.Ex=e}return t=this.resMsg,t}}}t.A_SetDocStatusImage=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetDocNewPage=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"SetDocNewPage"}constructor(){super()}Execute(e){let t;this.resMsg.Clear();let n=null==e?0:e.length;if(0!=n){try{let t=n<=0?null:e,r=super.GetEdtCtrl();for(let e=0;e<t.length;e++){let n=t[e],i=n.docId,l=n.newPage,s=r.All_Document;for(let e=0;e<s.length;e++){let t=s[e];t.DocID==i&&l&&(t.NewPage=l)}}r.reLoadXTextDocument(),this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1,this.resMsg.Ex=e}return t=this.resMsg,t}}}t.A_SetDocNewPage=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertXTextHeader=void 0;const r=n(1),i=n(62),l=n(14),s=n(6);class o extends r.XBaseAction{ActName(){return"InsertXTextHeader"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl();try{let n=e[0].xml,r=e[0].docIdList,o=t.All_Document;for(let e=0;e<o.length;e++){let t=o[e];if(r.indexOf(t.DocID)>-1){let e=l.XmlDomUtil.parseXMLFromString(n),r=new i.XTextDocument(!1);r.FromXML(e);let o=r.GetPagePanel(s.ENumPagePanelTp.Header).ChildEleList,a=t.GetPagePanel(s.ENumPagePanelTp.Header);this.changeOWerPanel(o,a),a.ChildEleList.Clear(),a.ChildEleList.AddRange(o)}}t.MRefreshDocsView()}catch(e){this.resMsg.Ex=e}return this.resMsg}changeOWerPanel(e,t){for(let n=0;n<e.Length;n++){let r=e.Get(n);r.OwnerDocPanel=t,r.ChildEleList&&r.ChildEleList.Length>0&&this.changeOWerPanel(r.ChildEleList,t)}}}t.A_InsertXTextHeader=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetSelectStructureTree=void 0;const r=n(65),i=n(1),l=n(3),s=n(32),o=n(0);class a extends i.XBaseAction{ActName(){return"GetSelectStructureTree"}constructor(){super()}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl().M_EleEvtModel.SelRange,n=t.FromLineEleIx.RefreshEleObj(!1),i=t.ToLineEleIx.RefreshEleObj(!1),a=r.EmrClipboard.GetInstance();let u={};if(a.CopyToClipboard(n,i,!1)){const e=a.M_ArrEleRange;if(null!=e){let t=[],r=new l.List;for(let t of e){let e=this.getXtextLabelElement(t),n=o.XDomUtil.GetParentXInput(t),i=!1,l=!1;for(let t of r)t.XID==(null==e?void 0:e.XID)&&(i=!0),t.XID==(null==n?void 0:n.XID)&&(l=!0);i||null!=e&&r.Add(e),l||null!=n&&r.Add(n)}let a=[];for(let e of r)e instanceof s.XTextLabelElement?(t.length<1&&a.length>0&&t.push({XTextLabelElement:{name:"",cptId:"",XID:"",docId:""},children:a}),a=[],t.push({XTextLabelElement:{name:e.EleText,cptId:e.CptID,XID:e.XID,docId:e.Document.DocID},children:a})):a.push({name:e.GetAttribute("decodeName"),cptId:e.CptID,XID:e.XID,docId:e.Document.DocID,Value:e.GetInnerText(!1)});t.length<1&&a.length>0&&t.push({XTextLabelElement:{name:"",cptId:"",XID:"",docId:""},children:a}),u.result=t,u.selectRange={fromEle:n,toEle:i}}}return this.resMsg.ReturnParams=u,this.resMsg}getXtextLabelElement(e){var t;if(e instanceof s.XTextLabelElement)return e;{let n=null===(t=e.Parent)||void 0===t?void 0:t.ChildEleList;if(!n)return null;{let t=null;for(let r of n)if(r instanceof s.XTextLabelElement)t=r;else if(r.XID==e.XID)return null!=t?t:this.getXtextLabelElement(e.Parent)}}}}t.A_GetSelectStructureTree=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SelectByEle=void 0;const r=n(1),i=n(2);class l extends r.XBaseAction{ActName(){return"SelectByEle"}constructor(){super()}Execute(e){if(this.resMsg.Clear(),e.length>0){let t=super.GetEdtCtrl(),n=t.M_EleEvtModel.SelRange,r=e[0].fromEle,l=e[0].toEle;n.SetFromIx(r),n.SetToIx(l);let s=n.InfoUtil.CalcLineRectRanges(!0);t.RefreshPageSelRange(i.ENumBkgRectsType.SelRects,s)}return this.resMsg}}t.A_SelectByEle=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SyncDataByTitle=void 0;const r=n(2),i=n(70),l=n(60),s=n(1),o=n(38),a=n(6);class u extends s.XBaseAction{constructor(e){super(e),this.xdocLoadParam=new i.XDocLoadParam,super.OpType=r.ENumActOpType.CtntEdit,this.xdocLoadParam=new i.XDocLoadParam(null,r.ENumXDocPath.LocalFile)}ActName(){return"SyncDataByTitle"}Execute(e){this.resMsg.Clear();try{if(e.length>0){super.GetEdtCtrl().unfocus=!0;for(let t=0;t<e.length;t++){let n=e[t].docId,r=e[t].isKeepTrace,i=e[t].srcStr,l=e[t].conceptId,s=e[t].changeFlag;this.syncDataByTitle(n,r,i,l,s)}}}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}syncDataByTitle(e,t,n,r,i){let l=super.GetEdtCtrl(),s=l.All_Document,a=[];for(let i=0;i<s.length;i++){let u=s[i];if(e&&u.DocID!=e)continue;let h=new o.List;u.GetChildrenListByCptId(r,h,!0);let d=new o.List;this.GetInsertInputEle(n,d);for(let e of d){let n=e.GetInnerText(!1),r=e.CptID;for(let e of h)e.CptID==r&&(e.UpdateInnerText(n,null,t),a.push(e))}l.MRefreshDocView(u)}i&&this.SetTimeChangeColor(a)}GetInsertInputEle(e,t){this.xdocLoadParam=new i.XDocLoadParam(null,r.ENumXDocPath.LocalFile),this.xdocLoadParam.SrcStr=e,l.EmrApiUtil.LoadXDocBrowse(!0,this.xdocLoadParam).GetPagePanel(a.ENumPagePanelTp.Body).GetChildrenByTypes(["XInputField"],!0,t)}}t.A_SyncDataByTitle=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetValueByTitle=void 0;const r=n(1),i=n(3),l=n(0),s=n(2),o=n(13),a=n(6),u=n(240),h=n(361),d=n(70),c=n(60),p=n(89),f=n(95),g=n(32);class m extends r.XBaseAction{constructor(e){super(e),this.rangeEdtAssist=null,this.rangeEdtAssist=new u.EditEleRangeAssist}ActName(){return"SetValueByTitle"}Execute(e){this.resMsg.Clear();try{let n=super.GetEdtCtrl(),r=new o.UndoGroup;this.xdoc=n.All_Document,this.rangeEdtAssist.SetEleEvtModel(n.M_EleEvtModel);for(var t=0;t<e.length;t++){let n=e[t].conceptId,i=e[t].value,l=e[t].type,s=e[t].docId,o=e[t].valueType?e[t].valueType:"text",a=null==e[t].buttonIconFlag||e[t].buttonIconFlag,u=null!=e[t].paragraphFlag&&e[t].paragraphFlag,h=null==e[t].returnFlag||e[t].returnFlag,d=1==e[t].filterTable,c=null!=e[t].KeepTrace&&e[t].KeepTrace;n&&this.setValue(n,i,l,o,a,u,h,s,c,r,d)}super.GetEdtCtrl().MRefreshDocsView(),this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}setValue(e,t,n,r,o,u,g,m,E,C,A){let y=super.GetEdtCtrl();for(var I=0;I<this.xdoc.length;I++){let S=this.xdoc[I];if(m&&S.DocID!=m)continue;let _,w=new i.List,b=new i.List,[x,P]=this.GetTitleChildList(S,e,w,o,A);if(null==P||"text"==r&&w.Get(w.Length-1)instanceof l.XParagraphFlag?(_=w.Get(w.Length-1),w.RemoveAt(w.Length-1)):_=P,"normal"==n){for(let e of w){let t=e instanceof l.XBaseContainer?e:null;if(null!=t){let e=new i.List;t.GetAllBaseChildren(e),b.AddRange(e)}else b.Add(e)}let e=b.ToArray(),t=new h.EditEleSubRange(0);t.ToIx=e.length,t.AddHistUsrInfo.Clear();let n=t;const r=y.M_EleEvtModel.WorkMode==s.ENumWorkMode.App||y.M_EleEvtModel.WorkMode==s.ENumWorkMode.Form,o=y.M_EdtCustomEvtGrp.AppKeepTrace;E&&r&&o?this.rangeEdtAssist.RemoveSubRangeAsTrace(e,n,C):this.rangeEdtAssist.RemoveSubRange(e,n,C)}if("xml"==r){let e=new d.XDocLoadParam(null,s.ENumXDocPath.LocalFile);e.SrcStr=t;let n=c.EmrApiUtil.LoadXDocBrowse(!0,e);const r=y.M_EleEvtModel,o=y.M_EdtCustomEvtGrp.AppKeepTrace;let h=r.AddEdtHistAct;if(o&&E||(h=null),null!=n){this.clearKeepTrace(n.GetPagePanel(a.ENumPagePanelTp.Body));let e=new i.List;n.storeChildrenList(e);const t=p.MsgRegisterHandler.changeAllChildrenNewIdAndXId(e,!0);p.MsgRegisterHandler.updateAllExpressStr(t[0],t[1],e)}let m=S,A=_;if(!g){let e=n.GetPagePanel(a.ENumPagePanelTp.Body);e.ChildEleList.Get(e.ChildEleList.Length-1)instanceof l.XParagraphFlag&&e.ChildEleList.RemoveAt(e.ChildEleList.Length-1)}if(u){let e=A.Parent,t=e.GetChildInx(A),n=new l.XParagraphFlag;e.AddChildEle(t,n)}m.AssistFunc.InsertBodyFrom(n,A,!1,h,null,C);f.EmrInnerUtil.ResetBodyXInputCache(S,y),p.MsgRegisterHandler.RegisterExpressionToMsgBus(S)}else y.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(_),y.M_ActionHandler.L_ExecuteCommand("InsertString",[t])}}clearKeepTrace(e){if(null==e)return;let t;const n=e.EleStyle;if(null!=n&&(n.DeleterIndex>-1&&(e.Parent.RemoveChild(e),t=!0),n.CreatorIndex>-1&&(n.CreatorIndex=-1)),!t&&e instanceof l.XBaseContainer){for(let t=0;t<e.ChildEleList.ToArray().length;t++){const n=e.ChildEleList.Get(t);this.clearKeepTrace(n)}e.ChildCount<=0&&e.Parent.RemoveChild(e)}}GetTitleChildList(e,t,n,r,i=!1){let s,o,a=e.GetChildrenByType("XTextLabelElement",!0,!1);for(let e of a)if(e.CptID==t){o=e;let t=e.Parent.ChildEleList,a=t.IndexOf(e),u=t.Length;for(let o=a+1;o<u;o++){let u=t.Get(o);if(!(o==a+1&&u instanceof l.XButtonEle)||r){if(u instanceof g.XTextLabelElement&&u.TitleLevel<=e.TitleLevel){s=u;break}if(u instanceof l.XTextTable&&i){s=u;break}n.Add(u)}}break}return[o,s]}}t.A_SetValueByTitle=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetCursorInfo=void 0;const r=n(1),i=n(32),l=n(55),s=n(6),o=n(38);class a extends r.XBaseAction{ActName(){return"GetCursorInfo"}Execute(e){this.resMsg.Clear();const t=super.GetEdtCtrl(),n=null!=t?t.M_EleEvtModel:null;let[r,s]=[null,null],o=[null,null],a=[null,null];if(null!=n){const e=n.EleClickedWrap;let i=new l.EmrEditEleRange;i.SetEleEvtObjs(n,t.M_EleEvtHandler);const u=i.IsSelRangeValid();[r,s]=u?super.GetSelRangeOuterEles(n.SelRange):super.GetFocusedOuterEles(e),o=[e.ClickPosInCtrl.X,e.ClickPosInCtrl.Y],a=[e.CursorPosInDom.X,e.CursorPosInDom.Y]}try{if(null==r&&null==s)return this.resMsg.ReturnParams=!1,this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 未获取光标所在位置",super.MessageWarn(),this.resMsg;let t,n={};if("onlyTitle"==(null!=e?e.valueTarget:null)?r instanceof i.XTextLabelElement?t=r:s instanceof i.XTextLabelElement?t=s:(null!=r&&(t=this.getXTLabelByBaseEle(r)),null!=s&&null==t&&(t=this.getXTLabelByBaseEle(r))):t=null!=r?r:s,t instanceof i.XTextLabelElement?n={text:t.Text,name:t.EleText}:null!=t&&(n={name:t.Name}),null==t)this.resMsg.ReturnParams={};else{let e=t.GetBoundsDPI(96).X,r=t.GetBoundsDPI(96).Y;null!=t.OwnerLine&&(e+=t.OwnerLine.GetBoundsDPI(96).X,r+=t.OwnerLine.GetBoundsDPI(96).Y),null!=t.OwnerDocPanel&&(e+=t.OwnerDocPanel.GetBoundsDPI(96).X,r+=t.OwnerDocPanel.GetBoundsDPI(96).Y),this.resMsg.ReturnParams=Object.assign({position:[e,r],caretPos:o,caretPosInDom:a,cId:t.CptID,value:t.GetInnerText(!1)},n)}}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}getXTLabelByBaseEle(e){let t;if(null!=e){const n=e.Document,r=null!=n?n.GetPagePanel(s.ENumPagePanelTp.Body):null;let l=new o.List;r.GetAllBaseChildren(l,!1);for(let n=l.FindIndex(0,l.Count(),t=>t.XID==e.XID)-1;n>=0;n--){const e=l.Get(n);if(e instanceof i.XTextLabelElement){t=e;break}}}return t}}t.A_GetCursorInfo=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdateBase=void 0;const r=n(1),i=n(4),l=n(3),s=n(20),o=n(2),a=n(0);class u extends r.XBaseAction{ActName(){return"UpdateBase"}Execute(e){if(this.resMsg.Clear(),this.resMsg.ReturnParams=null,this.resMsg.IsReturnMsg=!0,e.length<1)return this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",this.resMsg;this.refreshStatus=o.ENumRefreshStatus.None,super.isRefresh=!1,this.docIdArr=[],this.resMsg.MsgStr="";for(let t=0;t<e.length;t++){const n=e[t],r=n.docId;let o=this.getDocIx(r);const a=super.GetEdtCtrl().All_Document[o];if(null==a){this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+t+"]中的docId="+r+" 不存在病历文档Id["+this.docIdArr.join(",")+"]中。<br />";continue}let u=new l.List;const h=n.xId,d=n.cId,c=a.GetPagePanel(1);if(i.default.IsNullOrEmpty(h)?i.default.IsNullOrEmpty(d)?(this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+t+"]中的xId和cId不可均为空。<br />"):c.GetChildrenByCptId(d,!0,u):c.GetChildrenByXID(h,!0,u),u.Count()<1){this.resMsg.MsgLevel=5,this.resMsg.MsgStr+=this.ActName()+" 命令参数数组["+t+"]中的xId和cId均无法在病历文档中找到对应元素。<br />";continue}const p=n.isInTable;if(p){const e=s.XTextTableUtil.GetTextTableByCptID(h||d,c);u.Clear(),u.Add(e)}if(n.isInTableCell){const e=this.getCell(n,u,p);null!=e&&(u.Clear(),u.AddRange(e))}if(null!=n.attrs)for(let e=0;e<u.Count();e++){const t=u.Get(e);this.updateByType(t,n.attrs);const r=n.attrs.refreshStatus;this.refreshStatus<r&&(this.refreshStatus=r)}}return super.isRefresh=!0,this.refreshStatus==o.ENumRefreshStatus.None&&(this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName()+" 命令中无任何属性需更新"),super._RefreshPageAndMoveCaret(!0),this.resMsg}getDocIx(e){let t=0;if(!i.default.IsNullOrEmpty(e)){if(null==this.docIdArr||this.docIdArr.length<1){const e=super.GetEdtCtrl().All_Document;for(let t=0;t<e.length;t++){const n=e[t];this.docIdArr[t]=n.DocID}}t=this.docIdArr.indexOf(e)}return t}getCell(e,t,n){let r=[];if(n){let n=null===e.rowIx?-1:Number(e.rowIx);n=isNaN(n)?-1:Math.floor(n);let i=null===e.colIx?-1:Number(e.colIx);i=isNaN(i)?-1:Math.floor(i);const l=t.ToArray();for(let e=0;e<l.length;e++){const t=l[e];if(null==t||!(t instanceof a.XTextTable))continue;const s=t.Rows.ToArray();for(let e=0;e<s.length;e++){const t=s[e];if(null==t||n>=0&&t.Index!=n)continue;const l=t.Cells.ToArray();for(let e=0;e<l.length;e++){const t=l[e];null==t||i>=0&&t.ColIndex!=i||r.push(t)}}}}else{const e=t.ToArray();for(let t=0;t<e.length;t++){const n=e[t];let i;i=n instanceof a.XTextTableCell?n:s.XTextTableUtil.GetCursorCell(n),null!=i&&r.push(i)}}return r.length<1?null:r}updateByType(e,t){let n,i=null;switch(e.EleTypeName){case"XTextTable":n="TextTableProperty",i=e;break;case"XTextTableCell":n="TextTableCellProperty",i=e;break;case"XImage":n="UpdateImage";break;case"XBarcodeField":n="UpdateGraph",t.insertType=e.Type;break;case"XMedicalExpressionField":case"XPageInfo":n="UpdateGraph";break;case"HorizontalLine":break;case"Shape":case"XButtonEle":n="UpdateGraph";break;case"XTextLabelElement":break;case"XTextRadioBox":case"XTextCheckBox":case"XInputField":n="UpdateElement",i=!0}let l=super.GetEdtCtrl().M_GetActionByName(n);null!=l&&(r.XBaseAction.SetCurEle(e),l.Execute([t,i]))}}t.A_UpdateBase=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ProhibitedDoc=void 0;const r=n(1),i=n(3),l=n(0),s=n(241),o=n(6),a=n(7);class u extends r.XBaseAction{constructor(e){super(e)}ActName(){return"ProhibitedDoc"}Execute(e){this.resMsg.Clear();let t=[];this.locate=!1,super.GetEdtCtrl().unfocus=!0;for(let n=0;n<e.length;n++){let r=e[n],i=r.docId,l=r.ProhibiteList,s=this.ProhibitedDoc(i,l);t.push(...s)}return this.resMsg.ReturnParams=t,this.resMsg}ProhibitedDoc(e,t){let n=super.GetEdtCtrl().All_Document,r=[];for(var l=0;l<n.length;l++){if(e&&n[l].DocID!=e)continue;let s=[],o=n[l],a=this.BulidFindReplaceResults(o),u=new i.List;for(let e=0;e<a.Length;e++){let t=a.Get(e);t.TogetherWithPre?u.Get(u.Length-1).MergeChildList(t):u.Add(t)}for(let e=0;e<t.length;e++){let n=t[e];this.BulidSuitList_SelRange(n,u)&&s.push(n)}s.length>0&&r.push({docId:o.DocID,list:s})}return r}BulidFindReplaceResults(e){let t,n=new i.List,r=["XString","XLable","XTextRadioBox","XTextCheckBox"],a=new i.List;e.GetPagePanel(o.ENumPagePanelTp.Header).GetChildrenByTypes(r,!0,a),e.GetPagePanel(o.ENumPagePanelTp.Body).GetChildrenByTypes(r,!0,a),e.GetPagePanel(o.ENumPagePanelTp.Footer).GetChildrenByTypes(r,!0,a);let u=new i.List;for(let e=0;e<a.Count();e++){const t=a.Get(e);l.XDomUtil.HasDelTrace(t)||u.Add(t)}if(a=u,a.Count()<=0)t=null;else{super.GetEdtCtrl().M_EleEvtModel.EleClicked;let e,r=0;for(;r<a.Count();){let t=a.Get(r),i=t instanceof l.XStringEle?t:null;if(null!=i&&i.IsXInputBkgText){r++;continue}if(null!=(t instanceof l.XLabelEle?t:null)){r++;continue}let o=new s.FindReplaceAssistInfo;if(o.AddChildEle(t),null!=e){let n=e.Parent.GetChildInx(e),r=e.Parent.GetChildInx(t);t.Parent.Equals(e.Parent)&&n+1==r&&(o.TogetherWithPre=!0)}n.Add(o),e=t,r++}t=n}return t}BulidSuitList_SelRange(e,t){let n=!1;if(null==t)return n;for(let r=0;r<t.Length;r++){let i=t.Get(r).HitTest(e,!1,!1);if(i.Length>0){if(!this.locate){let e=super.GetEdtCtrl(),t=l.XDomUtil.GetNextEle(!0,i.Get(0).HitEles.Get(i.Get(0).HitEles.Count()-1)),n=e.M_EleEvtModel.EleClickedWrap.EleFocused;e.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(t);let r=e.M_EleEvtModel.EleClickedWrap.EleFocused;e.M_EleEvtHandler.OnCursorChange(n,r),e.M_EleEvtModel.MoveCaretByCursorEle(!0)}this.locate=!0}for(let e=0;e<i.Length;e++){n=!0;let t=i.Get(e).HitEles;for(let e=0;e<t.Length;e++)t.Get(e).EleStyle.ForeColor=new a.Color("#FFFF0000")}}return n}}t.A_ProhibitedDoc=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdateInputReadOnly=void 0;const r=n(1),i=n(3),l=n(33),s=n(0);class o extends r.XBaseAction{constructor(e){super(e)}ActName(){return"UpdateInputReadOnly"}Execute(e){this.resMsg.Clear();try{let n=super.GetEdtCtrl();this.xdoc=n.All_Document;let r=n.unfocus;this.RefreshDocList=[],n.unfocus=null!=e[0].unfocus?e[0].unfocus:r;for(var t=0;t<e.length;t++){let n=e[t].conceptId,r=e[t].readOnly,i=e[t].docId;this.setInputReadOnly(n,r,i)}this.MRefreshDocsView(),this.resMsg.ReturnParams=!0,n.unfocus=r}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}setInputReadOnly(e,t,n){for(var r=0;r<this.xdoc.length;r++){if(n&&this.xdoc[r].DocID!=n)continue;let o=new l.EmrCalcEngine(this.xdoc[r]),a=new i.List;if(o.GetXDocHeader().GetChildrenByCptId(e,!0,a),o.GetXDocBody().GetChildrenByCptId(e,!0,a),o.GetXDocFooter().GetChildrenByCptId(e,!0,a),a.Length>0){this.resetRefreshDocList(this.xdoc[r]);for(let e of a)e instanceof s.XInputEle&&(e.UserEditable=!t)}}}}t.A_UpdateInputReadOnly=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UndoInsertDocWithRelateId=void 0;const r=n(1),i=n(6),l=n(0),s=n(3),o=n(55);class a extends r.XBaseAction{constructor(e){super(e),this.edt_elerange=new o.EmrEditEleRange}ActName(){return"UndoInsertDocWithRelateId"}Execute(e){this.resMsg.Clear();try{let t=super.GetEdtCtrl();if(this.edt_elerange.SetEleEvtObjs(t.M_EleEvtModel,t.M_EleEvtHandler),e.length>0){for(let n=0;n<e.length;n++){let r=e[n].undoRelateId,o=t.All_Document;for(let e=0;e<o.length;e++){let t,n=o[e].GetPagePanel(i.ENumPagePanelTp.Body),a=new s.List;if(n.GetChildrenWithRelateId(!0,a,r),!(a.Length<=0)){for(let e of a)t=e.Parent,t.RemoveChild(e);t instanceof l.XBaseInputEle&&this.TrySwitchXInputToEmpty(t)}}}super._RefreshPageAndMoveCaret(!0)}this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}TrySwitchXInputToEmpty(e){if(null==e||l.XDomUtil.IsEleRemoved(e,!0)||l.XDomUtil.HasContent(e,!0))return!1;let t=e.GetBackTextXStrEle();if(null==t)return!0;let n=l.XDomUtil.GetXInputCtntChildIx(e);e.AddChildEle(n,t),e.EleStyle.isDefaultForeColor=!0,e.EleStyle.isDefaultBackgroundColor=!0}}t.A_UndoInsertDocWithRelateId=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertTableWithContent=void 0;const r=n(45),i=n(20),l=n(373),s=n(13),o=n(48),a=n(38),u=n(6),h=n(108),d=n(7);class c extends o.A_InsertElement{ActName(){return"InsertTableWithContent"}Execute(e){let t;this.resMsg.Clear(),this.inertTableInfo=l.InsertTableInfo.GetTextInfo();let n=e[0],i=this.getPosCID(n),o=!0===n.changeFlag;if(null!=i||this.InsertValid())if(this.resMsg.MsgLevel<5)t=this.resMsg;else{let e=super.GetEdtCtrl();null!=n&&(this.inertTableInfo.No=n.elementCodeString,this.inertTableInfo.ColNum=n.columnNumberString,this.inertTableInfo.RowNum=n.lineNumberString);try{if(null==this.inertTableInfo)return this.resMsg;let l=new r.XTextTable,u=e.M_EleEvtModel.EleClicked;if(null!=i){e.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.ReplaceEle(i)}else u=e.M_EleEvtModel.EleClicked;if(null==u)return this.resMsg.MsgStr="当前光标所在位置的元素对象为空",this.MessageError(),this.resMsg;let c=new s.UndoGroup;if(l.OwnerDocPanel=e.M_EleEvtModel.EleClicked.OwnerDocPanel,l.Action_CreateTextTable_New(this.inertTableInfo.RowNum,this.inertTableInfo.ColNum),null!=l&&!1===n.showBorder){l.IsShowBorderHideLine=!1,l.EleStyle.BorderTop=!1,l.EleStyle.BorderBottom=!1,l.EleStyle.BorderLeft=!1,l.EleStyle.BorderRight=!1;let e=l.ChildEleList;for(let t of e){let e=t.ChildEleList;for(let t of e){let e=t;e.EleStyle.DashStyle=0,e.EleStyle.EleBdrWidth=0,e.EleStyle.BackgroundColor=new d.Color("#ffffff"),e.EleStyle.BorderRight=!1,e.EleStyle.BorderTop=!1,e.EleStyle.BorderLeft=!1,e.EleStyle.BorderBottom=!1,e.EleStyle.TopBorderLineColor=new d.Color("#ffffff"),e.EleStyle.RightBorderLineColor=new d.Color("#ffffff"),e.EleStyle.TopApplytoText="单元格",e.EleStyle.RightApplytoText="单元格"}}}n.CptID&&(l.CptID=n.CptID);let p=[];if(n.content&&n.content.length>0){let t=n.content;for(let n=0;n<t.length;n++){let r=l.Rows.Get(t[n].rowIndex).ChildEleList.Get(t[n].colIndex),i=t[n].value,s=new a.List,o=super.GetXDocFocused().GetDefaultStyle();if(null!=i&&(i+=""),!i)continue;let d=h.EditEleRange.BuildElesFromStr(i,o,s,e.M_EleEvtModel.EleClickedWrap);if(s.Length>0){s.Insert(0,d);for(let e of s)e.Parent=r,e.OwnerDocPanel=u.OwnerDocPanel;r.ChildEleList.InsertRange(0,s.ToArray()),p.push(...s.ToArray())}else d.Parent=r,d.OwnerDocPanel=u.OwnerDocPanel,r.ChildEleList.Insert(0,d),p.push(d)}}return o&&this.SetTimeChangeColor(p),this.resMsg=super.Execute([l,c]),super._AddUndoItem(c),t=this.resMsg,t}catch(e){this.resMsg.Ex=e}t=this.resMsg}else this.resMsg.MsgStr="单元格内不允许插入表格",this.MessageError(),t=this.resMsg;return t}InsertValid(){let e=super.GetEdtCtrl().M_EleEvtModel.EleClicked;return null==i.XTextTableUtil.GetCursorCell(e)}getPosCID(e){let t;if(null!=e){const n=e.posCID;if(n){const e=super.GetEdtCtrl().M_DocumentFocused.GetPagePanel(u.ENumPagePanelTp.Body);let r=new a.List;if(e.GetChildrenByCptId(n,!0,r),r.Count()>0&&(t=r.Get(0)),null!=t){let n=e.GetChildInx(t);n++,n>0&&(t=e.GetChildEle(n))}}}return t}}t.A_InsertTableWithContent=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SaveFileWithNotTrace=void 0;const r=n(1),i=n(14);class l extends r.XBaseAction{ActName(){return"SaveFileWithNotTrace"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t=e.length,n=super.GetEdtCtrl();this.ClearStyle();let r=[];if(t>0)for(let l=0;l<t;l++){let t=e[l].docId,s=n.All_Document;for(let e=0;e<s.length;e++){let n=s[e];if(n.DocID==t){n.SaveWithTrace=!1;let e=n.ToXML();n.SaveWithTrace=!0;let l=i.XmlDomUtil.Xml2String(e);r.push({docId:t,xml:l})}}}else{let e=n.M_DocumentFocused;e.SaveWithTrace=!1;let t=n.M_DocumentFocused.ToXML();e.SaveWithTrace=!0;let l=i.XmlDomUtil.Xml2String(t);r.push({docId:e.DocID,xml:l})}return this.resMsg.ReturnParams=r,this.resMsg}}t.A_SaveFileWithNotTrace=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ExportPDF=void 0;const r=n(1),i=n(1072),l=n(2),s=n(6),o=n(3),a=n(0),u=n(152);class h extends r.XBaseAction{ActName(){return"ExportPDF"}Execute(e){this.resMsg.Clear();let t,n=super.GetEdtCtrl(),r=e.length,i="printPreview",s=null,o=!0,a=!0;if(r>0){let n=e[0];i=n.exportMode,s=n.callback,t=n.outPutType,o=null==n.showStatusImg||n.showStatusImg,a=null==n.showWaterMark||n.showWaterMark,this.docList=null==n.docArr?[]:n.docArr}let h=n.M_EleEvtModel.WorkMode,d=n.PageContainerDom;if(n.LazyLoad=!1,this.chageFlag=!1,"printPreview"==i&&h!=l.ENumWorkMode.PrintPreview){this.chageFlag=!0,n.M_GetActionByName("SetWorkMode_Browse").Execute([]),n.M_EleEvtModel.WorkMode=l.ENumWorkMode.PrintPreview,n.MShowAsPrint=!0}else if("Design"==i&&h!=l.ENumWorkMode.Design){n.M_GetActionByName("SetWorkMode_Design").Execute([]),this.chageFlag=!0}else if("Browse"==i&&h!=l.ENumWorkMode.Browse&&h!=l.ENumWorkMode.App&&h!=l.ENumWorkMode.Form){n.M_GetActionByName("SetWorkMode_Browse").Execute([]),this.chageFlag=!0}let c=document.createElement("div");c.id="previewpagescontainer",c.style.marginTop="8px",c.style.height="1px",c.style.overflowY="auto",n.dom.appendChild(c),n.PageContainerDom=c,n.ShowStatusImg=o,n.ShowWaterMark=a;let p=n.unfocus;this.docList&&this.docList.length>0&&n.reLoadXTextDocument(this.docList,!1),n.unfocus=!0,u.ImageCache.Clear(),u.ImageCache.ClearImgList(),n.ImageLoadFinish=!1,this.GetAllImage(i,o);this.IsImageAllCache();return u.ImageCache.GetImagList().Length>0?(n.M_EdtCustomEvtGrp.ImgLoadFinish=()=>{n.ImageLoadFinish=!0,n.M_EdtCustomEvtGrp.ImgLoadFinish=void 0,this.ExportReset(c,s,t,d,h,null,p,i)},n.MRefreshDocsView()):(n.ImageLoadFinish=!0,n.MRefreshDocsView(),this.ExportReset(c,s,t,d,h,null,p,i)),this.resMsg}GetAllImage(e,t){let n=super.GetEdtCtrl().All_Document;for(let r=0;r<n.length;r++){let i=n[r];if(this.docList&&this.docList.length>0&&-1==this.docList.indexOf(i.DocID))continue;let l=i.GetPagePanel(s.ENumPagePanelTp.Header),h=i.GetPagePanel(s.ENumPagePanelTp.Body),d=i.GetPagePanel(s.ENumPagePanelTp.Footer),c=new o.List;l.GetChildrenByTypes(["XImage","XBarcodeField"],!0,c),h.GetChildrenByTypes(["XImage","XBarcodeField"],!0,c),d.GetChildrenByTypes(["XImage","XBarcodeField"],!0,c),i.DocStatusImage&&t&&u.ImageCache.PutImage(i.DocStatusImage);for(let t of c)t.CanBeInline("printPreview"==e)&&-1==t.EleStyle.DeleterIndex&&(t instanceof a.XImageEle?u.ImageCache.PutImage(t.ImgObj.ImageEle.src):t instanceof a.XCodeEle&&t.CodeInfo.CodeValue.indexOf("PageIndex")<=-1&&u.ImageCache.PutImage(t.DrawImage.ImageEle.src))}}ExportReset(e,t,n,r,s,o,a,h){let d=super.GetEdtCtrl();const c=d.MGetPageViewList()[0].PageFormat,p=new i.default({orientation:c.Landscape?"l":"p",unit:"px",hotfixes:["px_scaling"],format:[c.Width,c.Height]});let f=d.ContainerDOM.querySelector("#previewpagescontainer").querySelectorAll("canvas");for(let e=0;e<f.length;e++){let t=f[e].toDataURL("image/jpg");p.addImage({imageData:t,x:0,y:0,width:c.Width,height:c.Height,format:"JPG",compression:"FAST"}),e!=f.length-1&&(p.addPage(),p.setPage(e+2))}if(t&&"function"==typeof t)switch(n){case"arraybuffer":o=p.output("arraybuffer");break;case"blob":o=p.output("blob");break;case"bloburi":o=p.output("bloburi");break;case"datauristring":o=p.output("datauristring");break;case"pdfobjectnewwindow":o=p.output("pdfobjectnewwindow");break;case"dataurl":o=p.output("dataurl");break;default:p.save("pdfexport")}e.remove(),this.docList&&this.docList.length>0&&d.reLoadXTextDocument(null,!1),d.PageContainerDom=r,d.ShowStatusImg=!0,d.ShowWaterMark=!0,u.ImageCache.ClearImgList(),d.LazyLoad=!0;let g="";if(this.chageFlag){switch(s){case l.ENumWorkMode.Design:g="SetWorkMode_Design";break;case l.ENumWorkMode.App:g="SetWorkMode_App";break;case l.ENumWorkMode.Form:g="SetWorkMode_Form";break;case l.ENumWorkMode.Browse:g="SetWorkMode_Browse";break;case l.ENumWorkMode.KeepTrace:g="SetWorkMode_KeepTrace";break;case l.ENumWorkMode.PrintPreview:g="SetPrintPreview"}d.M_GetActionByName(g).Execute([])}else d.MRefreshDocsView();d.unfocus=!1,t({params:o,pageNum:f.length})}IsImageAllCache(){let e=super.GetEdtCtrl().ImageList;if(e&&e.Length>0)for(let t of e){if(null==u.ImageCache.Get(t))return!1}return!0}}t.A_ExportPDF=h},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"AcroForm",(function(){return Te})),n.d(t,"AcroFormAppearance",(function(){return be})),n.d(t,"AcroFormButton",(function(){return Ce})),n.d(t,"AcroFormCheckBox",(function(){return Se})),n.d(t,"AcroFormChoiceField",(function(){return fe})),n.d(t,"AcroFormComboBox",(function(){return me})),n.d(t,"AcroFormEditBox",(function(){return Ee})),n.d(t,"AcroFormListBox",(function(){return ge})),n.d(t,"AcroFormPasswordField",(function(){return we})),n.d(t,"AcroFormPushButton",(function(){return Ae})),n.d(t,"AcroFormRadioButton",(function(){return ye})),n.d(t,"AcroFormTextField",(function(){return _e})),n.d(t,"GState",(function(){return N})),n.d(t,"ShadingPattern",(function(){return k})),n.d(t,"TilingPattern",(function(){return O})),n.d(t,"jsPDF",(function(){return G}));var r=n(28),i=n.n(r),l=n(148),s=function(){return"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this}();function o(){s.console&&"function"==typeof s.console.log&&s.console.log.apply(s.console,arguments)}var a={log:o,warn:function(e){s.console&&("function"==typeof s.console.warn?s.console.warn.apply(s.console,arguments):o.call(null,arguments))},error:function(e){s.console&&("function"==typeof s.console.error?s.console.error.apply(s.console,arguments):o(e))}};function u(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){f(r.response,t,n)},r.onerror=function(){a.error("could not download file")},r.send()}function h(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function d(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var c,p,f=s.saveAs||("object"!==("undefined"==typeof window?"undefined":i()(window))||window!==s?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=s.URL||s.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener","string"==typeof e?(i.href=e,i.origin!==location.origin?h(i.href)?u(e,t,n):d(i,i.target="_blank"):d(i)):(i.href=r.createObjectURL(e),setTimeout((function(){r.revokeObjectURL(i.href)}),4e4),setTimeout((function(){d(i)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download","string"==typeof e)if(h(e))u(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout((function(){d(r)}))}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!==i()(t)&&(a.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,n),t)}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return u(e,t,n);var l="application/octet-stream"===e.type,o=/constructor/i.test(s.HTMLElement)||s.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||l&&o)&&"object"===("undefined"==typeof FileReader?"undefined":i()(FileReader))){var h=new FileReader;h.onloadend=function(){var e=h.result;e=a?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},h.readAsDataURL(e)}else{var d=s.URL||s.webkitURL,c=d.createObjectURL(e);r?r.location=c:location.href=c,r=null,setTimeout((function(){d.revokeObjectURL(c)}),4e4)}});function g(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,l=n[r].process,s=i.exec(e);s&&(t=l(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n}}function m(e,t){var n=e[0],r=e[1],i=e[2],l=e[3];n=C(n,r,i,l,t[0],7,-680876936),l=C(l,n,r,i,t[1],12,-389564586),i=C(i,l,n,r,t[2],17,606105819),r=C(r,i,l,n,t[3],22,-1044525330),n=C(n,r,i,l,t[4],7,-176418897),l=C(l,n,r,i,t[5],12,1200080426),i=C(i,l,n,r,t[6],17,-1473231341),r=C(r,i,l,n,t[7],22,-45705983),n=C(n,r,i,l,t[8],7,1770035416),l=C(l,n,r,i,t[9],12,-1958414417),i=C(i,l,n,r,t[10],17,-42063),r=C(r,i,l,n,t[11],22,-1990404162),n=C(n,r,i,l,t[12],7,1804603682),l=C(l,n,r,i,t[13],12,-40341101),i=C(i,l,n,r,t[14],17,-1502002290),n=A(n,r=C(r,i,l,n,t[15],22,1236535329),i,l,t[1],5,-165796510),l=A(l,n,r,i,t[6],9,-1069501632),i=A(i,l,n,r,t[11],14,643717713),r=A(r,i,l,n,t[0],20,-373897302),n=A(n,r,i,l,t[5],5,-701558691),l=A(l,n,r,i,t[10],9,38016083),i=A(i,l,n,r,t[15],14,-660478335),r=A(r,i,l,n,t[4],20,-405537848),n=A(n,r,i,l,t[9],5,568446438),l=A(l,n,r,i,t[14],9,-1019803690),i=A(i,l,n,r,t[3],14,-187363961),r=A(r,i,l,n,t[8],20,1163531501),n=A(n,r,i,l,t[13],5,-1444681467),l=A(l,n,r,i,t[2],9,-51403784),i=A(i,l,n,r,t[7],14,1735328473),n=y(n,r=A(r,i,l,n,t[12],20,-1926607734),i,l,t[5],4,-378558),l=y(l,n,r,i,t[8],11,-2022574463),i=y(i,l,n,r,t[11],16,1839030562),r=y(r,i,l,n,t[14],23,-35309556),n=y(n,r,i,l,t[1],4,-1530992060),l=y(l,n,r,i,t[4],11,1272893353),i=y(i,l,n,r,t[7],16,-155497632),r=y(r,i,l,n,t[10],23,-1094730640),n=y(n,r,i,l,t[13],4,681279174),l=y(l,n,r,i,t[0],11,-358537222),i=y(i,l,n,r,t[3],16,-722521979),r=y(r,i,l,n,t[6],23,76029189),n=y(n,r,i,l,t[9],4,-640364487),l=y(l,n,r,i,t[12],11,-421815835),i=y(i,l,n,r,t[15],16,530742520),n=I(n,r=y(r,i,l,n,t[2],23,-995338651),i,l,t[0],6,-198630844),l=I(l,n,r,i,t[7],10,1126891415),i=I(i,l,n,r,t[14],15,-1416354905),r=I(r,i,l,n,t[5],21,-57434055),n=I(n,r,i,l,t[12],6,1700485571),l=I(l,n,r,i,t[3],10,-1894986606),i=I(i,l,n,r,t[10],15,-1051523),r=I(r,i,l,n,t[1],21,-2054922799),n=I(n,r,i,l,t[8],6,1873313359),l=I(l,n,r,i,t[15],10,-30611744),i=I(i,l,n,r,t[6],15,-1560198380),r=I(r,i,l,n,t[13],21,1309151649),n=I(n,r,i,l,t[4],6,-145523070),l=I(l,n,r,i,t[11],10,-1120210379),i=I(i,l,n,r,t[2],15,718787259),r=I(r,i,l,n,t[9],21,-343485551),e[0]=T(n,e[0]),e[1]=T(r,e[1]),e[2]=T(i,e[2]),e[3]=T(l,e[3])}function E(e,t,n,r,i,l){return t=T(T(t,e),T(r,l)),T(t<<i|t>>>32-i,n)}function C(e,t,n,r,i,l,s){return E(t&n|~t&r,e,t,i,l,s)}function A(e,t,n,r,i,l,s){return E(t&r|n&~r,e,t,i,l,s)}function y(e,t,n,r,i,l,s){return E(t^n^r,e,t,i,l,s)}function I(e,t,n,r,i,l,s){return E(n^(t|~r),e,t,i,l,s)}function S(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)m(r,_(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(m(r,i),t=0;t<16;t++)i[t]=0;return i[14]=8*n,m(r,i),r}function _(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}c=s.atob.bind(s),p=s.btoa.bind(s);var w="0123456789abcdef".split("");function b(e){for(var t="",n=0;n<4;n++)t+=w[e>>8*n+4&15]+w[e>>8*n&15];return t}function x(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function P(e){return S(e).map(x).join("")}var v="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=b(e[t]);return e.join("")}(S("hello"));function T(e,t){if(v){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}function M(e,t){var n,r,i,l;if(e!==n){for(var s=(i=e,l=1+(256/e.length>>0),new Array(l+1).join(i)),o=[],a=0;a<256;a++)o[a]=a;var u=0;for(a=0;a<256;a++){var h=o[a];u=(u+h+s.charCodeAt(a))%256,o[a]=o[u],o[u]=h}n=e,r=o}else o=r;var d=t.length,c=0,p=0,f="";for(a=0;a<d;a++)p=(p+(h=o[c=(c+1)%256]))%256,o[c]=o[p],o[p]=h,s=o[(o[c]+o[p])%256],f+=String.fromCharCode(t.charCodeAt(a)^s);return f}var L={print:4,modify:8,copy:16,"annot-forms":32};function D(e,t,n,r){this.v=1,this.r=2;var i=192;e.forEach((function(e){if(void 0!==L.perm)throw new Error("Invalid permission: "+e);i+=L[e]})),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var l=(t+this.padding).substr(0,32),s=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(l,s),this.P=-(1+(255^i)),this.encryptionKey=P(l+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=M(this.encryptionKey,this.padding)}function R(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var i=e.charCodeAt(r);t+=i<33||35===i||37===i||40===i||41===i||47===i||60===i||62===i||91===i||93===i||123===i||125===i||i>126?"#"+("0"+i.toString(16)).slice(-2):e[r]}return t}function F(e){if("object"!==i()(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,r){if(r=r||!1,"string"!=typeof e||"function"!=typeof n||"boolean"!=typeof r)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var i=Math.random().toString(35);return t[e][i]=[n,!!r],i},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],0===Object.keys(t[n]).length&&delete t[n],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var l in t[n]){var o=t[n][l];try{o[0].apply(e,r)}catch(n){s.console&&a.error("jsPDF PubSub Error",n.message,n)}o[1]&&i.push(l)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function N(e){if(!(this instanceof N))return new N(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function B(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function k(e,t,n,r,i){if(!(this instanceof k))return new k(e,t,n,r,i);this.type="axial"===e?2:3,this.coords=t,this.colors=n,B.call(this,r,i)}function O(e,t,n,r,i){if(!(this instanceof O))return new O(e,t,n,r,i);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,B.call(this,r,i)}function G(e){var t,n="string"==typeof arguments[0]?arguments[0]:"p",r=arguments[1],l=arguments[2],o=arguments[3],u=[],h=1,d=16,c="S",m=null;"object"===i()(e=e||{})&&(n=e.orientation,r=e.unit||r,l=e.format||l,o=e.compress||e.compressPdf||o,null!==(m=e.encryption||null)&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),h="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(d=e.floatPrecision),c=e.defaultPathOperation||"S"),u=e.filters||(!0===o?["FlateEncode"]:u),r=r||"mm",n=(""+(n||"P")).toLowerCase();var E=e.putOnlyUsedFonts||!1,C={},A={internal:{},__private__:{}};A.__private__.PubSub=F;var y="1.3",I=A.__private__.getPdfVersion=function(){return y};A.__private__.setPdfVersion=function(e){y=e};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};A.__private__.getPageFormats=function(){return S};var _=A.__private__.getPageFormat=function(e){return S[e]};l=l||"a4";var w={COMPAT:"compat",ADVANCED:"advanced"},b=w.COMPAT;function x(){this.saveGraphicsState(),de(new je(xe,0,0,-xe,0,Xn()*xe).toString()+" cm"),this.setFontSize(this.getFontSize()/xe),c="n",b=w.ADVANCED}function P(){this.restoreGraphicsState(),c="S",b=w.COMPAT}var v=A.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};A.advancedAPI=function(e){var t=b===w.COMPAT;return t&&x.call(this),"function"!=typeof e||(e(this),t&&P.call(this)),this},A.compatAPI=function(e){var t=b===w.ADVANCED;return t&&P.call(this),"function"!=typeof e||(e(this),t&&x.call(this)),this},A.isAdvancedAPI=function(){return b===w.ADVANCED};var T,M=function(e){if(b!==w.ADVANCED)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},L=A.roundToPrecision=A.__private__.roundToPrecision=function(e,n){var r=t||n;if(isNaN(e)||isNaN(r))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(r).replace(/0+$/,"")};T=A.hpf=A.__private__.hpf="number"==typeof d?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return L(e,d)}:"smart"===d?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return L(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return L(e,16)};var B=A.f2=A.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return L(e,2)},X=A.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return L(e,3)},V=A.scale=A.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return b===w.COMPAT?e*xe:b===w.ADVANCED?e:void 0},H=function(e){return b===w.COMPAT?Xn()-e:b===w.ADVANCED?e:void 0},U=function(e){return V(H(e))};A.__private__.setPrecision=A.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var W,j="00000000000000000000000000000000",z=A.__private__.getFileId=function(){return j},Y=A.__private__.setFileId=function(e){return j=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():j.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),null!==m&&(Yt=new D(m.userPermissions,m.userPassword,m.ownerPassword,j)),j};A.setFileId=function(e){return Y(e),this},A.getFileId=function(){return z()};var Q=A.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),n=t<0?"+":"-",r=Math.floor(Math.abs(t/60)),i=Math.abs(t%60),l=[n,$(r),"'",$(i),"'"].join("");return["D:",e.getFullYear(),$(e.getMonth()+1),$(e.getDate()),$(e.getHours()),$(e.getMinutes()),$(e.getSeconds()),l].join("")},K=A.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),n=parseInt(e.substr(6,2),10)-1,r=parseInt(e.substr(8,2),10),i=parseInt(e.substr(10,2),10),l=parseInt(e.substr(12,2),10),s=parseInt(e.substr(14,2),10);return new Date(t,n,r,i,l,s,0)},q=A.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=Q(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return W=t},J=A.__private__.getCreationDate=function(e){var t=W;return"jsDate"===e&&(t=K(W)),t};A.setCreationDate=function(e){return q(e),this},A.getCreationDate=function(e){return J(e)};var Z,$=A.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},ee=A.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},te=0,ne=[],re=[],ie=0,le=[],se=[],oe=!1,ae=re,ue=function(){te=0,ie=0,re=[],ne=[],le=[],$e=qe(),et=qe()};A.__private__.setCustomOutputDestination=function(e){oe=!0,ae=e};var he=function(e){oe||(ae=e)};A.__private__.resetCustomOutputDestination=function(){oe=!1,ae=re};var de=A.__private__.out=function(e){return e=e.toString(),ie+=e.length+1,ae.push(e),ae},ce=A.__private__.write=function(e){return de(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},pe=A.__private__.getArrayBuffer=function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n);t--;)r[t]=e.charCodeAt(t);return n},fe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];A.__private__.getStandardFonts=function(){return fe};var ge=e.fontSize||16;A.__private__.setFontSize=A.setFontSize=function(e){return ge=b===w.ADVANCED?e/xe:e,this};var me,Ee=A.__private__.getFontSize=A.getFontSize=function(){return b===w.COMPAT?ge:ge*xe},Ce=e.R2L||!1;A.__private__.setR2L=A.setR2L=function(e){return Ce=e,this},A.__private__.getR2L=A.getR2L=function(){return Ce};var Ae,ye=A.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))me=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');me=e}else me=parseInt(e,10)};A.__private__.getZoomMode=function(){return me};var Ie,Se=A.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');Ae=e};A.__private__.getPageMode=function(){return Ae};var _e=A.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');Ie=e};A.__private__.getLayoutMode=function(){return Ie},A.__private__.setDisplayMode=A.setDisplayMode=function(e,t,n){return ye(e),_e(t),Se(n),this};var we={title:"",subject:"",author:"",keywords:"",creator:""};A.__private__.getDocumentProperty=function(e){if(-1===Object.keys(we).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return we[e]},A.__private__.getDocumentProperties=function(){return we},A.__private__.setDocumentProperties=A.setProperties=A.setDocumentProperties=function(e){for(var t in we)we.hasOwnProperty(t)&&e[t]&&(we[t]=e[t]);return this},A.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(we).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return we[e]=t};var be,xe,Pe,ve,Te,Me={},Le={},De=[],Re={},Fe={},Ne={},Be={},ke=null,Oe=0,Ge=[],Xe=new F(A),Ve=e.hotfixes||[],He={},Ue={},We=[],je=function e(t,n,r,i,l,s){if(!(this instanceof e))return new e(t,n,r,i,l,s);isNaN(t)&&(t=1),isNaN(n)&&(n=0),isNaN(r)&&(r=0),isNaN(i)&&(i=1),isNaN(l)&&(l=0),isNaN(s)&&(s=0),this._matrix=[t,n,r,i,l,s]};Object.defineProperty(je.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(je.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(je.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(je.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(je.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(je.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(je.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(je.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(je.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(je.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(je.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(je.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(je.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(je.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(je.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(je.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),je.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(e)},je.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,n=e.sx*this.shy+e.shy*this.sy,r=e.shx*this.sx+e.sy*this.shx,i=e.shx*this.shy+e.sy*this.sy,l=e.tx*this.sx+e.ty*this.shx+this.tx,s=e.tx*this.shy+e.ty*this.sy+this.ty;return new je(t,n,r,i,l,s)},je.prototype.decompose=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,i=this.tx,l=this.ty,s=Math.sqrt(e*e+t*t),o=(e/=s)*n+(t/=s)*r;n-=e*o,r-=t*o;var a=Math.sqrt(n*n+r*r);return o/=a,e*(r/=a)<t*(n/=a)&&(e=-e,t=-t,o=-o,s=-s),{scale:new je(s,0,0,a,0,0),translate:new je(1,0,0,1,i,l),rotate:new je(e,t,-t,e,0,0),skew:new je(1,0,o,1,0,0)}},je.prototype.toString=function(e){return this.join(" ")},je.prototype.inversed=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,i=this.tx,l=this.ty,s=1/(e*r-t*n),o=r*s,a=-t*s,u=-n*s,h=e*s;return new je(o,a,u,h,-o*i-u*l,-a*i-h*l)},je.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,n=e.x*this.shy+e.y*this.sy+this.ty;return new Dn(t,n)},je.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),n=this.applyToPoint(new Dn(e.x+e.w,e.y+e.h));return new Rn(t.x,t.y,n.x-t.x,n.y-t.y)},je.prototype.clone=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,i=this.tx,l=this.ty;return new je(e,t,n,r,i,l)},A.Matrix=je;var ze=A.matrixMult=function(e,t){return t.multiply(e)},Ye=new je(1,0,0,1,0,0);A.unitMatrix=A.identityMatrix=Ye;var Qe=function(e,t){if(!Fe[e]){var n=(t instanceof k?"Sh":"P")+(Object.keys(Re).length+1).toString(10);t.id=n,Fe[e]=n,Re[n]=t,Xe.publish("addPattern",t)}};A.ShadingPattern=k,A.TilingPattern=O,A.addShadingPattern=function(e,t){return M("addShadingPattern()"),Qe(e,t),this},A.beginTilingPattern=function(e){M("beginTilingPattern()"),Nn(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},A.endTilingPattern=function(e,t){M("endTilingPattern()"),t.stream=se[Z].join("\n"),Qe(e,t),Xe.publish("endTilingPattern",t),We.pop().restore()};var Ke=A.__private__.newObject=function(){var e=qe();return Je(e,!0),e},qe=A.__private__.newObjectDeferred=function(){return te++,ne[te]=function(){return ie},te},Je=function(e,t){return t="boolean"==typeof t&&t,ne[e]=ie,t&&de(e+" 0 obj"),e},Ze=A.__private__.newAdditionalObject=function(){var e={objId:qe(),content:""};return le.push(e),e},$e=qe(),et=qe(),tt=A.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var n=parseFloat(t[0]);t=[n,n,n,"r"]}for(var r="#",i=0;i<3;i++)r+=("0"+Math.floor(255*parseFloat(t[i])).toString(16)).slice(-2);return r},nt=A.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var n=e.ch1,r=e.ch2,l=e.ch3,s=e.ch4,o="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof n&&"#"!==n.charAt(0)){var a=new g(n);if(a.ok)n=a.toHex();else if(!/^\d*\.?\d*$/.test(n))throw new Error('Invalid color "'+n+'" passed to jsPDF.encodeColorString.')}if("string"==typeof n&&/^#[0-9A-Fa-f]{3}$/.test(n)&&(n="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),"string"==typeof n&&/^#[0-9A-Fa-f]{6}$/.test(n)){var u=parseInt(n.substr(1),16);n=u>>16&255,r=u>>8&255,l=255&u}if(void 0===r||void 0===s&&n===r&&r===l)if("string"==typeof n)t=n+" "+o[0];else switch(e.precision){case 2:t=B(n/255)+" "+o[0];break;case 3:default:t=X(n/255)+" "+o[0]}else if(void 0===s||"object"===i()(s)){if(s&&!isNaN(s.a)&&0===s.a)return["1.","1.","1.",o[1]].join(" ");if("string"==typeof n)t=[n,r,l,o[1]].join(" ");else switch(e.precision){case 2:t=[B(n/255),B(r/255),B(l/255),o[1]].join(" ");break;default:case 3:t=[X(n/255),X(r/255),X(l/255),o[1]].join(" ")}}else if("string"==typeof n)t=[n,r,l,s,o[2]].join(" ");else switch(e.precision){case 2:t=[B(n),B(r),B(l),B(s),o[2]].join(" ");break;case 3:default:t=[X(n),X(r),X(l),X(s),o[2]].join(" ")}return t},rt=A.__private__.getFilters=function(){return u},it=A.__private__.putStream=function(e){var t=(e=e||{}).data||"",n=e.filters||rt(),r=e.alreadyAppliedFilters||[],i=e.addLength1||!1,l=t.length,s=e.objectId,o=function(e){return e};if(null!==m&&void 0===s)throw new Error("ObjectId must be passed to putStream for file encryption");null!==m&&(o=Yt.encryptor(s,0));var a={};!0===n&&(n=["FlateEncode"]);var u=e.additionalKeyValues||[],h=(a=void 0!==G.API.processDataByFilters?G.API.processDataByFilters(t,n):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(r)?r.join(" "):r.toString());if(0!==a.data.length&&(u.push({key:"Length",value:a.data.length}),!0===i&&u.push({key:"Length1",value:l})),0!=h.length)if(h.split("/").length-1==1)u.push({key:"Filter",value:h});else{u.push({key:"Filter",value:"["+h+"]"});for(var d=0;d<u.length;d+=1)if("DecodeParms"===u[d].key){for(var c=[],p=0;p<a.reverseChain.split("/").length-1;p+=1)c.push("null");c.push(u[d].value),u[d].value="["+c.join(" ")+"]"}}de("<<");for(var f=0;f<u.length;f++)de("/"+u[f].key+" "+u[f].value);de(">>"),0!==a.data.length&&(de("stream"),de(o(a.data)),de("endstream"))},lt=A.__private__.putPage=function(e){var t=e.number,n=e.data,r=e.objId,i=e.contentsObjId;Je(r,!0),de("<</Type /Page"),de("/Parent "+e.rootDictionaryObjId+" 0 R"),de("/Resources "+e.resourceDictionaryObjId+" 0 R"),de("/MediaBox ["+parseFloat(T(e.mediaBox.bottomLeftX))+" "+parseFloat(T(e.mediaBox.bottomLeftY))+" "+T(e.mediaBox.topRightX)+" "+T(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&de("/CropBox ["+T(e.cropBox.bottomLeftX)+" "+T(e.cropBox.bottomLeftY)+" "+T(e.cropBox.topRightX)+" "+T(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&de("/BleedBox ["+T(e.bleedBox.bottomLeftX)+" "+T(e.bleedBox.bottomLeftY)+" "+T(e.bleedBox.topRightX)+" "+T(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&de("/TrimBox ["+T(e.trimBox.bottomLeftX)+" "+T(e.trimBox.bottomLeftY)+" "+T(e.trimBox.topRightX)+" "+T(e.trimBox.topRightY)+"]"),null!==e.artBox&&de("/ArtBox ["+T(e.artBox.bottomLeftX)+" "+T(e.artBox.bottomLeftY)+" "+T(e.artBox.topRightX)+" "+T(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&de("/UserUnit "+e.userUnit),Xe.publish("putPage",{objId:r,pageContext:Ge[t],pageNumber:t,page:n}),de("/Contents "+i+" 0 R"),de(">>"),de("endobj");var l=n.join("\n");return b===w.ADVANCED&&(l+="\nQ"),Je(i,!0),it({data:l,filters:rt(),objectId:i}),de("endobj"),r},st=A.__private__.putPages=function(){var e,t,n=[];for(e=1;e<=Oe;e++)Ge[e].objId=qe(),Ge[e].contentsObjId=qe();for(e=1;e<=Oe;e++)n.push(lt({number:e,data:se[e],objId:Ge[e].objId,contentsObjId:Ge[e].contentsObjId,mediaBox:Ge[e].mediaBox,cropBox:Ge[e].cropBox,bleedBox:Ge[e].bleedBox,trimBox:Ge[e].trimBox,artBox:Ge[e].artBox,userUnit:Ge[e].userUnit,rootDictionaryObjId:$e,resourceDictionaryObjId:et}));Je($e,!0),de("<</Type /Pages");var r="/Kids [";for(t=0;t<Oe;t++)r+=n[t]+" 0 R ";de(r+"]"),de("/Count "+Oe),de(">>"),de("endobj"),Xe.publish("postPutPages")},ot=function(e){Xe.publish("putFont",{font:e,out:de,newObject:Ke,putStream:it}),!0!==e.isAlreadyPutted&&(e.objectNumber=Ke(),de("<<"),de("/Type /Font"),de("/BaseFont /"+R(e.postScriptName)),de("/Subtype /Type1"),"string"==typeof e.encoding&&de("/Encoding /"+e.encoding),de("/FirstChar 32"),de("/LastChar 255"),de(">>"),de("endobj"))},at=function(){for(var e in Me)Me.hasOwnProperty(e)&&(!1===E||!0===E&&C.hasOwnProperty(e))&&ot(Me[e])},ut=function(e){e.objectNumber=Ke();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[T(e.x),T(e.y),T(e.x+e.width),T(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var n=e.pages[1].join("\n");it({data:n,additionalKeyValues:t,objectId:e.objectNumber}),de("endobj")},ht=function(){for(var e in He)He.hasOwnProperty(e)&&ut(He[e])},dt=function(e,t){var n,r=[],i=1/(t-1);for(n=0;n<1;n+=i)r.push(n);if(r.push(1),0!=e[0].offset){var l={offset:0,color:e[0].color};e.unshift(l)}if(1!=e[e.length-1].offset){var s={offset:1,color:e[e.length-1].color};e.push(s)}for(var o="",a=0,u=0;u<r.length;u++){for(n=r[u];n>e[a+1].offset;)a++;var h=e[a].offset,d=(n-h)/(e[a+1].offset-h),c=e[a].color,p=e[a+1].color;o+=ee(Math.round((1-d)*c[0]+d*p[0]).toString(16))+ee(Math.round((1-d)*c[1]+d*p[1]).toString(16))+ee(Math.round((1-d)*c[2]+d*p[2]).toString(16))}return o.trim()},ct=function(e,t){t||(t=21);var n=Ke(),r=dt(e.colors,t),i=[];i.push({key:"FunctionType",value:"0"}),i.push({key:"Domain",value:"[0.0 1.0]"}),i.push({key:"Size",value:"["+t+"]"}),i.push({key:"BitsPerSample",value:"8"}),i.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),i.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),it({data:r,additionalKeyValues:i,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:n}),de("endobj"),e.objectNumber=Ke(),de("<< /ShadingType "+e.type),de("/ColorSpace /DeviceRGB");var l="/Coords ["+T(parseFloat(e.coords[0]))+" "+T(parseFloat(e.coords[1]))+" ";2===e.type?l+=T(parseFloat(e.coords[2]))+" "+T(parseFloat(e.coords[3])):l+=T(parseFloat(e.coords[2]))+" "+T(parseFloat(e.coords[3]))+" "+T(parseFloat(e.coords[4]))+" "+T(parseFloat(e.coords[5])),de(l+="]"),e.matrix&&de("/Matrix ["+e.matrix.toString()+"]"),de("/Function "+n+" 0 R"),de("/Extend [true true]"),de(">>"),de("endobj")},pt=function(e,t){var n=qe(),r=Ke();t.push({resourcesOid:n,objectOid:r}),e.objectNumber=r;var i=[];i.push({key:"Type",value:"/Pattern"}),i.push({key:"PatternType",value:"1"}),i.push({key:"PaintType",value:"1"}),i.push({key:"TilingType",value:"1"}),i.push({key:"BBox",value:"["+e.boundingBox.map(T).join(" ")+"]"}),i.push({key:"XStep",value:T(e.xStep)}),i.push({key:"YStep",value:T(e.yStep)}),i.push({key:"Resources",value:n+" 0 R"}),e.matrix&&i.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),it({data:e.stream,additionalKeyValues:i,objectId:e.objectNumber}),de("endobj")},ft=function(e){var t;for(t in Re)Re.hasOwnProperty(t)&&(Re[t]instanceof k?ct(Re[t]):Re[t]instanceof O&&pt(Re[t],e))},gt=function(e){for(var t in e.objectNumber=Ke(),de("<<"),e)switch(t){case"opacity":de("/ca "+B(e[t]));break;case"stroke-opacity":de("/CA "+B(e[t]))}de(">>"),de("endobj")},mt=function(){var e;for(e in Ne)Ne.hasOwnProperty(e)&&gt(Ne[e])},Et=function(){for(var e in de("/XObject <<"),He)He.hasOwnProperty(e)&&He[e].objectNumber>=0&&de("/"+e+" "+He[e].objectNumber+" 0 R");Xe.publish("putXobjectDict"),de(">>")},Ct=function(){Yt.oid=Ke(),de("<<"),de("/Filter /Standard"),de("/V "+Yt.v),de("/R "+Yt.r),de("/U <"+Yt.toHexString(Yt.U)+">"),de("/O <"+Yt.toHexString(Yt.O)+">"),de("/P "+Yt.P),de(">>"),de("endobj")},At=function(){for(var e in de("/Font <<"),Me)Me.hasOwnProperty(e)&&(!1===E||!0===E&&C.hasOwnProperty(e))&&de("/"+e+" "+Me[e].objectNumber+" 0 R");de(">>")},yt=function(){if(Object.keys(Re).length>0){for(var e in de("/Shading <<"),Re)Re.hasOwnProperty(e)&&Re[e]instanceof k&&Re[e].objectNumber>=0&&de("/"+e+" "+Re[e].objectNumber+" 0 R");Xe.publish("putShadingPatternDict"),de(">>")}},It=function(e){if(Object.keys(Re).length>0){for(var t in de("/Pattern <<"),Re)Re.hasOwnProperty(t)&&Re[t]instanceof A.TilingPattern&&Re[t].objectNumber>=0&&Re[t].objectNumber<e&&de("/"+t+" "+Re[t].objectNumber+" 0 R");Xe.publish("putTilingPatternDict"),de(">>")}},St=function(){if(Object.keys(Ne).length>0){var e;for(e in de("/ExtGState <<"),Ne)Ne.hasOwnProperty(e)&&Ne[e].objectNumber>=0&&de("/"+e+" "+Ne[e].objectNumber+" 0 R");Xe.publish("putGStateDict"),de(">>")}},_t=function(e){Je(e.resourcesOid,!0),de("<<"),de("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),At(),yt(),It(e.objectOid),St(),Et(),de(">>"),de("endobj")},wt=function(){var e=[];at(),mt(),ht(),ft(e),Xe.publish("putResources"),e.forEach(_t),_t({resourcesOid:et,objectOid:Number.MAX_SAFE_INTEGER}),Xe.publish("postPutResources")},bt=function(){Xe.publish("putAdditionalObjects");for(var e=0;e<le.length;e++){var t=le[e];Je(t.objId,!0),de(t.content),de("endobj")}Xe.publish("postPutAdditionalObjects")},xt=function(e){Le[e.fontName]=Le[e.fontName]||{},Le[e.fontName][e.fontStyle]=e.id},Pt=function(e,t,n,r,i){var l={id:"F"+(Object.keys(Me).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:n,encoding:r,isStandardFont:i||!1,metadata:{}};return Xe.publish("addFont",{font:l,instance:this}),Me[l.id]=l,xt(l),l.id},vt=function(e){for(var t=0,n=fe.length;t<n;t++){var r=Pt.call(this,e[t][0],e[t][1],e[t][2],fe[t][3],!0);!1===E&&(C[r]=!0);var i=e[t][0].split("-");xt({id:r,fontName:i[0],fontStyle:i[1]||""})}Xe.publish("addFonts",{fonts:Me,dictionary:Le})},Tt=function(e){return e.foo=function(){try{return e.apply(this,arguments)}catch(e){var t=e.stack||"";~t.indexOf(" at ")&&(t=t.split(" at ")[1]);var n="Error in function "+t.split("\n")[0].split("<")[0]+": "+e.message;if(!s.console)throw new Error(n);s.console.error(n,e),s.alert&&alert(n)}},e.foo.bar=e,e.foo},Mt=function(e,t){var n,r,i,l,s,o,a,u,h;if(i=(t=t||{}).sourceEncoding||"Unicode",s=t.outputEncoding,(t.autoencode||s)&&Me[be].metadata&&Me[be].metadata[i]&&Me[be].metadata[i].encoding&&(l=Me[be].metadata[i].encoding,!s&&Me[be].encoding&&(s=Me[be].encoding),!s&&l.codePages&&(s=l.codePages[0]),"string"==typeof s&&(s=l[s]),s)){for(a=!1,o=[],n=0,r=e.length;n<r;n++)(u=s[e.charCodeAt(n)])?o.push(String.fromCharCode(u)):o.push(e[n]),o[n].charCodeAt(0)>>8&&(a=!0);e=o.join("")}for(n=e.length;void 0===a&&0!==n;)e.charCodeAt(n-1)>>8&&(a=!0),n--;if(!a)return e;for(o=t.noBOM?[]:[254,255],n=0,r=e.length;n<r;n++){if((h=(u=e.charCodeAt(n))>>8)>>8)throw new Error("Character at position "+n+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(h),o.push(u-(h<<8))}return String.fromCharCode.apply(void 0,o)},Lt=A.__private__.pdfEscape=A.pdfEscape=function(e,t){return Mt(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Dt=A.__private__.beginPage=function(e){se[++Oe]=[],Ge[Oe]={objId:0,contentsObjId:0,userUnit:Number(h),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},Nt(Oe),he(se[Z])},Rt=function(e,t){var r,i,s;switch(n=t||n,"string"==typeof e&&(r=_(e.toLowerCase()),Array.isArray(r)&&(i=r[0],s=r[1])),Array.isArray(e)&&(i=e[0]*xe,s=e[1]*xe),isNaN(i)&&(i=l[0],s=l[1]),(i>14400||s>14400)&&(a.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),i=Math.min(14400,i),s=Math.min(14400,s)),l=[i,s],n.substr(0,1)){case"l":s>i&&(l=[s,i]);break;case"p":i>s&&(l=[s,i])}Dt(l),gn(pn),de(_n),0!==Tn&&de(Tn+" J"),0!==Mn&&de(Mn+" j"),Xe.publish("addPage",{pageNumber:Oe})},Ft=function(e){e>0&&e<=Oe&&(se.splice(e,1),Ge.splice(e,1),Oe--,Z>Oe&&(Z=Oe),this.setPage(Z))},Nt=function(e){e>0&&e<=Oe&&(Z=e)},Bt=A.__private__.getNumberOfPages=A.getNumberOfPages=function(){return se.length-1},kt=function(e,t,n){var r,i=void 0;return n=n||{},e=void 0!==e?e:Me[be].fontName,t=void 0!==t?t:Me[be].fontStyle,r=e.toLowerCase(),void 0!==Le[r]&&void 0!==Le[r][t]?i=Le[r][t]:void 0!==Le[e]&&void 0!==Le[e][t]?i=Le[e][t]:!1===n.disableWarning&&a.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),i||n.noFallback||null==(i=Le.times[t])&&(i=Le.times.normal),i},Ot=A.__private__.putInfo=function(){var e=Ke(),t=function(e){return e};for(var n in null!==m&&(t=Yt.encryptor(e,0)),de("<<"),de("/Producer ("+Lt(t("jsPDF "+G.version))+")"),we)we.hasOwnProperty(n)&&we[n]&&de("/"+n.substr(0,1).toUpperCase()+n.substr(1)+" ("+Lt(t(we[n]))+")");de("/CreationDate ("+Lt(t(W))+")"),de(">>"),de("endobj")},Gt=A.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||$e;switch(Ke(),de("<<"),de("/Type /Catalog"),de("/Pages "+t+" 0 R"),me||(me="fullwidth"),me){case"fullwidth":de("/OpenAction [3 0 R /FitH null]");break;case"fullheight":de("/OpenAction [3 0 R /FitV null]");break;case"fullpage":de("/OpenAction [3 0 R /Fit]");break;case"original":de("/OpenAction [3 0 R /XYZ null null 1]");break;default:var n=""+me;"%"===n.substr(n.length-1)&&(me=parseInt(me)/100),"number"==typeof me&&de("/OpenAction [3 0 R /XYZ null null "+B(me)+"]")}switch(Ie||(Ie="continuous"),Ie){case"continuous":de("/PageLayout /OneColumn");break;case"single":de("/PageLayout /SinglePage");break;case"two":case"twoleft":de("/PageLayout /TwoColumnLeft");break;case"tworight":de("/PageLayout /TwoColumnRight")}Ae&&de("/PageMode /"+Ae),Xe.publish("putCatalog"),de(">>"),de("endobj")},Xt=A.__private__.putTrailer=function(){de("trailer"),de("<<"),de("/Size "+(te+1)),de("/Root "+te+" 0 R"),de("/Info "+(te-1)+" 0 R"),null!==m&&de("/Encrypt "+Yt.oid+" 0 R"),de("/ID [ <"+j+"> <"+j+"> ]"),de(">>")},Vt=A.__private__.putHeader=function(){de("%PDF-"+y),de("%ºß¬à")},Ht=A.__private__.putXRef=function(){var e="0000000000";de("xref"),de("0 "+(te+1)),de("0000000000 65535 f ");for(var t=1;t<=te;t++)"function"==typeof ne[t]?de((e+ne[t]()).slice(-10)+" 00000 n "):void 0!==ne[t]?de((e+ne[t]).slice(-10)+" 00000 n "):de("0000000000 00000 n ")},Ut=A.__private__.buildDocument=function(){ue(),he(re),Xe.publish("buildDocument"),Vt(),st(),bt(),wt(),null!==m&&Ct(),Ot(),Gt();var e=ie;return Ht(),Xt(),de("startxref"),de(""+e),de("%%EOF"),he(se[Z]),re.join("\n")},Wt=A.__private__.getBlob=function(e){return new Blob([pe(e)],{type:"application/pdf"})},jt=A.output=A.__private__.output=Tt((function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return Ut();case"save":A.save(t.filename);break;case"arraybuffer":return pe(Ut());case"blob":return Wt(Ut());case"bloburi":case"bloburl":if(void 0!==s.URL&&"function"==typeof s.URL.createObjectURL)return s.URL&&s.URL.createObjectURL(Wt(Ut()))||void 0;a.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var n="",r=Ut();try{n=p(r)}catch(e){n=p(unescape(encodeURIComponent(r)))}return"data:application/pdf;filename="+t.filename+";base64,"+n;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(s)){var i="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",l=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(i=t.pdfObjectUrl,l="");var o='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+i+'"'+l+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",u=s.open();return null!==u&&u.document.write(o),u}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(s)){var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',d=s.open();if(null!==d){d.document.write(h);var c=this;d.document.documentElement.querySelector("#pdfViewer").onload=function(){d.document.title=t.filename,d.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(c.output("bloburl"))}}return d}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(s))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var f='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',g=s.open();if(null!==g&&(g.document.write(f),g.document.title=t.filename),g||"undefined"==typeof safari)return g;break;case"datauri":case"dataurl":return s.document.location.href=this.output("datauristring",t);default:return null}})),zt=function(e){return!0===Array.isArray(Ve)&&Ve.indexOf(e)>-1};switch(r){case"pt":xe=1;break;case"mm":xe=72/25.4;break;case"cm":xe=72/2.54;break;case"in":xe=72;break;case"px":xe=1==zt("px_scaling")?.75:96/72;break;case"pc":case"em":xe=12;break;case"ex":xe=6;break;default:if("number"!=typeof r)throw new Error("Invalid unit: "+r);xe=r}var Yt=null;q(),Y();var Qt=function(e){return null!==m?Yt.encryptor(e,0):function(e){return e}},Kt=A.__private__.getPageInfo=A.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ge[e].objId,pageNumber:e,pageContext:Ge[e]}},qt=A.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in Ge)if(Ge[t].objId===e)break;return Kt(t)},Jt=A.__private__.getCurrentPageInfo=A.getCurrentPageInfo=function(){return{objId:Ge[Z].objId,pageNumber:Z,pageContext:Ge[Z]}};A.addPage=function(){return Rt.apply(this,arguments),this},A.setPage=function(){return Nt.apply(this,arguments),he.call(this,se[Z]),this},A.insertPage=function(e){return this.addPage(),this.movePage(Z,e),this},A.movePage=function(e,t){var n,r;if(e>t){n=se[e],r=Ge[e];for(var i=e;i>t;i--)se[i]=se[i-1],Ge[i]=Ge[i-1];se[t]=n,Ge[t]=r,this.setPage(t)}else if(e<t){n=se[e],r=Ge[e];for(var l=e;l<t;l++)se[l]=se[l+1],Ge[l]=Ge[l+1];se[t]=n,Ge[t]=r,this.setPage(t)}return this},A.deletePage=function(){return Ft.apply(this,arguments),this},A.__private__.text=A.text=function(e,t,n,r,l){var s,o,a,u,h,d,c,p,f,g=(r=r||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof n||Array.isArray(n))){var m=n;n=t,t=e,e=m}if(arguments[3]instanceof je==0?(a=arguments[4],u=arguments[5],"object"===i()(c=arguments[3])&&null!==c||("string"==typeof a&&(u=a,a=null),"string"==typeof c&&(u=c,c=null),"number"==typeof c&&(a=c,c=null),r={flags:c,angle:a,align:u})):(M("The transform parameter of text() with a Matrix value"),f=l),isNaN(t)||isNaN(n)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return g;var E="",A=!1,y="number"==typeof r.lineHeightFactor?r.lineHeightFactor:cn,I=g.internal.scaleFactor;function S(e){return e=e.split("\t").join(Array(r.TabLen||9).join(" ")),Lt(e,c)}function _(e){for(var t,n=e.concat(),r=[],i=n.length;i--;)"string"==typeof(t=n.shift())?r.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?r.push(t[0]):r.push([t[0],t[1],t[2]]);return r}function x(e,t){var n;if("string"==typeof e)n=t(e)[0];else if(Array.isArray(e)){for(var r,i,l=e.concat(),s=[],o=l.length;o--;)"string"==typeof(r=l.shift())?s.push(t(r)[0]):Array.isArray(r)&&"string"==typeof r[0]&&(i=t(r[0],r[1],r[2]),s.push([i[0],i[1],i[2]]));n=s}return n}var P=!1,v=!0;if("string"==typeof e)P=!0;else if(Array.isArray(e)){var L=e.concat();o=[];for(var D,R=L.length;R--;)("string"!=typeof(D=L.shift())||Array.isArray(D)&&"string"!=typeof D[0])&&(v=!1);P=v}if(!1===P)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var F=ge/g.internal.scaleFactor,N=F*(y-1);switch(r.baseline){case"bottom":n-=N;break;case"top":n+=F-N;break;case"hanging":n+=F-2*N;break;case"middle":n+=F/2-N}if((d=r.maxWidth||0)>0&&("string"==typeof e?e=g.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce((function(e,t){return e.concat(g.splitTextToSize(t,d))}),[]))),s={text:e,x:t,y:n,options:r,mutex:{pdfEscape:Lt,activeFontKey:be,fonts:Me,activeFontSize:ge}},Xe.publish("preProcessText",s),e=s.text,a=(r=s.options).angle,f instanceof je==0&&a&&"number"==typeof a){a*=Math.PI/180,0===r.rotationDirection&&(a=-a),b===w.ADVANCED&&(a=-a);var B=Math.cos(a),k=Math.sin(a);f=new je(B,k,-k,B,0,0)}else a&&a instanceof je&&(f=a);b!==w.ADVANCED||f||(f=Ye),void 0!==(h=r.charSpace||Pn)&&(E+=T(V(h))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(p=r.horizontalScale)&&(E+=T(100*p)+" Tz\n"),r.lang;var O=-1,G=void 0!==r.renderingMode?r.renderingMode:r.stroke,X=g.internal.getCurrentPageInfo().pageContext;switch(G){case 0:case!1:case"fill":O=0;break;case 1:case!0:case"stroke":O=1;break;case 2:case"fillThenStroke":O=2;break;case 3:case"invisible":O=3;break;case 4:case"fillAndAddForClipping":O=4;break;case 5:case"strokeAndAddPathForClipping":O=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":O=6;break;case 7:case"addToPathForClipping":O=7}var H=void 0!==X.usedRenderingMode?X.usedRenderingMode:-1;-1!==O?E+=O+" Tr\n":-1!==H&&(E+="0 Tr\n"),-1!==O&&(X.usedRenderingMode=O),u=r.align||"left";var U,W=ge*y,j=g.internal.pageSize.getWidth(),z=Me[be];h=r.charSpace||Pn,d=r.maxWidth||0,c=Object.assign({autoencode:!0,noBOM:!0},r.flags);var Y=[];if("[object Array]"===Object.prototype.toString.call(e)){var Q;o=_(e),"left"!==u&&(U=o.map((function(e){return g.getStringUnitWidth(e,{font:z,charSpace:h,fontSize:ge,doKerning:!1})*ge/I})));var K,q=0;if("right"===u){t-=U[0],e=[],R=o.length;for(var J=0;J<R;J++)0===J?(K=An(t),Q=yn(n)):(K=V(q-U[J]),Q=-W),e.push([o[J],K,Q]),q=U[J]}else if("center"===u){t-=U[0]/2,e=[],R=o.length;for(var Z=0;Z<R;Z++)0===Z?(K=An(t),Q=yn(n)):(K=V((q-U[Z])/2),Q=-W),e.push([o[Z],K,Q]),q=U[Z]}else if("left"===u){e=[],R=o.length;for(var $=0;$<R;$++)e.push(o[$])}else{if("justify"!==u)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');e=[],R=o.length,d=0!==d?d:j;for(var ee=0;ee<R;ee++)Q=0===ee?yn(n):-W,K=0===ee?An(t):0,ee<R-1?Y.push(T(V((d-U[ee])/(o[ee].split(" ").length-1)))):Y.push(0),e.push([o[ee],K,Q])}}var te="boolean"==typeof r.R2L?r.R2L:Ce;!0===te&&(e=x(e,(function(e,t,n){return[e.split("").reverse().join(""),t,n]}))),s={text:e,x:t,y:n,options:r,mutex:{pdfEscape:Lt,activeFontKey:be,fonts:Me,activeFontSize:ge}},Xe.publish("postProcessText",s),e=s.text,A=s.mutex.isHex||!1;var ne=Me[be].encoding;"WinAnsiEncoding"!==ne&&"StandardEncoding"!==ne||(e=x(e,(function(e,t,n){return[S(e),t,n]}))),o=_(e),e=[];for(var re,ie,le,se=0,oe=1,ae=Array.isArray(o[0])?oe:se,ue="",he=function(e,t,n){var i="";return n instanceof je?(n="number"==typeof r.angle?ze(n,new je(1,0,0,1,e,t)):ze(new je(1,0,0,1,e,t),n),b===w.ADVANCED&&(n=ze(new je(1,0,0,-1,0,0),n)),i=n.join(" ")+" Tm\n"):i=T(e)+" "+T(t)+" Td\n",i},ce=0;ce<o.length;ce++){switch(ue="",ae){case oe:le=(A?"<":"(")+o[ce][0]+(A?">":")"),re=parseFloat(o[ce][1]),ie=parseFloat(o[ce][2]);break;case se:le=(A?"<":"(")+o[ce]+(A?">":")"),re=An(t),ie=yn(n)}void 0!==Y&&void 0!==Y[ce]&&(ue=Y[ce]+" Tw\n"),0===ce?e.push(ue+he(re,ie,f)+le):ae===se?e.push(ue+le):ae===oe&&e.push(ue+he(re,ie,f)+le)}e=ae===se?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var pe="BT\n/";return pe+=be+" "+ge+" Tf\n",pe+=T(ge*y)+" TL\n",pe+=bn+"\n",pe+=E,pe+=e,de(pe+="ET"),C[be]=!0,g};var Zt=A.__private__.clip=A.clip=function(e){return de("evenodd"===e?"W*":"W"),this};A.clipEvenOdd=function(){return Zt("evenodd")},A.__private__.discardPath=A.discardPath=function(){return de("n"),this};var $t=A.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};A.__private__.setDefaultPathOperation=A.setDefaultPathOperation=function(e){return $t(e)&&(c=e),this};var en=A.__private__.getStyle=A.getStyle=function(e){var t=c;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},tn=A.close=function(){return de("h"),this};A.stroke=function(){return de("S"),this},A.fill=function(e){return nn("f",e),this},A.fillEvenOdd=function(e){return nn("f*",e),this},A.fillStroke=function(e){return nn("B",e),this},A.fillStrokeEvenOdd=function(e){return nn("B*",e),this};var nn=function(e,t){"object"===i()(t)?sn(t,e):de(e)},rn=function(e){null===e||b===w.ADVANCED&&void 0===e||(e=en(e),de(e))};function ln(e,t,n,r,i){var l=new O(t||this.boundingBox,n||this.xStep,r||this.yStep,this.gState,i||this.matrix);l.stream=this.stream;var s=e+"$$"+this.cloneIndex+++"$$";return Qe(s,l),l}var sn=function(e,t){var n=Fe[e.key],r=Re[n];if(r instanceof k)de("q"),de(on(t)),r.gState&&A.setGState(r.gState),de(e.matrix.toString()+" cm"),de("/"+n+" sh"),de("Q");else if(r instanceof O){var i=new je(1,0,0,-1,0,Xn());e.matrix&&(i=i.multiply(e.matrix||Ye),n=ln.call(r,e.key,e.boundingBox,e.xStep,e.yStep,i).id),de("q"),de("/Pattern cs"),de("/"+n+" scn"),r.gState&&A.setGState(r.gState),de(t),de("Q")}},on=function(e){switch(e){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},an=A.moveTo=function(e,t){return de(T(V(e))+" "+T(U(t))+" m"),this},un=A.lineTo=function(e,t){return de(T(V(e))+" "+T(U(t))+" l"),this},hn=A.curveTo=function(e,t,n,r,i,l){return de([T(V(e)),T(U(t)),T(V(n)),T(U(r)),T(V(i)),T(U(l)),"c"].join(" ")),this};A.__private__.line=A.line=function(e,t,n,r,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!$t(i))throw new Error("Invalid arguments passed to jsPDF.line");return b===w.COMPAT?this.lines([[n-e,r-t]],e,t,[1,1],i||"S"):this.lines([[n-e,r-t]],e,t,[1,1]).stroke()},A.__private__.lines=A.lines=function(e,t,n,r,i,l){var s,o,a,u,h,d,c,p,f,g,m,E;if("number"==typeof e&&(E=n,n=t,t=e,e=E),r=r||[1,1],l=l||!1,isNaN(t)||isNaN(n)||!Array.isArray(e)||!Array.isArray(r)||!$t(i)||"boolean"!=typeof l)throw new Error("Invalid arguments passed to jsPDF.lines");for(an(t,n),s=r[0],o=r[1],u=e.length,g=t,m=n,a=0;a<u;a++)2===(h=e[a]).length?(g=h[0]*s+g,m=h[1]*o+m,un(g,m)):(d=h[0]*s+g,c=h[1]*o+m,p=h[2]*s+g,f=h[3]*o+m,g=h[4]*s+g,m=h[5]*o+m,hn(d,c,p,f,g,m));return l&&tn(),rn(i),this},A.path=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n.c;switch(n.op){case"m":an(r[0],r[1]);break;case"l":un(r[0],r[1]);break;case"c":hn.apply(this,r);break;case"h":tn()}}return this},A.__private__.rect=A.rect=function(e,t,n,r,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!$t(i))throw new Error("Invalid arguments passed to jsPDF.rect");return b===w.COMPAT&&(r=-r),de([T(V(e)),T(U(t)),T(V(n)),T(V(r)),"re"].join(" ")),rn(i),this},A.__private__.triangle=A.triangle=function(e,t,n,r,i,l,s){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(l)||!$t(s))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[n-e,r-t],[i-n,l-r],[e-i,t-l]],e,t,[1,1],s,!0),this},A.__private__.roundedRect=A.roundedRect=function(e,t,n,r,i,l,s){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(l)||!$t(s))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return i=Math.min(i,.5*n),l=Math.min(l,.5*r),this.lines([[n-2*i,0],[i*o,0,i,l-l*o,i,l],[0,r-2*l],[0,l*o,-i*o,l,-i,l],[2*i-n,0],[-i*o,0,-i,-l*o,-i,-l],[0,2*l-r],[0,-l*o,i*o,-l,i,-l]],e+i,t,[1,1],s,!0),this},A.__private__.ellipse=A.ellipse=function(e,t,n,r,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!$t(i))throw new Error("Invalid arguments passed to jsPDF.ellipse");var l=4/3*(Math.SQRT2-1)*n,s=4/3*(Math.SQRT2-1)*r;return an(e+n,t),hn(e+n,t-s,e+l,t-r,e,t-r),hn(e-l,t-r,e-n,t-s,e-n,t),hn(e-n,t+s,e-l,t+r,e,t+r),hn(e+l,t+r,e+n,t+s,e+n,t),rn(i),this},A.__private__.circle=A.circle=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||!$t(r))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,n,n,r)},A.setFont=function(e,t,n){return n&&(t=v(t,n)),be=kt(e,t,{disableWarning:!1}),this};var dn=A.__private__.getFont=A.getFont=function(){return Me[kt.apply(A,arguments)]};A.__private__.getFontList=A.getFontList=function(){var e,t,n={};for(e in Le)if(Le.hasOwnProperty(e))for(t in n[e]=[],Le[e])Le[e].hasOwnProperty(t)&&n[e].push(t);return n},A.addFont=function(e,t,n,r,i){var l=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==l.indexOf(arguments[3])?i=arguments[3]:arguments[3]&&-1==l.indexOf(arguments[3])&&(n=v(n,r)),i=i||"Identity-H",Pt.call(this,e,t,n,i)};var cn,pn=e.lineWidth||.200025,fn=A.__private__.getLineWidth=A.getLineWidth=function(){return pn},gn=A.__private__.setLineWidth=A.setLineWidth=function(e){return pn=e,de(T(V(e))+" w"),this};A.__private__.setLineDash=G.API.setLineDash=G.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map((function(e){return T(V(e))})).join(" "),t=T(V(t)),de("["+e+"] "+t+" d"),this};var mn=A.__private__.getLineHeight=A.getLineHeight=function(){return ge*cn};A.__private__.getLineHeight=A.getLineHeight=function(){return ge*cn};var En=A.__private__.setLineHeightFactor=A.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(cn=e),this},Cn=A.__private__.getLineHeightFactor=A.getLineHeightFactor=function(){return cn};En(e.lineHeight);var An=A.__private__.getHorizontalCoordinate=function(e){return V(e)},yn=A.__private__.getVerticalCoordinate=function(e){return b===w.ADVANCED?e:Ge[Z].mediaBox.topRightY-Ge[Z].mediaBox.bottomLeftY-V(e)},In=A.__private__.getHorizontalCoordinateString=A.getHorizontalCoordinateString=function(e){return T(An(e))},Sn=A.__private__.getVerticalCoordinateString=A.getVerticalCoordinateString=function(e){return T(yn(e))},_n=e.strokeColor||"0 G";A.__private__.getStrokeColor=A.getDrawColor=function(){return tt(_n)},A.__private__.setStrokeColor=A.setDrawColor=function(e,t,n,r){return _n=nt({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"draw",precision:2}),de(_n),this};var wn=e.fillColor||"0 g";A.__private__.getFillColor=A.getFillColor=function(){return tt(wn)},A.__private__.setFillColor=A.setFillColor=function(e,t,n,r){return wn=nt({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"fill",precision:2}),de(wn),this};var bn=e.textColor||"0 g",xn=A.__private__.getTextColor=A.getTextColor=function(){return tt(bn)};A.__private__.setTextColor=A.setTextColor=function(e,t,n,r){return bn=nt({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"text",precision:3}),this};var Pn=e.charSpace,vn=A.__private__.getCharSpace=A.getCharSpace=function(){return parseFloat(Pn||0)};A.__private__.setCharSpace=A.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Pn=e,this};var Tn=0;A.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},A.__private__.setLineCap=A.setLineCap=function(e){var t=A.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tn=t,de(t+" J"),this};var Mn=0;A.__private__.setLineJoin=A.setLineJoin=function(e){var t=A.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Mn=t,de(t+" j"),this},A.__private__.setLineMiterLimit=A.__private__.setMiterLimit=A.setLineMiterLimit=A.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return de(T(V(e))+" M"),this},A.GState=N,A.setGState=function(e){(e="string"==typeof e?Ne[Be[e]]:Ln(null,e)).equals(ke)||(de("/"+e.id+" gs"),ke=e)};var Ln=function(e,t){if(!e||!Be[e]){var n=!1;for(var r in Ne)if(Ne.hasOwnProperty(r)&&Ne[r].equals(t)){n=!0;break}if(n)t=Ne[r];else{var i="GS"+(Object.keys(Ne).length+1).toString(10);Ne[i]=t,t.id=i}return e&&(Be[e]=t.id),Xe.publish("addGState",t),t}};A.addGState=function(e,t){return Ln(e,t),this},A.saveGraphicsState=function(){return de("q"),De.push({key:be,size:ge,color:bn}),this},A.restoreGraphicsState=function(){de("Q");var e=De.pop();return be=e.key,ge=e.size,bn=e.color,ke=null,this},A.setCurrentTransformationMatrix=function(e){return de(e.toString()+" cm"),this},A.comment=function(e){return de("#"+e),this};var Dn=function(e,t){var n=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var r=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var i="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return i},set:function(e){i=e.toString()}}),this},Rn=function(e,t,n,r){Dn.call(this,e,t),this.type="rect";var i=n||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return i},set:function(e){isNaN(e)||(i=parseFloat(e))}});var l=r||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return l},set:function(e){isNaN(e)||(l=parseFloat(e))}}),this},Fn=function(){this.page=Oe,this.currentPage=Z,this.pages=se.slice(0),this.pagesContext=Ge.slice(0),this.x=Pe,this.y=ve,this.matrix=Te,this.width=On(Z),this.height=Xn(Z),this.outputDestination=ae,this.id="",this.objectNumber=-1};Fn.prototype.restore=function(){Oe=this.page,Z=this.currentPage,Ge=this.pagesContext,se=this.pages,Pe=this.x,ve=this.y,Te=this.matrix,Gn(Z,this.width),Vn(Z,this.height),ae=this.outputDestination};var Nn=function(e,t,n,r,i){We.push(new Fn),Oe=Z=0,se=[],Pe=e,ve=t,Te=i,Dt([n,r])},Bn=function(e){if(Ue[e])We.pop().restore();else{var t=new Fn,n="Xo"+(Object.keys(He).length+1).toString(10);t.id=n,Ue[e]=n,He[n]=t,Xe.publish("addFormObject",t),We.pop().restore()}};for(var kn in A.beginFormObject=function(e,t,n,r,i){return Nn(e,t,n,r,i),this},A.endFormObject=function(e){return Bn(e),this},A.doFormObject=function(e,t){var n=He[Ue[e]];return de("q"),de(t.toString()+" cm"),de("/"+n.id+" Do"),de("Q"),this},A.getFormObject=function(e){var t=He[Ue[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},A.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(f(Wt(Ut()),e),"function"==typeof f.unload&&s.setTimeout&&setTimeout(f.unload,911),this):new Promise((function(t,n){try{var r=f(Wt(Ut()),e);"function"==typeof f.unload&&s.setTimeout&&setTimeout(f.unload,911),t(r)}catch(e){n(e.message)}}))},G.API)G.API.hasOwnProperty(kn)&&("events"===kn&&G.API.events.length?function(e,t){var n,r,i;for(i=t.length-1;-1!==i;i--)n=t[i][0],r=t[i][1],e.subscribe.apply(e,[n].concat("function"==typeof r?[r]:r))}(Xe,G.API.events):A[kn]=G.API[kn]);var On=A.getPageWidth=function(e){return(Ge[e=e||Z].mediaBox.topRightX-Ge[e].mediaBox.bottomLeftX)/xe},Gn=A.setPageWidth=function(e,t){Ge[e].mediaBox.topRightX=t*xe+Ge[e].mediaBox.bottomLeftX},Xn=A.getPageHeight=function(e){return(Ge[e=e||Z].mediaBox.topRightY-Ge[e].mediaBox.bottomLeftY)/xe},Vn=A.setPageHeight=function(e,t){Ge[e].mediaBox.topRightY=t*xe+Ge[e].mediaBox.bottomLeftY};return A.internal={pdfEscape:Lt,getStyle:en,getFont:dn,getFontSize:Ee,getCharSpace:vn,getTextColor:xn,getLineHeight:mn,getLineHeightFactor:Cn,getLineWidth:fn,write:ce,getHorizontalCoordinate:An,getVerticalCoordinate:yn,getCoordinateString:In,getVerticalCoordinateString:Sn,collections:{},newObject:Ke,newAdditionalObject:Ze,newObjectDeferred:qe,newObjectDeferredBegin:Je,getFilters:rt,putStream:it,events:Xe,scaleFactor:xe,pageSize:{getWidth:function(){return On(Z)},setWidth:function(e){Gn(Z,e)},getHeight:function(){return Xn(Z)},setHeight:function(e){Vn(Z,e)}},encryptionOptions:m,encryption:Yt,getEncryptor:Qt,output:jt,getNumberOfPages:Bt,pages:se,out:de,f2:B,f3:X,getPageInfo:Kt,getPageInfoByObjId:qt,getCurrentPageInfo:Jt,getPDFVersion:I,Point:Dn,Rectangle:Rn,Matrix:je,hasHotfix:zt},Object.defineProperty(A.internal.pageSize,"width",{get:function(){return On(Z)},set:function(e){Gn(Z,e)},enumerable:!0,configurable:!0}),Object.defineProperty(A.internal.pageSize,"height",{get:function(){return Xn(Z)},set:function(e){Vn(Z,e)},enumerable:!0,configurable:!0}),vt.call(A,fe),be="F1",Rt(l,n),Xe.publish("initialized"),A}D.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},D.prototype.toHexString=function(e){return e.split("").map((function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)})).join("")},D.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},D.prototype.processOwnerPassword=function(e,t){return M(P(t).substr(0,5),e)},D.prototype.encryptor=function(e,t){var n=P(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return M(n,e)}},N.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||i()(e)!==i()(this))return!1;var r=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&r--;return 0===r},G.API={events:[]},G.version="2.5.1";var X=G.API,V=1,H=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},U=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},W=function(e){return e.toFixed(2)},j=function(e){return e.toFixed(5)};X.__acroform__={};var z=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Y=function(e){return e*V},Q=function(e){var t=new de,n=be.internal.getHeight(e)||0,r=be.internal.getWidth(e)||0;return t.BBox=[0,0,Number(W(r)),Number(W(n))],t},K=X.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},q=X.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},J=X.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(e&1<<t)?0:1},Z=X.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return J(e,t-1)},$=X.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return K(e,t-1)},ee=X.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return q(e,t-1)},te=X.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,i=e[0],l=e[1],s=e[2],o=e[3],a={};return a.lowerLeft_X=n(i)||0,a.lowerLeft_Y=r(l+o)||0,a.upperRight_X=n(i+s)||0,a.upperRight_Y=r(l)||0,[Number(W(a.lowerLeft_X)),Number(W(a.lowerLeft_Y)),Number(W(a.upperRight_X)),Number(W(a.upperRight_Y))]},ne=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=re(e,n),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+W(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var l=Q(e);return l.scope=e.scope,l.stream=t.join("\n"),l}},re=function(e,t){var n=0===e.fontSize?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},i=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map((function(e){return e.split("\n")})):i.map((function(e){return[e]}));var l=n,s=be.internal.getHeight(e)||0;s=s<0?-s:s;var o=be.internal.getWidth(e)||0;o=o<0?-o:o;var a=function(t,n,r){if(t+1<i.length){var l=n+" "+i[t+1][0];return ie(l,e,r).width<=o-4}return!1};l++;e:for(;l>0;){t="",l--;var u,h,d=ie("3",e,l).height,c=e.multiline?s-l:(s-d)/2,p=c+=2,f=0,g=0,m=0;if(l<=0){t="(...) Tj\n",t+="% Width of Text: "+ie(t,e,l=12).width+", FieldWidth:"+o+"\n";break}for(var E="",C=0,A=0;A<i.length;A++)if(i.hasOwnProperty(A)){var y=!1;if(1!==i[A].length&&m!==i[A].length-1){if((d+2)*(C+2)+2>s)continue e;E+=i[A][m],y=!0,g=A,A--}else{E=" "==(E+=i[A][m]+" ").substr(E.length-1)?E.substr(0,E.length-1):E;var I=parseInt(A),S=a(I,E,l),_=A>=i.length-1;if(S&&!_){E+=" ",m=0;continue}if(S||_){if(_)g=I;else if(e.multiline&&(d+2)*(C+2)+2>s)continue e}else{if(!e.multiline)continue e;if((d+2)*(C+2)+2>s)continue e;g=I}}for(var w="",b=f;b<=g;b++){var x=i[b];if(e.multiline){if(b===g){w+=x[m]+" ",m=(m+1)%x.length;continue}if(b===f){w+=x[x.length-1]+" ";continue}}w+=x[0]+" "}switch(w=" "==w.substr(w.length-1)?w.substr(0,w.length-1):w,h=ie(w,e,l).width,e.textAlign){case"right":u=o-h-2;break;case"center":u=(o-h)/2;break;case"left":default:u=2}t+=W(u)+" "+W(p)+" Td\n",t+="("+H(w)+") Tj\n",t+=-W(u)+" 0 Td\n",p=-(l+2),h=0,f=y?g:g+1,C++,E=""}break}return r.text=t,r.fontSize=l,r},ie=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},le={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},se=function(e,t){var n={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find((function(e){return e.type===n.type&&e.object===n.object}))&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},oe=function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(pe.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(le)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");V=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new ce,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",(function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})),e.internal.events.subscribe("buildDocument",(function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];r.objId=void 0,r.hasAnnotation&&se(r,e)}}(e)})),e.internal.events.subscribe("putCatalog",(function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)})),e.internal.events.subscribe("postPutPages",(function(t){!function(e,t){var n=!e;for(var r in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(r)){var l=e[r],s=[],o=l.Rect;if(l.Rect&&(l.Rect=te(l.Rect,t)),t.internal.newObjectDeferredBegin(l.objId,!0),l.DA=be.createDefaultAppearanceStream(l),"object"===i()(l)&&"function"==typeof l.getKeyValueListForStream&&(s=l.getKeyValueListForStream()),l.Rect=o,l.hasAppearanceStream&&!l.appearanceStreamContent){var a=ne(l);s.push({key:"AP",value:"<</N "+a+">>"}),t.internal.acroformPlugin.xForms.push(a)}if(l.appearanceStreamContent){var u="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var d=l.appearanceStreamContent[h];if(u+="/"+h+" ",u+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var r in d)if(d.hasOwnProperty(r)){var c=d[r];"function"==typeof c&&(c=c.call(t,l)),u+="/"+r+" "+c+" ",t.internal.acroformPlugin.xForms.indexOf(c)>=0||t.internal.acroformPlugin.xForms.push(c)}}else"function"==typeof(c=d)&&(c=c.call(t,l)),u+="/"+r+" "+c,t.internal.acroformPlugin.xForms.indexOf(c)>=0||t.internal.acroformPlugin.xForms.push(c);u+=">>"}s.push({key:"AP",value:"<<\n"+u+">>"})}t.internal.putStream({additionalKeyValues:s,objectId:l.objId}),t.internal.out("endobj")}n&&function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var r=n,l=e[n];t.internal.newObjectDeferredBegin(l.objId,!0),"object"===i()(l)&&"function"==typeof l.putStream&&l.putStream(),delete e[r]}}(t.internal.acroformPlugin.xForms,t)}(t,e)})),e.internal.acroformPlugin.isInitialized=!0}},ae=X.__acroform__.arrayToPdfArray=function(e,t,n){var r=function(e){return e};if(Array.isArray(e)){for(var l="[",s=0;s<e.length;s++)switch(0!==s&&(l+=" "),i()(e[s])){case"boolean":case"number":case"object":l+=e[s].toString();break;case"string":"/"!==e[s].substr(0,1)?(void 0!==t&&n&&(r=n.internal.getEncryptor(t)),l+="("+H(r(e[s].toString()))+")"):l+=e[s].toString()}return l+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ue=function(e,t,n){var r=function(e){return e};return void 0!==t&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),"("+H(r(e))+")"},he=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};he.prototype.toString=function(){return this.objId+" 0 R"},he.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},he.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter((function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)}));for(var n in t)if(!1===Object.getOwnPropertyDescriptor(this,t[n]).configurable){var r=t[n],i=this[r];i&&(Array.isArray(i)?e.push({key:r,value:ae(i,this.objId,this.scope)}):i instanceof he?(i.scope=this.scope,e.push({key:r,value:i.objId+" 0 R"})):"function"!=typeof i&&e.push({key:r,value:i}))}return e};var de=function(){he.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};z(de,he);var ce=function(){he.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+H(t(e))+")"}},set:function(t){e=t}})};z(ce,he);var pe=function e(){he.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(t,3))},set:function(e){!0===Boolean(e)?this.F=$(t,3):this.F=ee(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');n=e}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==r.length)return r},set:function(e){r=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(e){r[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(e){r[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(e){r[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(e){r[3]=e}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var l=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!l||l.length<1){if(this instanceof Ie)return;l="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+H(t(l))+")"},set:function(e){l=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return l},set:function(e){l=e}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(e){s=e}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var a=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return a},set:function(e){a=e}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===u?50/V:u},set:function(e){u=e}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(e){h=e}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof Ie||this instanceof _e))return ue(d,this.objId,this.scope)},set:function(e){e=e.toString(),d=e}});var c=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(c)return this instanceof Ce==0?ue(c,this.objId,this.scope):c},set:function(e){e=e.toString(),c=this instanceof Ce==0?"("===e.substr(0,1)?U(e.substr(1,e.length-2)):U(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ce==1?U(c.substr(1,c.length-1)):c},set:function(e){e=e.toString(),c=this instanceof Ce==1?"/"+e:e}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Ce==0?ue(p,this.objId,this.scope):p},set:function(e){e=e.toString(),p=this instanceof Ce==0?"("===e.substr(0,1)?U(e.substr(1,e.length-2)):U(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ce==1?U(p.substr(1,p.length-1)):p},set:function(e){e=e.toString(),p=this instanceof Ce==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var f,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(e){e=Boolean(e),g=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(f)return f},set:function(e){f=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,1):this.Ff=ee(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,2):this.Ff=ee(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,3):this.Ff=ee(this.Ff,3)}});var m=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==m)return m},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');m=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(m){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:m=2;break;case"center":case 1:m=1;break;case"left":case 0:default:m=0}}})};z(pe,he);var fe=function(){pe.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ae(t,this.objId,this.scope)},set:function(e){var n,r;r=[],"string"==typeof(n=e)&&(r=function(e,t,n){n||(n=1);for(var r,i=[];r=t.exec(e);)i.push(r[n]);return i}(n,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==n););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,18):this.Ff=ee(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=$(this.Ff,19):this.Ff=ee(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=$(this.Ff,20),t.sort()):this.Ff=ee(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,22):this.Ff=ee(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,23):this.Ff=ee(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,27):this.Ff=ee(this.Ff,27)}}),this.hasAppearanceStream=!1};z(fe,pe);var ge=function(){fe.call(this),this.fontName="helvetica",this.combo=!1};z(ge,fe);var me=function(){ge.call(this),this.combo=!0};z(me,ge);var Ee=function(){me.call(this),this.edit=!0};z(Ee,me);var Ce=function(){pe.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,15):this.Ff=ee(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,16):this.Ff=ee(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,17):this.Ff=ee(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,26):this.Ff=ee(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var n,r=[];for(n in r.push("<<"),t)r.push("/"+n+" ("+H(e(t[n]))+")");return r.push(">>"),r.join("\n")}},set:function(e){"object"===i()(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};z(Ce,pe);var Ae=function(){Ce.call(this),this.pushButton=!0};z(Ae,Ce);var ye=function(){Ce.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};z(ye,Ce);var Ie=function(){var e,t;pe.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,n=[];for(t in n.push("<<"),r)n.push("/"+t+" ("+H(e(r[t]))+")");return n.push(">>"),n.join("\n")},set:function(e){"object"===i()(e)&&(r=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(e){"string"==typeof e&&(r.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(e){n="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=be.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};z(Ie,pe),ye.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},ye.prototype.createOption=function(e){var t=new Ie;return t.Parent=this,t.optionName=e,this.Kids.push(t),xe.call(this.scope,t),t};var Se=function(){Ce.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=be.CheckBox.createAppearanceStream()};z(Se,Ce);var _e=function(){pe.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,13):this.Ff=ee(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,21):this.Ff=ee(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,23):this.Ff=ee(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,24):this.Ff=ee(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,25):this.Ff=ee(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,26):this.Ff=ee(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};z(_e,pe);var we=function(){_e.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(Z(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=$(this.Ff,14):this.Ff=ee(this.Ff,14)}}),this.password=!0};z(we,_e);var be={CheckBox:{createAppearanceStream:function(){return{N:{On:be.CheckBox.YesNormal},D:{On:be.CheckBox.YesPushDown,Off:be.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Q(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),l=re(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+W(be.internal.getWidth(e))+" "+W(be.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+W(l.fontSize)+" Tf "+i),n.push("BT"),n.push(l.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join("\n"),t},YesNormal:function(e){var t=Q(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=[],l=be.internal.getHeight(e),s=be.internal.getWidth(e),o=re(e,e.caption);return i.push("1 g"),i.push("0 0 "+W(s)+" "+W(l)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+W(s-1)+" "+W(l-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+W(o.fontSize)+" Tf "+r),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join("\n"),t},OffPushDown:function(e){var t=Q(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+W(be.internal.getWidth(e))+" "+W(be.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:be.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=be.RadioButton.Circle.YesNormal,t.D[e]=be.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Q(e);t.scope=e.scope;var n=[],r=be.internal.getWidth(e)<=be.internal.getHeight(e)?be.internal.getWidth(e)/4:be.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=be.internal.Bezier_C,l=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+j(be.internal.getWidth(e)/2)+" "+j(be.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+l+" "+l+" "+r+" 0 "+r+" c"),n.push("-"+l+" "+r+" -"+r+" "+l+" -"+r+" 0 c"),n.push("-"+r+" -"+l+" -"+l+" -"+r+" 0 -"+r+" c"),n.push(l+" -"+r+" "+r+" -"+l+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=Q(e);t.scope=e.scope;var n=[],r=be.internal.getWidth(e)<=be.internal.getHeight(e)?be.internal.getWidth(e)/4:be.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),l=Number((i*be.internal.Bezier_C).toFixed(5)),s=Number((r*be.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+j(be.internal.getWidth(e)/2)+" "+j(be.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),n.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),n.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),n.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+j(be.internal.getWidth(e)/2)+" "+j(be.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=Q(e);t.scope=e.scope;var n=[],r=be.internal.getWidth(e)<=be.internal.getHeight(e)?be.internal.getWidth(e)/4:be.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),l=Number((i*be.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+j(be.internal.getWidth(e)/2)+" "+j(be.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),n.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),n.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),n.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:be.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=be.RadioButton.Cross.YesNormal,t.D[e]=be.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Q(e);t.scope=e.scope;var n=[],r=be.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+W(be.internal.getWidth(e)-2)+" "+W(be.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(W(r.x1.x)+" "+W(r.x1.y)+" m"),n.push(W(r.x2.x)+" "+W(r.x2.y)+" l"),n.push(W(r.x4.x)+" "+W(r.x4.y)+" m"),n.push(W(r.x3.x)+" "+W(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=Q(e);t.scope=e.scope;var n=be.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+W(be.internal.getWidth(e))+" "+W(be.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+W(be.internal.getWidth(e)-2)+" "+W(be.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(W(n.x1.x)+" "+W(n.x1.y)+" m"),r.push(W(n.x2.x)+" "+W(n.x2.y)+" l"),r.push(W(n.x4.x)+" "+W(n.x4.y)+" m"),r.push(W(n.x3.x)+" "+W(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=Q(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+W(be.internal.getWidth(e))+" "+W(be.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};be.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=be.internal.getWidth(e),n=be.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},be.internal.getWidth=function(e){var t=0;return"object"===i()(e)&&(t=Y(e.Rect[2])),t},be.internal.getHeight=function(e){var t=0;return"object"===i()(e)&&(t=Y(e.Rect[3])),t};var xe=X.addField=function(e){if(oe(this,e),!(e instanceof pe))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};X.AcroFormChoiceField=fe,X.AcroFormListBox=ge,X.AcroFormComboBox=me,X.AcroFormEditBox=Ee,X.AcroFormButton=Ce,X.AcroFormPushButton=Ae,X.AcroFormRadioButton=ye,X.AcroFormCheckBox=Se,X.AcroFormTextField=_e,X.AcroFormPasswordField=we,X.AcroFormAppearance=be,X.AcroForm={ChoiceField:fe,ListBox:ge,ComboBox:me,EditBox:Ee,Button:Ce,PushButton:Ae,RadioButton:ye,CheckBox:Se,TextField:_e,PasswordField:we,Appearance:be},G.AcroForm={ChoiceField:fe,ListBox:ge,ComboBox:me,EditBox:Ee,Button:Ce,PushButton:Ae,RadioButton:ye,CheckBox:Se,TextField:_e,PasswordField:we,Appearance:be};var Pe,ve,Te=G.AcroForm;function Me(e){return e.reduce((function(e,t,n){return e[t]=n,e}),{})}!function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=e.__addimage__.getImageFileTypeByImageData=function(e,r){var i,l,s,o,a,u=t;if("RGBA"===(r=r||t)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(w(e))for(a in n)for(s=n[a],i=0;i<s.length;i+=1){for(o=!0,l=0;l<s[i].length;l+=1)if(void 0!==s[i][l]&&s[i][l]!==e[l]){o=!1;break}if(!0===o){u=a;break}}else for(a in n)for(s=n[a],i=0;i<s.length;i+=1){for(o=!0,l=0;l<s[i].length;l+=1)if(void 0!==s[i][l]&&s[i][l]!==e.charCodeAt(l)){o=!1;break}if(!0===o){u=a;break}}return u===t&&r!==t&&(u=r),u},l=function e(t){for(var n=this.internal.write,r=this.internal.putStream,i=(0,this.internal.getFilters)();-1!==i.indexOf("FlateEncode");)i.splice(i.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var l=[];if(l.push({key:"Type",value:"/XObject"}),l.push({key:"Subtype",value:"/Image"}),l.push({key:"Width",value:t.width}),l.push({key:"Height",value:t.height}),t.colorSpace===C.INDEXED?l.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(l.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===C.DEVICE_CMYK&&l.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),l.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&l.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)){for(var s="",o=0,a=t.transparency.length;o<a;o++)s+=t.transparency[o]+" "+t.transparency[o]+" ";l.push({key:"Mask",value:"["+s+"]"})}void 0!==t.sMask&&l.push({key:"SMask",value:t.objectId+1+" 0 R"});var u=void 0!==t.filter?["/"+t.filter]:void 0;if(r({data:t.data,additionalKeyValues:l,alreadyAppliedFilters:u,objectId:t.objectId}),n("endobj"),"sMask"in t&&void 0!==t.sMask){var h="/Predictor "+t.predictor+" /Colors 1 /BitsPerComponent "+t.bitsPerComponent+" /Columns "+t.width,d={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:t.bitsPerComponent,decodeParameters:h,data:t.sMask};"filter"in t&&(d.filter=t.filter),e.call(this,d)}if(t.colorSpace===C.INDEXED){var c=this.internal.newObject();r({data:x(new Uint8Array(t.palette)),objectId:c}),n("endobj")}},s=function(){var e=this.internal.collections.addImage_images;for(var t in e)l.call(this,e[t])},o=function(){var e,t=this.internal.collections.addImage_images,n=this.internal.write;for(var r in t)n("/I"+(e=t[r]).index,e.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},u=function(){var e=this.internal.collections.addImage_images;return a.call(this),e},h=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(t){return"function"==typeof e["process"+t.toUpperCase()]},p=function(e){return"object"===i()(e)&&1===e.nodeType},f=function(t,n){if("IMG"===t.nodeName&&t.hasAttribute("src")){var r=""+t.getAttribute("src");if(0===r.indexOf("data:image/"))return c(unescape(r).split("base64,").pop());var i=e.loadFile(r,!0);if(void 0!==i)return i}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var l;switch(n){case"PNG":l="image/png";break;case"WEBP":l="image/webp";break;case"JPEG":case"JPG":default:l="image/jpeg"}return c(t.toDataURL(l,1).split("base64,").pop())}},g=function(e){var t=this.internal.collections.addImage_images;if(t)for(var n in t)if(e===t[n].alias)return t[n]},m=function(e,t,n){return e||t||(e=-96,t=-96),e<0&&(e=-1*n.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*n.height*72/t/this.internal.scaleFactor),0===e&&(e=t*n.width/n.height),0===t&&(t=e*n.height/n.width),[e,t]},E=function(e,t,n,r,i,l){var s=m.call(this,n,r,i),o=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,h=u.call(this);if(n=s[0],r=s[1],h[i.index]=i,l){l*=Math.PI/180;var d=Math.cos(l),c=Math.sin(l),p=function(e){return e.toFixed(4)},f=[p(d),p(c),p(-1*c),p(d),0,0,"cm"]}this.internal.write("q"),l?(this.internal.write([1,"0","0",1,o(e),a(t+r),"cm"].join(" ")),this.internal.write(f.join(" ")),this.internal.write([o(n),"0","0",o(r),"0","0","cm"].join(" "))):this.internal.write([o(n),"0","0",o(r),o(e),a(t+r),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+i.index+" Do"),this.internal.write("Q")},C=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var A=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=e.__addimage__.sHashCode=function(e){var t,n,r=0;if("string"==typeof e)for(n=e.length,t=0;t<n;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;else if(w(e))for(n=e.byteLength/2,t=0;t<n;t++)r=(r<<5)-r+e[t],r|=0;return r},I=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},S=e.__addimage__.extractImageFromDataUrl=function(e){var t=(e=e||"").split("base64,"),n=null;if(2===t.length){var r=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(t[0]);Array.isArray(r)&&(n={mimeType:r[1],charset:r[2],data:t[1]})}return n},_=e.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array};e.__addimage__.isArrayBuffer=function(e){return _()&&e instanceof ArrayBuffer};var w=e.__addimage__.isArrayBufferView=function(e){return _()&&"undefined"!=typeof Uint32Array&&(e instanceof Int8Array||e instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)},b=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n},x=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",n=w(e)?e:new Uint8Array(e),r=0;r<n.length;r+=8192)t+=String.fromCharCode.apply(null,n.subarray(r,r+8192));return t};e.addImage=function(){var e,n,r,l,s,o,u,h,d;if("number"==typeof arguments[1]?(n=t,r=arguments[1],l=arguments[2],s=arguments[3],o=arguments[4],u=arguments[5],h=arguments[6],d=arguments[7]):(n=arguments[1],r=arguments[2],l=arguments[3],s=arguments[4],o=arguments[5],u=arguments[6],h=arguments[7],d=arguments[8]),"object"===i()(e=arguments[0])&&!p(e)&&"imageData"in e){var c=e;e=c.imageData,n=c.format||n||t,r=c.x||r||0,l=c.y||l||0,s=c.w||c.width||s,o=c.h||c.height||o,u=c.alias||u,h=c.compression||h,d=c.rotation||c.angle||d}var f=this.internal.getFilters();if(void 0===h&&-1!==f.indexOf("FlateEncode")&&(h="SLOW"),isNaN(r)||isNaN(l))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var g=P.call(this,e,n,u,h);return E.call(this,r,l,s,o,g,d),this};var P=function(n,i,l,s){var o,a,u;if("string"==typeof n&&r(n)===t){n=unescape(n);var c=v(n,!1);(""!==c||void 0!==(c=e.loadFile(n,!0)))&&(n=c)}if(p(n)&&(n=f(n,i)),i=r(n,i),!d(i))throw new Error("addImage does not support files of type '"+i+"', please ensure that a plugin for '"+i+"' support is added.");if((null==(u=l)||0===u.length)&&(l=function(e){return"string"==typeof e||w(e)?y(e):w(e.data)?y(e.data):null}(n)),(o=g.call(this,l))||(_()&&(n instanceof Uint8Array||"RGBA"===i||(a=n,n=b(n))),o=this["process"+i.toUpperCase()](n,h.call(this),l,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:A.NONE}(s),a)),!o)throw new Error("An unknown error occurred whilst processing the image.");return o},v=e.__addimage__.convertBase64ToBinaryString=function(e,t){var n;t="boolean"!=typeof t||t;var r,i="";if("string"==typeof e){r=null!==(n=S(e))?n.data:e;try{i=c(r)}catch(e){if(t)throw I(r)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+e.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return i};e.getImageProperties=function(n){var i,l,s="";if(p(n)&&(n=f(n)),"string"==typeof n&&r(n)===t&&(""===(s=v(n,!1))&&(s=e.loadFile(n)||""),n=s),l=r(n),!d(l))throw new Error("addImage does not support files of type '"+l+"', please ensure that a plugin for '"+l+"' support is added.");if(!_()||n instanceof Uint8Array||(n=b(n)),!(i=this["process"+l.toUpperCase()](n)))throw new Error("An unknown error occurred whilst processing the image");return i.fileType=l,i}}(G.API),Pe=G.API,ve=function(e){if(void 0!==e&&""!=e)return!0},G.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),Pe.events.push(["putPage",function(e){for(var t,n,r,i=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,s=this.internal.getPageInfoByObjId(e.objId),o=e.pageContext.annotations,a=!1,u=0;u<o.length&&!a;u++)switch((t=o[u]).type){case"link":(ve(t.options.url)||ve(t.options.pageNumber))&&(a=!0);break;case"reference":case"text":case"freetext":a=!0}if(0!=a){this.internal.write("/Annots [");for(var h=0;h<o.length;h++){t=o[h];var d=this.internal.pdfEscape,c=this.internal.getEncryptor(e.objId);switch(t.type){case"reference":this.internal.write(" "+t.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),f=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(p.objId),m=t.title||"Note";r="<</Type /Annot /Subtype /Text "+(n="/Rect ["+i(t.bounds.x)+" "+l(t.bounds.y+t.bounds.h)+" "+i(t.bounds.x+t.bounds.w)+" "+l(t.bounds.y)+"] ")+"/Contents ("+d(g(t.contents))+")",r+=" /Popup "+f.objId+" 0 R",r+=" /P "+s.objId+" 0 R",r+=" /T ("+d(g(m))+") >>",p.content=r;var E=p.objId+" 0 R";r="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+i(t.bounds.x+30)+" "+l(t.bounds.y+t.bounds.h)+" "+i(t.bounds.x+t.bounds.w+30)+" "+l(t.bounds.y)+"] ")+" /Parent "+E,t.open&&(r+=" /Open true"),r+=" >>",f.content=r,this.internal.write(p.objId,"0 R",f.objId,"0 R");break;case"freetext":n="/Rect ["+i(t.bounds.x)+" "+l(t.bounds.y)+" "+i(t.bounds.x+t.bounds.w)+" "+l(t.bounds.y+t.bounds.h)+"] ";var C=t.color||"#000000";r="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+d(c(t.contents))+")",r+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+C+")",r+=" /Border [0 0 0]",r+=" >>",this.internal.write(r);break;case"link":if(t.options.name){var A=this.annotations._nameMap[t.options.name];t.options.pageNumber=A.page,t.options.top=A.y}else t.options.top||(t.options.top=0);if(n="/Rect ["+t.finalBounds.x+" "+t.finalBounds.y+" "+t.finalBounds.w+" "+t.finalBounds.h+"] ",r="",t.options.url)r="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+d(c(t.options.url))+") >>";else if(t.options.pageNumber)switch(r="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(t.options.pageNumber).objId+" 0 R",t.options.magFactor=t.options.magFactor||"XYZ",t.options.magFactor){case"Fit":r+=" /Fit]";break;case"FitH":r+=" /FitH "+t.options.top+"]";break;case"FitV":t.options.left=t.options.left||0,r+=" /FitV "+t.options.left+"]";break;case"XYZ":default:var y=l(t.options.top);t.options.left=t.options.left||0,void 0===t.options.zoom&&(t.options.zoom=0),r+=" /XYZ "+t.options.left+" "+y+" "+t.options.zoom+"]"}""!=r&&(r+=" >>",this.internal.write(r))}}this.internal.write("]")}}]),Pe.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},Pe.link=function(e,t,n,r,i){var l=this.internal.getCurrentPageInfo(),s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:s(e),y:o(t),w:s(e+n),h:o(t+r)},options:i,type:"link"})},Pe.textWithLink=function(e,t,n,r){var i,l,s=this.getTextWidth(e),o=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==r.maxWidth){l=r.maxWidth;var a=this.splitTextToSize(e,l).length;i=Math.ceil(o*a)}else l=s,i=o;return this.text(e,t,n,r),n+=.2*o,"center"===r.align&&(t-=s/2),"right"===r.align&&(t-=s),this.link(t,n-o,l,i,r),s},Pe.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor},function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var l=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},s=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},o=e.__arabicParser__.isArabicEndLetter=function(e){return s(e)&&l(e)&&t[e.charCodeAt(0)].length<=2},a=e.__arabicParser__.isArabicAlfLetter=function(e){return s(e)&&i.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return s(e)&&l(e)&&t[e.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return s(e)&&l(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return s(e)&&l(e)&&t[e.charCodeAt(0)].length>=3};var h=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return s(e)&&l(e)&&4==t[e.charCodeAt(0)].length},d=e.__arabicParser__.resolveLigatures=function(e){var t=0,r=n,i="",l=0;for(t=0;t<e.length;t+=1)void 0!==r[e.charCodeAt(t)]?(l++,"number"==typeof(r=r[e.charCodeAt(t)])&&(i+=String.fromCharCode(r),r=n,l=0),t===e.length-1&&(r=n,i+=e.charAt(t-(l-1)),t-=l-1,l=0)):(r=n,i+=e.charAt(t-l),t-=l,l=0);return i};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==r[e.charCodeAt(0)]};var c=e.__arabicParser__.getCorrectForm=function(e,t,n){return s(e)?!1===l(e)?-1:!u(e)||!s(t)&&!s(n)||!s(n)&&o(t)||o(e)&&!s(t)||o(e)&&a(t)||o(e)&&o(t)?0:h(e)&&s(t)&&!o(t)&&s(n)&&u(n)?3:o(e)||!s(n)?1:2:-1},p=function(e){var n=0,r=0,i=0,l="",o="",a="",u=(e=e||"").split("\\s+"),h=[];for(n=0;n<u.length;n+=1){for(h.push(""),r=0;r<u[n].length;r+=1)l=u[n][r],o=u[n][r-1],a=u[n][r+1],s(l)?(i=c(l,o,a),h[n]+=-1!==i?String.fromCharCode(t[l.charCodeAt(0)][i]):l):h[n]+=l;h[n]=d(h[n])}return h.join(" ")},f=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,n=[];if(Array.isArray(t)){var r=0;for(n=[],r=0;r<t.length;r+=1)Array.isArray(t[r])?n.push([p(t[r][0]),t[r][1],t[r][2]]):n.push([p(t[r])]);e=n}else e=p(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",f])}(G.API),G.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",(function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+t+" 0 R")}))}return this},function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(e){n=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(e){r=e}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var n;if("2d"!==(e=e||"2d"))return null;for(n in t)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=t[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(G.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,r=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),l.call(this))},l=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var n=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var r=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var i=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return i},set:function(e){i=e}});var l=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return l},set:function(e){l=e}});var s=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return s},set:function(e){s=e}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return r.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){r.call(this);var n=(t=t||{}).fontSize||this.getFontSize(),i=t.font||this.getFont(),l=t.scaleFactor||this.internal.scaleFactor,s=0,o=0,a=0,u=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var h=t.maxWidth;h>0?"string"==typeof e?e=this.splitTextToSize(e,h):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce((function(e,t){return e.concat(u.splitTextToSize(t,h))}),[])):e=Array.isArray(e)?e:[e];for(var d=0;d<e.length;d++)s<(a=this.getStringUnitWidth(e[d],{font:i})*n)&&(s=a);return 0!==s&&(o=e.length),{w:s/=l,h:Math.max((o*n*this.getLineHeightFactor()-n*(this.getLineHeightFactor()-1))/l,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var e;e=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var i=this.internal.__cell__.lastCell,l=this.internal.__cell__.padding,o=this.internal.__cell__.margins||t,a=this.internal.__cell__.tableHeaderRow,u=this.internal.__cell__.printHeaders;return void 0!==i.lineNumber&&(i.lineNumber===e.lineNumber?(e.x=(i.x||0)+(i.width||0),e.y=i.y||0):i.y+i.height+e.height+o.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=o.top,u&&a&&(this.printHeaderRow(e.lineNumber,!0),e.y+=a[0].height)):e.y=i.y+i.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===n?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-l,e.y+l,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+l,{align:"center",baseline:"top",maxWidth:e.width-l-l}):this.text(e.text,e.x+l,e.y+l,{align:"left",baseline:"top",maxWidth:e.width-l-l})),this.internal.__cell__.lastCell=e,this};e.table=function(e,n,u,h,d){if(r.call(this),!u)throw new Error("No data for PDF table.");var c,p,f,g,m=[],E=[],C=[],A={},y={},I=[],S=[],_=(d=d||{}).autoSize||!1,w=!1!==d.printHeaders,b=d.css&&void 0!==d.css["font-size"]?16*d.css["font-size"]:d.fontSize||12,x=d.margins||Object.assign({width:this.getPageWidth()},t),P="number"==typeof d.padding?d.padding:3,v=d.headerBackgroundColor||"#c8c8c8",T=d.headerTextColor||"#000";if(l.call(this),this.internal.__cell__.printHeaders=w,this.internal.__cell__.margins=x,this.internal.__cell__.table_font_size=b,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=v,this.internal.__cell__.headerTextColor=T,this.setFontSize(b),null==h)E=m=Object.keys(u[0]),C=m.map((function(){return"left"}));else if(Array.isArray(h)&&"object"===i()(h[0]))for(m=h.map((function(e){return e.name})),E=h.map((function(e){return e.prompt||e.name||""})),C=h.map((function(e){return e.align||"left"})),c=0;c<h.length;c+=1)y[h[c].name]=h[c].width*(19.049976/25.4);else Array.isArray(h)&&"string"==typeof h[0]&&(E=m=h,C=m.map((function(){return"left"})));if(_||Array.isArray(h)&&"string"==typeof h[0])for(c=0;c<m.length;c+=1){for(A[g=m[c]]=u.map((function(e){return e[g]})),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(E[c],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=A[g],this.setFont(void 0,"normal"),f=0;f<p.length;f+=1)I.push(this.getTextDimensions(p[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);y[g]=Math.max.apply(null,I)+P+P,I=[]}if(w){var M={};for(c=0;c<m.length;c+=1)M[m[c]]={},M[m[c]].text=E[c],M[m[c]].align=C[c];var L=a.call(this,M,y);S=m.map((function(t){return new s(e,n,y[t],L,M[t].text,void 0,M[t].align)})),this.setTableHeaderRow(S),this.printHeaderRow(1,!1)}var D=h.reduce((function(e,t){return e[t.name]=t.align,e}),{});for(c=0;c<u.length;c+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:c,data:u[c]},this);var R=a.call(this,u[c],y);for(f=0;f<m.length;f+=1){var F=u[c][m[f]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:c,col:f,data:F},this),o.call(this,new s(e,n,y[m[f]],R,F,c+2,D[m[f]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=n,this};var a=function(e,t){var n=this.internal.__cell__.padding,r=this.internal.__cell__.table_font_size,i=this.internal.scaleFactor;return Object.keys(e).map((function(r){var i=e[r];return this.splitTextToSize(i.hasOwnProperty("text")?i.text:i,t[r]-n-n)}),this).map((function(e){return this.getLineHeightFactor()*e.length*r/i+n+n}),this).reduce((function(e,t){return Math.max(e,t)}),0)};e.setTableHeaderRow=function(e){r.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var i;if(n=!0,"function"==typeof this.internal.__cell__.headerFunction){var l=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(l[0],l[1],l[2],l[3],void 0,-1)}this.setFont(void 0,"bold");for(var a=[],u=0;u<this.internal.__cell__.tableHeaderRow.length;u+=1){i=this.internal.__cell__.tableHeaderRow[u].clone(),t&&(i.y=this.internal.__cell__.margins.top||0,a.push(i)),i.lineNumber=e;var h=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,i),this.setTextColor(h)}a.length>0&&this.setTableHeaderRow(a),this.setFont(void 0,"normal"),n=!1}}(G.API);var Le={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},De=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Re=Me(De),Fe=[100,200,300,400,500,600,700,800,900],Ne=Me(Fe);function Be(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(e){return Le[e=e||"normal"]?e:"normal"}(e.style),r=function(e){if(!e)return 400;if("number"==typeof e)return e>=100&&e<=900&&e%100==0?e:400;if(/^\d00$/.test(e))return parseInt(e);switch(e){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(e){return"number"==typeof Re[e=e||"normal"]?e:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,n,r].join(" ")}}}function ke(e,t,n,r){var i;for(i=n;i>=0&&i<t.length;i+=r)if(e[t[i]])return e[t[i]];for(i=n;i>=0&&i<t.length;i-=r)if(e[t[i]])return e[t[i]]}var Oe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Ge={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Xe(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Ve(e){return e.trimLeft()}function He(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function Ue(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var We,je,ze,Ye=["times"];!function(e){var t,n,r,l,s,o,u,h,d,c=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new h,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new o,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new o,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new p(this),t=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,l=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,u=this.internal.Rectangle,h=this.internal.Matrix,d=new c}]);var p=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var n=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return n},set:function(e){n=Boolean(e)}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(e){r=Boolean(e)}});var i=0;Object.defineProperty(this,"posX",{get:function(){return i},set:function(e){isNaN(e)||(i=e)}});var l=0;Object.defineProperty(this,"posY",{get:function(){return l},set:function(e){isNaN(e)||(l=e)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),d.margin=t}});var s=!1;Object.defineProperty(this,"autoPaging",{get:function(){return s},set:function(e){s=e}});var o=0;Object.defineProperty(this,"lastBreak",{get:function(){return o},set:function(e){o=e}});var a=[];Object.defineProperty(this,"pageBreaks",{get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(e){e instanceof c&&(d=e)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(e){d.path=e}});var u=[];Object.defineProperty(this,"ctxStack",{get:function(){return u},set:function(e){u=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=f(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=f(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var h=null;function p(e,t){if(null===h){var n=function(e){var t=[];return Object.keys(e).forEach((function(n){e[n].forEach((function(e){var r=null;switch(e){case"bold":r={family:n,weight:"bold"};break;case"italic":r={family:n,style:"italic"};break;case"bolditalic":r={family:n,weight:"bold",style:"italic"};break;case"":case"normal":r={family:n}}null!==r&&(r.ref={name:n,style:e},t.push(r))}))})),t}(e.getFontList());h=function(e){for(var t={},n=0;n<e.length;++n){var r=Be(e[n]),i=r.family,l=r.stretch,s=r.style,o=r.weight;t[i]=t[i]||{},t[i][l]=t[i][l]||{},t[i][l][s]=t[i][l][s]||{},t[i][l][s][o]=r}return t}(n.concat(t))}return h}var g=null;Object.defineProperty(this,"fontFaces",{get:function(){return g},set:function(e){h=null,g=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(e))){var n=t[1],r=(t[2],t[3]),i=t[4],l=(t[5],t[6]),s=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(i)[2];i="px"===s?Math.floor(parseFloat(i)*this.pdf.internal.scaleFactor):"em"===s?Math.floor(parseFloat(i)*this.pdf.getFontSize()):Math.floor(parseFloat(i)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(i);var o=function(e){var t,n,r=[],i=e.trim();if(""===i)return Ye;if(i in Ge)return[Ge[i]];for(;""!==i;){switch(n=null,t=(i=Ve(i)).charAt(0)){case'"':case"'":n=He(i.substring(1),t);break;default:n=Ue(i)}if(null===n)return Ye;if(r.push(n[0]),""!==(i=Ve(n[1]))&&","!==i.charAt(0))return Ye;i=i.replace(/^,/,"")}return r}(l);if(this.fontFaces){var a=function(e,t,n){for(var r=(n=n||{}).defaultFontFamily||"times",i=Object.assign({},Oe,n.genericFontFamilies||{}),l=null,s=null,o=0;o<t.length;++o)if(i[(l=Be(t[o])).family]&&(l.family=i[l.family]),e.hasOwnProperty(l.family)){s=e[l.family];break}if(!(s=s||e[r]))throw new Error("Could not find a font-family for the rule '"+Xe(l)+"' and default family '"+r+"'.");if(s=function(e,t){if(t[e])return t[e];var n=Re[e],r=n<=Re.normal?-1:1,i=ke(t,De,n,r);if(!i)throw new Error("Could not find a matching font-stretch value for "+e);return i}(l.stretch,s),s=function(e,t){if(t[e])return t[e];for(var n=Le[e],r=0;r<n.length;++r)if(t[n[r]])return t[n[r]];throw new Error("Could not find a matching font-style for "+e)}(l.style,s),!(s=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var n=Ne[e],r=ke(t,Fe,n,e<400?-1:1);if(!r)throw new Error("Could not find a matching font-weight for value "+e);return r}(l.weight,s)))throw new Error("Failed to resolve a font for the rule '"+Xe(l)+"'.");return s}(p(this.pdf,this.fontFaces),o.map((function(e){return{family:e,stretch:"normal",weight:r,style:n}})));this.pdf.setFont(a.ref.name,a.ref.style)}else{var u="";("bold"===r||parseInt(r,10)>=700||"bold"===n)&&(u="bold"),"italic"===n&&(u+="italic"),0===u.length&&(u="normal");for(var h="",d={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},c=0;c<o.length;c++){if(void 0!==this.pdf.internal.getFont(o[c],u,{noFallback:!0,disableWarning:!0})){h=o[c];break}if("bolditalic"===u&&void 0!==this.pdf.internal.getFont(o[c],"bold",{noFallback:!0,disableWarning:!0}))h=o[c],u="bold";else if(void 0!==this.pdf.internal.getFont(o[c],"normal",{noFallback:!0,disableWarning:!0})){h=o[c],u="normal";break}}if(""===h)for(var f=0;f<o.length;f++)if(d[o[f]]){h=d[o[f]];break}h=""===h?"Times":h,this.pdf.setFont(h,u)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,X.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,X.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};p.prototype.setLineDash=function(e){this.lineDash=e},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){_.call(this,"fill",!1)},p.prototype.stroke=function(){_.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw a.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var n=this.ctx.transform.applyToPoint(new o(e,t));this.path.push({type:"mt",x:n.x,y:n.y}),this.ctx.lastPoint=new o(e,t)},p.prototype.closePath=function(){var e=new o(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===i()(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new o(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(e.x,e.y)},p.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw a.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var n=this.ctx.transform.applyToPoint(new o(e,t));this.path.push({type:"lt",x:n.x,y:n.y}),this.ctx.lastPoint=new o(n.x,n.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),_.call(this,null,!0)},p.prototype.quadraticCurveTo=function(e,t,n,r){if(isNaN(n)||isNaN(r)||isNaN(e)||isNaN(t))throw a.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var i=this.ctx.transform.applyToPoint(new o(n,r)),l=this.ctx.transform.applyToPoint(new o(e,t));this.path.push({type:"qct",x1:l.x,y1:l.y,x:i.x,y:i.y}),this.ctx.lastPoint=new o(i.x,i.y)},p.prototype.bezierCurveTo=function(e,t,n,r,i,l){if(isNaN(i)||isNaN(l)||isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw a.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var s=this.ctx.transform.applyToPoint(new o(i,l)),u=this.ctx.transform.applyToPoint(new o(e,t)),h=this.ctx.transform.applyToPoint(new o(n,r));this.path.push({type:"bct",x1:u.x,y1:u.y,x2:h.x,y2:h.y,x:s.x,y:s.y}),this.ctx.lastPoint=new o(s.x,s.y)},p.prototype.arc=function(e,t,n,r,i,l){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i))throw a.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(l=Boolean(l),!this.ctx.transform.isIdentity){var s=this.ctx.transform.applyToPoint(new o(e,t));e=s.x,t=s.y;var u=this.ctx.transform.applyToPoint(new o(0,n)),h=this.ctx.transform.applyToPoint(new o(0,0));n=Math.sqrt(Math.pow(u.x-h.x,2)+Math.pow(u.y-h.y,2))}Math.abs(i-r)>=2*Math.PI&&(r=0,i=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:n,startAngle:r,endAngle:i,counterclockwise:l})},p.prototype.arcTo=function(e,t,n,r,i){throw new Error("arcTo not implemented.")},p.prototype.rect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw a.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+r),this.lineTo(e,t+r),this.lineTo(e,t),this.lineTo(e+n,t),this.lineTo(e,t)},p.prototype.fillRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw a.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var i={};"butt"!==this.lineCap&&(i.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(i.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,n,r),this.fill(),i.hasOwnProperty("lineCap")&&(this.lineCap=i.lineCap),i.hasOwnProperty("lineJoin")&&(this.lineJoin=i.lineJoin)}},p.prototype.strokeRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw a.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");E.call(this)||(this.beginPath(),this.rect(e,t,n,r),this.stroke())},p.prototype.clearRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw a.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,n,r))},p.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var r=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=r}},p.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(e){var t,n,r,i;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,n=0,r=0,i=0;else{var l=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==l)t=parseInt(l[1]),n=parseInt(l[2]),r=parseInt(l[3]),i=1;else if(null!==(l=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(l[1]),n=parseInt(l[2]),r=parseInt(l[3]),i=parseFloat(l[4]);else{if(i=1,"string"==typeof e&&"#"!==e.charAt(0)){var s=new g(e);e=s.ok?s.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,n=e.substring(2,3),n+=n,r=e.substring(3,4),r+=r):(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7)),t=parseInt(t,16),n=parseInt(n,16),r=parseInt(r,16)}}return{r:t,g:n,b:r,a:i,style:e}},m=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},E=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};p.prototype.fillText=function(e,t,n,r){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw a.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(r=isNaN(r)?void 0:r,!m.call(this)){var i=k(this.ctx.transform.rotation),l=this.ctx.transform.scaleX;L.call(this,{text:e,x:t,y:n,scale:l,angle:i,align:this.textAlign,maxWidth:r})}},p.prototype.strokeText=function(e,t,n,r){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw a.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!E.call(this)){r=isNaN(r)?void 0:r;var i=k(this.ctx.transform.rotation),l=this.ctx.transform.scaleX;L.call(this,{text:e,x:t,y:n,scale:l,renderingMode:"stroke",angle:i,align:this.textAlign,maxWidth:r})}},p.prototype.measureText=function(e){if("string"!=typeof e)throw a.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,n=this.pdf.internal.scaleFactor,r=t.internal.getFontSize(),i=t.getStringUnitWidth(e)*r/t.internal.scaleFactor,l=function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this};return new l({width:i*=Math.round(96*n/72*1e4)/1e4})},p.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw a.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var n=new h(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(n)},p.prototype.rotate=function(e){if(isNaN(e))throw a.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new h(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},p.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw a.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var n=new h(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(n)},p.prototype.transform=function(e,t,n,r,i,l){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(l))throw a.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var s=new h(e,t,n,r,i,l);this.ctx.transform=this.ctx.transform.multiply(s)},p.prototype.setTransform=function(e,t,n,r,i,l){e=isNaN(e)?1:e,t=isNaN(t)?0:t,n=isNaN(n)?0:n,r=isNaN(r)?1:r,i=isNaN(i)?0:i,l=isNaN(l)?0:l,this.ctx.transform=new h(e,t,n,r,i,l)};var C=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(e,t,n,r,i,l,s,o,a){var d=this.pdf.getImageProperties(e),c=1,p=1,f=1,g=1;void 0!==r&&void 0!==o&&(f=o/r,g=a/i,c=d.width/r*o/r,p=d.height/i*a/i),void 0===l&&(l=t,s=n,t=0,n=0),void 0!==r&&void 0===o&&(o=r,a=i),void 0===r&&void 0===o&&(o=d.width,a=d.height);for(var m,E=this.ctx.transform.decompose(),y=k(E.rotate.shx),_=new h,b=(_=(_=(_=_.multiply(E.translate)).multiply(E.skew)).multiply(E.scale)).applyToRectangle(new u(l-t*f,s-n*g,r*c,i*p)),x=A.call(this,b),P=[],v=0;v<x.length;v+=1)-1===P.indexOf(x[v])&&P.push(x[v]);if(S(P),this.autoPaging)for(var T=P[0],M=P[P.length-1],L=T;L<M+1;L++){this.pdf.setPage(L);var D=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],R=1===L?this.posY+this.margin[0]:this.margin[0],F=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],N=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],B=1===L?0:F+(L-2)*N;if(0!==this.ctx.clip_path.length){var O=this.path;m=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=I(m,this.posX+this.margin[3],-B+R+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=O}var G=JSON.parse(JSON.stringify(b));G=I([G],this.posX+this.margin[3],-B+R+this.ctx.prevPageLastElemOffset)[0];var X=(L>T||L<M)&&C.call(this);X&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],D,N,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",G.x,G.y,G.w,G.h,null,null,y),X&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(e,"JPEG",b.x,b.y,b.w,b.h,null,null,y)};var A=function(e,t,n){var r=[];t=t||this.pdf.internal.pageSize.width,n=n||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var i=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":r.push(Math.floor((e.y+i)/n)+1);break;case"arc":r.push(Math.floor((e.y+i-e.radius)/n)+1),r.push(Math.floor((e.y+i+e.radius)/n)+1);break;case"qct":var l=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);r.push(Math.floor((l.y+i)/n)+1),r.push(Math.floor((l.y+l.h+i)/n)+1);break;case"bct":var s=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);r.push(Math.floor((s.y+i)/n)+1),r.push(Math.floor((s.y+s.h+i)/n)+1);break;case"rect":r.push(Math.floor((e.y+i)/n)+1),r.push(Math.floor((e.y+e.h+i)/n)+1)}for(var o=0;o<r.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<r[o];)y.call(this);return r},y=function(){var e=this.fillStyle,t=this.strokeStyle,n=this.font,r=this.lineCap,i=this.lineWidth,l=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=n,this.lineCap=r,this.lineWidth=i,this.lineJoin=l},I=function(e,t,n){for(var r=0;r<e.length;r++)switch(e[r].type){case"bct":e[r].x2+=t,e[r].y2+=n;case"qct":e[r].x1+=t,e[r].y1+=n;case"mt":case"lt":case"arc":default:e[r].x+=t,e[r].y+=n}return e},S=function(e){return e.sort((function(e,t){return e-t}))},_=function(e,t){for(var n,r,i=this.fillStyle,l=this.strokeStyle,s=this.lineCap,o=this.lineWidth,a=Math.abs(o*this.ctx.transform.scaleX),u=this.lineJoin,h=JSON.parse(JSON.stringify(this.path)),d=JSON.parse(JSON.stringify(this.path)),c=[],p=0;p<d.length;p++)if(void 0!==d[p].x)for(var f=A.call(this,d[p]),g=0;g<f.length;g+=1)-1===c.indexOf(f[g])&&c.push(f[g]);for(var m=0;m<c.length;m++)for(;this.pdf.internal.getNumberOfPages()<c[m];)y.call(this);if(S(c),this.autoPaging)for(var E=c[0],_=c[c.length-1],b=E;b<_+1;b++){this.pdf.setPage(b),this.fillStyle=i,this.strokeStyle=l,this.lineCap=s,this.lineWidth=a,this.lineJoin=u;var x=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],P=1===b?this.posY+this.margin[0]:this.margin[0],v=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],T=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],M=1===b?0:v+(b-2)*T;if(0!==this.ctx.clip_path.length){var L=this.path;n=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=I(n,this.posX+this.margin[3],-M+P+this.ctx.prevPageLastElemOffset),w.call(this,e,!0),this.path=L}if(r=JSON.parse(JSON.stringify(h)),this.path=I(r,this.posX+this.margin[3],-M+P+this.ctx.prevPageLastElemOffset),!1===t||0===b){var D=(b>E||b<_)&&C.call(this);D&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],x,T,null).clip().discardPath()),w.call(this,e,t),D&&this.pdf.restoreGraphicsState()}this.lineWidth=o}else this.lineWidth=a,w.call(this,e,t),this.lineWidth=o;this.path=h},w=function(e,t){if(("stroke"!==e||t||!E.call(this))&&("stroke"===e||t||!m.call(this))){for(var n,r,i=[],l=this.path,s=0;s<l.length;s++){var o=l[s];switch(o.type){case"begin":i.push({begin:!0});break;case"close":i.push({close:!0});break;case"mt":i.push({start:o,deltas:[],abs:[]});break;case"lt":var a=i.length;if(l[s-1]&&!isNaN(l[s-1].x)&&(n=[o.x-l[s-1].x,o.y-l[s-1].y],a>0))for(;a>=0;a--)if(!0!==i[a-1].close&&!0!==i[a-1].begin){i[a-1].deltas.push(n),i[a-1].abs.push(o);break}break;case"bct":n=[o.x1-l[s-1].x,o.y1-l[s-1].y,o.x2-l[s-1].x,o.y2-l[s-1].y,o.x-l[s-1].x,o.y-l[s-1].y],i[i.length-1].deltas.push(n);break;case"qct":var u=l[s-1].x+2/3*(o.x1-l[s-1].x),h=l[s-1].y+2/3*(o.y1-l[s-1].y),d=o.x+2/3*(o.x1-o.x),c=o.y+2/3*(o.y1-o.y),p=o.x,f=o.y;n=[u-l[s-1].x,h-l[s-1].y,d-l[s-1].x,c-l[s-1].y,p-l[s-1].x,f-l[s-1].y],i[i.length-1].deltas.push(n);break;case"arc":i.push({deltas:[],abs:[],arc:!0}),Array.isArray(i[i.length-1].abs)&&i[i.length-1].abs.push(o)}}r=t?null:"stroke"===e?"stroke":"fill";for(var g=!1,C=0;C<i.length;C++)if(i[C].arc)for(var A=i[C].abs,y=0;y<A.length;y++){var I=A[y];"arc"===I.type?P.call(this,I.x,I.y,I.radius,I.startAngle,I.endAngle,I.counterclockwise,void 0,t,!g):D.call(this,I.x,I.y),g=!0}else if(!0===i[C].close)this.pdf.internal.out("h"),g=!1;else if(!0!==i[C].begin){var S=i[C].start.x,_=i[C].start.y;R.call(this,i[C].deltas,S,_),g=!0}r&&v.call(this,r),t&&T.call(this)}},b=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,n=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-n;case"top":return e+t-n;case"hanging":return e+t-2*n;case"middle":return e+t/2-n;case"ideographic":return e;case"alphabetic":default:return e}},x=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(e,t,n,r,i,l,s,o,a){for(var u=N.call(this,n,r,i,l),h=0;h<u.length;h++){var d=u[h];0===h&&(a?M.call(this,d.x1+e,d.y1+t):D.call(this,d.x1+e,d.y1+t)),F.call(this,e,t,d.x2,d.y2,d.x3,d.y3,d.x4,d.y4)}o?T.call(this):v.call(this,s)},v=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},T=function(){this.pdf.clip(),this.pdf.discardPath()},M=function(e,t){this.pdf.internal.out(n(e)+" "+r(t)+" m")},L=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;case"left":case"start":default:t="left"}var n=this.pdf.getTextDimensions(e.text),r=b.call(this,e.y),i=x.call(this,r)-n.h,l=this.ctx.transform.applyToPoint(new o(e.x,r)),s=this.ctx.transform.decompose(),a=new h;a=(a=(a=a.multiply(s.translate)).multiply(s.skew)).multiply(s.scale);for(var d,c,p,f=this.ctx.transform.applyToRectangle(new u(e.x,r,n.w,n.h)),g=a.applyToRectangle(new u(e.x,i,n.w,n.h)),m=A.call(this,g),E=[],y=0;y<m.length;y+=1)-1===E.indexOf(m[y])&&E.push(m[y]);if(S(E),this.autoPaging)for(var _=E[0],P=E[E.length-1],v=_;v<P+1;v++){this.pdf.setPage(v);var T=1===v?this.posY+this.margin[0]:this.margin[0],M=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],L=this.pdf.internal.pageSize.height-this.margin[2],D=L-this.margin[0],R=this.pdf.internal.pageSize.width-this.margin[1],F=R-this.margin[3],N=1===v?0:M+(v-2)*D;if(0!==this.ctx.clip_path.length){var B=this.path;d=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=I(d,this.posX+this.margin[3],-1*N+T),w.call(this,"fill",!0),this.path=B}var k=I([JSON.parse(JSON.stringify(g))],this.posX+this.margin[3],-N+T+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(c=this.pdf.internal.getFontSize(),this.pdf.setFontSize(c*e.scale),p=this.lineWidth,this.lineWidth=p*e.scale);var O="text"!==this.autoPaging;if(O||k.y+k.h<=L){if(O||k.y>=T&&k.x<=R){var G=O?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||R-k.x)[0],X=I([JSON.parse(JSON.stringify(f))],this.posX+this.margin[3],-N+T+this.ctx.prevPageLastElemOffset)[0],V=O&&(v>_||v<P)&&C.call(this);V&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],F,D,null).clip().discardPath()),this.pdf.text(G,X.x,X.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),V&&this.pdf.restoreGraphicsState()}}else k.y<L&&(this.ctx.prevPageLastElemOffset+=L-k.y);e.scale>=.01&&(this.pdf.setFontSize(c),this.lineWidth=p)}else e.scale>=.01&&(c=this.pdf.internal.getFontSize(),this.pdf.setFontSize(c*e.scale),p=this.lineWidth,this.lineWidth=p*e.scale),this.pdf.text(e.text,l.x+this.posX,l.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(c),this.lineWidth=p)},D=function(e,t,i,l){i=i||0,l=l||0,this.pdf.internal.out(n(e+i)+" "+r(t+l)+" l")},R=function(e,t,n){return this.pdf.lines(e,t,n,null,null)},F=function(e,n,r,i,o,a,u,h){this.pdf.internal.out([t(l(r+e)),t(s(i+n)),t(l(o+e)),t(s(a+n)),t(l(u+e)),t(s(h+n)),"c"].join(" "))},N=function(e,t,n,r){for(var i=2*Math.PI,l=Math.PI/2;t>n;)t-=i;var s=Math.abs(n-t);s<i&&r&&(s=i-s);for(var o=[],a=r?-1:1,u=t;s>1e-5;){var h=u+a*Math.min(s,l);o.push(B.call(this,e,u,h)),s-=Math.abs(h-u),u=h}return o},B=function(e,t,n){var r=(n-t)/2,i=e*Math.cos(r),l=e*Math.sin(r),s=i,o=-l,a=s*s+o*o,u=a+s*i+o*l,h=4/3*(Math.sqrt(2*a*u)-u)/(s*l-o*i),d=s-h*o,c=o+h*s,p=d,f=-c,g=r+t,m=Math.cos(g),E=Math.sin(g);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:d*m-c*E,y2:d*E+c*m,x3:p*m-f*E,y3:p*E+f*m,x4:e*Math.cos(n),y4:e*Math.sin(n)}},k=function(e){return 180*e/Math.PI},O=function(e,t,n,r,i,l){var s=e+.5*(n-e),o=t+.5*(r-t),a=i+.5*(n-i),h=l+.5*(r-l),d=Math.min(e,i,s,a),c=Math.max(e,i,s,a),p=Math.min(t,l,o,h),f=Math.max(t,l,o,h);return new u(d,p,c-d,f-p)},G=function(e,t,n,r,i,l,s,o){var a,h,d,c,p,f,g,m,E,C,A,y,I,S,_=n-e,w=r-t,b=i-n,x=l-r,P=s-i,v=o-l;for(h=0;h<41;h++)E=(g=(d=e+(a=h/40)*_)+a*((p=n+a*b)-d))+a*(p+a*(i+a*P-p)-g),C=(m=(c=t+a*w)+a*((f=r+a*x)-c))+a*(f+a*(l+a*v-f)-m),0==h?(A=E,y=C,I=E,S=C):(A=Math.min(A,E),y=Math.min(y,C),I=Math.max(I,E),S=Math.max(S,C));return new u(Math.round(A),Math.round(y),Math.round(I-A),Math.round(S-y))},X=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,n=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==n&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=n)}}}(G.API),function(e){var t=function(e){var t,n,r,i,l,s,o,a,u,h;for(/[^\x00-\xFF]/.test(e),n=[],r=0,i=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;i>r;r+=4)0!==(l=(e.charCodeAt(r)<<24)+(e.charCodeAt(r+1)<<16)+(e.charCodeAt(r+2)<<8)+e.charCodeAt(r+3))?(s=(l=((l=((l=((l=(l-(h=l%85))/85)-(u=l%85))/85)-(a=l%85))/85)-(o=l%85))/85)%85,n.push(s+33,o+33,a+33,u+33,h+33)):n.push(122);return function(e,t){for(var n=t;n>0;n--)e.pop()}(n,t.length),String.fromCharCode.apply(String,n)+"~>"},n=function(e){var t,n,r,i,l,s=String,o="length",a=255,u="charCodeAt",h="slice",d="replace";for(e[h](-2),e=e[h](0,-2)[d](/\s/g,"")[d]("z","!!!!!"),r=[],i=0,l=(e+=t="uuuuu"[h](e[o]%5||5))[o];l>i;i+=5)n=52200625*(e[u](i)-33)+614125*(e[u](i+1)-33)+7225*(e[u](i+2)-33)+85*(e[u](i+3)-33)+(e[u](i+4)-33),r.push(a&n>>24,a&n>>16,a&n>>8,a&n);return function(e,t){for(var n=t;n>0;n--)e.pop()}(r,t[o]),s.fromCharCode.apply(s,r)},r=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var n="",r=0;r<e.length;r+=2)n+=String.fromCharCode("0x"+(e[r]+e[r+1]));return n},i=function(e){for(var t=new Uint8Array(e.length),n=e.length;n--;)t[n]=e.charCodeAt(n);return(t=Object(l.b)(t)).reduce((function(e,t){return e+String.fromCharCode(t)}),"")};e.processDataByFilters=function(e,l){var s=0,o=e||"",a=[];for("string"==typeof(l=l||[])&&(l=[l]),s=0;s<l.length;s+=1)switch(l[s]){case"ASCII85Decode":case"/ASCII85Decode":o=n(o),a.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":o=t(o),a.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":o=r(o),a.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":o=o.split("").map((function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)})).join("")+">",a.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":o=i(o),a.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[s]+'" is not implemented')}return{data:o,reverseChain:a.reverse().join(" ")}}}(G.API),function(e){e.loadFile=function(e,t,n){return function(e,t,n){t=!1!==t,n="function"==typeof n?n:function(){};var r=void 0;try{r=function(e,t,n){var r=new XMLHttpRequest,i=0,l=function(e){var t=e.length,n=[],r=String.fromCharCode;for(i=0;i<t;i+=1)n.push(r(255&e.charCodeAt(i)));return n.join("")};if(r.open("GET",e,!t),r.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(r.onload=function(){200===r.status?n(l(this.responseText)):n(void 0)}),r.send(null),t&&200===r.status)return l(r.responseText)}(e,t,n)}catch(e){}return r}(e,t,n)},e.loadImageFile=e.loadFile}(G.API),function(e){function t(){return(s.html2canvas?Promise.resolve(s.html2canvas):Promise.resolve().then(n.t.bind(null,1194,7))).catch((function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))})).then((function(e){return e.default?e.default:e}))}function r(){return(s.DOMPurify?Promise.resolve(s.DOMPurify):Promise.resolve().then(n.t.bind(null,1195,7))).catch((function(e){return Promise.reject(new Error("Could not load dompurify: "+e))})).then((function(e){return e.default?e.default:e}))}var l=function(e){var t=i()(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},o=function(e,t){var n=document.createElement(e);for(var r in t.className&&(n.className=t.className),t.innerHTML&&t.dompurify&&(n.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)n.style[r]=t.style[r];return n},a=function e(t){var n=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),r=e.convert(Promise.resolve(),n);return(r=r.setProgress(1,e,1,[e])).set(t)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(e,t){return e.__proto__=t||a.prototype,e},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(e,t){return this.then((function(){switch(t=t||function(e){switch(l(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e)){case"string":return this.then(r).then((function(t){return this.set({src:o("div",{innerHTML:e,dompurify:t})})}));case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}}))},a.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=function e(t,n){for(var r=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),i=t.firstChild;i;i=i.nextSibling)!0!==n&&1===i.nodeType&&"SCRIPT"===i.nodeName||r.appendChild(e(i,n));return 1===t.nodeType&&("CANVAS"===t.nodeName?(r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(r.value=t.value),r.addEventListener("load",(function(){r.scrollTop=t.scrollTop,r.scrollLeft=t.scrollLeft}),!0)),r}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},a.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then((function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)})).then((function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)}))},a.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then((function(e){var t=this.opt.jsPDF,n=this.opt.fontFaces,r="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,i=Object.assign({async:!0,allowTaint:!0,scale:r,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete i.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=n,n)for(var l=0;l<n.length;++l){var s=n[l],o=s.src.find((function(e){return"truetype"===e.format}));o&&t.addFont(o.url,s.ref.name,s.ref.style)}return i.windowHeight=i.windowHeight||0,i.windowHeight=0==i.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):i.windowHeight,t.context2d.save(!0),e(this.prop.container,i)})).then((function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)}))},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e}))},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},a.prototype.output=function(e,t,n){return"img"===(n=n||"pdf").toLowerCase()||"image"===n.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},a.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(e,t)}))},a.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}}))},a.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},a.prototype.set=function(e){if("object"!==l(e))return this;var t=Object.keys(e||{}).map((function(t){if(t in a.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}}),this);return this.then((function(){return this.thenList(t)}))},a.prototype.get=function(e,t){return this.then((function(){var n=e in a.template.prop?this.prop[e]:this.opt[e];return t?t(n):n}))},a.prototype.setMargin=function(e){return this.then((function(){switch(l(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e})).then(this.setPageSize)},a.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then((function(){(e=e||G.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e}))},a.prototype.setProgress=function(e,t,n,r){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=n&&(this.progress.n=n),null!=r&&(this.progress.stack=r),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(e,t,n,r){return this.setProgress(e?this.progress.val+e:null,t||null,n?this.progress.n+n:null,r?this.progress.stack.concat(r):null)},a.prototype.then=function(e,t){var n=this;return this.thenCore(e,t,(function(e,t){return n.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,(function(t){return n.updateProgress(null,e),t})).then(e,t).then((function(e){return n.updateProgress(1),e}))}))},a.prototype.thenCore=function(e,t,n){n=n||Promise.prototype.then,e&&(e=e.bind(this)),t&&(t=t.bind(this));var r=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:a.convert(Object.assign({},this),Promise.prototype),i=n.call(r,e,t);return a.convert(i,this.__proto__)},a.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},a.prototype.thenList=function(e){var t=this;return e.forEach((function(e){t=t.thenCore(e)})),t},a.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return a.convert(t,this)},a.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},a.prototype.error=function(e){return this.then((function(){throw new Error(e)}))},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,G.getPageSize=function(e,t,n){if("object"===i()(e)){var r=e;e=r.orientation,t=r.unit||t,n=r.format||n}t=t||"mm",n=n||"a4",e=(""+(e||"P")).toLowerCase();var l,s=(""+n).toLowerCase(),o={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":l=1;break;case"mm":l=72/25.4;break;case"cm":l=72/2.54;break;case"in":l=72;break;case"px":l=.75;break;case"pc":case"em":l=12;break;case"ex":l=6;break;default:throw"Invalid unit: "+t}var a,u=0,h=0;if(o.hasOwnProperty(s))u=o[s][1]/l,h=o[s][0]/l;else try{u=n[1],h=n[0]}catch(e){throw new Error("Invalid format: "+n)}if("p"===e||"portrait"===e)e="p",h>u&&(a=h,h=u,u=a);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",u>h&&(a=h,h=u,u=a)}return{width:h,height:u,unit:t,k:l,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(Be):null;var n=new a(t);return t.worker?n:n.from(e).doCallback()}}(G.API),G.API.addJS=function(e){return ze=e,this.internal.events.subscribe("postPutResources",(function(){We=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(We+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),je=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+ze+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){void 0!==We&&void 0!==je&&this.internal.out("/Names <</JavaScript "+We+" 0 R>>")})),this},function(e){var t;e.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=e.outline.render().split(/\r\n/),i=0;i<r.length;i++){var l=r[i],s=n.exec(l);if(null!=s){var o=s[1];e.internal.newObjectDeferredBegin(o,!1)}e.internal.write(l)}if(this.outline.createNamedDestinations){var a=this.internal.pages.length,u=[];for(i=0;i<a;i++){var h=e.internal.newObject();u.push(h);var d=e.internal.getPageInfo(i+1);e.internal.write("<< /D["+d.objId+" 0 R /XYZ null null null]>> endobj")}var c=e.internal.newObject();for(e.internal.write("<< /Names [ "),i=0;i<u.length;i++)e.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+c+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,n){var r={title:t,options:n,children:[]};return null==e&&(e=this.root),e.children.push(r),r},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var n=0;n<t.children.length;n++)this.genIds_r(t.children[n])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<t.children.length;r++){var i=t.children[r];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(t)),r>0&&this.line("/Prev "+this.makeRef(t.children[r-1])),r<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[r+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var l=this.count=this.count_r({count:0},i);if(l>0&&this.line("/Count "+l),i.options&&i.options.pageNumber){var s=e.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+s.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var o=0;o<t.children.length;o++)this.renderItems(t.children[o])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var n=0;n<t.children.length;n++)e.count++,this.count_r(e,t.children[n]);return e.count}}])}(G.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,n,r,i,l,s){var o,a=this.decode.DCT_DECODE,u=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=l||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(o=function(e){for(var n,r=256*e.charCodeAt(4)+e.charCodeAt(5),i=e.length,l={width:0,height:0,numcomponents:1},s=4;s<i;s+=2){if(s+=r,-1!==t.indexOf(e.charCodeAt(s+1))){n=256*e.charCodeAt(s+5)+e.charCodeAt(s+6),l={width:256*e.charCodeAt(s+7)+e.charCodeAt(s+8),height:n,numcomponents:e.charCodeAt(s+9)};break}r=256*e.charCodeAt(s+2)+e.charCodeAt(s+3)}return l}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:s=this.color_spaces.DEVICE_GRAY;break;case 4:s=this.color_spaces.DEVICE_CMYK;break;case 3:s=this.color_spaces.DEVICE_RGB}u={data:e,width:o.width,height:o.height,colorSpace:s,bitsPerComponent:8,filter:a,index:n,alias:r}}return u}}(G.API);var Qe,Ke,qe,Je,Ze,$e=function(){var e,t,n;function r(e){var t,n,r,i,l,s,o,a,u,h,d,c,p,f;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},s=null;;){switch(t=this.readUInt32(),u=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":s&&this.animation.frames.push(s),this.pos+=4,s={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},l=this.readUInt16(),i=this.readUInt16()||100,s.delay=1e3*l/i,s.disposeOp=this.data[this.pos++],s.blendOp=this.data[this.pos++],s.data=[];break;case"IDAT":case"fdAT":for("fdAT"===u&&(this.pos+=4,t-=4),e=(null!=s?s.data:void 0)||this.imgData,c=0;0<=t?c<t:c>t;0<=t?++c:--c)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(r=this.palette.length/3,this.transparency.indexed=this.read(t),this.transparency.indexed.length>r)throw new Error("More transparent colors than palette size");if((h=r-this.transparency.indexed.length)>0)for(p=0;0<=h?p<h:p>h;0<=h?++p:--p)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":o=(d=this.read(t)).indexOf(0),a=String.fromCharCode.apply(String,d.slice(0,o)),this.text[a]=String.fromCharCode.apply(String,d.slice(o+1));break;case"IEND":return s&&this.animation.frames.push(s),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(f=this.colorType)||6===f,n=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*n,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)n.push(this.data[this.pos++]);return n},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(e){var t=this.pixelBitlength/8,n=new Uint8Array(this.width*this.height*t),r=0,i=this;if(null==e&&(e=this.imgData),0===e.length)return new Uint8Array(0);function s(l,s,o,a){var u,h,d,c,p,f,g,m,E,C,A,y,I,S,_,w,b,x,P,v,T,M=Math.ceil((i.width-l)/o),L=Math.ceil((i.height-s)/a),D=i.width==M&&i.height==L;for(S=t*M,y=D?n:new Uint8Array(S*L),f=e.length,I=0,h=0;I<L&&r<f;){switch(e[r++]){case 0:for(c=b=0;b<S;c=b+=1)y[h++]=e[r++];break;case 1:for(c=x=0;x<S;c=x+=1)u=e[r++],p=c<t?0:y[h-t],y[h++]=(u+p)%256;break;case 2:for(c=P=0;P<S;c=P+=1)u=e[r++],d=(c-c%t)/t,_=I&&y[(I-1)*S+d*t+c%t],y[h++]=(_+u)%256;break;case 3:for(c=v=0;v<S;c=v+=1)u=e[r++],d=(c-c%t)/t,p=c<t?0:y[h-t],_=I&&y[(I-1)*S+d*t+c%t],y[h++]=(u+Math.floor((p+_)/2))%256;break;case 4:for(c=T=0;T<S;c=T+=1)u=e[r++],d=(c-c%t)/t,p=c<t?0:y[h-t],0===I?_=w=0:(_=y[(I-1)*S+d*t+c%t],w=d&&y[(I-1)*S+(d-1)*t+c%t]),g=p+_-w,m=Math.abs(g-p),C=Math.abs(g-_),A=Math.abs(g-w),E=m<=C&&m<=A?p:C<=A?_:w,y[h++]=(u+E)%256;break;default:throw new Error("Invalid filter algorithm: "+e[r-1])}if(!D){var R=((s+I*a)*i.width+l)*t,F=I*S;for(c=0;c<M;c+=1){for(var N=0;N<t;N+=1)n[R++]=y[F++];R+=(o-1)*t}}I++}}return e=Object(l.a)(e),1==i.interlaceMethod?(s(0,0,8,8),s(4,0,8,8),s(0,4,4,8),s(2,0,4,4),s(0,2,2,4),s(1,0,2,2),s(0,1,1,2)):s(0,0,1,1),n},r.prototype.decodePalette=function(){var e,t,n,r,i,l,s,o,a;for(n=this.palette,l=this.transparency.indexed||[],i=new Uint8Array((l.length||0)+n.length),r=0,e=0,t=s=0,o=n.length;s<o;t=s+=3)i[r++]=n[t],i[r++]=n[t+1],i[r++]=n[t+2],i[r++]=null!=(a=l[e++])?a:255;return i},r.prototype.copyToImageData=function(e,t){var n,r,i,l,s,o,a,u,h,d,c;if(r=this.colors,h=null,n=this.hasAlphaChannel,this.palette.length&&(h=null!=(c=this._decodedPalette)?c:this._decodedPalette=this.decodePalette(),r=4,n=!0),u=(i=e.data||e).length,s=h||t,l=o=0,1===r)for(;l<u;)a=h?4*t[l/4]:o,d=s[a++],i[l++]=d,i[l++]=d,i[l++]=d,i[l++]=n?s[a++]:255,o=a;else for(;l<u;)a=h?4*t[l/4]:o,i[l++]=s[a++],i[l++]=s[a++],i[l++]=s[a++],i[l++]=n?s[a++]:255,o=a},r.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e};var i=function(){if("[object Window]"===Object.prototype.toString.call(s)){try{t=s.document.createElement("canvas"),n=t.getContext("2d")}catch(e){return!1}return!0}return!1};return i(),e=function(e){var r;if(!0===i())return n.width=e.width,n.height=e.height,n.clearRect(0,0,e.width,e.height),n.putImageData(e,0,0),(r=new Image).src=t.toDataURL(),r;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(t){var n,r,i,l,s,o,a,u;if(this.animation){for(u=[],r=s=0,o=(a=this.animation.frames).length;s<o;r=++s)n=a[r],i=t.createImageData(n.width,n.height),l=this.decodePixels(new Uint8Array(n.data)),this.copyToImageData(i,l),n.imageData=i,u.push(n.image=e(i));return u}},r.prototype.renderFrame=function(e,t){var n,r,i;return n=(r=this.animation.frames)[t],i=r[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=i?i.disposeOp:void 0)?e.clearRect(i.xOffset,i.yOffset,i.width,i.height):2===(null!=i?i.disposeOp:void 0)&&e.putImageData(i.imageData,i.xOffset,i.yOffset),0===n.blendOp&&e.clearRect(n.xOffset,n.yOffset,n.width,n.height),e.drawImage(n.image,n.xOffset,n.yOffset)},r.prototype.animate=function(e){var t,n,r,i,l,s,o=this;return n=0,s=this.animation,i=s.numFrames,r=s.frames,l=s.numPlays,(t=function(){var s,a;if(s=n++%i,a=r[s],o.renderFrame(e,s),i>1&&n/i<l)return o.animation._timeout=setTimeout(t,a.delay)})()},r.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},r.prototype.render=function(e){var t,n;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(n=t.createImageData(this.width,this.height),this.copyToImageData(n,this.decodePixels()),t.putImageData(n,0,0))},r}();function et(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,i=e[t++],l=i>>7,s=1<<1+(7&i);e[t++],e[t++];var o=null,a=null;l&&(o=t,a=s,t+=3*s);var u=!0,h=[],d=0,c=null,p=0,f=null;for(this.width=n,this.height=r;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,f=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((P=e[t++])>=0))throw Error("Invalid block size");if(0===P)break;t+=P}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var g=e[t++];d=e[t++]|e[t++]<<8,c=e[t++],0==(1&g)&&(c=null),p=g>>2&7,t++;break;case 254:for(;;){if(!((P=e[t++])>=0))throw Error("Invalid block size");if(0===P)break;t+=P}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var m=e[t++]|e[t++]<<8,E=e[t++]|e[t++]<<8,C=e[t++]|e[t++]<<8,A=e[t++]|e[t++]<<8,y=e[t++],I=y>>6&1,S=1<<1+(7&y),_=o,w=a,b=!1;y>>7&&(b=!0,_=t,w=S,t+=3*S);var x=t;for(t++;;){var P;if(!((P=e[t++])>=0))throw Error("Invalid block size");if(0===P)break;t+=P}h.push({x:m,y:E,width:C,height:A,has_local_palette:b,palette_offset:_,palette_size:w,data_offset:x,data_length:t-x,transparent_index:c,interlaced:!!I,delay:d,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return f},this.frameInfo=function(e){if(e<0||e>=h.length)throw new Error("Frame index out of range.");return h[e]},this.decodeAndBlitFrameBGRA=function(t,r){var i=this.frameInfo(t),l=i.width*i.height,s=new Uint8Array(l);tt(e,i.data_offset,s,l);var o=i.palette_offset,a=i.transparent_index;null===a&&(a=256);var u=i.width,h=n-u,d=u,c=4*(i.y*n+i.x),p=4*((i.y+i.height)*n+i.x),f=c,g=4*h;!0===i.interlaced&&(g+=4*n*7);for(var m=8,E=0,C=s.length;E<C;++E){var A=s[E];if(0===d&&(d=u,(f+=g)>=p&&(g=4*h+4*n*(m-1),f=c+(u+h)*(m<<1),m>>=1)),A===a)f+=4;else{var y=e[o+3*A],I=e[o+3*A+1],S=e[o+3*A+2];r[f++]=S,r[f++]=I,r[f++]=y,r[f++]=255}--d}},this.decodeAndBlitFrameRGBA=function(t,r){var i=this.frameInfo(t),l=i.width*i.height,s=new Uint8Array(l);tt(e,i.data_offset,s,l);var o=i.palette_offset,a=i.transparent_index;null===a&&(a=256);var u=i.width,h=n-u,d=u,c=4*(i.y*n+i.x),p=4*((i.y+i.height)*n+i.x),f=c,g=4*h;!0===i.interlaced&&(g+=4*n*7);for(var m=8,E=0,C=s.length;E<C;++E){var A=s[E];if(0===d&&(d=u,(f+=g)>=p&&(g=4*h+4*n*(m-1),f=c+(u+h)*(m<<1),m>>=1)),A===a)f+=4;else{var y=e[o+3*A],I=e[o+3*A+1],S=e[o+3*A+2];r[f++]=y,r[f++]=I,r[f++]=S,r[f++]=255}--d}}}function tt(e,t,n,r){for(var i=e[t++],l=1<<i,s=l+1,o=s+1,u=i+1,h=(1<<u)-1,d=0,c=0,p=0,f=e[t++],g=new Int32Array(4096),m=null;;){for(;d<16&&0!==f;)c|=e[t++]<<d,d+=8,1===f?f=e[t++]:--f;if(d<u)break;var E=c&h;if(c>>=u,d-=u,E!==l){if(E===s)break;for(var C=E<o?E:m,A=0,y=C;y>l;)y=g[y]>>8,++A;var I=y;if(p+A+(C!==E?1:0)>r)return void a.log("Warning, gif stream longer than expected.");n[p++]=I;var S=p+=A;for(C!==E&&(n[p++]=I),y=C;A--;)y=g[y],n[--S]=255&y,y>>=8;null!==m&&o<4096&&(g[o++]=m<<8|I,o>=h+1&&u<12&&(++u,h=h<<1|1)),m=E}else o=s+1,h=(1<<(u=i+1))-1,m=null}return p!==r&&a.log("Warning, gif stream shorter than expected."),n}function nt(e){var t,n,r,i,l,s=Math.floor,o=new Array(64),a=new Array(64),u=new Array(64),h=new Array(64),d=new Array(65535),c=new Array(65535),p=new Array(64),f=new Array(64),g=[],m=0,E=7,C=new Array(64),A=new Array(64),y=new Array(64),I=new Array(256),S=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],w=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],b=[0,1,2,3,4,5,6,7,8,9,10,11],x=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],P=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],v=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],L=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function D(e,t){for(var n=0,r=0,i=new Array,l=1;l<=16;l++){for(var s=1;s<=e[l];s++)i[t[r]]=[],i[t[r]][0]=n,i[t[r]][1]=l,r++,n++;n*=2}return i}function R(e){for(var t=e[0],n=e[1]-1;n>=0;)t&1<<n&&(m|=1<<E),n--,--E<0&&(255==m?(F(255),F(0)):F(m),E=7,m=0)}function F(e){g.push(e)}function N(e){F(e>>8&255),F(255&e)}function B(e,t,n,r,i){for(var l,s=i[0],o=i[240],a=function(e,t){var n,r,i,l,s,o,a,u,h,d,c=0;for(h=0;h<8;++h){n=e[c],r=e[c+1],i=e[c+2],l=e[c+3],s=e[c+4],o=e[c+5],a=e[c+6];var f=n+(u=e[c+7]),g=n-u,m=r+a,E=r-a,C=i+o,A=i-o,y=l+s,I=l-s,S=f+y,_=f-y,w=m+C,b=m-C;e[c]=S+w,e[c+4]=S-w;var x=.707106781*(b+_);e[c+2]=_+x,e[c+6]=_-x;var P=.382683433*((S=I+A)-(b=E+g)),v=.5411961*S+P,T=1.306562965*b+P,M=.707106781*(w=A+E),L=g+M,D=g-M;e[c+5]=D+v,e[c+3]=D-v,e[c+1]=L+T,e[c+7]=L-T,c+=8}for(c=0,h=0;h<8;++h){n=e[c],r=e[c+8],i=e[c+16],l=e[c+24],s=e[c+32],o=e[c+40],a=e[c+48];var R=n+(u=e[c+56]),F=n-u,N=r+a,B=r-a,k=i+o,O=i-o,G=l+s,X=l-s,V=R+G,H=R-G,U=N+k,W=N-k;e[c]=V+U,e[c+32]=V-U;var j=.707106781*(W+H);e[c+16]=H+j,e[c+48]=H-j;var z=.382683433*((V=X+O)-(W=B+F)),Y=.5411961*V+z,Q=1.306562965*W+z,K=.707106781*(U=O+B),q=F+K,J=F-K;e[c+40]=J+Y,e[c+24]=J-Y,e[c+8]=q+Q,e[c+56]=q-Q,c++}for(h=0;h<64;++h)d=e[h]*t[h],p[h]=d>0?d+.5|0:d-.5|0;return p}(e,t),u=0;u<64;++u)f[_[u]]=a[u];var h=f[0]-n;n=f[0],0==h?R(r[0]):(R(r[c[l=32767+h]]),R(d[l]));for(var g=63;g>0&&0==f[g];)g--;if(0==g)return R(s),n;for(var m,E=1;E<=g;){for(var C=E;0==f[E]&&E<=g;)++E;var A=E-C;if(A>=16){m=A>>4;for(var y=1;y<=m;++y)R(o);A&=15}l=32767+f[E],R(i[(A<<4)+c[l]]),R(d[l]),E++}return 63!=g&&R(s),n}function k(e){e=Math.min(Math.max(e,1),100),l!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var r=s((t[n]*e+50)/100);r=Math.min(Math.max(r,1),255),o[_[n]]=r}for(var i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],l=0;l<64;l++){var d=s((i[l]*e+50)/100);d=Math.min(Math.max(d,1),255),a[_[l]]=d}for(var c=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],p=0,f=0;f<8;f++)for(var g=0;g<8;g++)u[p]=1/(o[_[p]]*c[f]*c[g]*8),h[p]=1/(a[_[p]]*c[f]*c[g]*8),p++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),l=e)}this.encode=function(e,l){l&&k(l),g=new Array,m=0,E=7,N(65496),N(65504),N(16),F(74),F(70),F(73),F(70),F(0),F(1),F(1),F(0),N(1),N(1),F(0),F(0),function(){N(65499),N(132),F(0);for(var e=0;e<64;e++)F(o[e]);F(1);for(var t=0;t<64;t++)F(a[t])}(),function(e,t){N(65472),N(17),F(8),N(t),N(e),F(3),F(1),F(17),F(0),F(2),F(17),F(1),F(3),F(17),F(1)}(e.width,e.height),function(){N(65476),N(418),F(0);for(var e=0;e<16;e++)F(w[e+1]);for(var t=0;t<=11;t++)F(b[t]);F(16);for(var n=0;n<16;n++)F(x[n+1]);for(var r=0;r<=161;r++)F(P[r]);F(1);for(var i=0;i<16;i++)F(v[i+1]);for(var l=0;l<=11;l++)F(T[l]);F(17);for(var s=0;s<16;s++)F(M[s+1]);for(var o=0;o<=161;o++)F(L[o])}(),N(65498),N(12),F(3),F(1),F(0),F(2),F(17),F(3),F(17),F(0),F(63),F(0);var s=0,d=0,c=0;m=0,E=7,this.encode.displayName="_encode_";for(var p,f,I,_,D,O,G,X,V,H=e.data,U=e.width,W=e.height,j=4*U,z=0;z<W;){for(p=0;p<j;){for(D=j*z+p,G=-1,X=0,V=0;V<64;V++)O=D+(X=V>>3)*j+(G=4*(7&V)),z+X>=W&&(O-=j*(z+1+X-W)),p+G>=j&&(O-=p+G-j+4),f=H[O++],I=H[O++],_=H[O++],C[V]=(S[f]+S[I+256>>0]+S[_+512>>0]>>16)-128,A[V]=(S[f+768>>0]+S[I+1024>>0]+S[_+1280>>0]>>16)-128,y[V]=(S[f+1280>>0]+S[I+1536>>0]+S[_+1792>>0]>>16)-128;s=B(C,u,s,t,r),d=B(A,h,d,n,i),c=B(y,h,c,n,i),p+=32}z+=8}if(E>=0){var Y=[];Y[1]=E+1,Y[0]=(1<<E+1)-1,R(Y)}return N(65497),new Uint8Array(g)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)I[t]=e(t)}(),t=D(w,b),n=D(v,T),r=D(x,P),i=D(M,L),function(){for(var e=1,t=2,n=1;n<=15;n++){for(var r=e;r<t;r++)c[32767+r]=n,d[32767+r]=[],d[32767+r][1]=n,d[32767+r][0]=r;for(var i=-(t-1);i<=-e;i++)c[32767+i]=n,d[32767+i]=[],d[32767+i][1]=n,d[32767+i][0]=t-1+i;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)S[e]=19595*e,S[e+256>>0]=38470*e,S[e+512>>0]=7471*e+32768,S[e+768>>0]=-11059*e,S[e+1024>>0]=-21709*e,S[e+1280>>0]=32768*e+8421375,S[e+1536>>0]=-27439*e,S[e+1792>>0]=-5329*e}(),k(e)}function rt(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function it(e){function t(e){if(!e)throw Error("assert :P")}function n(e,t,n){for(var r=0;4>r;r++)if(e[t+r]!=n.charCodeAt(r))return!0;return!1}function r(e,t,n,r,i){for(var l=0;l<i;l++)e[t+l]=n[r+l]}function i(e,t,n,r){for(var i=0;i<r;i++)e[t+i]=n}function l(e){return new Int32Array(e)}function s(e,t){for(var n=[],r=0;r<e;r++)n.push(new t);return n}function o(e,t){var n=[];return function e(n,r,i){for(var l=i[r],s=0;s<l&&(n.push(i.length>r+1?[]:new t),!(i.length<r+1));s++)e(n[s],r+1,i)}(n,0,e),n}var a=function(){var e=this;function a(e,t){for(var n=1<<t-1>>>0;e&n;)n>>>=1;return n?(e&n-1)+n:e}function u(e,n,r,i,l){t(!(i%r));do{e[n+(i-=r)]=l}while(0<i)}function h(e,n,r,i,s){if(t(2328>=s),512>=s)var o=l(512);else if(null==(o=l(s)))return 0;return function(e,n,r,i,s,o){var h,c,p=n,f=1<<r,g=l(16),m=l(16);for(t(0!=s),t(null!=i),t(null!=e),t(0<r),c=0;c<s;++c){if(15<i[c])return 0;++g[i[c]]}if(g[0]==s)return 0;for(m[1]=0,h=1;15>h;++h){if(g[h]>1<<h)return 0;m[h+1]=m[h]+g[h]}for(c=0;c<s;++c)h=i[c],0<i[c]&&(o[m[h]++]=c);if(1==m[15])return(i=new d).g=0,i.value=o[0],u(e,p,1,f,i),f;var E,C=-1,A=f-1,y=0,I=1,S=1,_=1<<r;for(c=0,h=1,s=2;h<=r;++h,s<<=1){if(I+=S<<=1,0>(S-=g[h]))return 0;for(;0<g[h];--g[h])(i=new d).g=h,i.value=o[c++],u(e,p+y,s,_,i),y=a(y,h)}for(h=r+1,s=2;15>=h;++h,s<<=1){if(I+=S<<=1,0>(S-=g[h]))return 0;for(;0<g[h];--g[h]){if(i=new d,(y&A)!=C){for(p+=_,E=1<<(C=h)-r;15>C&&!(0>=(E-=g[C]));)++C,E<<=1;f+=_=1<<(E=C-r),e[n+(C=y&A)].g=E+r,e[n+C].value=p-n-C}i.g=h-r,i.value=o[c++],u(e,p+(y>>r),s,_,i),y=a(y,h)}}return I!=2*m[15]-1?0:f}(e,n,r,i,s,o)}function d(){this.value=this.g=0}function c(){this.value=this.g=0}function p(){this.G=s(5,d),this.H=l(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Gn,c)}function f(e,n,r,i){t(null!=e),t(null!=n),t(2147483648>i),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=n,e.pa=r,e.Jd=n,e.Yc=r+i,e.Zc=4<=i?r+i-4+1:r,x(e)}function g(e,t){for(var n=0;0<t--;)n|=v(e,128)<<t;return n}function m(e,t){var n=g(e,t);return P(e)?-n:n}function E(e,n,r,i){var l,s=0;for(t(null!=e),t(null!=n),t(4294967288>i),e.Sb=i,e.Ra=0,e.u=0,e.h=0,4<i&&(i=4),l=0;l<i;++l)s+=n[r+l]<<8*l;e.Ra=s,e.bb=i,e.oa=n,e.pa=r}function C(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<Hn-8>>>0,++e.bb,e.u-=8;_(e)&&(e.h=1,e.u=0)}function A(e,n){if(t(0<=n),!e.h&&n<=Vn){var r=S(e)&Xn[n];return e.u+=n,C(e),r}return e.h=1,e.u=0}function y(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function I(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function S(e){return e.Ra>>>(e.u&Hn-1)>>>0}function _(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>Hn}function w(e,t){e.u=t,e.h=_(e)}function b(e){e.u>=Un&&(t(e.u>=Un),C(e))}function x(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function P(e){return g(e,1)}function v(e,t){var n=e.Ca;0>e.b&&x(e);var r=e.b,i=n*t>>>8,l=(e.I>>>r>i)+0;for(l?(n-=i,e.I-=i+1<<r>>>0):n=i+1,r=n,i=0;256<=r;)i+=8,r>>=8;return r=7^i+Wn[r],e.b-=r,e.Ca=(n<<r)-1,l}function T(e,t,n){e[t+0]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=n>>0&255}function M(e,t){return e[t+0]<<0|e[t+1]<<8}function L(e,t){return M(e,t)|e[t+2]<<16}function D(e,t){return M(e,t)|M(e,t+2)<<16}function R(e,n){var r=1<<n;return t(null!=e),t(0<n),e.X=l(r),null==e.X?0:(e.Mb=32-n,e.Xa=n,1)}function F(e,n){t(null!=e),t(null!=n),t(e.Xa==n.Xa),r(n.X,0,e.X,0,1<<n.Xa)}function N(){this.X=[],this.Xa=this.Mb=0}function B(e,n,r,i){t(null!=r),t(null!=i);var l=r[0],s=i[0];return 0==l&&(l=(e*s+n/2)/n),0==s&&(s=(n*l+e/2)/e),0>=l||0>=s?0:(r[0]=l,i[0]=s,1)}function k(e,t){return e+(1<<t)-1>>>t}function O(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function G(t,n){e[n]=function(n,r,i,l,s,o,a){var u;for(u=0;u<s;++u){var h=e[t](o[a+u-1],i,l+u);o[a+u]=O(n[r+u],h)}}}function X(){this.ud=this.hd=this.jd=0}function V(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function H(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function U(e,t){return H(e+(e-t+.5>>1))}function W(e,t,n){return Math.abs(t-n)-Math.abs(e-n)}function j(e,t,n,r,i,l,s){for(r=l[s-1],n=0;n<i;++n)l[s+n]=r=O(e[t+n],r)}function z(e,t,n,r,i){var l;for(l=0;l<n;++l){var s=e[t+l],o=s>>8&255,a=16711935&(a=(a=16711935&s)+((o<<16)+o));r[i+l]=(4278255360&s)+a>>>0}}function Y(e,t){t.jd=e>>0&255,t.hd=e>>8&255,t.ud=e>>16&255}function Q(e,t,n,r,i,l){var s;for(s=0;s<r;++s){var o=t[n+s],a=o>>>8,u=o,h=255&(h=(h=o>>>16)+((e.jd<<24>>24)*(a<<24>>24)>>>5));u=255&(u=(u+=(e.hd<<24>>24)*(a<<24>>24)>>>5)+((e.ud<<24>>24)*(h<<24>>24)>>>5)),i[l+s]=(4278255360&o)+(h<<16)+u}}function K(t,n,r,i,l){e[n]=function(e,t,n,r,s,o,a,u,h){for(r=a;r<u;++r)for(a=0;a<h;++a)s[o++]=l(n[i(e[t++])])},e[t]=function(t,n,s,o,a,u,h){var d=8>>t.b,c=t.Ea,p=t.K[0],f=t.w;if(8>d)for(t=(1<<t.b)-1,f=(1<<d)-1;n<s;++n){var g,m=0;for(g=0;g<c;++g)g&t||(m=i(o[a++])),u[h++]=l(p[m&f]),m>>=d}else e["VP8LMapColor"+r](o,a,p,f,u,h,n,s,c)}}function q(e,t,n,r,i){for(n=t+n;t<n;){var l=e[t++];r[i++]=l>>16&255,r[i++]=l>>8&255,r[i++]=l>>0&255}}function J(e,t,n,r,i){for(n=t+n;t<n;){var l=e[t++];r[i++]=l>>16&255,r[i++]=l>>8&255,r[i++]=l>>0&255,r[i++]=l>>24&255}}function Z(e,t,n,r,i){for(n=t+n;t<n;){var l=(s=e[t++])>>16&240|s>>12&15,s=s>>0&240|s>>28&15;r[i++]=l,r[i++]=s}}function $(e,t,n,r,i){for(n=t+n;t<n;){var l=(s=e[t++])>>16&248|s>>13&7,s=s>>5&224|s>>3&31;r[i++]=l,r[i++]=s}}function ee(e,t,n,r,i){for(n=t+n;t<n;){var l=e[t++];r[i++]=l>>0&255,r[i++]=l>>8&255,r[i++]=l>>16&255}}function te(e,t,n,i,l,s){if(0==s)for(n=t+n;t<n;)T(i,((s=e[t++])[0]>>24|s[1]>>8&65280|s[2]<<8&16711680|s[3]<<24)>>>0),l+=32;else r(i,l,e,t,n)}function ne(t,n){e[n][0]=e[t+"0"],e[n][1]=e[t+"1"],e[n][2]=e[t+"2"],e[n][3]=e[t+"3"],e[n][4]=e[t+"4"],e[n][5]=e[t+"5"],e[n][6]=e[t+"6"],e[n][7]=e[t+"7"],e[n][8]=e[t+"8"],e[n][9]=e[t+"9"],e[n][10]=e[t+"10"],e[n][11]=e[t+"11"],e[n][12]=e[t+"12"],e[n][13]=e[t+"13"],e[n][14]=e[t+"0"],e[n][15]=e[t+"0"]}function re(e){return e==Ur||e==Wr||e==jr||e==zr}function ie(){this.eb=[],this.size=this.A=this.fb=0}function le(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function se(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ie,this.f.kb=new le,this.sd=null}function oe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ae(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ue(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function he(e,t){var n=e.T,i=t.ba.f.RGBA,l=i.eb,s=i.fb+e.ka*i.A,o=Ei[t.ba.S],a=e.y,u=e.O,h=e.f,d=e.N,c=e.ea,p=e.W,f=t.cc,g=t.dc,m=t.Mc,E=t.Nc,C=e.ka,A=e.ka+e.T,y=e.U,I=y+1>>1;for(0==C?o(a,u,null,null,h,d,c,p,h,d,c,p,l,s,null,null,y):(o(t.ec,t.fc,a,u,f,g,m,E,h,d,c,p,l,s-i.A,l,s,y),++n);C+2<A;C+=2)f=h,g=d,m=c,E=p,d+=e.Rc,p+=e.Rc,s+=2*i.A,o(a,(u+=2*e.fa)-e.fa,a,u,f,g,m,E,h,d,c,p,l,s-i.A,l,s,y);return u+=e.fa,e.j+A<e.o?(r(t.ec,t.fc,a,u,y),r(t.cc,t.dc,h,d,I),r(t.Mc,t.Nc,c,p,I),n--):1&A||o(a,u,null,null,h,d,c,p,h,d,c,p,l,s+i.A,null,null,y),n}function de(e,n,r){var i=e.F,l=[e.J];if(null!=i){var s=e.U,o=n.ba.S,a=o==Xr||o==jr;n=n.ba.f.RGBA;var u=[0],h=e.ka;u[0]=e.T,e.Kb&&(0==h?--u[0]:(--h,l[0]-=e.width),e.j+e.ka+e.T==e.o&&(u[0]=e.o-e.j-h));var d=n.eb;h=n.fb+h*n.A,e=br(i,l[0],e.width,s,u,d,h+(a?0:3),n.A),t(r==u),e&&re(o)&&_r(d,h,a,s,u,n.A)}return 0}function ce(e){var t=e.ma,n=t.ba.S,r=11>n,i=n==kr||n==Gr||n==Xr||n==Vr||12==n||re(n);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!Bn(t.Oa,e,i?11:12))return 0;if(i&&re(n)&&An(),e.da)alert("todo:use_scaling");else{if(r){if(t.Ib=ue,e.Kb){if(n=e.U+1>>1,t.memory=l(e.U+2*n),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+n,t.Ib=he,An()}}else alert("todo:EmitYUV");i&&(t.Jb=de,r&&En())}if(r&&!Li){for(e=0;256>e;++e)Di[e]=89858*(e-128)+xi>>bi,Ni[e]=-22014*(e-128)+xi,Fi[e]=-45773*(e-128),Ri[e]=113618*(e-128)+xi>>bi;for(e=Pi;e<vi;++e)t=76283*(e-16)+xi>>bi,Bi[e-Pi]=je(t,255),ki[e-Pi]=je(t+8>>4,15);Li=1}return 1}function pe(e){var n=e.ma,r=e.U,i=e.T;return t(!(1&e.ka)),0>=r||0>=i?0:(r=n.Ib(e,n),null!=n.Jb&&n.Jb(e,n,r),n.Dc+=r,1)}function fe(e){e.ma.memory=null}function ge(e,t,n,r){return 47!=A(e,8)?0:(t[0]=A(e,14)+1,n[0]=A(e,14)+1,r[0]=A(e,1),0!=A(e,3)?0:!e.h)}function me(e,t){if(4>e)return e+1;var n=e-2>>1;return(2+(1&e)<<n)+A(t,n)+1}function Ee(e,t){return 120<t?t-120:1<=(n=((n=Zr[t-1])>>4)*e+(8-(15&n)))?n:1;var n}function Ce(e,t,n){var r=S(n),i=e[t+=255&r].g-8;return 0<i&&(w(n,n.u+8),r=S(n),t+=e[t].value,t+=r&(1<<i)-1),w(n,n.u+e[t].g),e[t].value}function Ae(e,n,r){return r.g+=e.g,r.value+=e.value<<n>>>0,t(8>=r.g),e.g}function ye(e,n,r){var i=e.xc;return t((n=0==i?0:e.vc[e.md*(r>>i)+(n>>i)])<e.Wb),e.Ya[n]}function Ie(e,n,i,l){var s=e.ab,o=e.c*n,a=e.C;n=a+n;var u=i,h=l;for(l=e.Ta,i=e.Ua;0<s--;){var d=e.gc[s],c=a,p=n,f=u,g=h,m=(h=l,u=i,d.Ea);switch(t(c<p),t(p<=d.nc),d.hc){case 2:Yn(f,g,(p-c)*m,h,u);break;case 0:var E=c,C=p,A=h,y=u,I=(x=d).Ea;0==E&&(jn(f,g,null,null,1,A,y),j(f,g+1,0,0,I-1,A,y+1),g+=I,y+=I,++E);for(var S=1<<x.b,_=S-1,w=k(I,x.b),b=x.K,x=x.w+(E>>x.b)*w;E<C;){var P=b,v=x,T=1;for(zn(f,g,A,y-I,1,A,y);T<I;){var M=(T&~_)+S;M>I&&(M=I),(0,Zn[P[v++]>>8&15])(f,g+ +T,A,y+T-I,M-T,A,y+T),T=M}g+=I,y+=I,++E&_||(x+=w)}p!=d.nc&&r(h,u-m,h,u+(p-c-1)*m,m);break;case 1:for(m=f,C=g,I=(f=d.Ea)-(y=f&~(A=(g=1<<d.b)-1)),E=k(f,d.b),S=d.K,d=d.w+(c>>d.b)*E;c<p;){for(_=S,w=d,b=new X,x=C+y,P=C+f;C<x;)Y(_[w++],b),$n(b,m,C,g,h,u),C+=g,u+=g;C<P&&(Y(_[w++],b),$n(b,m,C,I,h,u),C+=I,u+=I),++c&A||(d+=E)}break;case 3:if(f==h&&g==u&&0<d.b){for(C=h,f=m=u+(p-c)*m-(y=(p-c)*k(d.Ea,d.b)),g=h,A=u,E=[],y=(I=y)-1;0<=y;--y)E[y]=g[A+y];for(y=I-1;0<=y;--y)C[f+y]=E[y];Qn(d,c,p,h,m,h,u)}else Qn(d,c,p,f,g,h,u)}u=l,h=i}h!=i&&r(l,i,u,h,o)}function Se(e,n){var r=e.V,i=e.Ba+e.c*e.C,l=n-e.C;if(t(n<=e.l.o),t(16>=l),0<l){var s=e.l,o=e.Ta,a=e.Ua,u=s.width;if(Ie(e,l,r,i),l=a=[a],t((r=e.C)<(i=n)),t(s.v<s.va),i>s.o&&(i=s.o),r<s.j){var h=s.j-r;r=s.j,l[0]+=h*u}if(r>=i?r=0:(l[0]+=4*s.v,s.ka=r-s.j,s.U=s.va-s.v,s.T=i-r,r=1),r){if(a=a[0],11>(r=e.ca).S){var d=r.f.RGBA,c=(i=r.S,l=s.U,s=s.T,h=d.eb,d.A),p=s;for(d=d.fb+e.Ma*d.A;0<p--;){var f=o,g=a,m=l,E=h,C=d;switch(i){case Br:er(f,g,m,E,C);break;case kr:tr(f,g,m,E,C);break;case Ur:tr(f,g,m,E,C),_r(E,C,0,m,1,0);break;case Or:ir(f,g,m,E,C);break;case Gr:te(f,g,m,E,C,1);break;case Wr:te(f,g,m,E,C,1),_r(E,C,0,m,1,0);break;case Xr:te(f,g,m,E,C,0);break;case jr:te(f,g,m,E,C,0),_r(E,C,1,m,1,0);break;case Vr:nr(f,g,m,E,C);break;case zr:nr(f,g,m,E,C),wr(E,C,m,1,0);break;case Hr:rr(f,g,m,E,C);break;default:t(0)}a+=u,d+=c}e.Ma+=s}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=r.height)}}e.C=n,t(e.C<=e.i)}function _e(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var n=e.Ya[t].G,r=e.Ya[t].H;if(0<n[1][r[1]+0].g||0<n[2][r[2]+0].g||0<n[3][r[3]+0].g)return 0}return 1}function we(e,n,r,i,l,s){if(0!=e.Z){var o=e.qd,a=e.rd;for(t(null!=mi[e.Z]);n<r;++n)mi[e.Z](o,a,i,l,i,l,s),o=i,a=l,l+=s;e.qd=o,e.rd=a}}function be(e,n){var r=e.l.ma,i=0==r.Z||1==r.Z?e.l.j:e.C;if(i=e.C<i?i:e.C,t(n<=e.l.o),n>i){var l=e.l.width,s=r.ca,o=r.tb+l*i,a=e.V,u=e.Ba+e.c*i,h=e.gc;t(1==e.ab),t(3==h[0].hc),qn(h[0],i,n,a,u,s,o),we(r,i,n,s,o,l)}e.C=e.Ma=n}function xe(e,n,r,i,l,s,o){var a=e.$/i,u=e.$%i,h=e.m,d=e.s,c=r+e.$,p=c;l=r+i*l;var f=r+i*s,g=280+d.ua,m=e.Pb?a:16777216,E=0<d.ua?d.Wa:null,C=d.wc,A=c<f?ye(d,u,a):null;t(e.C<s),t(f<=l);var y=!1;e:for(;;){for(;y||c<f;){var I=0;if(a>=m){var x=c-r;t((m=e).Pb),m.wd=m.m,m.xd=x,0<m.s.ua&&F(m.s.Wa,m.s.vb),m=a+ei}if(u&C||(A=ye(d,u,a)),t(null!=A),A.Qb&&(n[c]=A.qb,y=!0),!y)if(b(h),A.jc){I=h,x=n;var P=c,v=A.pd[S(I)&Gn-1];t(A.jc),256>v.g?(w(I,I.u+v.g),x[P]=v.value,I=0):(w(I,I.u+v.g-256),t(256<=v.value),I=v.value),0==I&&(y=!0)}else I=Ce(A.G[0],A.H[0],h);if(h.h)break;if(y||256>I){if(!y)if(A.nd)n[c]=(A.qb|I<<8)>>>0;else{if(b(h),y=Ce(A.G[1],A.H[1],h),b(h),x=Ce(A.G[2],A.H[2],h),P=Ce(A.G[3],A.H[3],h),h.h)break;n[c]=(P<<24|y<<16|I<<8|x)>>>0}if(y=!1,++c,++u>=i&&(u=0,++a,null!=o&&a<=s&&!(a%16)&&o(e,a),null!=E))for(;p<c;)I=n[p++],E.X[(506832829*I&4294967295)>>>E.Mb]=I}else if(280>I){if(I=me(I-256,h),x=Ce(A.G[4],A.H[4],h),b(h),x=Ee(i,x=me(x,h)),h.h)break;if(c-r<x||l-c<I)break e;for(P=0;P<I;++P)n[c+P]=n[c+P-x];for(c+=I,u+=I;u>=i;)u-=i,++a,null!=o&&a<=s&&!(a%16)&&o(e,a);if(t(c<=l),u&C&&(A=ye(d,u,a)),null!=E)for(;p<c;)I=n[p++],E.X[(506832829*I&4294967295)>>>E.Mb]=I}else{if(!(I<g))break e;for(y=I-280,t(null!=E);p<c;)I=n[p++],E.X[(506832829*I&4294967295)>>>E.Mb]=I;I=c,t(!(y>>>(x=E).Xa)),n[I]=x.X[y],y=!0}y||t(h.h==_(h))}if(e.Pb&&h.h&&c<l)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&F(e.s.vb,e.s.Wa);else{if(h.h)break e;null!=o&&o(e,a>s?s:a),e.a=0,e.$=c-r}return 1}return e.a=3,0}function Pe(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var n=e.Wa;null!=n&&(n.X=null),e.vb=null,t(null!=e)}function ve(){var t=new on;return null==t?null:(t.a=0,t.xb=gi,ne("Predictor","VP8LPredictors"),ne("Predictor","VP8LPredictors_C"),ne("PredictorAdd","VP8LPredictorsAdd"),ne("PredictorAdd","VP8LPredictorsAdd_C"),Yn=z,$n=Q,er=q,tr=J,nr=Z,rr=$,ir=ee,e.VP8LMapColor32b=Kn,e.VP8LMapColor8b=Jn,t)}function Te(e,n,r,o,a){var u=1,c=[e],f=[n],g=o.m,m=o.s,E=null,C=0;e:for(;;){if(r)for(;u&&A(g,1);){var y=c,I=f,_=o,x=1,P=_.m,v=_.gc[_.ab],T=A(P,2);if(_.Oc&1<<T)u=0;else{switch(_.Oc|=1<<T,v.hc=T,v.Ea=y[0],v.nc=I[0],v.K=[null],++_.ab,t(4>=_.ab),T){case 0:case 1:v.b=A(P,3)+2,x=Te(k(v.Ea,v.b),k(v.nc,v.b),0,_,v.K),v.K=v.K[0];break;case 3:var M,L=A(P,8)+1,D=16<L?0:4<L?1:2<L?2:3;if(y[0]=k(v.Ea,D),v.b=D,M=x=Te(L,1,0,_,v.K)){var F,N=L,B=v,G=1<<(8>>B.b),X=l(G);if(null==X)M=0;else{var V=B.K[0],H=B.w;for(X[0]=B.K[0][0],F=1;F<1*N;++F)X[F]=O(V[H+F],X[F-1]);for(;F<4*G;++F)X[F]=0;B.K[0]=null,B.K[0]=X,M=1}}x=M;break;case 2:break;default:t(0)}u=x}}if(c=c[0],f=f[0],u&&A(g,1)&&!(u=1<=(C=A(g,4))&&11>=C)){o.a=3;break e}var U;if(U=u)t:{var W,j,z,Y=o,Q=c,K=f,q=C,J=r,Z=Y.m,$=Y.s,ee=[null],te=1,ne=0,re=$r[q];n:for(;;){if(J&&A(Z,1)){var ie=A(Z,3)+2,le=k(Q,ie),se=k(K,ie),oe=le*se;if(!Te(le,se,0,Y,ee))break n;for(ee=ee[0],$.xc=ie,W=0;W<oe;++W){var ae=ee[W]>>8&65535;ee[W]=ae,ae>=te&&(te=ae+1)}}if(Z.h)break n;for(j=0;5>j;++j){var ue=Kr[j];!j&&0<q&&(ue+=1<<q),ne<ue&&(ne=ue)}var he=s(te*re,d),de=te,ce=s(de,p);if(null==ce)var pe=null;else t(65536>=de),pe=ce;var fe=l(ne);if(null==pe||null==fe||null==he){Y.a=1;break n}var ge=he;for(W=z=0;W<te;++W){var me=pe[W],Ee=me.G,Ce=me.H,ye=0,Ie=1,Se=0;for(j=0;5>j;++j){ue=Kr[j],Ee[j]=ge,Ce[j]=z,!j&&0<q&&(ue+=1<<q);r:{var _e,we=ue,be=Y,ve=fe,Me=ge,Le=z,De=0,Re=be.m,Fe=A(Re,1);if(i(ve,0,0,we),Fe){var Ne=A(Re,1)+1,Be=A(Re,1),ke=A(Re,0==Be?1:8);ve[ke]=1,2==Ne&&(ve[ke=A(Re,8)]=1);var Oe=1}else{var Ge=l(19),Xe=A(Re,4)+4;if(19<Xe){be.a=3;var Ve=0;break r}for(_e=0;_e<Xe;++_e)Ge[Jr[_e]]=A(Re,3);var He=void 0,Ue=void 0,We=be,je=Ge,ze=we,Ye=ve,Qe=0,Ke=We.m,qe=8,Je=s(128,d);i:for(;h(Je,0,7,je,19);){if(A(Ke,1)){var Ze=2+2*A(Ke,3);if((He=2+A(Ke,Ze))>ze)break i}else He=ze;for(Ue=0;Ue<ze&&He--;){b(Ke);var $e=Je[0+(127&S(Ke))];w(Ke,Ke.u+$e.g);var et=$e.value;if(16>et)Ye[Ue++]=et,0!=et&&(qe=et);else{var tt=16==et,nt=et-16,rt=Qr[nt],it=A(Ke,Yr[nt])+rt;if(Ue+it>ze)break i;for(var lt=tt?qe:0;0<it--;)Ye[Ue++]=lt}}Qe=1;break i}Qe||(We.a=3),Oe=Qe}(Oe=Oe&&!Re.h)&&(De=h(Me,Le,8,ve,we)),Oe&&0!=De?Ve=De:(be.a=3,Ve=0)}if(0==Ve)break n;if(Ie&&1==qr[j]&&(Ie=0==ge[z].g),ye+=ge[z].g,z+=Ve,3>=j){var st,ot=fe[0];for(st=1;st<ue;++st)fe[st]>ot&&(ot=fe[st]);Se+=ot}}if(me.nd=Ie,me.Qb=0,Ie&&(me.qb=(Ee[3][Ce[3]+0].value<<24|Ee[1][Ce[1]+0].value<<16|Ee[2][Ce[2]+0].value)>>>0,0==ye&&256>Ee[0][Ce[0]+0].value&&(me.Qb=1,me.qb+=Ee[0][Ce[0]+0].value<<8)),me.jc=!me.Qb&&6>Se,me.jc){var at,ut=me;for(at=0;at<Gn;++at){var ht=at,dt=ut.pd[ht],ct=ut.G[0][ut.H[0]+ht];256<=ct.value?(dt.g=ct.g+256,dt.value=ct.value):(dt.g=0,dt.value=0,ht>>=Ae(ct,8,dt),ht>>=Ae(ut.G[1][ut.H[1]+ht],16,dt),ht>>=Ae(ut.G[2][ut.H[2]+ht],0,dt),Ae(ut.G[3][ut.H[3]+ht],24,dt))}}}$.vc=ee,$.Wb=te,$.Ya=pe,$.yc=he,U=1;break t}U=0}if(!(u=U)){o.a=3;break e}if(0<C){if(m.ua=1<<C,!R(m.Wa,C)){o.a=1,u=0;break e}}else m.ua=0;var pt=o,ft=c,gt=f,mt=pt.s,Et=mt.xc;if(pt.c=ft,pt.i=gt,mt.md=k(ft,Et),mt.wc=0==Et?-1:(1<<Et)-1,r){o.xb=fi;break e}if(null==(E=l(c*f))){o.a=1,u=0;break e}u=(u=xe(o,E,0,c,f,f,null))&&!g.h;break e}return u?(null!=a?a[0]=E:(t(null==E),t(r)),o.$=0,r||Pe(m)):Pe(m),u}function Me(e,n){var r=e.c*e.i,i=r+n+16*n;return t(e.c<=n),e.V=l(i),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+r+n,1)}function Le(e,n){var r=e.C,i=n-r,l=e.V,s=e.Ba+e.c*r;for(t(n<=e.l.o);0<i;){var o=16<i?16:i,a=e.l.ma,u=e.l.width,h=u*o,d=a.ca,c=a.tb+u*r,p=e.Ta,f=e.Ua;Ie(e,o,l,s),xr(p,f,d,c,h),we(a,r,r+o,d,c,u),i-=o,l+=o*e.c,r+=o}t(r==n),e.C=e.Ma=n}function De(){this.ub=this.yd=this.td=this.Rb=0}function Re(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Fe(){this.Fb=this.Bb=this.Cb=0,this.Zb=l(4),this.Lb=l(4)}function Ne(){this.Yb=function(){var e=[];return function e(t,n,r){for(var i=r[n],l=0;l<i&&(t.push(r.length>n+1?[]:0),!(r.length<n+1));l++)e(t[l],n+1,r)}(e,0,[3,11]),e}()}function Be(){this.jb=l(3),this.Wc=o([4,8],Ne),this.Xc=o([4,17],Ne)}function ke(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new l(4),this.od=new l(4)}function Oe(){this.ld=this.La=this.dd=this.tc=0}function Ge(){this.Na=this.la=0}function Xe(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ve(){this.ad=l(384),this.Za=0,this.Ob=l(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function He(){this.uc=this.M=this.Nb=0,this.wa=Array(new Oe),this.Y=0,this.ya=Array(new Ve),this.aa=0,this.l=new ze}function Ue(){this.y=l(16),this.f=l(8),this.ea=l(8)}function We(){this.cb=this.a=0,this.sc="",this.m=new y,this.Od=new De,this.Kc=new Re,this.ed=new ke,this.Qa=new Fe,this.Ic=this.$c=this.Aa=0,this.D=new He,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,y),this.ia=0,this.pb=s(4,Xe),this.Pa=new Be,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ue),this.Hd=0,this.rb=Array(new Ge),this.sb=0,this.wa=Array(new Oe),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ve),this.L=this.aa=0,this.gd=o([4,2],Oe),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function je(e,t){return 0>e?0:e>t?t:e}function ze(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ye(){var e=new We;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,ri||(ri=Je)),e}function Qe(e,t,n){return 0==e.a&&(e.a=t,e.sc=n,e.cb=0),0}function Ke(e,t,n){return 3<=n&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function qe(e,n){if(null==e)return 0;if(e.a=0,e.sc="OK",null==n)return Qe(e,2,"null VP8Io passed to VP8GetHeaders()");var r=n.data,l=n.w,s=n.ha;if(4>s)return Qe(e,7,"Truncated header.");var o=r[l+0]|r[l+1]<<8|r[l+2]<<16,a=e.Od;if(a.Rb=!(1&o),a.td=o>>1&7,a.yd=o>>4&1,a.ub=o>>5,3<a.td)return Qe(e,3,"Incorrect keyframe parameters.");if(!a.yd)return Qe(e,4,"Frame not displayable.");l+=3,s-=3;var u=e.Kc;if(a.Rb){if(7>s)return Qe(e,7,"cannot parse picture header");if(!Ke(r,l,s))return Qe(e,3,"Bad code word");u.c=16383&(r[l+4]<<8|r[l+3]),u.Td=r[l+4]>>6,u.i=16383&(r[l+6]<<8|r[l+5]),u.Ud=r[l+6]>>6,l+=7,s-=7,e.za=u.c+15>>4,e.Ub=u.i+15>>4,n.width=u.c,n.height=u.i,n.Da=0,n.j=0,n.v=0,n.va=n.width,n.o=n.height,n.da=0,n.ib=n.width,n.hb=n.height,n.U=n.width,n.T=n.height,i((o=e.Pa).jb,0,255,o.jb.length),t(null!=(o=e.Qa)),o.Cb=0,o.Bb=0,o.Fb=1,i(o.Zb,0,0,o.Zb.length),i(o.Lb,0,0,o.Lb)}if(a.ub>s)return Qe(e,7,"bad partition length");f(o=e.m,r,l,a.ub),l+=a.ub,s-=a.ub,a.Rb&&(u.Ld=P(o),u.Kd=P(o)),u=e.Qa;var h,d=e.Pa;if(t(null!=o),t(null!=u),u.Cb=P(o),u.Cb){if(u.Bb=P(o),P(o)){for(u.Fb=P(o),h=0;4>h;++h)u.Zb[h]=P(o)?m(o,7):0;for(h=0;4>h;++h)u.Lb[h]=P(o)?m(o,6):0}if(u.Bb)for(h=0;3>h;++h)d.jb[h]=P(o)?g(o,8):255}else u.Bb=0;if(o.Ka)return Qe(e,3,"cannot parse segment header");if((u=e.ed).zd=P(o),u.Tb=g(o,6),u.wb=g(o,3),u.Pc=P(o),u.Pc&&P(o)){for(d=0;4>d;++d)P(o)&&(u.vd[d]=m(o,6));for(d=0;4>d;++d)P(o)&&(u.od[d]=m(o,6))}if(e.L=0==u.Tb?0:u.zd?1:2,o.Ka)return Qe(e,3,"cannot parse filter header");var c=s;if(s=h=l,l=h+c,u=c,e.Xb=(1<<g(e.m,2))-1,c<3*(d=e.Xb))r=7;else{for(h+=3*d,u-=3*d,c=0;c<d;++c){var p=r[s+0]|r[s+1]<<8|r[s+2]<<16;p>u&&(p=u),f(e.Jc[+c],r,h,p),h+=p,u-=p,s+=3}f(e.Jc[+d],r,h,u),r=h<l?0:5}if(0!=r)return Qe(e,r,"cannot parse partitions");for(r=g(h=e.m,7),s=P(h)?m(h,4):0,l=P(h)?m(h,4):0,u=P(h)?m(h,4):0,d=P(h)?m(h,4):0,h=P(h)?m(h,4):0,c=e.Qa,p=0;4>p;++p){if(c.Cb){var E=c.Zb[p];c.Fb||(E+=r)}else{if(0<p){e.pb[p]=e.pb[0];continue}E=r}var C=e.pb[p];C.Sc[0]=ti[je(E+s,127)],C.Sc[1]=ni[je(E+0,127)],C.Eb[0]=2*ti[je(E+l,127)],C.Eb[1]=101581*ni[je(E+u,127)]>>16,8>C.Eb[1]&&(C.Eb[1]=8),C.Qc[0]=ti[je(E+d,117)],C.Qc[1]=ni[je(E+h,127)],C.lc=E+h}if(!a.Rb)return Qe(e,4,"Not a key frame.");for(P(o),a=e.Pa,r=0;4>r;++r){for(s=0;8>s;++s)for(l=0;3>l;++l)for(u=0;11>u;++u)d=v(o,ui[r][s][l][u])?g(o,8):oi[r][s][l][u],a.Wc[r][s].Yb[l][u]=d;for(s=0;17>s;++s)a.Xc[r][s]=a.Wc[r][hi[s]]}return e.kc=P(o),e.kc&&(e.Bd=g(o,8)),e.cb=1}function Je(e,t,n,r,i,l,s){var o=t[i].Yb[n];for(n=0;16>i;++i){if(!v(e,o[n+0]))return i;for(;!v(e,o[n+1]);)if(o=t[++i].Yb[0],n=0,16==i)return 16;var a=t[i+1].Yb;if(v(e,o[n+2])){var u=e,h=0;if(v(u,(c=o)[(d=n)+3]))if(v(u,c[d+6])){for(o=0,d=2*(h=v(u,c[d+8]))+(c=v(u,c[d+9+h])),h=0,c=ii[d];c[o];++o)h+=h+v(u,c[o]);h+=3+(8<<d)}else v(u,c[d+7])?(h=7+2*v(u,165),h+=v(u,145)):h=5+v(u,159);else h=v(u,c[d+4])?3+v(u,c[d+5]):2;o=a[2]}else h=1,o=a[1];a=s+li[i],0>(u=e).b&&x(u);var d,c=u.b,p=(d=u.Ca>>1)-(u.I>>c)>>31;--u.b,u.Ca+=p,u.Ca|=1,u.I-=(d+1&p)<<c,l[a]=((h^p)-p)*r[(0<i)+0]}return 16}function Ze(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,i(e.zc,0,0,e.zc.length),e.ja=0}function $e(e,n){if(null==e)return 0;if(null==n)return Qe(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!qe(e,n))return 0;if(t(e.cb),null==n.ac||n.ac(n)){n.ob&&(e.L=0);var o=Gi[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=n.v-o>>4,e.zb=n.j-o>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=n.o+15+o>>4,e.Hb=n.va+15+o>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var a=e.ed;for(o=0;4>o;++o){var u;if(e.Qa.Cb){var h=e.Qa.Lb[o];e.Qa.Fb||(h+=a.Tb)}else h=a.Tb;for(u=0;1>=u;++u){var d=e.gd[o][u],c=h;if(a.Pc&&(c+=a.vd[0],u&&(c+=a.od[0])),0<(c=0>c?0:63<c?63:c)){var p=c;0<a.wb&&(p=4<a.wb?p>>2:p>>1)>9-a.wb&&(p=9-a.wb),1>p&&(p=1),d.dd=p,d.tc=2*c+p,d.ld=40<=c?2:15<=c?1:0}else d.tc=0;d.La=u}}}o=0}else Qe(e,6,"Frame setup failed"),o=e.a;if(o=0==o){if(o){e.$c=0,0<e.Aa||(e.Ic=Vi);e:{o=e.Ic,a=4*(p=e.za);var f=32*p,g=p+1,m=0<e.L?p*(0<e.Aa?2:1):0,E=(2==e.Aa?2:1)*p;if((d=a+832+(u=3*(16*o+Gi[e.L])/2*f)+(h=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=d)o=0;else{if(d>e.Vb){if(e.Vb=0,e.Ec=l(d),e.Fc=0,null==e.Ec){o=Qe(e,1,"no memory during frame initialization.");break e}e.Vb=d}d=e.Ec,c=e.Fc,e.Ac=d,e.Bc=c,c+=a,e.Gd=s(f,Ue),e.Hd=0,e.rb=s(g+1,Ge),e.sb=1,e.wa=m?s(m,Oe):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=p),t(!0),e.oc=d,e.pc=c,c+=832,e.ya=s(E,Ve),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=p),e.R=16*p,e.B=8*p,p=(f=Gi[e.L])*e.R,f=f/2*e.B,e.sa=d,e.ta=c+p,e.qa=e.sa,e.ra=e.ta+16*o*e.R+f,e.Ha=e.qa,e.Ia=e.ra+8*o*e.B+f,e.$c=0,c+=u,e.mb=h?d:null,e.nb=h?c:null,t(c+h<=e.Fc+e.Vb),Ze(e),i(e.Ac,e.Bc,0,a),o=1}}if(o){if(n.ka=0,n.y=e.sa,n.O=e.ta,n.f=e.qa,n.N=e.ra,n.ea=e.Ha,n.Vd=e.Ia,n.fa=e.R,n.Rc=e.B,n.F=null,n.J=0,!Lr){for(o=-255;255>=o;++o)Pr[255+o]=0>o?-o:o;for(o=-1020;1020>=o;++o)vr[1020+o]=-128>o?-128:127<o?127:o;for(o=-112;112>=o;++o)Tr[112+o]=-16>o?-16:15<o?15:o;for(o=-255;510>=o;++o)Mr[255+o]=0>o?0:255<o?255:o;Lr=1}lr=ut,sr=lt,ar=st,ur=ot,hr=at,or=it,dr=Qt,cr=Kt,pr=Zt,fr=$t,gr=qt,mr=Jt,Er=en,Cr=tn,Ar=Ht,yr=Ut,Ir=Wt,Sr=jt,ci[0]=wt,ci[1]=dt,ci[2]=St,ci[3]=_t,ci[4]=bt,ci[5]=Pt,ci[6]=xt,ci[7]=vt,ci[8]=Mt,ci[9]=Tt,di[0]=Et,di[1]=pt,di[2]=ft,di[3]=gt,di[4]=Ct,di[5]=At,di[6]=yt,pi[0]=Ft,pi[1]=ct,pi[2]=Lt,pi[3]=Dt,pi[4]=Bt,pi[5]=Nt,pi[6]=kt,o=1}else o=0}o&&(o=function(e,n){for(e.M=0;e.M<e.Va;++e.M){var s,o=e.Jc[e.M&e.Xb],a=e.m,u=e;for(s=0;s<u.za;++s){var h=a,d=u,c=d.Ac,p=d.Bc+4*s,f=d.zc,g=d.ya[d.aa+s];if(d.Qa.Bb?g.$b=v(h,d.Pa.jb[0])?2+v(h,d.Pa.jb[2]):v(h,d.Pa.jb[1]):g.$b=0,d.kc&&(g.Ad=v(h,d.Bd)),g.Za=!v(h,145)+0,g.Za){var m=g.Ob,E=0;for(d=0;4>d;++d){var C,A=f[0+d];for(C=0;4>C;++C){A=ai[c[p+C]][A];for(var y=si[v(h,A[0])];0<y;)y=si[2*y+v(h,A[y])];A=-y,c[p+C]=A}r(m,E,c,p,4),E+=4,f[0+d]=A}}else A=v(h,156)?v(h,128)?1:3:v(h,163)?2:0,g.Ob[0]=A,i(c,p,A,4),i(f,0,A,4);g.Dd=v(h,142)?v(h,114)?v(h,183)?1:3:2:0}if(u.m.Ka)return Qe(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(u=o,h=(a=e).rb[a.sb-1],c=a.rb[a.sb+a.ja],s=a.ya[a.aa+a.ja],p=a.kc?s.Ad:0)h.la=c.la=0,s.Za||(h.Na=c.Na=0),s.Hc=0,s.Gc=0,s.ia=0;else{var I,S;if(h=c,c=u,p=a.Pa.Xc,f=a.ya[a.aa+a.ja],g=a.pb[f.$b],d=f.ad,m=0,E=a.rb[a.sb-1],A=C=0,i(d,m,0,384),f.Za)var _=0,w=p[3];else{y=l(16);var b=h.Na+E.Na;if(b=ri(c,p[1],b,g.Eb,0,y,0),h.Na=E.Na=(0<b)+0,1<b)lr(y,0,d,m);else{var x=y[0]+3>>3;for(y=0;256>y;y+=16)d[m+y]=x}_=1,w=p[0]}var P=15&h.la,T=15&E.la;for(y=0;4>y;++y){var M=1&T;for(x=S=0;4>x;++x)P=P>>1|(M=(b=ri(c,w,b=M+(1&P),g.Sc,_,d,m))>_)<<7,S=S<<2|(3<b?3:1<b?2:0!=d[m+0]),m+=16;P>>=4,T=T>>1|M<<7,C=(C<<8|S)>>>0}for(w=P,_=T>>4,I=0;4>I;I+=2){for(S=0,P=h.la>>4+I,T=E.la>>4+I,y=0;2>y;++y){for(M=1&T,x=0;2>x;++x)b=M+(1&P),P=P>>1|(M=0<(b=ri(c,p[2],b,g.Qc,0,d,m)))<<3,S=S<<2|(3<b?3:1<b?2:0!=d[m+0]),m+=16;P>>=2,T=T>>1|M<<5}A|=S<<4*I,w|=P<<4<<I,_|=(240&T)<<I}h.la=w,E.la=_,f.Hc=C,f.Gc=A,f.ia=43690&A?0:g.ia,p=!(C|A)}if(0<a.L&&(a.wa[a.Y+a.ja]=a.gd[s.$b][s.Za],a.wa[a.Y+a.ja].La|=!p),u.Ka)return Qe(e,7,"Premature end-of-file encountered.")}if(Ze(e),a=n,u=1,s=(o=e).D,h=0<o.L&&o.M>=o.zb&&o.M<=o.Va,0==o.Aa)e:{if(s.M=o.M,s.uc=h,Fn(o,s),u=1,s=(S=o.D).Nb,h=(A=Gi[o.L])*o.R,c=A/2*o.B,y=16*s*o.R,x=8*s*o.B,p=o.sa,f=o.ta-h+y,g=o.qa,d=o.ra-c+x,m=o.Ha,E=o.Ia-c+x,T=0==(P=S.M),C=P>=o.Va-1,2==o.Aa&&Fn(o,S),S.uc)for(M=(b=o).D.M,t(b.D.uc),S=b.yb;S<b.Hb;++S){_=S,w=M;var L=(D=(V=b).D).Nb;I=V.R;var D=D.wa[D.Y+_],R=V.sa,F=V.ta+16*L*I+16*_,N=D.dd,B=D.tc;if(0!=B)if(t(3<=B),1==V.L)0<_&&yr(R,F,I,B+4),D.La&&Sr(R,F,I,B),0<w&&Ar(R,F,I,B+4),D.La&&Ir(R,F,I,B);else{var k=V.B,O=V.qa,G=V.ra+8*L*k+8*_,X=V.Ha,V=V.Ia+8*L*k+8*_;L=D.ld,0<_&&(cr(R,F,I,B+4,N,L),fr(O,G,X,V,k,B+4,N,L)),D.La&&(mr(R,F,I,B,N,L),Cr(O,G,X,V,k,B,N,L)),0<w&&(dr(R,F,I,B+4,N,L),pr(O,G,X,V,k,B+4,N,L)),D.La&&(gr(R,F,I,B,N,L),Er(O,G,X,V,k,B,N,L))}}if(o.ia&&alert("todo:DitherRow"),null!=a.put){if(S=16*P,P=16*(P+1),T?(a.y=o.sa,a.O=o.ta+y,a.f=o.qa,a.N=o.ra+x,a.ea=o.Ha,a.W=o.Ia+x):(S-=A,a.y=p,a.O=f,a.f=g,a.N=d,a.ea=m,a.W=E),C||(P-=A),P>a.o&&(P=a.o),a.F=null,a.J=null,null!=o.Fa&&0<o.Fa.length&&S<P&&(a.J=cn(o,a,S,P-S),a.F=o.mb,null==a.F&&0==a.F.length)){u=Qe(o,3,"Could not decode alpha data.");break e}S<a.j&&(A=a.j-S,S=a.j,t(!(1&A)),a.O+=o.R*A,a.N+=o.B*(A>>1),a.W+=o.B*(A>>1),null!=a.F&&(a.J+=a.width*A)),S<P&&(a.O+=a.v,a.N+=a.v>>1,a.W+=a.v>>1,null!=a.F&&(a.J+=a.v),a.ka=S-a.j,a.U=a.va-a.v,a.T=P-S,u=a.put(a))}s+1!=o.Ic||C||(r(o.sa,o.ta-h,p,f+16*o.R,h),r(o.qa,o.ra-c,g,d+8*o.B,c),r(o.Ha,o.Ia-c,m,E+8*o.B,c))}if(!u)return Qe(e,6,"Output aborted.")}return 1}(e,n)),null!=n.bc&&n.bc(n),o&=1}return o?(e.cb=0,o):0}function et(e,t,n,r,i){i=e[t+n+32*r]+(i>>3),e[t+n+32*r]=-256&i?0>i?0:255:i}function tt(e,t,n,r,i,l){et(e,t,0,n,r+i),et(e,t,1,n,r+l),et(e,t,2,n,r-l),et(e,t,3,n,r-i)}function nt(e){return(20091*e>>16)+e}function rt(e,t,n,r){var i,s=0,o=l(16);for(i=0;4>i;++i){var a=e[t+0]+e[t+8],u=e[t+0]-e[t+8],h=(35468*e[t+4]>>16)-nt(e[t+12]),d=nt(e[t+4])+(35468*e[t+12]>>16);o[s+0]=a+d,o[s+1]=u+h,o[s+2]=u-h,o[s+3]=a-d,s+=4,t++}for(i=s=0;4>i;++i)a=(e=o[s+0]+4)+o[s+8],u=e-o[s+8],h=(35468*o[s+4]>>16)-nt(o[s+12]),et(n,r,0,0,a+(d=nt(o[s+4])+(35468*o[s+12]>>16))),et(n,r,1,0,u+h),et(n,r,2,0,u-h),et(n,r,3,0,a-d),s++,r+=32}function it(e,t,n,r){var i=e[t+0]+4,l=35468*e[t+4]>>16,s=nt(e[t+4]),o=35468*e[t+1]>>16;tt(n,r,0,i+s,e=nt(e[t+1]),o),tt(n,r,1,i+l,e,o),tt(n,r,2,i-l,e,o),tt(n,r,3,i-s,e,o)}function lt(e,t,n,r,i){rt(e,t,n,r),i&&rt(e,t+16,n,r+4)}function st(e,t,n,r){sr(e,t+0,n,r,1),sr(e,t+32,n,r+128,1)}function ot(e,t,n,r){var i;for(e=e[t+0]+4,i=0;4>i;++i)for(t=0;4>t;++t)et(n,r,t,i,e)}function at(e,t,n,r){e[t+0]&&ur(e,t+0,n,r),e[t+16]&&ur(e,t+16,n,r+4),e[t+32]&&ur(e,t+32,n,r+128),e[t+48]&&ur(e,t+48,n,r+128+4)}function ut(e,t,n,r){var i,s=l(16);for(i=0;4>i;++i){var o=e[t+0+i]+e[t+12+i],a=e[t+4+i]+e[t+8+i],u=e[t+4+i]-e[t+8+i],h=e[t+0+i]-e[t+12+i];s[0+i]=o+a,s[8+i]=o-a,s[4+i]=h+u,s[12+i]=h-u}for(i=0;4>i;++i)o=(e=s[0+4*i]+3)+s[3+4*i],a=s[1+4*i]+s[2+4*i],u=s[1+4*i]-s[2+4*i],h=e-s[3+4*i],n[r+0]=o+a>>3,n[r+16]=h+u>>3,n[r+32]=o-a>>3,n[r+48]=h-u>>3,r+=64}function ht(e,t,n){var r,i=t-32,l=Fr,s=255-e[i-1];for(r=0;r<n;++r){var o,a=l,u=s+e[t-1];for(o=0;o<n;++o)e[t+o]=a[u+e[i+o]];t+=32}}function dt(e,t){ht(e,t,4)}function ct(e,t){ht(e,t,8)}function pt(e,t){ht(e,t,16)}function ft(e,t){var n;for(n=0;16>n;++n)r(e,t+32*n,e,t-32,16)}function gt(e,t){var n;for(n=16;0<n;--n)i(e,t,e[t-1],16),t+=32}function mt(e,t,n){var r;for(r=0;16>r;++r)i(t,n+32*r,e,16)}function Et(e,t){var n,r=16;for(n=0;16>n;++n)r+=e[t-1+32*n]+e[t+n-32];mt(r>>5,e,t)}function Ct(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t-1+32*n];mt(r>>4,e,t)}function At(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t+n-32];mt(r>>4,e,t)}function yt(e,t){mt(128,e,t)}function It(e,t,n){return e+2*t+n+2>>2}function St(e,t){var n,i=t-32;for(i=new Uint8Array([It(e[i-1],e[i+0],e[i+1]),It(e[i+0],e[i+1],e[i+2]),It(e[i+1],e[i+2],e[i+3]),It(e[i+2],e[i+3],e[i+4])]),n=0;4>n;++n)r(e,t+32*n,i,0,i.length)}function _t(e,t){var n=e[t-1],r=e[t-1+32],i=e[t-1+64],l=e[t-1+96];T(e,t+0,16843009*It(e[t-1-32],n,r)),T(e,t+32,16843009*It(n,r,i)),T(e,t+64,16843009*It(r,i,l)),T(e,t+96,16843009*It(i,l,l))}function wt(e,t){var n,r=4;for(n=0;4>n;++n)r+=e[t+n-32]+e[t-1+32*n];for(r>>=3,n=0;4>n;++n)i(e,t+32*n,r,4)}function bt(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],l=e[t-1-32],s=e[t+0-32],o=e[t+1-32],a=e[t+2-32],u=e[t+3-32];e[t+0+96]=It(r,i,e[t-1+96]),e[t+1+96]=e[t+0+64]=It(n,r,i),e[t+2+96]=e[t+1+64]=e[t+0+32]=It(l,n,r),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=It(s,l,n),e[t+3+64]=e[t+2+32]=e[t+1+0]=It(o,s,l),e[t+3+32]=e[t+2+0]=It(a,o,s),e[t+3+0]=It(u,a,o)}function xt(e,t){var n=e[t+1-32],r=e[t+2-32],i=e[t+3-32],l=e[t+4-32],s=e[t+5-32],o=e[t+6-32],a=e[t+7-32];e[t+0+0]=It(e[t+0-32],n,r),e[t+1+0]=e[t+0+32]=It(n,r,i),e[t+2+0]=e[t+1+32]=e[t+0+64]=It(r,i,l),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=It(i,l,s),e[t+3+32]=e[t+2+64]=e[t+1+96]=It(l,s,o),e[t+3+64]=e[t+2+96]=It(s,o,a),e[t+3+96]=It(o,a,a)}function Pt(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],l=e[t-1-32],s=e[t+0-32],o=e[t+1-32],a=e[t+2-32],u=e[t+3-32];e[t+0+0]=e[t+1+64]=l+s+1>>1,e[t+1+0]=e[t+2+64]=s+o+1>>1,e[t+2+0]=e[t+3+64]=o+a+1>>1,e[t+3+0]=a+u+1>>1,e[t+0+96]=It(i,r,n),e[t+0+64]=It(r,n,l),e[t+0+32]=e[t+1+96]=It(n,l,s),e[t+1+32]=e[t+2+96]=It(l,s,o),e[t+2+32]=e[t+3+96]=It(s,o,a),e[t+3+32]=It(o,a,u)}function vt(e,t){var n=e[t+0-32],r=e[t+1-32],i=e[t+2-32],l=e[t+3-32],s=e[t+4-32],o=e[t+5-32],a=e[t+6-32],u=e[t+7-32];e[t+0+0]=n+r+1>>1,e[t+1+0]=e[t+0+64]=r+i+1>>1,e[t+2+0]=e[t+1+64]=i+l+1>>1,e[t+3+0]=e[t+2+64]=l+s+1>>1,e[t+0+32]=It(n,r,i),e[t+1+32]=e[t+0+96]=It(r,i,l),e[t+2+32]=e[t+1+96]=It(i,l,s),e[t+3+32]=e[t+2+96]=It(l,s,o),e[t+3+64]=It(s,o,a),e[t+3+96]=It(o,a,u)}function Tt(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],l=e[t-1+96];e[t+0+0]=n+r+1>>1,e[t+2+0]=e[t+0+32]=r+i+1>>1,e[t+2+32]=e[t+0+64]=i+l+1>>1,e[t+1+0]=It(n,r,i),e[t+3+0]=e[t+1+32]=It(r,i,l),e[t+3+32]=e[t+1+64]=It(i,l,l),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=l}function Mt(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],l=e[t-1+96],s=e[t-1-32],o=e[t+0-32],a=e[t+1-32],u=e[t+2-32];e[t+0+0]=e[t+2+32]=n+s+1>>1,e[t+0+32]=e[t+2+64]=r+n+1>>1,e[t+0+64]=e[t+2+96]=i+r+1>>1,e[t+0+96]=l+i+1>>1,e[t+3+0]=It(o,a,u),e[t+2+0]=It(s,o,a),e[t+1+0]=e[t+3+32]=It(n,s,o),e[t+1+32]=e[t+3+64]=It(r,n,s),e[t+1+64]=e[t+3+96]=It(i,r,n),e[t+1+96]=It(l,i,r)}function Lt(e,t){var n;for(n=0;8>n;++n)r(e,t+32*n,e,t-32,8)}function Dt(e,t){var n;for(n=0;8>n;++n)i(e,t,e[t-1],8),t+=32}function Rt(e,t,n){var r;for(r=0;8>r;++r)i(t,n+32*r,e,8)}function Ft(e,t){var n,r=8;for(n=0;8>n;++n)r+=e[t+n-32]+e[t-1+32*n];Rt(r>>4,e,t)}function Nt(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t+n-32];Rt(r>>3,e,t)}function Bt(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t-1+32*n];Rt(r>>3,e,t)}function kt(e,t){Rt(128,e,t)}function Ot(e,t,n){var r=e[t-n],i=e[t+0],l=3*(i-r)+Dr[1020+e[t-2*n]-e[t+n]],s=Rr[112+(l+4>>3)];e[t-n]=Fr[255+r+Rr[112+(l+3>>3)]],e[t+0]=Fr[255+i-s]}function Gt(e,t,n,r){var i=e[t+0],l=e[t+n];return Nr[255+e[t-2*n]-e[t-n]]>r||Nr[255+l-i]>r}function Xt(e,t,n,r){return 4*Nr[255+e[t-n]-e[t+0]]+Nr[255+e[t-2*n]-e[t+n]]<=r}function Vt(e,t,n,r,i){var l=e[t-3*n],s=e[t-2*n],o=e[t-n],a=e[t+0],u=e[t+n],h=e[t+2*n],d=e[t+3*n];return 4*Nr[255+o-a]+Nr[255+s-u]>r?0:Nr[255+e[t-4*n]-l]<=i&&Nr[255+l-s]<=i&&Nr[255+s-o]<=i&&Nr[255+d-h]<=i&&Nr[255+h-u]<=i&&Nr[255+u-a]<=i}function Ht(e,t,n,r){var i=2*r+1;for(r=0;16>r;++r)Xt(e,t+r,n,i)&&Ot(e,t+r,n)}function Ut(e,t,n,r){var i=2*r+1;for(r=0;16>r;++r)Xt(e,t+r*n,1,i)&&Ot(e,t+r*n,1)}function Wt(e,t,n,r){var i;for(i=3;0<i;--i)Ht(e,t+=4*n,n,r)}function jt(e,t,n,r){var i;for(i=3;0<i;--i)Ut(e,t+=4,n,r)}function zt(e,t,n,r,i,l,s,o){for(l=2*l+1;0<i--;){if(Vt(e,t,n,l,s))if(Gt(e,t,n,o))Ot(e,t,n);else{var a=e,u=t,h=n,d=a[u-2*h],c=a[u-h],p=a[u+0],f=a[u+h],g=a[u+2*h],m=27*(C=Dr[1020+3*(p-c)+Dr[1020+d-f]])+63>>7,E=18*C+63>>7,C=9*C+63>>7;a[u-3*h]=Fr[255+a[u-3*h]+C],a[u-2*h]=Fr[255+d+E],a[u-h]=Fr[255+c+m],a[u+0]=Fr[255+p-m],a[u+h]=Fr[255+f-E],a[u+2*h]=Fr[255+g-C]}t+=r}}function Yt(e,t,n,r,i,l,s,o){for(l=2*l+1;0<i--;){if(Vt(e,t,n,l,s))if(Gt(e,t,n,o))Ot(e,t,n);else{var a=e,u=t,h=n,d=a[u-h],c=a[u+0],p=a[u+h],f=Rr[112+(4+(g=3*(c-d))>>3)],g=Rr[112+(g+3>>3)],m=f+1>>1;a[u-2*h]=Fr[255+a[u-2*h]+m],a[u-h]=Fr[255+d+g],a[u+0]=Fr[255+c-f],a[u+h]=Fr[255+p-m]}t+=r}}function Qt(e,t,n,r,i,l){zt(e,t,n,1,16,r,i,l)}function Kt(e,t,n,r,i,l){zt(e,t,1,n,16,r,i,l)}function qt(e,t,n,r,i,l){var s;for(s=3;0<s;--s)Yt(e,t+=4*n,n,1,16,r,i,l)}function Jt(e,t,n,r,i,l){var s;for(s=3;0<s;--s)Yt(e,t+=4,1,n,16,r,i,l)}function Zt(e,t,n,r,i,l,s,o){zt(e,t,i,1,8,l,s,o),zt(n,r,i,1,8,l,s,o)}function $t(e,t,n,r,i,l,s,o){zt(e,t,1,i,8,l,s,o),zt(n,r,1,i,8,l,s,o)}function en(e,t,n,r,i,l,s,o){Yt(e,t+4*i,i,1,8,l,s,o),Yt(n,r+4*i,i,1,8,l,s,o)}function tn(e,t,n,r,i,l,s,o){Yt(e,t+4,1,i,8,l,s,o),Yt(n,r+4,1,i,8,l,s,o)}function nn(){this.ba=new se,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ae,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function rn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ln(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function sn(){this.ua=0,this.Wa=new N,this.vb=new N,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new p,this.yc=new d}function on(){this.xb=this.a=0,this.l=new ze,this.ca=new se,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new I,this.Pb=0,this.wd=new I,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new sn,this.ab=0,this.gc=s(4,ln),this.Oc=0}function an(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ze,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function un(e,t,n,r,i,l,s){for(e=null==e?0:e[t+0],t=0;t<s;++t)i[l+t]=e+n[r+t]&255,e=i[l+t]}function hn(e,t,n,r,i,l,s){var o;if(null==e)un(null,null,n,r,i,l,s);else for(o=0;o<s;++o)i[l+o]=e[t+o]+n[r+o]&255}function dn(e,t,n,r,i,l,s){if(null==e)un(null,null,n,r,i,l,s);else{var o,a=e[t+0],u=a,h=a;for(o=0;o<s;++o)u=h+(a=e[t+o])-u,h=n[r+o]+(-256&u?0>u?0:255:u)&255,u=a,i[l+o]=h}}function cn(e,n,i,s){var o=n.width,a=n.o;if(t(null!=e&&null!=n),0>i||0>=s||i+s>a)return null;if(!e.Cc){if(null==e.ga){var u;if(e.ga=new an,(u=null==e.ga)||(u=n.width*n.o,t(0==e.Gb.length),e.Gb=l(u),e.Uc=0,null==e.Gb?u=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,u=1),u=!u),!u){u=e.ga;var h=e.Fa,d=e.P,c=e.qc,p=e.mb,f=e.nb,g=d+1,m=c-1,C=u.l;if(t(null!=h&&null!=p&&null!=n),mi[0]=null,mi[1]=un,mi[2]=hn,mi[3]=dn,u.ca=p,u.tb=f,u.c=n.width,u.i=n.height,t(0<u.c&&0<u.i),1>=c)n=0;else if(u.$a=h[d+0]>>0&3,u.Z=h[d+0]>>2&3,u.Lc=h[d+0]>>4&3,d=h[d+0]>>6&3,0>u.$a||1<u.$a||4<=u.Z||1<u.Lc||d)n=0;else if(C.put=pe,C.ac=ce,C.bc=fe,C.ma=u,C.width=n.width,C.height=n.height,C.Da=n.Da,C.v=n.v,C.va=n.va,C.j=n.j,C.o=n.o,u.$a)e:{t(1==u.$a),n=ve();t:for(;;){if(null==n){n=0;break e}if(t(null!=u),u.mc=n,n.c=u.c,n.i=u.i,n.l=u.l,n.l.ma=u,n.l.width=u.c,n.l.height=u.i,n.a=0,E(n.m,h,g,m),!Te(u.c,u.i,1,n,null))break t;if(1==n.ab&&3==n.gc[0].hc&&_e(n.s)?(u.ic=1,h=n.c*n.i,n.Ta=null,n.Ua=0,n.V=l(h),n.Ba=0,null==n.V?(n.a=1,n=0):n=1):(u.ic=0,n=Me(n,u.c)),!n)break t;n=1;break e}u.mc=null,n=0}else n=m>=u.c*u.i;u=!n}if(u)return null;1!=e.ga.Lc?e.Ga=0:s=a-i}t(null!=e.ga),t(i+s<=a);e:{if(n=(h=e.ga).c,a=h.l.o,0==h.$a){if(g=e.rc,m=e.Vc,C=e.Fa,d=e.P+1+i*n,c=e.mb,p=e.nb+i*n,t(d<=e.P+e.qc),0!=h.Z)for(t(null!=mi[h.Z]),u=0;u<s;++u)mi[h.Z](g,m,C,d,c,p,n),g=c,m=p,p+=n,d+=n;else for(u=0;u<s;++u)r(c,p,C,d,n),g=c,m=p,p+=n,d+=n;e.rc=g,e.Vc=m}else{if(t(null!=h.mc),n=i+s,t(null!=(u=h.mc)),t(n<=u.i),u.C>=n)n=1;else if(h.ic||En(),h.ic){h=u.V,g=u.Ba,m=u.c;var A=u.i,y=(C=1,d=u.$/m,c=u.$%m,p=u.m,f=u.s,u.$),I=m*A,S=m*n,w=f.wc,x=y<S?ye(f,c,d):null;t(y<=I),t(n<=A),t(_e(f));t:for(;;){for(;!p.h&&y<S;){if(c&w||(x=ye(f,c,d)),t(null!=x),b(p),256>(A=Ce(x.G[0],x.H[0],p)))h[g+y]=A,++y,++c>=m&&(c=0,++d<=n&&!(d%16)&&be(u,d));else{if(!(280>A)){C=0;break t}A=me(A-256,p);var P,v=Ce(x.G[4],x.H[4],p);if(b(p),!(y>=(v=Ee(m,v=me(v,p)))&&I-y>=A)){C=0;break t}for(P=0;P<A;++P)h[g+y+P]=h[g+y+P-v];for(y+=A,c+=A;c>=m;)c-=m,++d<=n&&!(d%16)&&be(u,d);y<S&&c&w&&(x=ye(f,c,d))}t(p.h==_(p))}be(u,d>n?n:d);break t}!C||p.h&&y<I?(C=0,u.a=p.h?5:3):u.$=y,n=C}else n=xe(u,u.V,u.Ba,u.c,u.i,n,Le);if(!n){s=0;break e}}i+s>=a&&(e.Cc=1),s=1}if(!s)return null;if(e.Cc&&(null!=(s=e.ga)&&(s.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+i*o}function pn(e,t,n,r,i,l){for(;0<i--;){var s,o=e,a=t+(n?1:0),u=e,h=t+(n?0:3);for(s=0;s<r;++s){var d=u[h+4*s];255!=d&&(d*=32897,o[a+4*s+0]=o[a+4*s+0]*d>>23,o[a+4*s+1]=o[a+4*s+1]*d>>23,o[a+4*s+2]=o[a+4*s+2]*d>>23)}t+=l}}function fn(e,t,n,r,i){for(;0<r--;){var l;for(l=0;l<n;++l){var s=e[t+2*l+0],o=15&(u=e[t+2*l+1]),a=4369*o,u=(240&u|u>>4)*a>>16;e[t+2*l+0]=(240&s|s>>4)*a>>16&240|(15&s|s<<4)*a>>16>>4&15,e[t+2*l+1]=240&u|o}t+=i}}function gn(e,t,n,r,i,l,s,o){var a,u,h=255;for(u=0;u<i;++u){for(a=0;a<r;++a){var d=e[t+a];l[s+4*a]=d,h&=d}t+=n,s+=o}return 255!=h}function mn(e,t,n,r,i){var l;for(l=0;l<i;++l)n[r+l]=e[t+l]>>8}function En(){_r=pn,wr=fn,br=gn,xr=mn}function Cn(n,r,i){e[n]=function(e,n,l,s,o,a,u,h,d,c,p,f,g,m,E,C,A){var y,I=A-1>>1,S=o[a+0]|u[h+0]<<16,_=d[c+0]|p[f+0]<<16;t(null!=e);var w=3*S+_+131074>>2;for(r(e[n+0],255&w,w>>16,g,m),null!=l&&(w=3*_+S+131074>>2,r(l[s+0],255&w,w>>16,E,C)),y=1;y<=I;++y){var b=o[a+y]|u[h+y]<<16,x=d[c+y]|p[f+y]<<16,P=S+b+_+x+524296,v=P+2*(b+_)>>3;w=v+S>>1,S=(P=P+2*(S+x)>>3)+b>>1,r(e[n+2*y-1],255&w,w>>16,g,m+(2*y-1)*i),r(e[n+2*y-0],255&S,S>>16,g,m+(2*y-0)*i),null!=l&&(w=P+_>>1,S=v+x>>1,r(l[s+2*y-1],255&w,w>>16,E,C+(2*y-1)*i),r(l[s+2*y+0],255&S,S>>16,E,C+(2*y+0)*i)),S=b,_=x}1&A||(w=3*S+_+131074>>2,r(e[n+A-1],255&w,w>>16,g,m+(A-1)*i),null!=l&&(w=3*_+S+131074>>2,r(l[s+A-1],255&w,w>>16,E,C+(A-1)*i)))}}function An(){Ei[Br]=Ci,Ei[kr]=yi,Ei[Or]=Ai,Ei[Gr]=Ii,Ei[Xr]=Si,Ei[Vr]=_i,Ei[Hr]=wi,Ei[Ur]=yi,Ei[Wr]=Ii,Ei[jr]=Si,Ei[zr]=_i}function yn(e){return e&~Mi?0>e?0:255:e>>Ti}function In(e,t){return yn((19077*e>>8)+(26149*t>>8)-14234)}function Sn(e,t,n){return yn((19077*e>>8)-(6419*t>>8)-(13320*n>>8)+8708)}function _n(e,t){return yn((19077*e>>8)+(33050*t>>8)-17685)}function wn(e,t,n,r,i){r[i+0]=In(e,n),r[i+1]=Sn(e,t,n),r[i+2]=_n(e,t)}function bn(e,t,n,r,i){r[i+0]=_n(e,t),r[i+1]=Sn(e,t,n),r[i+2]=In(e,n)}function xn(e,t,n,r,i){var l=Sn(e,t,n);t=l<<3&224|_n(e,t)>>3,r[i+0]=248&In(e,n)|l>>5,r[i+1]=t}function Pn(e,t,n,r,i){var l=240&_n(e,t)|15;r[i+0]=240&In(e,n)|Sn(e,t,n)>>4,r[i+1]=l}function vn(e,t,n,r,i){r[i+0]=255,wn(e,t,n,r,i+1)}function Tn(e,t,n,r,i){bn(e,t,n,r,i),r[i+3]=255}function Mn(e,t,n,r,i){wn(e,t,n,r,i),r[i+3]=255}function je(e,t){return 0>e?0:e>t?t:e}function Ln(t,n,r){e[t]=function(e,t,i,l,s,o,a,u,h){for(var d=u+(-2&h)*r;u!=d;)n(e[t+0],i[l+0],s[o+0],a,u),n(e[t+1],i[l+0],s[o+0],a,u+r),t+=2,++l,++o,u+=2*r;1&h&&n(e[t+0],i[l+0],s[o+0],a,u)}}function Dn(e,t,n){return 0==n?0==e?0==t?6:5:0==t?4:0:n}function Rn(e,t,n,r,i){switch(e>>>30){case 3:sr(t,n,r,i,0);break;case 2:or(t,n,r,i);break;case 1:ur(t,n,r,i)}}function Fn(e,t){var n,l,s=t.M,o=t.Nb,a=e.oc,u=e.pc+40,h=e.oc,d=e.pc+584,c=e.oc,p=e.pc+600;for(n=0;16>n;++n)a[u+32*n-1]=129;for(n=0;8>n;++n)h[d+32*n-1]=129,c[p+32*n-1]=129;for(0<s?a[u-1-32]=h[d-1-32]=c[p-1-32]=129:(i(a,u-32-1,127,21),i(h,d-32-1,127,9),i(c,p-32-1,127,9)),l=0;l<e.za;++l){var f=t.ya[t.aa+l];if(0<l){for(n=-1;16>n;++n)r(a,u+32*n-4,a,u+32*n+12,4);for(n=-1;8>n;++n)r(h,d+32*n-4,h,d+32*n+4,4),r(c,p+32*n-4,c,p+32*n+4,4)}var g=e.Gd,m=e.Hd+l,E=f.ad,C=f.Hc;if(0<s&&(r(a,u-32,g[m].y,0,16),r(h,d-32,g[m].f,0,8),r(c,p-32,g[m].ea,0,8)),f.Za){var A=a,y=u-32+16;for(0<s&&(l>=e.za-1?i(A,y,g[m].y[15],4):r(A,y,g[m+1].y,0,4)),n=0;4>n;n++)A[y+128+n]=A[y+256+n]=A[y+384+n]=A[y+0+n];for(n=0;16>n;++n,C<<=2)A=a,y=u+Oi[n],ci[f.Ob[n]](A,y),Rn(C,E,16*+n,A,y)}else if(A=Dn(l,s,f.Ob[0]),di[A](a,u),0!=C)for(n=0;16>n;++n,C<<=2)Rn(C,E,16*+n,a,u+Oi[n]);for(n=f.Gc,A=Dn(l,s,f.Dd),pi[A](h,d),pi[A](c,p),C=E,A=h,y=d,255&(f=n>>0)&&(170&f?ar(C,256,A,y):hr(C,256,A,y)),f=c,C=p,255&(n>>=8)&&(170&n?ar(E,320,f,C):hr(E,320,f,C)),s<e.Ub-1&&(r(g[m].y,0,a,u+480,16),r(g[m].f,0,h,d+224,8),r(g[m].ea,0,c,p+224,8)),n=8*o*e.B,g=e.sa,m=e.ta+16*l+16*o*e.R,E=e.qa,f=e.ra+8*l+n,C=e.Ha,A=e.Ia+8*l+n,n=0;16>n;++n)r(g,m+n*e.R,a,u+32*n,16);for(n=0;8>n;++n)r(E,f+n*e.B,h,d+32*n,8),r(C,A+n*e.B,c,p+32*n,8)}}function Nn(e,r,i,l,s,o,a,u,h){var d=[0],c=[0],p=0,f=null!=h?h.kd:0,g=null!=h?h:new rn;if(null==e||12>i)return 7;g.data=e,g.w=r,g.ha=i,r=[r],i=[i],g.gb=[g.gb];e:{var m=r,C=i,A=g.gb;if(t(null!=e),t(null!=C),t(null!=A),A[0]=0,12<=C[0]&&!n(e,m[0],"RIFF")){if(n(e,m[0]+8,"WEBP")){A=3;break e}var y=D(e,m[0]+4);if(12>y||4294967286<y){A=3;break e}if(f&&y>C[0]-8){A=7;break e}A[0]=y,m[0]+=12,C[0]-=12}A=0}if(0!=A)return A;for(y=0<g.gb[0],i=i[0];;){e:{var S=e;C=r,A=i;var _=d,w=c,b=m=[0];if((v=p=[p])[0]=0,8>A[0])A=7;else{if(!n(S,C[0],"VP8X")){if(10!=D(S,C[0]+4)){A=3;break e}if(18>A[0]){A=7;break e}var x=D(S,C[0]+8),P=1+L(S,C[0]+12);if(2147483648<=P*(S=1+L(S,C[0]+15))){A=3;break e}null!=b&&(b[0]=x),null!=_&&(_[0]=P),null!=w&&(w[0]=S),C[0]+=18,A[0]-=18,v[0]=1}A=0}}if(p=p[0],m=m[0],0!=A)return A;if(C=!!(2&m),!y&&p)return 3;if(null!=o&&(o[0]=!!(16&m)),null!=a&&(a[0]=C),null!=u&&(u[0]=0),a=d[0],m=c[0],p&&C&&null==h){A=0;break}if(4>i){A=7;break}if(y&&p||!y&&!p&&!n(e,r[0],"ALPH")){i=[i],g.na=[g.na],g.P=[g.P],g.Sa=[g.Sa];e:{x=e,A=r,y=i;var v=g.gb;_=g.na,w=g.P,b=g.Sa,P=22,t(null!=x),t(null!=y),S=A[0];var T=y[0];for(t(null!=_),t(null!=b),_[0]=null,w[0]=null,b[0]=0;;){if(A[0]=S,y[0]=T,8>T){A=7;break e}var M=D(x,S+4);if(4294967286<M){A=3;break e}var R=8+M+1&-2;if(P+=R,0<v&&P>v){A=3;break e}if(!n(x,S,"VP8 ")||!n(x,S,"VP8L")){A=0;break e}if(T[0]<R){A=7;break e}n(x,S,"ALPH")||(_[0]=x,w[0]=S+8,b[0]=M),S+=R,T-=R}}if(i=i[0],g.na=g.na[0],g.P=g.P[0],g.Sa=g.Sa[0],0!=A)break}i=[i],g.Ja=[g.Ja],g.xa=[g.xa];e:if(v=e,A=r,y=i,_=g.gb[0],w=g.Ja,b=g.xa,x=A[0],S=!n(v,x,"VP8 "),P=!n(v,x,"VP8L"),t(null!=v),t(null!=y),t(null!=w),t(null!=b),8>y[0])A=7;else{if(S||P){if(v=D(v,x+4),12<=_&&v>_-12){A=3;break e}if(f&&v>y[0]-8){A=7;break e}w[0]=v,A[0]+=8,y[0]-=8,b[0]=P}else b[0]=5<=y[0]&&47==v[x+0]&&!(v[x+4]>>5),w[0]=y[0];A=0}if(i=i[0],g.Ja=g.Ja[0],g.xa=g.xa[0],r=r[0],0!=A)break;if(4294967286<g.Ja)return 3;if(null==u||C||(u[0]=g.xa?2:1),a=[a],m=[m],g.xa){if(5>i){A=7;break}u=a,f=m,C=o,null==e||5>i?e=0:5<=i&&47==e[r+0]&&!(e[r+4]>>5)?(y=[0],v=[0],_=[0],E(w=new I,e,r,i),ge(w,y,v,_)?(null!=u&&(u[0]=y[0]),null!=f&&(f[0]=v[0]),null!=C&&(C[0]=_[0]),e=1):e=0):e=0}else{if(10>i){A=7;break}u=m,null==e||10>i||!Ke(e,r+3,i-3)?e=0:(f=e[r+0]|e[r+1]<<8|e[r+2]<<16,C=16383&(e[r+7]<<8|e[r+6]),e=16383&(e[r+9]<<8|e[r+8]),1&f||3<(f>>1&7)||!(f>>4&1)||f>>5>=g.Ja||!C||!e?e=0:(a&&(a[0]=C),u&&(u[0]=e),e=1))}if(!e)return 3;if(a=a[0],m=m[0],p&&(d[0]!=a||c[0]!=m))return 3;null!=h&&(h[0]=g,h.offset=r-h.w,t(4294967286>r-h.w),t(h.offset==h.ha-i));break}return 0==A||7==A&&p&&null==h?(null!=o&&(o[0]|=null!=g.na&&0<g.na.length),null!=l&&(l[0]=a),null!=s&&(s[0]=m),0):A}function Bn(e,t,n){var r=t.width,i=t.height,l=0,s=0,o=r,a=i;if(t.Da=null!=e&&0<e.Da,t.Da&&(o=e.cd,a=e.bd,l=e.v,s=e.j,11>n||(l&=-2,s&=-2),0>l||0>s||0>=o||0>=a||l+o>r||s+a>i))return 0;if(t.v=l,t.j=s,t.va=l+o,t.o=s+a,t.U=o,t.T=a,t.da=null!=e&&0<e.da,t.da){if(!B(o,a,n=[e.ib],l=[e.hb]))return 0;t.ib=n[0],t.hb=l[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*r/4&&t.hb<3*i/4,t.Kb=0),1}function kn(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function On(e,t,n,r){if(null==r||0>=e||0>=t)return 2;if(null!=n){if(n.Da){var i=n.cd,s=n.bd,o=-2&n.v,a=-2&n.j;if(0>o||0>a||0>=i||0>=s||o+i>e||a+s>t)return 2;e=i,t=s}if(n.da){if(!B(e,t,i=[n.ib],s=[n.hb]))return 2;e=i[0],t=s[0]}}r.width=e,r.height=t;e:{var u=r.width,h=r.height;if(e=r.S,0>=u||0>=h||!(e>=Br&&13>e))e=2;else{if(0>=r.Rd&&null==r.sd){o=s=i=t=0;var d=(a=u*Hi[e])*h;if(11>e||(s=(h+1)/2*(t=(u+1)/2),12==e&&(o=(i=u)*h)),null==(h=l(d+2*s+o))){e=1;break e}r.sd=h,11>e?((u=r.f.RGBA).eb=h,u.fb=0,u.A=a,u.size=d):((u=r.f.kb).y=h,u.O=0,u.fa=a,u.Fd=d,u.f=h,u.N=0+d,u.Ab=t,u.Cd=s,u.ea=h,u.W=0+d+s,u.Db=t,u.Ed=s,12==e&&(u.F=h,u.J=0+d+2*s),u.Tc=o,u.lb=i)}if(t=1,i=r.S,s=r.width,o=r.height,i>=Br&&13>i)if(11>i)e=r.f.RGBA,t&=(a=Math.abs(e.A))*(o-1)+s<=e.size,t&=a>=s*Hi[i],t&=null!=e.eb;else{e=r.f.kb,a=(s+1)/2,d=(o+1)/2,u=Math.abs(e.fa),h=Math.abs(e.Ab);var c=Math.abs(e.Db),p=Math.abs(e.lb),f=p*(o-1)+s;t&=u*(o-1)+s<=e.Fd,t&=h*(d-1)+a<=e.Cd,t=(t&=c*(d-1)+a<=e.Ed)&u>=s&h>=a&c>=a,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==i&&(t&=p>=s,t&=f<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=n&&n.fd&&(e=kn(r)),e}var Gn=64,Xn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Vn=24,Hn=32,Un=8,Wn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];G("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,n){return t[n+0]},e.Predictor3=function(e,t,n){return t[n+1]},e.Predictor4=function(e,t,n){return t[n-1]},e.Predictor5=function(e,t,n){return V(V(e,t[n+1]),t[n+0])},e.Predictor6=function(e,t,n){return V(e,t[n-1])},e.Predictor7=function(e,t,n){return V(e,t[n+0])},e.Predictor8=function(e,t,n){return V(t[n-1],t[n+0])},e.Predictor9=function(e,t,n){return V(t[n+0],t[n+1])},e.Predictor10=function(e,t,n){return V(V(e,t[n-1]),V(t[n+0],t[n+1]))},e.Predictor11=function(e,t,n){var r=t[n+0];return 0>=W(r>>24&255,e>>24&255,(t=t[n-1])>>24&255)+W(r>>16&255,e>>16&255,t>>16&255)+W(r>>8&255,e>>8&255,t>>8&255)+W(255&r,255&e,255&t)?r:e},e.Predictor12=function(e,t,n){var r=t[n+0];return(H((e>>24&255)+(r>>24&255)-((t=t[n-1])>>24&255))<<24|H((e>>16&255)+(r>>16&255)-(t>>16&255))<<16|H((e>>8&255)+(r>>8&255)-(t>>8&255))<<8|H((255&e)+(255&r)-(255&t)))>>>0},e.Predictor13=function(e,t,n){var r=t[n-1];return(U((e=V(e,t[n+0]))>>24&255,r>>24&255)<<24|U(e>>16&255,r>>16&255)<<16|U(e>>8&255,r>>8&255)<<8|U(e>>0&255,r>>0&255))>>>0};var jn=e.PredictorAdd0;e.PredictorAdd1=j,G("Predictor2","PredictorAdd2"),G("Predictor3","PredictorAdd3"),G("Predictor4","PredictorAdd4"),G("Predictor5","PredictorAdd5"),G("Predictor6","PredictorAdd6"),G("Predictor7","PredictorAdd7"),G("Predictor8","PredictorAdd8"),G("Predictor9","PredictorAdd9"),G("Predictor10","PredictorAdd10"),G("Predictor11","PredictorAdd11"),G("Predictor12","PredictorAdd12"),G("Predictor13","PredictorAdd13");var zn=e.PredictorAdd2;K("ColorIndexInverseTransform","MapARGB","32b",(function(e){return e>>8&255}),(function(e){return e})),K("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(e){return e}),(function(e){return e>>8&255}));var Yn,Qn=e.ColorIndexInverseTransform,Kn=e.MapARGB,qn=e.VP8LColorIndexInverseTransformAlpha,Jn=e.MapAlpha,Zn=e.VP8LPredictorsAdd=[];Zn.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var $n,er,tr,nr,rr,ir,lr,sr,or,ar,ur,hr,dr,cr,pr,fr,gr,mr,Er,Cr,Ar,yr,Ir,Sr,_r,wr,br,xr,Pr=l(511),vr=l(2041),Tr=l(225),Mr=l(767),Lr=0,Dr=vr,Rr=Tr,Fr=Mr,Nr=Pr,Br=0,kr=1,Or=2,Gr=3,Xr=4,Vr=5,Hr=6,Ur=7,Wr=8,jr=9,zr=10,Yr=[2,3,7],Qr=[3,3,11],Kr=[280,256,256,256,40],qr=[0,1,1,1,0],Jr=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Zr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],$r=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ei=8,ti=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ni=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ri=null,ii=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],li=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],si=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],oi=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ai=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ui=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],hi=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],di=[],ci=[],pi=[],fi=1,gi=2,mi=[],Ei=[];Cn("UpsampleRgbLinePair",wn,3),Cn("UpsampleBgrLinePair",bn,3),Cn("UpsampleRgbaLinePair",Mn,4),Cn("UpsampleBgraLinePair",Tn,4),Cn("UpsampleArgbLinePair",vn,4),Cn("UpsampleRgba4444LinePair",Pn,2),Cn("UpsampleRgb565LinePair",xn,2);var Ci=e.UpsampleRgbLinePair,Ai=e.UpsampleBgrLinePair,yi=e.UpsampleRgbaLinePair,Ii=e.UpsampleBgraLinePair,Si=e.UpsampleArgbLinePair,_i=e.UpsampleRgba4444LinePair,wi=e.UpsampleRgb565LinePair,bi=16,xi=1<<bi-1,Pi=-227,vi=482,Ti=6,Mi=(256<<Ti)-1,Li=0,Di=l(256),Ri=l(256),Fi=l(256),Ni=l(256),Bi=l(vi-Pi),ki=l(vi-Pi);Ln("YuvToRgbRow",wn,3),Ln("YuvToBgrRow",bn,3),Ln("YuvToRgbaRow",Mn,4),Ln("YuvToBgraRow",Tn,4),Ln("YuvToArgbRow",vn,4),Ln("YuvToRgba4444Row",Pn,2),Ln("YuvToRgb565Row",xn,2);var Oi=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Gi=[0,2,8],Xi=[8,7,6,4,4,2,2,2,1,1,1,1],Vi=1;this.WebPDecodeRGBA=function(e,n,r,i,l){var s=kr,o=new nn,a=new se;o.ba=a,a.S=s,a.width=[a.width],a.height=[a.height];var u=a.width,h=a.height,d=new oe;if(null==d||null==e)var c=2;else t(null!=d),c=Nn(e,n,r,d.width,d.height,d.Pd,d.Qd,d.format,null);if(0!=c?u=0:(null!=u&&(u[0]=d.width[0]),null!=h&&(h[0]=d.height[0]),u=1),u){a.width=a.width[0],a.height=a.height[0],null!=i&&(i[0]=a.width),null!=l&&(l[0]=a.height);e:{if(i=new ze,(l=new rn).data=e,l.w=n,l.ha=r,l.kd=1,n=[0],t(null!=l),(0==(e=Nn(l.data,l.w,l.ha,null,null,null,n,null,l))||7==e)&&n[0]&&(e=4),0==(n=e)){if(t(null!=o),i.data=l.data,i.w=l.w+l.offset,i.ha=l.ha-l.offset,i.put=pe,i.ac=ce,i.bc=fe,i.ma=o,l.xa){if(null==(e=ve())){o=1;break e}if(function(e,n){var r=[0],i=[0],l=[0];t:for(;;){if(null==e)return 0;if(null==n)return e.a=2,0;if(e.l=n,e.a=0,E(e.m,n.data,n.w,n.ha),!ge(e.m,r,i,l)){e.a=3;break t}if(e.xb=gi,n.width=r[0],n.height=i[0],!Te(r[0],i[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,i)){if(i=0==(n=On(i.width,i.height,o.Oa,o.ba))){t:{i=e;n:for(;;){if(null==i){i=0;break t}if(t(null!=i.s.yc),t(null!=i.s.Ya),t(0<i.s.Wb),t(null!=(r=i.l)),t(null!=(l=r.ma)),0!=i.xb){if(i.ca=l.ba,i.tb=l.tb,t(null!=i.ca),!Bn(l.Oa,r,Gr)){i.a=2;break n}if(!Me(i,r.width))break n;if(r.da)break n;if((r.da||re(i.ca.S))&&En(),11>i.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=i.ca.f.kb.F&&En()),i.Pb&&0<i.s.ua&&null==i.s.vb.X&&!R(i.s.vb,i.s.Wa.Xa)){i.a=1;break n}i.xb=0}if(!xe(i,i.V,i.Ba,i.c,i.i,r.o,Se))break n;l.Dc=i.Ma,i=1;break t}t(0!=i.a),i=0}i=!i}i&&(n=e.a)}else n=e.a}else{if(null==(e=new Ye)){o=1;break e}if(e.Fa=l.na,e.P=l.P,e.qc=l.Sa,qe(e,i)){if(0==(n=On(i.width,i.height,o.Oa,o.ba))){if(e.Aa=0,r=o.Oa,t(null!=(l=e)),null!=r){if(0<(u=0>(u=r.Md)?0:100<u?255:255*u/100)){for(h=d=0;4>h;++h)12>(c=l.pb[h]).lc&&(c.ia=u*Xi[0>c.lc?0:c.lc]>>3),d|=c.ia;d&&(alert("todo:VP8InitRandom"),l.ia=1)}l.Ga=r.Id,100<l.Ga?l.Ga=100:0>l.Ga&&(l.Ga=0)}$e(e,i)||(n=e.a)}}else n=e.a}0==n&&null!=o.Oa&&o.Oa.fd&&(n=kn(o.ba))}o=n}s=0!=o?null:11>s?a.f.RGBA.eb:a.f.kb.y}else s=null;return s};var Hi=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(e,t){for(var n="",r=0;r<4;r++)n+=String.fromCharCode(e[t++]);return n}function h(e,t){return(e[t+0]<<0|e[t+1]<<8|e[t+2]<<16)>>>0}function d(e,t){return(e[t+0]<<0|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new a;var c=[0],p=[0],f=[],g=new a,m=e,E=function(e,t){var n={},r=0,i=!1,l=0,s=0;if(n.frames=[],!function(e,t,n,r){for(var i=0;i<4;i++)if(e[t+i]!="RIFF".charCodeAt(i))return!0;return!1}(e,t)){var o,a;for(d(e,t+=4),t+=8;t<e.length;){var c=u(e,t),p=d(e,t+=4);t+=4;var f=p+(1&p);switch(c){case"VP8 ":case"VP8L":void 0===n.frames[r]&&(n.frames[r]={}),(E=n.frames[r]).src_off=i?s:t-8,E.src_size=l+p+8,r++,i&&(i=!1,l=0,s=0);break;case"VP8X":(E=n.header={}).feature_flags=e[t];var g=t+4;E.canvas_width=1+h(e,g),g+=3,E.canvas_height=1+h(e,g),g+=3;break;case"ALPH":i=!0,l=f+8,s=t-8;break;case"ANIM":(E=n.header).bgcolor=d(e,t),g=t+4,E.loop_count=(o=e)[(a=g)+0]<<0|o[a+1]<<8,g+=2;break;case"ANMF":var m,E;(E=n.frames[r]={}).offset_x=2*h(e,t),t+=3,E.offset_y=2*h(e,t),t+=3,E.width=1+h(e,t),t+=3,E.height=1+h(e,t),t+=3,E.duration=h(e,t),t+=3,m=e[t++],E.dispose=1&m,E.blend=m>>1&1}"ANMF"!=c&&(t+=f)}return n}}(m,0);E.response=m,E.rgbaoutput=!0,E.dataurl=!1;var C=E.header?E.header:null,A=E.frames?E.frames:null;if(C){C.loop_counter=C.loop_count,c=[C.canvas_height],p=[C.canvas_width];for(var y=0;y<A.length&&0!=A[y].blend;y++);}var I=A[0],S=g.WebPDecodeRGBA(m,I.src_off,I.src_size,p,c);I.rgba=S,I.imgwidth=p[0],I.imgheight=c[0];for(var _=0;_<p[0]*c[0]*4;_++)f[_]=S[_];return this.width=p,this.height=c,this.data=f,this}!function(e){var t=function(t,r,u,h){var d=4,c=s;switch(h){case e.image_compression.FAST:d=1,c=i;break;case e.image_compression.MEDIUM:d=6,c=o;break;case e.image_compression.SLOW:d=9,c=a}t=n(t,r,u,c);var p=Object(l.b)(t,{level:d});return e.__addimage__.arrayBufferToBinaryString(p)},n=function(e,t,n,r){for(var i,l,s,o=e.length/t,a=new Uint8Array(e.length+o),u=h(),c=0;c<o;c+=1){if(s=c*t,i=e.subarray(s,s+t),r)a.set(r(i,n,l),s+c);else{for(var p,f=u.length,g=[];p<f;p+=1)g[p]=u[p](i,n,l);var m=d(g.concat());a.set(g[m],s+c)}l=i}return a},r=function(e){var t=Array.apply([],e);return t.unshift(0),t},i=function(e,t){var n,r=[],i=e.length;r[0]=1;for(var l=0;l<i;l+=1)n=e[l-t]||0,r[l+1]=e[l]-n+256&255;return r},s=function(e,t,n){var r,i=[],l=e.length;i[0]=2;for(var s=0;s<l;s+=1)r=n&&n[s]||0,i[s+1]=e[s]-r+256&255;return i},o=function(e,t,n){var r,i,l=[],s=e.length;l[0]=3;for(var o=0;o<s;o+=1)r=e[o-t]||0,i=n&&n[o]||0,l[o+1]=e[o]+256-(r+i>>>1)&255;return l},a=function(e,t,n){var r,i,l,s,o=[],a=e.length;o[0]=4;for(var h=0;h<a;h+=1)r=e[h-t]||0,i=n&&n[h]||0,l=n&&n[h-t]||0,s=u(r,i,l),o[h+1]=e[h]-s+256&255;return o},u=function(e,t,n){if(e===t&&t===n)return e;var r=Math.abs(t-n),i=Math.abs(e-n),l=Math.abs(e+t-n-n);return r<=i&&r<=l?e:i<=l?t:n},h=function(){return[r,i,s,o,a]},d=function(e){var t=e.map((function(e){return e.reduce((function(e,t){return e+Math.abs(t)}),0)}));return t.indexOf(Math.min.apply(null,t))};e.processPNG=function(n,r,i,s){var o,a,u,h,d,c,p,f,g,m,E,C,A,y,I,S=this.decode.FLATE_DECODE,_="";if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){if(n=(u=new $e(n)).imgData,a=u.bits,o=u.colorSpace,d=u.colors,-1!==[4,6].indexOf(u.colorType)){if(8===u.bits){g=(f=32==u.pixelBitlength?new Uint32Array(u.decodePixels().buffer):16==u.pixelBitlength?new Uint16Array(u.decodePixels().buffer):new Uint8Array(u.decodePixels().buffer)).length,E=new Uint8Array(g*u.colors),m=new Uint8Array(g);var w,b=u.pixelBitlength-u.bits;for(y=0,I=0;y<g;y++){for(A=f[y],w=0;w<b;)E[I++]=A>>>w&255,w+=u.bits;m[y]=A>>>w&255}}if(16===u.bits){g=(f=new Uint32Array(u.decodePixels().buffer)).length,E=new Uint8Array(g*(32/u.pixelBitlength)*u.colors),m=new Uint8Array(g*(32/u.pixelBitlength)),C=u.colors>1,y=0,I=0;for(var x=0;y<g;)A=f[y++],E[I++]=A>>>0&255,C&&(E[I++]=A>>>16&255,A=f[y++],E[I++]=A>>>0&255),m[x++]=A>>>16&255;a=8}s!==e.image_compression.NONE&&"function"==typeof l.b?(n=t(E,u.width*u.colors,u.colors,s),p=t(m,u.width,1,s)):(n=E,p=m,S=void 0)}if(3===u.colorType&&(o=this.color_spaces.INDEXED,c=u.palette,u.transparency.indexed)){var P=u.transparency.indexed,v=0;for(y=0,g=P.length;y<g;++y)v+=P[y];if((v/=255)==g-1&&-1!==P.indexOf(0))h=[P.indexOf(0)];else if(v!==g){for(f=u.decodePixels(),m=new Uint8Array(f.length),y=0,g=f.length;y<g;y++)m[y]=P[f[y]];p=t(m,u.width,1)}}var T=function(t){var n;switch(t){case e.image_compression.FAST:n=11;break;case e.image_compression.MEDIUM:n=13;break;case e.image_compression.SLOW:n=14;break;default:n=12}return n}(s);return S===this.decode.FLATE_DECODE&&(_="/Predictor "+T+" "),_+="/Colors "+d+" /BitsPerComponent "+a+" /Columns "+u.width,(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:i,data:n,index:r,filter:S,decodeParameters:_,transparency:h,palette:c,sMask:p,predictor:T,width:u.width,height:u.height,bitsPerComponent:a,colorSpace:o}}}}(G.API),function(e){e.processGIF89A=function(t,n,r,i){var l=new et(t),s=l.width,o=l.height,a=[];l.decodeAndBlitFrameRGBA(0,a);var u={data:a,width:s,height:o},h=new nt(100).encode(u,100);return e.processJPEG.call(this,h,n,r,i)},e.processGIF87A=e.processGIF89A}(G.API),rt.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:r,blue:n,quad:l}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},rt.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(e){a.log("bit decode error:"+e)}},rt.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var l=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var a=this.palette[l>>7-o&1];this.data[s+4*o]=a.blue,this.data[s+4*o+1]=a.green,this.data[s+4*o+2]=a.red,this.data[s+4*o+3]=255}0!==n&&(this.pos+=4-n)}},rt.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<e;i++){var l=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+2*i*4,o=l>>4,a=15&l,u=this.palette[o];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*i+1>=this.width)break;u=this.palette[a],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}0!==t&&(this.pos+=4-t)}},rt.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+4*r;if(i<this.palette.length){var s=this.palette[i];this.data[l]=s.red,this.data[l+1]=s.green,this.data[l+2]=s.blue,this.data[l+3]=255}else this.data[l]=255,this.data[l+1]=255,this.data[l+2]=255,this.data[l+3]=255}0!==e&&(this.pos+=4-e)}},rt.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(l&t)/t*255|0,o=(l>>5&t)/t*255|0,a=(l>>10&t)/t*255|0,u=l>>15?255:0,h=r*this.width*4+4*i;this.data[h]=a,this.data[h+1]=o,this.data[h+2]=s,this.data[h+3]=u}this.pos+=e}},rt.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,l=0;l<this.width;l++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,a=(s>>5&n)/n*255|0,u=(s>>11)/t*255|0,h=i*this.width*4+4*l;this.data[h]=u,this.data[h+1]=a,this.data[h+2]=o,this.data[h+3]=255}this.pos+=e}},rt.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;this.data[s]=l,this.data[s+1]=i,this.data[s+2]=r,this.data[s+3]=255}this.pos+=this.width%4}},rt.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=l,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=s}},rt.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,i){var l=new rt(t,!1),s=l.width,o=l.height,a={data:l.getData(),width:s,height:o},u=new nt(100).encode(a,100);return e.processJPEG.call(this,u,n,r,i)}}(G.API),it.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,i){var l=new it(t,!1),s=l.width,o=l.height,a={data:l.getData(),width:s,height:o},u=new nt(100).encode(a,100);return e.processJPEG.call(this,u,n,r,i)}}(G.API),G.API.processRGBA=function(e,t,n){for(var r=e.data,i=r.length,l=new Uint8Array(i/4*3),s=new Uint8Array(i/4),o=0,a=0,u=0;u<i;u+=4){var h=r[u],d=r[u+1],c=r[u+2],p=r[u+3];l[o++]=h,l[o++]=d,l[o++]=c,s[a++]=p}var f=this.__addimage__.arrayBufferToBinaryString(l);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:f,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},G.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},Qe=G.API,Ke=Qe.getCharWidthsArray=function(e,t){var n,r,l=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),a=t.widths?t.widths:l.metadata.Unicode.widths,u=a.fof?a.fof:1,h=t.kerning?t.kerning:l.metadata.Unicode.kerning,d=h.fof?h.fof:1,c=!1!==t.doKerning,p=0,f=e.length,g=0,m=a[0]||u,E=[];for(n=0;n<f;n++)r=e.charCodeAt(n),"function"==typeof l.metadata.widthOfString?E.push((l.metadata.widthOfGlyph(l.metadata.characterToGlyph(r))+o*(1e3/s)||0)/1e3):(p=c&&"object"===i()(h[r])&&!isNaN(parseInt(h[r][g],10))?h[r][g]/d:0,E.push((a[r]||m)/u+p)),g=r;return E},qe=Qe.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return Qe.processArabic&&(e=Qe.processArabic(e)),"function"==typeof r.metadata.widthOfString?r.metadata.widthOfString(e,n,i)/n:Ke.apply(this,arguments).reduce((function(e,t){return e+t}),0)},Je=function(e,t,n,r){for(var i=[],l=0,s=e.length,o=0;l!==s&&o+t[l]<n;)o+=t[l],l++;i.push(e.slice(0,l));var a=l;for(o=0;l!==s;)o+t[l]>r&&(i.push(e.slice(a,l)),o=0,a=l),o+=t[l],l++;return a!==l&&i.push(e.slice(a,l)),i},Ze=function(e,t,n){n||(n={});var r,i,l,s,o,a,u,h=[],d=[h],c=n.textIndent||0,p=0,f=0,g=e.split(" "),m=Ke.apply(this,[" ",n])[0];if(a=-1===n.lineIndent?g[0].length+2:n.lineIndent||0){var E=Array(a).join(" "),C=[];g.map((function(e){(e=e.split(/\s*\n/)).length>1?C=C.concat(e.map((function(e,t){return(t&&e.length?"\n":"")+e}))):C.push(e[0])})),g=C,a=qe.apply(this,[E,n])}for(l=0,s=g.length;l<s;l++){var A=0;if(r=g[l],a&&"\n"==r[0]&&(r=r.substr(1),A=1),c+p+(f=(i=Ke.apply(this,[r,n])).reduce((function(e,t){return e+t}),0))>t||A){if(f>t){for(o=Je.apply(this,[r,i,t-(c+p),t]),h.push(o.shift()),h=[o.pop()];o.length;)d.push([o.shift()]);f=i.slice(r.length-(h[0]?h[0].length:0)).reduce((function(e,t){return e+t}),0)}else h=[r];d.push(h),c=f+a,p=m}else h.push(r),c+=p+f,p=m}return u=a?function(e,t){return(t?E:"")+e.join(" ")}:function(e){return e.join(" ")},d.map(u)},Qe.splitTextToSize=function(e,t,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),l=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle);return t.metadata.Unicode?{widths:t.metadata.Unicode.widths||{0:1},kerning:t.metadata.Unicode.kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/i;l.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,l.lineIndent=n.lineIndent;var o,a,u=[];for(o=0,a=r.length;o<a;o++)u=u.concat(Ze.apply(this,[r[o],s,l]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},r={},l=0;l<t.length;l++)n[t[l]]="0123456789abcdef"[l],r["0123456789abcdef"[l]]=t[l];var s=function(e){return"0x"+parseInt(e,10).toString(16)},o=e.__fontmetrics__.compress=function(e){var t,n,l,a,u=["{"];for(var h in e){if(t=e[h],isNaN(parseInt(h,10))?n="'"+h+"'":(h=parseInt(h,10),n=(n=s(h).slice(2)).slice(0,-1)+r[n.slice(-1)]),"number"==typeof t)t<0?(l=s(t).slice(3),a="-"):(l=s(t).slice(2),a=""),l=a+l.slice(0,-1)+r[l.slice(-1)];else{if("object"!==i()(t))throw new Error("Don't know what to do with value type "+i()(t)+".");l=o(t)}u.push(n+l)}return u.push("}"),u.join("")},a=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,r,i,l,s={},o=1,a=s,u=[],h="",d="",c=e.length-1,p=1;p<c;p+=1)"'"==(l=e[p])?t?(i=t.join(""),t=void 0):t=[]:t?t.push(l):"{"==l?(u.push([a,i]),a={},i=void 0):"}"==l?((r=u.pop())[0][r[1]]=a,i=void 0,a=r[0]):"-"==l?o=-1:void 0===i?n.hasOwnProperty(l)?(h+=n[l],i=parseInt(h,16)*o,o=1,h=""):h+=l:n.hasOwnProperty(l)?(d+=n[l],a[i]=parseInt(d,16)*o,o=1,i=void 0,d=""):d+=l;return s},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},d={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,n=d.Unicode[t.postScriptName];n&&(t.metadata.Unicode={},t.metadata.Unicode.widths=n.widths,t.metadata.Unicode.kerning=n.kerning);var r=h.Unicode[t.postScriptName];r&&(t.metadata.Unicode.encoding=r,t.encoding=r.codePages[0])}])}(G.API),function(e){var t=function(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n};e.API.events.push(["addFont",function(n){var r=void 0,i=n.font,l=n.instance;if(!i.isStandardFont){if(void 0===l)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if("string"!=typeof(r=!1===l.existsFileInVFS(i.postScriptName)?l.loadFile(i.postScriptName):l.getFileFromVFS(i.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");!function(n,r){r=/^\x00\x01\x00\x00/.test(r)?t(r):t(c(r)),n.metadata=e.API.TTFFont.open(r),n.metadata.Unicode=n.metadata.Unicode||{encoding:{},kerning:{},widths:[]},n.metadata.glyIdsUsed=[0]}(i,r)}}])}(G),function(e){function t(){return(s.canvg?Promise.resolve(s.canvg):Promise.resolve().then(n.t.bind(null,1196,7))).catch((function(e){return Promise.reject(new Error("Could not load canvg: "+e))})).then((function(e){return e.default?e.default:e}))}G.API.addSvgAsImage=function(e,n,r,i,l,s,o,u){if(isNaN(n)||isNaN(r))throw a.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(l))throw a.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=i,h.height=l;var d=h.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,h.width,h.height);var c={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return t().then((function(t){return t.fromString(d,e,c)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(e){return e.render(c)})).then((function(){p.addImage(h.toDataURL("image/jpeg",1),n,r,i,l,o,u)}))}}(),G.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(t,n);return this},G.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var r,l,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(o),u=[],h=0,d=0,c=0;function p(e,t){var n,r=!1;for(n=0;n<e.length;n+=1)e[n]===t&&(r=!0);return r}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var f=a.length;for(c=0;c<f;c+=1)n[a[c]].value=n[a[c]].defaultValue,n[a[c]].explicitSet=!1}if("object"===i()(e))for(l in e)if(s=e[l],p(a,l)&&void 0!==s){if("boolean"===n[l].type&&"boolean"==typeof s)n[l].value=s;else if("name"===n[l].type&&p(n[l].valueSet,s))n[l].value=s;else if("integer"===n[l].type&&Number.isInteger(s))n[l].value=s;else if("array"===n[l].type){for(h=0;h<s.length;h+=1)if(r=!0,1===s[h].length&&"number"==typeof s[h][0])u.push(String(s[h]-1));else if(s[h].length>1){for(d=0;d<s[h].length;d+=1)"number"!=typeof s[h][d]&&(r=!1);!0===r&&u.push([s[h][0]-1,s[h][1]-1].join(" "))}n[l].value="["+u.join(" ")+"]"}else n[l].value=n[l].defaultValue;n[l].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){var e,t=[];for(e in n)!0===n[e].explicitSet&&("name"===n[e].type?t.push("/"+e+" /"+n[e].value):t.push("/"+e+" "+n[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),n=unescape(encodeURIComponent(e)),r=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),i=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),s=n.length+r.length+i.length+t.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+s+" >>"),this.internal.write("stream"),this.internal.write(t+n+r+i+l),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,r){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(G.API),function(e){var t=e.API,n=t.pdfEscape16=function(e,t){for(var n,r=t.metadata.Unicode.widths,i=["","0","00","000","0000"],l=[""],s=0,o=e.length;s<o;++s){if(n=t.metadata.characterToGlyph(e.charCodeAt(s)),t.metadata.glyIdsUsed.push(n),t.metadata.toUnicode[n]=e.charCodeAt(s),-1==r.indexOf(n)&&(r.push(n),r.push([parseInt(t.metadata.widthOfGlyph(n),10)])),"0"==n)return l.join("");n=n.toString(16),l.push(i[4-n.length],n)}return l.join("")},r=function(e){var t,n,r,i,l,s,o;for(l="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",r=[],s=0,o=(n=Object.keys(e).sort((function(e,t){return e-t}))).length;s<o;s++)t=n[s],r.length>=100&&(l+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar",r=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(i=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),r.push("<"+t+"><"+i+">"));return r.length&&(l+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar\n"),l+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var n=t.font,i=t.out,l=t.newObject,s=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"Identity-H"===n.encoding){for(var o=n.metadata.Unicode.widths,a=n.metadata.subset.encode(n.metadata.glyIdsUsed,1),u="",h=0;h<a.length;h++)u+=String.fromCharCode(a[h]);var d=l();s({data:u,addLength1:!0,objectId:d}),i("endobj");var c=l();s({data:r(n.metadata.toUnicode),addLength1:!0,objectId:c}),i("endobj");var p=l();i("<<"),i("/Type /FontDescriptor"),i("/FontName /"+R(n.fontName)),i("/FontFile2 "+d+" 0 R"),i("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),i("/Flags "+n.metadata.flags),i("/StemV "+n.metadata.stemV),i("/ItalicAngle "+n.metadata.italicAngle),i("/Ascent "+n.metadata.ascender),i("/Descent "+n.metadata.decender),i("/CapHeight "+n.metadata.capHeight),i(">>"),i("endobj");var f=l();i("<<"),i("/Type /Font"),i("/BaseFont /"+R(n.fontName)),i("/FontDescriptor "+p+" 0 R"),i("/W "+e.API.PDFObject.convert(o)),i("/CIDToGIDMap /Identity"),i("/DW 1000"),i("/Subtype /CIDFontType2"),i("/CIDSystemInfo"),i("<<"),i("/Supplement 0"),i("/Registry (Adobe)"),i("/Ordering ("+n.encoding+")"),i(">>"),i(">>"),i("endobj"),n.objectNumber=l(),i("<<"),i("/Type /Font"),i("/Subtype /Type0"),i("/ToUnicode "+c+" 0 R"),i("/BaseFont /"+R(n.fontName)),i("/Encoding /"+n.encoding),i("/DescendantFonts ["+f+" 0 R]"),i(">>"),i("endobj"),n.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var n=t.font,i=t.out,l=t.newObject,s=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===n.encoding){for(var o=n.metadata.rawData,a="",u=0;u<o.length;u++)a+=String.fromCharCode(o[u]);var h=l();s({data:a,addLength1:!0,objectId:h}),i("endobj");var d=l();s({data:r(n.metadata.toUnicode),addLength1:!0,objectId:d}),i("endobj");var c=l();i("<<"),i("/Descent "+n.metadata.decender),i("/CapHeight "+n.metadata.capHeight),i("/StemV "+n.metadata.stemV),i("/Type /FontDescriptor"),i("/FontFile2 "+h+" 0 R"),i("/Flags 96"),i("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),i("/FontName /"+R(n.fontName)),i("/ItalicAngle "+n.metadata.italicAngle),i("/Ascent "+n.metadata.ascender),i(">>"),i("endobj"),n.objectNumber=l();for(var p=0;p<n.metadata.hmtx.widths.length;p++)n.metadata.hmtx.widths[p]=parseInt(n.metadata.hmtx.widths[p]*(1e3/n.metadata.head.unitsPerEm));i("<</Subtype/TrueType/Type/Font/ToUnicode "+d+" 0 R/BaseFont/"+R(n.fontName)+"/FontDescriptor "+c+" 0 R/Encoding/"+n.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(n.metadata.hmtx.widths)+">>"),i("endobj"),n.isAlreadyPutted=!0}}(t)}]);var i=function(e){var t,r=e.text||"",i=e.x,l=e.y,s=e.options||{},o=e.mutex||{},a=o.pdfEscape,u=o.activeFontKey,h=o.fonts,d=u,c="",p=0,f="",g=h[d].encoding;if("Identity-H"!==h[d].encoding)return{text:r,x:i,y:l,options:s,mutex:o};for(f=r,d=u,Array.isArray(r)&&(f=r[0]),p=0;p<f.length;p+=1)h[d].metadata.hasOwnProperty("cmap")&&(t=h[d].metadata.cmap.unicode.codeMap[f[p].charCodeAt(0)]),t||f[p].charCodeAt(0)<256&&h[d].metadata.hasOwnProperty("Unicode")?c+=f[p]:c+="";var m="";return parseInt(d.slice(1))<14||"WinAnsiEncoding"===g?m=a(c,d).split("").map((function(e){return e.charCodeAt(0).toString(16)})).join(""):"Identity-H"===g&&(m=n(c,h[d])),o.isHex=!0,{text:m,x:i,y:l,options:s,mutex:o}};t.events.push(["postProcessText",function(e){var t=e.text||"",n=[],r={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var l=0;for(l=0;l<t.length;l+=1)Array.isArray(t[l])&&3===t[l].length?n.push([i(Object.assign({},r,{text:t[l][0]})).text,t[l][1],t[l][2]]):n.push(i(Object.assign({},r,{text:t[l]})).text);e.text=n}else e.text=i(Object.assign({},r,{text:t})).text}])}(G),function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(G.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var n,r,i,l,s,o,a,u=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],c={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},f=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),m=!1,E=0;this.__bidiEngine__={};var C=function(e){var t=e.charCodeAt(),n=t>>8,r=p[n];return void 0!==r?u[256*r+(255&t)]:252===n||253===n?"AL":g.test(n)?"L":8===n?"R":"N"},A=function(e){for(var t,n=0;n<e.length;n++){if("L"===(t=C(e.charAt(n))))return!1;if("R"===t)return!0}return!1},y=function(e,t,s,o){var a,u,h,d,c=t[o];switch(c){case"L":case"R":m=!1;break;case"N":case"AN":break;case"EN":m&&(c="AN");break;case"AL":m=!0,c="R";break;case"WS":c="N";break;case"CS":o<1||o+1>=t.length||"EN"!==(a=s[o-1])&&"AN"!==a||"EN"!==(u=t[o+1])&&"AN"!==u?c="N":m&&(u="AN"),c=u===a?u:"N";break;case"ES":c="EN"===(a=o>0?s[o-1]:"B")&&o+1<t.length&&"EN"===t[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===s[o-1]){c="EN";break}if(m){c="N";break}for(h=o+1,d=t.length;h<d&&"ET"===t[h];)h++;c=h<d&&"EN"===t[h]?"EN":"N";break;case"NSM":if(i&&!l){for(d=t.length,h=o+1;h<d&&"NSM"===t[h];)h++;if(h<d){var p=e[o],f=p>=1425&&p<=2303||64286===p;if(a=t[h],f&&("R"===a||"AL"===a)){c="R";break}}}c=o<1||"B"===(a=t[o-1])?"N":s[o-1];break;case"B":m=!1,n=!0,c=E;break;case"S":r=!0,c="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":m=!1;break;case"BN":c="N"}return c},I=function(e,t,n){var r=e.split("");return n&&S(r,n,{hiLevel:E}),r.reverse(),t&&t.reverse(),r.join("")},S=function(e,t,i){var l,s,o,a,u,p=-1,f=e.length,g=0,A=[],I=E?d:h,S=[];for(m=!1,n=!1,r=!1,s=0;s<f;s++)S[s]=C(e[s]);for(o=0;o<f;o++){if(u=g,A[o]=y(e,S,A,o),l=240&(g=I[u][c[A[o]]]),g&=15,t[o]=a=I[g][5],l>0)if(16===l){for(s=p;s<o;s++)t[s]=1;p=-1}else p=-1;if(I[g][6])-1===p&&(p=o);else if(p>-1){for(s=p;s<o;s++)t[s]=a;p=-1}"B"===S[o]&&(t[o]=0),i.hiLevel|=a}r&&function(e,t,n){for(var r=0;r<n;r++)if("S"===e[r]){t[r]=E;for(var i=r-1;i>=0&&"WS"===e[i];i--)t[i]=E}}(S,t,f)},_=function(e,t,r,i,l){if(!(l.hiLevel<e)){if(1===e&&1===E&&!n)return t.reverse(),void(r&&r.reverse());for(var s,o,a,u,h=t.length,d=0;d<h;){if(i[d]>=e){for(a=d+1;a<h&&i[a]>=e;)a++;for(u=d,o=a-1;u<o;u++,o--)s=t[u],t[u]=t[o],t[o]=s,r&&(s=r[u],r[u]=r[o],r[o]=s);d=a}d++}}},w=function(e,t,n){var r=e.split(""),i={hiLevel:E};return n||(n=[]),S(r,n,i),function(e,t,n){if(0!==n.hiLevel&&a)for(var r,i=0;i<e.length;i++)1===t[i]&&(r=f.indexOf(e[i]))>=0&&(e[i]=f[r+1])}(r,n,i),_(2,r,t,n,i),_(1,r,t,n,i),r.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,n){if(function(e,t){if(t)for(var n=0;n<e.length;n++)t[n]=n;void 0===l&&(l=A(e)),void 0===o&&(o=A(e))}(e,t),i||!s||o)if(i&&s&&l^o)E=l?1:0,e=I(e,t,n);else if(!i&&s&&o)E=l?1:0,e=w(e,t,n),e=I(e,t);else if(!i||l||s||o){if(i&&!s&&l^o)e=I(e,t),l?(E=0,e=w(e,t,n)):(E=1,e=w(e,t,n),e=I(e,t));else if(i&&l&&!s&&o)E=1,e=w(e,t,n),e=I(e,t);else if(!i&&!s&&l^o){var r=a;l?(E=1,e=w(e,t,n),E=0,a=!1,e=w(e,t,n),a=r):(E=0,e=w(e,t,n),e=I(e,t),E=1,a=!1,e=w(e,t,n),a=r,e=I(e,t))}}else E=0,e=w(e,t,n);else E=l?1:0,e=w(e,t,n);return e},this.__bidiEngine__.setOptions=function(e){e&&(i=e.isInputVisual,s=e.isOutputVisual,l=e.isInputRtl,o=e.isOutputRtl,a=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text,r=(e.x,e.y,e.options||{}),i=(e.mutex,r.lang,[]);if(r.isInputVisual="boolean"!=typeof r.isInputVisual||r.isInputVisual,n.setOptions(r),"[object Array]"===Object.prototype.toString.call(t)){var l=0;for(i=[],l=0;l<t.length;l+=1)"[object Array]"===Object.prototype.toString.call(t[l])?i.push([n.doBidiReorder(t[l][0]),t[l][1],t[l][2]]):i.push([n.doBidiReorder(t[l])]);e.text=i}else e.text=n.doBidiReorder(t);n.setOptions({isInputVisual:!0})}])}(G),G.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new st(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new bt(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new ot(this.contents),this.head=new ht(this),this.name=new Et(this),this.cmap=new ct(this),this.toUnicode={},this.hhea=new pt(this),this.maxp=new Ct(this),this.hmtx=new At(this),this.post=new gt(this),this.os2=new ft(this),this.loca=new wt(this),this.glyf=new It(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,n,r,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,n,r,i;for(i=[],t=0,n=(r=this.bbox).length;t<n;t++)e=r[t],i.push(Math.round(e*this.scaleFactor));return i}.call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),0!=(32768&(t=r>>16))&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(i=this.familyClass)||2===i||3===i||4===i||5===i||7===i,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,n){var r,i,l,s;for(l=0,i=0,s=(e=""+e).length;0<=s?i<s:i>s;i=0<=s?++i:--i)r=e.charCodeAt(i),l+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/t)||0;return l*(t/1e3)},e.prototype.lineHeight=function(e,t){var n;return null==t&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},e}();var lt,st=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(e){var t,n,r;for(r=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,n,r,i,l,s,o;return e=this.readByte(),t=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),l=this.readByte(),s=this.readByte(),o=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^i)+65536*(255^l)+256*(255^s)+(255^o)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*r+16777216*i+65536*l+256*s+o},e.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(e){var t,n,r,i;for(i=[],n=0,r=e.length;n<r;n++)t=e[n],i.push(this.writeByte(t));return i},e}(),ot=function(){var e;function t(e){var t,n,r;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},n=0,r=this.tableCount;0<=r?n<r:n>r;n=0<=r?++n:--n)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var n,r,i,l,s,o,a,u,h,d,c,p,f;for(f in c=Object.keys(t).length,o=Math.log(2),h=16*Math.floor(Math.log(c)/o),l=Math.floor(h/o),u=16*c-h,(r=new st).writeInt(this.scalarType),r.writeShort(c),r.writeShort(h),r.writeShort(l),r.writeShort(u),i=16*c,a=r.pos+i,s=null,p=[],t)for(d=t[f],r.writeString(f),r.writeInt(e(d)),r.writeInt(a),r.writeInt(d.length),p=p.concat(d),"head"===f&&(s=a),a+=d.length;a%4;)p.push(0),a++;return r.write(p),n=2981146554-e(r.data),r.pos=s+8,r.writeUInt32(n),r.data},e=function(e){var t,n,r,i;for(e=yt.call(e);e.length%4;)e.push(0);for(r=new st(e),n=0,t=0,i=e.length;t<i;t=t+=4)n+=r.readUInt32();return 4294967295&n},t}(),at={}.hasOwnProperty,ut=function(e,t){for(var n in t)at.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};lt=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var ht=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var t;return(t=new st).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},t}(),dt=function(){function e(e,t){var n,r,i,l,s,o,a,u,h,d,c,p,f,g,m,E,C;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),h=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=0;o<256;++o)this.codeMap[o]=e.readByte();break;case 4:for(c=e.readUInt16(),d=c/2,e.pos+=6,i=function(){var t,n;for(n=[],o=t=0;0<=d?t<d:t>d;o=0<=d?++t:--t)n.push(e.readUInt16());return n}(),e.pos+=2,f=function(){var t,n;for(n=[],o=t=0;0<=d?t<d:t>d;o=0<=d?++t:--t)n.push(e.readUInt16());return n}(),a=function(){var t,n;for(n=[],o=t=0;0<=d?t<d:t>d;o=0<=d?++t:--t)n.push(e.readUInt16());return n}(),u=function(){var t,n;for(n=[],o=t=0;0<=d?t<d:t>d;o=0<=d?++t:--t)n.push(e.readUInt16());return n}(),r=(this.length-e.pos+this.offset)/2,s=function(){var t,n;for(n=[],o=t=0;0<=r?t<r:t>r;o=0<=r?++t:--t)n.push(e.readUInt16());return n}(),o=m=0,C=i.length;m<C;o=++m)for(g=i[o],n=E=p=f[o];p<=g?E<=g:E>=g;n=p<=g?++E:--E)0===u[o]?l=n+a[o]:0!==(l=s[u[o]/2+(n-p)-(d-o)]||0)&&(l+=a[o]),this.codeMap[n]=65535&l}e.pos=h}return e.encode=function(e,t){var n,r,i,l,s,o,a,u,h,d,c,p,f,g,m,E,C,A,y,I,S,_,w,b,x,P,v,T,M,L,D,R,F,N,B,k,O,G,X,V,H,U,W,j,z,Y;switch(T=new st,l=Object.keys(e).sort((function(e,t){return e-t})),t){case"macroman":for(f=0,g=function(){var e=[];for(p=0;p<256;++p)e.push(0);return e}(),E={0:0},i={},M=0,F=l.length;M<F;M++)null==E[W=e[r=l[M]]]&&(E[W]=++f),i[r]={old:e[r],new:E[e[r]]},g[r]=E[e[r]];return T.writeUInt16(1),T.writeUInt16(0),T.writeUInt32(12),T.writeUInt16(0),T.writeUInt16(262),T.writeUInt16(0),T.write(g),{charMap:i,subtable:T.data,maxGlyphID:f+1};case"unicode":for(P=[],h=[],C=0,E={},n={},m=a=null,L=0,N=l.length;L<N;L++)null==E[y=e[r=l[L]]]&&(E[y]=++C),n[r]={old:y,new:E[y]},s=E[y]-r,null!=m&&s===a||(m&&h.push(m),P.push(r),a=s),m=r;for(m&&h.push(m),h.push(65535),P.push(65535),b=2*(w=P.length),_=2*Math.pow(Math.log(w)/Math.LN2,2),d=Math.log(_/2)/Math.LN2,S=2*w-_,o=[],I=[],c=[],p=D=0,B=P.length;D<B;p=++D){if(x=P[p],u=h[p],65535===x){o.push(0),I.push(0);break}if(x-(v=n[x].new)>=32768)for(o.push(0),I.push(2*(c.length+w-p)),r=R=x;x<=u?R<=u:R>=u;r=x<=u?++R:--R)c.push(n[r].new);else o.push(v-x),I.push(0)}for(T.writeUInt16(3),T.writeUInt16(1),T.writeUInt32(12),T.writeUInt16(4),T.writeUInt16(16+8*w+2*c.length),T.writeUInt16(0),T.writeUInt16(b),T.writeUInt16(_),T.writeUInt16(d),T.writeUInt16(S),H=0,k=h.length;H<k;H++)r=h[H],T.writeUInt16(r);for(T.writeUInt16(0),U=0,O=P.length;U<O;U++)r=P[U],T.writeUInt16(r);for(j=0,G=o.length;j<G;j++)s=o[j],T.writeUInt16(s);for(z=0,X=I.length;z<X;z++)A=I[z],T.writeUInt16(A);for(Y=0,V=c.length;Y<V;Y++)f=c[Y],T.writeUInt16(f);return{charMap:n,subtable:T.data,maxGlyphID:C+1}}},e}(),ct=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="cmap",t.prototype.parse=function(e){var t,n,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t=new dt(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},t.encode=function(e,t){var n,r;return null==t&&(t="macroman"),n=dt.encode(e,t),(r=new st).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},t}(),pt=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),ft=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n}(),this.charRange=function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),gt=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="post",t.prototype.parse=function(e){var t,n,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var i;for(n=e.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 196608:break;case 262144:return this.map=function(){var t,n,r;for(r=[],i=t=0,n=this.file.maxp.numGlyphs;0<=n?t<n:t>n;i=0<=n?++t:--t)r.push(e.readUInt32());return r}.call(this)}},t}(),mt=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Et=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="name",t.prototype.parse=function(e){var t,n,r,i,l,s,o,a,u,h,d;for(e.pos=this.offset,e.readShort(),t=e.readShort(),s=e.readShort(),n=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+s+e.readShort()});for(o={},i=u=0,h=n.length;u<h;i=++u)r=n[i],e.pos=r.offset,a=e.readString(r.length),l=new mt(a,r),null==o[d=r.nameID]&&(o[d]=[]),o[r.nameID].push(l);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(e){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},t}(),Ct=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),At=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="hmtx",t.prototype.parse=function(e){var t,n,r,i,l,s,o;for(e.pos=this.offset,this.metrics=[],t=0,s=this.file.hhea.numberOfMetrics;0<=s?t<s:t>s;t=0<=s?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var n,i;for(i=[],t=n=0;0<=r?n<r:n>r;t=0<=r?++n:--n)i.push(e.readInt16());return i}(),this.widths=function(){var e,t,n,r;for(r=[],e=0,t=(n=this.metrics).length;e<t;e++)i=n[e],r.push(i.advance);return r}.call(this),n=this.widths[this.widths.length-1],o=[],t=l=0;0<=r?l<r:l>r;t=0<=r?++l:--l)o.push(this.widths.push(n));return o},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),yt=[].slice,It=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var t,n,r,i,l,s,o,a,u,h;return e in this.cache?this.cache[e]:(i=this.file.loca,t=this.file.contents,n=i.indexOf(e),0===(r=i.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+n,l=(s=new st(t.read(r))).readShort(),a=s.readShort(),h=s.readShort(),o=s.readShort(),u=s.readShort(),this.cache[e]=-1===l?new _t(s,a,h,o,u):new St(s,l,a,h,o,u),this.cache[e]))},t.prototype.encode=function(e,t,n){var r,i,l,s,o;for(l=[],i=[],s=0,o=t.length;s<o;s++)r=e[t[s]],i.push(l.length),r&&(l=l.concat(r.encode(n)));return i.push(l.length),{table:l,offsets:i}},t}(),St=function(){function e(e,t,n,r,i,l){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),_t=function(){function e(e,t,n,r,i){var l,s;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=r,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;s=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&s;)l.pos+=1&s?4:2,128&s?l.pos+=8:64&s?l.pos+=4:8&s&&(l.pos+=2)}return e.prototype.encode=function(){var e,t,n;for(t=new st(yt.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),wt=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return ut(t,lt),t.prototype.tag="loca",t.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,r;for(r=[],n=0,t=this.length;n<t;n+=2)r.push(2*e.readUInt16());return r}.call(this):function(){var t,r;for(r=[],n=0,t=this.length;n<t;n+=4)r.push(e.readUInt32());return r}.call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),r=0,i=0,l=0;l<n.length;++l)if(n[l]=r,i<t.length&&t[i]==l){++i,n[l]=r;var s=this.offsets[l],o=this.offsets[l+1]-s;o>0&&(r+=o)}for(var a=new Array(4*n.length),u=0;u<n.length;++u)a[4*u+3]=255&n[u],a[4*u+2]=(65280&n[u])>>8,a[4*u+1]=(16711680&n[u])>>16,a[4*u]=(4278190080&n[u])>>24;return a},t}(),bt=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,n,r,i;for(t in r=this.font.cmap.tables[0].codeMap,e={},i=this.subset)n=i[t],e[t]=r[n];return e},e.prototype.glyphsFor=function(e){var t,n,r,i,l,s,o;for(r={},l=0,s=e.length;l<s;l++)r[i=e[l]]=this.font.glyf.glyphFor(i);for(i in t=[],r)(null!=(n=r[i])?n.compound:void 0)&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(i in o=this.glyphsFor(t))n=o[i],r[i]=n;return r},e.prototype.encode=function(e,t){var n,r,i,l,s,o,a,u,h,d,c,p,f,g,m;for(r in n=ct.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(e),c={0:0},m=n.charMap)c[(o=m[r]).old]=o.new;for(p in d=n.maxGlyphID,l)p in c||(c[p]=d++);return u=function(e){var t,n;for(t in n={},e)n[e[t]]=t;return n}(c),h=Object.keys(u).sort((function(e,t){return e-t})),f=function(){var e,t,n;for(n=[],e=0,t=h.length;e<t;e++)s=h[e],n.push(u[s]);return n}(),i=this.font.glyf.encode(l,f,c),a=this.font.loca.encode(i.offsets,f),g={cmap:this.font.cmap.raw(),glyf:i.table,loca:a,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},e}();G.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(n){var r,i,l,s;if(Array.isArray(n))return"["+function(){var e,i,l;for(l=[],e=0,i=n.length;e<i;e++)r=n[e],l.push(t.convert(r));return l}().join(" ")+"]";if("string"==typeof n)return"/"+n;if(null!=n?n.isString:void 0)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(n)){for(i in l=["<<"],n)s=n[i],l.push("/"+i+" "+t.convert(s));return l.push(">>"),l.join("\n")}return""+n},t}(),t.default=G}.call(this,n(1073))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetPageNumberInfo=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"GetPageNumberInfo"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl().MGetPageViewList();return this.resMsg.ReturnParams={pageTotalNumber:t.length},this.resMsg}}t.A_GetPageNumberInfo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_LocateCursorWithRelateId=void 0;const r=n(1),i=n(6),l=n(0),s=n(3),o=n(55);class a extends r.XBaseAction{constructor(e){super(e),this.edt_elerange=new o.EmrEditEleRange}ActName(){return"LocateCursorWithRelateId"}Execute(e){this.resMsg.Clear();try{let t=super.GetEdtCtrl();if(this.edt_elerange.SetEleEvtObjs(t.M_EleEvtModel,t.M_EleEvtHandler),e.length>0){let n=t.M_EleEvtModel.EleClickedWrap.EleFocused,r=e[0].undoRelateId,o=e[0].docId,a=null==e[0].position?"before":e[0].position,u=t.All_Document;for(let e=0;e<u.length;e++){let h=u[e];if(o&&h.DocID!=o)continue;let d,c,p=h.GetPagePanel(i.ENumPagePanelTp.Body),f=new s.List;p.GetAllBaseChildren(f,!1);let g,m=[],E=!1,C=!1;for(let e of f)if(E&&m.push(e),e.UndoRelateId==r){if(null!=d){c=e,C=!0;break}null==d&&(d=e,m.push(e),E=!0)}if(0==m.length)continue;if(C||(m=[d]),"before"==a)g=m[0];else{let e=m[m.length-1];g=l.XDomUtil.GetNextEle(!0,e)}t.M_EleEvtModel.ReInitSelRange(),t.M_EleEvtModel.LastEleClicked instanceof l.XImageEle&&(t.M_EleEvtModel.LastEleClicked.IsFocused=!1),t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(g);let A=t.M_EleEvtModel.EleClickedWrap.EleFocused;t.M_EleEvtHandler.OnCursorChange(n,A),t.M_EleEvtModel.MoveCaretByCursorEle(!0)}}this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}}t.A_LocateCursorWithRelateId=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetInputBorderHide=void 0;const r=n(1),i=n(0),l=n(38),s=n(6),o=n(80);class a extends r.XBaseAction{ActName(){return"SetInputBorderHide"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();try{let e=super.GetEdtCtrl(),t=e.M_DocumentFocused,n=new l.List;e.unfocus=!0,t.GetPagePanel(s.ENumPagePanelTp.Body).GetChildrenByTypes(["XInputField"],!0,n);for(let e of n)if(e instanceof i.XInputEle){let t=o.XInputUtil.GetInstance().BulidEleInfo_InputField(e);e.BorderVisible="hidden",e.ReBulidInputField(t.DefaultValue,null,t.DefalutValueIsChanged)}super.GetEdtCtrl().MRefreshDocView(t,!1),this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}}t.A_SetInputBorderHide=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ClearTitleContent=void 0;const r=n(1),i=n(3),l=n(0),s=n(32),o=n(6);class a extends r.XBaseAction{ActName(){return"ClearTitleContent"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();try{let n=super.GetEdtCtrl(),r=n.unfocus,a=n.All_Document;this.RefreshDocList=[];for(var t=0;t<e.length;t++){let n=e[t].conceptId,r=e[t].docId;for(let e=0;e<a.length;e++){let t=a[e];if(r&&r!=t.DocID)continue;let u,h=t.GetPagePanel(o.ENumPagePanelTp.Body),d=new i.List;h.GetChildrenByType("XTextLabelElement",!0,d);for(let e of d)e.CptID==n&&(u=e);if(null==u)continue;this.resetRefreshDocList(t);let c=u.Parent,p=c.GetChildInx(u),f=c.ChildEleList,g=!0;for(let e=p+1;e<f.Length;e++){let t=f.Get(e);if(t instanceof s.XTextLabelElement&&t.TitleLevel<=u.TitleLevel)break;t instanceof l.XInputEle&&!t.IsRemoved&&(g=!1)}for(let e=p+1;e<f.Length;e++){let t=f.Get(e);if(t instanceof s.XTextLabelElement&&t.TitleLevel<=u.TitleLevel)break;t instanceof l.XStringEle&&g?t.Text="":t instanceof l.XInputEle&&t.UpdateInnerText("")}}}this.MRefreshDocsView(),this.resMsg.ReturnParams=!0,n.unfocus=r}catch(e){this.resMsg.ReturnParams=!1}return this.resMsg}}t.A_ClearTitleContent=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_InsertSignEle=void 0;const r=n(54),i=n(68),l=n(42);class s extends i.A_BaseInsertInput{ActName(){return"InsertSignEle"}Execute(e){let t;this.resMsg.Clear();let n=e[0],i=new r.ElementInfo;i.Code_mrdetp="3001",i.conceptDomainCode=n.conceptDomainCode,i.Id_mr_de=n.elementCode,i.Name=n.elementName,i.Name_de=n.dataEmementName,i.ValueCode_de=n.dataEmementCode,i.Text_label=n.labelText,i.Suffix_label=n.suffixText,i.Text_background=n.backgroundText,i.Text_tip=n.tooltipText,i.Name_source=n.sourceName,i.Name_property=n.attributeName,i.DefaultValue=n.defaultText,i.Activation_Mode_Key=n.activateWay,i.EditorEventActiveMode=n.editorEventActiveMode,i.QuoteSource=1==n.quoteSource,i.QuoteTarget=1==n.quoteTarget,i.ExtendAttr1=n.extendAttr1,i.LackEllipsisvalue=n.defaultValue,i.DynamicData=n.dynamicData,i.CustomAttribute=n.customAttribute,i.InputEventName=n.triggerAction,null!=n.expressionInput&&null!=n.expressionInput&&(i.Text_Expression=decodeURIComponent(n.expressionInput)),i.Fg_edit="boolean"==typeof n.readFlag?!n.readFlag:"false"==n.readFlag,i.Fg_encrypt=n.encryptFlag,i.Fg_delete=n.deleteFlag,i.Fg_border=n.borderFlag,i.Fg_quote=n.quoteFlag,i.Fg_qs=n.sourceFlag,i.CanEmpty=n.emptyFlag,i.IsSensitiveInfo=n.sensitiveFlag,i.Fg_hide=n.hideFlag,i.Occupying_Num=n.placeNum,i.IsStartUp_UnderLine=n.underlineFlag,i.CanBeInLine_StartBorder=n.startBorderFlag,i.CanBeInLine_EndBorder=n.endBorderFlag,i.Lg_max=n.maxLength,i.Lg_min=n.minimumLength,i.IsPrint=n.printFlag,i.IsDisSkip=n.skipFlag,i.Gender=n.sexJudge,i.MaxAge=n.maxAge,i.MinAge=n.minAge;let s=l.XInputFactory.GetInstance().GetText(i,null);return null==s?(t=this.resMsg,t):(s.ElementInfo=i,t=super.Execute([s]),n.defaultText&&(s.UpdateInnerText(n.defaultText),super.GetEdtCtrl().MRefreshDocView()),t)}}t.A_InsertSignEle=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ResetEleValidate=void 0;const r=n(1),i=n(6),l=n(0),s=n(3),o=n(46);class a extends r.XBaseAction{ActName(){return"ResetEleValidate"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl().All_Document;for(var n=0;n<e.length;n++){let r=e[n].conceptId,a=e[n].docId,u=e[n].toolTip;for(let e=0;e<t.length;e++){let n=t[e];if(a&&n.DocID!=a)continue;let h=new s.List,d=n.GetPagePanel(i.ENumPagePanelTp.Header),c=n.GetPagePanel(i.ENumPagePanelTp.Body),p=n.GetPagePanel(i.ENumPagePanelTp.Footer);d.GetChildrenByCptId(r,!0,h),c.GetChildrenByCptId(r,!0,h),p.GetChildrenByCptId(r,!0,h),d.IsLayoutValid=!1,c.IsLayoutValid=!1,p.IsLayoutValid=!1;for(let e of h)e instanceof l.XInputEle&&(e.CheckError_Type=o.CheckErrorType.None,e.IL_119(!1,!0,!1),e.ToolTip=u)}}return super._RefreshPageAndMoveCaret(!0),this.resMsg}}t.A_ResetEleValidate=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetTableRowAndHeight=void 0;const r=n(1),i=n(20),l=n(6);class s extends r.XBaseAction{ActName(){return"GetTableRowAndHeight"}constructor(){super()}Execute(e){let t=super.GetEdtCtrl().All_Document,n=[];if(e.length>0)for(let r=0;r<e.length;r++){let s=e[r],o=s.conceptId,a=s.docId;for(let e=0;e<t.length;e++){let r=t[e];if(a&&r.DocID!=a)continue;let s=r.GetPagePanel(l.ENumPagePanelTp.Body);const u=i.XTextTableUtil.GetTextTableByCptID(o,s);u.Rows.Length>u.THeadIx&&n.push({rowNum:u.Rows.Length-u.THeadIx,rowHeight:u.Rows.Get(u.THeadIx+1).FixHeight})}}return this.resMsg.ReturnParams=n,this.resMsg}}t.A_GetTableRowAndHeight=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetUnEditableColor=void 0;const r=n(1),i=n(7);class l extends r.XBaseAction{ActName(){return"SetUnEditableColor"}constructor(){super()}Execute(e){let t;this.resMsg.Clear();let n=null==e?0:e.length;if(0!=n){try{let t=n<=0?null:e,r=super.GetEdtCtrl();for(let e=0;e<t.length;e++){let n=t[e],l=n.docId,s=n.unEditableColor,o=r.All_Document;for(let e=0;e<o.length;e++){let t=o[e];t.DocID==l&&(t.UnEditableColor=new i.Color(s))}}this.resMsg.ReturnParams=!0}catch(e){this.resMsg.ReturnParams=!1,this.resMsg.Ex=e}return t=this.resMsg,t}}}t.A_SetUnEditableColor=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ReplaceDoc=void 0;const r=n(2),i=n(70),l=n(4),s=n(1),o=n(46);class a extends s.XBaseAction{constructor(){super(),this.xdocLoadParam=null,super.OpType=r.ENumActOpType.CtntEdit,this.xdocLoadParam=new i.XDocLoadParam(null,r.ENumXDocPath.LocalFile)}ActName(){return"ReplaceDoc"}Execute(e){this.resMsg.Clear();let t=(null==e?0:e.length)<=0?null:e[0],n=t.srcstr,r=t.docId,i=super.GetEdtCtrl();i.unfocus=!0;let s,a=i.M_EleEvtModel.EleClickedWrap,u=a.EleFocused,h=i.GetAlertFormStartRect(o.PositionEnum.LeftBottom,0,0,"focused").Location;if(l.default.IsNullOrEmpty(n))return i.Focus(),this.resMsg.MsgLevel=5,this.resMsg.MsgStr=this.ActName+"命令未指定有效的文件路径。",s=this.resMsg,s;try{this.xdocLoadParam.SrcStr=n,i.MReplaceXmlDocument(this.xdocLoadParam,r),this.resMsg.ReturnParams=!0,i.unfocus=!1,a.LineEleIxFocused.SetEle(u),i.Focus(),i.M_EleEvtModel.MoveCaretByCursorEle(!0);let e=i.GetAlertFormStartRect(o.PositionEnum.LeftBottom,0,0,"focused").Location.Y-h.Y,t=i.ContainerDOM.querySelector("#pango-editor-content-"+i.ContainerDOM.id);t.scrollTop=t.scrollTop+e}catch(e){i.M_EdtCustomEvtGrp.OpenError&&i.M_EdtCustomEvtGrp.OpenError(),this.resMsg.ReturnParams=!1,this.resMsg.Ex=e}return s=this.resMsg,s}}t.A_ReplaceDoc=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_GetElementByType=void 0;const r=n(1),i=n(6),l=n(3),s=n(0),o=n(75);class a extends r.XBaseAction{ActName(){return"GetElementByType"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t=e;if(null==t||null==t.types)this.resMsg.ReturnParams="参数有误";else{let e=super.GetEdtCtrl(),n=t.docId,r=t.types,a=e.All_Document,u=new l.List;for(let e=0;e<a.length;e++){let t=a[e];n&&t.DocID!=n||(t.GetPagePanel(i.ENumPagePanelTp.Body).GetChildrenByTypes(r,!0,u),t.GetPagePanel(i.ENumPagePanelTp.Header).GetChildrenByTypes(r,!0,u),t.GetPagePanel(i.ENumPagePanelTp.Footer).GetChildrenByTypes(r,!0,u))}let h=[];for(let e of u)e instanceof s.XImageEle&&h.push({imageType:"string"==typeof e.ImageType?e.ImageType:o.ImageType[e.ImageType],XID:e.XID});this.resMsg.ReturnParams=h}return this.resMsg}}t.A_GetElementByType=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_SetFirstDocStartPageNum=void 0;const r=n(1);class i extends r.XBaseAction{ActName(){return"SetFirstDocStartPageNum"}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl(),n=t.All_Document,r=e.length>0?e[0]:null;if(null!=r&&null!=r.startNum){for(let e=0;e<n.length;e++){let t=n[e];t.FirstDocStartPageNum=0==e?parseInt(r.startNum):null}let e=t.M_PageFocused.DocArgs.DocIx;t.RebuildPage(e)}else this.resMsg.MsgStr="调用参数有误",super.MessageWarn();return this.resMsg}}t.A_SetFirstDocStartPageNum=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_MutualExclusion=void 0;const r=n(1),i=n(3),l=n(0),s=n(241),o=n(6),a=n(7);class u extends r.XBaseAction{constructor(e){super(e),this.FindTextList=new i.List}ActName(){return"MutualExclusion"}Execute(e){this.resMsg.Clear();let t=[];this.locate=!1;for(let n=0;n<e.length;n++){this.FindTextList.Clear();let r=e[n],i=r.docId,l=r.MutualExclusionList,s=r.color;if(!l)continue;let o=this.MutualExclusion(i,l,s);t.push(...o)}return this.resMsg.ReturnParams=t,this.resMsg}MutualExclusion(e,t,n){let r=super.GetEdtCtrl().All_Document,l=[];for(var s=0;s<r.length;s++){if(e&&r[s].DocID!=e)continue;let o=[],u=r[s],h=this.BulidFindReplaceResults(u),d=new i.List;if(null!=h){for(let e=0;e<h.Length;e++){let t=h.Get(e);t.TogetherWithPre?d.Get(d.Length-1).MergeChildList(t):d.Add(t)}for(let e=0;e<t.length;e++){let n=t[e],r=this.BulidSuitList_SelRange(n,d);o.push(r)}}if(-1===o.findIndex(e=>!1===e)){for(let e of this.FindTextList)for(let t=0;t<e.Length;t++){let r=e.Get(t).HitEles;for(let e=0;e<r.Length;e++)r.Get(e).EleStyle.MutualExclusionColor=n?new a.Color(n):new a.Color("#FFFF0000")}l.push({docId:u.DocID,result:!0})}else l.push({docId:u.DocID,result:!1})}return l}BulidFindReplaceResults(e){let t,n=new i.List,r=["XString","XLable","XTextRadioBox","XTextCheckBox"],a=new i.List;e.GetPagePanel(o.ENumPagePanelTp.Header).GetChildrenByTypes(r,!0,a),e.GetPagePanel(o.ENumPagePanelTp.Body).GetChildrenByTypes(r,!0,a),e.GetPagePanel(o.ENumPagePanelTp.Footer).GetChildrenByTypes(r,!0,a);let u=new i.List;for(let e=0;e<a.Count();e++){const t=a.Get(e);l.XDomUtil.HasDelTrace(t)||u.Add(t)}if(a=u,a.Count()<=0)t=null;else{let e,r=super.GetEdtCtrl().M_EleEvtModel.EleClicked,i=(null==r||r.OwnerLine,0);for(;i<a.Count();){let t=a.Get(i),r=t instanceof l.XStringEle?t:null;if(null!=r&&r.IsXInputBkgText){i++;continue}if(null!=(t instanceof l.XLabelEle?t:null)){i++;continue}let o=new s.FindReplaceAssistInfo;if(o.AddChildEle(t),null!=e){let n=e.Parent.GetChildInx(e),r=e.Parent.GetChildInx(t);t.Parent.Equals(e.Parent)&&n+1==r&&(o.TogetherWithPre=!0)}n.Add(o),e=t,i++}t=n}return t}BulidSuitList_SelRange(e,t){let n=!1;if(null==t)return n;for(let r=0;r<t.Length;r++){let i=t.Get(r).HitTest(e,!1,!1);if(i.Length>0){if(n=!0,this.FindTextList.Add(i),!this.locate){let e=super.GetEdtCtrl(),t=l.XDomUtil.GetNextEle(!0,i.Get(0).HitEles.Get(i.Get(0).HitEles.Count()-1)),n=e.M_EleEvtModel.EleClickedWrap.EleFocused;e.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(t);let r=e.M_EleEvtModel.EleClickedWrap.EleFocused;e.M_EleEvtHandler.OnCursorChange(n,r),e.M_EleEvtModel.MoveCaretByCursorEle(!0)}this.locate=!0}}return n}}t.A_MutualExclusion=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_ValidateTitle=void 0;const r=n(1),i=n(32),l=n(3),s=n(6),o=n(0),a=n(62);class u extends r.XBaseAction{ActName(){return"ValidateTitle"}constructor(e){super(e)}Execute(e){this.resMsg.Clear();let t=super.GetEdtCtrl().All_Document,n=[];if(e.length>0)for(let i=0;i<e.length;i++){let o=new l.List,a=e[i],u=a.docId,h=a.titleCptId;for(var r=0;r<t.length;r++){if(u&&t[r].DocID!=u)continue;t[r].GetPagePanel(s.ENumPagePanelTp.Body).GetChildrenByType("XTextLabelElement",!0,o)}let d=this.ValidateTitle(o,h);n.push(d)}else for(r=0;r<t.length;r++){let e=t[r],i=new l.List;e.GetPagePanel(s.ENumPagePanelTp.Body).GetChildrenByType("XTextLabelElement",!0,i);let o=this.ValidateTitle(i);n.push(o)}return this.resMsg.ReturnParams=n,this.resMsg}ValidateTitle(e,t){let n=[];for(let r of e){if(t&&r.CptID!=t)continue;let e=this.GetTitleText(r);r.MaxLength&&e.length>r.MaxLength&&n.push({docId:r.Document.DocID,message:`长度必须小于或者等于${r.MaxLength}个字符`,CptId:r.CptID,titleText:r.Text,text:e}),r.MinLength&&e.length<r.MinLength?n.push({docId:r.Document.DocID,message:`长度必须大于或者等于${r.MinLength}个字符`,CptId:r.CptID,titleText:r.Text,text:e}):r.IsRequire&&0==e.length&&n.push({docId:r.Document.DocID,message:"内容为必填",CptId:r.CptID,titleText:r.Text,text:e})}return n}GetTitleText(e){let t="",n=super.GetEdtCtrl(),r=e.Parent.ChildEleList,u=r.IndexOf(e),h=r.Count(),d=new l.List,c=new a.XTextDocument(!1);for(let t=u+1;t<h;t++){let n=r.Get(t);if(n instanceof i.XTextLabelElement&&n.TitleLevel<=e.TitleLevel)break;d.Add(n)}let p=new l.List;c.restoreChildrenList(d),c.GetDocCtxt().EmrWorkMode=n.M_EleEvtModel.WorkMode,c.GetPagePanel(s.ENumPagePanelTp.Body).GetChildrenByTypes(["XString","XLable","XTextLabelElement","XTextCheckBox","XTextRadioBox"],!0,p);for(let e of p)e instanceof o.XStringEle&&e.IsXInputBkgText||(t+=e.GetInnerText(!1));return t}}t.A_ValidateTitle=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.A_UpdateElementType=void 0;const r=n(1),i=n(6),l=n(0),s=n(3);class o extends r.XBaseAction{ActName(){return"UpdateElementType"}Execute(e){let t;e.length<1&&(this.resMsg.MsgLevel=2,this.resMsg.MsgStr=this.ActName()+" 调用参数有误",super.MessageWarn(),t=null);super.GetEdtCtrl();let n=!1;for(let t=0;t<e.length;t++){let r=e[t],i=r.docId,l=r.conceptId,s=r.elementType;this.ChangeElementType(i,l,s)&&(n=!0)}return t}ChangeElementType(e,t,n){let r=super.GetEdtCtrl().All_Document,o=!1;for(let a=0;a<r.length;a++){let u=r[a];if(e&&u.DocID!=e)continue;let h=new s.List;u.GetPagePanel(i.ENumPagePanelTp.Header).GetChildrenByCptId(t,!0,h),u.GetPagePanel(i.ENumPagePanelTp.Footer).GetChildrenByCptId(t,!0,h),u.GetPagePanel(i.ENumPagePanelTp.Body).GetChildrenByCptId(t,!0,h);for(let e of h)if(e instanceof l.XInputEle){if(e.GetInputTypeName()==n)continue;let t=this.GetInputCode(n);e.SetAttribute("type",t),e.InputType=e.GetEleType(),o=!0}}return o}GetInputCode(e){let t;switch(e){case"text":t="5002";break;case"sigleSelect":t="7002";break;case"moreSelect":t="7003";break;case"date":t="6002";break;case"number":t="6001";break;case"havNo":t="7001";break;case"sign":t="3001";break;case"diagnosis":t="4008"}return t}}t.A_UpdateElementType=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EdtCanvasCustomEvtGrp=void 0;const r=n(1089),i=n(8),l=n(7);t.EdtCanvasCustomEvtGrp=class{constructor(e){this.edtCanvas=null,this._BrowerAllowedCopy=!1,this._BrowerAllowedRightMenu=!1,this._copyModel="0",this._appKeepTrace=!0,this._AppInsertForeColor=null,this._pasteDeleted=!1,this._isShowTraceUserId=!1,this.edtCanvas=e,this._xDiagTableInfo=new r.XDiagTableInfo}get XLabelHoverBackParagraph(){return this.fun_XLabelHover}set XLabelHoverBackParagraph(e){"function"!=typeof e&&(e=null),this.fun_XLabelHover=e}get XLabelMoveOut(){return this.fun_XLabelMoveOut}set XLabelMoveOut(e){"function"!=typeof e&&(e=null),this.fun_XLabelMoveOut=e}set EditablaDiagTableXID(e){this._editablaDiagTableXID=e}get EditablaDiagTableXID(){return this._editablaDiagTableXID}get xDiagTableInfo(){return this._xDiagTableInfo}get EdtCanvas(){return this.edtCanvas}get BrowerAllowedCopy(){return this._BrowerAllowedCopy}set BrowerAllowedCopy(e){const t=i.CNumUtil.TryParseBool(e,!1);this._BrowerAllowedCopy=t}get BrowerAllowedRightMenu(){return this._BrowerAllowedRightMenu}set BrowerAllowedRightMenu(e){const t=i.CNumUtil.TryParseBool(e,!1);this._BrowerAllowedRightMenu=t}get CopyModel(){return this._copyModel}set CopyModel(e){null==e&&(e="0"),"1"!=e&&"2"!=e&&"3"!=e&&(e="0"),this._copyModel=e}get AppKeepTrace(){return this._appKeepTrace}set AppKeepTrace(e){const t=i.CNumUtil.TryParseBool(e,!0);this._appKeepTrace=t}getAppInsertForeColor(){return this._AppInsertForeColor instanceof l.Color?this._AppInsertForeColor:new l.Color(this._AppInsertForeColor)}set AppInsertForeColor(e){let t=l.Color.Empty;null!=e&&(t=e instanceof l.Color?e:new l.Color(e)),this._AppInsertForeColor=t}get PasteDeleted(){return this._pasteDeleted}set PasteDeleted(e){const t=i.CNumUtil.TryParseBool(e,!1);this._pasteDeleted=t}get IsShowTraceUserId(){return this._isShowTraceUserId}set IsShowTraceUserId(e){const t=i.CNumUtil.TryParseBool(e,!1);this._isShowTraceUserId=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDiagTableInfo=void 0;const r=n(0),i=n(40),l=n(6),s=n(38),o=n(63),a=n(20);t.XDiagTableInfo=class{constructor(){this._RowIx=-1,this._ColIx=-1}get DiagTableCptID(){return this._DiagTableCptID}set DiagTableCptID(e){this._DiagTableCptID=e}get RowIx(){return this._RowIx}set RowIx(e){this._RowIx=e}get ColIx(){return this._ColIx}set ColIx(e){this._ColIx=e}get isClear(){return this._isClear}set isClear(e){this._isClear=e}get diffRow(){return this._diffRow}set diffRow(e){this._diffRow=e}Clear(){this.clearCell(),this._DiagTableCptID=null,this._RowIx=-1,this._ColIx=-1,this._isClear=!1,this._diffRow=!1,this._cell=null}SetValue(e){null!=e&&(this._DiagTableCptID=e[0],this._RowIx=e[1],this._ColIx=e[2],this._isClear=e[3],this._diffRow=e[4],this.setCell())}setEdtCtrl(e){this.edtCtrl=e}updateDiagTable(){if(null!=this._cell&&this._cell.ChildCount>0){const e=this.edtCtrl.M_EleEvtModel,t=this._cell._GetLastBaseEle();return e.EleClickedWrap.LineEleIxFocused.ReplaceEle(t),e.SelRange.Clear(),t}return null}getAllDiagEle(e=!1){if(!e)return null;if(null==this.xTable)return null;let t=[],n=new s.List;this.xTable.GetChildrenByType("XInputField",!0,n);const l=n.ToArray();for(let e=0;e<l.length;e++){const n=l[e];if(n&&n instanceof r.XInputEle&&n.InputType==i.EleTypeEnum.DiagnosisEle){let e=n.Parent;for(;null!=e&&!(e instanceof r.XTextTableCell);)e=e.Parent;if(null!=e&&e instanceof r.XTextTableCell){const r=e;t.push({CId:n.CptID,CustomAttribute:n.CustomAttribute,colIx:r.ColIndex,rowIx:r.RowIndex})}}}return t}setCell(){if(!this._DiagTableCptID)return;if(null==this.edtCtrl)return;const e=this.edtCtrl.M_DocumentFocused;if(null==e)return;const t=e.GetPagePanel(l.ENumPagePanelTp.Body);if(null==t)return;const n=a.XTextTableUtil.GetTextTableByCptID(this._DiagTableCptID,t);if(null==n||"XTextTable"!=n.EleTypeName)return;this.xTable=n;const i=n.Columns.Count();if(!(this._ColIx>=0&&i>this._ColIx))return;const s=n.ChildCount;if(this._RowIx>=0||(this._RowIx=Math.max(s-1,0)),this.diffRow&&(this.diffRow=!1,this._RowIx++),this._RowIx<s){const e=r.XDomUtil.GetCellsByRowInx(n,this._RowIx);null!=e&&(this._cell=e[this._ColIx]),null!=this._cell&&!this._isClear&&this._cell.ChildCount>1&&(this._RowIx=s,this._cell=null)}if(s<=this._RowIx){for(let e=s;e<=this._RowIx;e++){const t=n.GetLastCell();let r=n.Action_InsertRow(t,o.ORIENTATION.BOTTOM);for(let t=0;t<r.ChildEleList.Count();t++){const n=r.ChildEleList.Get(t);n.EleStyle.TopApplytoText="表格",n.EleStyle.RightApplytoText="表格",e==this._RowIx&&this._ColIx==t&&(this._cell=n,this._isClear=!1)}}this.edtCtrl.MRefreshDocView()}if(null==this._cell){const e=r.XDomUtil.GetCellsByRowInx(n,this._RowIx);null!=e&&(this._cell=e[this._ColIx],this.clearCell())}}clearCell(){this._isClear&&(this._isClear=!1,null!=this._cell&&this._cell.ChildCount>1&&(this._cell.RemoveChildren(0,this._cell.ChildCount-1),this.edtCtrl.MRefreshDocView()))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ElementEvtModel=void 0;const r=n(2),i=n(59),l=n(6),s=n(259),o=n(0),a=n(1091),u=n(10),h=n(94),d=n(143),c=n(17),p=n(9),f=n(32);t.ElementEvtModel=class{constructor(e,t,n){this.xdocEditor=null,this.workMode=r.ENumWorkMode.Design,this.viewMode=new s.ViewModeObj,this.activePageIx=-1,this.eleMClickedWrap=null,this.eleMOverWrap=null,this.selRange=null,this.selRangeAct=null,this.addEdtHistAct=null,this.lastClickedEle=null,this.popCtrl=null,this.loginUsrInfo=null,this.loginUsrInfo=new a.LoginUserInfo,this.xdocEditor=e,this._SetWorkMode(t),this._SetViewMode(n),this.eleMClickedWrap=new i.ClickedElementWrapper(!0),this.eleMOverWrap=new i.ClickedElementWrapper(!1),this.selRange=new d.XPageLineSelRange}get WorkMode(){return this.workMode}set WorkMode(e){this._SetWorkMode(e)&&this.xdocEditor.SwitchEvtHandler()}get ViewMode(){return this.viewMode}get LoginUsrInfo(){return this.loginUsrInfo}get SelRange(){return this.selRange}get SelRangeAct(){return null==this.selRangeAct&&(this.selRangeAct=this.xdocEditor.M_GetActionByName("SelectRange")),this.selRangeAct}get AddEdtHistAct(){return this.WorkMode==r.ENumWorkMode.Design?null:(null==this.addEdtHistAct&&(this.addEdtHistAct=this.xdocEditor.M_GetActionByName("AddEdtHistory")),this.addEdtHistAct)}get EleClickedWrap(){return this.eleMClickedWrap}get EleClicked(){return null==this.eleMClickedWrap?null:this.eleMClickedWrap.EleFocused}get EleClickedPrevSameLine(){if(null==this.eleMClickedWrap)return null;return this.eleMClickedWrap.LineEleIxFocused._GetNextEle(!1,!0,!1)}get ActivePageIx(){return this.activePageIx}set ActivePageIx(e){this.activePageIx=e}get EleMOverWrap(){return this.eleMOverWrap}get EleMOver(){return null==this.eleMOverWrap?null:this.eleMOverWrap.EleFocused}get LastEleClicked(){return this.lastClickedEle}get M_xdocEditor(){return this.xdocEditor}Clear(){this.activePageIx=-1,this.eleMClickedWrap.Clear(!0),this.eleMOverWrap.Clear(!0),this.ClearSelRange(),this.ClosePopCtrl()}SyncUndoMgrToXDoc(){this.xdocEditor.M_XDocsUtil.SyncUndoMgrToXDocs(this.xdocEditor.M_UndoMgr)}_SetWorkMode(e){return!!h.EditorWorkModeUtil.CanSwitch(this.workMode,e,this.loginUsrInfo)&&(this.xdocEditor.changWorkMode(e),this.workMode=e,this.SyncWorkModelToXDoc(),!0)}SyncWorkModelToXDoc(){this.xdocEditor.M_XDocsUtil.SyncWorkModelToXDocs(this.workMode)}_SetViewMode(e){r.ENumViewMode.CleanView,r.ENumViewMode.CleanView;let t=r.ENumViewMode.WebView==(e&r.ENumViewMode.WebView);return this.viewMode.IsCleanViewMode=!0,this.viewMode.IsWebViewMode=t,this.SyncViewModelToXDoc(),!0}SyncViewModelToXDoc(){this.xdocEditor.M_IsWebView=this.viewMode.IsWebViewMode,this.xdocEditor.M_XDocsUtil.SyncViewModelToXDocs(this.viewMode)}ClearSelRange(){this.ReInitSelRange()}ReInitSelRange(){let e=this.selRange.IsValid();this.selRange.Clear(),e&&this.xdocEditor.RefreshPageSelRange(r.ENumBkgRectsType.SelRects,null),this.selRange.SetFromIx(this.EleClicked)}UpdateLastEleClicked(e,t){let n=this.ViewMode.IsCleanViewMode;if(null==this.lastClickedEle||o.XDomUtil.IsEleRemoved(this.lastClickedEle,n))return void(this.lastClickedEle=e);let r=!1;if(this.lastClickedEle instanceof o.XBaseResizableElement&&this.lastClickedEle!=e){let e=this.lastClickedEle;e.IsFocused=!1;let t=e.OwnPageView;null==t&&(t=this.xdocEditor.M_EleEvtModel.EleClickedWrap.LastPageFocused),null!=t&&(t.DragDashRectF=p.RectangleF.Empty),r=!0}if(r&&t){let e=i.ClickedElementWrapper.GetEleRectInCtrl(this.lastClickedEle,this.xdocEditor.M_EleEvtModel.EleClickedWrap.PageFocused,this.xdocEditor.MGetZoomRatio());e.X-=5,e.Y-=5,e.Width+=10,e.Height+=10}this.lastClickedEle=e}set PopCtrl(e){this.popCtrl=e}get PopCtrl(){return this.popCtrl}ClosePopCtrl(){null!=this.popCtrl&&(this.popCtrl&&"function"==typeof this.popCtrl.CloseEvent&&this.popCtrl.CloseEvent(),this.popCtrl=null,this.MoveCaretByCursorEle(!0))}RestEleWrapRefPage(){this.ResetEleWrapPage(this.EleClickedWrap),this.ResetEleWrapPage(this.EleMOverWrap)}ResetEleWrapPage(e){if(null!=e){const t=this.ActivePageIx;let n=t>=0?this.xdocEditor.MGetPageView(t):null;if(null==n){const t=e.LineEleIxFocused,r=null==t?null:t.Line;n=null==r?null:r.PageView}null==n&&(n=this.xdocEditor.MGetPageView(0)),e.PageFocused=n}}Locate_EleInLine(e,t,n){let i=e==r.ENumEvtSrc.MOUSE_LPRESS||e==r.ENumEvtSrc.MOUSE_RPRESS,s=this.xdocEditor.getCursorPos(t).X,a=this.xdocEditor.getCursorPos(t).Y,u=this._UnZoomCtrlPoint(new c.PointF(s,a));n.Backup(),n.Clear(!1),n.ClickPosInCtrl=u,n.CursorPosInDom=this.xdocEditor.getCursorPosInDom(t);let h=!(e==r.ENumEvtSrc.MOUSE_DRAG||e==r.ENumEvtSrc.MOUSE_MOVE);this.xdocEditor.MGetEleByPos(n,h,t);let d=n.IsValid();if(d&&i){let e=n.EleFocused.OwnerDocPanel;null==e||e.IsEditable||e.PagePanelTp==l.ENumPagePanelTp.Body||(d=!1),n.EleFocused instanceof o.XTextTableCell&&(d=!1),d||n.Clear(!1)}d?(n.ClearBackup(),n.UpdateOrigElePosInLine()):n.Restore()}_UnZoomCtrlPoint(e){let t=this.xdocEditor.MGetZoomRatio();return new c.PointF(e.X/t,e.Y/t)}MoveCaretByCursorEle(e=!0){const t=this.eleMClickedWrap.IsValid();if(null!=this.eleMClickedWrap&&t){const t=this.EleClicked;if(null!=t){let[n,l]=this.getXtextLabelElement(t),s=this.EleClickedWrap.LineEleIxFocused._GetNextEle(!1,!0,!1);(null==s||s instanceof f.XTextLabelElement)&&(s=t);const a=this.xdocEditor.MGetZoomRatio(),u=this.EleClickedWrap.PageFocused,h=i.ClickedElementWrapper.GetEleRectInCtrl(t,u,a),d=i.ClickedElementWrapper.GetEleRectInCtrl(s,u,a);let p=this.xdocEditor.M_EdtCaret;p.CursorEle=s,e&&p.UpdateCaretEleStyle(s);const g=this._CalcCaretPosY(d,a),m=new c.PointF(Math.floor(h.X),Math.floor(g-2*a));if(this.workMode==r.ENumWorkMode.App&&!l&&n&&!(null==n?void 0:n.IsEditble))return this.eleMClickedWrap.LineEleIxFocused.SetEle(null),void p.HideXCaret();if(this.xdocEditor.unfocus)return;let E=4+this._CalcCaretHeight(m,a);E*=a;let C=!1;if(t instanceof o.XInputBorderEle&&t.IsStartBorder)C=!1;else{C=null!=o.XDomUtil.GetParentXInput(t)}p.MoveXCaretTo(m.X,m.Y,Math.floor(E),C),this.xdocEditor.UpdateToolbarStyle(this.EleClicked)}}}MoveCaretByMoveEle(e=!0,t=!0){const n=this.eleMOverWrap.IsValid();if(null!=this.eleMOverWrap&&n){const t=this.eleMOverWrap.EleFocused;if(null!=t){let n=o.XDomUtil.GetNextEle(!1,t);(null==n||n instanceof f.XTextLabelElement)&&(n=t);const r=this.xdocEditor.MGetZoomRatio(),l=this.EleClickedWrap.PageFocused,s=i.ClickedElementWrapper.GetEleRectInCtrl(t,l,r),a=this._CalcCaretPosY(s,r),u=new c.PointF(Math.floor(s.X),Math.floor(a-2*r));let h=this.xdocEditor.M_EdtCaret;if(h.CursorEle=t,e&&h.UpdateCaretEleStyle(n),this.xdocEditor.unfocus)return;let d=4+this._CalcCaretHeight(u,r);d*=r;let p=!1;if(t instanceof o.XInputBorderEle&&t.IsStartBorder)p=!1;else{p=null!=o.XDomUtil.GetParentXInput(t)}h.MoveXCaretTo(u.X,u.Y,Math.floor(d),p,!0)}}else{this.xdocEditor.M_EdtCaret.HideXCaret()}}getXtextLabelElement(e,t=!1){if(e instanceof f.XTextLabelElement)return[e,!1];{let n=e.Parent,r=!(e instanceof o.XInputBorderEle&&e.IsStartBorder)&&(n instanceof o.XInputEle||t),i=null!=n?n.GetChildInx(e):null;if(null==i)return[null,!1];{let e=null;for(let e=i-1;e>=0;e--){let t=n.ChildEleList.Get(e);if(t instanceof f.XTextLabelElement)return[t,r]}if(null==e)return this.getXtextLabelElement(n,r)}}}_CalcCaretPosY(e,t){const n=this.xdocEditor.M_EdtCaret.CaretEleStyle;let r=u.DPITransUtil.TransFloatVal(n.XFontStyle.FontSize,72,96);r*=t;const i=e.Height-r;let l;return Math.abs(i)<=1?l=e.Y:i>0?l=e.Y+i/2:i<0&&(l=e.Y-i/2),l}_CalcCaretHeight(e,t){let n=this.xdocEditor.M_EdtCaret.CaretEleStyle,r=u.DPITransUtil.TransFloatVal(n.XFontStyle.FontSize,72,96),i=r;return(n.Superscript||n.Subscript)&&(r*=.62,n.Subscript&&(e.Y+=t*(i-r))),r}CheckFormModeFocusedEle(e,t){if(this.WorkMode!=r.ENumWorkMode.Form)return!1;if(null!=o.XDomUtil.GetParentXInput(t,!0))return!1;if(null!=o.XDomUtil.GetParentXInput(e,!0))return this.EleClickedWrap.LineEleIxFocused.SetEle(e),!0;let n=this.xdocEditor.getFirstXInputToEndBorEle();if(null==n){n=this.xdocEditor.M_Xdoc.GetFirstBaseChild(!1)}return this.EleClickedWrap.LineEleIxFocused.SetEle(n),!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginUserInfo=void 0;const r=n(141);t.LoginUserInfo=class{constructor(){this.usrInfo=null,this.usrInfo=new r.XUserInfo}get UsrId(){return this.usrInfo.UsrId}get UsrName(){return this.usrInfo.UsrName}get PermLevel(){return this.usrInfo.PermissionLv}IsValid(){return this.usrInfo.IsValid()}SetUserInfo(e,t,n){this.usrInfo.UsrId=null==e?"":e,this.usrInfo.UsrName=null==t?"无登录":t,this.usrInfo.PermissionLv=null==n?1:n}CopyTo(e){null!=e&&e.CopyFrom(this.usrInfo)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MouseKbEvtMounter=void 0;const r=n(17),i=n(1093),l=n(29),s=n(234),o=n(2),a=n(186),u=n(65);t.MouseKbEvtMounter=class{constructor(e){this.evtHandler=null,this.relCtrl=null,this.lastMovePos=r.PointF.Empty,this.isMsLeftDown=!1,this._keyCtrlTimeStart=0,this._keyCtrlTimeEnd=0,this.tipSubLayer=null,this.chinesing=!1,this.preInputChinesingValue="",this.PresetedValue="",this.relCtrl=e,this.tipSubLayer=new s.TooltipTestUtil(e)}MountEvtHandler(e){e!=this.evtHandler&&null!=e&&(this.evtHandler=e,this.evtHandler.SetEvtSrcCtrl(this.relCtrl),this.UnBindEvtHandler(),this.BindEvtHandler())}BindOnKB_CharPress(e){"oninput"in e&&(this._caretInput=e,e.addEventListener("compositionstart",this.compositionstart.bind(this)),e.addEventListener("input",this.OnKB_CharPress.bind(this)),e.addEventListener("compositionend",this.compositionend.bind(this)))}compositionstart(e){this.chinesing=!0,this.preInputChinesingValue=""}compositionend(e){this.chinesing=!1;if(this.PresetedValue&&this.PresetedValue.search(/[a-z]/g)>=0&&!e.data){this.relCtrl.M_GetActionByName("Undo").Execute();let e=this.relCtrl.M_GetActionByName("InsertChar");e.PresetUndoGroup=null,e.PresetValue=""}this.OnKB_CharPress(e),this.PresetedValue="",this.preInputChinesingValue=e.data}get EvtHandler(){return this.evtHandler}get RealEvtCtrl(){return this.relCtrl}UnBindEvtHandler(){let e=this.RealEvtCtrl;e.RemoveMouseDown(this.OnMouse_Down.bind(this)),e.RemoveMouseUp(this.OnMouse_Up.bind(this)),e.RemoveMouseDoubleClick(this.OnMouse_DoubleClick.bind(this)),e.RemoveMouseMove(this.OnMouse_Move.bind(this)),e.RemoveMouseMoveLeave(this.OnMouse_Leave.bind(this)),e.RemoveMouseWheel(this.OnMouse_Wheel.bind(this)),e.RemoveKeyDown(this.OnKB_KeyDown.bind(this))}BindEvtHandler(){let e=this.RealEvtCtrl;e.AddMouseDown(this.OnMouse_Down.bind(this)),e.AddMouseUp(this.OnMouse_Up.bind(this)),e.AddMouseDoubleClick(this.OnMouse_DoubleClick.bind(this)),e.AddMouseMove(this.OnMouse_Move.bind(this)),e.AddMouseMoveLeave(this.OnMouse_Leave.bind(this)),e.AddMouseWheel(this.OnMouse_Wheel.bind(this)),e.AddKeyDown(this.OnKB_KeyDown.bind(this))}OnMouse_Down(e){if(null!=this.evtHandler)switch(e.buttons){case i.MouseButtons.Left:this.isMsLeftDown=!0,this.evtHandler.OnMouseL_Pressed(e);break;case i.MouseButtons.Right:clearTimeout(a.InputAlertFormEvtHandler.OnMouse_Down_Timout),this.evtHandler.OnMouseR_Pressed(e)}}OnMouse_Up(e){if(null!=this.evtHandler)switch(e.which){case i.MouseWhich.Left:this.isMsLeftDown=!1,this.evtHandler.OnMouseL_Released(e);let t=this.relCtrl.ToolBar.GetCurrentBtnElement("FormatBrush");null!=t&&(t.CommandValue=!1);break;case i.MouseWhich.Right:this.evtHandler.OnMouseR_Released(e)}}OnMouse_DoubleClick(e){null!=this.evtHandler&&(clearTimeout(this.OnMouse_Down_Timout),this.evtHandler.OnMouse_DblClick(e))}OnMouse_Move(e){if(null!=this.evtHandler&&(e.pageX!=this.lastMovePos.X||e.pageY!=this.lastMovePos.Y)){switch(e.buttons){case i.MouseButtons.None:0===e.buttons&&this.evtHandler.OnMouse_Moved(e);break;case i.MouseButtons.Left:this.isMsLeftDown?this.evtHandler.OnMouse_Dragged(e):this.evtHandler.OnMouse_Moved(e)}this.lastMovePos=new r.PointF(e.pageX,e.pageY)}}OnMouse_Wheel(e){null!=this.evtHandler&&this.evtHandler.OnMouse_Wheel(e)}OnMouse_Leave(e){null!=this.evtHandler&&this.evtHandler.OnMouse_Leave(e)}OnKB_KeyDown(e){if(null==this.evtHandler)return;let t;if(this.tipSubLayer.HideToolTip(),e.which>=0&&(t=e.which),null==t&&(t=l.Keys[e.code]),null==t&&(t=l.Keys.None),86==t)this._keyCtrlTimeEnd=(new Date).getTime();else if(17==t)return void(this._keyCtrlTimeStart=(new Date).getTime());let n=13==t&&3==e.location;if(0!=e.location&&!n)return;let r=l.Keys.None;e.ctrlKey?r=l.Keys.Control:e.shiftKey?r=l.Keys.Shift:e.altKey?r=l.Keys.Alt:e.metaKey&&(r=l.Keys.Control),t==l.Keys.V&&r==l.Keys.Control||this.evtHandler.OnKeyboard_FuncKey(t,r),(t==l.Keys.Tab||e.target==this.relCtrl.PageContainerDom&&this.relCtrl.M_EleEvtModel.WorkMode==o.ENumWorkMode.Form||t==l.Keys.F&&r==l.Keys.Control)&&e.preventDefault()}OnKB_KeyDown_after(e,t){this.evtHandler.OnKeyboard_FuncKey(e,t)}OnKB_CharPress(e){if(this.chinesing&&e.data){const t=/(^\s+)|(\s+$)|\s+|'|’/g,n=this.PresetedValue.replace(t,""),r=e.data.replace(t,"");return void(e.data.search(/[a-z]/g)>=0&&r.length!=n.length&&(this.PresetedValue=e.data,this.evtHandler.OnKeyboard_CharPress(e.data,!0)))}if(null==this.evtHandler)return;let t=this._caretInput;if(null==t)return;if(null==e.data&&"insertFromPaste"==e.inputType)return u.EmrClipboard.PasteFromCaret=t.value,this.OnKB_KeyDown_after(l.Keys.V,l.Keys.Control),void(t.value="");if("v"==e.data&&this._keyCtrlTimeEnd-this._keyCtrlTimeStart<50)return window.winning&&(this.relCtrl.M_EdtCaret.M_caretInput.focus(),window.winning.clipboard.paste()),void(t.value="");let n=e.data||"";this.preInputChinesingValue!=n&&(t.value="",null!=n&&""!=n&&this.evtHandler.OnKeyboard_CharPress(n))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MouseWhich=t.MouseButtons=void 0,function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Middle=4]="Middle"}(t.MouseButtons||(t.MouseButtons={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Middle=2]="Middle",e[e.Right=3]="Right"}(t.MouseWhich||(t.MouseWhich={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XDocEditorCaret=void 0;const r=n(2),i=n(0),l=n(58),s=n(17),o=n(25);t.XDocEditorCaret=class{constructor(e){this.editorCtrl=null,this.pos=s.PointF.Empty,this.cursorEle=null,this.caretEleStyle=null,this.isAutoInsertMode=!0,this.isManualInsertMode=!0,this.isCaretHidden=!0,this.sz=o.SizeF.Empty,this.lockAutoInsertMode=!1,this.caretEleStyle=new l.XBaseEleStyle(!1),this.editorCtrl=e,this._GenCaret()}get M_caretInput(){return this.caretInput}_GenCaret(e,t){let n=this.editorCtrl.PageContainerDom.querySelectorAll(".pango-editor-care-div"),r=null;0==n.length?(r=document.createElement("div"),r.className="pango-editor-care-div",this.editorCtrl.PageContainerDom.appendChild(r),this._caretDiv=r):this._caretDiv=n[0],null!=e&&null!=t&&(this._caretDiv.style.width=e+"px",this._caretDiv.style.height=t+"px");let i=null;this._caretDiv.childElementCount>0?i=this._caretDiv.childNodes[0]:(i=document.createElement("Input"),i.id="pango-editor-care-input",i.setAttribute("type","text"),i.setAttribute("tabIndex","0"),i.setAttribute("autocomplete","off"),this._caretDiv.appendChild(i)),this.caretInput=i,this._BindEvent()}_BindEvent(){null!=this.caretInput&&null!=this.editorCtrl.M_GetMsKbEvtMounter&&(this.caretInput.addEventListener("blur",this._Blur.bind(this)),this.editorCtrl.M_GetMsKbEvtMounter.BindOnKB_CharPress(this.caretInput))}Focus(){null!=this.caretInput&&setTimeout(()=>{this.caretInput.focus(),this._isCurrentFocus=!1})}get _IsFocus(){return this._isCurrentFocus}set _IsFocus(e){this._isCurrentFocus=e}_Blur(e){const t=this._isCurrentFocus;this._isCurrentFocus=!1,t||this.HideXCaret()}get CursorEle(){return this.cursorEle}set CursorEle(e){this.cursorEle=e}get CaretEleStyle(){return this.caretEleStyle}get IsInsertMode(){return this.isAutoInsertMode&&this.isManualInsertMode}TransferXCaret(e,t){this.pos.X=this.pos.X+e,this.pos.Y=this.pos.Y+t;let n=this.SetXCaretWidth();this.SetXCaretPos(n)}HideXCaret(){this.isCaretHidden||(this._caretDiv.style.height="0px",this.isCaretHidden=!0)}DestroyXCaret(){this._caretDiv.remove(),this.isCaretHidden=!0}SetCaretSize(e,t){this._caretDiv.style.width=e+"px",this._caretDiv.style.height=t+"px"}SetXCaretPos(e,t=!1){if(this.editorCtrl.M_EleEvtModel.SelRange.IsValid()&&!t)this.HideXCaret();else{this.SetCaretSize(e,this.sz.Height),this.isCaretHidden=!1;let t=this.pos.X-(this.IsInsertMode?e/2:0);this._caretDiv.style.left=t+"px",this._caretDiv.style.top=this.pos.Y+"px",this.Focus()}}SetXCaretWidth(){let e,t=this.GetXCaretWidth();if(this.sz.Width==t)e=t;else{this.sz.Width=t,this.IsInsertMode||this.HideXCaret(),e=t}return e}GetXCaretWidth(){let e;if(this.IsInsertMode)e=2;else if(null==this.cursorEle)e=2;else{let t=this.cursorEle.Parent;e=null!=t&&t instanceof i.XStringEle&&t.IsXInputBkgText?2:parseInt(96*this.cursorEle.Width/300+.5+"")}return e}UpdateCaretEleStyle(e){if(null!=e&&!(e instanceof i.XPageBreakLabel)){this.caretEleStyle.Clear(),this.caretEleStyle.CopyFrom(e.EleStyle,!1),this.caretEleStyle.SetDocument(e.Document);const t=this.editorCtrl.DefaultSetting;t.InputFiled_IsDoctorEditorMode&&(this.caretEleStyle.EditForeColor=t.InputFieldEditForeColor)}}IsLockAutoInsertMode(){return this.lockAutoInsertMode}get AutoInsertMode(){return this.isAutoInsertMode}set AutoInsertMode(e){this.lockAutoInsertMode||(this.editorCtrl.M_EleEvtModel.WorkMode==r.ENumWorkMode.KeepTrace&&(e=!0),this.isAutoInsertMode!=e&&(this.isAutoInsertMode=e,this.HideXCaret(),this.ShowXCaret()))}ShowXCaret(){if(this.isCaretHidden){let e=this.GetXCaretWidth();this.SetXCaretPos(e)}}MoveXCaretTo(e,t,n,r=!1,i=!1){n>0&&n!=this.sz.Height&&(this.sz.Height=n,this.HideXCaret()),this.pos.X=e,this.pos.Y=t,this._caretDiv.style.background=r?"#005aff":"#000000";let l=this.SetXCaretWidth();this.SetXCaretPos(l,i)}ReverseManualInsertMode(){this.editorCtrl.M_EleEvtModel.WorkMode==r.ENumWorkMode.KeepTrace?this.isManualInsertMode=!0:(this.isAutoInsertMode?this.isManualInsertMode=!this.isManualInsertMode:(this.isAutoInsertMode=!0,this.lockAutoInsertMode=!0,this.isManualInsertMode=!0),this.HideXCaret(),this.ShowXCaret())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UndoableManager=void 0;const r=n(0),i=n(3),l=n(305),s=n(215),o=n(23),a=n(13);class u extends o.IXUndoable{constructor(){super(),this.undoLimit=20,this.curInx=-10,this.lastCursorOper=null,this.itemList=null,this.itemList=new i.List}IsValid(){return!0}CanUndo(){return this.itemList.Count()>0&&this.curInx>=0}CanRedo(){let e=this.itemList.Count();return e>0&&this.curInx<e-1}Undo(e=!1){if(this.CanUndo()){let t=this.itemList.Get(this.curInx);if(t.CanUndo()){const n=t instanceof a.UndoGroup;if(n&&e&&!t.isPreset)return;t.Undo(),t instanceof s.IXCursorEleUndo&&(this.lastCursorOper=t),(t instanceof l.EleReplaceUndo||n)&&(e||this.DealXStringUndo(t))}this.curInx--}}Redo(){if(this.CanRedo()){this.curInx++;let e=this.itemList.Get(this.curInx);e.CanRedo()&&(e.Redo(),e instanceof s.IXCursorEleUndo&&(this.lastCursorOper=e instanceof s.IXCursorEleUndo?e:null),(e instanceof l.EleReplaceUndo||e instanceof a.UndoGroup)&&this.DealXStringUndo(e))}}AddItem(e){if(null!=e&&e.IsValid()){if(e.CursorRedoEle){e.CursorRedoEle.OwnerDocPanel.IsChanged=!0}{this.DiscardItemsRange(this.curInx+1,-1,-1),this.itemList.Add(e),-10==this.curInx?this.curInx=0:this.curInx++;let t=this.itemList.Count();t>this.undoLimit&&this.DiscardItemsRange(0,t-this.undoLimit,t)}}}GetLastCursorOper(){return this.lastCursorOper}Clear(){this.lastCursorOper=null,this.itemList.Clear(),this.curInx=-10}BulidInfEleHandler(e){this._infEleEvtHandler=e}DiscardItemsRange(e,t,n){if(n<0&&(n=this.itemList.Count()),n>0&&((t<0||t>n)&&(t=n),e>=0&&e<t)){let n=0;const r=this.itemList.GetEnumerator();for(;r.MoveNext();){const i=r.Current;if(n++>=e&&(i.Clear(),n>=t))break}this.itemList.RemoveRange(e,t-e),this.curInx>=e&&(this.curInx<t?this.curInx=0==e?0:e-1:this.curInx-=t-e)}}DealXStringUndo(e){if(null!=this._infEleEvtHandler)if(e instanceof a.UndoGroup){const t=e.GetChildUodoList().GetEnumerator();for(;t.MoveNext();){const e=t.Current;this.DealXStringUndo(e)}}else{const t=e.RelativeEle;if(null!=t)if(t instanceof r.XStringEle||t instanceof r.XBaseInputEle)this.SendEleEvent(t);else{let e=r.XDomUtil.GetParentXInput(t,!1);this.SendEleEvent(e)}}}SendEleEvent(e){null!=e&&(e instanceof r.XStringEle||e instanceof r.XBaseInputEle)&&this._infEleEvtHandler.OnTextChanged(e)}}t.UndoableManager=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditorXDocsUtil=void 0;const r=n(403),i=n(0);t.EditorXDocsUtil=class{constructor(e){this.editorID=null,this.editorID=e}get EditorID(){return this.editorID}MGet_DocumentsCnt(){return r.XDocIOInfoFactory.GetXDocsCntLoaded(this.editorID)}MGet_Documents(){return r.XDocIOInfoFactory.GetXDocsLoaded(this.editorID)}MGet_DocumentsWrap(){return r.XDocIOInfoFactory.GetXDocsWrapLoaded(this.editorID)}MCopy_DocumentsWrap(e,t){let n=this.MGet_DocumentsWrap(),r=null==n?0:n.length;if(r<=0)return null;let l=new Array(r);for(let s=0;s<r;s++)if(null!=n[s]){if(l[s]=new i.XTextDocumentsWrap,l[s].CopyXDocWrapFrom(n[s]),l[s].FirstXDoc.GetDocCtxt().CopyFrom(n[s].FirstXDoc.GetDocCtxt()),null!=t&&null!=l[s].FirstXDoc){let e=l[s].FirstXDoc.GetDocCtxt().ViewMode;e.IsCleanViewMode=!0,e.IsWebViewMode=!1}null!=e&&l[s].RefreshXDocWrapLines(e)}return l}MGet_Document(e,t){if(null!=e&&null!=t||null==e&&null!=t){let e;return e=null==t?null:t.Document,e}{let t,n=r.XDocIOInfoFactory.GetXDocsLoaded(this.editorID),i=null==n?0:n.length;return t=e<0||e>=i?null:n[e],t}}IsAnyXDocsChanged(){let e=this.MGet_Documents(),t=null==e?0:e.length;if(t<=0)return!1;let n=!1;for(let r=0;r<t;r++){let t=e[r];if(null!=t&&t.IsChanged){n=!0;break}}return n}ResetXDocsChangedFlag(){let e=this.MGet_Documents(),t=null==e?0:e.length;if(t>0)for(let n=0;n<t;n++)e[n].ResetChangedFlag()}InvalidXDocsLayout(){let e=this.MGet_Documents(),t=null==e?0:e.length;if(t>0)for(let n=0;n<t;n++)e[n].InvalidLayout()}SyncWorkModelToXDocs(e){let t=this.MGet_Documents(),n=null==t?0:t.length;if(n>0)for(let r=0;r<n;r++)null!=t[r]&&(t[r].GetDocCtxt().EmrWorkMode=e)}SyncViewModelToXDocs(e){let t=this.MGet_Documents(),n=null==t?0:t.length;if(n>0)for(let r=0;r<n;r++)null!=t[r]&&t[r].GetDocCtxt().ViewMode.CopyFrom(e)}SyncUndoMgrToXDocs(e){let t=this.MGet_Documents(),n=null==t?0:t.length;if(n>0)for(let e=0;e<n;e++)t[e]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QiPageCanvas=void 0;const r=n(3),i=n(30),l=n(384),s=n(7),o=n(17),a=n(9),u=n(25),h=n(1098),d=n(1102),c=n(1103),p=n(387),f=n(11),g=n(152),m=n(146),E=n(109);class C extends h.AbstractPageCanvas{constructor(e,t,n){super(e,t,n),this.isWebView=!1,this.pageGap=new u.SizeF(8,8),this.pageListWrap=null,this.pageRowList=null,this.showPageDfltBorder=!0,this.selPageIconLoader=null,this.prt_args=null,this.prtmode_args=null,this.defaultPgBkgColor=s.Color.White,this.pageListWrap=new c.DocPageListWrapper(!0),this.pageRowList=new r.List,this.prt_args=new l.QiPrintArgs,this.prtmode_args=this.prt_args.getPrtModeArgs(),this.GenPageContainer()}GenPageContainer(){g.ImageCache.Clear();let e=this.ContainerDOM.querySelectorAll(".pango-editor-pages");e.length>0&&e.item(0).remove();let t=document.createElement("div");t.className="pango-editor-pages",t.id="pagescontainer",t.style.marginTop="8px",t.tabIndex=1,t.setAttribute("oncontextmenu","return(false)"),this.dom.appendChild(t),this.pageContainerDom=t}AddMouseDown(e){this._mouseDownFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("mousedown",this._mouseDownFunc)}RemoveMouseDown(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("mousedown",this._mouseDownFunc)}AddMouseUp(e){this._mouseUpFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("mouseup",this._mouseUpFunc)}RemoveMouseUp(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("mouseup",this._mouseUpFunc)}AddMouseDoubleClick(e){this._mouseDoubleClickFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("dblclick",this._mouseDoubleClickFunc)}RemoveMouseDoubleClick(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("dblclick",this._mouseDoubleClickFunc)}AddMouseMove(e){this._mouseMoveFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("mousemove",this._mouseMoveFunc)}RemoveMouseMove(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("mousemove",this._mouseMoveFunc)}AddMouseMoveLeave(e){this._mouseMoveLeaveFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("mouseleave",this._mouseMoveLeaveFunc)}RemoveMouseMoveLeave(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("mouseleave",this._mouseMoveLeaveFunc)}AddMouseWheel(e){this._mouseWheelFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("wheel",this._mouseWheelFunc)}RemoveMouseWheel(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("wheel",this._mouseWheelFunc)}AddDragOver(e){this._dragOverFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("dragover",this._dragOverFunc)}RemoveDragOver(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("dragover",this._dragOverFunc)}AddDragDrop(e){this._dragDropFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("dragend",this._dragDropFunc)}RemoveDragDrop(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("dragend",this._dragDropFunc)}AddDragLeave(e){this._dragLeaveFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("dragleave",this._dragLeaveFunc)}RemoveDragLeave(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("dragleave",this._dragLeaveFunc)}AddKeyDown(e){this._keydownFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("keydown",this._keydownFunc)}RemoveKeyDown(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("keydown",this._keydownFunc)}AddKeyPress(e){this._keyPressFunc=e,null!=this.pageContainerDom&&this.pageContainerDom.addEventListener("keypress",this._keyPressFunc)}RemoveKeyPress(e){null!=this.pageContainerDom&&this.pageContainerDom.removeEventListener("keypress",this._keyPressFunc)}MGetPrtArgs(){return this.prt_args}MSetPageList(e,t){this.pageListWrap.PageList=e,this.prtmode_args.ResetPageSelRanges(),t&&super.MSetScrollValue(0,0)}MGetArrPages(){let e=this.pageListWrap.PageList;return null==e||e.Count()<=0?null:e.ToArray()}MHasPage(){return this.pageListWrap.GetPagesCnt()>0}get PageContainerDom(){return this.pageContainerDom}set PageContainerDom(e){this.pageContainerDom=e}getCursorPos(e){let t=this.pageContainerDom,n=o.PointF.Empty,r=E.DomUtils.GetOffset(t),i=E.DomUtils.GetScrollPosition(t),l=e.clientX+i.left-r.left,s=e.clientY+i.top-r.top;return n.X=l,n.Y=s,n}getCursorPosInDom(e){const t=this.ContainerDOM,n=E.DomUtils.GetOffset(t);let r=e.clientX-n.left,i=e.clientY-n.top;return new o.PointF(r,i)}PointToScreen(e){let t=this.pageContainerDom,n=t.offsetParent,r=o.PointF.Empty,i=E.DomUtils.GetOffset(t),l=e.X-(n?n.scrollLeft:0)+i.left,s=e.Y-(n?n.scrollTop:0)+i.top;return r.X=l,r.Y=s,r}get MShowPageDfltBorder(){return this.showPageDfltBorder}set MShowPageDfltBorder(e){this.showPageDfltBorder=e}get MAllowPageSelect(){return super.MAllowPageSelect}set MAllowPageSelect(e){e!=super.MAllowPageSelect&&(super.MAllowPageSelect=e,e&&this.selPageIconLoader,this.prtmode_args.HasPageSelRanges()&&this.prtmode_args.ResetPageSelRanges())}get MPagesCnt(){return this.pageListWrap.GetPagesCnt()}get MIsWebView(){return this.isWebView}set MIsWebView(e){this.isWebView=e}After_VScrollEvt_Handled(e){this.MCurPageIx=this._GetCurPageIxUI()}MCalcAdjustZoomRatio(){if(!this.MHasPage())return 1;let e=this.pageListWrap.GetPageMaxWidth();if(e<=0)return 1;let t=this.MGetSize(),n=this.visibleRect.Width<t.Width?0:this.scrollBarWidth;return 1*(this.visibleRect.Width-n)/e}MReCalc_ContentLayout(){if(this.pageRowList.ToArray().forEach(e=>{e.Clear()}),this.pageRowList.Clear(),!this.MHasPage())return;let e=this.MGetZoomRatio(),t=this.isWebView?0:this.pageGap.Height-2,n=new d.DocPageFltRow;this.pageRowList.Add(n),n.StartPgIx=0,n.ShowPageDfltBorder=this.showPageDfltBorder,n.SetDefaultPgBkgColor(this.defaultPgBkgColor),n.SetPgRowPosY(t,e),n.SetSelPageIconLoader(this.selPageIconLoader);let r=-1,i=this.pageListWrap.PageList;for(let l of i){if(r++,this.MPageCntPerRow<=0||n.GetPgCnt()<this.MPageCntPerRow){if(n.TryAddPage(l,this.isWebView?u.SizeF.Empty:this.pageGap,e,this.visibleRect))continue}t+=n.PgRowOrigHeight,n=new d.DocPageFltRow,this.pageRowList.Add(n),n.StartPgIx=r,n.ShowPageDfltBorder=this.showPageDfltBorder,n.SetDefaultPgBkgColor(this.defaultPgBkgColor),n.SetPgRowPosY(t,e),n.SetSelPageIconLoader(this.selPageIconLoader),n.TryAddPage(l,this.isWebView?u.SizeF.Empty:this.pageGap,e,this.visibleRect)}}ClearCmmtArea(){let e=this.ContainerDOM.querySelectorAll(".pangoEditor-Commentpage");for(let t=0;t<e.length;t++)e[t].remove()}MAfter_LayoutDone(e){if(this.visibleRect.Width<=0||this.visibleRect.Height<=0)return;if(0==this.pageRowList.Count())return;let t=this.pageContainerDom.querySelectorAll("canvas");if(this.MPagesCnt-t.length<0){let e=t.length-this.MPagesCnt;for(let n=t.length-1,r=0;r<e;r++,n--)t.item(n).remove()}let n=this.MGetZoomRatio(),r=this.pageGap.Width*n,l=this.pageGap.Height*n,s=0,o=0,u=0,h=0;for(let e of this.pageRowList){let d=e.GetPageIter(),c=0,p=0,f=0;for(;d.MoveNext();){let e=d.Current,s=e.PageRect.Clone(),g=s.Width+2,m=s.Height+2,E=g*n,C=m*n;if(e.SetPageLocationUI(u,h,i.DefineDPI.Base_WinDPI),t.length<=o?e.CreatePageCanvas(this.pageContainerDom):e.SetPageCanvas(t.item(o)),e.Graphic.Resize(E,C),this._wrapBound=new a.RectangleF(0,r,E+8,C+8),e.Graphic.SetMarginH(r),e.Graphic.SetMarginV(l),u+=g+this.pageGap.Width,f=m,c+=E+r+(e.PageFormat.ShowCmmtArea?194:0),p=C,e.PageFormat.ShowCmmtArea){let t=document.createElement("div");this.ContainerDOM.querySelector("#pagescontainer").appendChild(t),e.CmmtDom=t}o++}s<c&&(s=c),u=0,h+=f+this.pageGap.Height}this.pageContainerDom.style.width=s+"px",this.updateState(),e&&this.Invalidate()}updateState(){}MGetWrapBound(){return this._wrapBound}_GetCurPageIxUI(){let e=0,t=0,n=null;return this.pageRowList.ToArray().some(r=>!(r.PgRowBottom<this.visibleRect.Y)&&(r.PgRowPosY>this.visibleRect.Bottom||(e=this.visibleRect.Height,r.PgRowPosY>this.visibleRect.Y&&(e-=r.PgRowPosY-this.visibleRect.Y),this.visibleRect.Bottom>r.PgRowBottom&&(e-=this.visibleRect.Bottom-r.PgRowBottom),e>t&&(n=r,t=e),!1))),null==n?0:n.StartPgIx}AddOrRemoveDstSelPage(e){if(null==e||!this.MAllowPageSelect)return;this.prtmode_args.GetPageSelectList().AddOrRemoveOnePage(e);let t=a.RectangleF.Empty,n=this.selPageIconLoader.LoadIcon();d.DocPageFltRow.GetSelPageIconRect(t,e,n,this.MGetZoomRatio())}OnPaint(e){let t=this.MGetZoomRatio(),n=this.MShowAsPrint?f.ENumOutTp.CsPrint:f.ENumOutTp.UI_Show,r=new p.PageDrawArgs(n,t);r.CurLcPageIx=-1,r.PrtModeArgs=null==this.prt_args?null:this.prt_args.getPrtModeArgs();for(let t of this.pageRowList){if(this.LazyLoad){if(t.PgRowBottom<this.visibleRect.Y)continue;if(t.PgRowPosY>this.visibleRect.Bottom)break}t.DrawRow(e,this.brush,this.linePen,r)}m.LoadingComp.hide()}}t.QiPageCanvas=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractPageCanvas=void 0;const r=n(249),i=n(386),l=n(1099);class s extends l.QiCanvas{constructor(e,t,n){super(e,t,n),this.showAsPrint=!1,this.allowPageSelect=!1,this.pageCntPerRow=0,this.pageInnRange=null,this.pageInnMovePot=null,this.pageInnRange=new i.PageInnRange,this.pageInnMovePot=new r.PageInnPoint}get MShowAsPrint(){return this.showAsPrint}set MShowAsPrint(e){this.showAsPrint=e}get MAllowPageSelect(){return this.allowPageSelect}set MAllowPageSelect(e){this.allowPageSelect=e}get MPagesCnt(){return 0}get MPageCntPerRow(){return this.pageCntPerRow}set MPageCntPerRow(e){this.pageCntPerRow=e}get MCurPageIx(){return this.curPageIx}set MCurPageIx(e){this.curPageIx=e}get PageSelFromTo(){return this.pageInnRange}get PageInnMovePot(){return this.pageInnMovePot}}t.AbstractPageCanvas=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QiCanvas=void 0;const r=n(30),i=n(7),l=n(67),s=n(9),o=n(25),a=n(53),u=n(1100);class h extends u.QiXBaseControl{constructor(e,t,n){super(e,t,n),this.scrollBarWidth=10,this.zoomRatio=1,this.isAdjustRatio=!1,this.visibleRect=s.RectangleF.Empty,this.maxScrollSize=o.SizeF.Empty,this.brush=new a.SolidBrush(i.Color.Transparent),this.linePen=new l.Pen(i.Color.Black),this.canvasBkgColor=i.Color.White,this.forbidDWM=!1,this.screenDPI=o.SizeF.Empty,this.noDataMsg=null,this.tmp_szf=o.SizeF.Empty,this.brush=new a.SolidBrush(i.Color.Transparent),this._SetVisibleRect(),this._BindEvent(),this._GetScreenInfo()}get IsPrintview(){return this._isPrintView}set IsPrintview(e){this._isPrintView=e}_GetScreenInfo(){this.forbidDWM=!1,this.screenDPI.Width=96,this.screenDPI.Height=96}get ScreenDPI(){return this.screenDPI}_SetVisibleRect(){let e=this.dom.clientHeight?this.dom.clientHeight:this.EditorHeight;Object.prototype.hasOwnProperty.call(this,"EditorHeight")&&(e=this.EditorHeight),this.visibleRect=new s.RectangleF(this.dom.scrollLeft,this.dom.scrollTop,this.EditorWidth?this.EditorWidth:this.dom.offsetWidth,e)}SetVisibleRect(){this._SetVisibleRect()}_BindEvent(){this.dom.removeEventListener("scroll",this.ScrollHandler.bind(this)),this.dom.removeEventListener("mousewheel",this.ScrollHandler.bind(this)),this.dom.addEventListener("scroll",this.ScrollHandler.bind(this)),this.dom.addEventListener("mousewheel",this.ScrollHandler.bind(this))}ScrollHandler(e){this._isPrintView||(this.visibleRect.X!=this.dom.scrollLeft?this.After_HScrollEvt_Handled(this.dom.scrollLeft):this.visibleRect.Y!=this.dom.scrollTop&&this.After_VScrollEvt_Handled(this.dom.scrollTop),this.visibleRect.X=this.dom.scrollLeft,this.visibleRect.Y=this.dom.scrollTop,this.MAfter_LayoutDone(!1),this.Invalidate()),this.OnScrollEvent&&this.OnScrollEvent(e)}MGetZoomRatio(){return this.zoomRatio}MSetZoomRatio1(e,t){this.isAdjustRatio=e.IsAdjust;let n=e.IsAdjust?this.MCalcAdjustZoomRatio():e.FltRatio;n<=0||this.zoomRatio==n||(this.zoomRatio=n,t&&this.MReCalcLayout())}MSetZoomRatio(e,t){e<=0||this.zoomRatio==e||(this.isAdjustRatio=!1,this.zoomRatio=e,t&&this.MReCalcLayout())}MGetMaxScrollSize(){return this.maxScrollSize}MMoveScrollToOutPot(e){let t=this.ContainerDOM.querySelector("#pango-editor-content-"+this.ContainerDOM.id);const n=t.scrollTop,r=this.visibleRect.Height;let i=.1*r,l=e-n;l>=r-i?l=i:l<10?(i>n&&(i=n),i<0&&(i=0),l=-1*i):l=0,0!=l&&null!=t&&(t.scrollTop=n+l)}MReCalcLayout(e=!0){this.MReCalc_ContentLayout(),this.MAfter_LayoutDone(e)}MSetCanvasBkgColor(e){this.canvasBkgColor=e}After_VScrollEvt_Handled(e){}After_HScrollEvt_Handled(e){}MCalcAdjustZoomRatio(){return 1}MGetSize(){let e=this.Size;if(!this.forbidDWM)return e;let t=this.screenDPI.Width/r.DefineDPI.Base_WinDPI;return e.Width=this.Width/t,e.Height=this.Height/t,e}MReCalc_ContentLayout(){}MAfter_LayoutDone(e){e&&this.Invalidate()}MSetScrollValue(e,t){if(e<0&&t<0)return;let n=this.ContainerDOM.querySelector("#pango-editor-content-"+this.ContainerDOM.id);n.scrollTop=t,n.scrollLeft=e,this.MAfter_LayoutDone(!1)}}t.QiCanvas=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QiXBaseControl=void 0;const r=n(1101),i=n(11),l=n(7),s=n(67);class o extends r.XBaseControl{constructor(e,t,n){super(e,t,n),this.border_width=1,this.border_color=l.Color.Black,this.border_sides=i.ENumDirection.NONE,this.line_pen=null,this.canFocus=!0,this.flagKeyGetFocus=!1,this.enterFlag=!0,this.isFocus=!1,this.line_pen=new s.Pen(l.Color.Black,1),this.CanFocus=!0,this.SingleBorderStyle=!1}get QiBorderWidth(){return this.border_width}set QiBorderWidth(e){this.border_width=e}get QiBorderColor(){return this.border_color}set QiBorderColor(e){this.border_color=e}get QiBorderDirection(){return this.border_sides}set QiBorderDirection(e){this.border_sides=e}get CanFocus(){return this.canFocus}set CanFocus(e){this.canFocus=e}get FlagKeyGetFocus(){return this.flagKeyGetFocus}set FlagKeyGetFocus(e){this.flagKeyGetFocus=e}get EnterFlag(){return this.enterFlag}set EnterFlag(e){this.enterFlag=e}get IsFocus(){return this.isFocus}set IsFocus(e){this.isFocus=e}get TabSkip(){return this.tabSkip}set TabSkip(e){this.tabSkip=e}Focus(){return this.CanFocus&&this.Enabled&&this.Visible?(this.IsFocus||(this.IsFocus=!0),!0):(this.IsFocus=!1,!1)}OnPaint(e){super.OnPaint(e),this.SingleBorderStyle||this._QiPaintBorder(e)}_QiPaintBorder(e){if(this.border_width<=0)return;this.line_pen.Width=this.border_width,this.line_pen.Color=this.border_color;let t=this.line_pen.Width+.5;i.ENumDirection.ALL==this.border_sides?e.DrawRectangle(this.line_pen,0,0,this.Size.Width-t,this.Size.Height-t):i.DrawConstDef.HasDirection(this.border_sides,i.ENumDirection.LEFT)?e.DrawLine(this.line_pen,0,0,0,this.Height-t):i.DrawConstDef.HasDirection(this.border_sides,i.ENumDirection.TOP)?e.DrawLine(this.line_pen,0,0,this.Width-t,0):i.DrawConstDef.HasDirection(this.border_sides,i.ENumDirection.RIGHT)?e.DrawLine(this.line_pen,this.Width-t,0,this.Width-t,this.Height-t):i.DrawConstDef.HasDirection(this.border_sides,i.ENumDirection.BOTTOM)&&e.DrawLine(this.line_pen,0,this.Height-t,this.Width-t,this.Height-t)}}t.QiXBaseControl=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XBaseControl=void 0;const r=n(151),i=n(17),l=n(9),s=n(25);t.XBaseControl=class{constructor(e,t,n){this.customEvtGrp=null,this.graphics=null,this.painting=!1,this._lazyLoad=!0,this._ShowStatusImg=!0,this._ShowWaterMark=!0,this._showXParagraphFlag=!0,this._x=0,this._y=0,this._height=0,this._width=0,this._Visible=!0,this._Enabled=!0,this.ContainerDOM=e,this.EditorWidth=t,this.EditorHeight=n,this.canvasKey=this._GenTmpCanvasKey(),this.dom=this.ContainerDOM.querySelector("#"+this.canvasKey),this.graphics=r.Graphics.Empty}get ContainerDOM(){return this._containerdom}set ContainerDOM(e){this._containerdom=e}get EditorWidth(){return this._editorWidth}set EditorWidth(e){this._editorWidth=e}get LazyLoad(){return this._lazyLoad}set LazyLoad(e){this._lazyLoad=e}get ShowStatusImg(){return this._ShowStatusImg}set ShowStatusImg(e){this._ShowStatusImg=e}get ShowWaterMark(){return this._ShowWaterMark}set ShowWaterMark(e){this._ShowWaterMark=e}get EditorHeight(){return this._d}set EditorHeight(e){this._d=e}set ShowXParagraphFlag(e){this._showXParagraphFlag=null==e||e}get ShowXParagraphFlag(){return this._showXParagraphFlag}Invalidate(){this.painting||(this.painting=!0,this.LazyLoad?requestAnimationFrame(()=>{this.Paint()}):this.Paint())}Paint(){let e;this.graphics.ShowXParagraphFlag=this.ShowXParagraphFlag,this.graphics.ShowStatusImg=this.ShowStatusImg,this.graphics.ShowWaterMark=this.ShowWaterMark,this.customEvtGrp.beforePaint&&this.customEvtGrp.beforePaint();try{this.OnPaint(this.graphics),e=!0}catch(t){e=!1}this.customEvtGrp.afterPaint&&this.customEvtGrp.afterPaint(e),this.painting=!1}get FocusManager(){return this._focusManager}set FocusManager(e){this._focusManager=e}_GenTmpCanvasKey(){return"pango-editor-content-"+this.ContainerDOM.id}set Bounds(e){this._x=e.X,this._y=e.Y,this._width=e.Width,this._height=e.Height}get Bounds(){return new l.RectangleF(this.Location.X,this.Location.Y,this.Width,this.Height)}set Location(e){this._x=e.X,this._y=e.Y}get Location(){return new i.PointF(this._x,this._y)}get Size(){return new s.SizeF(this.Width,this.Height)}set Size(e){this.Height=e.Height,this.Width=e.Width}get Height(){return this._height}set Height(e){this._height=e}get Width(){return this._width}set Width(e){this._width=e}OnPaint(e){}get Visible(){return this._Visible}set Visible(e){this._Visible=e}get Enabled(){return this._Enabled}set Enabled(e){this._Enabled=e}get SingleBorderStyle(){return this._SingleBorderStyle}set SingleBorderStyle(e){this._SingleBorderStyle=e}Focus(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocPageFltRow=void 0;const r=n(3),i=n(140),l=n(7),s=n(9),o=n(25),a=n(110);t.DocPageFltRow=class{constructor(){this.row_pglist=null,this.start_pgix=-1,this.row_orig_rect=s.RectangleF.Empty,this.row_cs_rectf=s.RectangleF.Empty,this.tmp_pgv_orig_posx=0,this.tmp_rect=s.RectangleF.Empty,this.show_pg_dflt_border=!0,this.default_pg_bkgcolor=l.Color.White,this.selpage_icon_loader=null,this.row_pglist=new r.List}Clear(){this.row_pglist.Clear(),this.row_cs_rectf.X=0,this.row_cs_rectf.Y=0,this.row_cs_rectf.Width=0,this.row_cs_rectf.Height=0,this.row_orig_rect.X=0,this.row_orig_rect.Y=0,this.row_orig_rect.Width=0,this.row_orig_rect.Height=0}get StartPgIx(){return this.start_pgix}set StartPgIx(e){this.start_pgix=e}GetPgCnt(){return this.row_pglist.Count()}GetPageIter(){let e=this.row_pglist.GetEnumerator();return e.Reset(),e}get PgRowPosY(){return this.row_cs_rectf.Y+.5}get PgRowBottom(){return this.row_cs_rectf.Bottom+.5}get PgRowWidth(){return this.row_cs_rectf.Width+.5}get PgRowHeight(){return this.row_cs_rectf.Height+.5}get PgRowOrigHeight(){return this.row_orig_rect.Height}SetPgRowPosY(e,t){this.row_orig_rect.Y=e,this.row_cs_rectf.Y=e*t}set ShowPageDfltBorder(e){this.show_pg_dflt_border=e}SetDefaultPgBkgColor(e){this.default_pg_bkgcolor=e}SetSelPageIconLoader(e){this.selpage_icon_loader=e}TryAddPage(e,t,n,r){let l=e.PageRect.Size,s=e.PageFormat.ShowCmmtArea?i.PageFormat.GetCmmtAreaWidth(-1):0,u=o.SizeF.Empty;a.RectFUtil.ZoomSizeF(l,u,n);let h=s*n,d=this.row_pglist.Count()>0;return!(this.row_pglist.Count()>0)&&(this.row_pglist.Add(e),this.tmp_pgv_orig_posx+=l.Width+s+t.Width,this.row_cs_rectf.Width+=u.Width+h,this.row_orig_rect.Width+=l.Width+s,d&&(this.row_cs_rectf.Width+=t.Width*n,this.row_orig_rect.Width+=t.Width),u.Height>this.row_cs_rectf.Height&&(this.row_cs_rectf.Height=u.Height,this.row_orig_rect.Height=l.Height,this.row_cs_rectf.Height+=t.Height*n,this.row_orig_rect.Height+=t.Height),!0)}static GetSelPageIconRect(e,t,n,r){if(null==t)return;let i=t.PageLocationUI,l=t.PageRect;e.X=i.X+l.Width-n.Width-5,e.Y=i.Y+5,e.Width=n.Width,e.Height=n.Height}DrawRow(e,t,n,r){let i=null,s=l.Color.Empty,o=-1,a=this.row_pglist.GetEnumerator();for(;a.MoveNext();){let l=a.Current;o=l.PageIx,i=l.PageBorder,s=l.BkgColor,l.PageBorder=this.show_pg_dflt_border?l.DefaultPageBorder:null,l.ShowPageBorder=this.show_pg_dflt_border,l.BkgColor=this.default_pg_bkgcolor,l.DrawPage(e,t,n,r),l.PageBorder=i,l.BkgColor=s}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocPageListWrapper=void 0;const r=n(3),i=n(4);class l{constructor(e,t,n){this.docKey=null,this.docName=null,this.tipBeforePrt=null,this.pageList=null,this.isRefPgList=!0,this.isRefPgList=e,e||(this.pageList=new r.List),this.docKey=t,this.docName=n}get DocKey(){return this.docKey}set DocKey(e){this.docKey=e}get DocName(){return this.docName}set DocName(e){this.docName=e}get TipBeforePrt(){return this.tipBeforePrt}set TipBeforePrt(e){this.tipBeforePrt=e}get PageList(){return this.pageList}set PageList(e){this.isRefPgList?this.pageList=e:(this.pageList.Clear(),this.pageList.AddRange(e))}get FirstPage(){return this.GetPagesCnt()<=0?null:this.pageList[0]}get FirstPageFmt(){let e=this.FirstPage;return null==e?null:e.PageFormat}Clear(e){this.docKey=null,this.docName=null,this.tipBeforePrt=null,this.ClearPageViewList(e)}ClearPageViewList(e){(null==this.pageList?0:this.pageList.Count)>0&&(this.isRefPgList||(e&&this.pageList.ToArray().forEach(e=>{null!=e&&e.Clear()}),this.pageList.Clear()))}GetPagesCnt(){return null==this.pageList?0:this.pageList.Count()}GetPageMaxWidth(){if(this.GetPagesCnt()<=0)return 0;{let e=0;return this.pageList.ToArray().forEach(t=>{t.PageRect.Width>e&&(e=t.PageRect.Width)}),e}}CopyFrom(e){null!=e&&e!=this&&(this.isRefPgList=e.isRefPgList,this.docKey=e.docKey,this.docName=e.docName,this.tipBeforePrt=e.tipBeforePrt,this.isRefPgList?this.pageList=e.pageList:(this.pageList.Clear(),this.pageList.AddRange(e.pageList)))}GetHashCode(){let e=7;return null!=this.docKey&&(e=7*e+i.default.GetHashCode(this.docKey)),e}Equals(e){if(null!=e&&e instanceof l){let t=e;return i.default.Equals(this.docKey,t.docKey)}return!1}}t.DocPageListWrapper=l},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,l){function s(e){try{a(r.next(e))}catch(e){l(e)}}function o(e){try{a(r.throw(e))}catch(e){l(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}a((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EditorMsKBEvtHandler=void 0;const i=n(2),l=n(45),s=n(29),o=n(1105),a=n(183),u=n(176),h=n(1106),d=n(1157),c=n(0),p=n(1158),f=n(32),g=n(62),m=n(44),E=n(14),C=n(59),A=n(36),y=n(40),I=n(75),S=n(46);t.EditorMsKBEvtHandler=class{constructor(){this.xdocEditor=null,this.eleEvtModel=null,this.evtLayerMgr=null,this.kbEvtHandler=null,this._inputKeyboardHandler=null,this.clickInSelectRange=!1,this.dragFlag=!1}get HandlerLayerMgr(){return this.evtLayerMgr}SetEvtSrcCtrl(e){this.xdocEditor=e,this.eleEvtModel=this.xdocEditor.M_EleEvtModel,this.evtLayerMgr=new h.EditorHandlerLayerMgr(this.xdocEditor),this.kbEvtHandler=new d.EditorKeyboardEvtHandler(this.xdocEditor),this._inputKeyboardHandler=new p.InputKeyboardEvtHandler(this.xdocEditor),this.tableKeyboardEvtHandler=new o.XTextTableKeyboardEventHandler(this.xdocEditor)}Leave(){}OnMouseL_Pressed(e){return r(this,void 0,void 0,(function*(){this.dragFlag=!1;const t=this.eleEvtModel.EleClickedWrap,n=t.EleFocused;this.eleEvtModel.Locate_EleInLine(i.ENumEvtSrc.MOUSE_LPRESS,e,t);const r=t.EleFocused,l=this.CheckPanelClickValid(n,r);if(this.clickInSelectRange=!1,l){let l=e.getModifierState("Shift");if(l&&this.eleEvtModel.SelRange.FromLineEleIx.IsValid(),!(l||r instanceof c.XBaseResizableElement)){if(this.eleEvtModel.SelRange.IsEleInRange(r)&&this.eleEvtModel.WorkMode!=i.ENumWorkMode.Form&&this.eleEvtModel.WorkMode!=i.ENumWorkMode.Design)return void(this.clickInSelectRange=!0);this.eleEvtModel.ReInitSelRange()}let[s,o]=this.CheckFormModeCursorEle(t);if(s){let e=t.GetNextEle(o);this.eleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(e)}const a=this._MGetMouseModKeys(e),u=t.ClickPosInCtrl;if(yield this.evtLayerMgr.Handle(i.ENumEvtSrc.MOUSE_LPRESS,a,u.X,u.Y,0,0),this.eleEvtModel.CheckFormModeFocusedEle(n,r))return}this.eleEvtModel.MoveCaretByCursorEle(!0),this.xdocEditor.M_EleEvtHandler.OnCursorChange(n,r);const s=this.xdocEditor.Focus();this.xdocEditor.M_EdtCaret.Focus(),s&&(this.xdocEditor.M_EdtCaret._IsFocus=!0)}))}CheckFormModeCursorEle(e){let t=!1,n=!1;if(this.xdocEditor.M_EleEvtModel.WorkMode==i.ENumWorkMode.Form){let r=e.GetNextEle(!1);if(r instanceof c.XInputBorderEle&&!r.IsDrawText&&!r.IsStartBorder)return n=!1,t=!0,[t,n];let i=e.EleFocused;if(i instanceof c.XInputBorderEle&&!i.IsDrawText&&i.IsStartBorder)return n=!0,t=!0,[t,n]}return[t,n]}OnMouseL_Released(e){if(!a.EmrFmtBrush.GetInstance().IsEmpty()){let e=this.xdocEditor.M_GetActionByName("FormatBrush");null!=e&&e.Execute([null])}if(this.clickInSelectRange&&!this.dragFlag){this.eleEvtModel.ReInitSelRange(),this.eleEvtModel.MoveCaretByCursorEle(!0);this.xdocEditor.Focus()&&(this.xdocEditor.M_EdtCaret._IsFocus=!0)}this.evtLayerMgr.OnDone()}OnMouseR_Pressed(e){const t=this.eleEvtModel.EleClickedWrap,n=t.EleFocused;this.eleEvtModel.Locate_EleInLine(i.ENumEvtSrc.MOUSE_RPRESS,e,t);const r=t.EleFocused;if(this.CheckPanelClickValid(n,r)){this.xdocEditor.M_EdtCustomEvtGrp.BeforeRightMenu&&this.xdocEditor.M_EdtCustomEvtGrp.BeforeRightMenu();const t=this.xdocEditor.M_rightMenu;t.MenuItemConfig(e,r),t.setEditor(this.xdocEditor),t.CreateRightMenuRender()}this.eleEvtModel.MoveCaretByCursorEle(!0),this.xdocEditor.M_EleEvtHandler.OnCursorChange(n,r);this.xdocEditor.Focus()&&(this.xdocEditor.M_EdtCaret._IsFocus=!0)}OnMouseR_Released(e){}OnMouse_DblClick(e){return r(this,void 0,void 0,(function*(){const t=this.eleEvtModel.EleClickedWrap,n=this.eleEvtModel.EleMOverWrap,r=t.EleFocused;let l=this._MGetMouseModKeys(e),s=this.xdocEditor.getCursorPos(e).X,o=this.xdocEditor.getCursorPos(e).Y;const a=yield this.evtLayerMgr.Handle(i.ENumEvtSrc.MOUSE_DBLCLICK,l,s,o,0,0);if(this.evtLayerMgr.OnDone(),a){this.eleEvtModel.Locate_EleInLine(i.ENumEvtSrc.MOUSE_LPRESS,e,t);const l=t.EleFocused;let s=c.XDomUtil.GetParentXInput(l);if(l instanceof c.XImageEle&&(l.ImageType==I.ImageType.SyncImage||"SyncImage"==l.ImageType)&&!A.StringUtils.IsNullOrEmpty(l.CptID)||s instanceof c.XInputEle&&s.InputType==y.EleTypeEnum.SignEle){let e;e=A.StringUtils.IsNullOrEmpty(l.CptID)?s:l;let t={cptId:e.CptID,haveValue:e instanceof c.XImageEle?e.HaveValue:e.SignEleHaveValue,XID:e.XID};this.xdocEditor.M_EdtCustomEvtGrp.DoubleClickSyncImg&&this.xdocEditor.M_EdtCustomEvtGrp.DoubleClickSyncImg(t)}let o=n.EleFocused;if(o instanceof f.XTextLabelElement){let e={cptId:o.CptID,XID:o.XID,text:o.Text,bodylocation:this.xdocEditor.GetAlertFormStartRect(S.PositionEnum.LeftBottom,0,0).Location};this.xdocEditor.M_EdtCustomEvtGrp.DoubleClickTitle&&this.xdocEditor.M_EdtCustomEvtGrp.DoubleClickTitle(e)}this.eleEvtModel.CheckFormModeFocusedEle(r,l),this.xdocEditor.M_EleEvtModel.MoveCaretByCursorEle(!0)}this.xdocEditor.Focus()&&(this.xdocEditor.M_EdtCaret._IsFocus=!0)}))}OnMouse_TripleClick(e){}OnMouse_Wheel(e){}OnMouse_Moved(e){let t=this.eleEvtModel.EleMOverWrap;this.eleEvtModel.Locate_EleInLine(i.ENumEvtSrc.MOUSE_MOVE,e,t);let n=t.ClickPosInCtrl;this.evtLayerMgr.Handle(i.ENumEvtSrc.MOUSE_MOVE,s.Keys.None,n.X,n.Y,0,0),this.evtLayerMgr.OnDone();let r=t.EleFocused;if(r instanceof c.XButtonEle&&(this.xdocEditor.ContainerDOM.style.cursor="pointer"),null!=r){u.EmrTooltipManager.Instance.RefreshTooltip();const e=this.xdocEditor.DefaultSetting.InputFieldHoverColor.toString();if(null!=e&&-1==e.indexOf("#00")){let e=this.xdocEditor.M_GetActionByName("HoverXInputEle");null!=e&&e.Execute([r])}let t=this.xdocEditor.M_EdtCustomEvtGrp.XLabelHoverBackParagraph;if(null!=t){const e=C.ClickedElementWrapper.GetEleRectInCtrl(r,r.OwnPageView,this.xdocEditor.MGetZoomRatio()),i=n.X>=e.Left&&n.X<=e.Right,l=null==this.HoverXLabel||this.HoverXLabel.XID!=r.XID;if(l||!i){if(null!=this.HoverXLabel){const e=this.xdocEditor.M_EdtCustomEvtGrp.XLabelMoveOut;if(null!=e){e({cid:this.HoverXLabel.CptID})}this.HoverXLabel=null}if(l&&i&&r instanceof f.XTextLabelElement){this.HoverXLabel=r;const e=this.HoverXLabel.CptID;let i=new g.XTextDocument(!1);const l=m.TextDocApiUtil.getXLabelParagraphText(this.HoverXLabel,i,!0),s=i.getBodyEleWidthCptId(),o=i.ToXML(),a=E.XmlDomUtil.Xml2String(o);t({postion:[n.X,n.Y],cid:e,label:this.HoverXLabel.EleText,ParagraphTxt:l,childrenCidArr:s,xml:'<?xml version="1.0" encoding="utf-8"?>'+a})}}}}}OnMouse_Dragged(e){const t=this.eleEvtModel.EleMOverWrap,n=this.eleEvtModel.EleClickedWrap;this.eleEvtModel.Locate_EleInLine(i.ENumEvtSrc.MOUSE_DRAG,e,t);const r=this._MGetMouseModKeys(e),l=n.ClickPosInCtrl,s=t.ClickPosInCtrl;this.dragFlag=!0,this.evtLayerMgr.Handle(i.ENumEvtSrc.MOUSE_DRAG,r,l.X,l.Y,s.X-l.X,s.Y-l.Y,this.clickInSelectRange),this.xdocEditor.MMoveScrollToOutPot(s.Y)}OnMouse_Leave(e){this.evtLayerMgr.Handle(i.ENumEvtSrc.MOUSE_MOVELeave,s.Keys.None,0,0,0,0)}OnKeyboard_FuncKey(e,t){let n;return e!=s.Keys.Return&&e!=s.Keys.Tab||t!=s.Keys.None||(n=this._inputKeyboardHandler.OnKeyDown(this.eleEvtModel.EleClickedWrap,e)),n||(n=this.tableKeyboardEvtHandler.OnKeyboard_FuncKey(e,t,this.eleEvtModel)),n||(n=this.kbEvtHandler.OnKeyboard_FuncKey(e,t),this.JumpInnerTable(e)),n}OnKeyboard_CharPress(e,t=!1){return this.kbEvtHandler.OnKeyboard_CharPress(e,t)}OnScroll_ValChanged(e,t){this.eleEvtModel.ClosePopCtrl();let n=this.xdocEditor.M_EdtCustomEvtGrp;null!=n.OnScrollValChanged&&n.OnScrollValChanged(e,t)}_MGetMouseModKeys(e){let t=s.Keys.None,n=e.getModifierState("Shift");n&&(t|=s.Keys.Shift);e.getModifierState("Control");n&&(t|=s.Keys.Control);e.getModifierState("Alt");return n&&(t|=s.Keys.Alt),t}JumpInnerTable(e){if(this.eleEvtModel.EleClickedWrap.EleFocused instanceof l.XTextTable&&(e==s.Keys.ArrowLeft||e==s.Keys.ArrowRight||e==s.Keys.ArrowUp||e==s.Keys.ArrowDown)){let t,n=this.eleEvtModel.EleClickedWrap.EleFocused;t=e==s.Keys.ArrowRight||e==s.Keys.ArrowDown?n.GetFirstCell():n.GetLastCell(),null!=t.GetFirstChildBaseEle(!0)&&(this.eleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(t.GetFirstChildBaseEle(!0)),this.eleEvtModel.MoveCaretByCursorEle(!0))}}CheckPanelClickValid(e,t){if(null==e)return!0;if(null==t)return!1;const n=e.OwnerDocPanel.IsEditable,r=t.OwnerDocPanel.IsEditable,i="XTextBody"==t.OwnerDocPanel.EleTypeName;return!(n&&!r&&!i)||(this.eleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(e),!1)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XTextTableKeyboardEventHandler=void 0;const r=n(20),i=n(29),l=n(0),s=n(9);t.XTextTableKeyboardEventHandler=class{constructor(e){this.DocEditor=e}OnKeyboard_FuncKey(e,t,n){let l,s=r.XTextTableUtil.GetCursorCell(n.EleClickedWrap.EleFocused);if(null==s)l=!1;else{let r=s.Parent.Parent;if(null==r)l=!1;else{if(t==i.Keys.Shift&&e==i.Keys.Tab)return l=this.MovePreCell(r,s,n,!0),l;if(e==i.Keys.ArrowUp){let e=!0;this.DocEditor.M_EdtCustomEvtGrp.beforeArrowKeydown&&(e=this.DocEditor.M_EdtCustomEvtGrp.beforeArrowKeydown()),!1!==e&&(l=this.MoveUpCell(r,s,n))}else if(e==i.Keys.ArrowDown){let e=!0;this.DocEditor.M_EdtCustomEvtGrp.beforeArrowKeydown&&(e=this.DocEditor.M_EdtCustomEvtGrp.beforeArrowKeydown()),!1!==e&&(l=this.MoveDownCell(r,s,n))}else if(e==i.Keys.Tab)l=this.MoveNextCell(r,s,n);else{if(e==i.Keys.ArrowLeft){if(n.EleClickedWrap.EleFocused.Equals(s.GetFirstChildBaseEle(!0)))return l=this.MovePreCell(r,s,n,!1),l}else if(e==i.Keys.ArrowRight&&n.EleClickedWrap.EleFocused.Equals(s.GetLastChildEle()))return l=this.MoveNextCell(r,s,n),l;l=!1}}}return l}MoveDownCell(e,t,n){let r;if(t.RowIndex==e.Rows.Count()-1){let t=e.OwnerLine.GetEleByInx(e.OwnerLine.IndexOfElement(e)+1);n.EleClickedWrap.LineEleIxFocused.SetEle(t),n.MoveCaretByCursorEle(!0),r=!0}else if(n.EleClickedWrap.EleFocused.OwnerLine.Index<t.LinesCnt-1)r=!1;else{let i=e.GetDownCell(t,!0);null!=i?(n.EleClickedWrap.LineEleIxFocused.SetEle(i.GetCharacterEle().Get(0)),n.MoveCaretByCursorEle(!0),r=!0):r=!1}return!0===r&&this.DocEditor.MSetScrollToEleRect(this.DocEditor.M_EleEvtModel.EleClicked,s.RectangleF.Empty),r}MoveUpCell(e,t,n){let r;if(0==t.RowIndex){let t=l.XDomUtil.GetNextEle(!1,e);null!=t&&this.UpdateCursorEle(n,t),r=!0}else if(0!=n.EleClickedWrap.EleFocused.OwnerLine.Index)r=!1;else{let i=e.GetUpCell(t,!0);null!=i?(this.UpdateCursorEle(n,i.GetCharacterEle().Get(0)),r=!0):r=!1}return!0===r&&this.DocEditor.MSetScrollToEleRect(this.DocEditor.M_EleEvtModel.EleClicked,s.RectangleF.Empty),r}MoveNextCell(e,t,n){let r;if(e.GetLastCell().Equals(t)){let t=e.OwnerLine.GetEleByInx(e.OwnerLine.IndexOfElement(e)+1);this.UpdateCursorEle(n,t),r=!0}else{let i=e.GetNextCell(t,!0);if(null!=i){let e=i.GetFirstChildBaseEle(!0);l.XDomUtil.IsBdrOfXInput(e)?this.UpdateCursorEle(n,l.XDomUtil.GetParentXInput(e,!1).GetInsertModelCursorEle()):this.UpdateCursorEle(n,e),r=!0}else r=!1}return!0===r&&this.DocEditor.MSetScrollToEleRect(this.DocEditor.M_EleEvtModel.EleClicked,s.RectangleF.Empty),r}MovePreCell(e,t,n,r=!1){let i;if(e.GetFirstCell().Equals(t)){let t=l.XDomUtil.GetNextEle(!1,e);null!=t&&this.UpdateCursorEle(n,t),i=!0}else{let s=e.GetPreCell(t,!0);if(null!=s){if(r){let e=s.GetFirstChildBaseEle(!0);l.XDomUtil.IsBdrOfXInput(e)?this.UpdateCursorEle(n,l.XDomUtil.GetParentXInput(e,!1).GetInsertModelCursorEle()):this.UpdateCursorEle(n,e)}else{let e=s.GetLastChildEle();l.XDomUtil.IsBdrOfXInput(e)?this.UpdateCursorEle(n,l.XDomUtil.GetParentXInput(e,!1).GetInsertModelCursorEle()):this.UpdateCursorEle(n,e)}i=!0}else i=!1}return!0===i&&this.DocEditor.MSetScrollToEleRect(this.DocEditor.M_EleEvtModel.EleClicked,s.RectangleF.Empty),i}UpdateCursorEle(e,t){e.EleClickedWrap.LineEleIxFocused.SetEle(t),e.MoveCaretByCursorEle(!0)}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,l){function s(e){try{a(r.next(e))}catch(e){l(e)}}function o(e){try{a(r.throw(e))}catch(e){l(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}a((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EditorHandlerLayerMgr=void 0;const i=n(2),l=n(404),s=n(405),o=n(406),a=n(407),u=n(408),h=n(409),d=n(3),c=n(410),p=n(411),f=n(412),g=n(252),m=n(413),E=n(1156);t.EditorHandlerLayerMgr=class{constructor(e){this.xdocEditor=null,this.evtLayerList=null,this.xdocPanelEditableLayer=null,this.xdocEditor=e,this._InitLayers(),this.xdocPanelEditableLayer=new h.XDocPanelEditableLayer(this.xdocEditor)}_InitLayers(){this.evtLayerList=new d.List;let e=new a.MarkEleTestLayer(this.xdocEditor);this.evtLayerList.Add(e);let t=new u.PointTestLayer(this.xdocEditor);this.evtLayerList.Add(t);let n=new o.MarkEleClickLayer(this.xdocEditor);this.evtLayerList.Add(n);let r=new s.AutoNearSelRangeLayer(this.xdocEditor);this.evtLayerList.Add(r);let i=new l.AEleSelectBeforeLayout(this.xdocEditor);this.evtLayerList.Add(i);let h=new c.AEleSelectLayer(this.xdocEditor);this.evtLayerList.Add(h);let C=new m.AEleEdtLayer(this.xdocEditor);this.evtLayerList.Add(C);let A=new p.ResizeXTableLayer(this.xdocEditor);this.evtLayerList.Add(A);let y=new f.ResizeAEleLayer(this.xdocEditor);this.evtLayerList.Add(y);let I=new E.DragXImageLayer(this.xdocEditor);this.evtLayerList.Add(I);let S=new g.ChangeLineSelRangeLayer(this.xdocEditor);this.evtLayerList.Add(S)}OnReload(){}Handle(e,t,n,l,s,o,a=!1){return r(this,void 0,void 0,(function*(){let r=!1;for(let r=0;r<this.evtLayerList.Count();r++){let h=this.evtLayerList.Get(r);if(h.CanWakeBySrc(t,e)&&(h instanceof E.DragXImageLayer&&h.TryWake(n,l,a)||h.TryWake(n,l))&&(yield h.Handle(t,s,o),!h.CanWakeNextLayer()))break;h instanceof E.DragXImageLayer&&e==i.ENumEvtSrc.MOUSE_MOVELeave&&h.IsWaken&&h.UnWaken(),h instanceof u.PointTestLayer&&e==i.ENumEvtSrc.MOUSE_MOVELeave&&h.tooltipHide()}if(this.xdocPanelEditableLayer.CanWakeBySrc(t,e)){this.xdocPanelEditableLayer.TryWake(n,l)?this.xdocPanelEditableLayer.Handle(t,s,o):r=!0}return r}))}OnDone(){for(let e=0;e<this.evtLayerList.Count();e++){let t=this.evtLayerList.Get(e);t.IsWaken&&t.OnDone()}this.xdocPanelEditableLayer.OnDone()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XButtonEle_EvtHandler=void 0;t.XButtonEle_EvtHandler=class{OnMouseClick(e,t){let n,r=t.EventType;n=r||"buttonClick";let i={type:n,data:""};e.M_EdtCustomEvtGrp.ButtonClick&&e.M_EdtCustomEvtGrp.ButtonClick(i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupChoiceHandler=void 0;const r=n(220),i=n(3),l=n(226),s=n(1109),o=n(36);t.GroupChoiceHandler=class{OnMouseClick(e,t){if(null!=e&&null!=t){const n=e.M_EleEvtModel.EleClickedWrap;this._docEditableCanvas=e,this._nowXGroupEle=t;const r=n.ClickPosYDiff;r>0&&r<n.EleFocused.Bounds.Height&&this.RadioEleClick()}}RadioEleClick(){this._nowXGroupEle.Checked?this._nowXGroupEle.Checked=!1:this._nowXGroupEle.Checked=!0;if(null!=this._nowXGroupEle.Parent){const e=new i.List;this._nowXGroupEle.OwnerDocPanel.GetChildrenByGrpID(this._nowXGroupEle.GrpID,!0,e);let t="";this._nowXGroupEle instanceof l.XRadioBoxEle&&(t=this.GetSelectedRadioEleId(e));const n=new s.XChoiceEleUndo(this._nowXGroupEle,e,!this._nowXGroupEle.Checked,t);let r=this._docEditableCanvas.M_EleEvtModel.EleClickedWrap,a=r.EleFocused;if(null==n.CursorUndoEle&&(n.CursorUndoEle=a),null==n.CursorRedoEle&&(n.CursorRedoEle=r.EleFocused),this._docEditableCanvas.M_UndoMgr.AddItem(n),this._nowXGroupEle instanceof l.XRadioBoxEle&&this.RadioEle_ChildClick(e),this._nowXGroupEle.QuoteSource&&!o.StringUtils.IsNullOrEmpty(this._nowXGroupEle.LackEllipsisvalue)&&!o.StringUtils.IsNullOrEmpty(this._nowXGroupEle.CptID)){let t=this._nowXGroupEle.Document.AssistFunc.XDocXInputCache.BodyParTakeQuoteXChoiceCache;for(let n of e)for(let e of t)e.Equals(n)||n.LackEllipsisvalue!=e.LackEllipsisvalue||n.CptID!=e.CptID||n.CheckedValue!=e.CheckedValue||(e.Checked=n.Checked)}this._docEditableCanvas.MRefreshDocView()}}GetSelectedRadioEleId(e){if(null==e)return"";for(let t=0;t<e.Count();t++){let n=e.Get(t);if(!n.Equals(this._nowXGroupEle)&&null!=n&&n instanceof r.XBaseChoiceEle&&n.Checked)return n.XID}return""}RadioEle_ChildClick(e){if(this._nowXGroupEle.Checked&&e.Count()>0)for(let t=0;t<e.Count();t++){let n=e.Get(t);n.Equals(this._nowXGroupEle)||null!=n&&n instanceof r.XBaseChoiceEle&&(n.Checked=!1)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XChoiceEleUndo=void 0;const r=n(220),i=n(226),l=n(23);class s extends l.IXUndoable{constructor(e,t,n,r){super(),this._nowChoiceEle=e,this._brotherChoiceEles=t,e instanceof i.XRadioBoxEle&&(this._isSingleChoiceEle=!0),this._newValue=e.Checked,this._oldValue=n,this._lastSelectedEleId=r}IsValid(){return this.CanUndo()&&this.CanRedo()}CanUndo(){return null!=this._nowChoiceEle}CanRedo(){return null!=this._nowChoiceEle}Undo(){if(this._isSingleChoiceEle){if(this._nowChoiceEle.Checked=this._oldValue,null!=this._brotherChoiceEles)for(let e=0;e<this._brotherChoiceEles.Count();e++){let t,n=this._brotherChoiceEles.Get(e);n instanceof r.XBaseChoiceEle&&(t=n),null!=t&&(t.Equals(this._nowChoiceEle)||(this._lastSelectedEleId==n.XID?t.Checked=!this._oldValue:t.Checked=!1))}}else this._nowChoiceEle.Checked=this._oldValue}Redo(){if(this._isSingleChoiceEle){if(this._nowChoiceEle.Checked=this._newValue,null!=this._brotherChoiceEles)for(let e=0;e<this._brotherChoiceEles.Count();e++){let t,n=this._brotherChoiceEles.Get(e);n instanceof r.XBaseChoiceEle&&(t=n),null!=t&&(t.Equals(this._nowChoiceEle)||(this._lastSelectedEleId==n.XID?t.Checked=!this._newValue:t.Checked=!1))}}else this._nowChoiceEle.Checked=this._newValue}Clear(){this._nowChoiceEle=null,this._brotherChoiceEles=null,this._lastSelectedEleId=""}}t.XChoiceEleUndo=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EleResizeUndo=void 0;const r=n(23),i=n(25);class l extends r.IXUndoable{constructor(e){super(),this.relEle=null,this.relEle=e,null!=e&&(this.oldSize=new i.SizeF(e.Width,e.Height))}ReadNewSize(){null!=this.relEle&&(this.newSize=new i.SizeF(this.relEle.Width,this.relEle.Height))}IsValid(){return null!=this.relEle}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){this.CanUndo()&&this.relEle.SetSizeDPI(this.oldSize.Width,this.oldSize.Height,300)}Redo(){this.CanRedo()&&this.relEle.SetSizeDPI(this.newSize.Width,this.newSize.Height,300)}Clear(){this.relEle=null,this.oldSize=i.SizeF.Empty,this.newSize=i.SizeF.Empty}}t.EleResizeUndo=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImgEditor=void 0;const r=n(0),i=n(75),l=n(366),s=n(180),o=n(1112),a=n(2),u=n(13);t.ImgEditor=class{constructor(e){this.imgEle=null,this.isOK=!1,this.TeechImgEnum=s.default.TeechImg,this._docEdit=e}PopEditor(e){this._Clear();let t,n=e instanceof r.XImageEle?e:null,s=this;if(null==n)t=!1;else{if(null!=n.ContentReadOnly){let e=n.Parent;if(null==e)return t=!1,t;if(!e.UserEditable)return t=!1,t}if(n.UserEditable){if(this.imgEle=n,null==this.imgEle.ImgObj)t=!1;else{if(this.imgEle.ImageType==i.ImageType.NormalImage){let e=n.GetBoundsDPI(96);new o.ImageEditorDialog({width:480,height:280,IsImgBase64:this.imgEle.ImgInfo.IsImgBase64,baseUrl:this.imgEle.ImgInfo.ImgBase64,imgWidth:e.Width,imgHeight:e.Height,onOk:function(t){s.OnOK_TeechEdtForm(t,s.imgEle.DataString,e.Width,e.Height)},onPostMessage:function(t){s._docEdit.M_EdtCustomEvtGrp.UpdateImageUrl(t,(function(t){let n=t.IsImgBase64,r=t.url;s.newIsImgBase64=n,s.OnOK_TeechEdtForm(r,s.imgEle.DataString,e.Width,e.Height)}))}})}else if(this.imgEle.ImageType==i.ImageType.TeechBitmap||"TeechBitmap"==this.imgEle.ImageType)if(1==this.TeechImgEnum&&this.imgEle.UseEditorTeeth){let e=this.imgEle.DataString;new l.ToothPositionDialog({width:800,height:550,DataString:e,onOk:function(e,t){s.OnOK_TeechEdtForm(e,t)}})}else{this._docEdit.M_GetActionByName("UpdateTeeth").setInstance(this);let e=this.imgEle.DataString;this._docEdit.M_EdtCustomEvtGrp.UpdateTeeth&&this._docEdit.M_EdtCustomEvtGrp.UpdateTeeth(e)}else if(this.imgEle.ImageType==i.ImageType.SyncImage&&0==this.TeechImgEnum){let e={conceptId:this.imgEle.CptID};this._docEdit.M_EdtCustomEvtGrp.UpdateSyncImage&&this._docEdit.M_EdtCustomEvtGrp.UpdateSyncImage(e)}t=this.isOK}}else t=!1}return t}OnOK_TeechEdtForm(e,t,n,i){let l=this._docEdit,s=l.M_EleEvtModel,o=this.imgEle;const h=s.AddEdtHistAct,d=l.M_EdtCustomEvtGrp.AppKeepTrace;let c=new u.UndoGroup,p=o;const f=p.Parent,g=f.GetChildInx(p);if(null!=o.Parent&&d){o=null;let e=r.XElementFactory.CreatXElement("XImage");e.CopyFrom(p,!1,!0,!0),e instanceof r.XImageEle&&e.setImgObj(p.ImgInfo.ImgBase64,p.ImgInfo.IsImgBase64),f.AddChildEle(g,e),p.CptID=null,p.XID=p._BuildNewXID(),p.GrpID=p._BuildGrpID(null),s.EleClickedWrap.LineEleIxFocused.ReplaceEle(p),null!=h&&h.Execute3(a.ENumEdtType.Delete,c,[p]),this.imgEle=e}null!=h&&d&&h.Execute3(a.ENumEdtType.Add,c,[o]),this._OnEdtDone(e,t,n,i),this.isOK=!0}_OnEdtDone(e,t,n,i){if(null!=this.imgEle){let l=this,s=new r.XImageEle;null!=this.newIsImgBase64&&(this.imgEle.ImgInfo.IsImgBase64=this.newIsImgBase64),s.setImgObj(e,this.imgEle.ImgInfo.IsImgBase64);let o=new Image;o.src=e,o.onload=function(){let a=s;a.ImageEle=o;let u=l.imgEle;if(u.DataString=t,u instanceof r.XImageEle){l.imgEle.ImgInfo.IsImgBase64||(u.ImgInfo.ImgBase64=e),u.ImgObj=a.imgObj,n&&(s.ImgObj.Width=n),i&&(s.ImgObj.Height=i);let t=l._docEdit.M_EleEvtModel;u.InitSizeByImgObj(t.EleClicked),u.setImgObj(e,l.imgEle.ImgInfo.IsImgBase64)}l._docEdit.MRefreshDocView()}}}_Clear(){this.imgEle=null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageEditorDialog=void 0;const r=n(27),i=n(1113);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.ImageEditorComp(t,this.InitProps)}DefaultProps(){return{}}}t.ImageEditorDialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageEditorComp=t.ImageEditor=void 0;const r=n(12),i=n(24);n(1114);const l=n(52),s=n(22),o=n(1116);class a extends r.Component{constructor(e){super(e),this.canvas=r.createRef(),this.toolbar=r.createRef(),this.kssTextLayer=r.createRef(),this.baseUrl=this.props.baseUrl,this.imgWidth=this.props.imgWidth,this.imgHeight=this.props.imgHeight,this.IsImgBase64=this.props.IsImgBase64,this.state={}}okHandler(){let e=this.kssinstance.rectangleCanvas.getContext("2d");if(this.kssinstance.snapshootList.length>1){e.drawImage(this.kssinstance.rectangleCanvas,0,0,this.imgWidth,this.imgHeight,0,0,this.imgWidth,this.imgHeight);let t=this.kssinstance.rectangleCanvas.toDataURL("image/jpg");this.IsImgBase64?(this.props.onOk(t),this.kssinstance.endAndClear()):(this.props.onPostMessage(t),this.kssinstance.endAndClear())}else this.kssinstance.endAndClear()}cancel(){this.kssinstance.endAndClear()}getBase64Image(e){let t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height);let n=e.src.substring(e.src.lastIndexOf(".")+1).toLowerCase();return n=n||"jpg",t.toDataURL("image/"+n)}componentDidMount(){const e=new Image;e.src=this.baseUrl,e.crossOrigin="Anonymous";let t=this;this.kssTextLayer.current.style.width=this.imgWidth,this.kssTextLayer.current.style.height=this.imgHeight,e.onload=function(){if(t.IsImgBase64)t.kssinstance=new o.default({toolbarWrapper:t.toolbar.current,toolShow:!0,currentImgDom:this,scale:1,IsImgBase64:t.IsImgBase64,width:t.imgWidth,height:t.imgHeight,rectangleCanvas:t.canvas.current,kssTextLayer:t.kssTextLayer.current});else{let e=t.getBase64Image(this),n=new Image;n.src=e,n.onload=function(){t.kssinstance=new o.default({toolbarWrapper:t.toolbar.current,toolShow:!0,currentImgDom:this,scale:1,IsImgBase64:t.IsImgBase64,width:t.imgWidth,height:t.imgHeight,rectangleCanvas:t.canvas.current,kssTextLayer:t.kssTextLayer.current})}}}}render(){return r.createElement(l.Dialog,{className:"pango-editor-imgeditor",onOk:this.okHandler.bind(this),width:this.props.width,height:this.props.height,visible:!0,isDrag:!1,isDestroy:!0,title:"图片编辑",onCancel:this.cancel.bind(this)},r.createElement("div",{className:"pango-editor-imgeditor-imgContent",style:{width:"100%",height:"100%",overflow:"auto"}},r.createElement("div",{style:{width:this.imgWidth+"px",height:this.imgHeight+"px",position:"relative",backgroundColor:"#eee"}},r.createElement("canvas",{id:"kssRectangleCanvas",ref:this.canvas,width:""+this.imgWidth,height:""+this.imgHeight,style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",margin:"auto"}}),r.createElement("div",{ref:this.kssTextLayer,id:"kssTextLayer",style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",margin:"auto"}}))),r.createElement("div",{style:{width:"288px"}},r.createElement("div",{ref:this.toolbar})))}}t.ImageEditor=a;class u extends s.BaseComponent{constructor(e,t){super(e,t)}Render(){i.render(r.createElement(a,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.ImageEditorComp=u},function(e,t,n){var r=n(18),i=n(1115);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".pango-editor-imgeditor .pango-editor-dialog-content  {\r\n    height: 180px;\r\n    margin: 0;\r\n}\r\n\r\n.pango-editor-imgeditor-imgContent::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n.pango-editor-imgeditor-imgContent::-webkit-scrollbar-thumb {\r\n    border-left: 1px solid #ffffff;\r\n    border-right: 2px solid #ffffff;\r\n    border-radius: 4px;\r\n    background: rgba(58, 58, 58, 0.4);\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77),i=n(1117);n(1128);const l=n(1130),s=n(1131);let o=function(){let e;return class{constructor(t){return e||(this.style=null,this.toolbarWrapper=t.toolbarWrapper,this.kssScreenShotWrapper=t.wrapper,this.kssTextLayer=t.kssTextLayer,this.rectangleCanvas=t.rectangleCanvas,this.toolbar=null,this.scale=t.scale,this.isScreenshot=!1,this.snapshootList=[],this.drawingStatus=null,this.currentToolType=null,this.imgBase64=null,this.isEdit=!1,this.startX=this.rectangleCanvas.getClientRects()[0].left,this.startY=this.rectangleCanvas.getClientRects()[0].top,this.width=t.width,this.height=t.height,this.dotSize=6,this.lineSize=2,this.toolShow=t.toolShow,this.toolbarWidth=null,this.toolbarHeight=35,this.toolbarMarginTop=15,this.toolbarColor="#fb3838",this.toolbarLineWidth="[object Object]"===r.typeChecking(t.toolShow)?(n=t.toolShow.drawLine,isNaN(n)||n>10?10:n<1?1:n):10,this.toolmousedown=null,this.toolmousemove=null,this.toolmouseup=null,this.currentImgDom=t.currentImgDom,l.default(this),this.endAndClear=function(){s.default(this),e=null},this.toolbar=i.default(this),e=this);var n}}}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77),i=n(1118),l=n(1120),s=n(1121),o=n(1122),a=n(1123),u=n(1124),h=n(1125),d=[{component:l.default,show:"back",width:30},{component:i.default,show:"arrow",width:30},{component:s.default,show:"drawLine",width:30},{component:o.default,show:"rect",width:30},{component:a.default,show:"ellipse",width:30},{component:u.default,show:"text",width:30}];t.default=function(e){let t=document.createElement("div");return t.id="kssToolbar","[object Object]"!==r.typeChecking(e.toolShow)&&(e.toolShow={}),d.forEach(n=>{!1!==e.toolShow[n.show]&&t.appendChild(n.component(e))}),r.css(t,{lineHeight:e.toolbarHeight+"px",height:e.toolbarHeight+"px",position:"relative"}),t.appendChild(h.default(e)),e.toolbarWrapper.appendChild(t),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1119),i=n(187),l=n(147),s=n(96),o=n(123);t.default=function(e){let t=document.createElement("span");t.id="kssArrowBT",t.className="kssToolbarItemBT",t.title="箭头工具";let n=document.createElement("span");return n.className="emr-icon-arrow",e.arrowBT=t,t.appendChild(n),t.addEventListener("click",(function(){if(e.isEdit=!0,"arrow"===e.currentToolType)return;e.currentToolType="arrow",s.default(t),o.default(e,"canvasLayer"),e.toolmousedown&&(e.rectangleCanvas.removeEventListener("mousedown",e.toolmousedown),e.rectangleCanvas.removeEventListener("mousemove",e.toolmousemove),e.rectangleCanvas.removeEventListener("mouseup",e.toolmouseup)),e.rectangleCanvas.addEventListener("mousedown",a),e.toolmousedown=a;let n=!1;function a(t){if(n=!0,2===t.button)return;e.startX=e.rectangleCanvas.getClientRects()[0].left,e.startY=e.rectangleCanvas.getClientRects()[0].top;let s=t.clientX,o=t.clientY;e.rectangleCanvas.addEventListener("mousemove",u),e.rectangleCanvas.addEventListener("mouseup",h),e.toolmousemove=u,e.toolmouseup=h;let a={distance:null,twoSide:null,bottomSide:null,crossWidth:null};function u(t){if(0==n)return;i.default(e);let l=t.clientX,u=t.clientY;l<e.startX?l=e.startX:l>e.startX+e.width*e.scale&&(l=e.startX+e.width*e.scale),u<e.startY?u=e.startY:u>e.startY+e.height*e.scale&&(u=e.startY+e.height*e.scale),r.default({x:s-e.startX,y:o-e.startY},{x:l-e.startX,y:u-e.startY},a,e)}function h(t){let r=t.clientX,i=t.clientY;if(s===r&&o===i)return e.rectangleCanvas.removeEventListener("mousemove",u),void e.rectangleCanvas.removeEventListener("mouseup",h);e.rectangleCanvas.removeEventListener("mousemove",u),e.rectangleCanvas.removeEventListener("mouseup",h),l.default(e),n=!1}}})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77);t.default=function(e,t,n,i){let l=e.x,s=e.y,o=t.x,a=t.y;r.computed(n,"distance",["twoSide","bottomSide","crossWidth"],[function(e,t,n){e[n]=t/2*1.1<=20?t/2*1.1:20},function(e,t,n){e[n]=t/2*1.1<=20?t/2*1.1*.8:16},function(e,t,n){e[n]=t/2*1.1<=20?t/2*1.1*.4:8}]);let u=Math.sqrt(Math.pow(l-o,2)+Math.pow(s-a,2));n.distance=u;let h,d,c,p,f,g,m,E,C=Math.sqrt(Math.pow(n.twoSide,2)-Math.pow(n.bottomSide/2,2)),A=Math.sqrt(Math.pow(C,2)+Math.pow(n.crossWidth/2,2)),y=180*Math.atan(n.bottomSide/2/C)/Math.PI,I=180*Math.atan(n.crossWidth/2/C)/Math.PI;if(l>o&&s>a||l<o&&s<a){let e=180*Math.atan(Math.abs(l-o)/Math.abs(s-a))/Math.PI,t=Math.cos(2*(I+e)*Math.PI/360)*A,r=Math.sin(2*(I+e)*Math.PI/360)*A,i=1;l<o&&s<a&&(i=-1),h=o+r*i,d=a+t*i;let u=Math.cos(2*(y+e)*Math.PI/360)*n.twoSide;c=o+Math.sin(2*(y+e)*Math.PI/360)*n.twoSide*i,p=a+u*i;let S=Math.cos(2*e*Math.PI/360)*C,_=o+Math.sin(2*e*Math.PI/360)*C*i,w=a+S*i;m=2*_-h,E=2*w-d,f=2*_-c,g=2*w-p}else if(l<o&&s>a||l>o&&s<a){let e=180*Math.atan(Math.abs(s-a)/Math.abs(l-o))/Math.PI,t=Math.cos(2*(I+e)*Math.PI/360)*A,r=Math.sin(2*(I+e)*Math.PI/360)*A,i=1;l<o&&s>a&&(i=-1),h=o+t*i,d=a-r*i,c=o+Math.cos(2*(y+e)*Math.PI/360)*n.twoSide*i,p=a-Math.sin(2*(y+e)*Math.PI/360)*n.twoSide*i;let u=o+Math.cos(2*e*Math.PI/360)*C*i,S=a-Math.sin(2*e*Math.PI/360)*C*i;m=2*u-h,E=2*S-d,f=2*u-c,g=2*S-p}else if(l===o){let e=1;s<a&&(e=-1);let t=o,r=a+C*e;h=t+n.crossWidth/2*e,d=r,c=t+n.bottomSide/2*e,p=r,m=t-n.crossWidth/2*e,E=r,f=t-n.bottomSide/2*e,g=r}else if(s===a){let e=1;l<o&&(e=-1);let t=o+C*e,r=a;h=t,d=r+n.crossWidth/2*e,c=t,p=r+n.bottomSide/2*e,m=t,E=r-n.crossWidth/2*e,f=t,g=r-n.bottomSide/2*e}let S=i.rectangleCanvas.getContext("2d");S.beginPath(),S.lineWidth=1,S.moveTo(l,s),S.lineTo(h,d),S.lineTo(c,p),S.lineTo(o,a),S.lineTo(f,g),S.lineTo(m,E),S.lineTo(l,s),S.fillStyle=i.toolbarColor,S.fill(),S.closePath()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(187),i=n(96),l=n(123);t.default=function(e){let t=document.createElement("span");t.id="kssbackeBT",t.className="kssToolbarItemBT",t.title="后退";let n=document.createElement("span");function s(){e.isEdit=!1,e.currentToolType=null,e.rectangleCanvas.removeEventListener("mousedown",e.toolmousedown),document.removeEventListener("mousemove",e.toolmousemove),document.removeEventListener("mouseup",e.toolmouseup),i.default(null)}return n.className="emr-icon-cancel",e.backBT=t,t.appendChild(n),t.addEventListener("click",(function(){e.snapshootList.length>1?(2===e.snapshootList.length&&(l.default(e,"canvasLayer"),s()),e.snapshootList.pop()):1===e.snapshootList.length&&(l.default(e,"canvasLayer"),s()),e.currentImgDom.src=e.snapshootList[e.snapshootList.length-1],setTimeout((function(){r.default(e)}),0)})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77),i=n(147),l=n(96),s=n(123);t.default=function(e){let t=document.createElement("span");t.id="kssDrawLineBT",t.className="kssToolbarItemBT",t.title="画刷工具";let n=document.createElement("span");return n.className="emr-icon-pen",e.drawLineBT=t,t.appendChild(n),t.addEventListener("click",(function(){e.isEdit=!0;let n=document.getElementById("kssSetLineWidth");function o(t){if(2===t.button)return;e.startX=e.rectangleCanvas.getClientRects()[0].left,e.startY=e.rectangleCanvas.getClientRects()[0].top;let n=e.rectangleCanvas.getContext("2d");function r(t){n.lineWidth=e.toolbarLineWidth,n.lineTo(t.clientX-e.startX,t.clientY-e.startY),n.stroke()}function l(t){n.closePath(),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",l),i.default(e)}n.beginPath(),n.moveTo(t.clientX-e.startX,t.clientY-e.startY),n.strokeStyle=e.toolbarColor,document.addEventListener("mousemove",r),document.addEventListener("mouseup",l),e.toolmousemove=r,e.toolmouseup=l}document.documentElement.clientHeight-e.startY-e.height-e.toolbarMarginTop-e.toolbarHeight<0?r.css(n,{top:"30px"}):r.css(n,{top:"-40px"}),n.style.display="inline-block","drawLine"!==e.currentToolType&&(e.currentToolType="drawLine",l.default(t),s.default(e,"canvasLayer"),e.toolmousedown&&(e.rectangleCanvas.removeEventListener("mousedown",e.toolmousedown),document.removeEventListener("mousemove",e.toolmousemove),document.removeEventListener("mouseup",e.toolmouseup)),e.rectangleCanvas.addEventListener("mousedown",o),e.toolmousedown=o)})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(187),i=n(147),l=n(96),s=n(123);t.default=function(e){let t=document.createElement("span");t.id="kssRectBT",t.className="kssToolbarItemBT",t.title="方形工具";let n=document.createElement("span");return n.className="emr-icon-frame",e.rectBT=t,t.appendChild(n),t.addEventListener("click",(function(){function n(t){if(2===t.button)return;e.startX=e.rectangleCanvas.getClientRects()[0].left,e.startY=e.rectangleCanvas.getClientRects()[0].top;let n=t.clientX-e.startX,l=t.clientY-e.startY;function s(t){r.default(e);let i=e.rectangleCanvas.getContext("2d"),s=t.clientX,o=t.clientY;s<e.startX?s=e.startX:s>e.startX+e.width*e.scale&&(s=e.startX+e.width*e.scale),s-=e.startX,o<e.startY?o=e.startY:o>e.startY+e.height*e.scale&&(o=e.startY+e.height*e.scale),o-=e.startY,i.beginPath(),i.moveTo(Math.min(n,s),Math.min(l,o)),i.lineTo(Math.max(n,s),Math.min(l,o)),i.lineTo(Math.max(n,s),Math.max(l,o)),i.lineTo(Math.min(n,s),Math.max(l,o)),i.lineTo(Math.min(n,s),Math.min(l,o)),i.lineWidth=e.toolbarLineWidth,i.strokeStyle=e.toolbarColor,i.stroke(),i.closePath()}function o(t){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",o),i.default(e)}document.addEventListener("mousemove",s),document.addEventListener("mouseup",o),e.toolmousemove=s,e.toolmouseup=o}e.isEdit=!0,"rect"!==e.currentToolType&&(e.currentToolType="rect",l.default(t),s.default(e,"canvasLayer"),e.toolmousedown&&(e.rectangleCanvas.removeEventListener("mousedown",e.toolmousedown),document.removeEventListener("mousemove",e.toolmousemove),document.removeEventListener("mouseup",e.toolmouseup)),e.rectangleCanvas.addEventListener("mousedown",n),e.toolmousedown=n)})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(187),i=n(147),l=n(96),s=n(123);t.default=function(e){let t=document.createElement("span");t.id="kssArrowBT",t.className="kssToolbarItemBT",t.title="椭圆工具";let n=document.createElement("span");return n.className="emr-icon-circle",e.ellipseBT=t,t.appendChild(n),t.addEventListener("click",(function(){function n(t){if(2===t.button)return;e.startX=e.rectangleCanvas.getClientRects()[0].left,e.startY=e.rectangleCanvas.getClientRects()[0].top;let n=t.clientX-e.startX,l=t.clientY-e.startY;function s(t){r.default(e);let i=e.rectangleCanvas.getContext("2d"),s=t.clientX,o=t.clientY;s<e.startX?s=e.startX:s>e.startX+e.width*e.scale&&(s=e.startX+e.width*e.scale),s-=e.startX,o<e.startY?o=e.startY:o>e.startY+e.height*e.scale&&(o=e.startY+e.height*e.scale),o-=e.startY;let a=(n+s)/2,u=(l+o)/2,h=Math.abs(s-n)/2,d=Math.abs(o-l)/2,c=.5522848,p=h*c,f=d*c;i.beginPath(),i.lineWidth=e.toolbarLineWidth,i.strokeStyle=e.toolbarColor,i.moveTo(a-h,u),i.bezierCurveTo(a-h,u-f,a-p,u-d,a,u-d),i.bezierCurveTo(a+p,u-d,a+h,u-f,a+h,u),i.bezierCurveTo(a+h,u+f,a+p,u+d,a,u+d),i.bezierCurveTo(a-p,u+d,a-h,u+f,a-h,u),i.stroke(),i.closePath()}function o(t){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",o),i.default(e)}document.addEventListener("mousemove",s),document.addEventListener("mouseup",o),e.toolmousemove=s,e.toolmouseup=o}e.isEdit=!0,"ellipse"!==e.currentToolType&&(e.currentToolType="ellipse",l.default(t),s.default(e,"canvasLayer"),e.toolmousedown&&(e.rectangleCanvas.removeEventListener("mousedown",e.toolmousedown),document.removeEventListener("mousemove",e.toolmousemove),document.removeEventListener("mouseup",e.toolmouseup)),e.rectangleCanvas.addEventListener("mousedown",n),e.toolmousedown=n)})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77),i=n(147),l=n(96),s=n(123);t.default=function(e){let t=document.createElement("span");t.id="kssTextBT",t.className="kssToolbarItemBT",t.title="字体工具";let n=document.createElement("span");return n.className="emr-icon-word",e.textBT=t,t.appendChild(n),t.addEventListener("click",(function(){if(e.isEdit=!0,"text"===e.currentToolType)return;e.currentToolType="text",l.default(t),s.default(e,"textLayer"),e.toolmousedown&&(e.rectangleCanvas.removeEventListener("mousedown",e.toolmousedown),document.removeEventListener("mousemove",e.toolmousemove),document.removeEventListener("mouseup",e.toolmouseup));let n=!1;if(!e.textClickEvent){e.textClickEvent=function(t){if(n)return;e.startX=e.rectangleCanvas.getClientRects()[0].left,e.startY=e.rectangleCanvas.getClientRects()[0].top;let l=t.clientX-e.startX,s=t.clientY-e.startY,o=document.createElement("div");o.className="kssTextarea",o.contentEditable=!0,o.tabIndex=-1;let a=0,u=0;e.width*e.scale-l<60?a=60-(e.width*e.scale-l):r.css(o,{"min-width":"60px"});e.height*e.scale-s<36?u=36-(e.height*e.scale-s):r.css(o,{"min-height":"36px"});r.css(o,{position:"absolute",top:s+"px",left:l+"px",fontSize:10*e.toolbarLineWidth/2+"px","max-width":e.width*e.scale-l+"px","max-height":e.height*e.scale-s+"px"}),e.kssTextLayer.appendChild(o),o.addEventListener("focus",(function(){n=!0,r.css(o,{color:e.toolbarColor})})),o.addEventListener("blur",(function(t){if(n=!1,""===o.innerHTML)return void r.remove(o);var h=e.rectangleCanvas.getContext("2d");h.font=10*e.toolbarLineWidth/2+"px 宋体";let d=o.innerHTML.split("<div>"),c=[];d.forEach((t,n)=>{let r=t;n>0&&(r=t.replace("</div>",""));r=r.replace(/&nbsp;|\<br\>/g,"  ");let i=e.width*e.scale-l>60?e.width*e.scale-l:60,s=0,o="";Array.prototype.forEach.call(r,(e,t)=>{s+=h.measureText(e).width,s>=i?(s=h.measureText(e).width,c.push(o),o=e):o+=e}),c.push(o)}),h.fillStyle=e.toolbarColor,c.forEach((t,n)=>{h.fillText(t,l-a,s-u+15+16*n*e.toolbarLineWidth/2)}),i.default(e),r.remove(o)})),setTimeout((function(){o.focus()}),0)}}e.kssTextLayer.removeEventListener("mousedown",e.textClickEvent),e.kssTextLayer.addEventListener("mousedown",e.textClickEvent)})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77),i=n(1126),l=n(1127);t.default=function(e){document.documentElement.clientHeight;let t=document.createElement("div");return t.id="kssToolbarMiddleArea",r.css(t,{position:"absolute",top:"35px",display:"none",left:"0",background:"#303030",zIndex:99}),t.appendChild(l.default(e)),t.appendChild(i.default(e)),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77),i=n(96),l=["#FF5555","#FFCB13","#08C955","#5175F4","#999999","#FFFFFF"];t.default=function(e){let t=document.createElement("span");t.id="kssColorBoard",t.title="颜色板",t.tabIndex=-1,r.css(t,{display:"inline-block"});let n=document.createElement("div");return n.id="kssColorItemWrapper",r.css(n,{height:"20px",padding:"3px"}),l.forEach((function(t,l){let s=document.createElement("span");s.dataset.color=t,s.className="#fb3838"==t?`kssColorItem kss${t} active`:"kssColorItem kss"+t,r.css(s,{background:t,cursor:"pointer",display:"inline-block",width:"18px",height:"18px",margin:"0 2px",borderRadius:"2px",padding:"0"}),s.addEventListener("click",(function(t){let n=t.currentTarget.dataset.color;e.toolbarColor=n,i.activeColorItem(s)})),n.appendChild(s)})),t.appendChild(n),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77),i=n(96);t.default=function(e){let t=document.createElement("span");t.id="kssSetLineWidth",t.tabIndex=-1,r.css(t,{display:"inline-block"});let n=document.createElement("div");return n.id="kssNumInputWrapper",[4,6,8].forEach((function(t,l){let s=document.createElement("span");s.dataset.width=t,s.className=8==t?`kssLineWidthItem kss${t} active`:"kssLineWidthItem kss"+t,r.css(s,{width:2*t+"px",height:2*t+"px",borderRadius:"50%"}),s.addEventListener("click",(function(t){let n=t.currentTarget.dataset.width;e.toolbarLineWidth=n,i.activeSetWidthItem(s)})),n.appendChild(s)})),t.appendChild(n),t}},function(e,t,n){var r=n(18),i=n(1129);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,"#kssToolbar > span {\r\n    display: inline-block;\r\n    padding: 0 10px;\r\n}\r\n\r\n#kssSetLineWidth {\r\n    margin-left: 20px;\r\n}\r\n#kssColorItemWrapper {\r\n    margin-left: 20px;\r\n}\r\n.kssLineWidthItem {\r\n    margin:3px;\r\n    display:inline-block;\r\n    cursor: pointer;\r\n    background-color: rgba(255,255,255,.2);\r\n}\r\n.kssToolbarItemBT {\r\n    font-size: 16px;\r\n}\r\n.kssLineWidthItem.active {\r\n    background-color: #fff;\r\n}\r\n.kssColorItem.active{\r\n    border: 1px solid #fff;\r\n}\r\n.kssToolbarActiveItemBT {\r\n    color: #2D5AFA;\r\n}\r\n",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.rectangleCanvas.width=e.width*e.scale,e.rectangleCanvas.height=e.height*e.scale;let t=e.rectangleCanvas.getContext("2d");t.drawImage(e.currentImgDom,0,0,e.width*e.scale,e.height*e.scale);var n=t.getImageData(0,0,e.width*e.scale,e.height*e.scale);for(let e=0;e<n.data.length;e+=4)0==n.data[e+3]&&(n.data[e]=255,n.data[e+1]=255,n.data[e+2]=255,n.data[e+3]=255);t.putImageData(n,0,0,0,0,e.width*e.scale,e.height*e.scale);let r=e.rectangleCanvas.toDataURL("image/png");e.imgBase64=r,e.snapshootList[0]=r,e.currentImgDom.src=e.imgBase64}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77);t.default=function(e){r.removeClass(document.body,"kssBody"),e.kss&&r.remove(e.kss),e.kssScreenShotWrapper&&r.remove(e.kssScreenShotWrapper),e.style&&r.remove(e.style),e.kss=null,e.rectangleCanvas=null,e.kssTextLayer=null,e.kssScreenShotWrapper=null,e.drawingStatus=null,e.toolbar=null,e.currentToolType=null,e.snapshootList=[],e.isScreenshot=!1,e.isEdit=!1,e.toolmousedown=null,e.toolmousemove=null,e.toolmouseup=null,document.removeEventListener("keydown",e.endScreenShot),setTimeout((function(){document.removeEventListener("contextmenu",e.preventContextMenu)}),0),document.removeEventListener("keydown",e.endScreenShot),document.removeEventListener("mouseup",e.cancelDrawingStatus)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MedExpresEditor=void 0;const r=n(0),i=n(171),l=n(379),s=n(25),o=n(8),a=n(1133),u=n(1134),h=n(1137),d=n(1139),c=n(1141),p=n(1143),f=n(1145),g=n(1147);t.MedExpresEditor=class{constructor(e){this.xdocEditor=null,this.eleClicked=null,this.medExprEle=null,this.medExprUndo=null,this._isShowing=!1,this.isOK=!1,this.xdocEditor=e}get EdtUndoItem(){return this.medExprUndo}PopEditor(e){this._Clear(!0);let t,n=e instanceof r.XMedicalExpressionField?e:null;if(this.eleClicked=n,null==n)t=!1;else{this.medExprEle=n;const e=n.ExpressionStyle,r=n.ExpressionInfo.MedicalValue;switch(this.isOK=!1,e){case"FourValues1":this.MensesFormula2_AlertForm(r),t=!0;case"FourValues2":this.MensesFormula3_AlertForm(r),t=!0;case"ThreeValues":this.MensesFormula4_AlertForm(r),t=!0;case"Pupil":this.Pupil_AlertForm(r),t=!0;case"FetalHeart":this.FetalHeart_AlertForm(r),t=!0;case"LightPositioning":this.LightPosition_AlertForm(r),t=!0;case"PainIndex":this.Rule_AlertForm(r),t=!0;case"PermanentTeethBitmap":t=!0;case"DeciduousTeech":t=!0;default:this.MensesFormula1_AlertForm(r),t=!0}}return t}MensesFormula1_AlertForm(e){this._isShowing||(this._isShowing=!0,new u.FourValuesDialog({initValue:e,onOk:e=>{this.handleMedExpressDialogOk(e)}}))}MensesFormula2_AlertForm(e){this._isShowing||(this._isShowing=!0,new h.FourValues1Dialog({initValue:e,onOk:e=>{this.handleMedExpressDialogOk(e)}}))}MensesFormula3_AlertForm(e){this._isShowing||(this._isShowing=!0,new d.FourValues2Dialog({initValue:e,onOk:e=>{this.handleMedExpressDialogOk(e)}}))}MensesFormula4_AlertForm(e){this._isShowing||(this._isShowing=!0,new c.FourValues3Dialog({initValue:e,onOk:e=>{this.handleMedExpressDialogOk(e)}}))}Pupil_AlertForm(e){this._isShowing||(this._isShowing=!0,new p.PupilDialog({initValue:e,onOk:e=>{this.handleMedExpressDialogOk(e)}}))}LightPosition_AlertForm(e){this._isShowing||(this._isShowing=!0,new f.LightPositionDialog({initValue:e,onOk:e=>{this.handleMedExpressDialogOk(e)}}))}FetalHeart_AlertForm(e){this._isShowing||(this._isShowing=!0,new g.FetalHeartDialog({initValue:e,onOk:e=>{this.handleMedExpressDialogOk(e)}}))}Rule_AlertForm(e){if(!this._isShowing){let t=this.medExprEle.MedExpSettingInfo instanceof i.RulerInfo?this.medExprEle.MedExpSettingInfo:null;null==t&&(t=new i.RulerInfo("Default")),t.RulerNum=o.CNumUtil.TryParseDouble(e,0),this._isShowing=!0}}handleMedExpressDialogOk(e){this._OnEdtDone(e),this.xdocEditor.MRefreshDocView()}_OnEdtDone(e){if(null!=this.medExprEle){let t=this.medExprEle.ExpressionInfo.MedicalValue;this.medExprEle.ExpressionInfo.MedicalValue=e;let n=l.XMedicalExpressionUtil.GetSuitWidth(this.medExprEle.ExpressionStyle,e,this.medExprEle.EleStyle.Font),r=this.medExprEle.GetBoundsDPI(96).Height;n>0&&this.medExprEle.InitDrawSize(new s.SizeF(n,r),null),this.medExprUndo=new a.MedExpressionEditUodo(this.medExprEle,t)}}_Clear(e){this._isShowing=!1,this.medExprEle=null,e&&(this.medExprUndo=null)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MedExpressionEditUodo=void 0;const r=n(23);class i extends r.IXUndoable{constructor(e,t){super(),this._medExpressionEle=e,this._oldExpressionValue=t,this._newExpressionValue=this._medExpressionEle.ExpressionInfo.MedicalValue}IsValid(){return null!=this._medExpressionEle}CanUndo(){return this.IsValid()}CanRedo(){return this.IsValid()}Undo(){this._medExpressionEle.ExpressionInfo.MedicalValue=this._newExpressionValue}Redo(){this._medExpressionEle.ExpressionInfo.MedicalValue=this._oldExpressionValue}Clear(){this._medExpressionEle=null,this._oldExpressionValue="",this._newExpressionValue=""}}t.MedExpressionEditUodo=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FourValuesDialog=void 0;const r=n(27),i=n(1135);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.FourValuesDialogComp(t,this.InitProps)}DefaultProps(){return{}}}t.FourValuesDialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FourValuesDialogComp=t.FourValuesDialog=void 0;const r=n(12);n(113);const i=n(52),l=n(76),s=n(325),o=n(22),a=n(24),u=n(109),h={position:"absolute",top:45,left:195,id:"select1",width:"160",height:"32",labelWidth:"auto",labelText:"经期(天)",labelAlign:"left"},d={position:"absolute",top:200,left:195,id:"select2",width:"160",height:"32",labelWidth:"auto",labelText:"周期(天)",labelAlign:"left"},c={left:30,width:"160",height:"32",labelText:"初潮年龄",labelWidth:"150"},p={width:"160",height:"32",labelText:"末次月经/绝经年龄",labelWidth:"150"};class f extends r.PureComponent{constructor(e){super(e),this.state={SelectFirstMenstruationAge:"",SelectMenstruationCycle:"",SelectCycle:"",SelectEndMenstruationAgeDate:"",isUseFirstAge:!0,isUseEndAge:!0,SelectResult:"",isRender1:!1,isRender2:!1,isRender1Wrap:void 0,calendar1Position:{top:0,left:0},calendar2Position:{top:0,left:0},isCheckFirst:!0,isCheckEnd:!0}}componentDidMount(){if(this.props.parent.React=this,this.props.initValue){let e=this.props.initValue.split(",");this.setState({SelectFirstMenstruationAge:"初潮年龄"==e[0]?"":e[0],SelectMenstruationCycle:"经期"==e[1]?"":e[1],SelectCycle:"周期"==e[2]?"":e[2],SelectEndMenstruationAgeDate:"绝经年龄"==e[3]?"":e[3],isCheckFirst:JSON.parse(e[4]?e[4].toLowerCase():""),isCheckEnd:JSON.parse(e[5]?e[5].toLowerCase():"")})}}handleSelectMenstruationCycle(e){this.setState({SelectMenstruationCycle:e})}handleSelectFirstMenstruationAgeDate(e){this.state.isCheckFirst?this.setState({SelectFirstMenstruationAge:e}):this.setState({SelectFirstMenstruationAge:""})}handleSelectEndMenstruationAgeDate(e){this.state.isCheckEnd?this.setState({SelectEndMenstruationAgeDate:e}):this.setState({SelectEndMenstruationAgeDate:""})}handleSelectCycle(e){this.setState({SelectCycle:e})}handleFirstMenstruationAgeClick(){let e=this.firstMenstruationAgeInputRef.inputRef.current,t=u.DomUtils.GetOffset(e).top+e.offsetHeight+2,n=u.DomUtils.GetOffset(e).left;this.setState({calendar1Position:{top:t,left:n}}),this.setState({isRender1:!this.state.isRender1})}handleEndMenstruationAgeInput(){let e=this.endMenstruationAgeInputRef.inputRef.current;this.setState({calendar2Position:{top:u.DomUtils.GetOffset(e).top+e.offsetHeight+2,left:u.DomUtils.GetOffset(e).left}}),this.setState({isRender2:!this.state.isRender2})}handleOk(e){const{SelectMenstruationCycle:t,SelectEndMenstruationAgeDate:n,SelectFirstMenstruationAge:r,SelectCycle:i,isCheckFirst:l,isCheckEnd:s}=this.state;let o=r+","+t+","+i+","+n+","+l+","+s;this.setState({SelectResult:o}),this.props.onOk(o)}getFirstCheckboxVal(){this.setState({isCheckFirst:!this.state.isCheckFirst},()=>{this.state.isCheckFirst||this.setState({SelectFirstMenstruationAge:""})})}getEndCheckboxVal(){this.setState({isCheckEnd:!this.state.isCheckEnd},()=>{this.state.isCheckEnd||this.setState({SelectEndMenstruationAgeDate:""})})}setFirstInputValue(e){this.setState({SelectFirstMenstruationAge:e})}setEndInputValue(e){this.setState({SelectEndMenstruationAgeDate:e})}renderFirstCalendarInput(){const{SelectFirstMenstruationAge:e,isRender1:t,calendar1Position:n}=this.state;return r.createElement(r.Fragment,null,r.createElement(l.Input,Object.assign({ref:e=>this.firstMenstruationAgeInputRef=e},c,{prefixIcon:"date",value:e,onClick:this.handleFirstMenstruationAgeClick.bind(this)})),t?r.createElement(s.default,{dateFormat:"yyyy-MM-dd",value:"",position:{x:n.left,y:n.top},visible:!0,parent:this,onOk:this.handleSelectFirstMenstruationAgeDate.bind(this)}):null)}renderFirstInput(){return r.createElement(l.Input,Object.assign({ref:e=>this.firstMenstruationAgeInputRef=e},c,{value:this.state.SelectFirstMenstruationAge,onChange:this.setFirstInputValue.bind(this)}))}renderEndCalendarInput(){const{SelectEndMenstruationAgeDate:e,isRender2:t,calendar2Position:n}=this.state;return r.createElement(r.Fragment,null,r.createElement(l.Input,Object.assign({ref:e=>this.endMenstruationAgeInputRef=e},p,{prefixIcon:"date",onClick:this.handleEndMenstruationAgeInput.bind(this),value:e})),t?r.createElement(s.default,{dateFormat:"yyyy-MM-dd",value:"",position:{x:n.left,y:n.top},visible:!0,parent:this,onOk:this.handleSelectEndMenstruationAgeDate.bind(this)}):null)}renderEndInput(){return r.createElement(l.Input,Object.assign({ref:e=>this.endMenstruationAgeInputRef=e},p,{onChange:this.setEndInputValue.bind(this),value:this.state.SelectEndMenstruationAgeDate}))}render(){const{isCheckFirst:e,isCheckEnd:t,SelectMenstruationCycle:n,SelectCycle:s}=this.state;return r.createElement(i.Dialog,{className:"fourValuesDialog",isDrag:!1,title:"月经公式1",isDestroy:!0,visible:!0,width:544,height:327,onOk:this.handleOk.bind(this)},r.createElement("div",{className:"firstMenstruationAge-wrap"},e?this.renderFirstCalendarInput():this.renderFirstInput(),r.createElement("label",{style:{position:"relative",left:"-25px",color:"#2D5AFA",cursor:"pointer"},className:"firstCheckbox",onClick:()=>this.getFirstCheckboxVal()},e?"使用数值":"使用日期")),r.createElement("div",{style:{width:"160px",left:"200px",top:"170px",height:"0px",borderTop:"1px solid #565656"}}),r.createElement(l.Input,Object.assign({},h,{value:n,onChange:this.handleSelectMenstruationCycle.bind(this)})),r.createElement("div",{className:"lastMenstrual-wrap"},t?this.renderEndCalendarInput():this.renderEndInput(),r.createElement("label",{style:{position:"relative",left:"-55px",color:"#2D5AFA",cursor:"pointer"},className:"endCheckbox",onClick:()=>this.getEndCheckboxVal()},t?"使用数值":"使用日期")),r.createElement(l.Input,Object.assign({},d,{value:s,onChange:this.handleSelectCycle.bind(this)})))}}t.FourValuesDialog=f;class g extends o.BaseComponent{constructor(e,t){super(e,t,!0),this.Render()}onOk(e){this.React.handleOk(e)}Render(){a.render(r.createElement(f,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.FourValuesDialogComp=g},function(e,t,n){(t=n(19)(!1)).push([e.i,".fourValuesDialog .pango-editor-dialog-content > div {\r\n    position: absolute;\r\n    width: 122px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    font-size: 16px !important;\r\n}\r\n.fourValuesDialog .pango-editor-input {\r\n    margin: 4px 0;\r\n}\r\n.fourValuesDialog .pango-editor-input-label {\r\n    font-size: 16px;\r\n}\r\n\r\n.fourValuesDialog .firstMenstruationAge-wrap {\r\n    left: 8px;\r\n    top: 120px;\r\n}\r\n\r\n.fourValuesDialog .lastMenstrual-wrap {\r\n    right: 30px;\r\n    top: 120px;\r\n}\r\n.firstMenstruationAge-wrap .win-input--wrap, .lastMenstrual-wrap .win-input--wrap {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n}\r\n\r\n",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FourValues1Dialog=void 0;const r=n(27),i=n(1138);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.FourValues1DialogComp(t,this.InitProps)}DefaultProps(){return{}}}t.FourValues1Dialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FourValues1DialogComp=t.FourValues1Dialog=void 0;const r=n(12);n(113);const i=n(52),l=n(76),s=n(22),o=n(24),a={position:"absolute",top:58,left:36,width:"120",height:"24",labelText:"初潮年龄"},u={position:"absolute",top:58,left:220,width:"120",height:"24",labelText:"经期(天)"},h={position:"absolute",top:128,left:36,width:"120",height:"24",labelText:"末次月经/绝经年龄"},d={position:"absolute",top:128,left:220,width:"120",height:"24",labelText:"周期(天)"};class c extends r.PureComponent{constructor(e){super(e),this.state={FirstMenstruationAge:"",MenstruationCycle:"",EndMenstruationAge:"",Cycle:"",SelectResult:""}}componentDidMount(){if(this.props.parent.React=this,this.props.initValue){let e=this.props.initValue.split(",");this.setState({FirstMenstruationAge:"初潮年龄"==e[0]?"":e[0],MenstruationCycle:"经期"==e[1]?"":e[1],EndMenstruationAge:"绝经年龄"==e[2]?"":e[2],Cycle:"周期"==e[3]?"":e[3]})}}handleFirstMenstruationAge(e){this.setState({FirstMenstruationAge:e})}handleMenstruationCycle(e){this.setState({MenstruationCycle:e})}handleEndMenstruationAge(e){this.setState({EndMenstruationAge:e})}handleCycle(e){this.setState({Cycle:e})}handleOk(e){const{MenstruationCycle:t,EndMenstruationAge:n,FirstMenstruationAge:r,Cycle:i,isCheckFirst:l,isCheckEnd:s}=this.state;let o=r+","+t+","+n+","+i;this.setState({SelectResult:o}),this.props.onOk(o)}render(){const{FirstMenstruationAge:e,MenstruationCycle:t,EndMenstruationAge:n,Cycle:s}=this.state;return r.createElement(i.Dialog,{className:"fourValuesDialog",title:"月经公式2",isDrag:!1,isDestroy:!0,visible:!0,width:380,height:240,onOk:this.handleOk.bind(this)},r.createElement(l.Input,Object.assign({},a,{value:e,onChange:this.handleFirstMenstruationAge.bind(this)})),r.createElement(l.Input,Object.assign({},u,{value:t,onChange:this.handleMenstruationCycle.bind(this)})),r.createElement(l.Input,Object.assign({},h,{value:n,onChange:this.handleEndMenstruationAge.bind(this)})),r.createElement(l.Input,Object.assign({},d,{value:s,onChange:this.handleCycle.bind(this)})))}}t.FourValues1Dialog=c;class p extends s.BaseComponent{constructor(e,t){super(e,t,!0),this.Render()}onOk(e){this.React.handleOk(e)}Render(){o.render(r.createElement(c,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.FourValues1DialogComp=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FourValues2Dialog=void 0;const r=n(27),i=n(1140);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.FourValues2DialogComp(t,this.InitProps)}DefaultProps(){return{}}}t.FourValues2Dialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FourValues2DialogComp=t.FourValues2Dialog=void 0;const r=n(12);n(113);const i=n(52),l=n(76),s=n(22),o=n(24),a={position:"absolute",top:94,left:5,width:"120",height:"24",labelText:"初潮年龄"},u={position:"absolute",top:50,left:130,width:"120",height:"24",labelText:"经期(天)"},h={position:"absolute",top:134,left:130,width:"120",height:"24",labelText:"周期(天)"},d={position:"absolute",top:94,left:254,width:"120",height:"24",labelText:"末次月经/绝经年龄"};class c extends r.PureComponent{constructor(e){super(e),this.state={FirstMenstruationAge:"",MenstruationCycle:"",Cycle:"",EndMenstruationAge:"",SelectResult:""}}componentDidMount(){if(this.props.parent.React=this,this.props.initValue){let e=this.props.initValue.split(",");this.setState({FirstMenstruationAge:"初潮年龄"==e[0]?"":e[0],MenstruationCycle:"经期"==e[1]?"":e[1],EndMenstruationAge:"绝经年龄"==e[2]?"":e[2],Cycle:"周期"==e[3]?"":e[3]})}}handleFirstMenstruationAge(e){this.setState({FirstMenstruationAge:e})}handleMenstruationCycle(e){this.setState({MenstruationCycle:e})}handleCycle(e){this.setState({Cycle:e})}handleEndMenstruationAge(e){this.setState({EndMenstruationAge:e})}handleOk(e){const{MenstruationCycle:t,EndMenstruationAge:n,FirstMenstruationAge:r,Cycle:i,isCheckFirst:l,isCheckEnd:s}=this.state;let o=r+","+t+","+n+","+i;this.setState({SelectResult:o}),this.props.onOk(o)}render(){const{FirstMenstruationAge:e,MenstruationCycle:t,EndMenstruationAge:n,Cycle:s}=this.state;return r.createElement(i.Dialog,{className:"fourValuesDialog",title:"月经公式3",isDrag:!1,isDestroy:!0,visible:!0,width:400,height:240,onOk:this.handleOk.bind(this)},r.createElement(l.Input,Object.assign({},a,{value:e,onChange:this.handleFirstMenstruationAge.bind(this)})),r.createElement(l.Input,Object.assign({},u,{value:t,onChange:this.handleMenstruationCycle.bind(this)})),r.createElement(l.Input,Object.assign({},h,{value:s,onChange:this.handleCycle.bind(this)})),r.createElement(l.Input,Object.assign({},d,{value:n,onChange:this.handleEndMenstruationAge.bind(this)})))}}t.FourValues2Dialog=c;class p extends s.BaseComponent{constructor(e,t){super(e,t,!0),this.Render()}onOk(e){this.React.handleOk(e)}Render(){o.render(r.createElement(c,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.FourValues2DialogComp=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FourValues3Dialog=void 0;const r=n(27),i=n(1142);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.FourValues3DialogComp(t,this.InitProps)}DefaultProps(){return{}}}t.FourValues3Dialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FourValues3DialogComp=t.FourValues3Dialog=void 0;const r=n(12);n(113);const i=n(52),l=n(76),s=n(22),o=n(24),a={position:"absolute",top:94,left:44,width:"120",height:"24",labelText:"初潮年龄"},u={position:"absolute",top:60,left:210,width:"120",height:"24",labelText:"经期(天)"},h={position:"absolute",top:128,left:210,width:"120",height:"24",labelText:"周期(天)"};class d extends r.PureComponent{constructor(e){super(e),this.state={FirstMenstruationAge:"",MenstruationCycle:"",Cycle:"",SelectResult:""}}componentDidMount(){if(this.props.parent.React=this,this.props.initValue){let e=this.props.initValue.split(",");this.setState({FirstMenstruationAge:"初潮年龄"==e[0]?"":e[0],MenstruationCycle:"经期"==e[1]?"":e[1],Cycle:"周期"==e[2]?"":e[2]})}}handleFirstMenstruationAge(e){this.setState({FirstMenstruationAge:e})}handleMenstruationCycle(e){this.setState({MenstruationCycle:e})}handleCycle(e){this.setState({Cycle:e})}handleOk(e){const{MenstruationCycle:t,FirstMenstruationAge:n,Cycle:r}=this.state;let i=n+","+t+","+r;this.setState({SelectResult:i}),this.props.onOk(i)}render(){const{FirstMenstruationAge:e,MenstruationCycle:t,Cycle:n}=this.state;return r.createElement(i.Dialog,{className:"fourValuesDialog",isDrag:!1,title:"月经公式4",isDestroy:!0,visible:!0,width:380,height:240,onOk:this.handleOk.bind(this)},r.createElement(l.Input,Object.assign({},a,{value:e,onChange:this.handleFirstMenstruationAge.bind(this)})),r.createElement(l.Input,Object.assign({},u,{value:t,onChange:this.handleMenstruationCycle.bind(this)})),r.createElement(l.Input,Object.assign({},h,{value:n,onChange:this.handleCycle.bind(this)})))}}t.FourValues3Dialog=d;class c extends s.BaseComponent{constructor(e,t){super(e,t,!0),this.Render()}onOk(e){this.React.handleOk(e)}Render(){o.render(r.createElement(d,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.FourValues3DialogComp=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PupilDialog=void 0;const r=n(27),i=n(1144);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.PupilDialogComp(t,this.InitProps)}DefaultProps(){return{}}}t.PupilDialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PupilDialogComp=t.PupilDialog=void 0;const r=n(12);n(113);const i=n(52),l=n(76),s=n(22),o=n(24);class a extends r.PureComponent{constructor(e){super(e),this.InputDefaultProps={position:"absolute",width:"120",height:"24"},this.state={valueList:[],resultValue:""}}componentDidMount(){if(this.props.parent.React=this,this.props.initValue){let e=this.props.initValue.split(",");this.setState({valueList:e})}}handleOk(e){let t=this.state.valueList.join(",");this.setState({resultValue:t}),this.props.onOk(t)}handleValue(e,t){let n=this.state.valueList;n[t]=e,this.setState({valueList:n})}render(){const{valueList:e}=this.state;let t=[[58,8],[58,276],[100,8],[100,143],[100,276],[142,8],[142,276]];return r.createElement(i.Dialog,{className:"fourValuesDialog",isDrag:!1,title:"瞳孔图",isDestroy:!0,visible:!0,width:410,height:232,onOk:this.handleOk.bind(this)},e.map((n,i)=>r.createElement(l.Input,Object.assign({key:"input_"+i},this.InputDefaultProps,{top:t[i][0],left:t[i][1],value:e[i],onChange:e=>{this.handleValue(e,i)}}))))}}t.PupilDialog=a;class u extends s.BaseComponent{constructor(e,t){super(e,t,!0),this.Render()}onOk(e){this.React.handleOk(e)}Render(){o.render(r.createElement(a,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.PupilDialogComp=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LightPositionDialog=void 0;const r=n(27),i=n(1146);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.LightPositionDialogComp(t,this.InitProps)}DefaultProps(){return{}}}t.LightPositionDialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LightPositionDialogComp=t.LightPositionDialog=void 0;const r=n(12);n(113);const i=n(52),l=n(76),s=n(22),o=n(24);class a extends r.PureComponent{constructor(e){super(e),this.InputDefaultProps={position:"absolute",width:"120",height:"24"},this.state={valueList:[],resultValue:""}}componentDidMount(){if(this.props.parent.React=this,this.props.initValue){let e=this.props.initValue.split(",");this.setState({valueList:e})}}handleOk(e){let t=this.state.valueList.join(",");this.setState({resultValue:t}),this.props.onOk(t)}handleValue(e,t){let n=this.state.valueList;n[t]=e,this.setState({valueList:n})}render(){const{valueList:e}=this.state;let t=[[58,8],[58,143],[58,276],[100,8],[100,143],[100,276],[142,8],[142,143],[142,276]];return r.createElement(i.Dialog,{className:"fourValuesDialog",isDrag:!1,title:"光定位图",isDestroy:!0,visible:!0,width:410,height:232,onOk:this.handleOk.bind(this)},e.map((n,i)=>r.createElement(l.Input,Object.assign({key:"input_"+i},this.InputDefaultProps,{top:t[i][0],left:t[i][1],value:e[i],onChange:e=>{this.handleValue(e,i)}}))))}}t.LightPositionDialog=a;class u extends s.BaseComponent{constructor(e,t){super(e,t,!0),this.Render()}onOk(e){this.React.handleOk(e)}Render(){o.render(r.createElement(a,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.LightPositionDialogComp=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetalHeartDialog=void 0;const r=n(27),i=n(1148);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.FetalHeartDialogComp(t,this.InitProps)}DefaultProps(){return{}}}t.FetalHeartDialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetalHeartDialogComp=t.FetalHeartDialog=void 0;const r=n(12);n(113);const i=n(52),l=n(76),s=n(22),o=n(24);class a extends r.PureComponent{constructor(e){super(e),this.InputDefaultProps={position:"absolute",width:"120",height:"24"},this.state={valueList:[],resultValue:""}}componentDidMount(){if(this.props.parent.React=this,this.props.initValue){let e=this.props.initValue.split(",");this.setState({valueList:e})}}handleOk(e){let t=this.state.valueList.join(",");this.setState({resultValue:t}),this.props.onOk(t)}handleValue(e,t){let n=this.state.valueList;n[t]=e,this.setState({valueList:n})}render(){const{valueList:e}=this.state;let t=[[58,26],[58,180],[100,26],[100,180],[142,26],[142,180]];return r.createElement(i.Dialog,{className:"fourValuesDialog",title:"胎心图",isDestroy:!0,visible:!0,width:330,height:232,isDrag:!1,onOk:this.handleOk.bind(this)},e.map((n,i)=>r.createElement(l.Input,Object.assign({key:"input_"+i},this.InputDefaultProps,{top:t[i][0],left:t[i][1],value:e[i],onChange:(e,t)=>{this.handleValue(e,i)}}))))}}t.FetalHeartDialog=a;class u extends s.BaseComponent{constructor(e,t){super(e,t,!0),this.Render()}onOk(e){this.React.handleOk(e)}Render(){o.render(r.createElement(a,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.FetalHeartDialogComp=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputEditor=void 0;const r=n(0),i=n(186);t.InputEditor=class{constructor(e){this.xdocEdt=null,this.isOK=!1,this.xdocEdt=e,this._inputEventHandler=new i.InputAlertFormEvtHandler(this.xdocEdt)}get EdtUndoItem(){return null}PopEditor(e){let t,n=e instanceof r.XInputEle?e:null;return null==n?t=!1:(this.isOK=!1,this._inputEventHandler.OnMouseDoubleClick(n),this.xdocEdt.M_EleEvtModel.PopCtrl=this._inputEventHandler.InputPopControl,t=this.isOK),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FractionEditor=void 0;const r=n(1151);t.FractionEditor=class{constructor(e){this.isOK=!1,this.fractionForm=new r.FractionForm(e)}PopEditor(e){let t;return this._fractionEle=e,null==this._fractionEle?t=!1:(this.isOK=!1,this.fractionForm.setFractorEle(this._fractionEle),this.fractionForm.Init(this._fractionEle.FractionType),t=this.isOK),!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FractionForm=void 0;const r=n(1152);t.FractionForm=class{constructor(e){this.docEdit=e}Dispose(e){e&&null!=this.components&&this.components.Dispose()}setFractorEle(e){this.fractionEle=e}Init(e){let t=this,n=this.fractionEle.Numerator,i=this.fractionEle.Denominator;new r.FractorDialog({width:500,height:300,FractionType:e,Numerator:n,Denominator:i,onOk:function(e){t.fractionEle.InitFractionEle(e.Numerator,e.Denominator,e.type),t.docEdit.MRefreshDocView()}})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FractorDialog=void 0;const r=n(27),i=n(1153);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.FractorDialogComp(t,this.InitProps)}DefaultProps(){return{}}}t.FractorDialog=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FractorDialogComp=t.FractorDialog=void 0;const r=n(12),i=n(24);n(1154);const l=n(52),s=n(22),o=n(242),a=n(76);class u extends r.Component{constructor(e){super(e),this.fractorDirection=r.createRef(),this.Numerator=r.createRef(),this.Denominator=r.createRef(),this.state={vertClass:!0,hertClass:!1,obliqueClass:!1}}componentDidMount(){this.props.parent.React=this;let{FractionType:e}=this.props;this.initState(e)}fractorTypeSelect(e){switch(e.val){case"1":this.setState({vertClass:!0,hertClass:!1,obliqueClass:!1});break;case"2":this.setState({vertClass:!1,hertClass:!1,obliqueClass:!0});break;case"3":this.setState({vertClass:!1,hertClass:!0,obliqueClass:!1})}}initState(e){1==e?this.setState({vertClass:!0,hertClass:!1,obliqueClass:!1}):2==e?this.setState({vertClass:!1,hertClass:!1,obliqueClass:!0}):3==e&&this.setState({vertClass:!1,hertClass:!0,obliqueClass:!1})}okHandler(){let e=this.Numerator.current.state.value,t=this.Denominator.current.state.value;this.props.onOk({type:this.fractorDirection.current.state.selectedValues[0].val,Denominator:t,Numerator:e})}render(){let{FractionType:e}=this.props,t=[{text:"竖式",val:"1"},{text:"斜式",val:"2"},{text:"横式",val:"3"}],n=[];t.forEach((t,r)=>{t.val!=e||n.push(t)});const i={id:"select1",options:t,isObject:!0,disablePreSelectedValues:!0,singleSelect:!0,displayValue:"text",suffixIcon:"emr-icon-arrow-north",width:150,height:24,selectedValues:n};return r.createElement(l.Dialog,{onOk:this.okHandler.bind(this),visible:!0,isDestroy:!0,title:"分式"},r.createElement("div",{className:"fractor-dialog"},r.createElement(o.default,Object.assign({textWidth:100,onSelectedItem:this.fractorTypeSelect.bind(this),ref:this.fractorDirection,key:"Select1"},i,{top:0,left:0,width:120,label:{text:"分式类型选择"}}))),r.createElement("div",{style:{display:this.state.showVert},className:"fractor-content"},r.createElement(a.Input,{ref:this.Numerator,value:this.props.Numerator,top:0,left:0,width:"120",labelText:""}),r.createElement("div",{className:["fractor-line",this.state.vertClass?"vert":null,this.state.hertClass?"hert":null,this.state.obliqueClass?"oblique":null].join(" ")}),r.createElement(a.Input,{ref:this.Denominator,value:this.props.Denominator,top:this.state.obliqueClass?30:0,left:0,width:"120",labelText:""})))}}t.FractorDialog=u;class h extends s.BaseComponent{constructor(e,t){super(e,t)}Render(){i.render(r.createElement(u,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.FractorDialogComp=h},function(e,t,n){var r=n(18),i=n(1155);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".fractor-dialog {\r\n    margin-bottom: 15px;\r\n}\r\n\r\n.fractor-content {\r\n    text-align: center;\r\n    padding-top: 25px;\r\n}\r\n\r\n.fractor-content .fractor-line.hert {\r\n    border: 1px solid #000;\r\n    width: 20px;\r\n    display: inline-block;\r\n    transform: rotate(100deg);\r\n}\r\n\r\n.fractor-content .fractor-line.vert {\r\n    border: 1px solid #000;\r\n    margin: 5px auto;\r\n    width: 200px;\r\n}\r\n\r\n.fractor-content .fractor-line.oblique {\r\n    border: 1px solid #000;\r\n    margin: 5px -15px;\r\n    width: 50px;\r\n    display: inline-block;\r\n    transform: translate(0px, 20px) rotate(100deg);\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DragXImageLayer=void 0;const r=n(69),i=n(17),l=n(91),s=n(9),o=n(2),a=n(73),u=n(110),h=n(0),d=n(55),c=n(13),p=n(111),f=n(92),g=n(65),m=n(94);class E extends r.AbstractHandlerLayer{constructor(e){super(e),this.wakePosInEle=i.PointF.Empty,this.edt_elerange=null,this.wakeHitAnchor=l.MarkPoint.None,this.origRect=s.RectangleF.Empty,this.rectResizing=s.RectangleF.Empty,this.edt_elerange=new d.EmrEditEleRange,this.edt_elerange.SetEleEvtObjs(this.eleEvtModel,this.xdocEditor.M_EleEvtHandler)}CanWakeBySrc(e,t){return t==o.ENumEvtSrc.MOUSE_DRAG}UnWaken(){this.isWaken=!1}TryWake(e,t,n=!1){let r=!1;if(this.isWaken)r=!0;else{super.TryWake(e,t);let i=null==this.eleEvtModel?null:this.eleEvtModel.EleClicked,s=i;s instanceof h.XImageEle&&s.IsFocused?(this.wakePosInEle.X=e,this.wakePosInEle.Y=t,super.CalcPosInEle(i,!0,this.wakePosInEle),this.wakeHitAnchor=a.ResizeAnchorUtil.Hit_Hot(s,this.wakePosInEle,96),this.isWaken=l.MarkPoint.None==this.wakeHitAnchor,r=!!this.isWaken&&this.isWaken):n?(this.wakePosInEle.X=e,this.wakePosInEle.Y=t,super.CalcPosInEle(i,!0,this.wakePosInEle),this.isWaken=!0,r=!!this.isWaken&&this.isWaken):r=!1}return r}Handle(e,t,n){var r,i;let l=this.eleEvtModel.EleClicked;u.RectFUtil.CopyRectF(this.origRect,this.rectResizing);let s=this.eleEvtModel.EleMOverWrap.EleFocused;this.edt_elerange.HaveCanNotDelELe()&&(this.isWaken=!1,f.MessageBoxComp.Show({title:"提示",content:"存在不可拖拽元素",type:"warning",dom:this.xdocEditor.ContainerDOM})),this.isWaken&&(null===(r=null==s?void 0:s.OwnerDocPanel)||void 0===r?void 0:r.PagePanelTp)==(null===(i=null==l?void 0:l.OwnerDocPanel)||void 0===i?void 0:i.PagePanelTp)&&this.eleEvtModel.MoveCaretByMoveEle(!0,!0)}OnDone(){var e,t;if(this.isWaken){let n=this.eleEvtModel.EleMOverWrap,r=n.EleFocused,i=this.eleEvtModel.EleClicked;const l=n.IsValid();if(r==i||!l||(null===(e=null==r?void 0:r.OwnerDocPanel)||void 0===e?void 0:e.PagePanelTp)!=(null===(t=null==i?void 0:i.OwnerDocPanel)||void 0===t?void 0:t.PagePanelTp))return void(this.isWaken=!1);const s=this.eleEvtModel.WorkMode;if(this.eleEvtModel.SelRange.IsEleInRange(r))return void(this.isWaken=!1);if(!m.EditorWorkModeUtil.ChkAddRuleForWorkMode(r,s,!0))return this.isWaken=!1,void f.MessageBoxComp.Show({title:"提示",content:"当前位置不可插入元素，拖拽失败",type:"warning",dom:this.xdocEditor.ContainerDOM});r instanceof h.XInputBorderEle&&r.IsStartBorder;let o=new c.UndoGroup;this.edt_elerange.SetEleEvtObjs(this.eleEvtModel,this.xdocEditor.M_EleEvtHandler);let a=this.eleEvtModel.SelRange.InfoUtil.GetLineElesInRange(!0,!0,!0),u=g.EmrClipboard.Copy_SelEles(a,!1,!0);this.edt_elerange.DelSelRange(88,o,new p.ResMessage,!1),this.xdocEditor.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(r);let d,E,C=null==u?0:u.Count();if(C<=0)d=null;else{E=u.Get(0),u.RemoveAt(0);let e=C<=1?null:u.ToArray();u.Clear(),d=e}let A,y,I=d,S=E;this.edt_elerange.InsertNewEles(-1,S,I,o,new p.ResMessage,!1,!0),o.CursorRedoEle=i,super.AddUndoItem(o),E instanceof h.XBaseContainer?(A=E.GetFirstChildBaseEle(),y=E._GetLastBaseEle()):(A=E,y=E),null!=I&&I.length>0&&(y=I[I.length-1]instanceof h.XBaseContainer?I[I.length-1]._GetLastBaseEle():I[I.length-1]),this.xdocEditor.MRefreshDocView(),this.eleEvtModel.SelRange.SetFromIx(A);let _=h.XDomUtil.GetNextEle(!0,y);this.eleEvtModel.SelRange.SetToIx(_),this.xdocEditor.M_EleEvtModel.MoveCaretByCursorEle(),this.xdocEditor.MRefreshDocView(),this.isWaken=!1}}_CorrectNetiveDragSize(e){0==e.Width&&(e.Width=10),0==e.Height&&(e.Height=10),(e.Width<=0||e.Height<=0)&&(e.Width<0&&(e.Width=-e.Width,e.X-=e.Width),e.Height<0&&(e.Height=-e.Height,e.Y-=e.Height))}_ConstraintWHRatio(e,t){if(h.XDomUtil.IsFixWHRatioEle(t)){let n=t.Width/t.Height;n>0&&(e.Height=e.Width/n)}}}t.DragXImageLayer=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditorKeyboardEvtHandler=void 0;const r=n(29),i=n(35),l=n(26),s=n(414),o=n(9),a=n(16);t.EditorKeyboardEvtHandler=class{constructor(e){this.logger=s.SimpleLogger.GetInstance(".EditorKeyboardEvtHandler"),this.xdocEditor=null,this.eleEvtModel=null,this.xdocEditor=e,this.eleEvtModel=e.M_EleEvtModel}OnKeyboard_CharPress(e,t=!1){let n=[e,t];return this._Exec_Action("InsertChar",n)}_Exec_Action(e,t){const n=this.eleEvtModel.EleClickedWrap;let r;if(null!=n&&n.IsValid()){let n=this.xdocEditor.M_GetActionByName(e),i=this.eleEvtModel;if(null!=n&&n.IsEnable(!1)){const e=n.Execute(t);e.IsWarnMsg()&&this.logger.Log(e,!1)}else r=!1;let l=o.RectangleF.Empty;this.xdocEditor.MSetScrollToEleRect(i.EleClicked,l)}else r=!1;return r}OnKeyboard_FuncKey(e,t){return this._OnFuncKey_(e,t)}_OnFuncKey_(e,t){let n,i=!0,l=this.xdocEditor.M_GetActionByHotKey(e,t);if(null!=l)if(l.IsEnable(!1)){let i=[];i=e==r.Keys.V&&t==r.Keys.Control?[e,t]:[null];l.Execute(i);n=!0}else n=!0;else{switch(e){case r.Keys.Backspace:this._OnKey_Backspace();break;case r.Keys.Tab:this._Insert_TabSpace();break;default:if(e!=r.Keys.Return)switch(e){case r.Keys.Prior:case r.Keys.Next:break;case r.Keys.End:case r.Keys.Home:case r.Keys.ArrowLeft:case r.Keys.ArrowRight:this._MoveCaret(e,t);break;case r.Keys.ArrowUp:case r.Keys.ArrowDown:let n=!0;this.xdocEditor.M_EdtCustomEvtGrp.beforeArrowKeydown&&(n=this.xdocEditor.M_EdtCustomEvtGrp.beforeArrowKeydown()),!1!==n&&this._MoveCaret(e,t);break;case r.Keys.Insert:this.xdocEditor.M_EdtCaret.ReverseManualInsertMode();break;case r.Keys.Delete:this._Exec_Action("RemoveChar",["127"]);break;default:i=!1}else{let e=!0;"function"==typeof this.xdocEditor.M_EdtCustomEvtGrp.beforeEnterKeydown&&(e=this.xdocEditor.M_EdtCustomEvtGrp.beforeEnterKeydown()),!1!==e&&this._Insert_Return(t)}}n=i}return n}_MoveCaret(e,t){let n=this.eleEvtModel,r=this.eleEvtModel.EleClickedWrap;const i=r.IsValid();if(null!=r&&i){let i=this.xdocEditor.M_GetActionByName("MoveCaret");if(null!=i&&i.IsEnable(!1)){let l=r.EleFocused;if(!i.Execute([e,t]).IsWarnMsg()){this.eleEvtModel.MoveCaretByCursorEle(!0),this.xdocEditor.M_EleEvtHandler.OnCursorChange(l,r.EleFocused);let e=o.RectangleF.Empty;this.xdocEditor.MSetScrollToEleRect(n.EleClicked,e)}}}}_OnKey_Backspace(){let e=this.xdocEditor.M_EleFocused,t=null!=this.xdocEditor.M_EleEvtModel.SelRange&&this.xdocEditor.M_EleEvtModel.SelRange.IsValid(),n=null==e?null:e.OwnerLine;if(!t&&null!=n&&n.IsFirstLineOfParagraph&&n.FirstElement==e){let e=n.RelEleParagraphStyle;if(null!=e&&e.FirstLineIndent>0){let e=[];return e.length=2,e[0]=0,void this._Exec_Action("SetParagraphIndent",e)}}this._Exec_Action("RemoveChar",["8"])}_Insert_TabSpace(){let e=this.xdocEditor.M_EleFocused,t=null==e?null:e.OwnerLine;if(null!=t&&t.IsFirstLineOfParagraph&&t.FirstElement==e){let e=t.RelEleParagraphStyle;if(null!=e){let t=e.FirstLineIndent,n=i.CommDefines.CalcTabSpaceRealWidth(t),r="SetParagraphIndent",l=new Array(2);return l[0]=t+n,void this._Exec_Action(r,l)}}this._Exec_Action("InsertChar",["\t"])}_Insert_Return(e){const t=l.TextDocInitInfo.GetInstance().IsStartUpAllKeyJump,n=this.eleEvtModel.EleClickedWrap;let i=!0;if(null!=n)if(null!=n.EleFocused){const e=a.XDomUtil.GetParentXInput(n.EleFocused,!0);null!=e&&(i=e.IsDisSkip)}else null!=n.ParentXInput&&(i=n.ParentXInput.IsDisSkip);if(t&&!i){if(l.TextDocInitInfo.GetInstance().AllKeyJump_ShortCutKey==r.Keys.Return){r.Keys.Alt==(e&r.Keys.Alt)&&this._Exec_Action("InsertReturn",[])}}else{r.Keys.Control==(e&r.Keys.Control)?this._Exec_Action("InsertPageBreak",[]):this._Exec_Action("InsertReturn",[])}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputKeyboardEvtHandler=void 0;const r=n(186),i=n(16),l=n(29),s=n(330),o=n(88);t.InputKeyboardEvtHandler=class{constructor(e){this._xdocEdt=e,this._inputEventHandler=new r.InputAlertFormEvtHandler(e)}OnKeyDown(e,t){let n;if(e.EleFocused instanceof s.XInputBorderEle&&(n=e.EleFocused),null!=n&&n.IsStartBorder)return!1;const r=i.XDomUtil.GetParentXInput(e.EleFocused,!0);if(e.ParentXInput=r,null==r)return!1;let a=!1,u=!1;if(t==l.Keys.Tab){const e=r instanceof o.XInputEle?r:null;u=this._inputEventHandler.OnTabDown(e)}if(t==l.Keys.Return){let e=!0;if(this._xdocEdt.M_EdtCustomEvtGrp.beforeEnterKeydown&&(e=this._xdocEdt.M_EdtCustomEvtGrp.beforeEnterKeydown()),!1!==e){const e=r instanceof o.XInputEle?r:null;a=this._inputEventHandler.OnEnterDown(e,!1)}}return a&&(this._xdocEdt.M_EleEvtModel.PopCtrl=this._inputEventHandler.InputPopControl),a||u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputEvtHandler=void 0;const r=n(16),i=n(29),l=n(40),s=n(80),o=n(13),a=n(0),u=n(176),h=n(46),d=n(58),c=n(214);t.InputEvtHandler=class{constructor(){this._nowInputEle=null}OnCursorChange(e,t,n){let l=e.M_EleEvtModel.ViewMode.IsCleanViewMode,s=null;r.XDomUtil.IsEleRemoved(t,l)||(s=r.XDomUtil.GetParentXInput(t,!1));let o=r.XDomUtil.GetParentXInput(n,!1);null!=o&&(this._preInnerText=o.InnerValue,o.IsFocusing||(o.IsFocusing=!0,o.EnterFocusText=o.InnerValue)),null!=s&&(s.Equals(o)||(this.SendLostFocusEvent(e,s),s.EnterInputField_DownKey=i.Keys.None,this.ExcInputCheck(e,s,t)))}SendLostFocusEvent(e,t){t.IsFocusing&&(t.IsFocusing=!1)}ExcInputCheck(e,t,n){if(t.InputType==l.EleTypeEnum.DateEle||s.XInputUtil.MacroEle_IsDateOut(t)){new o.UndoGroup}}AppendSpaceChar(e,t){let n=e;for(var r=0;r<t;r++)n+=" ";return n}OnTextChanged(e,t){if(this._nowInputEle=r.XDomUtil.GetParentXInput(t,!1),null!=this._nowInputEle&&null!=t){this._nowInputEle.BindDocEditor(e),this._nowInputEle.TextChanged();this._nowInputEle.NeedSerialized()&&(null!=this._nowInputEle.StartEle&&null!=this._nowInputEle.StartEle.EleStyle&&this._nowInputEle.StartEle.EleStyle.DeleterIndex>-1||this._nowInputEle.DynamicShowHideBackEle());let t=this.GetFirstXStringEle(),n=this.GetLastXStringEle();if(null!=t){let r=u.EmrTooltipManager.Instance;if(this._nowInputEle.CheckError_Type==h.CheckErrorType.None?r.TipInfo.SetTipMsg(null):r.TipInfo.SetTipMsg(this._nowInputEle.ToolTip),null==this._preInnerText&&(this._preInnerText=this.AppendSpaceChar("",this._nowInputEle.MinSpaceNumber)),this._nowInputEle.MinSpaceNumber>0&&this.Check_CanUseBlackSpace(t)){let r=this._nowInputEle.InnerValue,i=this.GetInnerTextLength(r,!1),l=new c.BooleanWrapper(!1),o=e.M_EleEvtModel.EleClicked,a=this.GetInnerTextLength(r,!0);if(i<this._nowInputEle.MinSpaceNumber){let e=this._nowInputEle.MinSpaceNumber-i,t=n.EleStyle;n.ChildCount>0&&(t=n.GetLastChildEle().EleStyle);let r=new d.XBaseEleStyle(!1),l=this._nowInputEle.CreateSpaceEles(e,t,r);n.AddChildrenEle(n.ChildCount,l),s.XInputUtil.GetInstance().SetElesStyle(n.GetChildArr(),r)}else if(i>this._nowInputEle.MinSpaceNumber)if(a>this._nowInputEle.MinSpaceNumber)this.IsHaveEleNotInSpaceEle(t)?this.RemoveEmptyEle(t,o,l):this.RemoveInValidEmptyEle(t,!0,-1,o,l),this.IsHaveEleNotInSpaceEle(n)?this.RemoveEmptyEle(n,o,l):this.RemoveInValidEmptyEle(n,!0,-1,o,l);else{let e=i-this._nowInputEle.MinSpaceNumber;if(0==e)return;e>0&&this.RemoveInValidEmptyEle(t,!1,e,o,l)}if(this.Check_CanReSetFocusEle(l,o)||0==a){e.MRefreshDocView();let t=this.GetLastValidEle(n);this.UpdateMoveCaretEle(t,e)}}this._preInnerText=this._nowInputEle.GetInnerText(!1),this._nowInputEle=null}}}IsHaveEleNotInSpaceEle(e){let t;if(null==e)t=!1;else{let r=e.GetChildArr();if(null==r||0==r.length)t=!1;else{let e=!1,i=r;for(var n=0;n<i.length;n++){let t=i[n];if(null!=t&&" "!=t.ChVal){e=!0;break}}t=e}}return t}Check_CanReSetFocusEle(e,t){let n;if(e.Value)n=!0;else if(null==t)n=!1;else{let e=this._nowInputEle.GetBorderEle(!1);if(t.Equals(e))n=!0;else{let e=this._nowInputEle.GetUnitLabelTextEle();n=t.Equals(e)}}return n}Check_CanUseBlackSpace(e){let t;if(this._nowInputEle.MinSpaceNumber<=0)t=!1;else{let r=e.GetChildArr();if(null==r||0==r.length)t=!1;else{let e=!1,i=r;for(var n=0;n<i.length;n++){let t=i[n],r=t instanceof a.XCharacterEle?t:null;if(null!=r&&" "!=r.ChVal){e=!0;break}}let l=this.GetInnerTextLength(this._preInnerText,!0);t=e||0!=l}}return t}IsChineseChar(e){return!!/[\u4e00-\u9fa5]/.test(e)}GetInnerTextLength(e,t){let n;n=t?e.replace(/\s+/g,""):e;let r=0;for(let e=0;e<n.length;e++){let t=n[e];this.IsChineseChar(t)?r+=2:r++}return r}RemoveEmptyEle(e,t,n){let r=e.GetChildArr();if(null!=r)for(var i=0;i<=r.length-1;i++){let l=r[i],s=l instanceof a.XCharacterEle?l:null;null!=s&&" "==s.ChVal&&(e.RemoveChildByEle(s),s.Equals(t)&&(n.Value=!0))}}RemoveInValidEmptyEle(e,t,n,r,i){let l=e.GetChildArr();if(null!=l){let o=l.length-n;t&&(o=0),o<0&&(o=0);let u=0;for(var s=0;s<=l.length-1;s++)if(u<n){let t=l[s],n=t instanceof a.XCharacterEle?t:null;null!=n&&" "==n.ChVal&&(e.RemoveChildByEle(n),u++,n.Equals(r)&&(i.Value=!0))}}}GetLastValidEle(e){let t,n=e.GetChildArr();if(null==n||0==n.length)t=null;else{let l=null;for(var i=n.length-1;i>=0;i--){let e=n[i];if(null!=e&&" "!=e.ChVal){l=e;break}}null!=l&&(l=r.XDomUtil.GetNextEle(!0,l),null!=l.Parent&&l.Parent instanceof a.XStringEle&&l.Parent.XID!=e.XID&&null!=this._nowInputEle&&(l=this._nowInputEle.GetBorderEle(!1))),null==l&&(l=n[0]),t=l}return t}GetFirstXStringEle(){let e,t=this._nowInputEle.GetChildArr();if(null==t||0==t.length)e=null;else{let r=t;for(var n=0;n<r.length;n++){let t=r[n],i=t instanceof a.XStringEle?t:null;if(null!=i&&!i.IsXInputBkgText){let t=!1;for(let e of i.ChildEleList)-1==e.EleStyle.DeleterIndex&&(t=!0);if(!t)continue;return e=i,e}}e=null}return e}GetLastXStringEle(){let e,t=this._nowInputEle.GetChildArr();if(null==t||0==t.length)e=null;else{let r=t;for(var n=r.length-1;n>=0;n--){let t=r[n],i=t instanceof a.XStringEle?t:null;if(null!=i&&!i.IsXInputBkgText){let t=!1;for(let e of i.ChildEleList)-1==e.EleStyle.DeleterIndex&&(t=!0);if(!t)continue;return e=i,e}}e=null}return e}UpdateMoveCaretEle(e,t){null!=e&&(t.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(e),t.M_EleEvtModel.MoveCaretByCursorEle(!0))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowseMsKBEvtHandler=void 0;const r=n(2),i=n(29),l=n(176),s=n(1161),o=n(1162),a=n(252),u=n(16),h=n(0),d=n(36),c=n(40),p=n(75);t.BrowseMsKBEvtHandler=class{constructor(){this.xdocEditor=null,this.eleEvtModel=null,this.evtLayerMgr=null,this.kbEvtHandler=null}SetEvtSrcCtrl(e){this.xdocEditor=e,this.eleEvtModel=this.xdocEditor.M_EleEvtModel,this.kbEvtHandler=new o.BrowseKeyboardEvtHandler(this.xdocEditor),this.evtLayerMgr=new s.BrowerHandlerLayerMgr(this.xdocEditor)}OnMouseL_Pressed(e){this.xdocEditor.Focus(),this.xdocEditor.M_EleEvtModel.WorkMode==r.ENumWorkMode.PrintPreview&&this.xdocEditor.M_EdtCustomEvtGrp.PrintpreviewClick&&this.xdocEditor.M_EdtCustomEvtGrp.PrintpreviewClick();let t=this.eleEvtModel.EleClicked;this.eleEvtModel.Locate_EleInLine(r.ENumEvtSrc.MOUSE_LPRESS,e,this.eleEvtModel.EleClickedWrap),this.eleEvtModel.ClearSelRange();const n=this.eleEvtModel.SelRangeAct;let i=[null,null];i[0]=this.eleEvtModel.EleClicked;let l=u.XDomUtil.GetParentXInput(i[0],!1);if(null!=l&&l.StartEle!=t&&l instanceof h.XInputEle){let t=u.XDomUtil.GetXTableOfCell(u.XDomUtil.GetParentCell(l));if(t instanceof h.XTextTable&&t.XID==this.xdocEditor.M_EdtCustomEvtGrp.EditablaDiagTableXID){const t=this.eleEvtModel.EleClickedWrap,n=t.EleFocused;this.eleEvtModel.Locate_EleInLine(r.ENumEvtSrc.MOUSE_LPRESS,e,t);const i=t.EleFocused;if(this.CheckPanelClickValid(n,i)){let l=e.getModifierState("Shift");l&&this.eleEvtModel.SelRange.FromLineEleIx.IsValid(),l||i instanceof h.XBaseResizableElement||this.eleEvtModel.ReInitSelRange();let[s,o]=this.CheckFormModeCursorEle(t);if(s){let e=t.GetNextEle(o);this.eleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(e)}const a=this._MGetMouseModKeys(e),u=t.ClickPosInCtrl;this.evtLayerMgr.Handle(r.ENumEvtSrc.MOUSE_LPRESS,a,u.X,u.Y,0,0),this.eleEvtModel.CheckFormModeFocusedEle(n,i)}this.eleEvtModel.MoveCaretByCursorEle(!0),this.xdocEditor.M_EleEvtHandler.OnCursorChange(n,i);this.xdocEditor.Focus()&&(this.xdocEditor.M_EdtCaret._IsFocus=!0)}}n.Execute(i),this.xdocEditor.M_EleEvtHandler.OnCursorChange(t,this.eleEvtModel.EleClicked)}CheckFormModeCursorEle(e){let t=!1,n=!1;if(this.xdocEditor.M_EleEvtModel.WorkMode==r.ENumWorkMode.Form){let r=e.GetNextEle(!1);if(r instanceof h.XInputBorderEle&&!r.IsDrawText&&!r.IsStartBorder)return n=!1,t=!0,[t,n];let i=e.EleFocused;if(i instanceof h.XInputBorderEle&&!i.IsDrawText&&i.IsStartBorder)return n=!0,t=!0,[t,n]}return[t,n]}_MGetMouseModKeys(e){let t=i.Keys.None,n=e.getModifierState("Shift");n&&(t|=i.Keys.Shift);e.getModifierState("Control");n&&(t|=i.Keys.Control);e.getModifierState("Alt");return n&&(t|=i.Keys.Alt),t}CheckPanelClickValid(e,t){if(null==e)return!0;if(null==t)return!1;const n=e.OwnerDocPanel.IsEditable,r=t.OwnerDocPanel.IsEditable,i="XTextBody"==t.OwnerDocPanel.EleTypeName;return!(n&&!r&&!i)||(this.eleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(e),!1)}OnMouse_DblClick(e){if(this.xdocEditor.Focus(),this.xdocEditor.M_EleEvtModel.WorkMode==r.ENumWorkMode.PrintPreview&&this.xdocEditor.M_EdtCustomEvtGrp.PrintpreviewClick&&this.xdocEditor.M_EdtCustomEvtGrp.PrintpreviewClick(),this.eleEvtModel.Locate_EleInLine(r.ENumEvtSrc.MOUSE_DBLCLICK,e,this.eleEvtModel.EleClickedWrap),null!=this.eleEvtModel.EleClicked){let e=this.eleEvtModel.EleClicked,t=u.XDomUtil.GetParentXInput(e);if(e instanceof h.XImageEle&&(e.ImageType==p.ImageType.SyncImage||"SyncImage"==e.ImageType)&&!d.StringUtils.IsNullOrEmpty(e.CptID)||t instanceof h.XInputEle&&t.InputType==c.EleTypeEnum.SignEle){let n;n=d.StringUtils.IsNullOrEmpty(e.CptID)?t:e;let r={cptId:n.CptID,haveValue:n instanceof h.XImageEle?n.HaveValue:n.SignEleHaveValue,XID:n.XID};this.xdocEditor.M_EdtCustomEvtGrp.DoubleClickSyncImg&&this.xdocEditor.M_EdtCustomEvtGrp.DoubleClickSyncImg(r)}else this.eleEvtModel.SelRangeAct.Execute([this.eleEvtModel.EleClicked.Parent])}}OnMouseR_Pressed(e){if(this.xdocEditor.M_EleEvtModel.WorkMode==r.ENumWorkMode.Browse){this.xdocEditor.Focus()&&(this.xdocEditor.M_EdtCaret._IsFocus=!0);const t=this.eleEvtModel.EleClickedWrap;t.EleFocused;this.eleEvtModel.Locate_EleInLine(r.ENumEvtSrc.MOUSE_RPRESS,e,t);t.EleFocused;if(this.xdocEditor.M_EdtCustomEvtGrp.BrowseRClick){let t=this.xdocEditor.M_EleEvtModel.EleClickedWrap.ClickPosInCtrl;this.xdocEditor.M_EdtCustomEvtGrp.BrowseRClick({evt:e,editorLocation:t})}}}OnMouse_Moved(e){const t=this.eleEvtModel.EleMOverWrap;this.eleEvtModel.Locate_EleInLine(r.ENumEvtSrc.MOUSE_MOVE,e,this.eleEvtModel.EleMOverWrap);const n=t.ClickPosInCtrl;this.evtLayerMgr.Handle(r.ENumEvtSrc.MOUSE_MOVE,i.Keys.None,n.X,n.Y,0,0),this.evtLayerMgr.OnDone();if(null!=t.EleFocused){l.EmrTooltipManager.Instance.RefreshTooltip()}}OnMouse_Dragged(e){const t=this.eleEvtModel.EleMOverWrap;this.eleEvtModel.Locate_EleInLine(r.ENumEvtSrc.MOUSE_DRAG,e,t);const n=t.ClickPosInCtrl;let i=new a.ChangeLineSelRangeLayer(this.xdocEditor);i.TryWake(),i.Handle(),this.xdocEditor.MMoveScrollToOutPot(n.Y)}OnKeyboard_FuncKey(e,t){this.kbEvtHandler.OnKeyboard_FuncKey(e,t);return!0}OnKeyboard_CharPress(e,t=!1){this.kbEvtHandler.OnKeyboard_CharPress(e,t);return!0}OnScroll_ValChanged(e,t){t=Math.floor(t);const n=this.xdocEditor.M_EdtCustomEvtGrp;null!=n.OnScrollValChanged&&n.OnScrollValChanged(e,t)}OnMouse_TripleClick(e){}Leave(){}OnMouseL_Released(e){}OnMouseR_Released(e){const t=this.xdocEditor.M_EdtCustomEvtGrp.BrowerAllowedCopy,n=this.xdocEditor.M_EdtCustomEvtGrp.BrowerAllowedRightMenu;if(t||n){const r=this.xdocEditor.M_rightMenu;n&&r.setEditor(this.xdocEditor),this.xdocEditor.M_EdtCustomEvtGrp.BeforeRightMenu&&this.xdocEditor.M_EdtCustomEvtGrp.BeforeRightMenu(),r.CreateRightMenuRenderOnBrower(e,n,t)}}OnMouse_Wheel(e){}OnMouse_Leave(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowerHandlerLayerMgr=void 0;const r=n(404),i=n(405),l=n(406),s=n(407),o=n(408),a=n(409),u=n(3),h=n(410),d=n(411),c=n(412),p=n(252),f=n(413);t.BrowerHandlerLayerMgr=class{constructor(e){this.xdocEditor=null,this.evtLayerList=null,this.xdocPanelEditableLayer=null,this.xdocEditor=e,this._InitLayers(),this.xdocPanelEditableLayer=new a.XDocPanelEditableLayer(this.xdocEditor)}_InitLayers(){this.evtLayerList=new u.List;let e=new s.MarkEleTestLayer(this.xdocEditor);this.evtLayerList.Add(e);let t=new o.PointTestLayer(this.xdocEditor);this.evtLayerList.Add(t);let n=new l.MarkEleClickLayer(this.xdocEditor);this.evtLayerList.Add(n);let a=new i.AutoNearSelRangeLayer(this.xdocEditor);this.evtLayerList.Add(a);let g=new r.AEleSelectBeforeLayout(this.xdocEditor);this.evtLayerList.Add(g);let m=new h.AEleSelectLayer(this.xdocEditor);this.evtLayerList.Add(m);let E=new f.AEleEdtLayer(this.xdocEditor);this.evtLayerList.Add(E);let C=new d.ResizeXTableLayer(this.xdocEditor);this.evtLayerList.Add(C);let A=new c.ResizeAEleLayer(this.xdocEditor);this.evtLayerList.Add(A);let y=new p.ChangeLineSelRangeLayer(this.xdocEditor);this.evtLayerList.Add(y)}OnReload(){}Handle(e,t,n,r,i,l){let s=!1;for(let s=0;s<this.evtLayerList.Count();s++){let o=this.evtLayerList.Get(s);if(o.CanWakeBySrc(t,e)&&o.TryWake(n,r)&&(o.Handle(t,i,l),!o.CanWakeNextLayer()))break}if(this.xdocPanelEditableLayer.CanWakeBySrc(t,e)){this.xdocPanelEditableLayer.TryWake(n,r)?this.xdocPanelEditableLayer.Handle(t,i,l):s=!0}return s}OnDone(){for(let e=0;e<this.evtLayerList.Count();e++){let t=this.evtLayerList.Get(e);t.IsWaken&&t.OnDone()}this.xdocPanelEditableLayer.OnDone()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowseKeyboardEvtHandler=void 0;const r=n(29),i=n(35),l=n(26),s=n(414);t.BrowseKeyboardEvtHandler=class{constructor(e){this.logger=s.SimpleLogger.GetInstance(".EditorKeyboardEvtHandler"),this.xdocEditor=null,this.eleEvtModel=null,this.xdocEditor=e,this.eleEvtModel=e.M_EleEvtModel}OnKeyboard_CharPress(e,t=!1){let n=[e,t];return this._Exec_Action("InsertChar",n),!0}_Exec_Action(e,t){const n=this.eleEvtModel.EleClickedWrap;let r;if(null!=n&&n.IsValid()){let n=this.xdocEditor.M_GetActionByName(e);if(null!=n&&n.IsEnable(!1)){const e=n.Execute(t);e.IsWarnMsg()&&this.logger.Log(e,!1)}else r=!1}else r=!1;return r}OnKeyboard_FuncKey(e,t){return this._OnFuncKey_(e,t)}_OnFuncKey_(e,t){let n,i=!0,l=this.xdocEditor.M_GetActionByHotKey(e,t);if(null!=l)if(this.xdocEditor.M_EdtCustomEvtGrp.BrowerAllowedCopy){if(e==r.Keys.C&&t==r.Keys.Control){l.Execute([null]);n=!0}}else if(l.IsEnable(!1)){l.Execute([null]);n=!0}else n=!0;else{switch(e){case r.Keys.Backspace:this._OnKey_Backspace();break;case r.Keys.Tab:this._Insert_TabSpace();break;default:if(e!=r.Keys.Return)switch(e){case r.Keys.Prior:case r.Keys.Next:break;case r.Keys.End:case r.Keys.Home:case r.Keys.ArrowLeft:case r.Keys.ArrowUp:case r.Keys.ArrowRight:case r.Keys.ArrowDown:this._MoveCaret(e,t);break;case r.Keys.Insert:this.xdocEditor.M_EdtCaret.ReverseManualInsertMode();break;case r.Keys.Delete:this._Exec_Action("RemoveChar",["127"]);break;default:i=!1}else this._Insert_Return(t)}n=i}return n}_MoveCaret(e,t){let n=this.eleEvtModel.EleClickedWrap;if(null!=n&&n.IsValid()){let r=this.xdocEditor.M_GetActionByName("MoveCaret");if(null!=r&&r.IsEnable(!1)){let i=n.EleFocused;r.Execute([e,t]).IsWarnMsg()||(this.eleEvtModel.MoveCaretByCursorEle(!0),this.xdocEditor.M_EleEvtHandler.OnCursorChange(i,n.EleFocused))}}}_OnKey_Backspace(){let e=this.xdocEditor.M_EleFocused,t=null!=this.xdocEditor.M_EleEvtModel.SelRange&&this.xdocEditor.M_EleEvtModel.SelRange.IsValid(),n=null==e?null:e.OwnerLine;if(!t&&null!=n&&n.IsFirstLineOfParagraph&&n.FirstElement==e){let e=n.RelEleParagraphStyle;if(null!=e&&e.FirstLineIndent>0){let e=[];return e.length=2,e[0]=0,void this._Exec_Action("SetParagraphIndent",e)}}this._Exec_Action("RemoveChar",["8"])}_Insert_TabSpace(){let e=this.xdocEditor.M_EleFocused,t=null==e?null:e.OwnerLine;if(null!=t&&t.IsFirstLineOfParagraph&&t.FirstElement==e){let e=t.RelEleParagraphStyle;if(null!=e){let t=e.FirstLineIndent,n=i.CommDefines.CalcTabSpaceRealWidth(t),r="SetParagraphIndent",l=new Array(2);return l[0]=t+n,void this._Exec_Action(r,l)}}this._Exec_Action("InsertChar",["\t"])}_Insert_Return(e){const t=l.TextDocInitInfo.GetInstance().IsStartUpAllKeyJump,n=this.eleEvtModel.EleClickedWrap;let i;if(null!=n.ParentXInput&&(i=n.ParentXInput.IsDisSkip),t&&!i){if(l.TextDocInitInfo.GetInstance().AllKeyJump_ShortCutKey==r.Keys.Return){r.Keys.Control==(e&r.Keys.Control)&&this._Exec_Action("InsertReturn",[])}}else{r.Keys.Control==(e&r.Keys.Control)?this._Exec_Action("InsertPageBreak",[]):this._Exec_Action("InsertReturn",[])}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowseEleEvtHandler=void 0;const r=n(415);t.BrowseEleEvtHandler=class{constructor(e){this.xdocEditor=null,this.edtCustomEvtGrp=null,this.xdocEditor=e,this.edtCustomEvtGrp=this.xdocEditor.M_EdtCustomEvtGrp,this._EditorEleEvtHandler=new r.EditorEleEvtHandler(e)}OnXDocLoaded(e,t){null!=this.edtCustomEvtGrp.OnXDocLoaded&&this.edtCustomEvtGrp.OnXDocLoaded(e,t),this.xdocEditor.DefaultSetting.IsShowRule&&this.xdocEditor.M_emrDocView.RefreshRuler()}OnCursorChange(e,t){this._EditorEleEvtHandler.OnCursorChange(e,t)}OnSelRangeChanged(e){this._EditorEleEvtHandler.OnSelRangeChanged(e)}OnTextChanged(e){}OnEleStyleChanged(e,t){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusBar=void 0;const r=n(1165),i=n(27);class l extends i.BaseControl{constructor(e,t){super(e,t),this.Component=new r.StatusBarComp(e,this.InitProps)}set Current(e){this.current=e,this.Component.React.setCurrent(this.current)}set Total(e){this.total=e,this.Component.React.setTotal(this.total)}set Zoom(e){this.zoom=e,this.Component.React.setZoom(this.zoom)}set WorkMode(e){this.workmode=e,this.Component.React.setWorkMode(this.workmode)}DefaultProps(){return{current:1,total:1,zoom:1}}}t.StatusBar=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusBarComp=void 0,n(1166);const r=n(12),i=n(24),l=n(22),s=n(263),o=n(2);class a extends r.PureComponent{constructor(e){super(e),this.state={current:e.current,total:e.total,zoom:e.zoom,workMode:e.workMode}}componentDidMount(){this.props.parent.React=this}setCurrent(e){this.setState({current:e})}setTotal(e){this.setState({total:e})}setZoom(e){this.setState({zoom:e})}setWorkMode(e){this.setState({workMode:e})}getWorkMode(){let e="";switch(this.state.workMode){case o.ENumWorkMode.Design:e="设计态";break;case o.ENumWorkMode.KeepTrace:e="修订态";break;case o.ENumWorkMode.App:e="应用态";break;case o.ENumWorkMode.Form:e="表单态";break;case o.ENumWorkMode.Browse:e="浏览态";break;case o.ENumWorkMode.PrintPreview:e="打印预览"}return e}render(){let e=null==this.props.showWorkMode||this.props.showWorkMode,t=null==this.props.showZoom||this.props.showZoom;return r.createElement(r.Fragment,null,r.createElement("div",{className:"statusBar-left"},r.createElement(u,{current:this.state.current,total:this.state.total})),e?r.createElement("div",{className:"statusBar-center"},this.getWorkMode()):null,t?r.createElement("div",{className:"statusBar-right"},r.createElement(h,{Parent:this,zoom:this.state.zoom,onZoomChange:this.props.onZoomChange})):null)}}class u extends r.Component{constructor(e){super(e)}render(){return r.createElement("span",{className:"statusBar-pageInfo"},"第",this.props.current,"页，共",this.props.total,"页")}}class h extends r.Component{constructor(e){super(e),this.restore=()=>{this.props.Parent.setZoom(1),1!=this.state.zoomValue&&(this.setState({zoomValue:1}),this.props.onZoomChange&&this.props.onZoomChange(1))},this.state={zoomValue:e.zoom}}componentWillReceiveProps(e){this.setState({zoomValue:e.zoom})}zoom(e){let t=new s.Big(this.state.zoomValue);t=e?1.1==t?1.25:1.25==t?1.35:parseFloat(t.add(.1).toFixed(1)):1.5==t?1.35:1.35==t?1.25:1.25==t?1.1:parseFloat(t.minus(.1).toFixed(1)),t<.5&&(t=.5),t>3&&(t=3),this.setState({zoomValue:t}),this.props.Parent.setZoom(t),this.props.onZoomChange&&this.state.zoomValue!=t&&this.props.onZoomChange(t)}render(){return r.createElement("div",{className:"zoom"},r.createElement("span",{className:"zoom-in emr-icon-zoomin",onClick:()=>this.zoom(!1)}),r.createElement("span",{className:"zoom-value",title:"还原",onClick:this.restore},parseInt(100*this.state.zoomValue+""),"%"),r.createElement("span",{className:"zoom-out emr-icon-zoomout",onClick:()=>this.zoom(!0)}))}}class d extends l.BaseComponent{constructor(e,t){super(e,t)}Render(){i.render(r.createElement(a,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.StatusBarComp=d},function(e,t,n){var r=n(18),i=n(1167);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".pango-editor-statusBar {\r\n    height: 32px;\r\n    box-shadow: inset 0 1px 0 0 #C8D0D8;\r\n    background: linear-gradient(180deg, #EEF0F2 1%, #D8DADC 100%);\r\n    overflow: hidden;\r\n    display: flex;\r\n    justify-content:space-between;\r\n    user-select:none;\r\n}\r\n.statusBar-left {\r\n    margin-left: 16px;\r\n    display: flex;\r\n}\r\n.statusBar-right {\r\n    margin-right: 16px;\r\n    display: flex;\r\n}\r\n.statusBar-center {\r\n    font-size: 14px;\r\n    line-height: 32px;\r\n}\r\n.statusBar-pageInfo {\r\n    display: inline-block;\r\n    line-height: 32px;\r\n    font-size: 14px;\r\n}\r\n.zoom {\r\n    display: inline-block;\r\n    height: 32px;\r\n    line-height: 32px;\r\n    font-size: 14px;\r\n}\r\n.zoom .zoom-in,.zoom .zoom-out {\r\n    display: inline-block;\r\n    width: 24px;\r\n    height: 24px;\r\n    line-height: 24px;\r\n    font-size: 14px;\r\n    text-align: center;\r\n    cursor: default;\r\n}\r\n.zoom .zoom-in:hover,.zoom .zoom-out:hover {\r\n    background-color: #cccccc;\r\n}\r\n\r\n.zoom .zoom-value {\r\n    display: inline-block;\r\n    width: 60px;\r\n    text-align: center;\r\n    cursor: pointer;\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToolBarStyle=void 0;const r=n(121);t.ToolBarStyle=class{get FontStyle(){return this._fontStyle}set FontStyle(e){this._fontStyle=e}get HAlign(){return this._hAlign}set HAlign(e){this._hAlign=e}get SupSubValue(){return this._supSubValue}set SupSubValue(e){this._supSubValue=e}get FontColor(){return this._fontColor}set FontColor(e){this._fontColor=e}get FontBgColor(){return this._fontBgColor}set FontBgColor(e){this._fontBgColor=e}ToolBarStyle(){this._hAlign=null,this._supSubValue="None",this._fontStyle=new r.FontInfo,this._fontStyle.InitFontInfo()}Intersect(e){this.HAlign=this.HAlign==e.HAlign?this.HAlign:"",this.SupSubValue=this.SupSubValue===e.SupSubValue?this.SupSubValue:"",this.FontStyle.Intersect(e.FontStyle)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionHandler=void 0;const r=n(0),i=n(6),l=n(9),s=n(26),o=n(37);t.ActionHandler=class{constructor(e){this._docEditableCanvas=e}setCanvas(e){this._docEditableCanvas=e}L_ExecuteCommand(e,t){o.TextDocApiConst.IsWriteLog=!0;let n=this._docEditableCanvas.M_GetActionByName(e),r=null;if(null!=n){let i=this._docEditableCanvas.unfocus;r=n.Execute(t),this.AfterExecuteCommand(e),this._docEditableCanvas.unfocus||this.M_SetFocus(!1),this._docEditableCanvas.unfocus=i,o.TextDocApiConst.IsWriteLog=!1}return r}AfterExecuteCommand(e){"FileSave"==e&&s.TextDocInitInfo.GetInstance().InputFiled_IsShowTag&&this._docEditableCanvas.Invalidate()}M_SetFocus(e=!1){if(!(this._docEditableCanvas.M_XDocsUtil.MGet_DocumentsCnt()<=0)){if(e&&this._docEditableCanvas.M_EdtCaret.DestroyXCaret(),this._docEditableCanvas.Focus(),null!=this._docEditableCanvas.FocusManager&&null!=this._docEditableCanvas.FocusManager.ActiveFocus&&(this._docEditableCanvas.FocusManager.ActiveFocus.IsFocus=!1,this._docEditableCanvas.FocusManager.ActiveFocus=null),null==this._docEditableCanvas.M_EleEvtModel.EleClicked)this.M_SetCursorFirstChild();else{if(this._docEditableCanvas.M_EleEvtModel.EleClicked.IsRemoved)return;this._docEditableCanvas.M_EleEvtModel.MoveCaretByCursorEle(!1)}this.SetCursorEleVisible(),this._docEditableCanvas.Invalidate()}}M_SetCursorFirstChild(){let e=this.GetDocFirstBaseChild(this.GetDocument(!0));null!=e&&(this._docEditableCanvas.M_EleEvtModel.EleClickedWrap.LineEleIxFocused.SetEle(e),this._docEditableCanvas.M_EleEvtModel.MoveCaretByCursorEle(!0))}SetCursorEleVisible(){this._docEditableCanvas.MGetZoomRatio();let e=this._docEditableCanvas.M_EleEvtModel.EleClicked,t=l.RectangleF.Empty;this._docEditableCanvas.MSetScrollToEleRect(e,t)}GetDocument(e=!0){let t=this._docEditableCanvas.M_EleEvtModel.EleClicked;return null!=t?t.Document:e?this._docEditableCanvas.M_DocumentFirst:null}GetDocFirstBaseChild(e){if(null==e)return null;let t=e.GetPagePanel(i.ENumPagePanelTp.Body).GetChildArr(),n=this._docEditableCanvas.MShowAsPrint,r=e.GetDocCtxt().ViewMode.IsCleanViewMode;return this.GetValid_CursorEle_ClenViewMode(t,r,n)}GetValid_CursorEle_ClenViewMode(e,t,n){for(let i of e)if(!n&&!t||i.EleStyle.DeleterIndex<=0){if(i instanceof r.XInputBorderEle){if(n)continue;{let e=i instanceof r.XInputBorderEle?i:null;if(!e.IsDrawText){let i=e instanceof r.XBaseElement?e:null,l=r.XDomUtil.GetNextEle(!0,i),s=this.GetValid_CursorEle_ClenViewMode([l],t,n);if(null!=s)return s}}}else if(i instanceof r.XBaseContainer){let e=this.GetValid_CursorEle_ClenViewMode(i.GetChildArr(),t,n);if(null!=e)return e}return i}return null}GetCaretEleStyle(){return this._docEditableCanvas.M_CaretEleStyle}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RightMenuFactory=void 0;const r=n(1171),i=n(1174),l=n(7),s=n(2),o=n(36),a=n(0),u=n(10);class h{constructor(){this.type="normal",this.focusEleArr=[],this._customizeRightMenuArr=[],this._customizeParams={},this.itemName="",this.customizeMenuIx=(new Date).getTime(),this.minRowFixheight=-1}static GetInstance(e){return h._rightMenuFactory=new h,h._rightMenuFactory.init(e),h._rightMenuFactory}get Enabled(){return this.enabled}set Enabled(e){this.enabled=e}get Type(){return this.type}set Type(e){this.type=e}get IsLeafNode(){return this.isLeafNode}set IsLeafNode(e){this.isLeafNode=e}get IsRespondBtnClick(){return this.isRespondBtnClick}set IsRespondBtnClick(e){this.isRespondBtnClick=e}set M_eleFocused(e){this._eleFocused=e}get M_eleFocused(){if(null!=this._eleFocused)return this._eleFocused;if(null!=this.xdocEditor){const e=this.xdocEditor.M_EleEvtModel;if(null!=e){const t=e.EleClickedWrap;if(null!=t)return t.EleFocused}}return null}init(e){this.xdocEditor=e,this.enabled=!0,this.isLeafNode=!1,this.isRespondBtnClick=!0}MenuItemConfig(e,t){this._left=e.clientX,this._top=e.clientY,this.M_eleFocused=t;const n=this.M_eleFocused;if(this.getParentByString(n,"EleTypeName","XTextTable"))this.type="table",this.isLeafNode=!0;else{this.type="normal",this.isLeafNode=!1;switch(null!=n?n.EleTypeName:null){case"XImage":case"XTextLabelElement":case"XBarcodeField":case"XMedicalExpressionField":case"XPageInfo":case"HorizontalLine":case"Shape":case"XButtonEle":this.isLeafNode=!0;break;case"XTextRadioBox":case"XTextCheckBox":case"XLableInputBorder":this.isLeafNode=!0;break;default:this.isLeafNode=this.getParentByString(n,"EleTypeName","XInputField")}}this.focusEleArr=[],this.isLeafNode&&(this.focusEleArr=this.getAllEleAttr(n))}getAllEleAttr(e){let t=e,n=[];for(;null!=t;){const e=t.EleTypeName;e&&-1==this.focusEleArr.indexOf(e)&&n.push(e),t=t.Parent}return n}getParentByString(e,t,n){if(null==e||null==t||null==n)return null;const r=e[t];if(n==r&&r)return!0;if(null!=e.Parent){return this.getParentByString(e.Parent,t,n)}return!1}CloseEventHandler(){this.xdocEditor.M_EleEvtModel.PopCtrl=null}okEventHandler(e,t){let n;switch(e){case"RightProperty":n=[this.M_eleFocused,t];break;case"SetFont":new i.FontDialog({onOk:e=>{let t=this.xdocEditor.M_ActionHandler;for(let n in e){let r;"SetFontBold"==n||"SetFontItalic"==n||"SetTextUnderline"==n?r=[e[n]]:"SetFontName"==n||"SetFontSize"==n?r=[e[n],e[n]]:"SetForeColor"!=n&&"SetBkgColor"!=n||(r=[new l.Color(e[n])]),t.L_ExecuteCommand(n,r)}}},this.xdocEditor,this.M_eleFocused);break;case"CopyInsertTableCol_Left":case"CopyInsertTableCol_Right":case"CopyInsertTableRow_Bottom":case"CopyInsertTableRow_Top":n=e;break;case"TextTableResizeRow":n=Number(t);break;case"Paste":if(window.winning){if(window.winning.getClipboardText){let t=window.winning.getClipboardText();this.xdocEditor.M_EdtCaret.M_caretInput.value=t,this.xdocEditor.M_GetActionByName(e).Execute(n)}else this.xdocEditor.M_EdtCaret.M_caretInput.focus(),window.winning.clipboard.paste();n=!1}else n=!0;break;case"":n=!1;break;default:n=!0}if(n){let t=this.xdocEditor.M_GetActionByName(e);null!=t&&(n instanceof Array||(n=[n]),t.Execute(n))}}setEditor(e){this.xdocEditor=e,this._WorkMode=e.M_EleEvtModel.WorkMode;const t=this._WorkMode==s.ENumWorkMode.App||this._WorkMode==s.ENumWorkMode.Form;t&&(this.isLeafNode=!1),null==this._disCommand&&(this._disCommand=[]);const n=e.M_EdtCustomEvtGrp.customizeRightMenuArr;null!=n&&n.length>0&&this.getRangeCidTOcusArr(n),this.minRowFixheight=-1,this.setCustomizeParams(t)}getRangeCidTOcusArr(e){let t=[...this._customizeRightMenuArr];if(null!=e){const n=this.getCusMenuIdArr();for(let r=0;r<e.length;r++){const i=e[r];if(null!=i.removeMenu&&i.removeMenu instanceof Array&&i.removeMenu.length>0)for(let e=0;e<t.length;e++){const n=t[e];if(null==n)continue;const r=n.menuId;-1!=i.removeMenu.indexOf(r)&&(t[e]=null)}null!=i.disCommand&&i.disCommand instanceof Array&&i.disCommand.length>0&&(this._disCommand=i.disCommand),"normal"==i.itemName?this.itemName="":i.itemName&&(this.itemName=i.itemName);const l=n.indexOf(i.menuId);if(i.menuId&&-1!=l&&t[l]){const e=t[l];for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const n=i[t];e[t]=n}}else if(i.menu){this.customizeMenuIx++,t.push(i);const e=t.length-1;i.menuId?t[e].menuId=i.menuId+"":t[e].menuId=this.customizeMenuIx+""}else if(i.type){this.customizeMenuIx++,t.push(i);const e=t.length-1;i.menuId?t[e].menuId=i.menuId+"":t[e].menuId=this.customizeMenuIx+""}}}let n=[];for(let e=0;e<t.length;e++){const r=t[e];null!=r&&n.push(r)}this._customizeRightMenuArr=[...n],this.xdocEditor.M_EdtCustomEvtGrp.customizeRightMenuArr=[]}getCusMenuIdArr(){let e=[];if(null!=this._customizeRightMenuArr&&this._customizeRightMenuArr.length>0)for(let t=0;t<this._customizeRightMenuArr.length;t++){const n=this._customizeRightMenuArr[t].menuId;e.push(n)}return e}setCustomizeParams(e){const t=this.xdocEditor.M_EleEvtModel,n=this.M_eleFocused;let r=[],i=[],l="";const s=t.SelRange;let h;null!=s&&s.IsValid()?h=s.InfoUtil.GetLineElesInRange(!1,!1):null!=n&&e&&(h=[n]);let d=0,c=[];for(;null!=h&&d<h.length;){const e=h[d];let t=e.CptID;if(o.StringUtils.IsNullOrEmpty(t)||-1==i.indexOf(t)&&i.push(t),l+=e.GetInnerText(!1),0==d&&"XTextLabelElement"!=e.EleTypeName){const t=e.XID;let n=e.OwnerLine;if(null!=n){let e=n.ChildEleList,i=n.ElementCnt-1,l=!1;for(;i>=0;){const s=e.Get(i);if(null!=s&&l&&"XTextLabelElement"==s.EleTypeName){const e=s;r.push({CptID:e.CptID,text:e.Text,inner:[]}),i=-1}else null!=s&&t==s.XID&&(l=!0);0==i&&(n=n.PrevLine,null!=n&&(e=n.ChildEleList,i=n.ElementCnt)),i--}}}else if("XTextLabelElement"==e.EleTypeName){const t=e;r.push({CptID:t.CptID,text:t.Text,inner:[]})}else if("XTextLabelElement"!=e.EleTypeName){const e=r.length-1;e>=0&&t&&-1==r[e].inner.indexOf(t)&&r[e].inner.push(t)}let n=e.Parent;for(;null!=n&&-1==c.indexOf(n.XID);){if(n instanceof a.XTextTableRow){let e=n.FixHeight;e>0&&(this.minRowFixheight<0||e<this.minRowFixheight)&&(e=u.DPITransUtil.TransFloatVal(e,300,96),e=Math.round(100*e)/100,this.minRowFixheight=e)}t=n.CptID,o.StringUtils.IsNullOrEmpty(t)||(-1==i.indexOf(t)&&i.push(t),c.push(n.XID)),n=n.Parent}e instanceof a.XBaseContainer&&(i=this.getAllChildrenCptID(e,i)),d++}let p,f=this.xdocEditor.M_GetActionByName("FavoritesPhrases");null!=f&&(p=f.Execute([])),this._customizeParams={XML:p.ReturnParams,innerText:l,CptIDArr:i,Labels:r}}getAllChildrenCptID(e,t){if(t instanceof Array||(t=[]),null==e)return t;let n=e.CptID;if(o.StringUtils.IsNullOrEmpty(n)||-1==t.indexOf(n)&&t.push(n),!(e instanceof a.XBaseContainer))return t;if(!(e.ChildCount>0))return t;let r=e.ChildEleList.ToArray();for(let e=0;e<r.length;e++){const i=r[e];n=i.CptID,o.StringUtils.IsNullOrEmpty(n)||-1==t.indexOf(n)&&t.push(n),i instanceof a.XBaseContainer&&(t=this.getAllChildrenCptID(i,t))}return t}menuIsShowByscopeCptId(){const e=this.M_eleFocused;for(let t=0;t<this._customizeRightMenuArr.length;t++){const n=this._customizeRightMenuArr[t],r=n.scopeCptId;if(r){const t=this.getParentByString(e,"CptID",r);n.hideByCptId=!t}}}composeDisCommand(){let e=[...this._disCommand];return-1==this._disCommand.indexOf("SaveAsText")&&this._WorkMode==s.ENumWorkMode.Design&&e.push("SaveAsText"),-1!=this._disCommand.indexOf("RightProperty")&&-1!=this._disCommand.indexOf("setAttr")||this.isLeafNode||e.push("setAttr"),-1==this._disCommand.indexOf("table")&&"normal"==this.type&&e.push("table"),e}CreateRightMenuRender(){this.menuIsShowByscopeCptId();const e=this.composeDisCommand();let t=[];t=this.getBrowseMenu(!1),null!=this._Render&&this._Render.Child?this._Render.updateProps({left:this._left,top:this._top,customizeRightMenuArr:t,disCommand:e,customizeParams:this._customizeParams,itemName:this.itemName,minRowFixheight:this.minRowFixheight,attrTypeEle:this.focusEleArr}):this._Render=new r.RightMenuComp({domContent:this.xdocEditor.dom,onClose:this.CloseEventHandler.bind(this),onOk:this.okEventHandler.bind(this),left:this._left,top:this._top,customizeRightMenuArr:t,disCommand:e,customizeParams:this._customizeParams,itemName:this.itemName,minRowFixheight:this.minRowFixheight,attrTypeEle:this.focusEleArr})}CreateRightMenuRenderOnBrower(e,t,n=!1){const i=n?"":"Copy",l=["Cut",i,"Paste","RemoveCharByRight","SetFont","SetParagraphStyle","align","table","insert","copyInsert","RemoveTabByRight","TextTableDeleteRow","TextTableDeleteColumn","TextTableCombineCell","TextTableUncombineCell","tableAlign","RemoveEmptyLines","SaveAsText","setAttr"];this._left=e.clientX,this._top=e.clientY;let s=[];t&&(s=this.getBrowseMenu());(!i||s&&s.length>0)&&(null!=this._Render&&this._Render.Child?this._Render.updateProps({left:this._left,top:this._top,customizeRightMenuArr:s,disCommand:l,customizeParams:this._customizeParams,itemName:this.itemName}):this._Render=new r.RightMenuComp({domContent:this.xdocEditor.dom,onClose:this.CloseEventHandler.bind(this),onOk:this.okEventHandler.bind(this),left:this._left,top:this._top,customizeRightMenuArr:s,disCommand:l,customizeParams:this._customizeParams,itemName:this.itemName}))}getBrowseMenu(e=!0){let t=[];if(e){const e=this.xdocEditor.M_EdtCustomEvtGrp.customizeRightMenuArr;null!=e&&e.length>0&&this.getRangeCidTOcusArr(e)}const n=this._customizeRightMenuArr;if(null!=n&&n.length>0)for(let r=0;r<n.length;r++){const i=n[r];e?"onlyBrowse"!=i.workMode&&"bothEditBrowse"!=i.workMode||t.push(i):"onlyBrowse"!=i.workMode&&t.push(i)}return t}}t.RightMenuFactory=h,h._rightMenuFactory=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RightMenuComp=void 0;const r=n(12),i=n(24),l=n(74);n(1172);const s=n(22),o=n(52);class a extends r.Component{constructor(e){super(e),this.defaultData=[{type:"normal",txt:"剪切",command:"Cut",icon:"emr-icon-cut",Shortcutkey:"Ctrl+X"},{type:"normal",txt:"复制",command:"Copy",icon:"emr-icon-copy",Shortcutkey:"Ctrl+C"},{type:"normal",txt:"粘贴",command:"Paste",icon:"emr-icon-paste",Shortcutkey:"Ctrl+V"},{type:"normal",txt:"删除",command:"RemoveCharByRight",icon:"emr-icon-delete"},{type:"line",txt:"",splitType:"table"},{type:"table",txt:"表格",childType:"tableIn",icon:"emr-icon-insertform"},{type:"line",txt:"",splitType:"paragraph"},{type:"paragraph",txt:"字体与颜色",command:"SetFont",icon:"emr-icon-font"},{type:"paragraph",txt:"段落",command:"SetParagraphStyle",icon:"emr-icon-paragraph"},{type:"paragraph",txt:"段落对齐方式",childType:"align",icon:"emr-icon-alignment"},{type:"line",txt:"",splitType:"auto"},{type:"auto",txt:"自动排版",command:"RemoveEmptyLines",icon:"emr-icon-cleanview"},{type:"line",txt:"",splitType:"save"},{type:"save",txt:"保存为常用语",command:"SaveAsText",icon:"emr-icon-save"},{type:"line",txt:"",splitType:"setAttr"},{type:"setAttr",txt:"属性菜单",childType:"setAttrChild",icon:"emr-icon-property"}],this.childData=[{type:"align",txt:"左对齐",command:"SetAlignLeft",icon:"emr-icon-left"},{type:"align",txt:"居中对齐",command:"SetAlignCenter",icon:"emr-icon-center"},{type:"align",txt:"右对齐",command:"SetAlignRight",icon:"emr-icon-right"},{type:"align",txt:"两端对齐",command:"SetAlignBothEnds",icon:"emr-icon-liangduanduiqi"},{type:"align",txt:"分散对齐",command:"SetAlignScattered",icon:"emr-icon-fensanduiqi"},{type:"tableAlign",txt:"靠上左对齐",command:"SetAlignTopLeft",icon:"emr-icon-kaoshangzuoduiqi"},{type:"tableAlign",txt:"靠上居中对齐",command:"SetAlignTopCenter",icon:"emr-icon-top-center"},{type:"tableAlign",txt:"靠上右对齐",command:"SetAlignTopRight",icon:"emr-icon-top-right"},{type:"tableAlign",txt:"中部左对齐",command:"SetAlignMiddleLeft",icon:"emr-icon-zhongbuzuoduiqi"},{type:"tableAlign",txt:"中部居中对齐",command:"SetAlignMiddleCenter",icon:"emr-icon-center-center"},{type:"tableAlign",txt:"中部右对齐",command:"SetAlignMiddleRight",icon:"emr-icon-center-right"},{type:"tableAlign",txt:"靠下左对齐",command:"SetAlignBottomLeft",icon:"emr-icon-kaoxiazuoduiqi"},{type:"tableAlign",txt:"靠下居中对齐",command:"SetAlignBottomCenter",icon:"emr-icon-bottom-center"},{type:"tableAlign",txt:"靠下右对齐",command:"SetAlignBottomRight",icon:"emr-icon-bottom-right"},{type:"insert",txt:"左侧插入列",command:"TextTableInsertColumn_Left",icon:"emr-icon-insertformleft"},{type:"insert",txt:"右侧插入列",command:"TextTableInsertColumn_Right",icon:"emr-icon-insertformright"},{type:"insert",txt:"上方插入行",command:"TextTableInsertRow_Top",icon:"emr-icon-insertformtop"},{type:"insert",txt:"下方插入行",command:"TextTableInsertRow_Bottom",icon:"emr-icon-insertformbottom"},{type:"copyInsert",txt:"左侧复制插入列",command:"CopyInsertTableCol_Left",icon:"emr-icon-insertformleft"},{type:"copyInsert",txt:"右侧复制插入列",command:"CopyInsertTableCol_Right",icon:"emr-icon-insertformright"},{type:"copyInsert",txt:"上方复制插入行",command:"CopyInsertTableRow_Top",icon:"emr-icon-insertformtop"},{type:"copyInsert",txt:"下方复制插入行",command:"CopyInsertTableRow_Bottom",icon:"emr-icon-insertformbottom"},{type:"SplitCell",txt:"按行拆分",command:"TextTableSplitCellByRow",icon:"emr-icon-splitcells"},{type:"SplitCell",txt:"按列拆分",command:"TextTableSplitCellByCol",icon:"emr-icon-splitcells"},{type:"TableDelete",txt:"删除表格",command:"RemoveTabByRight",icon:"emr-icon-deleteform"},{type:"TableDelete",txt:"删除表格行",command:"TextTableDeleteRow",icon:"emr-icon-deleteformrow"},{type:"TableDelete",txt:"删除表格列",command:"TextTableDeleteColumn",icon:"emr-icon-deleteformcolumn"},{type:"tableIn",txt:"单元格对齐方式",childType:"tableAlign",icon:"emr-icon-alignment"},{type:"tableIn",txt:"拆分单元格",childType:"SplitCell",icon:"emr-icon-splitcells"},{type:"tableIn",txt:"合并单元格",command:"TextTableCombineCell",icon:"emr-icon-mergecells"},{type:"tableIn",txt:"解除单元格合并",command:"TextTableUncombineCell",icon:"emr-icon-splitcells"},{type:"tableIn",txt:"设置表格行高",command:"TextTableResizeRow",icon:"emr-icon-insertform"},{type:"tableIn",txt:"插入",childType:"insert",icon:"emr-icon-insertform"},{type:"tableIn",txt:"复制插入",childType:"copyInsert",icon:"emr-icon-insertform"},{type:"tableIn",txt:"删除",childType:"TableDelete",icon:"emr-icon-deleteform"},{type:"setAttrChild",txt:"横线属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"HorizontalLine"},{type:"setAttrChild",txt:"形状属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"Shape"},{type:"setAttrChild",txt:"按钮属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XButtonEle"},{type:"setAttrChild",txt:"页码属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XPageInfo"},{type:"setAttrChild",txt:"图片属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XImage"},{type:"setAttrChild",txt:"条形/二维码属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XBarcodeField"},{type:"setAttrChild",txt:"标题属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XTextLabelElement"},{type:"setAttrChild",txt:"医学表达式属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XMedicalExpressionField"},{type:"setAttrChild",txt:"复选属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XTextCheckBox"},{type:"setAttrChild",txt:"单选属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XTextRadioBox"},{type:"setAttrChild",txt:"元素属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XInputField"},{type:"setAttrChild",txt:"单元格属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XTextTableCell"},{type:"setAttrChild",txt:"表格属性",command:"RightProperty",icon:"emr-icon-property",eleTypeName:"XTextTable"}],this.list_height=32,this.list_num=0,this.line_num=0,this.updateEvent=e=>{const{left:t,top:n,domContent:r,itemName:i,minRowFixheight:l}=this.state;let s=[];e.left!=t&&s.push({item:"left",value:this.getLeft(e.left)});const o=this.getMenuArr(e);s.push({item:"menuArr",value:o}),s.push({item:"customizeParams",value:e.customizeParams});const a=this.getTop(e,r);a!=n&&s.push({item:"top",value:a});const u=e.itemName;u!=i&&s.push({item:"itemName",value:u});const h=e.minRowFixheight;h!=l&&s.push({item:"minRowFixheight",value:h}),s.length>0&&this.setState((e,t)=>{let n={isShow:!0};return s.forEach(e=>{n[e.item]=e.value}),n})},this.closeEvent=()=>{this.setState({isShow:!1}),"function"==typeof this.props.onClose&&this.props.onClose()},this.clickHandler=this.clickHandler.bind(this);const t=this.getMenuArr(e),n=this.getTop(e);this.state={domContent:this.props.domContent,isShow:!0,inputPopShow:!1,type:e.type,left:this.getLeft(e.left),top:n,menuArr:t,customizeParams:e.customizeParams,itemName:this.props.itemName,minRowFixheight:this.props.minRowFixheight},e.onRef&&e.onRef(this)}render(){return this.state.inputPopShow?this.InputPop():r.createElement(l.default,{className:"right-menu-pop",onClose:this.closeEvent,showOkBtn:!1,showCancelBtn:!1,isShow:this.state.isShow,top:this.state.top,isTopFromProp:!0,left:this.state.left},this.renderLabels())}getLeft(e){return e+10}getTop(e,t){const{domContent:n,top:r}=e;let i=n||t;const l=this.list_num*this.list_height+20+4,s=document.body.clientHeight;if(i&&i.clientHeight>0){let e=32,t=i.clientHeight;t-e>0?t-=e:e=0;const n=r-i.offsetTop,s=Math.max(0,t-n);if(s>=l)return r;if(n-l>=0){let e=r-l-12;return Math.max(0,e)}if(t>=l){const e=Math.abs(s-l);return Math.max(0,r-e)}{const e=Math.abs(s-l);return Math.max(0,r-e)}}{const e=s-30-r;if(e>=l)return r;if(r>=l)return Math.max(0,r-l);if(s>=l){if(e>=r){const t=Math.abs(e-l);return Math.max(0,r-t)}{const e=Math.abs(r-l);return Math.max(0,r-l+e)}}return 0}}getMenuArr(e){const{customizeRightMenuArr:t,disCommand:n,attrTypeEle:r}=e;let i=[],l=[],s=[],o=0,a=0,u=!1;null!=n?(this.defaultData.map((e,t)=>{const r=-1!=n.indexOf(e.type);let i=!1;(e.childType&&-1!=n.indexOf(e.childType)||e.command&&-1!=n.indexOf(e.command))&&(i=!0),r||i||("setAttr"==e.type&&(u=!0),l.push(e),"line"!=e.type&&(a++,-1==s.indexOf(e.type)&&s.push(e.type)))}),this.childData.map((e,t)=>{const r=-1!=n.indexOf(e.type);let i=!1;(e.childType&&-1!=n.indexOf(e.childType)||e.command&&-1!=n.indexOf(e.command))&&(i=!0),e.disType=!(!r&&!i)}),-1==n.indexOf("line")&&l.map((e,t)=>{"line"==e.type&&-1==s.indexOf(e.splitType)||(o++,e.id=o,i.push(e))})):(u=!0,i=[...this.defaultData]),u&&r&&this.childData.map((e,t)=>{"setAttrChild"==e.type&&(-1!=r.indexOf(e.eleTypeName)?e.disType=!1:e.disType=!0)});let h=0,d=[];null!=t&&t.map((e,t)=>{0==t&&(o++,i.push({type:"line",id:o,txt:"",splitType:"_customize"}));let n=[];e.childMenus instanceof Array&&e.childMenus.length>0&&e.childMenus.map((e,t)=>{if(e.menu){let t=void 0,r={};e.setGray?r={className:"menuGrayed"}:("function"==typeof e.callback&&(t=e.callback),r={command:t}),n.push(Object.assign({txt:e.menu},r))}});let r=null;if("function"!=typeof e.callback||n.length>0||(r=e.callback),!e.hideByCptId)if("line"==e.type)o++,i.push({type:"line",id:o,menuId:e.menuId});else if(-1==d.indexOf(e.menu)){o++;let t={};e.setGray?t={className:"menuGrayed"}:(t={command:r||"",childMenus:n},h=Math.max(h,n.length));const l=Number(e.menuIndex),s=Object.assign({type:"_customize",id:o,menuId:e.menuId,txt:e.menu||"自定义内容",icon:e.icon||""},t);l>=0?i.splice(l,0,s):i.push(s),d.push(e.menu),a++}}),i instanceof Array&&null!=i[0]&&"line"==i[0].type&&i.shift();let c=0;return i.map((e,t)=>{"line"==e.type&&c++}),this.line_num=c,this.list_num=Math.max(a,h),i}clickHandler(e,t=null){if("function"==typeof e){const{customizeParams:n}=this.state,r=t;n.menuId=r,e(n)}else if("TextTableResizeRow"==e){if(t){const n=Number(t);return"function"==typeof this.props.onOk&&this.props.onOk(e,n),void this.setState({inputPopShow:!1})}this.setState({inputPopShow:!0})}else"function"==typeof this.props.onOk&&this.props.onOk(e,t);this.closeEvent()}renderLabels(){const{menuArr:e,itemName:t}=this.state;let n=-1,i=0,l=e.map((e,t)=>{const l=!!e.childType,s=e.childMenus instanceof Array&&e.childMenus.length>0,o="line"==e.type;let a="right-menu-li";return e.className&&(a+=" "+e.className),o?a+=" splite":(l||s)&&(a+=" hasChild"),o?i++:n+=1,"Paste"!=e.command||window.winning?r.createElement("div",{key:"rightMenu"+e.id,className:a,onClick:()=>e.command?this.clickHandler(e.command,e.menuId):null},e.icon?r.createElement("i",{className:e.icon}):null,e.txt,e.Shortcutkey?r.createElement("span",{className:"Shortcutkey",style:{margin:"0 45px"}},e.Shortcutkey):null,l?this.renderchildren(e.childType,this.list_num-n+.5*(this.line_num-i)):null,s?this.renderchildMenus(e.childMenus,n):null):null}),s=t?" right-menu-item-"+t:"";return r.createElement("div",{className:"right-menu"+s},l)}renderchildren(e,t){let n=[];this.childData.map(t=>{e!=t.type||t.disType||n.push(t)});let i=0,l=n.map((e,t)=>{const i=!!e.childType;let l="right-menu-li";return l+=i?" hasChild":"",r.createElement("div",{key:"rightMenuChildren"+(t+1),className:l,onClick:()=>e.command?this.clickHandler(e.command,e.eleTypeName):null},e.icon?r.createElement("i",{className:e.icon}):null,e.txt,i?this.renderchildren(e.childType,n.length-t):null)});i=n.length-t;let s=i>=0?{top:-1*(i*this.list_height+10)+"px"}:null;return r.createElement("div",{className:"right-menu",style:s},l)}renderchildMenus(e,t){const n=e;let i=n.map((e,t)=>{let n="right-menu-li";return n+=e.className?" "+e.className:"",r.createElement("div",{key:"rightMenuChildren"+(t+1),className:n,onClick:()=>e.command?this.clickHandler(e.command):null},e.icon?r.createElement("i",{className:e.icon}):null,e.txt)});const l=Math.min(n.length-1,t);let s=l>0?{top:-1*l*this.list_height+"px"}:null;return r.createElement("div",{className:"right-menu",style:s},i)}InputPop(){const{minRowFixheight:e}=this.state;return r.createElement(o.Dialog,{title:"设置表格行高",width:550,height:144,visible:this.state.inputPopShow,onOk:()=>this.clickHandler("TextTableResizeRow",e),onCancel:()=>{this.setState({inputPopShow:!1})}},r.createElement("input",{onKeyPress:e=>{/[\d|\.]/g.test(String.fromCharCode(e.charCode))||e.preventDefault()},onClick:e=>e.currentTarget.select(),onChange:e=>this.setState({minRowFixheight:e.target.value}),className:"pango-editor-input-inner",type:"number",defaultValue:e||""}))}}class u extends s.BaseComponent{constructor(e,t=null){super(t,e),this.updateProps=e=>{this.Child&&this.Child.updateEvent(e)},this.updateProps=this.updateProps.bind(this)}Render(){const e=r.createElement(a,Object.assign({},this.Props,{parent:this,onRef:e=>this.Child=e}));i.render(e,document.createDocumentFragment())}}t.RightMenuComp=u},function(e,t,n){var r=n(18),i=n(1173);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".right-menu-pop {\r\n    cursor: pointer;\r\n    box-shadow: none;\r\n    border: 0;\r\n}\r\n.pango-editor-popover.right-menu-pop{\r\n    position: fixed;\r\n}\r\n.right-menu {\r\n    background: #FFFFFF;\r\n}\r\n.right-menu .right-menu-li {\r\n    color: rgb(116, 116, 116);\r\n}\r\n.right-menu .right-menu-li.splite {\r\n    border-top: 1px solid rgb(204,241,252);\r\n}\r\n.right-menu .right-menu-li.menuGrayed:hover,\r\n.right-menu .right-menu-li.menuGrayed {\r\n    color: #999;\r\n    background-color:#e9e9e9;\r\n    cursor: default;\r\n}\r\n.right-menu .right-menu-li.hasChild {\r\n    position: relative;\r\n}\r\n.right-menu .right-menu-li i {\r\n    font-size: 14px;\r\n    width: 14px;\r\n}\r\n.right-menu .right-menu-li .Shortcutkey{\r\n    font-size: 12px;\r\n}\r\n.right-menu-li.hasChild .right-menu {\r\n    white-space: nowrap;\r\n    position: absolute;\r\n    left: 100%;\r\n    display: none;\r\n}\r\n.right-menu-li.hasChild:hover>.right-menu {\r\n    display: block;\r\n}\r\n    .right-menu {\r\n        padding: 10px 0;\r\n        border: 0;\r\n        box-shadow: 0 3px 7px 0 rgba(0,0,0,0.22);\r\n        border-radius: 4px;\r\n    }\r\n    .right-menu .right-menu-li {\r\n        font-size: 16px;\r\n        line-height: 32px;\r\n        padding: 0 10px;\r\n    }\r\n    .right-menu .right-menu-li:hover {\r\n        color: #565656;\r\n        background-color:#ECF0F4;\r\n    }\r\n    .right-menu .right-menu-li.splite {\r\n        border-top-color: #C8D0D8;\r\n        margin: 8px 0;\r\n    }\r\n    .right-menu .right-menu-li i {\r\n        margin-right: 8px;\r\n    }\r\n    .right-menu-li.hasChild .right-menu {\r\n        top: -10px;\r\n        bottom: auto;\r\n    }\r\n    .right-menu-item-smallBlue.right-menu .right-menu,\r\n    .right-menu-item-smallBlue.right-menu {\r\n        padding: 0 0;\r\n        border: 1px solid rgb(0, 183, 238);\r\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\r\n        border-radius: 0;\r\n    }\r\n    .right-menu-item-smallBlue.right-menu .right-menu-li {\r\n        font-size: 12px;\r\n        line-height: 28px;\r\n        padding: 0 1em;\r\n    }\r\n    .right-menu-item-smallBlue.right-menu .right-menu-li:hover {\r\n        color: #fff;\r\n        background-color: rgb(0, 183, 238);\r\n    }\r\n    .right-menu-item-smallBlue.right-menu .right-menu-li.splite {\r\n        border-top-color: #eee;\r\n        margin: 0 0;\r\n    }\r\n    .right-menu-item-smallBlue.right-menu-li.hasChild .right-menu {\r\n        top: 0;\r\n        bottom: auto;\r\n    }\r\n    .right-menu-item-smallBlue.right-menu .right-menu-li i {\r\n        margin-right: 0.25em;\r\n        margin-left: -0.25em;\r\n    }\r\n\r\n",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontDialog=void 0;const r=n(27),i=n(1175),l=n(357),s=n(358),o=n(356),a=n(1178),u=n(121),h={id:"SetFontName",options:["宋体","黑体","微软雅黑","微软正黑体","楷体","新宋体","仿宋"],isObject:!1,singleSelect:!0,selectedValues:["宋体"],textWidth:80},d={id:"SetFontSize",options:[6,8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],isObject:!1,singleSelect:!0,selectedValues:[12],textWidth:60},c=[{fontName:"SetFontName",title:"字体",stopEvent:!0},{fontSize:"SetFontSize",title:"字号",stopEvent:!0},{bold:"SetFontBold",title:"加粗",switch:!0,stopEvent:!0},{italic:"SetFontItalic",title:"斜体",switch:!0,stopEvent:!0},{underline:"SetTextUnderline",title:"下划线",switch:!0,stopEvent:!0},{fontFamily:"SetForeColor",title:"文本颜色",stopEvent:!0},{textcolor:"SetBkgColor",title:"背景色",stopEvent:!0}];class p extends r.BaseControl{constructor(e,t,n){let r=document.createDocumentFragment();super(r,e),this._toobarhandler=t.M_ActionHandler,this.itemList=this.renderChildren(),this.clickedEle=n,this.Component=new i.FontDialogComp(r,this.itemList,Object.assign(this.InitProps,{onLoad:()=>{this._OnLoad()}}),this._getInitStyle())}renderChildren(){return c.map((e,t)=>{let n=Object.keys(e)[0],r=e.title,i=e.stopEvent;if("fontName"===n){let e=Object.assign(Object.assign({},h),{stopEvent:i});return this.fontFamilyDropdown=new l.Dropdown(null,Object.assign({},e),this._toobarhandler),this.fontFamilyDropdown}if("fontSize"===n){let e=Object.assign(Object.assign({},d),{stopEvent:i});return this.fontSizeDropdown=new l.Dropdown(null,Object.assign({},e),this._toobarhandler),this.fontSizeDropdown}if("fontFamily"===n){let t={id:e[n],buttonIcon:n,title:r,stopEvent:i};return new s.ColorButton(null,t,this._toobarhandler)}if("textcolor"===n){let t={id:e[n],buttonIcon:n,title:r,stopEvent:i};return new s.ColorButton(null,t,this._toobarhandler)}{let t={id:e[n],buttonIcon:n,title:r,stopEvent:i};return e.switch&&(t.switch=e.switch),e.isContinueSelected&&(t.isContinueSelected=e.isContinueSelected),new o.IconButton(null,t,this._toobarhandler)}})}GetCurrentBtnElement(e){let t;for(var n=0;n<this.itemList.length;n++)if(this.itemList[n].id==e){t=this.itemList[n].Component;break}return t}DefaultProps(){return{}}_BuildFontDialogStyle(e){let t=new a.FontDialogStyle;return t.FontStyle=this._BulidFontInfo(e.XFontStyle),t.FontColor=e.ForeColor,t.FontBgColor=e.BackgroundColor,t}_BulidFontInfo(e){if(null==e)return new u.FontInfo;{let t=new u.FontInfo;return t.FontName=e.FontName,t.FontSize=e.FontSize,t.FontSizeName=e.FontSizeName,t.IsBold=e.IsBold,t.IsItatlic=e.IsItalic,t.IsDrawUnderLine=e.IsUnderline,t}}_OnLoad(){let e=this._BuildFontDialogStyle(this.clickedEle.EleStyle);this.UpdateFontDialogBtnStatus(e)}UpdateFontDialogBtnStatus(e){if(null==e)return;let t=this.GetCurrentBtnElement("SetFontBold");null!=t&&(t.CommandValue=e.FontStyle.IsBold);let n=this.GetCurrentBtnElement("SetFontItalic");null!=n&&(n.CommandValue=e.FontStyle.IsItatlic);let r=this.GetCurrentBtnElement("SetTextUnderline");null!=r&&(r.CommandValue=e.FontStyle.IsDrawUnderLine);let i=this.GetCurrentBtnElement("SetFontName");null!=i&&(i.CommandValue=e.FontStyle.FontName);let l=this.GetCurrentBtnElement("SetFontSize");null!=l&&(l.CommandValue=e.FontStyle.FontSizeName);let s=this.GetCurrentBtnElement("SetForeColor");null!=s&&(s.CommandValue=e.FontColor);let o=this.GetCurrentBtnElement("SetBkgColor");null!=o&&(o.CommandValue=e.FontBgColor)}_getInitStyle(){let e=this._BuildFontDialogStyle(this.clickedEle.EleStyle),t={};return t.SetFontName=e.FontStyle.FontName,t.SetFontSize=e.FontStyle.FontSizeName,t.SetFontBold=e.FontStyle.IsBold,t.SetFontItalic=e.FontStyle.IsItatlic,t.SetTextUnderline=e.FontStyle.IsDrawUnderLine,t.SetForeColor=e.FontColor?e.FontColor.ToRgbaString():"",t.SetBkgColor=e.FontBgColor?e.FontBgColor.ToRgbaString():"",t}}t.FontDialog=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontDialogComp=t.FontDialog=void 0;const r=n(12),i=n(24),l=n(52),s=n(22),o=n(235),a=n(236),u=n(238);n(1176);class h extends r.Component{constructor(e){super(e),this.stateRef={},this.state={fontName:e.fontName,fontSize:e.fontSize,parentList:[],fontColorLeft:0,fontColorTop:0,bgColorLeft:0,bgColorTop:0},this.getFontName=this.getFontName.bind(this),this.getFontSize=this.getFontSize.bind(this),this.selectedList={fontName:"",fontSize:"",fontColor:"",bgColor:""}}componentDidMount(){this.props.parent.React=this,this.props.onLoad()}offset(e){let t=null,n=null,r=e.offsetParent;for(t+=e.offsetLeft,n+=e.offsetTop;r;)t+=r.offsetLeft,n+=r.offsetTop,r=r.offsetParent;return{left:t,top:n}}handleOk(){this.props.onOk(this.stateRef)}getFontName(e){Object.assign(this.selectedList,{fontName:e})}getFontSize(e){Object.assign(this.selectedList,{fontSize:e})}handleColorClick(){let e=this.fontColorRef.buttonIcon,t=this.bgColorRef.buttonIcon;this.setState({fontColorLeft:this.offset(e).left,fontColorTop:this.offset(e).top+24}),this.setState({bgColorLeft:this.offset(t).left,bgColorTop:this.offset(t).top+24})}renderMainBody(){return r.createElement("div",{className:"fontDialog",onClick:this.handleColorClick.bind(this)},this.props.parent.ItemList.map((e,t)=>{if(e.Component instanceof o.IconButtonComp)return r.createElement(o.IconButton,Object.assign({stateRef:this.stateRef,key:t},e.InitProps,{item:e.Component,toolbar:this.props.parent}));if(e.Component instanceof a.DropdownComp)return r.createElement(a.default,Object.assign({stateRef:this.stateRef,key:t},e.InitProps,{item:e.Component}));if(e.Component instanceof u.ColorButtonComp){if("fontFamily"==e.Component.o.buttonIcon){let n=Object.assign(Object.assign({},e.InitProps),{isSetPopPos:!0,isDestroy:!0,popTop:this.state.fontColorTop,popLeft:this.state.fontColorLeft});return r.createElement(u.ColorButton,Object.assign({stateRef:this.stateRef,ref:e=>this.fontColorRef=e,key:t},n,{item:e.Component}))}if("textcolor"==e.Component.o.buttonIcon){let n=Object.assign(Object.assign({},e.InitProps),{isSetPopPos:!0,isDestroy:!0,popTop:this.state.bgColorTop,popLeft:this.state.bgColorLeft});return r.createElement(u.ColorButton,Object.assign({stateRef:this.stateRef,ref:e=>this.bgColorRef=e,key:t},n,{item:e.Component}))}}}))}_getPreviewStyle(){let e={},t=Object.assign(this.props.parent.InitStyle,this.stateRef);for(let n in t)switch(n){case"SetFontName":e.fontFamily=t[n];break;case"SetFontSize":e.fontSize=t[n]+"px";break;case"SetFontBold":e.fontWeight=t[n]?"bold":"normal";break;case"SetFontItalic":e.fontStyle=t[n]?"italic":"normal";break;case"SetTextUnderline":e.textDecoration=t[n]?"underline":"none";break;case"SetForeColor":e.color=t[n];break;case"SetBkgColor":e.backgroundColor=t[n]}return e}renderPreview(){let e=this._getPreviewStyle();return r.createElement("div",{className:"previewWrap"},r.createElement("span",{className:"title"},"预览框"),r.createElement("div",{className:"preview",style:e},"预览文字"))}render(){return r.createElement(l.Dialog,{className:"fontDialogWrap",width:400,height:310,title:"字体",visible:!0,onOk:this.handleOk.bind(this),isDestroy:!0},this.renderMainBody(),this.renderPreview())}}t.FontDialog=h,h.defaultProps={type:"",onLoad:()=>{}};class d extends s.BaseComponent{constructor(e,t,n,r){super(e,n,!0),this.itemList=t,this.initStyle=r,this.Render()}get ItemList(){return this.itemList}get InitStyle(){return this.initStyle}onOk(){this.React.handleOk()}Render(){i.render(r.createElement(h,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.FontDialogComp=d},function(e,t,n){var r=n(18),i=n(1177);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,'.fontDialog {\r\n    position: relative;\r\n    padding: 16px;\r\n    cursor: default;\r\n}\r\n\r\n.fontDialog>div, .fontDialog>button {\r\n    position: absolute;\r\n}\r\n\r\n.fontDialog .multiSelectContainer {\r\n    width: 110px;\r\n    top: 20px;\r\n    border: 1px solid #ccc;\r\n}\r\n\r\n.fontDialog .multiSelectContainer:nth-child(2) {\r\n    width: 90px;\r\n    left: 220px;\r\n}\r\n\r\n.fontDialog .pango-editor-button {\r\n    top: 60px;\r\n}\r\n\r\n.fontDialog #SetFontItalic {\r\n    left: 68px;\r\n}\r\n\r\n.fontDialog #SetTextUnderline {\r\n    left: 120px;\r\n}\r\n\r\n.fontDialog .colorButton {\r\n    top: 60px;\r\n}\r\n\r\n.fontDialog #SetForeColor {\r\n    left: 180px;\r\n}\r\n\r\n.fontDialog #SetBkgColor {\r\n    left: 240px;\r\n}\r\n.previewWrap {\r\n    display: flex;\r\n    justify-content: center;\r\n    position: relative;\r\n    top: 96px;\r\n    width: 100%;\r\n    height: 80px;\r\n}\r\n.previewWrap .title {\r\n    font-size: 12px;\r\n    color: #666;\r\n    position: absolute;\r\n    top: -8px;\r\n    left: 20px;\r\n}\r\n.previewWrap:before{\r\n    content: "";\r\n    position: absolute;\r\n    display: inline-block;\r\n    width: 246px;\r\n    left: 62px;\r\n    height: 1px;\r\n    background-color: #ccc;\r\n    box-sizing: border-box;\r\n}\r\n.previewWrap .preview{\r\n    position: absolute;\r\n    width: 350px;\r\n    height: 60px;\r\n    margin-top: 10px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n.fontDialogWrap .pango-editor-dialog-footer .pango-editor-text-button {\r\n    width: 80px!important;\r\n    height: 24px!important;\r\n}\r\n',""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontDialogStyle=void 0;const r=n(121);t.FontDialogStyle=class{get FontStyle(){return this._fontStyle}set FontStyle(e){this._fontStyle=e}get FontColor(){return this._fontColor}set FontColor(e){this._fontColor=e}get FontBgColor(){return this._fontBgColor}set FontBgColor(e){this._fontBgColor=e}ToolBarStyle(){this._fontStyle=new r.FontInfo,this._fontStyle.InitFontInfo()}Intersect(e){this.FontStyle.Intersect(e.FontStyle)}}},function(e,t,n){var r=n(18),i=n(1180);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,":root {\r\n    --pango-editor-theme:#2d5afa;\r\n    --pango-editor-theme-hover:#5175f4;\r\n    --pango-editor-theme-press:#1d39c4;\r\n    --pango-editor-theme-table-head:#eaeefe;\r\n    --pango-editor-theme-back-select:#f3f5ff;\r\n\r\n    --pango-editor--prompt-fail-color:#EC0000;\r\n    --pango-editor--background:#F2F4F6;\r\n    --pango-editor--input-border-color:#C9C9C9;\r\n    --pango-editor--input-font-color: #000000;\r\n    --pango-editor--input-placeholder-color: #999999;\r\n    --pango-editor--input-border-hover-color: #999999;\r\n    --pango-editor--input-border-active-color: var(--pango-editor-theme-press);\r\n    --pango-editor--input-border-active-shadow-color: var(--pango-editor-theme-back-select);\r\n    --pango-editor--input-icon-color: #7E89A4;\r\n    --pango-editor--input-icon-active-color: var(--pango-editor-theme-press);\r\n    --pango-editor--input-border-validate-color: var(--pango-editor--prompt-fail-color);\r\n    --pango-editor--input-border-validate-shadow-color: #f8ebeb;\r\n    --pango-editor--border-input-color: #E9E9E9;\r\n    --pango-editor--font-sub-title-color: #333333; \r\n    --pango-editor--input-font-disabled-color: #999999;\r\n\r\n    --pango-editor--fs12px: 12px;\r\n    --pango-editor--fs13px: 13px;\r\n    --pango-editor--fs14px: 14px;\r\n    --pango-editor--fs15px: 15px;\r\n    --pango-editor--fs16px: 16px;\r\n    --pango-editor--fs17px: 17px;\r\n    --pango-editor--fs18px: 18px;\r\n}",""]),e.exports=t},function(e,t,n){var r=n(18),i=n(1182);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".pango-editor {\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    overflow: hidden;\r\n}\r\n.pango-editor-content {\r\n    padding: 0 28px;\r\n    position: relative;\r\n    flex-grow: 1;\r\n    overflow: auto;\r\n    display: flex;\r\n    justify-content: center;\r\n    background: var(--pango-editor--background);\r\n}\r\n\r\n.pango-editor-content::-webkit-scrollbar {\r\n    width: 8px;     \r\n    height: 8px;\r\n}\r\n.pango-editor-content::-webkit-scrollbar-thumb {\r\n    border-left: 1px solid #ffffff;\r\n    border-right: 2px solid #ffffff;\r\n    border-radius: 4px;\r\n    background: rgba(58,58,58,0.4);\r\n}\r\n.pango-editor-content::-webkit-scrollbar-track {\r\n    background: #FFFFFF;\r\n}\r\n.pango-editor-content::-webkit-scrollbar-thumb:active {\r\n    background: rgba(58,58,58,1);\r\n}\r\n\r\n.pango-editor-content .pango-editor-pages {\r\n    position: absolute;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    outline:none;\r\n}\r\n.pango-editor-content .pango-editor-pages>canvas {\r\n    box-shadow: 0 0 16px 0 rgba(0,0,0,0.20), inset -1px 0 0 0 #A3A3A3, inset 1px 1px 0 0 #A3A3A3;\r\n}\r\n\r\n.pango-editor-care-div {\r\n    position: absolute;\r\n    background: #000000;\r\n    animation:cursorImg 1s infinite steps(1, start);\r\n}\r\n@keyframes cursorImg {\r\n    0%, 100% {\r\n        opacity: 1;\r\n    }\r\n    50% {\r\n        opacity: 0;\r\n    }\r\n}\r\n.pango-editor-care-div input {\r\n    opacity: 0;\r\n    width: 10px;\r\n    padding: 0;\r\n    margin: auto;\r\n    position: absolute;\r\n    left: -1px;\r\n    right: -1px;\r\n    top: 1.25em;\r\n}\r\n\r\n.pango-editor-ruler {\r\n    overflow: hidden;\r\n    margin: auto;\r\n}\r\n.pango-editor-ruler canvas#pango-editor-ruler-top {\r\n    display: block;\r\n    cursor: default;\r\n    margin: 0;\r\n    position: relative;\r\n    z-index: 9;\r\n}\r\n.pango-editor-content canvas#pango-editor-ruler-left {\r\n    transform: none;\r\n    cursor: default;\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    z-index: 9;\r\n}\r\n.pango-editor-statusBar {\r\n    z-index: 10;\r\n}\r\n\r\n",""]),e.exports=t},function(e,t,n){var r=n(18),i=n(1184);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){var r=n(19),i=n(388),l=n(1185),s=n(1186),o=n(1187);t=r(!1);var a=i(l),u=i(s),h=i(o);t.push([e.i,'@font-face {\r\n  font-family: "emrfont"; \r\n  src: url('+a+") format('woff2'),\r\n       url("+u+") format('woff'),\r\n       url("+h+') format(\'truetype\');\r\n}\r\n\r\n[class*=" emr-icon-"], [class^=emr-icon-] {\r\n  font-family: "emrfont" !important;\r\n  font-style: normal;\r\n  font-weight: 200;\r\n  font-variant: normal;\r\n  text-transform: none;\r\n  line-height: 1;\r\n  vertical-align: baseline;\r\n  display: inline-block;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\n.emr-icon-diagnoseConfirm:before {\r\n  content: "\\e717";\r\n}\r\n\r\n.emr-icon-outHospital:before {\r\n  content: "\\e70f";\r\n}\r\n\r\n.emr-icon-inHospital:before {\r\n  content: "\\e710";\r\n}\r\n\r\n.emr-icon-copyText:before {\r\n  content: "\\e709";\r\n}\r\n\r\n.emr-icon-mark:before {\r\n  content: "\\e707";\r\n}\r\n\r\n.emr-icon-preview:before {\r\n  content: "\\e708";\r\n}\r\n\r\n.emr-icon-additionalCopy:before {\r\n  content: "\\e706";\r\n}\r\n\r\n.emr-icon-duanyu:before {\r\n  content: "\\e782";\r\n}\r\n\r\n.emr-icon-zhengxingfudianxing:before {\r\n  content: "\\e777";\r\n}\r\n\r\n.emr-icon-kaiguan:before {\r\n  content: "\\e77e";\r\n}\r\n\r\n.emr-icon-mimakuang1:before {\r\n  content: "\\e778";\r\n}\r\n\r\n.emr-icon-shijiankuang1:before {\r\n  content: "\\e779";\r\n}\r\n\r\n.emr-icon-zifukuang1:before {\r\n  content: "\\e77a";\r\n}\r\n\r\n.emr-icon-xialakuang1:before {\r\n  content: "\\e77b";\r\n}\r\n\r\n.emr-icon-zhengxingfudianxing1:before {\r\n  content: "\\e77c";\r\n}\r\n\r\n.emr-icon-xiguan1:before {\r\n  content: "\\e77d";\r\n}\r\n\r\n.emr-icon-xinjian:before {\r\n  content: "\\e776";\r\n}\r\n\r\n.emr-icon-down:before {\r\n  content: "\\e774";\r\n}\r\n\r\n.emr-icon-up:before {\r\n  content: "\\e775";\r\n}\r\n\r\n.emr-icon-qingchugeshi:before {\r\n  content: "\\e76e";\r\n}\r\n\r\n.emr-icon-huanhangfu:before {\r\n  content: "\\e76f";\r\n}\r\n\r\n.emr-icon-tubiao:before {\r\n  content: "\\e770";\r\n}\r\n\r\n.emr-icon-yemianshitu:before {\r\n  content: "\\e772";\r\n}\r\n\r\n.emr-icon-yaweitu:before {\r\n  content: "\\e773";\r\n}\r\n\r\n.emr-icon-moxingshu:before {\r\n  content: "\\e76b";\r\n}\r\n\r\n.emr-icon-zidingyishujuji:before {\r\n  content: "\\e76c";\r\n}\r\n\r\n.emr-icon-edit:before {\r\n  content: "\\e6f5";\r\n}\r\n\r\n.emr-icon-deleteformcolumn:before {\r\n  content: "\\e6ee";\r\n}\r\n\r\n.emr-icon-liebiao1:before {\r\n  content: "\\e768";\r\n}\r\n\r\n.emr-icon-dianhuahaomakuang:before {\r\n  content: "\\e769";\r\n}\r\n\r\n.emr-icon-wenjianshangchuan:before {\r\n  content: "\\e76a";\r\n}\r\n\r\n.emr-icon-zujian:before {\r\n  content: "\\e764";\r\n}\r\n\r\n.emr-icon-shujuyuan:before {\r\n  content: "\\e765";\r\n}\r\n\r\n.emr-icon-xinjianxialaanniu:before {\r\n  content: "\\e756";\r\n}\r\n\r\n.emr-icon-xinjianwenbenshurukongjian:before {\r\n  content: "\\e753";\r\n}\r\n\r\n.emr-icon-xinjiananniuzu:before {\r\n  content: "\\e755";\r\n}\r\n\r\n.emr-icon-xinjianbiaoqian:before {\r\n  content: "\\e752";\r\n}\r\n\r\n.emr-icon-xialaanniu:before {\r\n  content: "\\e74a";\r\n}\r\n\r\n.emr-icon-anniuzu:before {\r\n  content: "\\e74b";\r\n}\r\n\r\n.emr-icon-jindutiao:before {\r\n  content: "\\e74f";\r\n}\r\n\r\n.emr-icon-liebiao:before {\r\n  content: "\\e750";\r\n}\r\n\r\n.emr-icon-ziji-tongyong:before {\r\n  content: "\\e749";\r\n}\r\n\r\n.emr-icon-fuji-shujuji:before {\r\n  content: "\\e751";\r\n}\r\n\r\n.emr-icon-fuji-biaoshuju:before {\r\n  content: "\\e747";\r\n}\r\n\r\n.emr-icon-fuji-canzhao:before {\r\n  content: "\\e74d";\r\n}\r\n\r\n.emr-icon-fuji-yuanshuju:before {\r\n  content: "\\e754";\r\n}\r\n\r\n.emr-icon-fuji-canzhaomoxing:before {\r\n  content: "\\e74c";\r\n}\r\n\r\n.emr-icon-a-fuji-tongyongmeiju-shensemoshi:before {\r\n  content: "\\e74e";\r\n}\r\n\r\n.emr-icon-paragraph:before {\r\n  content: "\\e6e9";\r\n}\r\n\r\n.emr-icon-word:before {\r\n  content: "\\e6cc";\r\n}\r\n\r\n.emr-icon-frame:before {\r\n  content: "\\e6cb";\r\n}\r\n\r\n.emr-icon-straightLine:before {\r\n  content: "\\e6ce";\r\n}\r\n\r\n.emr-icon-arrow:before {\r\n  content: "\\e6cf";\r\n}\r\n\r\n.emr-icon-pen:before {\r\n  content: "\\e6d0";\r\n}\r\n\r\n.emr-icon-circle:before {\r\n  content: "\\e6d1";\r\n}\r\n\r\n.emr-icon-brokenLine:before {\r\n  content: "\\e6d5";\r\n}\r\n\r\n.emr-icon-polygon:before {\r\n  content: "\\e6d9";\r\n}\r\n\r\n.emr-icon-strikeThrough:before {\r\n  content: "\\e6ad";\r\n}\r\n\r\n.emr-icon-expression:before {\r\n  content: "\\e65f";\r\n}\r\n\r\n.emr-icon-qrcode:before {\r\n  content: "\\e6d2";\r\n}\r\n\r\n.emr-icon-doctororder:before {\r\n  content: "\\e65e";\r\n}\r\n\r\n.emr-icon-baogao:before {\r\n  content: "\\e65d";\r\n}\r\n\r\n.emr-icon-humanbody:before {\r\n  content: "\\e65c";\r\n}\r\n\r\n.emr-icon-save:before {\r\n  content: "\\e65b";\r\n}\r\n\r\n.emr-icon-transform:before {\r\n  content: "\\e65a";\r\n}\r\n\r\n.emr-icon-warning:before {\r\n  content: "\\e655";\r\n}\r\n\r\n.emr-icon-success:before {\r\n  content: "\\e656";\r\n}\r\n\r\n.emr-icon-info:before {\r\n  content: "\\e657";\r\n}\r\n\r\n.emr-icon-question:before {\r\n  content: "\\e658";\r\n}\r\n\r\n.emr-icon-error:before {\r\n  content: "\\e659";\r\n}\r\n\r\n.emr-icon-zoomin:before {\r\n  content: "\\e654";\r\n}\r\n\r\n.emr-icon-zoomout:before {\r\n  content: "\\e652";\r\n}\r\n\r\n.emr-icon-folder:before {\r\n  content: "\\e653";\r\n}\r\n\r\n.emr-icon-right:before {\r\n  content: "\\e64f";\r\n}\r\n\r\n.emr-icon-left:before {\r\n  content: "\\e650";\r\n}\r\n\r\n.emr-icon-justify:before {\r\n  content: "\\e651";\r\n}\r\n\r\n.emr-icon-center:before {\r\n  content: "\\e64d";\r\n}\r\n\r\n.emr-icon-distributed:before {\r\n  content: "\\e64e";\r\n}\r\n\r\n.emr-icon-topleft:before {\r\n  content: "\\e647";\r\n}\r\n\r\n.emr-icon-bottomleft:before {\r\n  content: "\\e648";\r\n}\r\n\r\n.emr-icon-bottomright:before {\r\n  content: "\\e649";\r\n}\r\n\r\n.emr-icon-bottomcenter:before {\r\n  content: "\\e64a";\r\n}\r\n\r\n.emr-icon-topright:before {\r\n  content: "\\e64b";\r\n}\r\n\r\n.emr-icon-topcenter:before {\r\n  content: "\\e64c";\r\n}\r\n\r\n.emr-icon-centercenter:before {\r\n  content: "\\e644";\r\n}\r\n\r\n.emr-icon-centerright:before {\r\n  content: "\\e645";\r\n}\r\n\r\n.emr-icon-centerleft:before {\r\n  content: "\\e646";\r\n}\r\n\r\n.emr-icon-arrowbottom:before {\r\n  content: "\\e643";\r\n}\r\n\r\n.emr-icon-adddata:before {\r\n  content: "\\e63e";\r\n}\r\n\r\n.emr-icon-property:before {\r\n  content: "\\e642";\r\n}\r\n\r\n.emr-icon-splitcells:before {\r\n  content: "\\e641";\r\n}\r\n\r\n.emr-icon-pagenumber:before {\r\n  content: "\\e640";\r\n}\r\n\r\n.emr-icon-alignment:before {\r\n  content: "\\e63d";\r\n}\r\n\r\n.emr-icon-structure:before {\r\n  content: "\\e63c";\r\n}\r\n\r\n.emr-icon-barcode:before {\r\n  content: "\\e63a";\r\n}\r\n\r\n.emr-icon-text:before {\r\n  content: "\\e69c";\r\n}\r\n\r\n.emr-icon-diagnose:before {\r\n  content: "\\e69d";\r\n}\r\n\r\n.emr-icon-signature:before {\r\n  content: "\\e69e";\r\n}\r\n\r\n.emr-icon-haveornot:before {\r\n  content: "\\e69f";\r\n}\r\n\r\n.emr-icon-number:before {\r\n  content: "\\e6a0";\r\n}\r\n\r\n.emr-icon-reference:before {\r\n  content: "\\e6a4";\r\n}\r\n\r\n.emr-icon-link:before {\r\n  content: "\\e6a7";\r\n}\r\n\r\n.emr-icon-checkbox:before {\r\n  content: "\\e6a9";\r\n}\r\n\r\n.emr-icon-date:before {\r\n  content: "\\e6aa";\r\n}\r\n\r\n.emr-icon-datagroup:before {\r\n  content: "\\e6ac";\r\n}\r\n\r\n.emr-icon-element:before {\r\n  content: "\\e6b1";\r\n}\r\n\r\n.emr-icon-codegroup:before {\r\n  content: "\\e6a1";\r\n}\r\n\r\n.emr-icon-watermark:before {\r\n  content: "\\e6bd";\r\n}\r\n\r\n.emr-icon-code:before {\r\n  content: "\\6e90";\r\n}\r\n\r\n.emr-icon-saveas:before {\r\n  content: "\\e6bf";\r\n}\r\n\r\n.emr-icon-open:before {\r\n  content: "\\e6c0";\r\n}\r\n\r\n.emr-icon-printpreview:before {\r\n  content: "\\e6c1";\r\n}\r\n\r\n.emr-icon-pageformat:before {\r\n  content: "\\e6c3";\r\n}\r\n\r\n.emr-icon-printcurrentpage:before {\r\n  content: "\\e6c5";\r\n}\r\n\r\n.emr-icon-delete:before {\r\n  content: "\\e6f1";\r\n}\r\n\r\n.emr-icon-bordershade:before {\r\n  content: "\\e6b0";\r\n}\r\n\r\n.emr-icon-insertline:before {\r\n  content: "\\e6b2";\r\n}\r\n\r\n.emr-icon-insertbutton:before {\r\n  content: "\\e6b3";\r\n}\r\n\r\n.emr-icon-insertshape:before {\r\n  content: "\\e6b5";\r\n}\r\n\r\n.emr-icon-fraction:before {\r\n  content: "\\e6b7";\r\n}\r\n\r\n.emr-icon-insertpagebreak:before {\r\n  content: "\\e6c4";\r\n}\r\n\r\n.emr-icon-insertfilecontent:before {\r\n  content: "\\e6c6";\r\n}\r\n\r\n.emr-icon-showscale:before {\r\n  content: "\\e6c8";\r\n}\r\n\r\n.emr-icon-restoresize:before {\r\n  content: "\\e6ca";\r\n}\r\n\r\n.emr-icon-hiddenscale:before {\r\n  content: "\\e6cd";\r\n}\r\n\r\n.emr-icon-webview:before {\r\n  content: "\\e6d3";\r\n}\r\n\r\n.emr-icon-complexview:before {\r\n  content: "\\e6d4";\r\n}\r\n\r\n.emr-icon-expressioncheck:before {\r\n  content: "\\e6d6";\r\n}\r\n\r\n.emr-icon-test:before {\r\n  content: "\\e6d7";\r\n}\r\n\r\n.emr-icon-insertmacroelement:before {\r\n  content: "\\e6d8";\r\n}\r\n\r\n.emr-icon-paragraphtemplate:before {\r\n  content: "\\e6da";\r\n}\r\n\r\n.emr-icon-workmodel:before {\r\n  content: "\\e6db";\r\n}\r\n\r\n.emr-icon-mergecells:before {\r\n  content: "\\e6dc";\r\n}\r\n\r\n.emr-icon-deleteform:before {\r\n  content: "\\e6dd";\r\n}\r\n\r\n.emr-icon-showgridcode:before {\r\n  content: "\\e6e6";\r\n}\r\n\r\n.emr-icon-hideelementcode:before {\r\n  content: "\\e6ea";\r\n}\r\n\r\n.emr-icon-showelementcode:before {\r\n  content: "\\e6eb";\r\n}\r\n\r\n.emr-icon-elementstore:before {\r\n  content: "\\e6ec";\r\n}\r\n\r\n.emr-icon-data:before {\r\n  content: "\\e6ed";\r\n}\r\n\r\n.emr-icon-reinstallsystem:before {\r\n  content: "\\e6ef";\r\n}\r\n\r\n.emr-icon-testexpression:before {\r\n  content: "\\e6f0";\r\n}\r\n\r\n.emr-icon-tree:before {\r\n  content: "\\e6f2";\r\n}\r\n\r\n.emr-icon-search:before {\r\n  content: "\\e638";\r\n}\r\n\r\n.emr-icon-card:before {\r\n  content: "\\e63f";\r\n}\r\n\r\n.emr-icon-entity:before {\r\n  content: "\\e6b4";\r\n}\r\n\r\n.emr-icon-importReport:before {\r\n  content: "\\e639";\r\n}\r\n\r\n.emr-icon-radio:before {\r\n  content: "\\e698";\r\n}\r\n\r\n.emr-icon-radiogroup:before {\r\n  content: "\\e69a";\r\n}\r\n\r\n.emr-icon-checkboxgroup:before {\r\n  content: "\\e69b";\r\n}\r\n\r\n.emr-icon-cleanview-copy:before {\r\n  content: "\\e757";\r\n}\r\n\r\n.emr-icon-textcolor:before {\r\n  content: "\\e615";\r\n}\r\n\r\n.emr-icon-insertform:before {\r\n  content: "\\e616";\r\n}\r\n\r\n.emr-icon-cancel:before {\r\n  content: "\\e618";\r\n}\r\n\r\n.emr-icon-insertpic:before {\r\n  content: "\\e619";\r\n}\r\n\r\n.emr-icon-recover:before {\r\n  content: "\\e61b";\r\n}\r\n\r\n.emr-icon-bold:before {\r\n  content: "\\e61c";\r\n}\r\n\r\n.emr-icon-cut:before {\r\n  content: "\\e61e";\r\n}\r\n\r\n.emr-icon-deleteformrow:before {\r\n  content: "\\e61f";\r\n}\r\n\r\n.emr-icon-designformulas:before {\r\n  content: "\\e620";\r\n}\r\n\r\n.emr-icon-clear:before {\r\n  content: "\\e621";\r\n}\r\n\r\n.emr-icon-copy:before {\r\n  content: "\\e622";\r\n}\r\n\r\n.emr-icon-spechars:before {\r\n  content: "\\e623";\r\n}\r\n\r\n.emr-icon-insertformbottom:before {\r\n  content: "\\e625";\r\n}\r\n\r\n.emr-icon-insertformright:before {\r\n  content: "\\e626";\r\n}\r\n\r\n.emr-icon-paste:before {\r\n  content: "\\e627";\r\n}\r\n\r\n.emr-icon-insertformleft:before {\r\n  content: "\\e628";\r\n}\r\n\r\n.emr-icon-superscript:before {\r\n  content: "\\e62a";\r\n}\r\n\r\n.emr-icon-songti:before {\r\n  content: "\\e62c";\r\n}\r\n\r\n.emr-icon-fontcolor:before {\r\n  content: "\\e62d";\r\n}\r\n\r\n.emr-icon-underline:before {\r\n  content: "\\e62e";\r\n}\r\n\r\n.emr-icon-insertformtop:before {\r\n  content: "\\e62f";\r\n}\r\n\r\n.emr-icon-font:before {\r\n  content: "\\e630";\r\n}\r\n\r\n.emr-icon-print:before {\r\n  content: "\\e631";\r\n}\r\n\r\n.emr-icon-fontsize:before {\r\n  content: "\\e632";\r\n}\r\n\r\n.emr-icon-subscript:before {\r\n  content: "\\e633";\r\n}\r\n\r\n.emr-icon-italic:before {\r\n  content: "\\e634";\r\n}\r\n\r\n',""]),e.exports=t},function(e,t,n){"use strict";n.r(t),t.default="data:font/woff2;base64,d09GMgABAAAAADTQAAsAAAAAe9QAADR+AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFQGYACYGgqBvRyBk1ABNgIkA4VAC4JiAAQgBYRbB5EtG99kJ5TdF6h0J6B8lW8rWaIojas8MhBsHABUeFL2///fE5SMsd/A+wGiVIlgVMMUmpphaAU73uzSMx80JoxnFOE9suoEYmmQ7euyP0VCMzTPfn4rcwPdXtFtpnXrk5HXZU6Fewe3VIYgWO6xW596ESKfdoKdmmwikwwRnWyeQs6/xGLR2wR7OqlkHa1WRIa4ymo4v5P9r7i+8e7o7ockRVPk4fmr37nLvN+2gEdjiUWBFUUJDFikHykKNL7D89vs0QYi8Q2iJMXCTFrFJMyc9hS9Eta41K2tra0Ld5u4Kpe6KmN1uS6GdKZ3H75LWBACYwhQkuGBnSJ7kTpaLUsyJWzzI9rPIOjYjAXeGgD34VJ/7Avgc3wBNmk3wD4nZ3zphXcUYrvALmgmyY9/46IVKIFWJbaLtFsEuwiSCoj6v5xW/1dJdvwLpNDgMh4BKD0Fid0bg2wr4Tdx0m61LtKe9qlOC0N8WgC87Z4NSwS5g48olsCstTwMkvulgdTnUeaQ3Rgqgq91NjC2Ebng8XZUtbqX7Y/1an59IhhQTDWN3es65vlQCGDc+7fkkPZKmfwGQB9ATcfzwLF8F9XLEB0OcMATrXAYyP1FVeuLrG47yW0/eVhSx1u/1KnuEAlJsEmAAUG3wXkhjziICJh/m5atxl5t7KB8xyXT67lKRa9PmdfTfNBIf75G4z+yvfoaO5bkBY1RI8v7BAczWhp7D7QJHzBqJDumA8k+IK5SAkGbKmmqTZcyTZmiTJuSi6JOmT5EtSN50GwBLLs5TiLOIUgmtqZlIApwSZ/NOfx83Wv2ma4BSe64hSKKHM6lFqVrfHUPY8vGRa7ROe9ExQQFFSPB+HgkAoArEIsCXyhP1ACcV9hUCyiQYL8wAKxXD6+yvBDYHEQAmWgLsAmjuXfYCwvrMA9AnprPG/Djv/bxtflFPwASUBlg79X7l6wEHKtdfhn+mAxUYmY5CyZPADYACoBdWUc9m+7LJw2xJLundrE3L7J4I+BNDBTYcQcKGQ2HkEiAMPmfeC4iLqVSo2adunXDxvMubT//0yUVxIwcPFJy34rMAUmuqBh4O3gKEdEc2impQk1bVq8whbsl+vN3cCoDCxff5mB5QLw7YKIkKbIU7FCvyYHmoZ3Ogwlw03cX3G+F9RFctyyLin9Wm2JuLIZdh5UA4Nt6fgFBIWGPPPbEU88898JLEVExcQlJKWkVKlWp9o3vFciVI8MqubJk0tPQ0kmSLEWqNOkSqanES6CgpF9hTm5efkF2MCszI+327r6ru6e3b7R/YHBoOHVuZH7henFpbGJyanp5ZmV1LS52PT4hMSl9YzN5a3snZXdv/+Aw5uj45DRwdj57ER0aCXsPp/9L3pNVcnl6dndzf35xdXJ0e3z4tztYb7bzxWg8mc4Gw37DZzuu8SzNQqp0sCgGYY+D/01+9jswTid4pDM80RWeSYYXpMJL0uAVGfCaTHhDFrwlG97RDd6TAx/Ig4/kwycK4DOF8IUi+EpP+EYv+E5v+EEf+Ekx/KIv/KYf/KE//GUA/GMIXDIUbhgGnYyADkZCO6OgmdFwxRhoYyy0Mg5aKIEmSqGeMmigHBqpgEoqoYoqqGY81DABapkIdVSHcZMQ0GRACVOglKlQxjQoYjoUUwOF1EIOdZBLPeQxA/KZCQXMgmxmQ5A5kMVcyGQeZDAf0rgRbtkFd+yGe/aEnPYCutkHPdwMvdwCfdwKo9wB/eyHAQ7CIIdgiL/CMH+DVI7AHHfDCP+Eee6BBe6Fa47CIsdgiYdhjEdhgsdgksdhiidhmqdgmeMww9OwwrOwyvOwxgsQxwmI5SSs8yLE8xIk8DIk8gok8Sqk8xps8Dps8gYk8yZs8RZs8zbs8A6k8C7scgr2OA37nIED/gOH/B9i+BiO+ASO+RRO+AxO+RwCRPETL/svvO6/8bz/wdv+H0uBLTWCCkGgSpAoExSKBI0SwaBAyLgWKi6FhlOh40wYuBMmboSFe2HjXDi4EC6uhIcT4eNIBLgVIY5FhEMR4y8G7MSIA7FgLVZsxIat2DEXBxbiwkjcGIsHE/FhKn7MJICBBDGUEPoSRoNE0CJRtEkMHRJHlyR2XpNAj6TQJLmj/gHiR+GpNF3v39N/O6WHt2JZNm0sJ7+UM7hW6oOeHjIqbDzRpPb5SFBlEToa/cBSmnCEkgf5OB96KKaHV7DXqVfEplyrsSxhKIphHUT7SijQwzakHQzU0kNmnwg6VE2q6lSPThil0k3K0ZVUQxNNCSFgLRQyOqWo4lLYeZ2yCKp1siYD7xsBoLP6sgqFUkvJ1YAsSikJLsCcR3BvHglW7R9o1gGGa8A+oCHEuMYoJoNpPuDv98fNY0djEMoVZtUbkZySSEGviQ5+3n4Dvit50e6+6KH7WAtvjnEFeJluuihm1Q2gmVPKpdQ5e/e+FZfiEFTVQEKcg2NkGp9L+w0c9xPWapenpTSHtC42dqZLz13cekNOTommfaYFVnfWOXKaahOlSYfecYbSd5QYjbiZAQ9+BE6J6gJdf4VmYbI6KERIOAyyoXzYHei1miDGi4jO4GVIZgHkAUHPqpxj6gT7OAQOO2eg05MTMROl69MxZlxPYin9sMdaL0DBd2QuSpgojWnDB+XcqYVBdNzhiuhgXPCYToQ+m+E2r7ZTckDWLejqLWOoIYKy4EYDhomQX2TvKOJpX1FM1kbOAIk0ME31m96Ii8+bYkTEq0AR6shMvOpG3c3TVZqeHUHNfSJfVf9FsZCtdsOVXuwZ+Lp7xDogvASN+S7reMIfj5LkPhySszKfIBA1FMVIkUhsi3PMkw3a7j5qUi5CmqZxIEm7I2yulwlGSFyqjkiBjgW/seaWl6jcAArxUEhMXRBAEOjkUGDwj9SeUSDt151LRsR1wPJ2gXkBpgcEjgz1ZxHFKU6MyO5X9wWfdQ0hanR967vFL6rqxR3UjPS8WPd0q0fU2P16lRnw2iDvIntkgY1W3POQeGvaYp0Cl67uvHfy/pjeGjSMe81YF989Lk72Cj0TbpCYgeY+wIrEtY1TvLvPZSQHKOMinasgE1ehk+/wZYTskt+lKOFtbbVDPJLNO2Jjco28BrCnHiUafE2ptQoF+dNP081LXD8oMqdasfOsTTr+Wqk597+ww99cBoTdxyMEAaokfixO07BOFaM7QXwixSZ3H4uKfon7Ho99mu/d8aqKdOMR5sbQqCqvaaJhCLrujbYyctebV6x/9dVzbzt/9oMXrr+WdSjr4b6jRrmx1SnS+ZsnBlWmc18+wbEex97TmJAE8Jh2DagSiJoUxDodS3udqnfw1JIRyc+Us9ll3Hxs86MBnzlfpvuhaGeTvI1hjYthLYv7meX6dKLLa6vysXS9g3LPCBRNTS8hhbJvCjOudG4TL1TmTXBtvBHYpX08s1B9PLdwYDC0NkpDCnSUciPtnOtWUi8wXHhJi6OESYqYUBOjLJY2rlGPjjELYKI1C/vnY9Hm9DpYb3tajUNymVVlv7X5jEF4Rlhzq9urt35tJs3RfnHQSipupVG4DJhbd1UCLhq8u0NQL7bqpzOoOdnBPCARqymFmuHsIcF6T/WJuDX+bhI6Ab4D6SYDUTYpGJO5os5igY0RKGuJQDJzdn6q3/z4zNK3MahJra0K3Yo3Kwcc76sJSS+Q+vba+NzI3V2ws4ONDDSK9rLGuesyRseMF3oXyCeSAlKc23Es2VeVayttn8tIeQJxAd3zrxj7YY75qIP7GMuh5BIoV4bhgXA75kRdIFW36x3RLnevCYLDJBHfaaS8Jjltn42SJE2HaT8O5tZTSXDYCFMLavT7BQZOJpqu9tqk9bUMJY+1ZYcDYd16LCBxFul4O5KxkUzlxETJtniRgk3jCh3QmPQtDZVhGqCrKZQ2M7Bdz+Ii9SVsOyTxZkg3nnrNPxEOxZBsIoEgycqiFxIUQBFsRd0i4jkLHSUjLlCCYGUYruwSAf3L6qpiCG01I1UQ6SUzrqtHccHwHeljCXXzmkNBy5bukBFvenjisyQk9yyBygcAlvYe+KoCPX2CU3xEn89iIX5d0viAVVHa4Rcvs8QhHyVYK0g2EjgRAYE5SpsgibfDeDch1jXmziZ63hruncRD2XSszqk6zUtCdt2cOsOEaDBAlPiInzkUjuPIne8TyaysZAzEDsPqqHwakE1Byj1froL/gEI3yFYBKYIIRSCjj1dLEiHLpHwUnyIQwU+Ye4QcfQGF8Y4Ja5ZI3T/seSVgnU/x06nkzQozyJBX0CNZM1Oq9kijWMVkprZUA3sycsrlKKIefQMjiHaIzBYYlfKoeX/QDaM4EQYQNhR+t5D+vBzADpTKRnIsPBYSCgy8jcsVBBDQRIXoYS07rHyjVHE5gfTIgDXhQci7KpZRlSzYnlOn0FaTAB8qks1Ipi6sW312dJmMVBjN1iMr6jIjJbUk4lNqh+Z9okx/LhFFLepxqkR5QvvjJFkc7bfSpa5Vvyh/7DEhEWURn8VzmIV+GBe9rAoQRZJCKQmQcDxQggnP8DHeSXwxiWC11ypiGauCZLHsp6udhDBcIqT2UdRZC7qq6RiasDQYn6t8o+ngO8WskHm7m33ZfDCKVYiHhVDsA9dTk+CTJ2lSgLDmvCAnDZWW9kWPBbroXHwbtuZctu/Gt+bemoFw0JaBXU4Y+IiP4OhjG4Yu+n8mOlAmcO7cO55OYQ9jkpeTfd3Nxgeql+0nXXGQ5r4LKeYH416417tlO6DxFOS49iDiofXCWHKGvMuZ5OeM+BAIM6PvQjKl1IEnoR1RgJz4k20I+zJyCXa4AMJEmrwEh5RAm8plxZkvBdYZZMyn5CZdtCl+Pa4BOJUgI+LEKJaYheFavmbIN1In1I/y22LJ3CamZ5pRgKl8UyTnbVtZ41rUEVI4T1EiheqO8Xi1M9AyqchuCWhtaQRVBE0wboPceOptvtJTNDFBBim0u8BLiBoFYu3HgptFPrRW8hUtSIHbIFkBzAEFtRuqhMpjwuK3hqF/mlV1PRFMNEydp2FtGJRTRdZbY4/zeLmkrmkqqi1UossMQ/EKhKausWtdA41jGka3TaJJM4PLHCQuLAZug8ZZA+Ia+6hSPKET+hENvDcQKiUe7f3dzJx93fk9kyxMzmBueS3P4SYooYc1CjvJfG3AkTk8Ml1lmlakvzmK7ViW8G333IgXUqZA80WJPBAEUgpoDo+NZUHbsAz0s2OqPqEbvZMMEM6mS01THRkbl2LygtFtHdMwS2cWXm5ILkC0CYhvMkJqCRRMdiaC+fIIhbvYMwLIft11YiBWwpwuKJAw0PF1ziesiPxHmeZDCapvCOemkhEooLSCC9RgSCHxu/IWuQcCKv8Zc4grKAibmHkPyBEjPM83lT0LUVIVS2w851QsclHB6ROzf9bP7AQf2ZnnxvrZ1GtRsmOs+WeXhS34rHc52t7wKjF7KNXvoNJ1EzVg6jCBX9uT/HzwkTT3P/VnHNphbUkhDDvisE6hxhSxnZ4tEhPnn8ZpBXzJSyLVPPuzu09gC4TrM73B7tvJ02lr3LtBHQMyUiDbBRD2rCR7dXqoOBzCV7Te+cl42p2Yaa+OOGPNlD+ZHZKwFEiEoLjAR4/Oi5jO0dNXMlnIHUv5uYYEq8xBzxRk3z+6Z8E4vNT3OjJgPWb0xNHsMQ3tynJRa3Ywdt6529R38T2luQdjKuEaznqXsKRrnNMYczI4DxEyMZomiy9BtFKkdkGRhuQeRUlMTOcSRp6HAm1lFYh957WZSSdZUjIRNA0ANIkQLRsyAEcTCRVIBqEsC9SNJjynWPCbRbgLF5J8hS8jtOcmKjV5WBhoOkOFb1mKUd8JdAWi+HDySFk4SQKdHhyn/DKZItUtT4YUJy2mIM6cZ5aAXAvigbuVFcWFhbIb6ReHMmgt6cfpAkKF0hVQ1d/BtchhrO7JMTuVrDcTQLOAQHtzFc1JcByNVoJj7OJ1wUBAjlBZFIwcEB/AEtYc6eWXywVESBCKRIdXGlnNM0bcEqTXleI7WsUAYF5nTQnuiiVcMM1L24qpXCWyb8vAOxYoiJahI9kZErDASJy0Bz/gk8AutxomZYkgOo6O+W7/4TSVohTav4POnphkW96MRyOExJOyudUcFa3xE/FyAwKlWNosMdvUGOsE/bgQjOvssnO4zHtc7gSMODpDsWe+n+YNouYwc9//YXu65wKHQx6u5Q+vwJzRQsiYJyfHrWbfoXacMjMdu+a9TgtmbbxDPotdOWjJeoK1h17kt+BVKYF4ReAs22e0ZNgHO3EXKNYOEKsigQvHrsaKle79PbNger0gI7482kI4uKAdKuyAZP0MhejTYeEHaQdv0WiTa4/rdbqTy1jypfQh0eli6JR0QHhFvdx4y8A26/rKlnKPxRyPHVeclJyI21UAcc8KIadB1Tonqs/vddBGoRd5g8sFDxfnofgsaG/iRIrXDdkfzO2MWqiH3et1Ru9zNeli0MTtXx8LbBsel6wlVVHblJA1nYzRuz5JLlD0epUv7cD4wwMcRwWJpQHaG4zINuQSLTq6bEmrvdwoc5bjoHN7fAyPx8S3Xa6ICHUpI8aBE/gD5o0BgeBQuSxz4p6Y7WTO5tWpTQjtXXs2PuhEvRwoI7ixsmnRHzTrTj99c76TrVt2+GH5USKCGqoueffY+mgsrvFJCxpBDfeH04mESmiveydaq4J2ZqPFYZtm6+yWgk2lsT2TPRALGbRJ4w67+JxU1zmgOAvs8tabuTfZEkfHri6u8X/dfgvlLEWhd9CTCmzezR2y89ry0u5xAXfupzLXV5e7QWNRRIS0HvNlXclljKvpYVd+LM3xlN5YUxeLGIHChOk1LmTkxcQLCYpD+aoy11ntxau0OKfybBWogeJoMIotG/JswLKTwTAr50Sse8NxJRDX3aRE34khXEadoJZlCFZ+0NoELr01b06uY0RckTh6shvpeBnLu3vj1kAPsRPli8SJ7qHpJdw/Se6qNJa3DFgfqN8jw9x0Pty3vSmBb20498rofdysE83J043NWKKxqJhuJ6ztfWfHBlTPWMHjNPI2t1eK3fy5PGlprsA7kNFmJ2VbLNl3RdCmNbA9SpBkDFjEcuEXcROIMFov1I3M2VcvW9RO8bj5hBf/0odNHXV9K3dkXtrO6XAh9JRsozLQx/mVBTje95ZYHxLKwbLHL5FsMjAEoJAW1GxPrd34ZG0VqtYHVgcISYJPHpQ7fgqqdqxLr6ve9BRiLpiCFBXrzgmZtW5CRHyFqA1YF8I9+v33ucTEykWlj5ET59lH1jBC4zJrXN+IvzychTHQeRk+BIECQtXEVoHdGxqj4j05dqqntR5Y5DhAiaKXtslt028MdCda+M5fj5RzYO6H1jWu3CfWlWUsyCThdD1W1NWoaVvrdn4vYSKQnKbTuW7lLFLCDLUV/SLnoIAOzJQRH7seocKeVUwhOiNXrlzRgdONXrKqcC6wDXLB2pQGeWO2KgZAMrMIInxHOCBNKMUmpBfIOGB+XJ5MaTlzXKKEXshplvQkSOVAqbTJyP3JHGS0yaIU86z1KJJDFvLp39eeMLqtQKP40Iz/4Z03/WACFxfw/m8+P/DrL/ANz4T2ezx/qbn+/+tf+Pa1TtGf3Ne+NF//2fKB/ff9Fsch6cCSj79qvuL/WPCFrUqwf+vY4k984Kr5yk+2r8+963/87HGfhudp/veiL8jHD4wd6b3z7CDwe+RAvowFW+AqYtAMcSzXbHzxc7aa9vYV6La1la1k4DTSzIyADmGK/u81x/x+bNqYa2ubjNPb22tefJGWHtLyH30HrMmLGXm2lvzDCenwJcMiONUbl8zST8zUHCkSGlGiME3mGPD2xSY7VKx7T09cFZMXmO0TmbZw1dvKoobQFK3Y7RiPWR3b02udVee8U93947FZj0O2kuYYSrOD3UsSE0vcCZ3KH6QJBoQCl2MoI1X+mfUxNisgPsUdAgoZHzkWgo06ofonz+xN+RktfVvfeeCiB4p3wH6LxDYvfP/F1rlj7OKxdyy+esriKVefNpOYYsMu52Ery/j51Tufznl+871dXdx1DV/zzbo6bu0gtfhCpjYlvvEmkdZXsHBGHzPw6NRbUtYZNhT51XmD+SsfdggRIPCT5KEDuvBjstaJ1sfJUOSBhhw8FkK+u6AWRJ4vrHW0h5Dvz0cuhCwtOfig09e9RwrUBxrymNQudBDIsIMGp9VHELyCHWTPHZiObFknpcJaxRYHO9RXHHDYr5iC/oolFgPbzpiv9sR/kmiKg5NvRRTFAVg7FjdJpU3LI65yOXimxwTo/f31FVWsaoXpAgrwGzeCobARbSbq21iLksTiRs+TP5w4gSGfH4/BoSUeTYmxv7cP/d9+YBSWURAAi0xUpdX/ZIMtmTl9+3I2r3QLXO2V4OWRlqQxUeJWQe2dUxBXFxNTt7CKVV1ozl6aAA2Tfs4krmNhoCFSO+mAPv4gzUqNf6PnN/l3fvQLmo8x9F5k8kw/6/WEsmq4l7kREYODQ4NA533zulbTXYc1AImCfddq1qyt+jQIfgRjmyY+2ysrPjbVaMkOZ1meP6/9LgRp90TNNEjzeqOTHbfOgfXdf+w/++rky2lZX+zf2ADfncJ6tPx+rWrsPIUyoXasNugBsbZ29wQC8zNGksGQxGj6iTs2xv2pqIljGP6zWchrSmIYDHpUslQQy+fHCqR9EZd4nrRU0OeIxI0HPCojqYn709jYZi6VUBNNAoaev09ALbCS5q62Hn+BqxpdHW+JH+1UWVTA6y4TWmrTseDw3hI8lrz2hrvLFomNl46s/I8lZSsKmtkGRn1oaUixSmn94Oid9YriOuYsdXCml8DjycxHroMvrCoMKQotYdazDIZCtoIl/U8lxlX/PbVAtYwST1mmQt/5+cq5ruvPGCsjkuTltHJqsV+GWGc9eQmKc4Ig4chDouvCcWkJNAcncFLLi5IRahGtokyWFFFpvL0e2C/GkHm0YkqwK4bMpdvn4LX4RQRXJaWYFkiuJAdip1C6Ev4NtCeHkNFWYCyGbh8oDiRQ9G74floGpZgupfdTuEch4PB9msgPD6A7bpidpF4/TJw76SGOJ1hcVrE2PHskt6/P0+t6QMC1iJ7KSgIc4YlA3Di8Yhl0h4PZAfX4FcS8ol/XX1fXuf8oyZnh9evQa+htPKA0k39BpTMJ6YkkOoPGrbha3EmT3V1jYxf9/C+OWbpe2svLegpEfhxxSNXKyogviM+GzMPmUi0n4ImjUqlQWBNUSpRPqbRmPg0zT5pLJ4BvxjwkDCbBROLkp6lrsnTjxOTXiq6J0k0Oe/18w3p3OmpfsHfedsDbp68V+Po55ZzMI777tKekiFRboDiKd1j+aa7G0enJeWwXWzg/1XCwPHWBkD24vP0dGP+zMfmCNzn375UGl/c1bHRy6MSEXJGa9m/pY632eCALuC3lLSDkx8bQRtC4snGoQbtSe3rF0MohDKfMBbQh9xtpDTRQgCnOgGcsX+Yj2orBBtAIrB/ZQLQbBGF3mTgEjg5+eL8RLSCeQpxpbtDGDe3KDWoHPwf1BmV7+2oc4oL+HJNqWrV6tRYPur96mpSk4vivKn9Zw8cBppvothfGsJz0qx1DuWBLF2GSqak1e4zqO36Zhzs24gl0n7i2c+/H8p2kqlUOnbS3Z7c19MR5qqCRgsfOX6AK6IvzSx0gd5eJYCaasHuyGta/399MGxt1KQ1Ze7Amopkg0szaC5vH195xu1Ncm4X2s6kGujCbMLPw84HJ9O1y9ChnK4Vj4lC27iSzmjHaRI51XUSG5i0yzFRp41Fbu0L1IVG2ibJJPwu/QjtbEuYzArHdzICNUAjZg9gVOghVCGdZv1Ej94GSYnCfYJY/Gdn5d394Og/hmp8r7COPBNnN5d8oQsp9U83yX1IcpvqTfEnI+VolNt1uAIPlYzH9P1M2CTb58tp5DV1hVXMER1gh+QWCY3zk3Mv3UIlEKl3EVe5x7Fl0NPqYsCWlRajHX4QdNTUaAzyAMrAlxRIEbBV8P0Y5ZohvADM74QtM/upYfLGf/mWpS67LQfgieHOxi/2OLc9dHlEeGl0U7mjz0m8jvlgdq8r5H5tzijyejf1/6JBgyG+3nHSA5EMa4g/r7QdFAT98mD+04wdEENaMzR4lj2ZjrcWgIGsxwUxYTIQy8Z1wNSfRRQlyVYgo8JRC4v1M4NrfdQF1Pf71AfU9m+r8n8xPBmazqfeF+cu66uuIZteJYRsH0b43DB59xp3mMuTmEoaFUWKWf+IlPLrOrEGeWI1Zt7TTUYO32HXYQp86kAUvBdHV3f99TNSD6e2vNxUhdt1sf3Wnvi1n6HracRVWfrBstN3bZ+fXt01t1ZU/XD4Kk6w65Xy73qhctEwUEeWk83/P1nUn5wMNr1hXOIzfUzFe/CZQoA6e06YgMdq0fqZYUuunTzNOD2h6Zq70nmkFdtyEm2fuIzkE6p8w0bVmLX1az50SxvEFEsG0oBXG8YXKu8yuyC5laYokrsXOtoPUYWtnZBiUzK6ILgWqIIljwcsYMrzrEigQfggvZUrxJ9D7qjunVqxXANxvoTW8NVGWkJA1psljHFfgdHlcJMEeAIjMBs4BDUAnq729TSQytm9L5FjB+N38go6OniMSHfcRH/v812tGwMqYKvIE2fwVK/jZgrzLufn87BUrsvl5gsuYiuU1NblBWQEBWUG5dyWui84KyA2665gU1M2vhMNh8MrKsnIDpJEW7LOGgtTN7s179b1aj+zaHaz8tk24253kC45+EzA5cfToPR37/YBT0HjY+/+6lIcaiRi0Zm1YmFSRfUiBD5XnQy+IQ9QckxHcI0k6YXKEliwdBfLlu3WVzk7BAjXpOD4RwQjAqCFozEk1uTkAMXu7fNFtXJ7RpFo6fZ9CWV8JszJZn6iKkOI4Qi67sUybpwsDD5z/tlOQQMj0P59BM+/3gjWwScdPe7Xx1WmN415pemV8/toMYXUkrTwQoCKLtlLgDGWMoMiwNP4MGUrLfNS+Fc/v9XwB/lJcnhu216V3Z6tahw+a9g/ptGbvvnmv9P5bcONli7ftzF07/Mbm8Jz9bxh37ZSTadnFfW+qWP3oo5WVq1e99NKe3fWLO5dnpOKStG+yX4vod2M/7FuDZmd98WkWIPrd0A93hcoMzVZPqs4O7YKbYfIDXlB9qjTo638FKaWxdeGKCqxJ3FyY+gUaPiOacUpxlDlSGmM9uDKQLJRIhCkwGVcUK7RDHJ73HwcjlzY3SViqI6bq7tStW+rEW7en7qrVU1Oz9+YLd292aipRDehPmLJ2xS5oVW9z2O0/HCzftStR3d+fEn1KfNZtsKniN/K5iFNLNuxLL6spGiwsHDhVOLhVGNf4pvmI03w1ZyJKPMXrX0IPLfIERCd/qvdsD/X0cI9e+VkYu71FRWBBk1fyRBxHWUZuV7N+l3BCijUHpQyclpoczLcuPP8RHoFNBvewDkc06DDq5tcKIP/BNZwwAQBIAqJbfaY4/0FMTMXbarYcom3b1wQ/TqK9vXlYGnCICRfcdrf2iFkDaPIOm5qiw45lj+6aQqrOLN++b/bel1xq8g6bmlQzLn5j86qBY3cvaj3zzHVN6848s3XR7rFQKGohvXby+bPP0VsghsqjxLWFWAwxjQSIqMv2wIG6prnVf2Ie+CgtLFlUunLU/H5LTv0waGHLQbf84NSb+DCvXJRdOMR7LIDxh1t9UbM7i7pjCH80P+YrjJoXO+2DAHy7MP4uHwxSnIgkJjR7YOBHdWQ+gI+0t0+vAR6X7Kga27AtO/s549RFjBETxPG/W/eYPa4fc8dGggxIokxJaulQnwvmj5o1VROU9DFpMvIMsbF9PkbAIqWz7AImjpJAofi7BJICyAsigwYM74g2uDQhtBe1uxOxZWXYt2x9lmZiyTDZqRWaY4hBelKdkkDRnF7TxV3f5Jp6KGTrdl47a07+br+meM/dd51UVDP7sC9GH0nffFOjfj5y1BfFKnOl1hxE3ZVKXqJWL+mVuDr6JDPqdsnmCkG9EsGrS+9/cw2E9HSC4fB6cZq3byo8P/P9nB78iJMUgyXXdMWUWFMkTl++onRxsDgAFCnpnifCT3iGH+w5fJp7ksLlwf4s7y8Id/0cleaLYD0mdqMPM4fKqumMCg2oz6O77qc4uWNYxoY+lKpSnj7AklfPNXcH4IlBMdGBvq7XSuuhYjHA73Ct23/b5PHvj3XkKQ9e+h44lerLK84RrLmQAYY8BXfXl4n7XMiJLkKwBu+dT17kQfp+PPAywD9fX5zs6pq8mJhIowYFUWlZM1cuq9WXr2QKaVS1+uLFu9jPrFZTaVlpuOOXlNTeXjg8NXVkN2CAIRlfg2atGbSOlFq4YbmHzf6Mlim2PAYowHfMKKXwSJDx3NAVhDF66uwxJimR0xSTBulQFCSxaynhkNICoCtQ5jIi74BPIBlDGYfM5/4cEoJEKiAq6KhCTiSIEgNBF1xrrYm0Unr8XTIMgjC3DrBxu0WtwKbpLVEY+VWwQaCBIrqHkxaVKooj71GRUJESGM2D/Me+1sywcuPWGMMQk1kZRK0nFwUYh2MWJsQQarVVkY6Z4g2US8Ol6XkRqxjQwuzQl7KxDUyYP0mzAlVj3LlT+4Xj1NU+b7DGUMdzBKBgIzX73ErZeshG6Hcy87OR6fQfdsH0kgxBAoMCibjR0P28MGKovA2khDJhiCPGb5Mw5Asm7NkwYczIWBWABOqQ8RVhmB0qWV+2rsTaesWwTaJ8hii/n7nsxnWCvQ7S4ecrWVe2vgRMl9U2oIS/8siwRJL8s4yweT6g7p6eTz/55BJEt9dQMeTVV4fUflRXB0G3SIQG6fY+qt4Lg1lnPzaxct//PzN+cq8D2kSCGC8pjiS25caiALOaK/fbmKmdtuy4gYjFEysXDEBXoUVr6UptWKEQ7vd9ACqlhLRyYzfoZmbRaU2H/Ie1zMC8zIEJKKACJElAZOxawv3tdxBHzBDHViBbeHGbfm611JUuRuiiiFBibDIzX8bXzBoEWUtIGva5RPZbcW0vEga4ZN6k2Msn/AMz6qzJz7Lr5r90B8r8gzIyAwPK9uv+kgXRng4fMpZuxG4sMf568FnAs4O/Gksu5lLj5I8TVxiLM/iVCe4+Yw4x4le9oV5ewbAwlMWMDkYMPgrpHIjIFrBJ0DXA3LFCdo75V1ef1Cb/ZUqFCcY2Tk1NyHMmLrnUY+Xf47n4sr4ObGOv2RRKfP7IkcJh+S+BzN9Wtz5PXzLTGmjtcuMMk5aFzGJpUYJraxlHvjDiEk/xWqmnuJ5bGF+0/1T9+GygZPHKv+v/XulUM1qzeHrxaN1UkJawLO6fsosG+Hyc7Jqc0lDCjiPD/ykYj6YhC0+jn5bIY/IZ+RQNEPhx3b0/JD1BWq9mNVOvK8rUJTF9WuB6eOYLl2rnhTq5VCZdpKtydnkBz4Rpf86cyszRl2Trk5mezbB0mP6eyyb+e/PKpHLpQl21M2dy7slVhNhgZEymgaiBkH9dgKv/eRQJaYiGzBhUMD52P6h0beiPFzTNa5wriO/fHeNd5MJvqShv5d+4bqmQRDOCn2EzduzZwW8tr2jlcdNo3HNS+gkp+vnY/v9RXjgc6v9r7b5JUSfWkgyZZRnUU1BdM0DDT8+dL78s8rv4r11nfuJQxAXp0iCi0WSeBqUkAJFcFZMgwZGxdchPNB4AHD8woH/d9tH7bBn04TYYurX1weFe5ncgqWYgJxyXaqHuAV7mHxYbB/4rUrY2rjaMPHAYu90ejWMRUe0WUC0Sb8y98KK1mu2SVXJH++ga0+OK6njhRSJxBM0AmA7QMJ9zO8X9Gl9vd3wV7aza6f/rVn8xL92ZSCfaCxBJBHNXgdBCdSzUgQ4WGiPMJ9rlVWuFWnki4CgnSHSioszTtPO6GqInD83lN3HavHdbUJXqn3/2r6q63oJ3c3peuBp/SUUrVVsEVPtVaDa6PnSWYDPv+dsh7Wb70g0OG7YIoj1DlrSOl2nrD1Xq5EBGEVtKR77alzgmWYBWdSZ19c/g5UsJhKVeBSOiuiav/PnsM7zdWaFpFkvNtKXan5hW1pipuwSlR37sGiO4ulKLd5gIyu+SMesAlOSRqt5Ucxy2S+9P4Vl3GCafo+fopJHyqH2+uaQsoiokPlSoq6JxUlvn9abudv6Ntz43SPbjBPp7u77IR+7WxgSLMrDtw/jHQ40LpeQoRSr78WDkV+bzF72Hyy60yd2KfDTKiASWhB4mkXz4uoi55iVidlxtuFamyCZ2HGsTPpYgZ9Wy/Ykl8GYwtnXFuImiDn/G5p5WON+Ij30OCUgKSSBArs9AobneOQxYdDFY+9kMZq/w76kLYeD6Si1YRBFJSo2wYmhOpCnppzsUyGaD3bpZYzO7PDABgKpUzYFVd7vOQNCWY53Fk6jetWlE9K85Ie2vZGws8ji8cyXD8ldU9Qwz0Eg/c+MQON7eH/1iKyi3vGg6WD3Y7NpPyaw4tahKE3xEMGkZxf2b+Px9+za1tWVL/dHmH1rTW1p90oHtq9f5gMsTsFzbbVa6mYdco8Ku0iJoV+mcC2u/ZHStiq6Zv9jl0WOXewf7VWadwgb+jHYNeCVKosuZ0NdNEPRaFesre6wAARqDDm+HUriS0vZbIMgY+qfevP6zesKCEGjMeaeWF4zx5lU86sYYHUJGz9AgQNhZ8X1YsXNDwznlFxzVa9qqihcqV03FVYu1Y6+yoFNgqBad6zFkElM2/bGmx6ZDm5c2h/UhGT0sdJlgMAr3+Vt/zukORWmcUqQee1MH8hX1HMH2iwfnlg/mli1bvswUd7blQO8uJxCEfdpLdnsD+q1ymweULCpb+POz5Wr3oTWtWuhQMxovRbRO2gonVwQ5xsKyRft2+j5+s5YOr9+90LjNBx43J7vlmmefE6WTq6dtmL9P/RlFn7WeN/nachj1y9qvFz/5zYTYMaFEBBT5LW+h/39Yz23GddNKp8FRWiAK7/tJcDz38F8TJh62Z0rn2Ov3PvOsluvHdE7bffiKC/pd33D5Q9+h472AULmUNqx0dil0vT8wQmkbY65Tqpz8vLn42YAzqnZCuZF6exB7/q7rYP+JTWyr3thfeXciJWRwBmhaJUoE5iEGwLNQxglMs8xBZGEn7rs1suVkd7rJbLGJBcwai4SlHRH6TER2lchOJQYgzp1N+266oIbftXUKofqib4cNPefKYVcNO+vO0q3lg6ZePVLFO1w/juicMqh8aPacq4ZfOfysx4pM5QMbOkdsjnaUB7tp5NWNA3OrUAdCakxC7cgQQZVq1jYSnhBcWLOgQKXCOs1EKtBSZ31GLa0KoGrtScNCEc69py4kNCNTn/zrB89/kOV2Yf1ryDTWHnhAY1vm4Dlz95sy2ITm4CE5tXrm+uqnQ1cP0jd6sIFCUQ9wkcJ6arGxWSabUuE3BLk1WY1KaisZAx1abRUyEXJ10rPPaZkfTqCXj1dOGiSUpsu+ThUsB+0LX1CoWih2bouHhSJ5Yq/wxNE39I5rMAwck9ZChK7EaNChtkE8X+TQvvhqfN1stM7+r7DDkoRLotbX3fjPIRc9Pm35wHQIIHaOlQb4TsAf4s2B8VWEiJ2hGH4Ee5ikAMLZ4TQB/NkLnseveaRk0/GjgLlCq6DfpG8N2ZOie3Pa3mNT2kXaF8EP8lYJ4Fu3cwwwN3CDNjoYbt2hI8orontiW56gfT0nsIqD0EdZTaRHK/3TR2xp5w0w6qPW1TbwfdxbTaURXQH1jR/ORR4STDn92mBLpBCS3BGTJNbNf8gHq5l/whLAACDNG//OdzAc/hpi9aJrCh1LEiSupLWPhnDA50N1XIxC0kN+e1f19kTCCSca/CZQqyW0tM4vKbXI2xX2ObDllpZewRwtiFhSKiCtX8V/acue+EFp5yITaJHtrtFtnalJCbVJXmXjrC3Z28FXoV8T0gC5gbsUwK8Zhrh1nXzloeRjgQAEgL+V57/mePKfBRIA/I6uVgCdsdaEutA/E4UAG/13LM9bIOGxljq7LnBuAPrPkjXlWSFc5vwG3uc3so/scVnyrdvI0Po/uh3TCEAr/EmgVsgr3S/5fX3X+8cBqb71erdsiLvRjpJt2WBya5O30TEoMW5IAHD2lWUAkABcuTLgn4R7n8w+5JVntkEAJsD7QnopQnnZQnuFu2xgDz67LMBA2C5X4CH2zq+BpBoCYL1sAfDCuLMLDHCwU4B79wgI73EB6b20CwqczeyCBhy82cUOdAHrtQd+bJT8GEUw9IfpdiAnPAtLizof+zcuJYDCj6n+R80kfHh/eRsN/4qMOn2WfF4+zObDrBIPvxzcOwxBDknliM5eVrP09fV1jjX84iR+86MiGPrDdJsdlJzwDOO9UYNaf+NSAmTaqAS1/Y96poOrdnh/eUsLv1LmlFRgzuflgwybD72hEpfqL4VIcANySPFaR3T2smYY6esrTTRz6UttSnyGpfe1Ndr50RwBgRACiUJjfpjwN2nj4OLhBxBhQhkXUmljnQ/CKE7SLC/Kqm7arh/GaV7WbT/O637e78fi8AQiiUyh0ugMJovN4fL4AuEvstIkUpn+o1AoVWqNVqc3GE1mi9Vmdzhdbo/X5w8EQ+FINBZPJFPpTDaXLxRL5Uq1Vm80W+1Ot9cfDEfjyXQ2XyxX6812tz8cT+fL9XZ/PF9v7x/22b0nWFgy/ig8k8ZBiv0mOZFB6ImJH09C6yTd/sWrVRH01CTFM+FlB96TkTCEH/0aqX0BvpUv9xV5uRIvc6Ess2k0J6DFx9RHinD6NS/v27zS8Y6Rwf5Oc7kMDVeCECDSXKNAQ+aALpWXC39X0vhJ0HBrWZAC69cLWYH7XGorE4EMN4whAd5spbnBBY1YF4ULc17L/k7eZDc6B49+KFShJ3vwGNBwFo1OQoncBkI62vtjBgD5nhWE74HHC/LxnQIH/cD1vdhoR43cgPLILMrHGGCm8oMDxGMTHjKLlpPwYld27ihMz73szzBl8nly9ASUxrulO3Jf7KQ0LOZt73SkZ5M8AcjHuSD+vNHdDQZANozfuwO+ryCQWwQO9YQLSz/As4tEdoeIdCwGcsZI7aWkLoHCopDW6iLqN7NCxDGbAi2r/UWMG1CVy/cJuXakLmA/qZyQ8flNknBbhLeB3xJ0wn9XlbKsPV6TYs4kXH+qE4+DF2eioh61nkAWkG4tEXgSf6synLEzBc6l199cQLnBPRW5OIc5V8SztJ8Fs5HwBlVF67tIJG5+qkqxepbgUTfKb14VcLbmWIJWnW+1QzbUwRN3hVMx9I1J8s7sJzGT+FgyoKih8Y7jkDYcwpDuF7+Hxh98CA0AeYf6C6KFigsTiTbgiYNBq5dDEqrd+pwCmcMQcp9gQS5xQu0g0MIR2bpsWpwVxWYCwa1WGV6t7easy4Fk8JuqW+GMoixWE3hwijMqssMqEJ9at6I7TXKtPBh2Wg1YVEpqMGAqkDByZHQXMNSBQa7e5LoypoZcSUIekxLbcIGYhSWkgz3gDFdU0QvcQnX3A2KEFXzHeQWPPXFGtUCM4yN7KmbCwxn4T5qwnRWckfD+BMlkTYpwevwomimgEzahzLLKJTsIOChmE60G3XFYyXtkXLK54MRjweAkpoDXp2PfEJEosirDbE+EhyI4lVf1sRMww4hQWHd0ET1F8Rj6iLpgdVn6GXnkJbkoeXEN7VfySAah0MMKlPGGeIalkQ97ReJsQDDjlg3jjikLow+9MkWsM4K6tXKgvkY2sttIMYna36jvdaPgSXpUieFtdSMkY+cCAgtAfh7+WWfHISdBtFJgDo5WO2CHoSv6Hwu5RtHJGbWaJPjvXbFtdquoXHYeMy2M9JcAeUNe04r0l9HmhG4FzQ8H3AIcexvqJtttEmTHDoM6zD3MJaFmp5SszsKLUTcLM7tdV9hfIBDjNkbSJFW+dNMM5fYBG8OKLpeJRAEZBHLfAAA="},function(e,t,n){"use strict";n.r(t),t.default="data:font/woff;base64,d09GRgABAAAAAEDsAAsAAAAAe9QAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAARAAAAGDErUpeY21hcAAAAYgAAAUoAAAMGjT7vjJnbHlmAAAGsAAAMXkAAF6cJbh0/WhlYWQAADgsAAAAMQAAADYigu90aGhlYQAAOGAAAAAgAAAAJAnXBjBobXR4AAA4gAAAAFUAAALAyCT/1WxvY2EAADjYAAABYgAAAWI6nCCibWF4cAAAOjwAAAAfAAAAIAHJAJhuYW1lAAA6XAAAAUMAAAJb6ej1SHBvc3QAADugAAAFTAAACK3aH0GUeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGHhYZzAwMrAwNTJdIaBgaEfQjO+ZjBi5ACKMrAyM2AFAWmuKQwH8iY8b2Ju+N/AwMB8h6EDKMyIoogJAHh9DQ94nNXW+dOVcxzG8fcJj7KVpU1JJJJkKSTJXnrad7JkKUKS7EXIvu8ka0RKkW2aMWMwaJrs+z7jp+s7dprxM9f3XP4Evzj3vJ45537mfOe+z/39fK4PsBmwifWzTf12Aw2/o83bPttont+ELZrnN22z2J9bOdzf2WLOneqkruquXuqjvhqowZquxVqqZVqulVqtV7RWr+lNrdN6fS9po/4q7UqH0rkML1PLzDK7zC0Ly6K//wav1VFd1E091Ntr9dMgDfFaS5prrdAqrWmu9bre8lobvNaPXqultG+uNaLMKLPKnDIva/1Hr4bvs5VRjGEc0zjFx1wu5FUf65vHBt7ji+bxDT/wQ6PFRxcfPRo9m8eQxtDGsEZr4zSvNZv7eYDFPMgSHuJhHuFRHuNxlvIET7KMp3ia5TzDClbyLKtYzXM8z+3cxcmcxIkcxx2c4Ks4nqlMYjJTfFVjfV3jmcBEX+NoRvhaRzKcYxnGERzJURzNMX5OhzGUQxnCYO7mHu5luu/jVE7jdM5mBjM5gzOZxcFcwFm+u4u4k4u5hHM4lzmc5zu+lPO5jPksYH/243IGMJADOJBDuIKFHMSVXMXVDGIR13At13E9+3IDN3ITN9ONW7iVedzGjmzuHdPi3dWmuaf2Yk96szv9vbf2YQ/60Jfd2JW96cUu3MfO9KQ7O9GDLnRle3agI53ozLZsRwfasSVbsTXb+F1778y2flgt/9lz//++tqp/2o7799OaWlXh/Yc6hnci6hTek6hLeHeiruF9irqFdyzqHt67qEd4F6Odw/sZ9QzvbLRLeI+jXcO7HfUK73vUO1wBaPdwLaA9wlWB+oTrA/UNVwrqF64ZtHe4elD/cB2hfcIVhfYN1xbaL1xlaP9wvaEB4cpDA8M1iAaFqxEdHK5LNDhcoWhIuFbRoeGqRUPD9YsOC1cyOjxc0+iIcHWjI8N1jo4KVzw6Olz76JhwF0DDwv0ADQ93BnRsuEegEeFugVrDfQONDHcQNCrcS9DooJ4bE9RzY4O63rigrjc+qOtNCOq1TAzqtUwK6vVODup9TwnqfU8N6n0fF9T7Pj6o9z0tqL/fCUH9XU8M6u99UlCfw8lBfT7Tg/rcFod7IloS7o7ooXCfRA8H9XuPhHsnejTcRdFj4X6KHg93VrQ03GPRsnC3RcvDfRetCHdgtDLci9GqcFdGq4O679aEOzV6Idyz0Yvh7o1eCvdx9HK4o6NXwr0drQ13efRauN+j18OdH70RzgD0ZjgN0FvhXEBvhxMCvRPOCrQunBpofTg/0IZwkqB3g1p/7wW1Lt8P5wz6IKh1+WFQ6/KjcAqhj8N5hD4JJxP6NJxR6LNwWqHPw7mFvggnGPoynGXoq3Cqoa+D2gO+CScd+jaceei7cPqh78M5iBRORPRjUPvQT+GURD+H8xL9Ek5O9Gs4Q9FvQe3Hv4dzFf0RTlj0Zzhr0cZw6qK/wvlLaQknMeVfdfIrbYP6/3ZRp8DSPpzYlA5Rp8TSOepkWIaH85wyIpzslNZwxlNGhtOeMiqc+5TRUafOMiY8C1DGhqcCyrjwfEAZH54UKBPCMwNlYnh6oEwKzxGUyeGJgjIlPFtQpoanDMqM8LxBmRmePCizwjMI5azwNEI5OzyXUM4JTyiU2eFZhTInPLVQzgvPL5S54UmGMi8801AuCOrvemF4zqFcFJ54KBcH9TlcEtRndWl4HqJcFnUKKPPDMxJlQXhaolweze9eEdTnvDDqlF8WBW3/AeYu0Mt4nL18CXgbx3noziyAJW7iJkgCJAgsQIoSLwAEdZGyomtpiZZl64glO7JkW0eNjaxYPnKJdhxHdhI1BuPEtnLUqfzsSOmRvFciSZPGaWPHzKutNK3T5AF1nNckfkkaNUfz3DbcYf9/dgEsSPlQ+75HYndnZmdnZ/75579nBasgLEyLZXFasAs+ISREhasFgfiSvoQvEUr4SEQKSZlCJBNK5uVQIk+6SGGchrtodiTcRYI2qZ/0DBLJQ9ODVPKQQZrsSQ+S3OgEyY500cI4CYtlVVOJwEpiW+7n2U/kDn2tSie1WdItXpkRvcGAzdKedYco8bklxe8kKyy+UNAqbumzJlut46tqd1wOS2zM2h4TpzWVpuarqkXQ3pb7GcmeyR76/ORkSVHIWdsP3+Fwi1KLLQ9PuIOihzzgcFOH3fb903630zLhc9s8QUokS+wbre4WQRBsOHaLAGP3Ce1CXOgR0sIIjj7rS+YRAkkOgyxCIVNI5BMZK4AAwQDFeTGUDSUBLMl8Ni/KFbXCShVSYkKFXnPhQu5u9gUyeYL9cEEgwoJA1QUhpSiTiiJOswqrlkmKVZmg0gqRtaewunJiu6pWVBUGomK9SeXy+geJiDRI3lT/1uZOkD72t3fnLqhvpnvZEwpU3bqke4K13j87YE5cSAmZJtwxdYAEkqFMUkoG+O08kbKiinhR0cqiAs2qKqs82Dn8V0NqharKPLx37TvpRSaQkqaqoqpVVKVYVFTo/0x1ZoYq0C+VKgpTytAPC/TjJPTjHsEtdArLhDFBkAu2SNhDATsHSEa2eqiXJHsGaGE0Q0biVLJJVl9unMojcRIJ+eR0Jj1OSZHYAg6HXOiS8/vG7fQj5GjLql1Zt9xVkB2OVspODuzIub0rg+yBZdtupv4t79xqYQ8EV3rd+asfc65fFVub7Ry6Jv/bgyNXD4skNrI2PjRGvrXsyr39n/m9W8jews3blpU23rnFw84eOvqZ/r1XLmuCX5sgC33Ciib4Qe9sEqCebYCOk0iPhwTjZGSc5AaIaMyzRVDnqxyIXbm3DrbE1yxbM3zXflm+cU1yTU/Pmk2rk8nVH2QlUtVmYeWUSUVfOY8V9h1eBnWTZNPx45vHoOKanuRqqE2GisWyqhowrfXNz+e2mSpwfMuYcUyf2ca0ttWxbO/Zs+oTT9BpmFeYU4UofE7ZKh2xyJfwrnqWqFqZCjW8+jC8uwArwC2EhS6hF9+esOYTPiv2QM6SkXDQ1pPOjSZqiWQtYRHYDHuIVcUSgCZKXAvaTLy/f21/P3mxi1+/Ctk1/f1iQSPnz9MFVfuHd76TbME7zT8YubDwIvSjXxAFSegWVgrXCnuEw8JdwgO8P7wzOEuRMGARoBsiWzqT9wE2JXhxF/EFL10MKOjhyAnk0lcYBUpJAI5i2uYloWA4GwYKms+lrY18YS0ZTUd4PgJogPczA8QizAviV+ZPiXdpoWCqs8VGSWtMzqRikkQglSL3BSHNS1MZ2bifIg5elxBCOzwylGNtInZ4UuzUhoedPgI01+mjxE9uMmVewTShvhBk4CL2z58Td23UcnS7p8Pv9rnYP4XSnR5Ie1udJBjKdHjeqNwpt7vrN1xy1O1hRzdsIFuIx2mb9/jgIs27AuRSWcnpwazN6REEurCACEvvEbyw/gWckaCHJBMA3tw4yYaaVo6w6cTGjSc2MeOa25PL7TmMJzq98cSHsAxO64wyOOn4yNv/LseDMKzUnGn+I4UILlLgEMAnC4nXzfLpOo9w0w7Z1rvW9nSvWJHoWeu+QiL90hV6vjuxOL/GdYVEX9R20XM7gSK+fYM33bGqLZttW9WR9m54vVwTjca+I5VZaer7KIcUkL9MOgdIONpEZKSRcAzYOOB20AaENL2W4OKCAcDCElOsuO/x669/vDy1dfnAwPKtU9evP3bFFcfuw9MtwY63+tvFjsADgc5OcXpe4GSKvkKu+/QX/+A6cWBg61Xlq7YODN5o1IfT1s7Au8M+KdjRETwX6GyiP9hvrxBo9NpOkshKSCQpZU39+TCRbs/9a/YEkeKW7U82XvsT7T2lEn3fp16Clszz6Gi0KEqZRkNrz53XgV1kQ2TtuXOAX7wvBPiLCLMv2EnETqw+ghM6OtJFwkEvCgh0N+vbRf6eXcsWKN310Vtv9Y/4p/3+W49+dCcdZP07yYvaeSuxkoWdD8M9/0m4feuRh3dBl8SmsZpGauagppE+cfGievFiY4RlzKoXgZVjYyotYI9lkqAC0NTUHEF63nTPXrtHC6ykj68K709Ce3Y+PoBxItNBKHDfj5M/IV9mHvbla+b/RezRdn+CzLG79hIXe5XP0YMAz28BLD3AJQA2AIhsPluXRWoHMoOXFc4MgGeL6nwJD9KbPaGWddmC+PVDMHD2YfHn4u8BNFoBY1cIeUEoIKsGepnIeoiX5IFejgDZDQeBkNp66gicCXmIlBwnMtROQu0Huu686t1flMUDt6c+d0fgqjvZU1dtXJ/p7c2s3/ipWuItV93Zdbv8RfIHUPF2qH9Rz7/7zv/eZ4M8tTXV5olnb9fbhVpQudZnXY7GOXQ2Y2xNLMNDLMPgBZBeSgsCq5JZNolHfTIJyGEzXKDV5+U9XK4ZF94NrSVtXorDAxGbpjM9Nhx6KIhQwP9xUsjngI/oKzZOEBz4n88hdKwgs3O2QYFzJEf0R0Icel6a4RQg2QNpAj/IIGPK5/QGaMW2cZm90xXxu6LtnoC/f8OK3fJEoqena9XKyaHB6FC36JCi7nBc7BrpGByaXLmqO9GTmJjUfjUYt4eiI5Mj0ZAv3u20tLXH2jLBUKwzO7zObiei25+UxyYyKa+VEkrsLRM3d8ZCwUxbvF2ctvssHissF5ujxWdvj/Zt3LL/xJ233XKTMuRrsXV3ONYP9/fffGW0K2V3tA5NHrz5tjvvuHHLxr7hos1lcbicTpdDcliI1NLavmJw06HDN71197qWFlsuuyGVGVp+TafbE4ab6z5/8MgtGwdXtLfaJUGH96ct2wHea4StsIISSACDNmAkQPvglPcldSq4muh3+nFic6PZ5oo+LCMJvWrtHnVRKZpMtWn/Fk2ys61hX5ucih6JpuQ2H8mnotSGSe3foyn2P0k+TZPaWzvTcow+Cc98IN15sL1XjjnDrfT9fe0HO9NY0PeKM9rHE+mYk33b195LfXAzJvMywEFh4bzlF4CPLuCJCVhBK4VJYQeMCiXhdAb7VsgmEFmwe1IyUcjmk4EIkQpESnSRkJdkpYRRcYIQXNC8br2wkLUmIjEqJcjR8PgPg3GxPSiJ6/sCkAhI7NuHPrr385/W/vbFPFl7lP0zCA7kxaPshF7N4n3q2FM5qPlHmsd4cFT7GaU0/KXQv8LTT+iN4OXIanrDp7Xv5P+OfPKoaFlusRyB2meDMZGQGDQyC7kV56NYBHUtUEHU6el9sBb3QcoOEqSAahvhQyug0AorkAY/wbZcyJEvnjlz+IxHVekLZ9iW7AVSPnPm0Blcz3a+nl8S19TXcwfIoUnQcPob67qQDGVlOIiJx2dqZcZVfGl+Az3ELhL/xVOntMdOnSL5YWXL0BZlSIHfL06dorfo5XgV18xvEL9ySPOdhz/yT0NYUa+7+vnnnycvnUN2ZOiFzzfRmghQSOAUuuLXfH3+ecvz87fcYjpvex5be/Sv4Y88hunFPGjcLN9GUGRFUuFFdSQMWeB5XWSCAG3Ijuh0xEttXPMfAKkVSEyDWWl/4w17k06Pz+YIWCzU5g6PdMNqk6gkWV2t7uhQb7jL7VuW6H3fmKuwo8Nu727wtVK4dSQcdbe6LNYWKtrcwa5s2GEVRYvX19Lqbk+FvKFOp7tjR8E1dl9vYpnbkdblhkctN8A4rACZIEg8wJMSxlh8gNgSmjKkDOdMP9hOB373h+T32U/Fovbv25/fvOPmXZvpfexR8eRfz78i/vhOzUETq57fcs0rP9u1hcp33mnWyZtgj9DCfwkhlvRlA/yNoQRdqX0TFJLj59l5spN889y54wCY0/M/EjvJr7XT9Dgex9lxcpodF09jneO3LX6HC3igPg6jzQwq+OYMhzZv9DQDIkbMWbKZrSTfPP6P5247Tv/RSB4/DvO9sAA6M8o0XsDrQZSawyGfTsPyPqBb1kSPDQrCQMBGoSBNgLUMoFDtwckPj4jnkyMjyflzeBb7NcEfjfpFPLMPPWq3OkJu9oI75LDaH3WlxOl6xV3JkZ1Rf6O2NveII9rm8bRFHY+4hSZZCOEKrDUAAwQpyJfl2AySkC+Zx7mUfVnIZ30lWgVmWdJScBZRpKmyr3yOXXtenK6VYg1IHSFfVxQ2gbwaxj5tw7H3C6uB0u8TbtW1BhR3a2cYu6FDrEXTgXEGSACHJfq9ODGAk9HzkUbBIuBZE83QtTwcG46FjAN+v/tuc96K1/l9LVGP+HS4CyvP7wX+wXN/Nr8u3NUVxmTX/MP0Z+Hu7rAWhrM43b68vds4tKfhZMrTdXACxXgbXDz+ziB52V9iWyFjcbViLvDJziDrDnZiOti5HzIv8wwU8Tn5rLgL5iQC0lgdV0BxGCTpHi/xEA6YUcD6YBjIAsrEMGwZ+GA6iZAQ+31RV7jN8aqr0/Wqoy3sivr6Ay3Peno8z7YEEGUdEuuRHOJ01D8/7Qo6qfTllpYvS9QZdInT/ig7z3qcdtvDDsfDNruTvLTzMcnhkMy6jQCrpFsYEtYJgg9gDp2D90KXrE0TqU8eIrYEHY3A3BRgbiQ0swBp60HqBfenRWF6WhOm6dPJ1T09q5NsWr+SaTYdlWlPlLwfLvI77D7JIh1ytDsOwdVnF/lD+PDTTQ/BdV1PlL3LeLRDftrpD8Bz8FjA70QtxDSGtDAqbBL2CrcIbxfuFO5ZNBqSNOCJmBVKGgsVUctqXGsoFjDhHj4RCaItLJ9FWi6BCIkUXcqlQX7JjozTjJEaLei6Roibe7MRSNWB8dyQx8EOOzweRxvHi+eCnWyPjiw64sB98qd4n213eM62eEPOtaOOloBHIlaLzW5tSXvsgYDFbrO6nZLLJTnfkxl+4PjqTPfKTANy7Hu8geccniFo+jA2Pc3b/1P+zjH2Mt4n3XD+qifsbfkLi5QOWCVK7ZLH53YNizb7tQ57uqXj0Udl+cytR/9i//6nAa5SE4w7hV5hOeDK2GLoLjIbIJ7oUAQYSslCQj/QxNTAkZf7J/vhx9bpV/I0W9c7NtZLnobzP6+eXk3WwWlBWB3HUtNA/6B/chc+Aad1Y9vH4Pc0/sEV+tjS1F+d+ncCfqcW9Rj5mgw8wPwvQ1mtd0+jbZesI+vY0+aD8XITvi4IL69bt+5pOF5eqOkyJy3fBPrYLQwAhdwi7AY6zK2R9RcFUQpAJBwgg8SHC8eaqAMQQGSIwzpe+pZmdBhD9pHslC87RCLsp3gkVqbcH/rQmsPrLGQo65sik/SnrrDbHXZpkUBHh9jfGdD+BhIBOhjoXJx2hV3ww5w4vf6mPb6br//z6wdSazMiuX7VwTWttMW356b117tD0bCrI9PBvgzPpjs72Xfh6XRHB/tusMMVxnuGPbkA8Nd5I/CMwCICvjjfR17//o3kfl806mPvRMZnStNRcj8W1W7U02SvuTaVsRifqlWppbWKuZ4uO5y0/LAun/iFKEitAqIFqR9IGHgSyISYMGhEiPwdeTt7iHySHGMfYQeN9EYgvx+Z/yXZyD4SjVrOR/2/O++P/oTk2F+TnHYLybLn4c0t7Hn6mPaQP0qfJy3YF52Pn7QMcpt8h7AMIeiDWadIg2kfSC9AdyA9QGWDl+j0efTr6HqI5/sikb48/TdWIXJstC8c7htlJ7xhhy/Y6gjRi1oK7sbJLNYzp0uh1vlJh88BP3G2NVSTJ95rGQZ4tAnDwkbgXaOc3Fs9gLfyAEo1XcQaB2lWfq0bIgGiaZOAQ2SAQ4BGDBxO/I2322N12tgdy27s97A7PKBcdnhs5MHoWNRFHlx0094i1W8GyTNQ2Wpnq/3L/GyNF9IO8g3/MnLGbo/FHZbftFsi0q8dCa/baRV/7RVdtkHTjd/YazcsbpsIgqs90Wq3sZ86nSTCkyTi1Mcs/jHAPgBzX0DJETQ8qw10fARxQR4FmZ1Yw0Eo68nI6RyUjBBkidYwGgwAIaDUJtnEP3K72MelVovodpEjeGWT5OMuFzvijrvZEZeLfNwdZ921m1i5BZX5BfYOd9j2rMViAxX+w5D8psUiWcmJl2xR2z9I0j/A5SWJnWTvcIWlxbUMeq3jDnqVBmAEG4UpkNJQRqOILNTEzgNIpZFGWxO68RKICjdfEtMNnZC/XrH4CQPPYprc+5Ze+Cldy5at7e+nVzEDpcgsv2oPNG60hkKtr18sTvM2U9h6ZkOGVuGkybqDQXb4AlgHTkRBl8Sa/lQ4jljOC/Q6oa4Qr6HjMpzK9FvG2hZks4mtrBvV8Hii2Z6Gdo05UaUX9afQfprg9lMxS2WizEyw5yZmiLLcc+O36cX5Srksys+yn9WeK4sF/r6GtbRuwRIL+D5VUw37okUg2DcBnUSolJC5klC3PV5Lv4vUiWRkMUMy9G0PkpP9D7L+dTTxYD+b/iCkan39Z/GLXO8GPogKO+rtEfrs/of2ay/+5TD53UO0cuNDN2ovDn0d0vwZrsugnayNe9B0jTWIgg7gN5qy0C6G1m00d3GD2QgatrhhjAqH37bvNNr2Tu9727cbycPFG/bmC4X83hv+Vy0hTi+upCfVplo8YYz5n+gRhJxdjNipeB/TGGMfOwQEhZKj9AjTiMg+dhhOGjnamCeEt2GHFROiTAKJAOh05ZI2WyJl9uxhcvawWGAlFJt/wH7HPkpurdG5OW7zwDkOAG7Aw1l4luNIIKk7X7efoJMn7r9nvnQP/cV8iVS/fnK/Z//Jr19EOotHCZCmwiZ/9Ssyu8R34ITVmGhgQUbHO91C7SORQlaKJDMgI5lM6YqmEnVBKJVUUlYU9PPCX7FY1/CLikJVtaTO0tSCAIlSsVgCjPEa/txmHbthfxkUskATVht98SV9VoxOgKvM+6Wnk4a+2KSZo8BUK68wmZaKJKUSWdWq6AgvlOhZVSmSisoUJoPaLpexGDtHBO2JEoUZ2MtkUplFWM2USjN4VRaEuVLpLKuSVAn+qIw18DCc63NYegn7cEcDljXbsNne32QnLvGQiX3T0ypIbDXolY24h+niNPzqdiFSfwfGc3TDW0xvkLOok0n4LijNIjlNmt6iaGVaVfrjM3jFte2Ux1Ml0c9fVlGUihrvh5nUADhi3xXyguEbgXHdA+9DG0UIoxKSupNflwd1UU8EUMJMA0jKsWw8nl09Eo+P0Gl0FiusTAFDhFh2dTYWG1kzEl/k/zFZ0yNG2AMxZhpxraxwTKMKLgkMYTDgI6bYDCmyKhA0vZ8nOfzRp4y+bLkQ8SWsUgaaowJ0TIa5JHBWsYGKWhZVOM2XoCOWJvoyKmy+XBoj1nzTAQw+EAEm6YyYHqeXQXvu7F6xYt2KFd3BVLuLJmlieTdNUVdH6jJokvb4iokV8KPZ1pgcYI+EY7EwORyQY62XRUM9NC6Oixk7kGYQh15zCLs/dTwb3vvQuSdPbWtJsAn20o5vk/evOvua/d1875PnP3pjrF8987kdbIL0XP1tct/mqUWw3yrs+U/APuTL1uz1Nft9zZKfLRhKC87OZUzHFsmZanE6W2bxlOJJJdATDPYEQAq4jDlZEBwt7Al4WHI6JaXFSSCvtDjKgZ7engDIA0tw7/r/Eu7BEyHM6UAYpwMiOtPC6ALOwyK9DAAUO2R5VJY7rji2xT18YF18WTzkbe9dL5O+DVdv6hcJ6ezrEjeeuBz0VLHBUZnesubIPXfscAVD8XhouzcsLt+0fUMfldf3OYNxGg1Km+7YULNf1uCy6nKhYjX75S9j2Oxrle9Nfa86Vf3B1MvVbZcxulur39v2/cpU9eWpH1SnkF8vvLpwSvw3LqOneHzLSFzk0T4eMiCO05onvt5jtIOS6nVP3jflyY09ue2pq5+ZO3ekfe2pLx06cO7AgXPP7LxmeGRk+Jqdn2RANNff/Ydf+NzmJ6eeWjecPPHH33rmkWvVA5/9xrkDI0PX7PzmzmuGRthcsbioD0Nv3AfJHO7zJvqyfG5OnZt7E90pfqs4N1f8Vk2OgXndx+333mbrPZd1ywpF0RIoNhB4ZLVlcW9FU8RSUVNIhQR0mddiyMoX6/yWxy+JTRIziq6US1JwvYi2Y61sEp0v0UYA2jA7tssYnKZSAdooXbIN65I2ArVIquaWeJykSsvYG+PQW1vcYk0PUF9DD0AbuApPw3WRHmDoD4Y8H9Kf4weGeEoJPGUKiZomQcTchQu5E3THCbzerf23aVWtFIvHMXf77bxscZyGAedmr7cpcqGsSzINF09qabzZknbkN26noqrl+ry/VjuZJe0UWYmoS5u5rDYqtfC6N92G+Ib9aIDl8tpZ3Jf/V+2QIrQDBONy21k8rjfXzpvAm0ZDup71At3HV2eCGykNS8042SNud/rtVokdD68Js+OS1e6ne13BcAs7HgqR0y3hoEtoigOWTJoGl2Ux2tFqonrck2zCS+gjBqUKtSDWMqvA0ql1G3WqvUUQfEmlpAewFkDjuWgoB08oRozvuzgf83JrTUbXbOSRcATe7aEDdJxKqK4g96YY/5JPjBMrL1lcRV1+ZSt1ar91FzZuykftfRMlEKzliT57NL9pY8Gt/ZY6W68kj5WZvLTiEyPL1MRAq3/oLVtW9ewDmjGXWLXlLUMB34oetW9kLxaM9Kk9UGN4/ZbVib2IVY05dALUuoU+fQ6zoSxqX0jh8klfNp/1JfQIagBgRo5IAE3IoZ5ZrFaL4iye2SRxIbH586/drX2HX3IXcLaJUgF0RBWhAkuLlUEpex7Jj3J3Lnf75F25C5eKvYkKsUV6KvceZmEGkZehX7yhXaVAsaoqoNvEWgP2crWhXalI1mcVpaq0tIQwcWlazjmC4YytXcsqrWLsMuMqBUasM4WUdXoOqiWUqqD46ldT/PK0CfcAgujdTBheTn4FaIqm6AJamSVFaAX5BpxJcRb0awojYdUqjIMpKtdTi0U8z4IKPo9KOIBT0G1sPBbu4iIdu7EKDR5VO2BOfSa3vqoQQGulBBrTjKyPDJgOTmotpKlx1OfItN7rXvPaHAVCXG/kPKzxHgCcAkovgK1iprCkrCJEVbQamH3GNb06oYc+oMywOI4O+H1V1Z3kFHqvB9SdPauePSsWSpXKfEWUeSDyEypGLes4Ln5VfDe8xaHHuCENsBNJtAYAmUXgmXLBJ0UKPKxkLRn9s5z2rv9BaP6nt/4i9wvy9mj20GHgv+JpNncP0/6MfiB3pJ2V4NatPyX00KGsULPZoz+6FdqPC4PCGoyDrunPjehMKTxOM6CARQrppTebQzdNqjetXHVqaurUpzboEWwbfv1q/s5r/X8xdM2IGH41wzqnmu5uH945PLzzwLXDw9cOx0Af50p5lsxNnfrkqSms8Gms+e1XO/zX3vnxwR37l70aoqnmm6rx/MFrhxXjeTgtxgH01u41cQ/Q04I2KYQxfaiPZQrh7AgPXuOrFs0WKMhnRq36YvZJeT3ADT0tGMc2mo1A+WitagZSDTz65OrNye5kOJJel9k5LC8b7EpH2sdzbeHO9lDAF+gdYzcCCch63C0OCyX+0St64oWW4E0Xr030xjuSyb7O9niDqV41lu0edImOtg4l3zk20hfr6Pb4V/q8sbZ2R4tvaMTGYJ0Rgciiw+ayknX54ZW5UUIU5cplULk73RdzewXXEvvGYgsXlxKlUG0vBWCvYblCC1bBdGSMcjxoQS2gJYqp0NdnVCIViaTqf7WcPhBF1TdWCPrNR4vFx1T1sVoC//R1NSP+gsdh6jbFCGhLdioSiQQIKE8RiZBXLpx5YRuJsTn2o73kO1Ns8DoSm7pw5sIU+5H2wpkL29iP2ByJkZfY4BT5DuljP+I3SWxJ3KvbhAsRtC40Zu+hq9kBpu34fGMO3ruDHSDiji+YfKWLoYj8O581aKfZ8leDYS1NQNpWS/MCMARO2splMjdL5kDmMBLidKlUQpm4xEoakh/8q9agZPbXWnm8mb6PitNx2Qf82pcx+IJs2CM5rwjpGgDasEBMkmUM5NVm6SSrVGixngFuAfpO5SIrKUDK0aBVnEEyr+hJoiI7ATpYkyXmxKoR++QDWMQ4L4mEpExe1s9SKFIwznp5QU8LFXgtHBWG4yMlOLES5jE3V6qWar+UgiE1+o+qpiLz+rYa1seOGgR4hJxdzBQGiZgMZPjY9XFr5VS5nGIVipvEKqnyTEpRFeCcij5kIPLlsgpXkKWga5BGsFT4qIUm3z6F8TsMbzm+N5QMhEiSGEceLsYhAcTLZVYukYqmzojyPDDFclkDjWkGJDOlXCqUQV4DtVKe0WAZKfy+JsBomVwClleq61LAP6s8xhClVxiXVBtlhiJuVJRqFTpKuXEd0rSiTdJZvwpAJQrKNKwMaTPccBWEDPkFMRc4vpVv8iJ1u2eI2z0BF+dLJbGsaEVQDwWFlhTgvmWUt2UF8BVvqhWtqIgKV3GBJFTKMzNm/Vq3EAshXwLEyKyYCSREksggtywrOP+7s1pxK/0YzMKCQMsFEbCBpVQeUlCpsrIRR6XLLSs4x9oh7OK703gMVdII/pFiJBjuIjo7hhWJ27DWAluiq8nr7XDK1M1W8JCoyJkNGbU/rqmdy0S5ww6iVRkAqNacwzGZHn7NDVBDke7uFYmEBbVq3N+WeUtvSY33y50tM519Il9BSiUCjVSwNcDI19we9Qq2s6KbqFUjPrRcp101yiOb40NlLnMkuOxR0xzxKHBplPtOTJIok5VJOjmJ8ltNdlJm4DI50xBKZxSoMFOsxYiXZ3Av3gzSoPpc4D7BEeCtO4UbhAOC2pgRHgO0eAZQ+loU+CIj6Os50jSHI7gPCWOmTLOTMepjfIc+U3xGNPPscNu8qvtRWdXwp6a84bC3nqvUJpeW4Nq/0zRrql4Rz8YE4lRFKk2zBjLwdMOhqobjIUcrOlIL9YlWMQUTX5/FGagUiocvpY9GULLXvUucTqMyw/dVhpKgVDEgivib5yRqlsgKfUJTKEilKVLFQ1NEuaiqxUUyD+6T8Bn4AaANkYSY4JOg8zpt9Mfkx2yWTF7BfslWkDH2nD7zz2mj5Mdn2CyIqivYL+k/sudM/lZnPUaSczMj2rFE5lKpEvyWyPooYfbCijXvYRrhAb5xghIY0htA2Aw0F8FoSyA3oAKHQRJL8rNJCTg0FI2l22LDhdtBhdosAk3jW0OZsmebczLf0ApKrf5MosvWG+uTKUkplYoC9LcKfDb1+NssheXvUcRMwmL2fwYw8rPGozHiM2tEgYq8yMezIveJynKJTpZkBfS4VIpOpvbWSuQScooUL9dp7FkjJrzJDhdBbYrriHqaAlpMThKgoFTmKT9yWqVC5mDCz+ppA1/m+B5FnFWk2nWrXgY0glCGa8JwiMBIQbwolSxCSSsBLmspUgA6jXQULUXVKmgz6ClE2m22RbgMTpDgey8jXDlq3n5Z3+6rH6AQVtUK7q9kCr1Q332JHAi9h2iMqJbEaTTuCMZG0NreXt25B/Sk1KyrWUF+WCdcL9xSi3C2JrkqVT+QRRmiKRzE2FfCI8VxV84g7i0rjPJQcd0Ob1jiDVu8YVfONAgKdApWF5HLRf5XpsUiEDpYZqXN6+UVQYtNavX0Z8ZPTaSXS5CzWYLS8vTEps6ujuVtGBXa1t/Zlevq7NczK9picWO35zRTNZgDtQyNlSaLtKi/gc32RVYEbfbWVnd/RJYj/VJQsjtsIWlZRC64XbFWm91lt7bGXB4PZKyQsbXGnW6/Hq5RszNjbIULZqtHGMBIOR76pQd+JcwZYvLF1L1OFX1XKj2s71Jl/653OB7sCQR6gpChF4HxzUIiTifx3EgzpX8tBp2QVKAn0xOETNPc9QmbhX3CbbW5A7QxzQ5oWFKm0DRD2ZEIef35lcIempFAMatP3iBpTGsXKaTHUTnVJ1E8lSvG0vUp29ArT2fVVJdp2jb097H2JTOtJUVHe8rv9Xrb6xP53sYEd3TZ7PHeYKu/NqVMyRWD6focuk7m1GiXaRq95NnFk7475U+1O0SvpTGpo43J9ncFe+NQhPYet8nPFOeemuWgm60UJoRNwjbhauCy+17H90SSNmmcyEm4my6A+llIhrAsGMmm0YoDAOQZORmWIMNDc7OjhVA2bc3mbQWYrOxre1jJC/d1b9x6t1a9L3X31o2fPCZf+eVjV7Izp73e02Eye//9rur9Ltf95KnT4fBpr/Yrz+bjPfd1v3JMZr87duUvrFd0wWOv5b/SlJsORg9t3nwoevCmAwefeeYg+cDosVGgVaNvL8APVJ/RY2STpePmt9x04zMHDjxz8GZp//7Nh2q60N0WIn4AsG8M8G+ncBAw8L3CBwFKYcCTOG42AiSUbAAlQCbAvcIA7ibiaAhwGqcYbGfr0vevQanM8SuM6JUfzaQ5vkFOv2nlG9Y4RZkgvGoXYvIE7mET+YNwB/cFwi1MTfDNruINA5QOTO257qohURzsKb5/86b7b+0ZFOnQjuv3bV8B93puvX/T5vcXtWqL2+63EGt6bGTU75sgj7SMrfH5R0fG0laLz8UW2tr65WTvyrHepNzfyb4m+bNtktSWBWIRCdF1Fq8v7HQ59TKZNxLbOOF3eon2HUK8Tt+6jTFsS3x7955dd3TvPrC7+64913W3RXZv3Lg70tZ93a67uvfctKf7jmv31Aq1kWCqe32vlTiAQYdCMH63LRTKJzMOYu1dv4wcpWOrx/JUzMGFDootkTZ7SzRis0b6Ul0t8VhfyGKNRFvs0TC5BppI5ZKSd3nvqrTXm16V6ffYkrlUxtHMA/TvgnTpcu3S74KYo4CsTVFAaKdH0/ifZH+WO5M79A0Q2S8ZDLT0ix6HGnFBoIiUZlR1pnQJGc3XbEG007w5+CjFUEngWmyT6bBqKJLN+jLqcEGhncfLcL2YywS6thyxSgVxsbIsgnjOdWUq3cB+czx4uFlZRssk0RXjmWP/m9xGv9qkKpv0VqshjTRZDGqeB92nFwjVLbH5CLePouY8Dwcr6XtetBQMSwFllVUgravOUEDQKcFdgHNcY8bHFO4RonWbM/cgEtQCCzossfUZbXYG2uaABOiVy/iZDq36Gjb/hp0/YbL/X8Lmj/quyhSk2Tz1jRdeyN3+51+7i7bzS+4FoOl1S7/J+r/U5t+An9uQkhrfz9A1KzgMu4OxMw9lFx9KewY7w516gBUMTWCApmdz996bu+fe7D33ZO9lFEZcRnZRLcLQpzVgIICPyNey995Tq+grkRLIUiX+12QHatYJkzqe8thr3h8ZIcMtIbVdgjLvS12wLsszM3KZymVMpGYUkDpRYq6C3o3dQWxmAohJ03KpJGNX4epHlZjIRmcQPo+LGvSlB3jWgLBRuE7Yz+W415QC6kKAbMJ1K7J8rPWGTN9sThKfy6mxjIn1Z96TuzXeSwNY4u7PTGxY1qfN1lbMr3ssLcG4r8XubW29JMtv77Y5OjPBVh/7be2ZJ3NqKBOQ4BEP8Hw3NB/qJfW893HTaluVbE20e6nXisze1uJusbUWGklfIpCJOYDZ02nzCpU4bfglX58JISNsAG5/jfDWGnVINEm6yR5ditUhqFvXrG9K3F1CVuh3muTcDZAbqEONbcOhf/ANhd3vN9OivshAHTLmtD5UfwMWhpSrZ+JOj1+PQaalZtrlWGTn0+2MfcKgkOe+SxMFk022R/xySbPtMaIji4m6mSkbKeAaBFWxDJoJaDXwxy4iskOiUqN2JlJXVqvFIsgmePYvf9vy2o9GeWmAZ0h7gxA2+36X7Oes+XgX+XtNzt3Frl507BYXhLOLnLzIS+8yZMjVIDMeFd6BOnvWxjfTcsSIeESQh4BoyiO4pDhmUY4/iFuDlgEyQQ0dShd3ujAsh4s5IM6MhLmmnk+O8q37HPEy4zRQwzKVtKRSGzd/6Ya9k1f23Zq6+1Nf+OOPF1Qq7Dy4eczvs9qI3env6h9buXF8846J1SBau92iM+Ie23xw55qtG3JW69C6TataTck7/m6L2txo70e+fLOOfGSub/+e3eMTI8HAylW7Yzvu3RFJ37DpnaD5DiUHW302u9vh8nV0JEPtPR3LPO5Wt9frirgGk0NKIt5vsfTGui2kkZo5tO+dTGhq8foPbWNKTf8yyym4V6pdSC+SU96EiELLlUr5jcUTeXp69lKSScN/W9PYdf8trgLTgVYk3QiKVJ+oM0SgslbhIcZwZWXgt9ysWcYvJJVAVWcl0FWq8EP/Lk0Rdb6skPIkATWdNsVuvWHk1puJ1noTcVpmu0dT3EYtxpgYkf+mNcKdKvpOAYbSWLFIQPiyLPGZCHbig1/EZ/XJ8CNuIlMeBwUMmuwlc+wJWGDQBAGuK04vQDGHnFBiFQDYzAzjxAJ536W+m4aSQTZOIyEjNOH17Cj5HKwp1ZlcI4slDFBGIbbNZE/R46T1WGm5U5wW5dUp54JQ/7zWEqtKGS2b/+WYxWan7mWEam4yvmp0WeGYpcbXkBbbhNq5h3p93bdzqQ+xvPEIRJMTiCmX6PbSL7VcNYJu5ZvwtL/uIaKppZ0vLv1ki2o8CCdgJdx9ZF2EgyiDG2MS655I/MyPuauKEV4nKKvY97+06uS+RkeEmr3zKf0W3ai/p+WSPAYlw+bvBvCoi0X5ypKNCJfYm6BzHoP78M2dpUWbEOqxfx+uvzlUIFwyMfbe4azZScFnFSMolRZI2UEeCEQ7/ME4huTH2rvZk+yYStp+/vLP2ddUVfzQThcrB/r6+wZXoYc/llyTX85uJuveR+7/Efs/XyFtZPdP3tckp4frq3HZJeR0/Ytyck1IbxKM60J6Yxmi/ZiL6Ca5uCGmG0swwyX0moBOuM9mBvrSWod8XoroworPIFlAeImMlmMyR8rzOM/T0wrjQWhL41hcMJPdBgWUQomAFMlGYdoKERJp2v3AlRm5TOZve/HF8ny1/DHSXdZmGuEVukivlcpAG//lr3BatXL5QXIFEDZTAEVT/wN6/0OFjB7n4jOsvCW0vAHDgu4r/HNC2H3UFxTd3y6q8HyQ+wAE3f+WHYnTGOHrN6lTcmNLXBJ3h/M9c5Wpe1d3j1mWX722h8eIMIXMIGIN44p61+xsXB/E7oceKSTGr+5XtmMYCNdRSvqKU6txfWOHbZGOFOY+s+aoo/zSr/uRkJPkA3x/G/eVEQE/ElnWJQ5uMsUP/H2oUq3Si8aeNBFd9rBcVfM3/UiKr5Ai3+dsv8S6bPrGixkJG9qbrk0GlmhuDUxE/z0gzJdyU1O5bVN4njpWhbkow6TX9DdN1xtpilWJJzs1ld22jZ/JwZo6uYhu6H0bBAlywmT3MBmSZVNMO1oOzFsbyKIYxgaPntPdb95QiLkOHc4dht8hOFMYyNnGrccBi6an6T5WbmzesuM+xXA8dPHQoVzttxUkJ32XbjxMzuIz+FMa+4QKIK0s56u/5h5IcswDFpjnCNiT5kpUYXQtIVnuMU6IwD+Dfsnpdgd8FtFmtVns3kx7H7uuy+dv9XtDbi9JzYDMJJAUmWZCONCd7u+U+3pikYDH4SaRFlsiGurozMgr0oAzQK+VxbYktCEsxkHzXqxFeLdP/6DlIkxjJf1DloLNxOfXCleC3ribRzq9DrfPwn9SF0v1/TXpjJEPZNMB7IovmcnyzsgRyYdfsEEjQkDKvvYGxj3bV6VKsgL/qcmjW4/0d17/+589e99V9tVrupSUkpIVddX2901Ozsro2a8qBfgniiqr3++5t/81BYWUMlksFv9v7/vPfvb0vo4VRx/57KfHJ6CECCkMe1oQFDj7U+vZX/5kvSxPgrjsfkuvQTcf5HJjS+NrBubviGKojn4sXng35k5Qq/YqkPMUt8eozYsNvyKHtJ6+pNN55M0LQm0RNeg1ru7ae2F+dWDqB9G/4WQIgwYHQtFTj/Eh8DZyf53zIN/hy0DVu6PJZfo23TJ1rEqF8iIeoccDLcEu42twzZgF7wQBnylLiJgeev+a4zG7bEI6+BrfLDbGYzFGw5ATlbW/wnBb9vdkxd30Nn1AxnBQ0YEB6Ra3fj4gobZ/7ocwfyvwC5KgWkY6yDiZ4N/KCUpiAOUI3F+VcRLcU4QfhsgVAmKaRxSE+M6RfAFgXQn2OB7/jL3T39LlCjit1arVGXB1BXocn3ncHvPZu5xBp61SscFFBF6GH/u9GPSxn5OQN0CJKxCxs1PslCMcdAZ8JMx+5vVT4gyGHeQucpc9EnApJVlWZlJcuaf1mAifHlGTCCUDEk4AyRB05wci3K2PCkGGogWhUmQV0CdgMkAZVBWie9LLCvWXStzGgE5aLuyBlKBiTRAWSgZ80A8ofuCN91iL989XZ2fF1DO1PdbIk9Ev3anHlgZ8wTjFr/n5sr6GVJ33oaV3ZuzAiZsnxJmR4R27nt21Y3gEQ0uLbHL1wTWW0f2r3Rg0chNqaqiy3URm6/E+0zwyNmVYaxsuPYxFq6+9+nq01HAbeQRPaRfqqxBUMcPmSbljG65lbp29IJjtyq38W6whieu8BQxfThTwM2wNkIvyJIr+rDRZQrRHYXmyCeYYB1aagUszrPn3m+qxLhgtuUHfy2KObEk0ol6SGNUUMIesBIw4lqYAJQyVMoWslGqRLFza95vCURSMT4k3wlX2NgWiNOJTZhgs6HqwCauFn9TCUWqw4vvyvbW9s0gb9EhoClQZhm0RAAT04owm08oMoqfC9X99PcKz/4n1SP7/rUetjIuxBCxIl79PcvkTPQ4YTZMUkcFnSWVBoDNlWHZasUwvcgwoCf8Bi0aJ0AAAAHicY2BkYGAA4i99Dz/H89t8ZeBmYQCBe1uv7oTR/7//r2BjZO4FcjkYmECiALGQD1cAAAB4nGNgZGBgbvjfwBDDxvD/+///bIwMQBEUsAEAoRMHEnicY2FgYGAhCv//T5w6NDwXiN8g8c9A6VhMs9lw2MEqDqRDgTSI7wnEHlA5T2q5F6QWA3+HYDL8TDcM8yOpcUNmXKKa8Z16ZuLQK4VNHFUMABJHLJkAAAAAAAAAAH4AzgEeAWIBvgIMAkoCjgNiA5ID8ARMBHYEkgTCBOYE9AUCBR4FSgWkBc4GhgbsB2oHjAfaCAQIaAiYCMoI/AlICXoKEgpeCsALcgvKDAoMigzoDSwNcA3qDkoO1g7yDw4PJA8yD0gPYg+sD8YP5BAOEEoQtBDmESARTBF0EZISBBJQEtATXBO8E/4USBRsFI4UsBTaFPYVIBVEFWgVihWsFdAV9BYYFjwWYBaCFsAXHhdiF5YXwhf8GDQYYhiQGMIZNhm8Gg4aPhpgGqIa5hsmG2AbnBvCG/gcHhycHOQdhB2wHdwd8h5GHnQenB7IHwofoB/oIJAhKCIMIlYifiK8IvwjGCNcI6Yj7CSMJRolgCWyJmAmoibcJxgnPCdqJ7YoFCh+KLIo9CkwKXYpmCnWKfYqOCp+Ks4rNCt8K6osNCxwLKos2C0ULW4tpC3ALfAuKC5aLr4u3C82L04AAHicY2BkYGDYwNDDwM8AAkxAzAWEDAz/wXwGACnfAmIAeJxdkU1OwzAQhV/6h2glFiCxYGU2FRJS0nbZHarU7rsI6zR1+qMkjhy3UlechhNwAk7ACeASXICXdIqgsTz+3vPMOHEAXOMLHo7PDeeRPVxQHblBvhNuku+FW+QH4TZ6CIQ79MfCXTziSbjHjik7eK1Lqj5ehD1c4VW4QX4TbpLfhVvkD+E2bvEp3KH/LdxF6HnCPfS954nVkdNLtTioTWzyxOROZ7Za5nq1SyMrSpZQ23JjcjX0B+LMdK7tqUW5X42cS1RiTaamVVmaGlVYs9Wx89fOFeMgSMT3Y5NhAguNCI5xCYUFDowbxDDIkdSx2suYd1Jz6hV2vKiorv6791+F1BYl+1VaYQgfg7OcGXVe552/RYk9zxnRdcxWnJY1GWn6e1rKYegU9d6WTkzfx7quKviTA47kLN+vvy/7AR/6a8kAeJxtVfmbG8UR3WePNBpJu9q1Q7jB3CFhA+a+A5jDAYcEx0A4Q2umNNOrme7Znm5rJa5Awn0FAgEScpBAOJKA+Q+pnhkj/4C+T+rqqupXr+torexaaT79le//HMMu7EaADroI0UOEPgYYYhVrGGEdG9iDvfgBTsIPcTJOwak4DafjDJyJs3A29uEcnIvzcD4uwIW4CD/CxfgxfoJLsImf4lJchv24HFfgSlyFq3ENrsV1uB434EbchJvxM9yCW3EbDuB23IE7cRcO4ue4G/fgEH6Be/FL/Ar34TB+jSO4Hw/gQfwGD+FhPIJH8Rgex2/xBATGiJGAMEGKDBJbmCJHAQWNEtswqGDhcBQz7GCOBZ7EU3gaz+BZ/A7P4Xn8Hn/AC3gRL+FlvIJX8Rpexxt4E2/hj3gb7+BPeBfv4c94Hx/gQ/wFf8VH+Bv+jn/gn/gY/8K/8Qk+xX/wGT7HF/gS/8X/8H98ha9xDN+sjBIpUqUrOqDVRJpioJ09qKtSWpH3pTou9mJdzo/Qjg0KYaZhaeiopNmaSBJppVYiP8D2buKEmru9i4xUuiNVOnGMrrwUToVM2dovZCGmLKT7V6tMbrG52fUXcuIacbAjRd46hTv1Mb8q7xwkeqZ2uXK4zaBx5lJilH7GLpnw8brWjaXQgzkV7M0268K5mBGvUaE9kypzo4VMWJpLlrfclgyIb7GeUE6WJtoUsc5doXq5JI+1f8NfgkNkQrfcN2ZUs6l80NhH7y6cV0Q14pwVGy3h+i5CKelOazV8dkx81Bk31Sr1qrXWVPst3Kjd+ujbvPaXIGHrEm1JlTjLDmFLc3XB2dy0jDjn73DCfDbb+63VG+9UKxpbLNSCb9TYPOPatudEW5OwfWKzVh6HLkhuOYbmO1DBiDIqhRGpEWUWzLRJOhMjChpW1nDJM3tIKuoIY/Rsd0mqG0sT59QfGz0l5W1hqfN5qtUqH5BTOpIZ7dKsTzvcY1XFvdXdNrFOaJDo2GrDAch0x0KnQkeZKzhLOpkHlThKEUdUlS9gOBNG+a6rXBwzSiDVRPe2HVW+WTvEbEx3oXUhVegX7vnuROeM3DGec5DTxIZbjt0n825MypIZJNIzHDtLSWh16V36Y22tLrw4aMT6+LCRm3M99q21EQuNatgsLW6z1C79Rq7x6pQ1QCGPWSKs6JVGl2TsvF+VubQx5XnVL0VKyhVjMpHIZaoKhoiYqYutMxSORZ29wPLs9o7PelSxo/D2KOPEaaO07bYghiZkSMUU5FJNe3FG8XSsdwImQJFnkXKBypCHpY7kwWtNNGMH41+HwOu6viKiCpiwGnIClG3fjJqwL5Kw67U+dobjWa/uNjPIufRV5ulKiN+giq/MXGjYiFwBbsVBs2GfknrccbGv7KhReqixITHdaPYTmVOsObM+M5meVbHIacDtxf1ElVzQIJNJwv3s9eGMxp7nINYFF3nHy6NlN9b54GxWdk8DXojY6DYbG99NgiU+7DPGEzEtOB95vyCTUlOz5VMz9HxSIxOfsxHToBaq3nvjCfthK9e8fUHEyBCz4Pc5r+YVx1zzxJZkA2uIK0HcA1kQC5N0+bS086EsSm3sYfK/HSMSqfv1b13J1eM1r3drPK5C+Sxs+v+AyDcSP5DatJXxt+jyg8E3i9r0yzg0nPCjZIIxT9Xu2NnV5ZW5rdcS8h3ody4XVceHMIGH71UlxZkw1foSvRmC0VJRz0qnFHzVtaW2nprK8YBUsZGl7Vb8WFkZTbRqCEdOcVf5TlpdnuKhDLxHp+7Fnhd9R0SVG7cw/u9Pxisr3wIkBvud"},function(e,t,n){"use strict";n.r(t),t.default="data:font/ttf;base64,AAEAAAALAIAAAwAwR1NVQiCLJXoAAAE4AAAAVE9TLzLErUpeAAABjAAAAGBjbWFwNPu+MgAABKwAAAwaZ2x5ZiW4dP0AABIsAABenGhlYWQigu90AAAA4AAAADZoaGVhCdcGMAAAALwAAAAkaG10eMgk/9UAAAHsAAACwGxvY2E6nCCiAAAQyAAAAWJtYXhwAckAmAAAARgAAAAgbmFtZeno9UgAAHDIAAACW3Bvc3TaH0GUAABzJAAACK0AAQAAA4D/gABcBgD/9///BgEAAQAAAAAAAAAAAAAAAAAAALAAAQAAAAEAAPSO4fNfDzz1AAsEAAAAAADetdW5AAAAAN611bn/9/94BgEDjQAAAAgAAgAAAAAAAAABAAAAsACMAA8AAAAAAAIAAAAKAAoAAAD/AAAAAAAAAAEAAAAKADAAPgACREZMVAAObGF0bgAaAAQAAAAAAAAAAQAAAAQAAAAAAAAAAQAAAAFsaWdhAAgAAAABAAAAAQAEAAQAAAABAAgAAQAGAAAAAQAAAAQEDAGQAAUAAAKJAswAAACPAokCzAAAAesAMgEIAAACAAUDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFBmRWQAwG6Q54IDgP+AAAAD3ACIAAAAAQAAAAAAAAAAAAAAAAACBAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQA//8EAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABJ0AAATsAAAEAAAABAAAAATMAAAEAAAABF0AAAQAAAAEAAAABAD//wQAAAAGAP//BAAAAAQAAAAEAAAABAAAAAQAAAAFFwAABFUAAAUAAAAESQAABEgAAAQAAAAESQAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAD//wQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAP//BAD//wQA//8EAP//BAD//wQA//cEAP/3BAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAD//wQAAAAEAP//BAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAP//BAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQA//cEAAAABAAAAAQAAAAEAP//BAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAP//BAAAAAQAAAAEAAAABAAAAAQAAAAEGv//BAAAAAQAAAAEAAAABAAAAAQA//8EAAAABAAAAAQAAAAAAAAFAAAAAwAAACwAAAAEAAADygABAAAAAALEAAMAAQAAACwAAwAKAAADygAEApgAAABKAEAABQAKbpDmFuYZ5hzmI+Yo5irmNOY65l/mmOah5qTmp+aq5q3mtea35r3mwebG5sjm3ebm5vLm9ecJ5xDnF+dH51fnZeds53DnfueC//8AAG6Q5hXmGOYb5h7mJeYq5izmOOY85pjmmuak5qfmqeas5rDmt+a95r/mw+bI5srm5ubp5vXnBucP5xfnR+dJ52TnaOdu53Lngv//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEASgBKAEwATgBQAFoAYABgAHAAdAC6ALoAyADIAMgAygDMANYA1gDWANoA4ADgAQYBBgEYARgBHgEgASABIAE8AT4BRgFKAWIAAABsAJYAlwCYAJkAmgCbAJwAnQCeAJ8AoAChAKIAowCkAKUApgCnAKgAqQCqAKsArACtAK4ArwCOAJEAXgBdAFwAWACPAFsAWgBZAFcAVABVAFYATgBPAFAAUQBSAFMATABNAEkASgBLAEcASABGAEEAQgBDAEQARQBAAD8APgA9ADwAOgCSAJMAlABfAGAAYQBiAGMAagBkAGUAZgBnAGgAOQBzAGkAdAB1AJAAdgB3AGsAbQBuAG8AcAB4AHEAeQB6AHsAMgAxAHwAMwA0ADUANgA7AH0AfgA3AH8AgACBADgAggCDAIQAhQCGADAAhwCIAIkAigAbAIsAjAByAI0AGgAHAAUABgAEAAIAAwABACsAKQAlACYALgAsAC8AJwAoACoAJAAiAC0AIwAhAJUAHwAgABwAHQAeABgAGQATABQAFQAWABcAEQASABAACQALAAwADQAOAAkADwAKAAgAAAEGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAACFAAAAAAAAAAsAAAbpAAAG6QAAAAbAAA5hUAAOYVAAAAlgAA5hYAAOYWAAAAlwAA5hgAAOYYAAAAmAAA5hkAAOYZAAAAmQAA5hsAAOYbAAAAmgAA5hwAAOYcAAAAmwAA5h4AAOYeAAAAnAAA5h8AAOYfAAAAnQAA5iAAAOYgAAAAngAA5iEAAOYhAAAAnwAA5iIAAOYiAAAAoAAA5iMAAOYjAAAAoQAA5iUAAOYlAAAAogAA5iYAAOYmAAAAowAA5icAAOYnAAAApAAA5igAAOYoAAAApQAA5ioAAOYqAAAApgAA5iwAAOYsAAAApwAA5i0AAOYtAAAAqAAA5i4AAOYuAAAAqQAA5i8AAOYvAAAAqgAA5jAAAOYwAAAAqwAA5jEAAOYxAAAArAAA5jIAAOYyAAAArQAA5jMAAOYzAAAArgAA5jQAAOY0AAAArwAA5jgAAOY4AAAAjgAA5jkAAOY5AAAAkQAA5joAAOY6AAAAXgAA5jwAAOY8AAAAXQAA5j0AAOY9AAAAXAAA5j4AAOY+AAAAWAAA5j8AAOY/AAAAjwAA5kAAAOZAAAAAWwAA5kEAAOZBAAAAWgAA5kIAAOZCAAAAWQAA5kMAAOZDAAAAVwAA5kQAAOZEAAAAVAAA5kUAAOZFAAAAVQAA5kYAAOZGAAAAVgAA5kcAAOZHAAAATgAA5kgAAOZIAAAATwAA5kkAAOZJAAAAUAAA5koAAOZKAAAAUQAA5ksAAOZLAAAAUgAA5kwAAOZMAAAAUwAA5k0AAOZNAAAATAAA5k4AAOZOAAAATQAA5k8AAOZPAAAASQAA5lAAAOZQAAAASgAA5lEAAOZRAAAASwAA5lIAAOZSAAAARwAA5lMAAOZTAAAASAAA5lQAAOZUAAAARgAA5lUAAOZVAAAAQQAA5lYAAOZWAAAAQgAA5lcAAOZXAAAAQwAA5lgAAOZYAAAARAAA5lkAAOZZAAAARQAA5loAAOZaAAAAQAAA5lsAAOZbAAAAPwAA5lwAAOZcAAAAPgAA5l0AAOZdAAAAPQAA5l4AAOZeAAAAPAAA5l8AAOZfAAAAOgAA5pgAAOaYAAAAkgAA5poAAOaaAAAAkwAA5psAAOabAAAAlAAA5pwAAOacAAAAXwAA5p0AAOadAAAAYAAA5p4AAOaeAAAAYQAA5p8AAOafAAAAYgAA5qAAAOagAAAAYwAA5qEAAOahAAAAagAA5qQAAOakAAAAZAAA5qcAAOanAAAAZQAA5qkAAOapAAAAZgAA5qoAAOaqAAAAZwAA5qwAAOasAAAAaAAA5q0AAOatAAAAOQAA5rAAAOawAAAAcwAA5rEAAOaxAAAAaQAA5rIAAOayAAAAdAAA5rMAAOazAAAAdQAA5rQAAOa0AAAAkAAA5rUAAOa1AAAAdgAA5rcAAOa3AAAAdwAA5r0AAOa9AAAAawAA5r8AAOa/AAAAbQAA5sAAAObAAAAAbgAA5sEAAObBAAAAbwAA5sMAAObDAAAAcAAA5sQAAObEAAAAeAAA5sUAAObFAAAAcQAA5sYAAObGAAAAeQAA5sgAAObIAAAAegAA5soAAObKAAAAewAA5ssAAObLAAAAMgAA5swAAObMAAAAMQAA5s0AAObNAAAAfAAA5s4AAObOAAAAMwAA5s8AAObPAAAANAAA5tAAAObQAAAANQAA5tEAAObRAAAANgAA5tIAAObSAAAAOwAA5tMAAObTAAAAfQAA5tQAAObUAAAAfgAA5tUAAObVAAAANwAA5tYAAObWAAAAfwAA5tcAAObXAAAAgAAA5tgAAObYAAAAgQAA5tkAAObZAAAAOAAA5toAAObaAAAAggAA5tsAAObbAAAAgwAA5twAAObcAAAAhAAA5t0AAObdAAAAhQAA5uYAAObmAAAAhgAA5ukAAObpAAAAMAAA5uoAAObqAAAAhwAA5usAAObrAAAAiAAA5uwAAObsAAAAiQAA5u0AAObtAAAAigAA5u4AAObuAAAAGwAA5u8AAObvAAAAiwAA5vAAAObwAAAAjAAA5vEAAObxAAAAcgAA5vIAAObyAAAAjQAA5vUAAOb1AAAAGgAA5wYAAOcGAAAABwAA5wcAAOcHAAAABQAA5wgAAOcIAAAABgAA5wkAAOcJAAAABAAA5w8AAOcPAAAAAgAA5xAAAOcQAAAAAwAA5xcAAOcXAAAAAQAA50cAAOdHAAAAKwAA50kAAOdJAAAAKQAA50oAAOdKAAAAJQAA50sAAOdLAAAAJgAA50wAAOdMAAAALgAA500AAOdNAAAALAAA504AAOdOAAAALwAA508AAOdPAAAAJwAA51AAAOdQAAAAKAAA51EAAOdRAAAAKgAA51IAAOdSAAAAJAAA51MAAOdTAAAAIgAA51QAAOdUAAAALQAA51UAAOdVAAAAIwAA51YAAOdWAAAAIQAA51cAAOdXAAAAlQAA52QAAOdkAAAAHwAA52UAAOdlAAAAIAAA52gAAOdoAAAAHAAA52kAAOdpAAAAHQAA52oAAOdqAAAAHgAA52sAAOdrAAAAGAAA52wAAOdsAAAAGQAA524AAOduAAAAEwAA528AAOdvAAAAFAAA53AAAOdwAAAAFQAA53IAAOdyAAAAFgAA53MAAOdzAAAAFwAA53QAAOd0AAAAEQAA53UAAOd1AAAAEgAA53YAAOd2AAAAEAAA53cAAOd3AAAACQAA53gAAOd4AAAACwAA53kAAOd5AAAADAAA53oAAOd6AAAADQAA53sAAOd7AAAADgAA53wAAOd8AAAACQAA530AAOd9AAAADwAA534AAOd+AAAACgAA54IAAOeCAAAACAAAAAAAAAB+AM4BHgFiAb4CDAJKAo4DYgOSA/AETAR2BJIEwgTmBPQFAgUeBUoFpAXOBoYG7AdqB4wH2ggECGgImAjKCPwJSAl6ChIKXgrAC3ILygwKDIoM6A0sDXAN6g5KDtYO8g8ODyQPMg9ID2IPrA/GD+QQDhBKELQQ5hEgEUwRdBGSEgQSUBLQE1wTvBP+FEgUbBSOFLAU2hT2FSAVRBVoFYoVrBXQFfQWGBY8FmAWghbAFx4XYheWF8IX/Bg0GGIYkBjCGTYZvBoOGj4aYBqiGuYbJhtgG5wbwhv4HB4cnBzkHYQdsB3cHfIeRh50HpweyB8KH6Af6CCQISgiDCJWIn4ivCL8IxgjXCOmI+wkjCUaJYAlsiZgJqIm3CcYJzwnaie2KBQofiiyKPQpMCl2KZgp1in2KjgqfirOKzQrfCuqLDQscCyqLNgtFC1uLaQtwC3wLiguWi6+LtwvNi9OAAAABQAA/4ADtwOAAAkAEQAVABkAUQAAAREjESERIRUhEQEXBxUHJzcXJxUjNSUVITUBHwE3PgIWHwIzMhYfARQGBysBIi8BBw4CJi8CBw4BLwIjIiYvATQ2PwEzMh8CNz4BFgO3bv1uAQD+kgMYNOsznDRnv9wCSv22ASADSycDDxQTBgQaMw0VAgERDQdJEgsBLQQRFRQFA0gpBSMQBT46DRUCARENB0kMCgQdOAUaHQOA/W4CJPzcbgQA/V806gEzmzNnsUpKkklJAaQG4XMKDQMHCAY1EQ0HDRQDDgGJCg0CCgkG2Y4SDQsEPxENBg4UAgEHBB3EEA0IAAAABgAA/4AEAAOAABEAGgAeACIAJgAyAAABETMRIzUjESERIxEhFSERMxEBFwcnNyE1IScFFSE1JRUhNSEVITUDFTMVIxUjNSM1MzUDJdtu2/6S2wGS/gDbAlPPzzR5/rIBSnX+4f8AAQD/AAJu/wAkSUlKSUkDgP7b/ty3AST+3P4AbgLbASX9qM/PNHlJdVBubttubklJAW5JSklJSkkAAAYAAP+ABAADgAARABoAHgAiACYAMgAAAREzESM1IxEhESMRIRUhETMRARcHIRUhFwcvARUhNSUVITUhFSE1AxUzFSMVIzUjNTM1AyXbbtv+ktsBkv4A2wI9NHUBKf7TeTTPbv8AAQD/AAJu/wAkSUlKSUkDgP7b/ty3AST+3P4AbgLbASX9qDN1SXk0z0xubttubklJAW5JSklJSkkAAAAFAAD/gAQAA4AACQAVAB4AJAAnAAABESMRIREhFSERARUzFSMVIzUjNTM1ARMjFScjByMTAREjESE1AQczA25u/W4B2/23A0lubklubv7bihwxwzBu2wJuSfzbASU9egLu/gABkv1ubgNu/dtuSW1tSW4Bkv6T3JOTAkkBJf1uAklJ/km3AAAABAAA/38EAAOBAA0AHAAqADgAACU3BhcWDgIrASIuASclBQ4CDwEjIi4CNzYnATIeAgcGBwURND4CJTIeARcVESUmJyY+AgFtAQYTCgolNx8lNVw+CQKQAWoIOlYzDSUfNyUKChAC/n8uUjQNDzkU/okqTWUCEkh6TAT+iRQ5Dw01UZoLQjodPTMcMFM19WMyUTEDAR0yPR4wOAHKKktbK6JrZgFbN2VNKpJFd0gO/qRnaqIrW0sqAAUAAP+ABAADgAAJABgAJQApAC0AAAERIxEhESEVIREBMh4BBgcXBycGLgI+ARciDgEUHgEyPgE0LgEDFSE1JRUhNQQAbvzcAdv9twMfNFkvCB48KjwxeGAlJWE8IzwiIjxGOyMjO4v+kgHc/bYDgP23Adv83G4EAP2aN1xoKjwqPCMBRnJyRzgiPEY8IiM7RjsjATBtbbdubgAAAAQAAP+ABAADgAAJABIAHgAkAAABESMRIREhFSERARcHIRUhFwcnAxUzFSMVIzUjNTM1AREjESE1A25u/W4B2/23Axg0dQEp/tN5NM9bpKRupaUCgEn82wLu/kkBSf1ubgNu/jozdUl5NM8BuaRupaVupAFu/bcCAEkAAAAFAAD/jQQAAzcABgANABYAHwAoAAABESEFNSERBSERIRUlMwEyFhQGIiY0NiEyFhQGIiY0NiMyFhQGIiY0NgQA/pP+kf7cA5L83AEZAQz//ZMeKys9KysB1R8rKz0rK70eKys8KysDN/0Bq6sC/2793Xp6AUgrPSsrPSsrPSsrPSsrPSsrPSsACQAA/9UEAAMrAAMABwAgADkAVABYAGgAeACJAAABESERBSERIQEyHgEXFhcVERYOAiIuAScmJzURJj4CITIeARcWHwERFA4CIi4BJyYnNREmPgIhMh4BFxYfAREHBgcOASIuAScmLwERNzY3PgEBFSM1AyYGDwEVFBYzFjY/ATU0JgUmBg8BFRQWMxY2Nz0BNiYXJgYPARUXHgEyNj8BNScuAQQA/AADvPyIA3j9FRQkHAgGAgEQHSUnJB0HBwEBEB0kAYQUJB0HBgIBEB0kJyUcCAYCARAdJAEKFCQcCAYBAQECGw4lJyUcBwcBAQEDGw4k/ohElQsRAQERDQsRAgESAWQLEQEBEQ0LEQIBEucLEQEBAQIRFRECAQECEQMr/KoDVkX9NAJQDhsSDREM/uwVJhwODhsSDxALARQVJxsODhsSDREM/uwVJhwODhsSDxALARQVJxsODhsSDREM/uwLJRoNDg4bEg8QCwEUDCUZDQ7+akREAUgBDgsG/A4RAQ4LB/wMEwEBDgsG/A4RAQ4LB/wMEwEBDgsG/AcLDg4LB/wGCw4AAAL//wAABAACgQAPABwAAAEyHgEUDgEjISIuATQ+ATMVIg4BFB4BMj4BNC4BAwBGdUVFdUb+AEZ1RUV1RjRYNDRYaFg0NFgCgEV1jHVFRXWMdUVANFhoWDQ0WGhYNAAAAAUAAAAABAAC1gADAAcAFgAlADQAAAERIREFIREhARc3FwcXBycHJzcnNxc3IRc3FwcXBycHJzcnNxc3IRc3FwcXBycHJzcnNxc3BAD8AAOr/KoDVv1nBkIMPSIgLS0hIj0NQQcBKwdBDD0iIC0tICE9DUEHASsHQQw9IiAtLSAhPAxBBwLV/VYCqlX+AAFvRA8mGzoYMzMYOhsmD0REDyYbOhgzMxg6GyYPREQPJhs6GDMzGDobJg9EAAAABQAA/4AEAAOAAAMABwAYACUAOQAAAREhEQUhESEBNh4BFA4BJicmJyY0NzY3NhciDgEUHgEyPgE0LgEHMhYdATMyFhcVFAYrASImPQE0NgQA/AADkvzcAyT+bVyhXV2ht05MLC4uLExOXUJwQUFwhHBBQXBmFBtZEhoDGxOJExwcA4D8AAQAbvzcAucBWp+4oFoDLi5MT7dPTC4vYUFwhHBBQXCEcEFMHBN8FhEHFBsbFKoTHAAAAAQAAP+ABAADgAADAAcADwATAAABESERBSERIQkBIycjByMBFyMHMwQA/AADkvzcAyT+jQEHdDT4M3UBBx4EUKcDgPwABABu/NwC5v19kpICg57eAAMAAAAABAAC1gADAAcACgAAAREhEQUhESEDBycEAPwAA5L83AMkPaqrAtX9VgKqbf4wAT2qqgAAAgAA/4AEAQOBAAMAFgAACQEXCQEFEQEnNxc3NjIfARYUDwEXBycCV/4pVgHX/lT+/wICVpRsbBIyEoASEmxqlFUCL/4rVQHV/asFAQUB/1WVbGwSEn8SMhJsaZVWAAAAAwAA/4AEAAOAAAMABwATAAABESERBSERIQEVMxUjFSM1IzUzNQQA/AADkvzcAyT+pe7ubu7uA4D8AAQAbvzcArfubu7ubu4AAQAAAAADbgI3AAIAACUBIQIAAW79JMkBbgAAAAEAAAAAA24CNwACAAAJASECAAFu/SQCN/6SAAACAAD/3AQAAyMABAAJAAAJARchCQEhJxsBApL9bpcBrwG6/g7+ulP89AMi/VecAcn+eFsBDP73AAQAAP+KBAACygAKAA4AEgAWAAABFwczNTMVIRcHLwEVITUBFSE1ARUhNQMYNHXgSf7TeTTPSf5JA278kgNu/JIBKDN1brd5NM9Mbm4BEm5uARJubgAAAAAFAAD/lQPrA2sABwAQACUALQA1AAA3HgEXFS4BJyEzDgEPATU+AQEyFxYXFhQHBgcGIicmJyY0NzY3NicVDgEHIz4BJR4BFyMuASeJH3dPfLglA2J0JKx2E093/qhPRUInKCgnQkWeRUInKCgnQkVDT3cfdCW4AaB8uCV0H3dP7k93H3QluHx3sykGdB93AgYoJ0JFnkVCJygoJ0JFnkVCJyjGdB93T3y4JSW4fE93HwAAAAAFAAD/gAO3A4AAAwAHAAsADwATAAABESERBSERIQEVITUlFSE1JRUhNQO3/JIDAP1uApL/AP7cAbb+SgG2/koDgPwABABu/NwBJElJk0pKkklJAAACAAD/fQQAA4EAPgB8AAABIwYPAg4BByMiJi8CJiciBgcGBwYVFBcWFxYXFhcWPgE3NTQ3PgEzMhYXFRQeATc2NzY3Njc2NTQnJicmBRYfAh4BMjY/AjY/ASMyFxYXFhcWFRQHBgcGDwInJicmJyYjIgcGDwEGDwEnJicuAScmNTQ3Njc2NzYC2wZFKgkcDBcSDBkaDhMSK0QtVyU/ISIiHzo5SjAvGTAgAwoHGQ0WHgMfMhsvMEo5OiAhIiE/Sv3xLx4JFRkySjIZFREeIAsEGBodGCcUFR0cMzFACQkBAw0SIyU4PyckDwUCAQIBCQg/ZRwdFRQnGB4aA4AJEQQOBQUBBQYKCBEJGhkpRUhgdXdxZmRJMBEIBiAbCkIxKytlSxkfJAkKEDBKY2Vxd3ZhSEUpMW0GDAQKDAsLDAoHCgQBBwgQGi0vRmdoZFlXQAgIBjQzRCQnMCxTHA0OFgEHCECxY2lmRS8tGhAJBwAAAAIAAP+fBFADgQA8AEwAACUhMhYdARQGIyEiJj0BISImNREjIiY9ATQ2OwEyFh0BFAYrARUhNTQ2MyEyFh0BFAYjISImPQEhESE1NDYBISImPQE0NjMhMhYdARQGAgwCBxkjJBj9+Rkj/qQQFhEYJSQZaRkkJRgRATUkGQIGGSQlGP36GST+ywE1JgIj/VkcJiUdAqcZIySHJhxjGiglHQsWEAKFKRpjHCYmHGMaKecLGSkmHGMaKSYdC/7QERooAhEpGmMdJSYcYxopAAcAAP+rBO0DgAAMABwAIQA1ADkASgBSAAAlDwEjIiYnPQE0NjczITMyFhcdARQGByMhNzM1IxMXAQc3AQchHwEVDwEzByEiJic9ATQ2PwEBFwcvATIWFx0BByEiJic9ATQ2NzMFIRcdAgchAWoWPuEUHgMaFAcDQikTHgMaEwf+0GeUW7Gf/dPVNQE9av7vAQEBAdVq/nUUHgMaFAcED6hwqDQTHgOt/Q4UHgMaFAcDNv3qAgICFrkV+BoTB6UTHgMaEwelEx4DaTsCXp/90jXUAZ1qAwQsBARpGhQHpBQdAwEBHahwqLYaFActqxkUB6QUHgNpBAQsBAMAAAMAAP+EA7cDXAADAAkADQAABRUhNQEXAQc3ATcXBycDt/ySAhSc/kjPNAG4m5tomw5ubgLOm/5IM88Bt5ubZ5sAAAAACQAA/4AD3gM8AAMABwALAA8AGwAfACMAJwArAAABESERBSERITcjFTMlIxUzARcHFwcnByc3JzcXJyMVMyUjFTMBIxUzJSMVMwPe/EQCZ/7uARLuiIj9moiIATUxSUgwSEkwSUkwSe2IiAJmiIj9moiIAmaIiAM8/EQDvGf9Eaurq6sB7DBJSDBISDBISTBJO83NzQHeqqqqAAAABgAA/4AEzQOAAAMABwALAA8AEwAXAAA3FSM1IRUhNQMVIzUhFSE1AxUjNSEVITXNzQTN/GZmzQTN/GZmzQTN/GZNzc3NzQGZzMzMzAGazc3NzQAAAwAA/4AEAAOAAAMABwA+AAABESERBSERIQEyFx4BFxYVFAcGDwEGBxcWFx4BHwEWHwE/ATY3NjMyFxYXFhUUDwIGIyImLwEuATU0PwI2BAD8AAOS/NwDJP3RDxYPIwsOEQYKEwQEAgYNFjIgEAkHBwIHBwUMEA0ZMCgWHw0RKiEogzgMN1IbCQkgA4D8AAQAbvzcApIWEDIWGQ0QDAQFCAIDBg0UHzMWCgUDAwQPEQgQDRokFQ8VHAsNG1I3DDiEKCEqDQomAAAEAAD/mQReA4AABQALABQAGAAAARchESERBSERIREhHwEHJxUjNQcnARUhNQHfUAIu+6MBj/7pA239+lDNR1JlVkcChP6ZA3/M/OcD5Xf9CgIhOs1IU+fqVkgCJXd3AAAGAAD/gAQAA4AAAwAHAAsADwATABcAAAERIREhESERByERIQEjETMTESERBSEVIQI5/ccEAP5yq/6rAVUBx6qqcvwAA4785AMcAfL9jgJy/Y4CcnL+cgGO/nIDjv6rAVVycQAABgAA/4AEAAOAAAMABwAMABAAFAAYAAABESERBSEVIScVITUhAREhEQUhFSEnFSE1BAD8AAOO/OQDHI7+AAIAAQD8AAOO/OQDHI7+AAFH/jkBx3LjqnFyAuP+OQHHcuOqcnIAAAP///9/BAEDgQAPAB8ALwAAATIWFREUBiMhIiY1ETQ2MwUhIgYVERQWMyEyNjURNCYBNz4BLgEjISIOARYfARYyA6sjMjIj/KojMjIjAyv9ABIZGRIDABIZGf6MmQkFChUN/s4NFQoFCZkMJAOAMiP8qiMyMiMDViMyVRkS/QASGRkSAwASGf3JmAoZGA4OGBkKmA0AAAAAAwAA/4AEAAOAABMAFwAfAAATFSE1MxUjETMVIzUhFSM1MxEjNQUhESElETM1IRUzEZIC3JJJSZL9JJJJSQNu/SQC3P68rP5UqwOASUmS/SSSSUmSAtySkv0kaQHBSUn+PwAAAAX///+ABgEDgQArADsATABcAGwAAAEyHgEdATMyHgEdATMyHgEVERQOASMhIi4BPQEjIi4BPQEjIi4BNRE0PgEzAREUDgEjIR4BMyEyNjURNCcRFA4BIyEXHgEzITI2NRE0JyEiBhURFBYzITI2NRE0JgUhMhYVERQGIyEiJjURNDYElR0xHRUdMR0VHTEdHTEd+9YdMR0VHTEdFR0xHR0xHQUVHTEd/FwIGQ4DwBYflR0xHfxbAgcZDgPAFh+1/EAWHx8WA8AWHx/8lQLqFiAgFv0WFiAgA4AaLBogGiwaIBosGv3AGiwaGiwaIBosGiAaLBoCQBosGv6T/k0aLBoOEhwUAeASkv5MGiwaBAwQHBQB4BOdHBT+IBQcHBQB4BQcYBwU/uAUHBwUASAUHAADAAD/qQNWA4AAFwAlAC8AAAEyFhURFA4BJi8BJiIPAQ4BLgE1ETQ2MxMRFBY/ATYyHwEWNjURJSE1NCYjISIGFQMrERkMFhgK9wwcDPcKGBYMGRErEwjGDiIOxggT/gACAAoH/iIHCgOAGRL8gAwUCwIHuggIugcCCxQMA4ASGf6r/iILCQaVCgqVBgkLAd5VmgcKCgcAAAUAAP+ABAADgAAAAAwAIAAwAEAAABEzITIVERQjISI1ETQFMh4BFREUDgEjISIuATURND4BMwUhIgYHERQWFyEyNjcRNCYHMh4BBg8BBiIvAS4BPgEzgAMAgID9AIACwCM7IiI7I/6AIzsiIjsjAYD+gBklAiIZAYUZJQIlcwkRBwQHZwoaCmcHBAcRCQOAgP0AgIADAIDAIjsj/oAjOyIiOyMBgCM7IkAiGf57GSUCIhkBhRslwAsSEwdnCgpnBxMSCwAKAAD/gAQAA4AAAAAMACYANgBGAFsAZgBvAHcAgQAAETMhMhURFCMhIjURNAEjNCYjISIGFREUFjMVIyImNRE0NjMhMhYVBTQ2MyEyFhURFAYjISImNRMRFBYzITI2NRE0JiMhIgYXFA4CKwE1MzIXHgEHDgEHHgEXFgc0JisBFTMyPgInNCYrARUzMjY3FSM1IzUzFRcnFSM1Mxc1MxWAAwCAgP0AgALIMA4K/mgKDg4KGBQcHBQByBQc/lgcFAHgFBwcFP4gFBwwDgoBsAoODgr+UAoOpAgPFQs9NgoIEw4HAQUEBgkFCCYOCRMTBAkGBQ0LBwwMBwt9JzGJcjsnIDknA4CA/QCAgAMAgP7YCg4OCv7ICg4wHBQBaBQcHBSAFBwcFP6wFBwcFAE4/uAKDg4KASAKDg69DhYPCL4EByYTBQcCAgkHDhENDDEDBglUCgkmCBuZmSUlm2xqvmBgwAAAAAcAAP+ABAADgAAAAAwAHAAoACwAMAA4AAARMyEyFREUIyEiNRE0ATIeARQOASMhIi4BND4BMwUhIgYUFjMhMjY0JiMHIzchByM3IQcjIiY0NjOAAwCAgP0AgALgK0orK0or/kArSisrSisBwP5AKDg4KAHAKDg47zuAOwFAO4A7/wA7Hig4OCgDgID9AICAAwCA/qArSlZKKytKVkorQDhQODhQOMDAwMDAOFA4AAAACAAA/4AEAAOAAAAADAAQABQAGAAcACAAJAAAETMhMhURFCMhIjURNBchESElIRUhFSEVIRUhFSEVIRUhJSERIYADAICA/QCAwAEA/wABQAFA/sABQP7AAUD+wAFA/sD+wAEA/wADgID9AICAAwCAwP8A4EBAQMBAQEDg/wAAAAAFAAD/fwTHA4EAIAAuADsASABXAAATMh4BBgcVIRUhFSEVIRUUHgEfATMVIyIuAS8BES4BPgEFITIeARQOASMhIiY0NgEUBiMhIiY0NjMhMhYRFAYjISImNDYzITIWERQGIyEiLgE0PgEzITIWmDNOETMwARf+6QEX/ukhOSQNjIw8aEAEATAzEU4BSgLpDBYNDRYM/RcTGxsDKxwT/dETGxsTAi8THBwT/dETGxsTAi8THBwT/dEMFgwMFgwCLxMcA4BCZFgRZV27XS4kPScDAV06YzwQAggRWGRCXQ0VGRYMGycb/roTGxsmHBz+1hMcHCYbG/7WFBsMFhkWDBsABAAA/38ENwOAAA8AHwAvAD8AABMhMhYVERQGIyEiJjURNDYTITIWFREUBiMhIiY1ETQ2KQEyFhURFAYjISImNRE0NhMhMhYVERQGIyEiJjURNDZhAYYRGRkR/noSGRkSAYYRGRkR/noSGRkCNgGGEhkZEv56EhkZEgGGEhkZEv56EhkZAVsZEf56EhkZEgGGERkCJRkS/noRGRkRAYYSGRkS/noRGRkRAYYSGf3bGRH+ehIZGRIBhhEZAAAGAAD/fwThA4AAAwAHAAsAEgAZACMAACUhESEBIREhASERIQEhMjY1ESEBIREhERQWAyERNCYjISIGFQHUAW/+kQGdAXD+kP5jAW/+kQGdAUUSGf6Q/PABRf6QGRkEqxkS+6sSGeYBNP7MATT9ZgEz/s0ZEgEI/s0Cmv2REhkCzQEIEhkZEgAAAwAA/38ELwOBAA0AGwAqAAATIREhIi4CNRE0PgIpAREhMj4CNRE0LgIlMhYVERQOASIuATURNDbBAST+3B41KRcXKTUC+f7bASUdNikWFik2/nUPFgoRFBAKFQLu/SQXKTUeAbYeNSkX/SQXKTUeAbYeNSkXkhUQ/EoKEQoKEQoDthAVAAAAAAMAAP9+BDEDgAAYADEARQAAATYeAQYPAQUOAS8BJS4BNz4BHwEFHgE/ASU2HgEGDwEFDgEvASUuATc+AR8BBR4BPwEDAR4BBwYHAQYiJwEuATc2NwE2MgPzDyAOBQsG/nYqYSsO/nYOCAgGGw4GAYoZOBkMAYoPIA4FCwb+diphKw7+dg4JCAcbDgYBihk4GQwUAcUOCAgFCf47EioS/jwPCAgFCgHEEioBmwkJHR4KBPMaBBcH8gohDw0LBQPyDwMMBi8JCR0eCgTzGgQXB/MJIQ8NCwUD8g8EDQYDj/7pCSEQCQb+6QsLARcJIRAJBgEXCwADAAD/fgOuA4EAEwAjADcAAAERFAYHBQYmJyY1ETQ2NyU2FhcWAQUWFAcFBiInJSY0NyU2MgERFBYXBRY2NzY1ETQmJyUmBgcGA60NDP6XBxAEAw0MAWkHEAQD/koBlwwM/mkNHg3+aQwMAZcNHv4gDQwBaQcQBAMNDP6XCA8FAgH//nMNFgbGBAQGBQUBjQ0WBscEBAcFAXXeBhkG3QcH3QYZBt4H/n/+cwwWB8YEBAYFBQGNDRYGxwQEBwUAAAAHAAD/fwQvA4EAFQAeAC4ANwBFAE4AXAAAATIeAhURFA4CIyEiLgE1ETQ+ATMTIgYUFjI2NCYFISIOARQeATMhMj4BNC4BASIGFBYyNjQmBSEiBhQWMyEyPgE0LgEBIgYUFjI2NCYFISIGFBYzITI+ATQuAQOcHTYpFhYpNh39JShDKChDKEkfKio9KysCT/5KChEKChEKAbYKEQoKEf2JHyoqPSsrAk/+ShAVFRABtgoRCgoR/YkfKio9KysCT/5KEBUVEAG2ChEKChEDgBYpNh39JB02KRYnRCcC3CdEJ/0lKz0rKz0rJQoRExEKChETEQoBSSs8Kys8KyQWHhYKERQRCgFJKz0rKz0rJRUfFQoRExEKAAAAAwAAAAADtwLKAAMABwALAAAlFSE1ARUhNQEVITUDt/ySA278kgNu/JKlbm4BEm5uARJubgAAAAACAAD/yQNuAu4ABwALAAAJASMnIQcjARcjAzMCJQFJkz/+yD+TAUksDmHQAu7827e3AyXG/uoAAAIAAP/JA7cDNwADAAcAAAERIREFIREhA7f8kgMA/W4CkgM3/JIDbm79bgAAAQAAAAAEAAHKAAMAABEhFSEEAPwAAcmSAAAAAAEAAAAAA1QC1gAGAAABJyUDJwEnAl+KAX8riv4rQAIhiiv+gIv+K0AAAAAAAgAA/+8DuAM8AAMACAAAATcXBwEHNwEXAsZgkWD91cIxAfuRAtthkWH91TDBAfuRAAAAAAL///9/BAADgQAYAC0AAAEyFx4BFxYUBw4BBwYiJy4BJyY0Nz4BNzYXIgcGBwYUFxYXFjI3Njc2NCcmJyYCAGhfXI4nKCgnjlxf0F9cjicoKCeOXF9obV5bNTc3NVte2l5bNTc3NVteA4AoJ45cX9BfXI4nKCgnjlxf0F9cjicobjc1W17aXls1Nzc1W17aXls1NwABAAAAAAPsAmkABwAACQMXCQIDhP79/v7+lmcBAwECAWoCaf79AQP+lmgBA/79AWoAAAAAAgAA/8kDtwM3AAQACQAACQEDIQMlARMhEwIAAbeS/baSAbf+xmgBpGgDN/6S/gACAN/++/6UAWwAAAAAAwAA/8kDtwNcAAcACwATAAAlAyEDMxMhEyUVITUBEyMnIwcjEwFQdQJKdYaB/JKBAu38kgHcwX9gDmB/we7+2wEl/tsBJZJubgHb/krx8QG2AAAABQAA/4AEAAOAAAMABwALABUAIQAAAREhEQUhESEnFSE1ARUhFTMVIxUjEQEXNzMHFyMnByM3JwQA/AADkvzcAyRJ/W4Bbv8AkpJuAbdJSUlubklJSUltbQOA/AAEAG783G1JSQJubpJutgIk/wBubpKSbW2SkgAADwAA/38EAAOAAAMABwALAA8AEwAXABsAHwAjACcAKwAvADMANwA7AAABESERBREjEQUVIzUlESMRJSERIScVIzUlESMRIxUjNSEVIzUBESERIREhEQchESEBIREhJRUjNSEVIzUB2/4lApJtASRuASVu/dz/AAEAN5ICpG5JbQHbbv5J/iUEAP4lt/8AAQACJP8AAQD9pZICtpIBW/4lAdu2/tsBJZOSkpP+2wElSf8AyZKSpP7cASSSkpKSAiX+JQHb/iUB227/AAEA/wDJkpKSkgAFAAD/gAO3A4AAAwAHAAsADwAbAAABESERBSERISUVITUlFSE1ARUzFSMVIzUjNTM1A7f8kgMA/W4Ckv8A/pICSv22AVyAgG6AgAOA/AAEAG783LdKSpJJSQGkgG2AgG2AAAAABgAA/4AEAQOAAAMABwALABEAFQAgAAABIREhJRUhNSUVITUlMzU0JiMHFSE1ASERITMeAhURIwMA/W4Ckv8A/pICSf23AtxJKx6T/bcC3PySA24LJT4kkgMS/Ny3SkrbSUnbbh4rt0lJ/SUEAAMpQSX/AAACAAD/gAO3A4EACwAYAAABFSERIxEjESMRITUBMh4BFA4BIi4BND4BA7f/AG6Sbv8AAbcdMx4eMzsyHh4yAoBu/W4BSf63ApJuAQAdMzszHR0yPDIeAAAABAAA/4AEAAOAAAMACwAPABMAAAERIREXIxEhESMRIQEhESEnFSM1BAD8ALdJAyRJ/W4CSf4AAgBJSQOA/AAEAG783AMk/pMBbf7c27e3AAACAAD/fwO3A4AABgANAAABESMlNxcRIQUHJxEjEQIAbv8AJdsBJQEAJdtuA4D8ANtutwNu2263/JIEAAAE////fwQAA4EAGAAtADYARwAAATIXHgEXFhQHDgEHBiInLgEnJjQ3PgE3NhciBwYHBhQXFhcWMjc2NzY0JyYnJgMyFhQGIiY0NhMyHgIHAw4BIiYnAyY+AgIAaF9cjicoKCeOXF/QX1yOJygoJ45cX2htXls1Nzc1W17aXls1Nzc1W153IC0tQC0tIBQkGgwCIwIhLCACJAIMGyQDgCgnjlxf0F9cjicoKCeOXF/QX1yOJyhuNzVbXtpeWzU3NzVbXtpeWzU3/aEtPy0tPy0CMxAdJRP+mBYdHRYBaBMlHRAAAAAC////fwQAA4EAGAAtAAABMhceARcWFAcOAQcGIicuAScmNDc+ATc2FyIOAh4DPgMnCQE3FwEuAQIAaF9cjicoKCeOXF/QX1yOJygoJ45cX2hXnnIzFluRqqeITQgh/j/+3lLQAYU6pAOAKCeOXF/QX1yOJygoJ45cX9BfXI4nKG5HgqerlGEdK26brFL+PwEiUdABhEdOAAT///9/BAADgQAYAC0ATABYAAABMhceARcWFAcOAQcGIicuAScmNDc+ATc2FyIHBgcGFBcWFxYyNzY3NjQnJicmAzIWFREzMhYdARQGKwEiJj0BNDY7AREjIiY9ATQ2MzcyHgEUDgEjIiY0NgIAaF9cjicoKCeOXF/QX1yOJygoJ45cX2htXls1Nzc1W17aXls1Nzc1W15IBwskCAsLCLYICwsIJCQICwsISRMiFBQiEx8qKgOAKCeOXF/QX1yOJygoJ45cX9BfXI4nKG43NVte2l5bNTc3NVte2l5bNTf/AAoI/qULCEkHCwsHSQgLAQAKCEkICrcTIigiEys8KwAE////fwQAA4EAGAAtADYAXQAAATIXHgEXFhQHDgEHBiInLgEnJjQ3PgE3NhciBwYHBhQXFhcWMjc2NzY0JyYnJgMyFhQGIiY0NhMyHgIOAQcVFAYiJj0BNDY7AT4CLgMOAQ8BFg4BJic1ND4BAgBoX1yOJygoJ45cX9BfXI4nKCgnjlxfaG1eWzU3NzVbXtpeWzU3NzVbXm0bJSU2JSUbQXBIDTFiQB4qHhUPGihCJQEpRFFGKwMBARwpHwNFdQOAKCeOXF/QX1yOJygoJ45cX9BfXI4nKG43NVte2l5bNTc3NVte2l5bNTf9biU2JSU2JQJmPGmBdlIMFBUeHhVQDxYDLEZQRCkCJUIpCxQeAhkUB0Z2RAAAA////38EAAOBABgALQA6AAABMhceARcWFAcOAQcGIicuAScmNDc+ATc2FyIHBgcGFBcWFxYyNzY3NjQnJicmBRc3FwcXBycHJzcnNwIAaF9cjicoKCeOXF/QX1yOJygoJ45cX2htXls1Nzc1W17aXls1Nzc1W17+v9vYTtjcTtzfTuDcTQOAKCeOXF/QX1yOJygoJ45cX9BfXI4nKG43NVte2l5bNTc3NVte2l5bNTds3NhN2dtO3OBO39xOAAAAA//3/4gD+QOBABMAJAAoAAABMh4DBgcXBycOAS4DPgIXIg4BFB4BMjc2NzY0JyYnJhMVITUB3FqnhE4ONDinTahRxcmqaRo9iLlnYqpiYqrFVVMxMjIxU1Wd/gADgEJ5o7KsR6dOqEAxI3WuysWYVG5iqcSqYjIwU1XHVVMwMv7JbW0AA//3/4gD+QOBABMAJAAwAAABMh4DBgcXBycOAS4DPgIXIg4BFB4BMjc2NzY0JyYnJgcVMxUjFSM1IzUzNQHcWqeETg40OKdNqFHFyappGj2IuWdiqmJiqsVVUzEyMjFTVSzJyW7JyQOAQnmjsqxHp06oQDEjda7KxZhUbmKpxKpiMjBTVcdVUzAybcptycltygAAAAMAAP/JBAADXAAFAAsADwAAARchESERBSERIREhARUhNQG3SQIA/AABbv8AAyT+JQHb/rcDW9v9SQOSbf1JAdsBE25uAAAAAAQAAAAAA7cC7gADAAcACwAPAAABESMRAxUhNQEVITUBFSE1A7dubv1uApL+AAIA/W4C7v0kAtz9t25uARJubgESbm4ABAAAAAADtwLuAAMABwALAA8AABMRIxEBFSE1ARUhNQEVITW3bgNu/W4CAP4AApL9bgLu/SQC3P23bm4BEm5uARJubgAFAAAAAAO3Au4AAwAHAAsADwATAAABESMRIREjEQEVITUBFSE1ARUhNQO3bv1ubgK3/gACAP4AAgD+AALu/SQC3P0kAtz9t25uARJubgESbm4AAAADAAAAAANuAsoAAwAHAAsAACUVITUBFSE1ARUhNQNu/SQCbv4AAm79JKVubgESbm4BEm5uAAAAAAMAAAAAA7cDNwADAAcAFQAAJRUhNSUVITUlByc3FwchJzcXByc3IQO3/JIDbvySAQM0z880dQJSdTTPzzR5/aaAbm7bbW1yNM/PNHR0NM/PNHkAAAQAAP+ABAADgAADAAcACwAPAAABESERBSERIQEVITUlFSE1BAD8AAOS/NwDJP63/pICSv22A4D8AAQAbvzcAiRtbbdubgAAAAQAAP+ABAADgAADAAcACwAPAAABESERBSERISUVITUlFSE1BAD8AAOS/NwDJP63/pICSv22A4D8AAQAbvzc225ut25uAAAAAAQAAP+ABAADgAADAAcACwAPAAABESERBSERIScVITUlFSE1BAD8AAOS/NwDJG3+kgFu/bYDgPwABABu/Nzbbm63bm4ABAAA/4AEAAOAAAMABwALAA8AAAERIREFIREhJxUhNSUVITUEAPwAA5L83AMk2/6SAdz9tgOA/AAEAG783NtubrdubgAEAAD/gAQAA4AAAwAHAAsADwAAAREhEQUhESEDFSE1JRUhNQQA/AADkvzcAyRt/pIBbv22A4D8AAQAbvzcAiRtbbdubgAAAAAEAAD/gAQAA4AAAwAHAAsADwAAAREhEQUhESEDFSE1JRUhNQQA/AADkvzcAyTb/pIB3P22A4D8AAQAbvzcAiRtbbdubgAAAAAEAAD/gAQAA4AAAwAHAAsADwAAAREhEQUhESEDFSE1JRUhNQQA/AADkvzcAyTb/pIB3P22A4D8AAQAbvzcAW1tbbdtbQAAAAAEAAD/gAQAA4AAAwAHAAsADwAAAREhEQUhESEDFSE1JRUhNQQA/AADkvzcAyRt/pIBbv22A4D8AAQAbvzcAW1tbbdtbQAAAAAEAAD/gAQAA4AAAwAHAAsADwAAAREhEQUhESEBFSE1JRUhNQQA/AADkvzcAyT+t/6SAkr9tgOA/AAEAG783AFtbW23bW0AAAABAAAAAAPOAlwADwAAEyEyHgEGBwEGIicBLgE+AVgDUAsSCQUH/nIWPBb+cgcFCRICWwwUFgj+chUVAY4IFhQMAAAAAAYAAP+ABAADgAAHABMAFwAbAB8AIwAAARUhESEVIREFFTMVIxUjNSM1MzUFFSE1AREhEQUhESElFSE1BAD8bgGS/gADSW5uSW5u/rf+2wNu/AADkvzcAyT+Jf7bAVtt/wBuAduSbkltbUluN0lJAu7+JQHbbv8ApUlJAAAGAAD/ewQAA4EADwATACMAJwA3ADsAACUyFhchFSEOAi4CPgIHFSM1ATIeAg4CLgEnITUhPgEFFSM1ATIWFyEVIQ4CLgI+AgcVIzUBbixLEAIL/fUNN0VGNRkJKT+StwKSJT8pCRk1RkU3Df31AgsQSwGat/4lLEsQAgv99Q03RUY1GQkpP5K3pTIqbiEuEBIwQ0g6IlxubgHJITpIQzATES0ibikyW25uAckyKW4iLhASMUJIOyFbbm4AAAQAAP+ABAADgAALABcAIAApAAABESERMxUzESMVIxEhESM1IxEzNTMRIREBFwcnNyM1MyclFwczFSMXBycB2/5KbdzcbQO2bdzcbf5KAQzPzzR1u795/dI0dbu/eTTPA4D8AAFJ2wMk2wFJ/rfb/Nzb/rcEAP7Nz880dEl5NDR0Sng0zwAAAAAFAAD/gAO3A4AAAwAHAAsAGQAdAAABESERBSERIScVITUBETMVIzUzNSM1Mjc2NwMVIzUDt/ySAwD9bgKSJP22AdxJ20lJHRATCbfcA4D8AAQAbvzct25uAgD+tklJ3EkICBX+tklJAAUAAAAAA7cC7gADAAcACwAPABMAABMRIxEBESERBSEVIQERIREFIRUht24C3P4AAZL+2wElAQD9bgIk/kkBtwLu/SQC3P5J/tsBJW5JAm7+2wElbkkAAAAEAAD/fwQAA4AAFwAbAB8AIwAAAREjFSEVMxEhETM1IRUzESERMzUhNSMRAyMVMyUjFTMBIxUzAtu2AW1u/ttu/W5u/ttuAW22bklJAttJSf7c3NwDgP5Jbrb+2wElbW3+2wEltm4Bt/y3SUlJAyTbAAAAAAcAAAAABAAC7gADAAcACwAPABMAFwAbAAABESERBSERIQERIxEhESMRIREjESERIxEzESMRBAD8AAOS/NwDJP1uSQEAbgFJkgEAJZMlAu79JALcbv4AAdv+SgG2/koBtv5KAbb+SgG2/koBtgAAAAAFAAD/gAQAA4AAAwAHAAsAEwAXAAABESERBSERIScVITUTFSMRIxEjNQEVITUEAPwAA5L83AMkJP5JSYBugALc/tsDgPwABABu/Nzbbm4Bt27+SQG3bv8Abm4AAAMAAP+ABAADgAALAA8AGwAAASEVIzUhFSERIREhBSERIQEVMxUjFSM1IzUzNQKS/txuAgABAPwAApIBAPzcAyT+paSkbqSkAzeS29v82wMlbv23AgClbqSkbqUABAAA/4ADvQN8AAMACgASABYAAAUVITUJAQcDBRMlFwcDNxcHJTcRBxc3A7f8kgI9ATa1NP17tAECNels7TTtAW8ZM2doEm5uA47+yYH+/bUChzRpGv6S7TTtbOkBAmdnMwAAAAYAAP9/BAEDgQAQABYAHgAvADwASQAAATIeARQOASInJicmNDc2NzYXBxY+AiciDgIXNyYBMh4BFA4BIicmJyY0NzY3NhciDgEUHgEyPgE0LgEHMh4BFA4BIi4BND4BAttPiE5OiJ5EQicoKCdCRPL3NXdUEr4wUzIDFvcn/hxOiE5OiJ5EQicoKCdCRFAxVTExVWJUMTFUMR0zHR0zOzMdHTMByU6InYhOKCdCRJ9EQico0PcbElR3ly9SYCr3FQIkToidiE4oJ0JEn0RCJyhuMVViVDExVGNUMUkdMzszHR0zOzMdAAAFAAD/gAQAA4AAAwAHADAAQABbAAABESERBSERIQMyFhUUBgcVFhcWFA4BIyInNxYzMjY1NCcmIzUyNzY1NCYjIgcGByc2BREzFSM1MxEHNTY3Njc2NyEyFhUUBwYHNjMXFSM1Njc2NTQmIyIHJzY3NgQA/AADkvzcAySdO0cjICMWFyZAJ1UxJSovHyYXGj40GBYcGhUTERMoOP5hSdtJMw4NCAoEAgESNkEiHjcIFGTuVCEoHhsjIykcGh4DgPwABABu/NwCTzgzIC8MAwoYG0k1HDgyKR0bIA4SOREPHRgaCggRMDIG/rdJSQEAASUDCgYMBQFANTE5NDYBAUlJSyoyKR0gJikdDQ8ADAAA/4AEAAOAAAMACwAPABMAFwAbAB8AIwAnACsALwAzAAABESMRBxUhESEVIREBFSM1IxUjNSEVIzUlFSM1NxUjNTcVIzU3FSM1JxUjNSEVIzUhFSM1AjduN/7cAST+bgQAbsVuAQdtAQdubm5ubm5uxW4BB20BB24DgPwABABJbv1ubgNu/QBubm5ubm6ZbW2abm6abm6ZbW2abm5ubm5uAAADAAD/kwPtA2sABwALABMAACUXNyc3CQIDAQcBEwEHJwcXBwEB58+bzk0BHf7J/uRbAdJO/i9aAR1Oz5vPTv7k/c6bz03+5P7JAR0B3v4vTgHSASn+5E7Pm89OAR0AAAADAAD/gAQAA4AAAwAHAA0AAAERIREFIREhAxcJATcXBAD8AAOS/NwDJJFR/mL+/VKxA4D8AAQAbvzcAn5S/mIBA1KyAAgAAP+ABAADgAALAA8AEwAXABsAHwAjACcAAAEVITUzFTMRIREzNQEhESElFSM1IRUjNSEVIzUlFSM1IRUjNSEVIzUBAAIAbpL8AJIDAPzcAyT9t7cBybYBybf+krcBybYBybcDgJKSkvySA26S/pL93Ntubm5ubm7cbm5ubm5uAAAAAAgAAP+ABAADgAAFAAkADQARABUAGQAfACMAACURITUhEScRIREFIRUhJRUjNQERIREFIRUhARUhESMRARUjNQQA/pIBJSX83AK3/bYCSv7b2wJt/NwCt/22Akr+Sf7bSQIA2+7+kkkBJW3+kwFtbZNuSUkCSf6TAW1tkwFuSf7bAW7/AElJAAAGAAD/yQPcA4AABQALABEAFwAdACMAAAEXFQcnNSUXFQcnNSUHFRc3NSUHFRc3NQEXFQcnNTcHFRc3NQEA29vbAtvb29v+225ubgGSbm5u/pLb29vbbm5uAcmS3JKS3JKS3JKS3CRJkklJkklJkklJkgJuktySktwkSZJJSZIAAAUAAP+ABAADgAAFAAsAEQAVABsAACURITUhEQEXBxcHCQMnNy8BAyMTJxUhESMRBAD+kgEl/bckt7ck/tsCbgEA/tskt5MkSW5Jkv7bSe7+kkkBJQG3bre3bgElASX+2/7bbre3bv22AkrbSf7bAW4AAAAABwAA/4AEAAOAAAIABgAKABAAFAAYABsAACUVIxMVASMBFQEjARUBIzUBIwE1ASMBNQEjBzUEALe3/reSAdv9bpMDJfxJSQO3t/0AAm6T/iUBSbeSN7cB25L+twMlk/1uBABJ/ElJA7f9AJICbv4lkgFJkpIAAAAAAwAAAAAEAALcAAMACQAPAAABAyMTBxcHFwcJAyc3JwJubm5u20nc3En+2wLbASX+20nc3ALb/UoCthJu29tuAUkBSf63/rdu29sAAAUAAP+ABAADgAAHAA0AFQAZAB0AAAEVMxEhNSMRBSMRIRUhASMRIREjESEBIRUhJxUjNQNukvySkgO3Sf1tAtz9AEkCkkn+AAG3/pIBbiVJA4CS/JKSA27b/W1JA0n9bgKS/twBJNu3k5MAAAMAAP/JBAADXAAHAAsAEQAAFREhFyEVMwMnEyEDASEnIREhAbdJAZJublcz/W1MApb+kkn/AAK3NwOS29v+JG4BAP8AAdvc/rcAAAAF////fwQAA4AALQA8AEkAUgBWAAABETMyHgEdASM1NCYjISIGBx0BFBYfATUhFSERIRUhNSMiLgI9ATQ+AjsBEQEyHgEGBxcHJwYuAj4BFyIOARQeATI+ATQuAScyFhQGIiY0NhMhFSEDSSUnRCduKx79bhwqAyUbCQGS/rcBSf5uJR02KRYWKTYdJQJoNFkvCB48KjwxeGAlJWE8IzwiIjxGOyMjOzAXICAtISEE/gACAAOA/tsnQyiSbh4rJRwIkxwpAwFuSf7bSdsXKTYd2x02KRYBJf2aN1xoKjwqPCMBRnJyRzgiPEY8IiM7Rjsj5yAtISEtIAFu3AAJAAD/gAO3A4AAAwAHAA0AEwAXABsAHwAlACsAAAERIREFIREhJRUjNSM1IRUjFSM1JxUhNSUVITUlFSE1NxUjNTM1IRUzFSM1A7f8kgMA/W4Ckv4lSUoCSkpJSf7cAbb+SgG2/kpJk0oBtkqTA4D8AAQAbvzct5NJSkpJk21JSZNKSpJJSbeTSklJSpMAAAAI////fwQAA4AAHgAiADIAQABVAF4AYgBuAAABETMyHgEdARQOAisBFSE1IyIuAj0BND4COwERASERIScyHgEUDgEjISIuATQ+ATMlMhYUBiMhIi4BND4BMwEhIgYHHQEUFh8BNSEVMjY3PQE0JgcyFhQGIiY0NhMhFSEnMhYUBiMhIiY0NjMDSSUnRCcWKTYdJf1uJR02KRYWKTYdJQJJ/gACAG4KEQoKEQr+3AoRCgoRCgEkDxYWD/7cChEKChEKAdv9bhwqAyUbCQKSHCoDK1UXICAtISEE/gACAG4PFhYP/twPFhYPA4D+2ydDKNsdNikX29sXKTYd2x02KRYBJf1u/tuAChETEQoKERMRCm4WHhUKEBQRCgE3JRwIkxwpAwFubiUcCJMeKyUgLSEhLSABbtyTFh4VFR4WAAAAAAQAAP+ABAADgAADAAcACwAXAAATESERBREjESERIxEBIREjNSE1IRUhFSO3ApL+bm4Bbm4BbvySSQElAbYBJUkCpf1JArdu/iQB3P4kAdz9SQMlbW5ubQAFAAD/gAQAA4AAAwAHAAoADgARAAABESERBQEzARUBIQMhAREBIREEAPwAA5L9NuUB5f62AUpB/vD+LQE4/sgDgPwABADI/TYB5Zv+tgMk/i3+8ALj/sgAAQAAAAAEAAHKAAsAABMVITUzFSM1IRUjNZIC3JKS/SSSAckkJJIkJJIAAAAHAAAAAAQAAu4AAwAHABYAHgAoAC0ANAAAAREhEQUhESEBMhcWFRQHHgEVFAYHIxEhFSMVIycjNSEXNTMRIycVIxEFFRY1NCcjFRY1NCcEAPwAA5L83AMk/WcwGR0mGB0xN3QB3ElHA0kBSUpJSUpJ/klYTQtKNQLu/SQC3G7+AAGSEBInIR8GKB0pJQIBJEnb20m3t/7ct7cBJKFfBDcsfUkDJyEEAAACAAD/yQO3AzcAEwAfAAAlFSM1IRUjNTMRIzUzFSE1MxUjEQMjNSEVIxEzFSE1MwO3kv22kiUlkgJKkiVJJP22JCQCSiRbkiUlkgJKkiUlkv22AkokJP22JCQAAAUAAP+kA7cDXAADAAcACwAPABMAAAERIxEXIxUzARUhNQERIxEXIxUzAm7ck0pKAZL8kgIl3JNKSgES/pMBbUnbAclubgGk/pMBbUnbAAAABAAA/8kEAAM3AAcACgANABUAAAERIxEhESMRJxcHJRUnAREhETMRIREDbm7+AG6SkpIEAJL9kgIAbv0kATf+kgEA/wABbrdubtzcbgG3/wABAP6SAW4AAAYAAP+ABAADgAAMABUAGQAdACEAJAAAARcRIxEjNSERIRUhEQEXByEVIRcHLwEVITUlFSE1JRUhNSUVMwLb3G7b/kkBSf5JAs80dQEp/tN5NM9J/tsCSv22ASX+2wHckgOA2/6SAQDb/NxuBAD9qDN1SXk0z0xKSttJSdtJSbeSAAAAAAUAAP+ABAADgAAFACMAQABdAGYAAAERIREhEQUjFTMVIxUzFSMVMxUjFTMRITUjFSM1IxUjNSMVIwEyFxYXFhcWBg8BBgcGIicmLwEmJyY3Nj8BNjc2FyIHBgcGBwYUFxYXFhcWMjc2NzY3NjQnJicmJyYHMhYUBiImNDYEAP2S/m4BJbdtbW1tbW23Am1tSpJJkkkBkkdCJS0UBAYHEA4rJz6IPyYsBxQEBgYEFAcsJj9GHB8bLBgHCgoHGCscHzQfHCsYBwoKBxgtGB0eHisrPCsrA4D+bv2SBABut0mSSZJKbQJtt21tbW1t/rYpFy0UBgkQEA0rFyUlFysHFAcJCgYVByoXJTcNDB0QBgkMCQUQHQwODgwdEAUJDAkGEB4LDRIrPCsrPCsAAAQAAAAAA24C7gAMABkAIgAuAAATMhYVERQGIiY1ETQ2ITIWFREUBiImNRE0NgEyFhQGIiY0NhMyHgEUDgEjIiY0NtsfKys9KysCaB4rKz0rK/76HisrPCsrHhQiExMiFB4rKwLuKx79th4rKx4CSh4rKx79th4rKx4CSh4r/kkrPSoqPSsBJBMiJyIUKz0qAAUAAP+ABAADgAAFACkARwBcAHEAAAERIREhEQEXBxYXFhcWBg8BBgcGIyInByc3Ji8BJicmNzY/ATY3NjMyFwEjFTMVIxUzFSMVMxUjFTMRITUjFSM1IxUjNSMVIwEHFg4CJwcWMzI3Njc2NzY0JyYvASIHBgcGBwYUFxYfATcmPgIXNyYEAP2S/m4DiDRtHSYUBAYHEA4rJz5EKCWAM24kHwcUBAYGBBQHLCY/RCsp/hq3bW1tbW1ttwJtbUqSSZJJAf0jAwoaJBIPDw8aHxwrGAcKCgcYfhwfGywYBwoKBxgbHwYJHigUEBIDgP5u/ZIEAP5JNG0UJhQGCRAQDSsXJQx/NG4ZHwcUBwkKBhUHKhclDwHGt0mSSZJKbQJtt21tbW1t/lckEiQaCgMPBA4MHRAFCQwJBhA2DQwdEAYJDAkFEBIfFCgeCQYQBQAAAA3///9/BAADgQAYAB4AJAAoACwAMwA5AD8ARgBNAFEAVQBcAAABMhceARcWFAcOAQcGIicuAScmNDc+ATc2ASMGBz4BJSMeARcmNyMWFzcjFTYBIwYUFzMmJSMVMzY0JyMGFBczJSMWBzM2NAEHDgEHMzY3FTMmBTM1BjcXFhczLgECAGhfXI4nKCgnjlxf0F9cjicoKCeOXF8BzoQgRUx5/dyEJHlMRZ1wJUu6cEv+m44PD44WAbaGhgzchgwMhgGojhYWjg/98Q5HciKEIOdwJf77cEvtBUEfhCR5A4AoJ45cX9BfXI4nKCgnjlxf0F9cjico/UlkYxlnR0dnGWNkYmPFxWMBhzZwNm5u3DZvNzZvN9xubjZwAUYEG2VDZGHFYmLFY2UHYGBHZwAAAAAIAAD/eQQBA4cAKQA4AEcAVQBjAHEAfgCLAAABFgcGBx4BFAYHFhcWBwYuAScOAicmNzY3LgE0NjcmJyY3Nh4BFz4CAQcGBwYfATc2NzY3JicmJQcGBwYHFhcWHwE1NicmASIHBgcWFxY3NjcmJyYFDwEGDwEXFhcWFz8BJiUHBgcfATY3Nj8BJyYnAwcGBwYHFxYXNjc2JyUHBhcWFzY/ASYnJicDXi4CAi5OWFpPMAMDLyJthUdGhmwiLwMCMFJdXFAtAgIuImyGRkeFbf3cCA0JEgQBBSY4MjYSET8BmAg4PBESNjI4JgUEEQz+/xgYKyUjKDk4KCMlKxz+vwcSMxgHBxgzDg4MFxUCQAQPERYLDAszGAcHGDMlBSY4MjYdRT8SCw8B/dIBAQ8LEUBFHTYyOCYDbyBYVnYgV2JXIHhYWiAYF1dFRVcXGCBaVnggWGRYIHZUWCAYF1dFRVcX/TIUJCBCKAUBCicjNRUVBQ8BDQYVFTUjJwoBBShCKgFqAjg7ODUCAzQ4OzgCLwMIFxgJCBkXBgUXKSQfCB4dKRUEBRcZCAkZFgFTAQonJDQjBw8sKDomDw8mOicrDgYjNCQnCgAAAAAFAAD/gAQAA4AACQARABUAHwArAAABESMRIREhFSERARcHFQcnNxcnFSE1ARUhFTMVIxUjEQUXNzMHFyMnByM3JwQAbvzcAZL+AAOvM+o0mzRnxP63AW7/AJKSbgG3SUlJbm5JSUlJbW0DgP1uAiT83G4EAP1fNOoBM5szZ2dJSQJubpJutgIkkm5ukpNubpOSAAAABAAA/4AEAAOAAAMABwALABEAAAERIREFIREhJxUhNQkCNTcnBAD8AAOS/NwDJCT+kv63AW7+ktvbA4D8AAQAbvzc225uAdz+2/7bbre3AAAGAAD/yQPcA4AABQAJAA8AFAAaACAAAAEXFQcnNQEVITUBBxUXNzUlFwUHNwMXFQcnNTcHFRc3NQEA29vbA7b+Sv7bbm5uAgde/vNyFGjb29vbbm5uAcmS3JKS3P8Abm4BJEmSSUmSk3DiAXECvZLckpLcJEmSSUmSAAAABwAA/4AEAAOAAAUACwAPABMAGQAfACMAACURITUhESERIRUhEQUVITUBFSE1ExUhESMRIREjESE1FxUhNQQA/pIBJfySASX+kgNu/SQC3P0k3P7bSQQASf7b3P0k7v6SSQEl/ttJAW5Jbm4BEm5uAclJ/tsBbv6SASVJt25uAAACAAD/fwQAA4AABwALAAABESEXITchEQUhESEEAP6Sk/22k/6SA5L83AMkA4D8t7e3A0lu/dwAAAQAAP+ABAADgAALABcAIAApAAABESM1IxEzNTMRIREhESERMxUzESMVIxEBFwcnNyM1MyclFwczFSMXBycBt27b227+SQQA/klu29tu/sTOzjR0u794Aho0dLu/eDTOA4D+t9v83Nv+twQA/AABSdsDJNsBSf7Nz880dEl5NDR0Sng0zwAAAAAHAAD/gAQAA4AADQAZAB0AIQAlACkALQAAAREjNSEVMxUjFTMVIREBFwcXBycHJzcnNxcFIxUzESMVMwE1IxUjNSMVJyMVMwQAbv4Abm5u/gADpDSCgjSBgjOBgTOC/gK3t7e3Am23bdxtt7cDgP23SZJukm4EAP2SM4KBNIKCNIGCM4ERkgGSkgEAkpKSkpKSAAAACAAA/4AEAAOAAAMABwANABMAFwAbAB8AIwAAAREhEQEhESEBFwcXByclFwcnNy8BAyMTASMVMyUjFTMlIxUzBAD8AAOS/NwDJP23JZOTJbcCJbe3JZOTJJNJkwFtt7f+3Nzc/re3twOA/AAEAP4A/m4BgCWSkiW3t7e3JZKSEv63AUkBJZKSkpKSAAAHAAD/oQP9A4AAIgAoAC4ARQBaAGAAZgAAARcHFhcWFxYGDwEGBwYjIicHJzcmLwEmJyY2PwE2NzYzMhclFxUHJzU3BxUXNzUFBxYOAiMiJwcWMzI3Njc2NzY0JyYvASIHBgcGBwYUFxYfATcmPgIXNyYBFxUHJzU3BxUXNzUDyDRuHScUBAYHEA4rJz5EKCd9NGweKAITBAYHEA0rJz9EKin9ttvb29tubm4B8iIECBQeEQgJDxAQGh8cKxgHCgoHGH4cHxssGAcKCgcYGiAGChwnFBAR/vXb29vbbm5uAac0bhUnEwcJDxAOKxclDX00bBUoARMHCQ8QDisXJQ+hktySktwkSZJJSZI6IxAhGg8CDwUODB0QBggNCAYQNw4MHRAGCA0IBhARIRMnHQoGEAUCgJLckpLcJEmSSUmSAAcAAP/JA/ADgAAFACEAJwBEAE0AUwBZAAABFxUHJzUhMhcWFxYXFgYPAQYHBiMiJyYnJicmNj8BNjc2JQcVFzc1BSIHBgcGBwYUFxYXFhcWMjc2NzY3NjQnJicmJyYHMhYUBiImNDYDFxUHJzU3BxUXNzUBANvb2wLSR0IlLRQEBgcQDisnPkRHQiUuEwQGBxANKyc//k1ubm4BixwfGywYBwoKBxgrHB80HxwrGAcKCgcYLRgdHh4rKzwrK9nb29vbbm5uAcmS3JKS3CkXLhMHCQ8QDisXJSkXLhMHCQ8QDisXJSRJkklJkhIODB0QBggNCAYQHQwODgwdEAYIDQgGEB4LDhIrPSsrPSsCkpLckpLcJEmSSUmSAAAACgAA/4AEAAOAAAUACwARABcAHQAjACkALwA1ADsAACURITUhESERIRUhESUXFQcnNSUXFQcnNQ8BFRc3NSUHFRc3NQEXFQcnNRcHFRc3NQMVIREjESERIxEhNQQA/pIBJfySASX+kgE3t7e3Akm3t7fbSUlJAUlJSUn+7re3t7dJSUnb/ttJBABJ/tvu/pJJASX+20kBbrdu3G1t3G5u3G1t3BIsXywsXywsXywsXwIZbdxubtwTLF8sLF8BGkn+2wFu/pIBJUkAAAAABgAA/4AEAAOAAAMABwALAA8AEwAXAAABESERBSERISUVITUBESERBSERISUVITUEAPwAA5L83AMk/iX+2wNu/AADkvzcAyT+Jf7bAVv+JQHbbf8ApElJAu7+JQHbbv8ApUlJAAUAAP94BAADgQAYADsAUQBqAHMAABMVMwYXFhceATc2NzY3Fw4DLgEnFSMRJTIXFh8BFhcWBg8CBgcGBwYjIicmLwQuAT8CNjc2FyIHBg8BFxYXFh8BMjc2PwEnJicmJwMyFhc1MxEjNSM2JyYnLgEHBgcGByc+AhMyFhQGIiY0Nm4BCCQkRUe5XltKSylsJHmesq6XN24CAFVjRzgSEQUGAQkLEh8rODlFPkdSPzsUEBINDQMLFw04R2NVPExENAUFMEBGOhA8TEQ0BQUwQEY6EHbUSG5uAQgkJEVHuV5bSkspbCiQumUeKys8KysBySlgWFc+PzIUEzk6Vx1SglIXJl5GegIAbjAjLxARBgkNCgwRGxsjFRoiGyoODRANDw8MFwwvIzBJIR4rBAQoHSAEASEeKwQEKB0gBAGTZ1x6/gApYFhXPj8yFBM5OlcdXYxN/kkrPCsrPCsAAAUAAP+ABAADgAAJAAwAEAAaACYAAAERIxEhESEVIREBFwcnFSE1ARUhFTMVIxUjEQUXNzMHFyMnByM3JwQAbvzcAZL+AAK329u3/rcBbv8AkpJuAbdJSUlubklJSUltbQOA/W4CJPzcbgQA/SWAgLZJSQJubpJutgIkkm5ukpNubpOSAAQAAP9/BAADgAAVABkAHQAhAAABESMVITUhESE1IREhNSERITUhESMRASEVIREhFSEBIxUzAW6TAQACJf3b/wABAAIl/dv+t5IDkv63AUn+twFJ/W6SkgOA/pJtbf7cbf7cbv7bbgIkAW78t0kBt0oBt5IAAv/3/4gD+QOBABMAJAAAATIeAwYHFwcnDgEuAz4CFyIOARQeATI3Njc2NCcmJyYB3FqnhE4ONDinTahRxcmqaRo9iLlnYqpiYqrFVVMxMjIxU1UDgEJ5o7KsR6dOqEAxI3WuysWYVG5iqcSqYjIwU1XHVVMwMgAABAAA/8kEAAM3AAMABwALAA8AAAERIREBIREhJRUhNQEhFSEEAPwAA5L83AMk/iX+2wMA/NwDJAM3/JIDbv5u/pLbbW0Bt7cABAAA/4AEAAOAAAUACQANABEAAAkBEQkBERcRBRElBRElAQ0BJQIAAgD+AP4AbgFbAcn+pQFb/m7+bgGSAZIDgP8A/gD/AAEAAgCS/tu3AUmTk/63twJJt5KSAAAGAAD/gAQAA4AAEQAaAB4AIgAmAC0AAAEzHgIXFREjFSMRIREhFSERARcHIRUhFwcvARUhNSUVITUlFSE1JRUzNTQmJwNuCyM8JQOSbv1uAZL+AAMYNHUBKf7TeTTPSf6SAkn9twJJ/bcC3EklHAOAAyU7JAv/ALcB2/zcbgQA/agzdUl5NM9MSkrbSUnbSUm3t24cKgMAAAP///9/BAADgQAYAC0AOgAAATIXHgEXFhQHDgEHBiInLgEnJjQ3PgE3NhciBwYHBhQXFhcWMjc2NzY0JyYnJgcyHgEUDgEiLgE0PgECAGhfXI4nKCgnjlxf0F9cjicoKCeOXF9obV5bNTc3NVte2l5bNTc3NVtebUZ1RUV1jHVFRXUDgCgnjlxf0F9cjicoKCeOXF/QX1yOJyhuNzVbXtpeWzU3NzVbXtpeWzU3kkV1jHVFRXWMdUUAAAAABQAA/4AEAAOAAAUAGgAvADwAQgAAJREhNSERATIXFhcWFAcGBwYiJyYnJjQ3Njc2FyIHBgcGFBcWFxYyNzY3NjQnJicmBzIeARQOASIuATQ+AQMVIREjEQQA/pIBJf5JbV5bNTc3NVte2l5bNTc3NVtebU9FQicoKCdCRZ5FQicoKCdCRU8yVDExVGRUMTFUYP7bSe7+kkkBJQIkNzVbXtpeWzU3NzVbXtpeWzU3bSgnQkWeRUInKCgnQkWeRUInKG4xVGRUMTFUZFQxAUlJ/tsBbgAFAAD/gAQAA4AABQAJAA0AEwAZAAAlESE1IREDESERBSERIQMXASc3FwMVIREjEQQA/pIBJUn9JAJu/gACAEk6/tm5On9c/ttJ7v6SSQElAgD9JALcbv4AAag6/tm5On8CRUn+2wFuAAgAAP+ABAADgAADAAcACwAPABMAFwAbAB8AAAERIREhESERByERIQEhESEBESERIREhEQchESEBIREhAdv+JQQA/iW3/wABAAIk/wABAP5J/iUEAP4lt/8AAQACJP8AAQABW/4lAdv+JQHbbf8AAQD/AAOS/iUB2/4lAdtu/wABAP8AAAMAAAAAA7cDjQAXABsAHwAAARU3ARYXFhcWFA4BIi4BNTQ3NjcJATcRBQMXEwEjFTcBtwoBiRMZGxIUHjI8Mh4dGiD+p/5wbgEY6+Dr/r9ubgOMVQz+txMpKykvOjMdHTMdIzw1LP5lAUCDAYbk/ui8ARgBV+aDAAcAAP+ABAADgAANABYAGgAeACIAJgAqAAABESM1IRUzFSMVMxUhEQEXByEVIRcHJyUjFTMRIxUzASMVMyUjFTMlIxUzBABu/gBubm7+AAMYNHUBKf7TeTTP/ty3t7e3Am23t/7c3Nz+t7e3A4D9t0mSbpJuBAD9qDN1SXk0zyeSAZKSAZKSkpKSkgAAAQAA/4ADkwOAABAAAAERIREhESE1Bxc1IREhESERA5L83AMk/m6SkgEl/bYCSgHJAbf8AAIASYCASf7cAyT+twAAAAAFAAD/gAQAA4AAAwAHAAwAEwAgAAABESERAQcVIRMHFzMZASERNxcBFwEyHgEUDgEiLgE0PgEEAPwAASW3Afxx1dW3/Ny3lgEgt/2THTMdHTM7Mx0dMwOA/AAEAP2St20Bt/TDAQACJP23t4oBQbcBSR0zOzMdHTM7Mx0AAQAA/4ADkwOAABAAABMRIREhESEVNycVIREhESER2wJK/bYBJZKS/m4DJPzcAckBSfzcASRJgIBJ/gAEAP5JAAMAAP+AA24DgAAUAB4AKAAAATIeAQYHMzIeAh0BFAcGBwYjIREBIREhMj4BNC4BAyMVMzI+ATQuAQHbToI7IDgELFE9IignQkRQ/kkBk/8AAQAxVDExVHu2th4zHR0zA4BXkZg3IT5RK0lQREInKAQA/gD+kjFUZFQxAW7cHjI8Mh4AAAYAAP+ABAADgAADAAcADQAWAB8AJQAAAREhEQUhESEBESMRITUBMhYUBiImNDYhMhYUBiImNDYBFQsBNRMDbvySAwD9bgKSAQBJ/NsBtx4rKzwrK/76HisrPSsrAYzb3NwC7vySA25u/W4DkvySAyVJ/W4rPSsrPSsrPSsrPSsBJG3/AAEAbf8AAAAACQAA/4AEAAOAAAMABwALAA8AEwAfACMAJwArAAABESERASMVMyUjFTMlIxUzASERIQEXBxcHJwcnNyc3FxMjFTMlIxUzJSMVMwQA/AADkre3/tzc3P63t7cCbfzcAyT+uTROTjRNTjROTjROcNzcASS3t/2Tt7cDgPwABAD9AJKSkpKSAiT+3AEOM05OM01NM05OM00BY5KSkpKSAAAAAAgAAP+ABAADgAADAAcAEwAfACMALwA7AD8AAAERIREFIREhJzIeARQOASMiJjQ2JRc3FwcXBycHJzcnBRUhNTcyHgEUDgEjIiY0NgEVMxUjFSM1IzUzNQUVITUEAPwAA5L83AMkyQoRCgoRCg8VFf4MZ2g0aGg0aGc0aGgC3P63pAoRCgoRCg8VFf6hgIBJgIACXP63A4D8AAQAbvzcbQkRFBEKFh4V7mdnNGdnNGdnNGdnTElJbgoRFBAKFR4WAaSASYCASYCASUkAAAIAAP+AA7cDNwAkACwAAAERIyInJi8BJicmIxQHBgcGBw4BNQYHBiMhIiY/ATY3Njc2PQEBMxEhFSE1IQO3bhwUEgcLDQ0TEQQDBgUGBAkPJxop/lofERIQEg8VDQ8BJJMBSf0AASQBgP4AFhMgJiscJSkiHRcTDgoNARcIBiEZFRscJyUtJtsBt/7bSUkAAAQAAP+ABAADgAADAAcADQAZAAABESERBSERIQERIxEhNQEVMxUjFSM1IzUzNQNu/JIDAP1uApIBAEn82wFcpKRupaUC7vySA25u/W4DkvySAyVJ/pKkbqWlbqQABv///38EAAOBABgAPQBLAFMAVwBbAAABMhceARcWFAcOAQcGIicuAScmNDc+ATc2FyIHMwczByMXIycHIzcOAh4DPgMmJwcjFyMnByMTMyYTFTMVIxEjJzM1IzUzNSUXBxEjNQcnJRcHJxMHMyYCAGhfXI4nKCgnjlxf0F9cjicoKCeOXF9oWFA6JJIlSSVJJSRKakxpKxxdj6mkhE8JOzwfSSRJJCVJbjpQg0pKtiWS29v+3Ek3STdJAUluJW7ZIoIrA4AoJ45cX9BfXI4nKCgnjlxf0F9cjicobiRJSm1tbfYohaSpjlwbLWqYqZ8+P21tbQEAJP63SUn/AEm3SUkSJEL+wuZCJSVKSUkCDUMoAAAABQAA/4oEAAM3AAgAGAAcACAAJAAAARcHIRUhFwcnAxUzNTMVMzUzFTM1MxEhEQEjFTMlIxUzJSMVMwFhNHUCBf33eTTPJLdt3G23bvwAA5K3t/7c3Nz+t7e3ASgzdUl5NM8C3pKSkpKSkv4AAgD/AJKSkpKSAAAABQAA/4AEAAOAAA8AEwAcACAAJAAAAREhNTM1IzUzNSM1MzUjNQEjFTMBFwchFSEXBy8BIxUzESMVMwIA/gBubm5ubm4Bkre3AYY0dQEp/tN5NM+3t7e3twOA/ABut23cbbdu/SW3Al80dEp4NM9w3AIAtwAFAAD/gAQAA4AAAwAHAA0AEQAVAAABESERBSERIQERIxEhNQEVITUlFSE1A278kgMA/W4CkgEASfzbAgD+SQG3/kkC7vySA25u/W4DkvySAyVJ/YBubtttbQAAAAUAAP+ABAADgAAPABMAHAAgACQAAAEVIxUzFSMVMxUjFTMVIREBIxUzARcHJzchNSEnBSMVMxEjFTMEAG5ubm5ubv4AASW3t/3Dz880df7XAS15AnG3t7e3A4But23cbbduBAD9JbcCX8/PNHRJeSvcAgC3AAAAAAIAAP9/A+EDNwAtADkAABMyFhcbAT4BPwEzMh4BFAcDExYUDgErASImJwsBDgEPASMiLgE0NxMDJjQ+ATMlFQcVMxUjNTc1IzXbFCIKoaIJHBIIHwwTCwXc3AULEwwfEyIKoqEJHREJHwsUCwbb2wYLFAsDJZKS3JOTAu4UEf7rARUPEwIBDBMXCf6I/ogKFhQLExEBFv7qDxICAQsUFgoBeAF4CRcTDEmSJSVJkyQlSQAAAAL///9/BAADgAARAB0AAAEVIRUjEwcBESMRAScBIzUhNRMXIREjNSEVIxEhJwJJAW63223+25L+25IBALcBbm5JAZKS/SSSAbdJAhKSkv7bSQFu/pIBbv6SSQElkpIBbpL+25KSASWSAAAAAAIAAAAAA24DhwAHAAsAAAkBIychByMBFyMDMwIlAUmTP/7IP5MBSSwOYdADhvzctrYDJMX+6gAAAgAA/4ADbgNcAAMAHAAABRUhNRMRFB4CPgE3NREzERQHBgcGIicmJyY1EQNu/SSTOGJ1ZT8DkzIxUlbGVlIxMhJubgNt/ko7YzwENmA7DQG2/kpkVVMwMjIwU1VkAbYAAwAA/8kEAAOAAA8AGwAkAAABESM1IxUjNSMVIzUjFSMRBSEVMzUzFTM1MxUzARcHIRUhFwcnBABut23cbbduA5L83Ldt3G23/c80dQIF/fd5NM8Byf4AkpKSkpKSAgBukpKSkpICtzR0SXk0zwAAAAIAAP9/BAADgAAQABwAAAEVByEVIREhNzM1ITUhNyE1ARchESM1IRUjESEnAyVKASX+Sf6SSpL+SQG3Sf7bAUpJAZKS/SSSAbdJAhKSSZL+25KTkkmSAW6S/tuSkgElkgAAAAAF////gAQAA4AAHgAiACsALwBEAAAlFSE1IyIuAj0BND4COwERIREzMh4BHQEUDgIjJyERIRMyFhQGIiY0NhMhFSETMjY3PQE0JiMhIgYHHQEUFh8BNSEDSf1uJR02KRYWKTYdJQKSJSdEJxYpNh1u/gACABIXICAtISEE/gACAEkcKgMrHv1uHCoDJRsJApJb29sXKTYd2x02KRYBJf7bJ0Mo2x02KReT/tsCACAtISEtIAFu3P5uJRwIkx4rJRwIkxwpAwFuAAIAAP9/BAAC7gAHAA8AAAEVIREjESE1ARUjESMRIzUC2/7ckv7bBACSk5IC7pP9JQLbk/7bkv5JAbeSAAIAAP9/A+EC7gAtADkAABMyFhcbAT4BPwEzMh4BFAcDExYUDgErASImJwsBDgEPASMiLgE0NxMDJjQ+ATMBFQcVMxUjNTc1IzXbFCIKoaIJHBIIHwwTCwXc3AULEwwfEyIKoqEJHREJHwsUCwbb2wYLFAsDJZKS3JOTAu4UEf7rARUPEwIBDBMXCf6I/ogKFhQLExEBFv7qDxICAQsUFgoBeAF4CRcTDP23kyQlSZIlJEoAAAEAAP9/A24DgAALAAABITUhFSMDIRUhNTMB2/8AApO3kgEA/W23Au6Skv0kkpIAAAAAEgDeAAEAAAAAAAAAEwAAAAEAAAAAAAEABwATAAEAAAAAAAIABwAaAAEAAAAAAAMABwAhAAEAAAAAAAQABwAoAAEAAAAAAAUACwAvAAEAAAAAAAYABwA6AAEAAAAAAAoAKwBBAAEAAAAAAAsAEwBsAAMAAQQJAAAAJgB/AAMAAQQJAAEADgClAAMAAQQJAAIADgCzAAMAAQQJAAMADgDBAAMAAQQJAAQADgDPAAMAAQQJAAUAFgDdAAMAAQQJAAYADgDzAAMAAQQJAAoAVgEBAAMAAQQJAAsAJgFXQ3JlYXRlZCBieSBpY29uZm9udGVtcmZvbnRSZWd1bGFyZW1yZm9udGVtcmZvbnRWZXJzaW9uIDEuMGVtcmZvbnRHZW5lcmF0ZWQgYnkgc3ZnMnR0ZiBmcm9tIEZvbnRlbGxvIHByb2plY3QuaHR0cDovL2ZvbnRlbGxvLmNvbQBDAHIAZQBhAHQAZQBkACAAYgB5ACAAaQBjAG8AbgBmAG8AbgB0AGUAbQByAGYAbwBuAHQAUgBlAGcAdQBsAGEAcgBlAG0AcgBmAG8AbgB0AGUAbQByAGYAbwBuAHQAVgBlAHIAcwBpAG8AbgAgADEALgAwAGUAbQByAGYAbwBuAHQARwBlAG4AZQByAGEAdABlAGQAIABiAHkAIABzAHYAZwAyAHQAdABmACAAZgByAG8AbQAgAEYAbwBuAHQAZQBsAGwAbwAgAHAAcgBvAGoAZQBjAHQALgBoAHQAdABwADoALwAvAGYAbwBuAHQAZQBsAGwAbwAuAGMAbwBtAAACAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALABAgEDAQQBBQEGAQcBCAEJAQoBCwEMAQ0BDgEPARABEQESARMBFAEVARYBFwEYARkBGgEbARwBHQEeAR8BIAEhASIBIwEkASUBJgEnASgBKQEqASsBLAEtAS4BLwEwATEBMgEzATQBNQE2ATcBOAE5AToBOwE8AT0BPgE/AUABQQFCAUMBRAFFAUYBRwFIAUkBSgFLAUwBTQFOAU8BUAFRAVIBUwFUAVUBVgFXAVgBWQFaAVsBXAFdAV4BXwFgAWEBYgFjAWQBZQFmAWcBaAFpAWoBawFsAW0BbgFvAXABcQFyAXMBdAF1AXYBdwF4AXkBegF7AXwBfQF+AX8BgAGBAYIBgwGEAYUBhgGHAYgBiQGKAYsBjAGNAY4BjwGQAZEBkgGTAZQBlQGWAZcBmAGZAZoBmwGcAZ0BngGfAaABoQGiAaMBpAGlAaYBpwGoAakBqgGrAawBrQGuAa8BsAGxAA9kaWFnbm9zZUNvbmZpcm0Lb3V0SG9zcGl0YWwKaW5Ib3NwaXRhbAhjb3B5VGV4dARtYXJrB3ByZXZpZXcOYWRkaXRpb25hbENvcHkGZHVhbnl1E3poZW5neGluZ2Z1ZGlhbnhpbmcHa2FpZ3VhbgptaW1ha3VhbmcxDXNoaWppYW5rdWFuZzEKemlmdWt1YW5nMQt4aWFsYWt1YW5nMQd4aWd1YW4xB3hpbmppYW4EZG93bgJ1cAxxaW5nY2h1Z2VzaGkKaHVhbmhhbmdmdQZ0dWJpYW8LeWVtaWFuc2hpdHUHeWF3ZWl0dQltb3hpbmdzaHUPemlkaW5neWlzaHVqdWppBGVkaXQQZGVsZXRlZm9ybWNvbHVtbghsaWViaWFvMRFkaWFuaHVhaGFvbWFrdWFuZxF3ZW5qaWFuc2hhbmdjaHVhbgZ6dWppYW4Jc2h1anV5dWFuEXhpbmppYW54aWFsYWFubml1GnhpbmppYW53ZW5iZW5zaHVydWtvbmdqaWFuDnhpbmppYW5hbm5pdXp1D3hpbmppYW5iaWFvcWlhbgp4aWFsYWFubml1B2Fubml1enUJamluZHV0aWFvB2xpZWJpYW8NemlqaS10b25neW9uZwxmdWppLXNodWp1amkOZnVqaS1iaWFvc2h1anUMZnVqaS1jYW56aGFvDmZ1amkteXVhbnNodWp1EmZ1amktY2Fuemhhb21veGluZyBhLWZ1amktdG9uZ3lvbmdtZWlqdS1zaGVuc2Vtb3NoaQlwYXJhZ3JhcGgEd29yZAVmcmFtZQxzdHJhaWdodExpbmUFYXJyb3cDcGVuBmNpcmNsZQpicm9rZW5MaW5lB3BvbHlnb24Nc3RyaWtlVGhyb3VnaApleHByZXNzaW9uBnFyY29kZQtkb2N0b3JvcmRlcgZiYW9nYW8JaHVtYW5ib2R5BHNhdmUJdHJhbnNmb3JtB3dhcm5pbmcHc3VjY2VzcwRpbmZvCHF1ZXN0aW9uBWVycm9yBnpvb21pbgd6b29tb3V0BmZvbGRlcgVyaWdodARsZWZ0B2p1c3RpZnkGY2VudGVyC2Rpc3RyaWJ1dGVkB3RvcGxlZnQKYm90dG9tbGVmdAtib3R0b21yaWdodAxib3R0b21jZW50ZXIIdG9wcmlnaHQJdG9wY2VudGVyDGNlbnRlcmNlbnRlcgtjZW50ZXJyaWdodApjZW50ZXJsZWZ0C2Fycm93Ym90dG9tB2FkZGRhdGEIcHJvcGVydHkKc3BsaXRjZWxscwpwYWdlbnVtYmVyCWFsaWdubWVudAlzdHJ1Y3R1cmUHYmFyY29kZQR0ZXh0CGRpYWdub3NlCXNpZ25hdHVyZQloYXZlb3Jub3QGbnVtYmVyCXJlZmVyZW5jZQRsaW5rCGNoZWNrYm94BGRhdGUJZGF0YWdyb3VwB2VsZW1lbnQJY29kZWdyb3VwCXdhdGVybWFyawRjb2RlBnNhdmVhcwRvcGVuDHByaW50cHJldmlldwpwYWdlZm9ybWF0EHByaW50Y3VycmVudHBhZ2UGZGVsZXRlC2JvcmRlcnNoYWRlCmluc2VydGxpbmUMaW5zZXJ0YnV0dG9uC2luc2VydHNoYXBlCGZyYWN0aW9uD2luc2VydHBhZ2VicmVhaxFpbnNlcnRmaWxlY29udGVudAlzaG93c2NhbGULcmVzdG9yZXNpemULaGlkZGVuc2NhbGUHd2Vidmlldwtjb21wbGV4dmlldw9leHByZXNzaW9uY2hlY2sEdGVzdBJpbnNlcnRtYWNyb2VsZW1lbnQRcGFyYWdyYXBodGVtcGxhdGUJd29ya21vZGVsCm1lcmdlY2VsbHMKZGVsZXRlZm9ybQxzaG93Z3JpZGNvZGUPaGlkZWVsZW1lbnRjb2RlD3Nob3dlbGVtZW50Y29kZQxlbGVtZW50c3RvcmUEZGF0YQ9yZWluc3RhbGxzeXN0ZW0OdGVzdGV4cHJlc3Npb24EdHJlZQZzZWFyY2gEY2FyZAZlbnRpdHkMaW1wb3J0UmVwb3J0BXJhZGlvCnJhZGlvZ3JvdXANY2hlY2tib3hncm91cA5jbGVhbnZpZXctY29weQl0ZXh0Y29sb3IKaW5zZXJ0Zm9ybQZjYW5jZWwJaW5zZXJ0cGljB3JlY292ZXIEYm9sZANjdXQNZGVsZXRlZm9ybXJvdw5kZXNpZ25mb3JtdWxhcwVjbGVhcgRjb3B5CHNwZWNoYXJzEGluc2VydGZvcm1ib3R0b20PaW5zZXJ0Zm9ybXJpZ2h0BXBhc3RlDmluc2VydGZvcm1sZWZ0C3N1cGVyc2NyaXB0BnNvbmd0aQlmb250Y29sb3IJdW5kZXJsaW5lDWluc2VydGZvcm10b3AEZm9udAVwcmludAhmb250c2l6ZQlzdWJzY3JpcHQGaXRhbGljAAAAAAA="},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Blank=void 0;class r{}t.Blank=r,r.File='<?xml version="1.0" encoding="utf-8"?>\n        <XTextDocument xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" EditorVersionString="1.2015.12.23">\n           <Attributes />\n           <ContentReadonly>False</ContentReadonly>\n           <XElements>\n              <Element xsi:type="XTextHeader">\n                 <Attributes />\n                 <AcceptTab>true</AcceptTab>\n                 <XElements>\n                    <Element xsi:type="XParagraphFlag" StyleIndex="0" />\n                 </XElements>\n              </Element>\n              <Element xsi:type="XTextBody">\n                 <Attributes />\n                 <AcceptTab>true</AcceptTab>\n                 <XElements>\n                    <Element xsi:type="XParagraphFlag" />\n                 </XElements>\n              </Element>\n              <Element xsi:type="XTextFooter">\n                 <Attributes />\n                 <AcceptTab>true</AcceptTab>\n                 <XElements>\n                    <Element xsi:type="XParagraphFlag" />\n                 </XElements>\n              </Element>\n           </XElements>\n           <RepeatedImages />\n           <GlobalJavaScriptReferences />\n           <Info>\n              <LicenseText>卫宁健康</LicenseText>\n              <CreationTime>1980-01-01T00:00:00</CreationTime>\n              <LastModifiedTime>2017-10-25T13:52:24.2345702+08:00</LastModifiedTime>\n              <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>\n              <Operator>DCSoft.Writer Version:1.2015.12.23</Operator>\n              <NumOfPage>1</NumOfPage>\n           </Info>\n           <BodyText />\n           <Comments />\n           <RuntimeComments />\n           <LocalConfig />\n           <PageSettings />\n           <UserHistories />\n           <Parameters />\n           <ContentStyles>\n              <Default xsi:type="DocumentContentStyle">\n                 <FontName>宋体</FontName>\n                 <FontSize>12</FontSize>\n              </Default>\n              <Styles>\n                 <Style Index="0">\n                    <FontName>宋体</FontName>\n                    <FontSize>12</FontSize>\n                    <Align>Center</Align>\n                 </Style>\n              </Styles>\n           </ContentStyles>\n           <FileName>C:\\Users\\f\\Desktop\\空文档.xml</FileName>\n           <FileFormat>XML</FileFormat>\n        </XTextDocument>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Signature1=void 0;const r=n(27),i=n(1190);class l extends r.BaseControl{constructor(e){let t=document.createDocumentFragment();super(t,e),this.Component=new i.SignatureComp(t,this.InitProps)}DefaultProps(){return{top:0,left:0}}}t.Signature1=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignatureComp=t.Signature=void 0;const r=n(12),i=n(24);n(1191);const l=n(74),s=n(22);class o extends r.Component{constructor(e){super(e),this.canvascontainer=r.createRef(),this.canvasWidth=800,this.canvasHeight=this.canvasWidth/2,this.lastLocation={x:0,y:0},this.recentTime,this.recentLineWidth=0,this.penColor="#000",this.state={isRender:!0}}componentDidMount(){this.props.parent.React=this,this.canvas=this.canvascontainer.current,this.canvas.width=this.canvasWidth,this.canvas.height=this.canvasHeight,this.context=this.canvas.getContext("2d"),this.drawGrid(this.context);let e=this;document.getElementById("clear-btn").onclick=function(){e.drawGrid(e.context)};for(var t=document.querySelectorAll("#panel>a"),n=0;n<t.length;n++){let r=t[n];r.style.background=t[n].innerHTML,r.onclick=function(){for(var t=document.querySelectorAll(".active"),n=0;n<t.length;n++)t[n].setAttribute("class","");e.penColor=r.innerHTML,r.setAttribute("class","active")}}this.canvas.onmousedown=function(t){t.preventDefault(),e.beginStroke(t.offsetX,t.offsetY)},this.canvas.onmousemove=function(t){t.preventDefault(),1==t.buttons&&e.strokeProcess(t.offsetX,t.offsetY)},this.canvas.onmouseup=function(e){e.preventDefault()},this.canvas.onmouseout=function(e){e.preventDefault()}}beginStroke(e,t){this.lastLocation=this.getMousePosition(e,t,this.canvas),this.recentTime=(new Date).getTime()}strokeProcess(e,t){var n=this.getMousePosition(e,t,this.canvas),r=(new Date).getTime(),i=r-this.recentTime,l=this.getLineWidth(n,i);this.draw(this.context,n,this.penColor,l),this.lastLocation=n,this.recentTime=r,this.recentLineWidth=l}getMousePosition(e,t,n){var r=n.offsetWidth,i=n.offsetHeight;return e=e*n.width/r,t=t*n.height/i,{x:e=Math.round(e),y:t=Math.round(t)}}getLineWidth(e,t){var n=this.distance(e.x,e.y,this.lastLocation.x,this.lastLocation.y)/t;return n=(n=2+1/n)>6?6:n,n=.4*this.recentLineWidth+.6*n}distance(e,t,n,r){return Math.sqrt((e-n)*(e-n)+(t-r)*(t-r))}draw(e,t,n,r){e.strokeStyle=n,e.lineCap="round",e.lineJoin="round",e.lineWidth=r,e.beginPath(),e.moveTo(this.lastLocation.x,this.lastLocation.y),e.lineTo(t.x,t.y),e.stroke()}drawGrid(e){e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.strokeStyle="rgb(230,11,9)",e.restore()}okHandler(){let e=this.canvas.toDataURL("image/png");this.props.onOk(e)}closeHandler(){this.drawGrid(this.context),this.setState({isRender:!1})}render(){let{target:e,top:t,left:n}=this.props,{isRender:i}=this.state;return i?r.createElement(l.default,{top:t,left:n,showOkBtn:!0,showCancelBtn:!0,target:e,isShow:!0,onOk:this.okHandler.bind(this),onClose:this.closeHandler.bind(this)},r.createElement("div",{className:"signature"},r.createElement("canvas",{ref:this.canvascontainer,id:"canvas",width:"800",height:"400"},"您的浏览器不支持canvas！"),r.createElement("div",{id:"panel"},r.createElement("a",{className:"active",style:{background:"rgb(0, 0, 0)"}},"#000"),r.createElement("a",{style:{background:"rgb(215, 0, 0)"}},"#D70000"),r.createElement("a",{style:{background:"rgb(38, 127, 0)"}},"#267F00"),r.createElement("a",{style:{background:"rgb(0, 148, 255)"}},"#0094FF"),r.createElement("a",{style:{background:"rgb(255, 106, 0)"}},"#FF6A00"),r.createElement("button",{id:"clear-btn"},"Clear")))):null}}t.Signature=o;class a extends s.BaseComponent{constructor(e,t){super(e,t)}Render(){i.render(r.createElement(o,Object.assign({},this.Props,{parent:this})),this.Dom)}}t.SignatureComp=a},function(e,t,n){var r=n(18),i=n(1192);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};r(i,l);e.exports=i.locals||{}},function(e,t,n){(t=n(19)(!1)).push([e.i,".signature #canvas {\r\n    display: block;\r\n    margin: 20px auto;\r\n    width: 90%;\r\n    max-width: 600px;\r\n    min-width: 300px;\r\n    border: 1px solid #000;\r\n}\r\n\r\n.signature #panel {\r\n    margin: 0 auto;\r\n    width: 90%;\r\n    max-width: 600px;\r\n    min-width: 300px;\r\n    padding: 10px 0;\r\n}\r\n\r\n.signature #panel a {\r\n    display: inline-block;\r\n    width: 30px;\r\n    height: 30px;\r\n    margin: 0 5px 0 0;\r\n    border-radius: 15px;\r\n    background-color: #666;\r\n    overflow: hidden;\r\n    text-indent: -200px;\r\n    cursor: pointer;\r\n}\r\n\r\n.signature #panel a:hover {\r\n    box-shadow: 0px 0px 1px 2px #aaaaaa;\r\n}\r\n\r\n.signature #panel a.active {\r\n    box-shadow: 0px 0px 3px 3px #888888;\r\n}\r\n\r\n.signature #clear-btn {\r\n    float: right;\r\n    width: 70px;\r\n    height: 30px;\r\n    font-family: Microsoft Yahei, Arial;\r\n    font-size: 16px;\r\n    font-weight: 400;\r\n    line-height: 1.4;\r\n    text-align: center;\r\n    white-space: nowrap;\r\n    vertical-align: middle;\r\n    cursor: pointer;\r\n    user-select: none;\r\n    border: 1px solid #c6c6c6;\r\n    border-radius: 4px;\r\n    background-color: #fff;\r\n}\r\n\r\n.signature #clear-btn:hover {\r\n    color: #333;\r\n    background-color: #e6e6e6;\r\n    border-color: #adadad;\r\n    text-decoration: none;\r\n}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeFactory=void 0;class r{static ChangeTheme(e){const t=this.themeMap[e]||this.themeMap.default;document.documentElement.style.setProperty("--pango-editor-theme",t.primary),document.documentElement.style.setProperty("--pango-editor-theme-hover",t.hover),document.documentElement.style.setProperty("--pango-editor-theme-press",t.press),document.documentElement.style.setProperty("--pango-editor-theme-table-head",t.table_head),document.documentElement.style.setProperty("--pango-editor-theme-back-select",t.back_select)}}t.ThemeFactory=r,r.themeMap={default:{primary:"#2d5afa",hover:"#5175f4",press:"#1d49c4",table_head:"#eaeefe",back_select:"#f3f5ff"},skyBlue:{primary:"#0791EF",hover:"#48ADF3",press:"#068BDD",table_head:"#ECF7FF",back_select:"#F5FBFF"},industrialBlue:{primary:"#005D97",hover:"#0A74B6",press:"#004E7E",table_head:"#DAF1FF",back_select:"#E9F7FF"},azureBlue:{primary:"#0043B2",hover:"#1B5ED0",press:"#003793",table_head:"#E0EBFF",back_select:"#F4F8FF"},brightCyan:{primary:"#2DB7A0",hover:"#60E0CB",press:"#089881",table_head:"#E6FFFC",back_select:"#F3FFFD"},surgicalBlue:{primary:"#2996AA",hover:"#39AFC5",press:"#177B8D",table_head:"#E3FBFF",back_select:"#EFFDFF"},innovationGreen:{primary:"#1F8970",hover:"#1FA585",press:"#046A52",table_head:"#D5FFF5",back_select:"#E3FFF8"},winterCyan:{primary:"#196C35",hover:"#278B49",press:"#0D4F23",table_head:"#DAFFE7",back_select:"#ECFFF3"},maternityPink:{primary:"#F24F86",hover:"#FF82AC",press:"#D03469",table_head:"#FFE4EF",back_select:"#FFEEF5"},darkPurple:{primary:"#722ED1",hover:"#9E6EE1",press:"#551AA7",table_head:"#F5EDFF",back_select:"#F9F5FF"},daiPurple:{primary:"#8142B0",hover:"#9553C6",press:"#5F1C91",table_head:"#F2E0FF",back_select:"#F9F0FF"},lavenderPurple:{primary:"#7753BD",hover:"#9067DF",press:"#5935A0",table_head:"#E9DEFF",back_select:"#F4EFFF"},grapePurple:{primary:"#422AA8",hover:"#5235CB",press:"#2A1681",table_head:"#E3DCFF",back_select:"#F2EFFF"},sunrise:{primary:"#B16C3D",hover:"#C57036",press:"#985528",table_head:"#FFEBDD",back_select:"#FFF6EF"},marigold:{primary:"#7B4A36",hover:"#92604C",press:"#5C2E1B",table_head:"#FFEBE3",back_select:"#FFF5F1"},cubanSand:{primary:"#60493B",hover:"#805C47",press:"#433024",table_head:"#FFF3EB",back_select:"#FFFBF9"}}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__1194__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__1195__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__1196__}])}));
//# sourceMappingURL=PangoEditor.js.map